#ifndef _GlobalMatchManager_
#define _GlobalMatchManager_

#include Query.vih

#component "AGAT"

type tArgsArray = array[0..0] of variant;

objinterface IGlobalMatchSearcher;
  function SearchMatch(args: tArgsArray): IResultSet;
end;

objinterface IGlobalMatchSetter;
  function SetMatch(args: tArgsArray): boolean;
end;

objinterface IGlobalMatchManager;
  function FindByExternalObjId(aExternalObjId: string): IResultSet;
  function FindByRefObjId(aRefObjId: comp): IResultSet;
  function SetMatch(aRefObjId: comp; aExternalObjId: string): boolean;
end;

vipinterface GlobalMatchManager implements IGlobalMatchManager;
  public:
    constructor Init;
    property SearcherByExternalObjId: IGlobalMatchSearcher;
    property SearcherByRefObjId: IGlobalMatchSearcher;
    property MatchSetter: IGlobalMatchSetter;
end;

vipinterface GoodsByKatmcMatchSearcher implements IGlobalMatchSearcher;
  public:
    constructor Init;
    property IdObjMappingType: string;
    property IdRefClass: string;
end;

vipinterface KatmcByGoodsMatchSearcher implements IGlobalMatchSearcher;
  public:
    constructor Init;
    property IdObjMappingType: string;
    property IdRefClass: string;
end;

vipinterface KatmcGoodsMatchSetter implements IGlobalMatchSetter;
  public:
    constructor Init;
    property IdObjMappingType: string;
    property IdRefClass: string;
end;

#end
