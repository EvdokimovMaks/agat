#ifndef __PriceFinder__
#define __PriceFinder__

#include IModify.vih
#include Query.vih

#component "AGAT"

/*
#doc
<brief>Объекты с ценами</brief>
#end
objinterface oPriceObject;

  #doc
  <brief>Установка строки приходной накладной с расчетом и установкой всех зависимых полей</brief>
  #end
  procedure SetSpsopr(aSpsoprNrec: comp);

  #doc
  <brief>Установка объекта с расчетом и установкой всех зависимых полей</brief>
  #end
  procedure SetObject(aKind: word; acRec: comp);

  #doc
  <brief>Уникальный номер</brief>
  #end
  property Nrec      : comp;

  #doc
  <brief>Вид объекта: 1 - МЦ, 2 - Услуга</brief>
  #end
  property Kind      : word;

  #doc
  <brief> Ссылка на объект: katmc.nrec / katusl.nrec </brief>
  #end
  property cRec      : comp;

  #doc
  <brief> Релевантность. Используется для сотрировки по индексу: релевантность тем больше, чем более похоже
  название мц из спецификации накладной на название объекта с ценами. При полном совпадении = 100</brief>
  #end
  property Relevance: word;

  #doc
  <brief> Ссылка на строку сопроводительного документа с ценой </brief>
  #end
  property SpsoprNrec: comp;

  #doc
  <brief> Ссылка на сопроводительный документ</brief>
  #end
  property KatsoprNrec: comp;

  #doc
  <brief> Цена из сопроводительного документа </brief>
  #end
  property Price     : double;

  #doc
  <brief> Наименование объекта: katmc.name / katusl.name </brief>
  #end
  property Name      : string;

  #doc
  <brief> Конструкторское наименование объекта: katmc.obozn / katusl.obozn </brief>
  #end
  property Obozn     : string;

  #doc
  <brief> Текстовое представление строки сопроводительного документа </brief>
  #end
  property SpsoprName: string;

  #doc
  <brief> Текстовое представление сопроводительного документа </brief>
  #end
  property KatsoprName: string;

  #doc
  <brief> Дата сопроводительного документа </brief>
  #end
  property KatsoprDate: date;

  #doc
  <brief> Наименование организации из сопроводительного документа </brief>
  #end
  property KatorgName: string;

  index i01 = Nrec;
  index i02 = Kind, cRec;

end;


vipinterface iPriceObject implements oPriceObject, iModify licensed(free);
*/

#doc
<brief>Объект для поиска цен</brief>
#end

objinterface oPriceFinder;
  #doc
  <brief>Добавить объект в коллекцию объектов для определения цены</brief>
  #end
  procedure AddObject(aObjectKind: word; aObjectNrec:comp; aOtpedNrec: comp; aSpsoprNrec: comp = 0; aPrice: double = 0);
  #doc
  <brief>Очистить коллекцию объектов для определения цен</brief>
  #end
  procedure ClearObjects;
  #doc
  <brief>Найти цены на дату</brief>
  #end
  procedure Find(aDate: date);
  #doc
  <brief>Показать пользовательский интерфейс установки цен. Возвращает событие закрытия интерфейса (cmDefault / cmCancel)</brief>
  #end
  function ShowUserInterface: longint;
  #doc
  <brief>Функция возвращает найденную строку накладной и цену объекта</brief>
  #end
  function GetPrice(aObjectKind: word; aObjectNrec: comp; var aSpsoprNrec: comp; var aPrice: double): boolean;
end;

vipinterface iPriceFinder implements oPriceFinder licensed(free);
#end
