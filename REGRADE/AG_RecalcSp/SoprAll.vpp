//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Логистика - сопроводительные документы
// Общие функции сопроводительных документов,
// которые нельзя вынести на методы объектов
//******************************************************************************

//------------------------------------------------------------------------------
// ТРЕБОВАНИЯ К ИНТЕРФЕЙСАМ:
// 1.подключены таблицы:
//   - KATSOPR
// 2.подключены файлы:
//   - SDfuns.vih ; SDfuns.var
//------------------------------------------------------------------------------


#ifNdef _SOPRALL_VPP
#define _SOPRALL_VPP

#create

//******************************************************************************
// обновление текущей записи KatSopr, SoprHoz и баланса взаиморасчета с контрагентами
//******************************************************************************

Function Update_Current_KatSopr: word;
{
  iKB.SaveInfoforBal(KatSopr.VidSopr, KatSopr.NRec);

  Result := update current KatSopr;

  if ( Result = tsOk )
    oSDfuns.UpdateSoprHoz(KatSopr.Buffer);

  iKB.ModiKontrBal(KatSopr.VidSopr, KatSopr.NRec);

  #ifdef __ArchiveFuncs_var__
  if (m_sCurrentBarKod <> '') // создание связи с архивом
  {
    oArchiveFuncs.CreateLinkDocWithBarkod(m_sCurrentBarKod, KatSopr.nRec, KatSopr.VidSopr);
    m_sCurrentBarKod := '';
  }
  #endif
}

//******************************************************************************
// использование ДЕИ в сопр.документах
#include UkrDeiTmp.vpp
//******************************************************************************

#end
