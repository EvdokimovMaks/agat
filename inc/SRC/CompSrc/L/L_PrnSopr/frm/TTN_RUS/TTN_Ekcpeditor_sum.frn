.begin
//может быть еще нужны
//include ttn_097.frn
//include ttn_096.frn

 //Страна происхождения груза
  wstr :=  if (СчФакт_НРек = 0, '-', oPrnSoprFun.PrnSoprGTD(Признак_МЦ, СчФакт_НРек, спецификацияМЦ_нрек, 1))
  if wstr<>''
    if pos(wstr,sCountry)=0
      sCountry:= sCountry+if(sCountry<>'',', ','')+wstr;
  //-----------------------------
  vKatSoprMemTTN._Loop SpSopr
  { if vKatSoprMemTTN.SpSopr.PRMc=1
    { if vKatSoprMemTTN.GetFirst KAtMc=tsok {}
      if sTovarKod = ' - '
        sTovarKod :=vKatSoprMemTTN.KAtMc.BarKod;
      else
        sTovarKod :='-';
      if vKatSoprMemTTN.GetFirst GroupMC=tsok {}
      if vKatSoprMemTTN.GroupMC.Kod =KODGRMCTARA
      { if vKatSoprMemTTN.GetFirst tmpSoprAgr where (( NameForm == tmpSoprAgr.NmForm
          and 'TARA' == tmpSoprAgr.NmGroup
          and KAtMc.Name == tmpSoprAgr.SortName
         )) <>tsok
        { vKatSoprMemTTN.insert into tmpSoprAgr set
              tmpSoprAgr.NmForm   :=  NameForm
            , tmpSoprAgr.NmGroup  := 'TARA'
            , tmpSoprAgr.SortName := KAtMc.Name
            , tmpSoprAgr.fFld1[1] := SpSopr.KolOpl
            ;
        }
        else
        { vKatSoprMemTTN.update current tmpSoprAgr set
             tmpSoprAgr.fFld1[1]    := tmpSoprAgr.fFld1[1] + SpSopr.KolOpl;
        }

      } //if vKatSoprMemTTN.GroupMC.Kod =KODGRMCTARA
      else //torg12fld.frn
      { //wstr:= IF(ЕД_ИЗМЕРЕНИЯ_ГРУЗОВЫХ_МЕСТ <> '', ЕД_ИЗМЕРЕНИЯ_ГРУЗОВЫХ_МЕСТ, ОтпЕд);
        wstr:= ЕД_ИЗМЕРЕНИЯ_ГРУЗОВЫХ_МЕСТ;
        kol_mest := КОЛ_ГРУЗОВЫХ_МЕСТ;
        if kol_mest=0 kol_mest := vKatSoprMemTTN.SpSopr.KolOpl;
        if vKatSoprMemTTN.GetFirst tmpSoprAgr where (( NameForm == tmpSoprAgr.NmForm
          and 'TARA2' == tmpSoprAgr.NmGroup
          and wStr == tmpSoprAgr.SortName
         )) <>tsok
        { vKatSoprMemTTN.insert into tmpSoprAgr set
              tmpSoprAgr.NmForm   :=  NameForm
            , tmpSoprAgr.NmGroup  := 'TARA2'
            , tmpSoprAgr.SortName := wstr
            , tmpSoprAgr.fFld1[1] := kol_mest
            ;
        }
        else
        { vKatSoprMemTTN.update current tmpSoprAgr  set
             tmpSoprAgr.fFld1[1]    := tmpSoprAgr.fFld1[1] + kol_mest;
        }

      }
      kol_mest := kol_mest + vKatSoprMemTTN.SpSopr.KolOpl
    } //if vKatSoprMemTTN.SpSopr.PRMc=1
  } //vKatSoprMemTTN._Loop SpSopr

  MassaBrItogFull      += МассаМЦ + МассаТарыМЦ;
  MassaNetItogFull     += МассаМЦ;

 end.
