//******************************************************************************
//                                                      (с) корпорация Галактика
//  Галактика 9.1 - Заработная плата
//  Импорт листка нетрудоспособности из xml-файла
//******************************************************************************

#component "Z_DocsFSS"

ObjInterface iImportBlisnetXML;

  property  prLschet        : comp    read write;
  property  primportFileName: string  read write;    //имя xml-файла
  property  prtypeRun       : word    read write;
  property  prslTypeChoice  : word    read write;    //тип больничного: больничные текущего периода sltCurrentPeriod = 0; больничные прошлых периодов (архивные) sltPastPeriod = 3;  больничные будущего периода (не участвующие в расчетах) sltFuturePeriod = 5;
  property  prboPacket      : boolean read write;
  property  prboFillMt_table: boolean read write;
  property  prSNILS_        : s20     read write;
  property  prFIO_          : string  read write;
  property  prKViplate      : double  read write;
  property  prDatVipl       : date    read write;


  #doc
  Импорт листка нетрудоспособности из xml-файла
  #end

  procedure ImportData;
  procedure pClear_Log;
  procedure pView_Log;
  procedure CheckNodeName;
  function  GetNodeValue(ANodeParent: comp; ANodeName: string; ALog: boolean): string;
  function  TrunslateDate(AStrDate: string): date;
  function  GetNodeID(ANodeParent: comp; ANodeName: string): comp;
  function  fwGetVidPos(tmpAgeFirst, tmpAgeSecond: byte; dtHOSPITAL_DT1: date; tmpS2: s2): word;
  procedure LoadExteranalKod;
  function  CheckFIO(AFIO, ASurname, AName, APatronimic: string; ABornDate: date; ASnils: s20;  ANeedLog: boolean): boolean;
  procedure pmtClear;
end;

ObjInterface iImportBlisnetXML1;
  property  prboPrintBL: boolean  read write;
end;

ObjInterface iImportBlisnetXML2;
#doc
  результат импорта ЭЛН в Галактику
  параметр:
  boRes = true, успешно
#end
  event procedure SetResultImport(boRes: boolean);
end;

vipinterface ImportBlisnetXML implements iImportBlisnetXML, iImportBlisnetXML1, iImportBlisnetXML2
licensed(free)
parameters(prLschet: comp; typeRun : word; slType: word);
