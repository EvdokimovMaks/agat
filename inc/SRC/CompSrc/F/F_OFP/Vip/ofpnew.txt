//-----------------------------------------------
!!!Tune
 + Для поля Фоп "Тип документа" добавить настройки
   + 'Документы, формируемые по умолчанию по финоперациям'
   + 'Для каждой финоперации конвертации формировать свой платежный документ'
   + 'Вид для формируемых из модуля "Платежный календарь" бухсправок'
 + переимновал настройку
   'Список платежных документов, формируемых только из модуля "Платежный календарь"'
   в 'Документы, формируемые только из модуля "Платежный календарь"'
 + Добавить настройку 'Суммы в бюджете ведутся' (нет, по ФО, по Фоп)
   (по умолчанию - по ФО)
 + заменить настройку (по просьбе Людмилы Консевич)
   'Формировать финансовые обязательства на остаток суммы с учетом отгрузок по ДО'
   на
   'Формирование обязательств по ДО осуществлять на сумму...'
 + добавить настройку (Пир 107.525)
   'Разрешить формирование обязательств по полностью оплаченным ДО'
 + добавить настройку
   'При переводе ФО в "исполняемый" все платежи ДО привязывать к ФО'
   (если в настройке
     'Формирование обязательств по ДО осуществлять на сумму...'
     выбрано 'долга по платежам'
     то при переводе в "исполняемый" привязывать только неоплаченные ХО
   )
 + добавить настройку
   'Подбор финоперации при привязке платежей ДО к ФО...'
 - "учитывать Фиксированные остатки в Рассчитанных остатках"
 - "автоматический пересчет отстатков при изменении финопераций" GetTune_AutoRecountSaldo
 - "включать в фин.поток суммы, которые не влияют на остатки ПС"
 - "Что делать с Фоп при переносе даты ФО"
 - "Выводить логи при выполнении групповых операций над Фоп/ФО/Фоп и ФО"
 - Интерфейсы модуля
     Журнал ФО
       При открытии переключаться в иерархический режим
       При открытии позиционироваться на последнюю запись
       Строить дерево по настройке
          выбранной в прошлый раз
          указанной ниже
          предлагать выбор
       Отображать итоги по текущему уровню (Пир 101.23012) __Ofp_JOURNITOGI__
          уровень иерархии "Тип периода" (закрытый/плановый)
 - в настройке в папку Формирование заявок и обязательств добавить папки
     Заявки, Финобязательства, Финоперации
 - новая папка "Связь с платежными документами"
   1. Переработать настройку
      "Доки, формируемые только из ПК"
      1) добавить все доступные доки (по функции)
      2) переименовать в "Доки, формируемые из ПК"
      3) выбирать из нее - в настройке "Типы доков, формируемых по Фоп"
      4) добавить птичку "только из ПК"
      5) добавить птичку "автоформирование в ПК при привязке к ДО"
         с учетом настройки "Формирование ФО при привязке ХО к ДО"
         после этого - переделать функцию PlatDoc_CanFoByDo
   2. добавить настройку
      "Разрешить изменение ХО, привязанной к Фоп в закрытом периоде" ("нет")
   3. добавить настройку
      "ХО, привязанную к Фоп"
      - "разрешать удалять" (изменять?)
      - "запрещать удалять"
      - "выдавать подтверждение"
   4. добавить настройку
      "При отвязки ДО от ХО, привязанной к Фоп"
      - "разрешать"
      - "запрещать"
      - "удалять привязку к Фоп"
      - "по запросу"
   5. Перенести настройки из других папок
      - "Автоматическое формирование обязательств при привязке ДО в платежных документах"
      - "При автоматическом подборе финоперации для ХО учитывать платежное средство"
      - "Устанавливать взаимосвязь между финоперациями по акту взаимозачета"
      - "При переводе ФО в "исполняемый" все платежи ДО привязывать к ФО"
      - "Подбор финоперации при привязке платежей ДО к ФО"
   6. Создать две вложенные папки
      - "Формирование из платежного календаря"
      - "Изменения в календаре при изменениях в другом модуле"

 - переименовать значение
   "предлагать распределение по статьям бюджета при формировании ФО"
   настройки
   "Автоматическое формирование обязательств при привязке ДО в платежных документах"
 - убрать "ФО" или заменить на "документа"
 - "автоформ. ФО по ХО при привязке к ДО - только по типам документов..."
 - настройка "при удалении ХО, привязанного к финоперации":
               - не давать удалять ХО (с предупреждением)
               - предупреждать перед удалением
               - дават удалять, не предупреждая
   и добавить признак в окно ред.ХО, что ХО распределено по Фоп

//-----------------------------------------------
!!!VIH
! - все вызовы внешних модулей вынести в отдельный объект (OUT\aOfpIn)
! - перейти на заглушку в cmInit Operfinp, сам Operfinp удалить
! - перенести Банковскую выписку в отдельный каталог
! - добавить поле Комментарий для Банковской выписки
! - в TuneIntr.vpp выбор приоритета перенести на вызов public-функции
!   piOfpOut.Priority_GetName, которая вызывает соответствующую в piFunOfp
! - Ctrl+F2/Ctrl+F3 для ФО
! - в aClearin все типы документов (Clearing_GetPlatMean2) сделать через функции
! - перенести App_-функции из aFunOfp.vih в aNewApp.vih
! - избавиться от __OFP_CLEARINGNEW__
! - сделать, чтобы AktPerf_Create возвращала AktPerf.nRec
! - поле "комментарий" к ФО - кем и каким способом сформировано
! - множественное распределение по статьям бюджета
! - pick.inc переделать
! - в Clearing_UpdateP добавить параметр nRec
! - переименовать файлы каталога ofp\rep
! - сделать var-файл для ValutDoc, RefTable
! - удалить aTreeNew из каталога OS
! - перенести изменения в Taxes
! - убрать ofpdef из ofpmacro.vpp
! - файлы _hbf заменить на файлы с расширением .prn
! - сделать public Clearing_GetMeanType1, Clearing_GetPlatMean1, Clearing_MeanTypeByTiDkGal
! - добавить индекс OFPSaldo = RecType + IsLeaf + dSaldo
! - добавить поле OfpPrihod.Direct или SumDebet, SumCredit, HozPrihod.Direct
! - каталог сотрудников (поле куратор) добавить в меню ПК

//-----------------------------------------------
!!!Dict
! - в таблицу OfpProt - поле "описание изменения" (или ссылку на него)

! - OfpPrihod, OfpLimv, OfpSaldoD перенести в одну таблицу OfpSaldI (информация)
!   чтобы можно было обрабатывать одними и теми же функциями
!     Attr                 : word       "Атрибуты",
!     RecType              : word       "Приход, лимиты, фикс.остатки и т.д.",
!     cOFPSaldo            : tNRec      "Ссылка на фактические остатки",
!     dDoc                 : date       "Дата",
!     MeanType             : word       "Тип платежного средства",
!     cPlatMean            : tNRec      "Ссылка на платежное средство",
!     cVal                 : tNRec      "Ссылка на валюту",
!     Summa                : double     "Сумма"
!     Summa1               : double     "Сумма1"
!     Summa2               : double     "Сумма2"
!   OfpSaldR - такие же названия полей, плюс ссылка на модель
! - Потом избавиться от OfpSaldo.dSaldo
! - избавиться от AktPerf
 
! + AktPerf.Direct

OFPPRIHOD
 + OfpPrihod.SumFact, OfpPrihod.HozSumma

OFPSALDR
 + добавить OfpSaldR.Attr (word): 1 - по фиксированному остатку
 + добавить OfpSaldR.dFixSaldo и использовать вместо OfpSaldR.SaldoKredIn

+OFPREF - добавил таблицу

DOCREQ
 + добавить DocReq.cBank - банк контрагента (Пир 101.22872)
AKTOFP
 + назначение платежа - в ФО (Пир 101.19781)
 + в AktOfp и DocReq добавить : Договор (уже есть), ДС, ПКП, ДО (уже есть)
     (Пир 104.1524, 101.25106)
    пока использую cBudget for ДС, cBudVar for ПКП

CLEARING
 + добавить Clearing.Attr (AktOfp.Attr) - cgFopAttr_:
       1- исполнено/не исполнено
       2- влияет на бюджет/не влияет
   пока использую Clearing.cChainClearing
 + добавить Clearing.DocType
      использовать вместо Clearing.SaldoOut
 + добавить Clearing.CourseFrom (см.cgFopCourse_-константы)
 + добавить cSoprHoz

 + del! - добавить индекс AktPerf07 = dSoprHoz (Пир 101.19336)
   для возможности закрытия Фоп, исполненных в закрываемом периоде

fpOborot - индекс для ofpjour3.vpp, Tree_FillAnByStBud
 - fpOborot.cPlansSch, fpOborot.cStBud, fpOborot.TiDk
//-----------------------------------------------
!!!D
! + Переключение на другой тип ДО в operfinp.vip
! + Сделать нормальные параметры в operfinp.vip
! + 'Alt+D' cmDocBas - повесить перенос даты
! + перенести cgOp_FoRecountDFirst из журнала ФО в aOfpOp
! + из Operfinp перенести все в aOfpOp, aDocReq
! + закрытие дня - добавить в Историю
! + работу Фоп с ХО вынести в отдельную vpp-ку и доработать
! + вызов истории поместить в if #IsBetaTester
! + в iHistory добавить параметр Code для IncLevel, DecLevel, CurLevel 
! + историю - в aSaldo.vip
! + пересчет OfpSaldo - убрал update, когда сумма не изменяется
! + точность в макросах изменил с 0.01 на 0.005
! + доработать ofpconv (в том числе добавить iHistory)
! + дебит. задолженность перед кем-то заменил на просто дебит.задолженность
! + восстановление бюджета (__OFP_BudRestore__)

! + доработал интерфейсы настройки ПК, отчетов
! + множественный выбор в фильтрах, возможность отфильтровать по неопределенным статьям
!     + докомпилятор
! + появилась закладка с фильтрами в иер.журнале ФО
! + в валютной Фоп с привязанным исполнением теперь нельзя удалить валюту
! + подправил макросы сравнения double
! + поле "Тип документа" - в окно редактирования Фоп
!     + добавить группировку в ПК "Тип документа"
!     + при конвертации из валюты в валюту сумма распределения
!       в основной Фоп была неправильная
!     + настройки (см.ниже)
! + поле Clearing.SumVal поддерживать не только для вал-руб ФО
!   (для Фоп конвертации ломалось при изменении валюты Фоп или Фоп2)
! + название Фоп в интерфейсе ПК сделал более информативным
! + настраиваемая сортировка в ПК, реестрах (см.__OFP_RepTuneSort__)
! + суммы исполнения, факта - в окно ред-ния ФО, Фоп (см.__OFP_SeeAllSums__)
! + изменение приоритета заявки повесить на Alt+R

! + в интерфейсе выбора ХО при смене фильтра сохранять позицию
! + при привязке исполнения к Фоп с суммой = 0 увеличивать сумму Фоп
!   если сумма Фоп уже <> 0, то не изменять ее
! + перерисовывать нижнюю панель после установки фильтров в инт-се форм.ФО
! + доделать __OFP_NEWATTACHPERF__ (WN 102.13352)
! + возможность переформировать план, факт, резерв по всем ФО (WN 102.12635)
!     добавил константы в fpconst.inc
!     Budget_ClearPlan, Budget_MakePlan - сделать по любому регистру
!     Registers_MakeSome, Registers_ClearSome - сделать формирование факта
! + соответствие Clearing_DocPickOnlyFromPK (GetTiDkGal) и Clearing_DocPickByPs
!   надо использовать Clearing_DocGetTiDkGals
! + "остаток на начало" заменил на "остаток начальный"
!     "остаток" заменил на "остаток конечный"
! + колонка "Есть хозоперация" для Неразнесенного прихода
! + параметры в интерфейс OfpSaldo для позиционирования из ofpansee
! + группировка по дате погашения ФО - в ПК
! + группировка по виду периода - в ПК __OFP_VIDPERIODINPK__
! + группировка по Типу операции (ПК),
! + группировка по Виду платежа (журнал ФО, ПК - Пир 101.24565)
! + сортировка  по Виду платежа (журнал ФО, ПК - Пир 101.24565)
! + доработан интерфейс "Остатки и лимиты платежных средств"
!     + убрал из интерфейса закрытия дня все лишнее, подправил строку статуса
!     + изменил название интерфейса Закрытый период на Закрытие дня/откат
!     + интерфейс переноса дня в архив - этот же интерфейс
!     + избавится от интерфейса OfpPeriodToArc
! + при изменении суммы АПП векселя изменять сумму распределения в исполнении (Пир 102.40875)
! + группировка и фильтрация по полю Вид платежа ФО в ПК и реестре ФО
! + сбивалась сортировка на уровнях по алфавиту в построителе деревьев
! + суммы исполнения, факта - в окно ред-ния ФО, Фоп
! + группировка по Виду периода в журнале ФО, интерфейсе ПК
! + заменил названия "Остаток на начало", "Остаток" на "Остаток начальный", "Остаток конечный"
! + в интерфейсе ПК при сравнении моделей остатки на модели пересчитывались,
!   а суммы в интерфейсе - нет
! + в функции KatPurpose_FromDogovor перед добавлением проверять наличие записи
! + отображать цветом рассчитанные остатки, которые по фиксированным остаткам
! + разрешить выбор Договора в окне редактирования ФО (Пир 106.7586) __Ofp_FoCanPickDog__
! + на первый день периода (план., закр.) фикс. остаток не учитывается
!check + доделать докомпилятор для поля "Тип документа"
! + переделать aNewPlp
! + в Clearing_Insert в Clearing_SetStatusAfter заменить Clearing на ClearingTmp (21.04.2004)
! + Clearing_MakeFactOnSum - добавил SpGrPlD_Copy - копируем привязку к группам ПС
! + номер ФО - в название окна "Протокол изменения ФО"

! + в ПК сортировка по умолчанию - кроме приоритета, еще и дата Фоп
! + в ПК сортировка действует и для НП 
! + в ПК неправильно определялась дата при Alt+O на уровне с периодом
! + ofpsaldp.vip - F3 на НП - возможность разнести ХО по Фоп
! + вместо удаления стат. прихода и НП, удаляем подвязку ХО к НП с уменьшением суммы НП
! + лист и Неразнесенный приход - запретим те операции, кот.для Фоп

! - при перевыборе документа править поле Фоп "Тип документа"
! - интерфейс привязки ХО - добавить панель с платежками и поместить во встроенный интерфейс
! - сделать новый интерфейс Закрытие дня/Архив - наподобие формирования плат.доков
!   см. __OFP_CLOSEDAY_NEW__
! - в aNewPlp показывать изменения в бюджете по статьям
! - отчет по распределению/рассогласованию ХО и Фоп - наподобие Акта сверки
! - заменить вызовы AktOfp_GetFirstADate на AktOfp_GetFirstADateForEdit
! - сделать возможность привязки к докам одной статьи с разными аналитиками
! - в Clearing_DocGetTiDkGals анализировать направление Фоп
! - Clearing_CanTiDkGal - проверить направление для Фоп конвертации
! - в интерфейсе формирования ФО отображать список сформированных ФО (ДО->ФО)
!   или причину, по которой ФО не было сформировано
! - при формировании платежек (журнал ФО, ПК) отображать список сформированных
!   платежек (Фоп->платежка) или причину, по которой платежка не сформировалась
! - в AktPerf_OnChangeDSoprHoz разделять Фоп, если ХО оплатили в закр.периоде
! - при вычислении факта бюджета учитывать Clearing_HasAffectOnFactFO
! - доработать интерфейс "Остатки и лимиты платежных средств"
!     - изменить название "Обновление остатков"
!     - фиксированные остатки загружать по сальдо за день/за месяц
!     - неразнесенный приход - по выбранным ХО
!     - лимиты - по выбранной аналитике и бюджету
!     - в рассчитанные остатки в нижнюю панель добавить Неразнесенный приход
! - подбор Фоп к ХО сделать с учетом точности (Clearing_FindByFOandSHBuf)
! - добавить закладку с Неразнесенным приходом
!     - в интерфейс ПК
!     - в интерфейс OfpSaldo
! - сделать функцию в журнале ФО - "подобрать ФО для взаимозачета по критериям"
! - сделать визуализацию для формирования ФО по периодическим заявкам
! - за 20 сек 1500 записей в ПК отбирает с уровнями Вид периода/Тип документа
! - сделать функцию "Подбор ФО для взаимозачета"
! - доделать objTreeRep - новый вид графика - __TreeRep_New__

! - при переводе ФО в исполняемый привязываемые платежи (Фоп) распределять по статьям ФО
! - если для каждой Фоп своя платежка - запретить выбор типа документа по второй Фоп
! - для Фоп, если настройка "один док.к обеим Фоп", прятать неисп.-мые поля "Тип документа"
! - дополнить Список документов, формируемых только из ПК - Clearing_DocGetOnlyFromPK
! - ofpbydr.vip, ofpbydo.vip - в cmInit не срабатывала ClearFieldState
! - перенести в место вызова из GetOFPTitle параметр _DocType
! - для пор.на конв.валюты (36) в новом интерфейсе правильно отображать привязку к ХО
!   и создавать один док по обеим Фоп (когда формируем по ФО)

! - глючит настройка "Формирование обязательств по ДО осуществлять на сумму"
!   в значении "долга по платежам (не оплачено по ДО)"
!   при подвязке ДО к платежному документу
! - а если установлена "При переводе ФО в "исполняемый" все платежи ДО
    привязывать к ФО", то у ФО появляются 2 платежки - 1-ая цепляется
    при переводе в статус исполняемый, а 2-ая - не знает о 1-ой и
    пытается тоже привязаться... но увы - на 0-ую сумму...
 ПОСЛЕДНИЕ ДВЕ - исправятся, если распределение ХО по ФО вызывать до
                 того, как в ХО проставится ссылка на ДО
! - убрать ChangeStatSumma

! - нужен новый статус для ФО и Фоп - редактировать нельзя, разноску по статьям
!   производить можно

!!! - на модели факт и исполнение Фоп считаются = 0 (проявляется при проверке
!     целостности таблиц ПК)
!!! - Конвертация - в поле "Направление" ФО из поля "Вид платежа"
!!! - не учитывается закрытый период

! - доработать интерфейс "Остатки и лимиты" - __Ofp_SaldoFromOutside__
! - сделать "График по текущему ПС" (остатки, лимиты, н/приход)
! - в интерфейсе "ПК" добавить создание ФО (или Фоп) конвертации для погашения дефицита
!   и функции сделать нормально работающими
! - закрытие дня - через мастер с папками "Долг контрагента", "Долг наш"
! - в AktOfp_CanForDODate не было getfirst BaseDoc, а поле этой записи учитывалось

!wasErrors
 + Clearing_DocIsOnlyForConvert - параметр не учитывался - но ошибка не проявится,
   так как все сходится - текущая запись KatDoc.TiDkGal

//-----------------------------------------------
 - Разноска по статьям бюджета
//-----------------------------------------------
 + привязка к статьям - интерфейс aOfpBudNew.vip 
 - изменение сумм - интерфейс aBudByDoc.vip 

//-----------------------------------------------
