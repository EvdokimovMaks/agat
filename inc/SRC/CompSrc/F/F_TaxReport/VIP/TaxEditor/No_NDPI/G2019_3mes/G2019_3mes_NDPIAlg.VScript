//------------------------------------------------------------------------------------------------------------
//                                                                                    (c) ™Æ‡ØÆ‡†Ê®Ô É†´†™‚®™†
// É†´†™‚®™† 9.1 - ¨Æ§„´Ï "ù´•™‚‡Æ≠≠†Ô Æ‚Á•‚≠Æ·‚Ï"
// Ä´£Æ‡®‚¨Î ‡†·Á•‚† : "Ñ•™´†‡†Ê®Ô ØÆ çÑèà 2019 · 3 ¨•·ÔÊ†"
//------------------------------------------------------------------------------------------------------------


//============================================================================================================
//#region ëÖêÇàëçõÖ åÖíéÑõ
//------------------------------------------------------------------------------------------------------------
@Script GetStrVal(fld : string) : string;
@begin
  Result := XMLMAP.GetAttrValueByName(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetDblVal(fld : string) : double;
@begin
  Result := Double(XMLMAP.GetAttrValueByName(fld));
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetIntVal(fld : string) : integer;
@begin
  Result := Integer(XMLMAP.GetAttrValueByName(fld));
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetFldVis(fld : string) : boolean;
@begin
  Result := XMLMAP.GetAttrVisByName(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script SetFldVal(fld:string; val:variant);
@begin
  XMLMAP.SetVariantAttrValueByName_Formula(fld, val, 2);
@end.

//------------------------------------------------------------------------------------------------------------
@Script SetFldVis(fld : string;vis : boolean);
@begin
  XMLMAP.SetAttrVisByName(fld, vis);
@end.

//------------------------------------------------------------------------------------------------------------
@Script DblToStr(fld : double;digits : longint) : string;
@begin
  if (Pos('.', String(fld, 20, digits)) > 0)
    Result := Rtrim(Rtrim(Trim(String(fld, 20, digits)), '0'), '.');
  else
    Result := Trim(String(fld, 20, digits));
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetCountFld(fld : string) : longint;
@begin
  Result := XMLMap.GetNodeCountByName(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetIter(iter : longint) : string;
@begin
  Result := '';

  if (iter > 0)
    Result := '[' + String(iter) + ']';
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetStrNull(fld : string) : boolean;
@begin
  Result := XMLMAP.GetIsNullAttrValueByName(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetStrValFormat(fld : string) : string;
@begin
  var bufRes: string;

  bufRes := Trim(String(XMLMAP.GetAttrValueByName(fld)));

  if (bufRes = '')
  then Result := '0'
  else if (Double(bufRes) < 0)
       then Result := '('+bufRes+')'
       else Result := bufRes;
@end.

//------------------------------------------------------------------------------------------------------------
@Script MessageErrorStop_ALG(mesMesAdrXML, mesPole, mesMes : string; mesCountIter : integer = 0) : boolean;
@begin
  MesError.InsertMesError(mesMesAdrXML, Comp(0), '', mesPole, mesMes, mesCountIter);
  Result := True;
@end.
//#endregion ëÖêÇàëçõÖ åÖíéÑõ
//************************************************************************************************************


//============================================================================================================
//#region On_Visable ÑÖâëíÇàü ÇõèéãçüÖåõÖ èêà ìëíÄçéÇäÖ ÇàÑàåéëíà èéãÖâ
//------------------------------------------------------------------------------------------------------------
@Script On_Visable : boolean;
  //==========================================================================================================
  //#region ëÖêÇàë On_Visable
  //----------------------------------------------------------------------------------------------------------
  #declare IfVis(adrIfVis)
    SetFldVis(#adrIfVis, not GetStrNull(#adrIfVis));
  #end

  #declare SetVisF(adrIfVis)
    SetFldVis(#adrIfVis, False);
  #end

  #declare SetVisFCon(adrIfVis)
  {
    SetFldVis(#adrIfVis, False);
    continue;
  }
  #end

  #declare IfNullSetVisFCon(adrIfVis_1, adrIfVis_2)
    if (GetStrNull(#adrIfVis_1))
    {
      SetFldVis(#adrIfVis_2, False);
      continue;
    }
  #end


  #declare SetVisT(adrIfVis)
    SetFldVis(#adrIfVis, True);
  #end

  //----------------------------------------------------------------------------------------------------------
  // è‡Æ¢•‡™† ≠† ·ÆÆ‚¢•‚·‚¢®• ß≠†Á•≠®Ô ØÆ´Ô îÆ‡¨ê•Æ‡£ „·´Æ¢®Ô¨
  function _FormReorg : boolean;
  {
    var val : Integer;
    val := GetIntVal('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/îÆ‡¨ê•Æ‡£');

    Result := False;
    Result := ((val = 1) or (val = 2) or (val = 3) or (val = 5) or (val = 6));
  }
  //#endregion ëÖêÇàë On_Visable
  //**********************************************************************************************************
@begin
  var tBool, tBool_2, tBool_3 :boolean;
  var bufAdr, bufAdr_2, bufAdr_3, bufAdr_4 : string;
  var i, j, k, q, count, count_2, count_3, count_4 : longint;
  var bufInt : integer;

  //==========================================================================================================
  //#region àëèêÄÇãÖçàÖ ÇàÑàåéëíà èéãÖâ èéëãÖ ëíÄêéÉé èÄíóÄ
  //----------------------------------------------------------------------------------------------------------
  if not GetFldVis('î†©´/xsi:noNamespaceSchemaLocation')
  {
    #SetVisT('î†©´'                                       );
    #SetVisF('î†©´/xmlns:xsi'                             );
    #SetVisF('î†©´/xsi:noNamespaceSchemaLocation'         );
    #SetVisT('î†©´/à§î†©´'                                );
    #SetVisT('î†©´/Ç•‡·è‡Æ£'                              );
    #SetVisT('î†©´/Ç•‡·îÆ‡¨'                              );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚'                              );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/äçÑ'                          );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/Ñ†‚†ÑÆ™'                      );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/è•‡®Æ§'                       );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/é‚Á•‚ÉÆ§'                     );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/äÆ§çé'                        );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÆ¨äÆ‡‡'                      );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/èÆå•·‚„'                      );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè'                         );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã'                    );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ç†®¨é‡£'            );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/àççûã'              );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/äèè'                );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/îÆ‡¨ê•Æ‡£');
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèîã'                    );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèîã/àççîã'              );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèîã/îàé'                );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèîã/îàé/î†¨®´®Ô'        );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèîã/îàé/à¨Ô'            );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚'                    );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/è‡èÆ§Ø'             );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé/î†¨®´®Ô'        );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé/à¨Ô'            );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/ë¢è‡•§/ç†®¨ÑÆ™'     );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà'                         );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì'                );

    count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì');
    for (i := 0; i < count; i++)
    {
      bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì' + getIter(i);
      #SetVisT(bufAdr           );
      #SetVisT(bufAdr + '/äÅä'  );
      #SetVisT(bufAdr + '/éäíåé');
      #SetVisT(bufAdr + '/ç†´èì');
    }

    count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚');
    for (i := 0; i < count; i++)
    {
      bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚' + getIter(i);
      #SetVisT(bufAdr + '/äÆ§Ñèà');
      #SetVisT(bufAdr + '/äÅä'   );
      #SetVisT(bufAdr + '/éäÖà'  );

      count_2 := GetCountFld(bufAdr + '/èÆ™ê†·Áç†´');
      for (j := 0; j < count_2; j++)
      {
        bufAdr_2 := bufAdr + '/èÆ™ê†·Áç†´' + getIter(j);
        #SetVisT(bufAdr_2                );
        #SetVisT(bufAdr_2 + '/éäíåé'     );
        #SetVisT(bufAdr_2 + '/ë•‡ã®Êç•§‡');
        #SetVisT(bufAdr_2 + '/çÆ¨ã®Êç•§‡');
        #SetVisT(bufAdr_2 + '/Ç®§ã®Êç•§‡');
        #SetVisT(bufAdr_2 + '/èÆ™†ßÑ¨'   );
        #SetVisT(bufAdr_2 + '/ä≠§Ø®'     );
        #SetVisT(bufAdr_2 + '/äÆÌ‰äÊ'    );
        #SetVisT(bufAdr_2 + '/äÆÌ‰ä¢'    );
        #SetVisT(bufAdr_2 + '/ë‚•Ø•≠Ïë¢' );
        #SetVisT(bufAdr_2 + '/äÆÌ‰äß'    );
        #SetVisT(bufAdr_2 + '/äÆÌ‰ä§¢'   );
        #SetVisT(bufAdr_2 + '/äÆÌ‰ä™†≠'  );
        #SetVisT(bufAdr_2 + '/ç†´à·Á®·´' );
        #SetVisT(bufAdr_2 + '/ç†´ÇÎÁ'    );
        #SetVisT(bufAdr_2 + '/ç†´ìØ´'    );

        count_3 := GetCountFld(bufAdr_2 + '/ÑÆ°ç•‰‚ìÁç•§‡');
        for (k := 0; k < count_3; k++)
        {
          bufAdr_3 := bufAdr_2 + '/ÑÆ°ç•‰‚ìÁç•§‡' + getIter(k);
          #SetVisT(bufAdr_3 + '/äÆ§é·≠Æ¢' );
          #SetVisT(bufAdr_3 + '/äÆ´ç•‰‚èç');
        }

        count_3 := GetCountFld(bufAdr_2 + '/ÑÆ°ç•‰‚á†´•¶');
        for (k := 0; k < count_3; k++)
        {
          bufAdr_3 := bufAdr_2 + '/ÑÆ°ç•‰‚á†´•¶' + getIter(k);
          #SetVisT(bufAdr_3 + '/ç†®¨á´¶'     );
          #SetVisT(bufAdr_3 + '/É´„°è´†·‚'   );
          #SetVisT(bufAdr_3 + '/è´Æ‚≠ç•‰‚'   );
          #SetVisT(bufAdr_3 + '/èÆ™†ß†‚Ñ¨'   );
          #SetVisT(bufAdr_3 + '/ë‚•Ø•≠Ïë¢ß'  );
          #SetVisT(bufAdr_3 + '/äÆÌ‰ä§'      );
          #SetVisT(bufAdr_3 + '/äÆ´ç†´è•‡'   );
          #SetVisT(bufAdr_3 + '/äÆÌ‰ä§¢'     );
          #SetVisT(bufAdr_3 + '/ç†´à·Á®·´á´¶');

          count_4 := GetCountFld(bufAdr_3 + '/äÆ´ç•‰‚é·≠');
          for (q := 0; q < count_4; q++)
          {
            bufAdr_4 := bufAdr_3 + '/äÆ´ç•‰‚é·≠' + getIter(q);
            #SetVisT(bufAdr_4               );
            #SetVisT(bufAdr_4 + '/äÆ§é·≠Æ¢' );
            #SetVisT(bufAdr_4 + '/äÆ´ç•‰‚èç');
          }
        }
      }
    }

    count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß');
    for (i := 0; i < count; i++)
    {
      bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß' + getIter(i);
      #SetVisT(bufAdr + '/äÆ§Ñèà'   );
      #SetVisT(bufAdr + '/äÅä'      );
      #SetVisT(bufAdr + '/éäÖà'     );
      #SetVisT(bufAdr + '/ë„¨à·Áç†´');
      #SetVisT(bufAdr + '/ë„¨ç†´ìØ´');
      #SetVisT(bufAdr + '/äÆÌ‰é¢'   );
      #SetVisT(bufAdr + '/äÆÌ‰ä£Ø≠' );
      #SetVisT(bufAdr + '/äÆÌ‰ä¨†≠' );
      #SetVisT(bufAdr + '/äÆÌ‰äÆ´ÑÆ°');
      count_2 := GetCountFld(bufAdr + '/èÆ™ê†·Áç†´');
      for (j := 0; j < count_2; j++)
      {
        bufAdr_2 := bufAdr + '/èÆ™ê†·Áç†´' + getIter(j);
        #SetVisT(bufAdr_2                );
        #SetVisT(bufAdr_2 + '/éäíåé'     );
        #SetVisT(bufAdr_2 + '/ë•‡ã®Êç•§‡');
        #SetVisT(bufAdr_2 + '/çÆ¨ã®Êç•§‡');
        #SetVisT(bufAdr_2 + '/Ç®§ã®Êç•§‡');
        #SetVisT(bufAdr_2 + '/ë‚•Ø•≠Ïë¢£');
        #SetVisT(bufAdr_2 + '/á≠†Á•≠Ö„‚' );
        #SetVisT(bufAdr_2 + '/äÆÌ‰Ñ£'    );
        #SetVisT(bufAdr_2 + '/ë„¨à·Áç†´' );
        #SetVisT(bufAdr_2 + '/ë„¨ç†´ÇÎÁ' );
        #SetVisT(bufAdr_2 + '/ë„¨ç†´ìØ´' );
        count_3 := GetCountFld(bufAdr_2 + '/äÆ´Ñèàá†´');
        for (k := 0; k < count_3; k++)
        {
          bufAdr_3 := bufAdr_2 + '/äÆ´Ñèàá†´' + getIter(k);
          #SetVisT(bufAdr_3                  );
          #SetVisT(bufAdr_3 + '/ç†®¨á´¶'     );
          #SetVisT(bufAdr_3 + '/É´„°è´†·‚'   );
          #SetVisT(bufAdr_3 + '/è´Æ‚≠ìÇëÎ‡ÏÔ');
          #SetVisT(bufAdr_3 + '/á≠†Á•≠®•ä¢£' );
          #SetVisT(bufAdr_3 + '/á≠†Á•≠®•ä‡'  );
          #SetVisT(bufAdr_3 + '/á≠†Á•≠®•ä£ß' );
          #SetVisT(bufAdr_3 + '/á≠†Á•≠®•ä†·' );
          #SetVisT(bufAdr_3 + '/á≠†Á•≠®•äÆ‡ß');
          #SetVisT(bufAdr_3 + '/äÆÌ‰ä·'      );
          #SetVisT(bufAdr_3 + '/ç†´à·Á®·´á´¶');

          count_4 := GetCountFld(bufAdr_3 + '/äÆ´Ñèàá†´é·≠');
          for (q := 0; q < count_4; q++)
          {
            bufAdr_4 := bufAdr_3 + '/äÆ´Ñèàá†´é·≠' + getIter(q);
            #SetVisT(bufAdr_4              );
            #SetVisT(bufAdr_4 + '/äÆ§é·≠Æ¢');
            #SetVisT(bufAdr_4 + '/äÆ´Ñèà'  );
          }
        }
      }
    }

    count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢');
    for (i := 0; i < count; i++)
    {
      bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢' + getIter(i);
      #SetVisT(''+ bufAdr + '/äÆ§Ñèà'      );
      #SetVisT(''+ bufAdr + '/äÅä'         );
      #SetVisT(''+ bufAdr + '/éäÖà'        );
      #SetVisT(''+ bufAdr + '/éäíåé'       );
      #SetVisT(''+ bufAdr + '/ë•‡ã®Êç•§‡'  );
      #SetVisT(''+ bufAdr + '/çÆ¨ã®Êç•§‡'  );
      #SetVisT(''+ bufAdr + '/Ç®§ã®Êç•§‡'  );
      #SetVisT(''+ bufAdr + '/ç†®¨å•·‚'    );
      #SetVisT(''+ bufAdr + '/ç†ÁÑÆ°ìÇë'   );
      #SetVisT(''+ bufAdr + '/ë‚Æ®¨Ö§èàå®≠');
      #SetVisT(''+ bufAdr + '/ç†´Å†ß†'     );
      #SetVisT(''+ bufAdr + '/ç†´à·Á®·´'   );

      count_2 := GetCountFld(bufAdr + '/äÆ´èàç†´é·≠');
      for (j := 0; j < count_2; j++)
      {
        bufAdr_2 := bufAdr + '/äÆ´èàç†´é·≠' + getIter(j);
        #SetVisT(bufAdr_2              );
        #SetVisT(bufAdr_2 + '/äÆ§é·≠Æ¢');
        #SetVisT(bufAdr_2 + '/äÆ´èàç†´');
      }
    }

    count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´');
    for (i := 0; i < count; i++)
    {
      bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´' + getIter(i);
      #SetVisT(bufAdr + '/äÆ§Ñèà'              );
      #SetVisT(bufAdr + '/äÅä'                 );
      #SetVisT(bufAdr + '/éäÖà'                );
      #SetVisT(bufAdr + '/ç†´ë‚†¢™†'           );
      #SetVisT(bufAdr + '/ê†·Áç†´ìØ´'          );
      #SetVisT(bufAdr + '/ê†·Áç†´ìØ´/ë‚Æ®¨Ö§èà');
      #SetVisT(bufAdr + '/ê†·Áç†´ìØ´/ç†´Å†ß†'  );
      #SetVisT(bufAdr + '/ê†·Áç†´ìØ´/ç†´à·Á®·´');

      count_2 := GetCountFld(bufAdr + '/äÆ´èàìÁç†´');
      for (j := 0; j < count_2; j++)
      {
        bufAdr_2 := bufAdr + '/äÆ´èàìÁç†´' + getIter(j);
        #SetVisT(bufAdr_2                );
        #SetVisT(bufAdr_2 + '/éäíåé'     );
        #SetVisT(bufAdr_2 + '/ë•‡ã®Êç•§‡');
        #SetVisT(bufAdr_2 + '/çÆ¨ã®Êç•§‡');
        #SetVisT(bufAdr_2 + '/Ç®§ã®Êç•§‡');

        count_3 := GetCountFld(bufAdr_2 + '/äÆ´èàç†´é·≠');
        for (k := 0; k < count_3; k++)
        {
          bufAdr_3 := bufAdr_2 + '/äÆ´èàç†´é·≠' + getIter(k);
          #SetVisT(bufAdr_3              );
          #SetVisT(bufAdr_3 + '/äÆ§é·≠Æ¢');
          #SetVisT(bufAdr_3 + '/äÆ´èàç†´');
        }
      }
    }

    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È'               );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·ÂÑÆ°è•‡'  );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/é·‚çèç†Áè•‡'   );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/é·‚çèäÆ≠è•‡'   );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·ÂÑèàè•‡'  );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/Ç≠•‡•†´ê†·ÂÑèà');
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/äÆ·¢ê†·ÂÑèà'   );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/äÆ·¢ê†·ÂÑ‡'    );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·Âè•‡é°È'  );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/äÆ·¢à≠ê†·Âè•‡' );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/ê†·Âé°ÈÑÆ°è•‡' );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§'               );
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/éäÖà'          );

    count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§');
    for (i := 0; i < count; i++)
    {
      bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§' + getIter(i);
      #SetVisT(bufAdr                   );
      #SetVisT(bufAdr + '/äÆ§Ñèà'       );
      #SetVisT(bufAdr + '/äÆ´®ÁÑèà'     );
      #SetVisT(bufAdr + '/ÑÆ´ÔÑèàé°ÈäÆ´');
    }

    count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£');
    for (i := 0; i < count; i++)
    {
      bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£' + getIter(i);
      #SetVisT(bufAdr + '/äÅä'                             );
      #SetVisT(bufAdr + '/ë•‡ã®Êç•§‡'                      );
      #SetVisT(bufAdr + '/çÆ¨ã®Êç•§‡'                      );
      #SetVisT(bufAdr + '/Ç®§ã®Êç•§‡'                      );
      #SetVisT(bufAdr + '/éäÖà'                            );
      #SetVisT(bufAdr + '/éäíåé'                           );
      #SetVisT(bufAdr + '/è‡®ß≠ä‚§'                        );
      #SetVisT(bufAdr + '/Ñ†≠Ñèàì£'                        );
      #SetVisT(bufAdr + '/ê†·Áç†´ìØ´'                      );
      #SetVisT(bufAdr + '/ê†·Áç†´ìØ´/à·Á®·´ìÁì£'           );
      #SetVisT(bufAdr + '/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·Âéíè•‡Ç·');

      count_2 := GetCountFld(bufAdr + '/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ');
      for (j := 0; j < count_2; j++)
      {
        bufAdr_2 := bufAdr + '/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ' + getIter(j);
        #SetVisT(bufAdr_2              );
        #SetVisT(bufAdr_2 + '/äÆ§Ñèà'  );
        #SetVisT(bufAdr_2 + '/äÆ§é·≠Æ¢');
        #SetVisT(bufAdr_2 + '/äÆ´Ñèà'  );
      }

      count_2 := GetCountFld(bufAdr + '/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡');
      for (j := 0; j < count_2; j++)
      {
        bufAdr_2 := bufAdr + '/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡' + getIter(j);
        #SetVisT(bufAdr_2                   );
        #SetVisT(bufAdr_2 + '/ç†Áè‡†¢ç†´ÇÎÁ');
        #SetVisT(bufAdr_2 + '/ç†´ÇÎÁç†Á'    );
        #SetVisT(bufAdr_2 + '/äÆ≠è‡†¢ç†´ÇÎÁ');
      }
    }
  }

  #SetVisF('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèîã');
  //#endregion àëèêÄÇãÖçàÖ ÇàÑàåéëíà èéãÖâ èéëãÖ ëíÄêéÉé èÄíóÄ
  //**********************************************************************************************************


  //==========================================================================================================
  //#region íàíìãúçõâ ãàëí
  //----------------------------------------------------------------------------------------------------------
  #IfVis('î†©´/ÑÆ™„¨•≠‚/ë¢çè/í´‰');

  if not GetStrNull('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/îÆ‡¨ê•Æ‡£')
  {
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã');

    if _FormReorg
    {
      #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/àççûã');
      #SetVisT('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/äèè'  );
    }
    else
    {
      #IfVis('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/àççûã');
      #IfVis('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/äèè'  );
    }
  }
  else #SetVisF('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã');

  bufInt := GetIntVal('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/è‡èÆ§Ø');

  if     (bufInt = 2)
     or ((bufInt = 1) and GetFldVis('î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã'))
     or (    not GetStrNull('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé/î†¨®´®Ô')
         and not GetStrNull('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé/à¨Ô'    ))
  {
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé');
    #IfVis  ('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé/é‚Á•·‚¢Æ');
  }
  else #SetVisF('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé');

  if (bufInt = 2)
  {
    #SetVisT('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/ë¢è‡•§'        );
    #IfVis  ('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/ë¢è‡•§/ç†®¨é‡£');
  }
  else #SetVisF('î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/ë¢è‡•§');
  //#endregion íàíìãúçõâ ãàëí
  //**********************************************************************************************************


  //==========================================================================================================
  //#region êÄáÑÖã 1
  //----------------------------------------------------------------------------------------------------------
  tBool := False;
  count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì');

  for (i := 0; i < count; i++)
  {
    bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì'+getIter(i);

    if    (not GetStrNull(bufAdr+'/äÅä'  )
       and not GetStrNull(bufAdr+'/éäíåé')
       and not GetStrNull(bufAdr+'/ç†´èì'))
    then { #SetVisT(bufAdr); tBool := True;}
    else #SetVisF(bufAdr);
  }

  if (not tBool) #SetVisT('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì');
  //#endregion êÄáÑÖã 1
  //**********************************************************************************************************


  //==========================================================================================================
  //#region êÄáÑÖã 2
  //----------------------------------------------------------------------------------------------------------
  count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚');
  for (i := 0; i < count; i++)
  {
    // à·Áç†´ç•‰‚ == 03.1 ê†ß§•´ 2
    bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+getIter(i);

    #IfNullSetVisFCon(bufAdr+'/äÆ§Ñèà', bufAdr);
    #IfNullSetVisFCon(bufAdr+'/äÅä'   , bufAdr);
    #IfNullSetVisFCon(bufAdr+'/éäÖà'  , bufAdr);

    // èÆ™ê†·Áç†´
    tBool := False;
    count_2 := GetCountFld(bufAdr+'/èÆ™ê†·Áç†´');

    for (j := 0; j < count_2; j++)
    {
      bufAdr_2 := bufAdr+'/èÆ™ê†·Áç†´'+getIter(j);

      #IfNullSetVisFCon(bufAdr_2+'/éäíåé'     , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë•‡ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/çÆ¨ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/Ç®§ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/èÆ™†ßÑ¨'   , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ä≠§Ø®'     , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/äÆÌ‰äÊ'    , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/äÆÌ‰ä¢'    , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë‚•Ø•≠Ïë¢' , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/äÆÌ‰äß'    , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/äÆÌ‰ä§¢'   , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/äÆÌ‰ä™†≠'  , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ç†´à·Á®·´' , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ç†´ÇÎÁ'    , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ç†´ìØ´'    , bufAdr_2)

      // ÑÆ°ç•‰‚ìÁç•§‡ == 04.1.1 ê†ß§•´ 2.1.1
      count_3 := GetCountFld(bufAdr_2+'/ÑÆ°ç•‰‚ìÁç•§‡');

      for (k := 0; k < count_3; k++)
      {
        bufAdr_3 := bufAdr_2+'/ÑÆ°ç•‰‚ìÁç•§‡'+getIter(k);

//î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚/èÆ™ê†·Áç†´/ÑÆ°ç•‰‚ìÁç•§‡[1]/äÆ´ç•‰‚èç

        if    (not GetStrNull(bufAdr_3+'/äÆ§é·≠Æ¢' )
           and not GetStrNull(bufAdr_3+'/äÆ´ç•‰‚èç'))
        then #SetVisT(bufAdr_3)
        else #SetVisF(bufAdr_3);
      }

      // ÑÆ°ç•‰‚á†´•¶ == 05.1.1.1 ê†ß§•´ 2.1.2
      count_3 := GetCountFld(bufAdr_2+'/ÑÆ°ç•‰‚á†´•¶');

      for (k := 0; k < count_3; k++)
      {
        bufAdr_3 := bufAdr_2+'/ÑÆ°ç•‰‚á†´•¶'+getIter(k);

        #IfNullSetVisFCon(bufAdr_3+'/ç†®¨á´¶'     , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/É´„°è´†·‚'   , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/è´Æ‚≠ç•‰‚'   , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/èÆ™†ß†‚Ñ¨'   , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/ë‚•Ø•≠Ïë¢ß'  , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/äÆÌ‰ä§'      , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/äÆ´ç†´è•‡'   , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/äÆÌ‰ä§¢'     , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/ç†´à·Á®·´á´¶', bufAdr_3)

        tBool_2 := False;
        count_4 := GetCountFld(bufAdr_3+'/äÆ´ç•‰‚é·≠');

        for (q := 0; q < count_4; q++)
        {
          bufAdr_4 := bufAdr_3+'/äÆ´ç•‰‚é·≠'+getIter(q);

          if    (not GetStrNull(bufAdr_4+'/äÆ§é·≠Æ¢' )
             and not GetStrNull(bufAdr_4+'/äÆ´ç•‰‚èç'))
          then { #SetVisT(bufAdr_4); tBool_2 := True; }
          else #SetVisF(bufAdr_4);
        }

        if (not tBool_2) #SetVisFCon(bufAdr_3)

        #IfVis(bufAdr_3+'/ù‰íÆ´Èè´†·‚');
        #IfVis(bufAdr_3+'/è‡Æ≠®Êá´¶'  );

        #SetVisT(bufAdr_3);
      }

      tBool := True;
      #SetVisT(bufAdr_2);
    }

    if tBool
    then #SetVisT(bufAdr)
    else #SetVisF(bufAdr);
  }
  //#endregion êÄáÑÖã 2
  //**********************************************************************************************************


  //==========================================================================================================
  //#region êÄáÑÖã 3
  //----------------------------------------------------------------------------------------------------------
  count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß');

  for (i := 0; i < count; i++)
  {
    bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+getIter(i);

    #IfNullSetVisFCon(bufAdr+'/äÆ§Ñèà'   , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/äÅä'      , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/éäÖà'     , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/ë„¨à·Áç†´', bufAdr)
    #IfNullSetVisFCon(bufAdr+'/ë„¨ç†´ìØ´', bufAdr)
    #IfNullSetVisFCon(bufAdr+'/äÆÌ‰é¢'   , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/äÆÌ‰ä£Ø≠' , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/äÆÌ‰ä¨†≠' , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/äÆÌ‰äÆ´ÑÆ°', bufAdr)
    #IfVis(bufAdr+'/ë„¨ç†´ÇÎÁ'  );
    #IfVis(bufAdr+'/äÆÌ‰äË‰´„'  );
    #IfVis(bufAdr+'/äÆ´å£™'     );
    #IfVis(bufAdr+'/ë‚†¢™†Ç'    );
    #IfVis(bufAdr+'/èÆ™†ß†‚í£'  );
    #IfVis(bufAdr+'/ñ•≠†ñ£'     );
    #IfVis(bufAdr+'/ë‡ñ•≠†ñ¢'   );
    #IfVis(bufAdr+'/ê†·Áñ•≠†ñÌ');
    #IfVis(bufAdr+'/ñ•≠†ñ™'     );
    #IfVis(bufAdr+'/ì·´ë‚†¢è≠'  );
    #IfVis(bufAdr+'/äÆÌ‰ä£Ø'    );
    #IfVis(bufAdr+'/äÆÌ‰ä™¨'    );
    tBool := False;
    count_2 := GetCountFld(bufAdr+'/èÆ™ê†·Áç†´');

    for (j := 0; j < count_2; j++)
    {
      bufAdr_2 := bufAdr+'/èÆ™ê†·Áç†´'+getIter(j);

      #IfNullSetVisFCon(bufAdr_2+'/éäíåé'     , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë•‡ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/çÆ¨ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/Ç®§ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë„¨à·Áç†´' , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë„¨ç†´ìØ´' , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë‚•Ø•≠Ïë¢£', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/á≠†Á•≠Ö„‚' , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/äÆÌ‰Ñ£'    , bufAdr_2)
      #IfVis(bufAdr_2+'/ë„¨ç†´ÇÎÁ'    );
      tBool_2 := False;
      count_3 := GetCountFld(bufAdr_2+'/äÆ´Ñèàá†´');

      for (k := 0; k < count_3; k++)
      {
        bufAdr_3 := bufAdr_2+'/äÆ´Ñèàá†´'+getIter(k);

        #IfNullSetVisFCon(bufAdr_3+'/ç†®¨á´¶'     , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/É´„°è´†·‚'   , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/è´Æ‚≠ìÇëÎ‡ÏÔ', bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/á≠†Á•≠®•ä¢£' , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/á≠†Á•≠®•ä‡'  , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/á≠†Á•≠®•ä£ß' , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/á≠†Á•≠®•ä†·' , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/á≠†Á•≠®•äÆ‡ß', bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/äÆÌ‰ä·'      , bufAdr_3)
        #IfNullSetVisFCon(bufAdr_3+'/ç†´à·Á®·´á´¶', bufAdr_3)

        tBool_3 := False;
        count_4 := GetCountFld(bufAdr_3+'/äÆ´Ñèàá†´é·≠');

        for (k := 0; k < count_4; k++)
        {
          bufAdr_4 := bufAdr_3+'/äÆ´Ñèàá†´é·≠'+getIter(k);

          if    (not GetStrNull(bufAdr_4+'/äÆ§é·≠Æ¢')
             and not GetStrNull(bufAdr_4+'/äÆ´Ñèà'  ))
          then { #SetVisT(bufAdr_4); tBool_3 := True; }
          else #SetVisF(bufAdr_4);
        }

        if (not tBool_3) #SetVisFCon(bufAdr_3)

        tBool_2 := True;
        #SetVisT(bufAdr_3)
      }

      if (not tBool_2) #SetVisFCon(bufAdr_2)

      #IfVis(bufAdr_2+'/äÆÌ‰ä™¨');

      tBool := True;
      #SetVisT(bufAdr_2)
    }

    if (not tBool) #SetVisFCon(bufAdr)

    #IfVis(bufAdr+'/èÆ™†ß†‚í£');

    #SetVisT(bufAdr);
  }
  //#endregion êÄáÑÖã 3
  //**********************************************************************************************************


  //==========================================================================================================
  //#region êÄáÑÖã 4
  //----------------------------------------------------------------------------------------------------------
  count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢');

  for (i := 0; i < count; i++)
  {
    bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+getIter(i);

    #IfNullSetVisFCon(bufAdr+'/äÆ§Ñèà'      , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/äÅä'         , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/éäÖà'        , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/éäíåé'       , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/ë•‡ã®Êç•§‡'  , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/çÆ¨ã®Êç•§‡'  , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/Ç®§ã®Êç•§‡'  , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/ç†®¨å•·‚'    , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/ç†ÁÑÆ°ìÇë'   , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/ë‚Æ®¨Ö§èàå®≠', bufAdr)
    #IfNullSetVisFCon(bufAdr+'/ç†´Å†ß†'     , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/ç†´à·Á®·´'   , bufAdr)

    tBool := False;
    count_2 := GetCountFld(bufAdr+'/äÆ´èàç†´é·≠');

    for (j := 0; j < count_2; j++)
    {
      bufAdr_2 := bufAdr+'/äÆ´èàç†´é·≠'+getIter(j);

      if    (not GetStrNull(bufAdr_2+'/äÆ§é·≠Æ¢')
         and not GetStrNull(bufAdr_2+'/äÆ´èàç†´'))
      then { #SetVisT(bufAdr_2); tBool := True; }
      else #SetVisF(bufAdr_2);
    }

    if (not tBool) #SetVisFCon(bufAdr)

    #IfVis(bufAdr+'/ë‚Æ®¨Ö§èà'      );
    #IfVis(bufAdr+'/äÆ´ê•†´Ñèà'     );
    #IfVis(bufAdr+'/ÇÎ‡ê•†´Ñèà'     );
    #IfVis(bufAdr+'/ÇÎ‡ê•†´Ñèà105.3');
    #IfVis(bufAdr+'/ç†´à·Á®·´105.3' );

    #SetVisT(bufAdr);
  }
  //#endregion êÄáÑÖã 4
  //**********************************************************************************************************


  //==========================================================================================================
  //#region êÄáÑÖã 5
  //----------------------------------------------------------------------------------------------------------
  count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´');

  for (i := 0; i < count; i++)
  {
    bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+getIter(i);

    #IfNullSetVisFCon(bufAdr+'/äÆ§Ñèà'   , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/äÅä'      , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/éäÖà'     , bufAdr)
    #IfNullSetVisFCon(bufAdr+'/ç†´ë‚†¢™†', bufAdr)

    tBool := False;
    count_2 := GetCountFld(bufAdr+'/äÆ´èàìÁç†´');

    for (j := 0; j < count_2; j++)
    {
      bufAdr_2 := bufAdr+'/äÆ´èàìÁç†´'+getIter(j);

      #IfNullSetVisFCon(bufAdr_2+'/éäíåé'     , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë•‡ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/çÆ¨ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/Ç®§ã®Êç•§‡', bufAdr_2)

      tBool_2 := False;
      count_3 := GetCountFld(bufAdr_2+'/äÆ´èàç†´é·≠');

      for (k := 0; k < count_3; k++)
      {
        bufAdr_3 := bufAdr_2+'/äÆ´èàç†´é·≠'+getIter(k);
        if    (not GetStrNull(bufAdr_3+'/äÆ§é·≠Æ¢')
           and not GetStrNull(bufAdr_3+'/äÆ´èàç†´'))
        then { #SetVisT(bufAdr_3); tBool_2 := True; }
        else #SetVisF(bufAdr_3);

        #IfVis(bufAdr_3+'/äÆÌ‰äØÆ§ß');
        #IfVis(bufAdr_3+'/äÆÌ‰ä‚§'  );
      }

      if (not tBool_2) #SetVisFCon(bufAdr)

      tBool := True;
      #SetVisT(bufAdr_2);
    }

    if (not tBool) #SetVisFCon(bufAdr)

    tBool := False;
    bufAdr_2 := bufAdr+'/ê†·Áç†´ìØ´';

    if    (not GetStrNull(bufAdr_2+'/ë‚Æ®¨Ö§èà')
       and not GetStrNull(bufAdr_2+'/ç†´Å†ß†'  )
       and not GetStrNull(bufAdr_2+'/ç†´à·Á®·´'))
    {
      #IfVis(bufAdr_2+'/ÑÆ´ÔÑ‡å•‚Ñèà'   );
      #IfVis(bufAdr_2+'/äÆ´ê•†´Ñèà'     );

      SetFldVis(bufAdr_2+'/ÇÎ‡ê•†´Ñèà', GetFldVis(bufAdr_2+'/äÆ´ê•†´Ñèà'));

      #IfVis(bufAdr_2+'/ÇÎ‡ê•†´Ñèà105.3');
      #IfVis(bufAdr_2+'/ê†·ÂçèÑÆ·‚'     );
      #IfVis(bufAdr_2+'/ê†·ÂçèÄ‰≠¶'     );
      #IfVis(bufAdr_2+'/ç†´à·Á®·´105.3' );

      tBool := True;
      #SetVisT(bufAdr_2);
    }
    else #SetVisF(bufAdr_2);

    if (not tBool) #SetVisFCon(bufAdr);

    #SetVisT(bufAdr);
  }
  //#endregion êÄáÑÖã 5
  //**********************************************************************************************************


  //==========================================================================================================
  //#region êÄáÑÖã 6
  //----------------------------------------------------------------------------------------------------------
  {
    bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà';

    if                        (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/è‡ê†·ÂÑÆ°è•‡'  )) #SetVisF(bufAdr);
    else if                   (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/é·‚çèç†Áè•‡'   )) #SetVisF(bufAdr);
      else if                 (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/é·‚çèäÆ≠è•‡'   )) #SetVisF(bufAdr);
        else if               (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/è‡ê†·ÂÑèàè•‡'  )) #SetVisF(bufAdr);
          else if             (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/Ç≠•‡•†´ê†·ÂÑèà')) #SetVisF(bufAdr);
            else if           (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/äÆ·¢ê†·ÂÑèà'   )) #SetVisF(bufAdr);
              else if         (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/äÆ·¢ê†·ÂÑ‡'    )) #SetVisF(bufAdr);
                else if       (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/è‡ê†·Âè•‡é°È'  )) #SetVisF(bufAdr);
                  else if     (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/äÆ·¢à≠ê†·Âè•‡' )) #SetVisF(bufAdr);
                    else if   (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé°È/ê†·Âé°ÈÑÆ°è•‡' )) #SetVisF(bufAdr);
                      else if (GetStrNull(bufAdr+'/ë„¨ê†·ÂÑèàé‚§/éäÖà'          )) #SetVisF(bufAdr);
                        else {
                          tBool := False;
                          count := GetCountFld(bufAdr+'/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§');

                          for (i := 0; i < count; i++)
                          {
                            bufAdr_2 := bufAdr+'/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+getIter(i);

                            #IfNullSetVisFCon(bufAdr_2+'/äÆ§Ñèà'       , bufAdr_2)
                            #IfNullSetVisFCon(bufAdr_2+'/äÆ´®ÁÑèà'     , bufAdr_2)
                            #IfNullSetVisFCon(bufAdr_2+'/ÑÆ´ÔÑèàé°ÈäÆ´', bufAdr_2)

                            #IfVis(bufAdr_2+'/ë„¨ê†·ÂÑÆ°èà');

                            tBool := True;
                            #SetVisT(bufAdr_2);
                          }

                          if (not tBool)
                          then #SetVisF(bufAdr);
                          else #SetVisT(bufAdr);
                        }
  }
  //#endregion êÄáÑÖã 6
  //**********************************************************************************************************


  //==========================================================================================================
  //#region êÄáÑÖã 7
  //----------------------------------------------------------------------------------------------------------
  count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£');

  for (i := 0; i < count; i++)
  {
    bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+getIter(i);

    if                (GetStrNull(bufAdr+'/äÅä'                  )) #SetVisFCon(bufAdr)
    else if           (GetStrNull(bufAdr+'/ë•‡ã®Êç•§‡'           )) #SetVisFCon(bufAdr)
      else if         (GetStrNull(bufAdr+'/çÆ¨ã®Êç•§‡'           )) #SetVisFCon(bufAdr)
        else if       (GetStrNull(bufAdr+'/Ç®§ã®Êç•§‡'           )) #SetVisFCon(bufAdr)
          else if     (GetStrNull(bufAdr+'/éäÖà'                 )) #SetVisFCon(bufAdr)
            else if   (GetStrNull(bufAdr+'/éäíåé'                )) #SetVisFCon(bufAdr)
            else if   (GetStrNull(bufAdr+'/è‡®ß≠ä‚§'             )) #SetVisFCon(bufAdr)
              else if (GetStrNull(bufAdr+'/ê†·Áç†´ìØ´/à·Á®·´ìÁì£')) #SetVisFCon(bufAdr)
                else
    {
      tBool := False;
      count_2 := GetCountFld(bufAdr+'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ');

      for (j := 0; j < count_2; j++)
      {
        bufAdr_2 := bufAdr+'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ'+getIter(j);

        if    (not GetStrNull(bufAdr_2+'/äÆ§Ñèà'  )
           and not GetStrNull(bufAdr_2+'/äÆ§é·≠Æ¢')
           and not GetStrNull(bufAdr_2+'/äÆ´Ñèà'  ))
        then { #SetVisT(bufAdr_2); tBool := True; }
        else #SetVisF(bufAdr_2);
      }

      if (not tBool) #SetVisFCon(bufAdr)
    }

    {
      #IfVis(bufAdr+'/ê†·Áç†´ìØ´/é·‚ç†Áè•‡'   );
      #IfVis(bufAdr+'/ê†·Áç†´ìØ´/ê†·ÂéíÇÎÁ'   );
      #IfVis(bufAdr+'/ê†·Áç†´ìØ´/äÆÌ‰ä‚'      );
      #IfVis(bufAdr+'/ê†·Áç†´ìØ´/ç†´ÇÎÁè‡•§'  );
      #IfVis(bufAdr+'/ê†·Áç†´ìØ´/à·Á®·´è•‡ìØ´');
      #IfVis(bufAdr+'/ê†·Áç†´ìØ´/é·‚äÆ≠è•‡'   );

      if (not GetStrNull(bufAdr+'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·Âéíè•‡Ç·'))
      {
        #IfVis(bufAdr+'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/å†‚ê†·Â'   );
        #IfVis(bufAdr+'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·ÂÄ¨à¨„È');
        #IfVis(bufAdr+'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·Âê•™Æ≠' );

        #SetVisT(bufAdr+'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·Âéíè•‡Ç·');
      }
      else #SetVisF(bufAdr+'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·Âéíè•‡Ç·')
    }

    {
      tBool := False;
      count_2 := GetCountFld(bufAdr+'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡');

      for (j := 0; j < count_2; j++)
      {
        bufAdr_2 := bufAdr+'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡'+getIter(j);

        if    (not GetStrNull(bufAdr_2+'/ç†Áè‡†¢ç†´ÇÎÁ')
           and not GetStrNull(bufAdr_2+'/ç†´ÇÎÁç†Á'    )
           and not GetStrNull(bufAdr_2+'/äÆ≠è‡†¢ç†´ÇÎÁ'))
        then { #SetVisT(bufAdr_2); tBool := True; }
        else { #SetVisF(bufAdr_2); continue; }

        #IfVis(bufAdr_2+'/ç†´ÇÎÁè‡•§'  );
        #IfVis(bufAdr_2+'/ç†´ÇÎÁí•™'   );
        #IfVis(bufAdr_2+'/é·‚ç†´ÇÎÁäÆ≠');
      }

      if (not tBool)
      then #SetVisF(bufAdr+'/ê†·Áç†´ÇÎÁ')
      else #SetVisT(bufAdr+'/ê†·Áç†´ÇÎÁ')
    }

    #IfVis(bufAdr+'/ä‚§');

    #SetVisT(bufAdr);
  }
  //#endregion êÄáÑÖã 7
  //**********************************************************************************************************

  //==========================================================================================================
  //#region êÄáÑÖã 8
  //----------------------------------------------------------------------------------------------------------
  count := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ');
  for (i := 0; i < count; i++)
  {
    // à·Áç†´ç•‰‚çÑÑ == 30.1 ê†ß§•´ 8.1
    bufAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+getIter(i);

    #IfNullSetVisFCon(bufAdr+'/äÆ§Ñèà', bufAdr);
    #IfNullSetVisFCon(bufAdr+'/äÅä'   , bufAdr);
    #IfNullSetVisFCon(bufAdr+'/éäÖà'  , bufAdr);

    // ê†·Áç†´ìÁ == 31.1.1 ê†ß§•´ 8.1.1
    tBool := False;
    count_2 := GetCountFld(bufAdr+'/ê†·Áç†´ìÁ');

    for (j := 0; j < count_2; j++)
    {
      bufAdr_2 := bufAdr+'/ê†·Áç†´ìÁ'+getIter(j);

      #IfNullSetVisFCon(bufAdr_2+'/éäíåé'     , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë•‡ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/çÆ¨ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/Ç®§ã®Êç•§‡', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë‚•ØÇÎ‡†°' , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ÉÆ§ç†ÁÑÆ°' , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/äÆÌ‰ä≠§§'  , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë‡ì‡ñ•≠'   , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë‡á≠†Áä„‡·', bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/è‡®ß≠ä£'   , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/äÆÌ‰ä£'    , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë‚†¢ùè'    , bufAdr_2)
      #IfNullSetVisFCon(bufAdr_2+'/ë„¨à·Áç†´' , bufAdr_2)

      tBool_2 := False;
      // äÆ´ç•‰‚ç†´é·≠ == 32.1.1.1 ê†ß§•´ 8.1.1.1
      count_3 := GetCountFld(bufAdr_2+'/äÆ´ç•‰‚ç†´é·≠');

      for (k := 0; k < count_3; k++)
      {
        bufAdr_3 := bufAdr_2+'/äÆ´ç•‰‚ç†´é·≠'+getIter(k);

        if    (not GetStrNull(bufAdr_3+'/äÆ§é·≠Æ¢' )
           and not GetStrNull(bufAdr_3+'/äÆ´ç•‰‚ç†´'))
        then { #SetVisT(bufAdr_3) tBool_2 := true; }
        else #SetVisF(bufAdr_3);
      }
      if tBool_2
      {
        tBool := true;
        #SetVisT(bufAdr_2)
      }
      else
        #SetVisF(bufAdr_2);

    }
    if tBool
    then #SetVisT(bufAdr)
    else #SetVisF(bufAdr);
  }
  //#endregion êÄáÑÖã 8
  //**********************************************************************************************************

@end.
//#endregion On_Visable ÑÖâëíÇàü ÇõèéãçüÖåõÖ èêà ìëíÄçéÇäÖ ÇàÑàåéëíà èéãÖâ
//************************************************************************************************************


//============================================================================================================
//#region On_Check ÑÖâëíÇàü ÇõèéãçüÖåõÖ èêà èêéÇÖêäÖ èéãÖâ
//------------------------------------------------------------------------------------------------------------
@Script On_Check : boolean;
  //==========================================================================================================
  //#region ëÖêÇàë On_Check
  //----------------------------------------------------------------------------------------------------------
  #include AllTaxObj.Vih

  //----------------------------------------------------------------------------------------------------------
  function IsValidSerL(strIn: string; var strGetMes: string) : boolean;
  begin
    strGetMes := 'îÆ‡¨†‚ ØÆ´Ô: 3 ·®¨¢Æ´†';
    Result := False;
    Result :=    Length(strIn) =  3;
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidSerL_3_4(strIn: string; var strGetMes: string) : boolean;
  begin
    strGetMes := 'îÆ‡¨†‚ ØÆ´Ô: 3-4 ·®¨¢Æ´†';
    Result := False;
    Result := (Length(strIn) = 3) or (Length(strIn) = 4);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidNomL(strIn: string; var strGetMes: string) : boolean;
  begin
    strGetMes := 'îÆ‡¨†‚ ØÆ´Ô: 5 ·®¨¢Æ´†';
    Result := False;
    Result :=    Length(strIn) = 5;
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidVidL(strIn: string; var strGetMes: string) : boolean;
  begin
    strGetMes := 'îÆ‡¨†‚ ØÆ´Ô: 2 ·®¨¢Æ´†';
    Result := False;
    Result :=    Length(strIn) = 2;
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidMGod(strIn: string; var strGetMes: string) : boolean;
  begin
    //ç†´Æ£Æ¢†Ô °†ß†
    //ç†´Å†ß†
    strGetMes := 'îÆ‡¨†‚ ØÆ´Ô: åå.ÉÉÉÉ';
    Result := False;
    Result := CheckError.isRegExpr('^[0]{1}[1-9]{1}[.][1-2]{1}[0-9]{3}$', strIn)
             or  CheckError.isRegExpr('^[1]{1}[0-2]{1}[.][1-2]{1}[0-9]{3}$', strIn) ;
  end;
  //----------------------------------------------------------------------------------------------------------
  function IsValidGod(strIn: string; var strGetMes: string) : boolean;
  begin
    //ç†´Æ£Æ¢†Ô °†ß†
    //ç†´Å†ß†
    strGetMes := 'îÆ‡¨†‚ ØÆ´Ô: ÉÉÉÉ';
    Result := False;
    Result := CheckError.isRegExpr('^[[1-2]{1}[0-9]{3}$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidDol(strIn: string; var strGetMes: string) : boolean;
  begin
    //ç†´Æ£Æ¢†Ô °†ß†
    //ç†´Å†ß†
    strGetMes := 'îÆ‡¨†‚ ØÆ´Ô: X.XXXX';
    Result := False;
    Result := CheckError.isRegExpr('^[0]{1}[.][0-9]{3}[1-9]{1}$', strIn)
             or  CheckError.isRegExpr('^[1]{1}[.][0-9]{4}$', strIn) ;
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidPrizn(strIn: string; var strGetMes: string) : boolean;
  begin
    //è‡®ß≠†™ Ø‡®¨•≠•≠®Ô ·‚†¢™® †™Ê®ß† ≠† Ì‚®´Æ¢Î© ·Ø®‡‚
    //è‡®ß≠ë‚†¢
    strGetMes := 'ÇÆß¨Æ¶≠Î• ß≠†Á•≠®Ô: 1, 2, 3 ®´® 4';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2|3|4)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidPriznKtd(strIn: string; var strGetMes: string) : boolean;
  begin
    //è‡®ß≠†™ Ø‡®¨•≠•≠®Ô ·‚†¢™® †™Ê®ß† ≠† Ì‚®´Æ¢Î© ·Ø®‡‚
    //è‡®ß≠ë‚†¢
    strGetMes := 'ÇÆß¨Æ¶≠Î• ß≠†Á•≠®Ô: 0, 1, 2 ®´® 3 ';

    Result := False;
    Result := CheckError.isRegExpr('^(0|1|2|3)$', strIn);
  end;

  function IsValidKodDpi(strIn: string; var strGetMes: string) : boolean;
  begin
    //è‡®ß≠†™ Ø‡®¨•≠•≠®Ô ·‚†¢™® †™Ê®ß† ≠† Ì‚®´Æ¢Î© ·Ø®‡‚
    //è‡®ß≠ë‚†¢
    strGetMes := 'ÇÆß¨Æ¶≠Î• ß≠†Á•≠®Ô: 01100, 01150, 01300 ®´® 01350 ';

    Result := False;
    Result := CheckError.isRegExpr('^(01100|01150|01300|01350)$', strIn);
  end;

  function IsValidKodOsn(strIn: string; var strGetMes: string) : boolean;
  begin
    //è‡®ß≠†™ Ø‡®¨•≠•≠®Ô ·‚†¢™® †™Ê®ß† ≠† Ì‚®´Æ¢Î© ·Ø®‡‚
    //è‡®ß≠ë‚†¢
    strGetMes := 'ÇÆß¨Æ¶≠Î• ß≠†Á•≠®Ô: 6001, 6050, 6051, 6100, 6101, 6150, ®´® 6151 ';

    Result := False;
    Result := CheckError.isRegExpr('^(6001|6050|6051|6100|6101|6150|6151)$', strIn);
  end;

  #declare _IsValidNoKor_Decimal(_StrMes,_adrXML, _Cel, _Drob, _Pole, _CutIterMode=0, _flMin=False)
    if not IsValidDecimal(GetStrVal(#_adrXML), #_Cel, #_Drob, getMes, #_flMin)
      MessageErrorStop_ALG
      (
        #_adrXML,
        #_Pole,
        'èÆ´• ≠• ·ÆÆ‚¢•‚·‚¢„•‚ ‰Æ‡¨†‚„. îÆ‡¨†‚ ØÆ´Ô '+  #_StrMes + getMes ,
        #_CutIterMode
      );
  #end

  #declare No_IsValidNoKor_Decimal(_StrMes,_adrXML, _Cel, _Drob, _Pole, _CutIterMode=0, _flMin=False)
   if GetFldVis(#_adrXML)
    if not IsValidDecimal(GetStrVal(#_adrXML), #_Cel, #_Drob, getMes, #_flMin)
      MessageErrorStop_ALG
      (
        #_adrXML,
        #_Pole,
        'èÆ´• ≠• ·ÆÆ‚¢•‚·‚¢„•‚ ‰Æ‡¨†‚„. îÆ‡¨†‚ ØÆ´Ô '+  #_StrMes + getMes,
        #_CutIterMode
      );
  #end

  //----------------------------------------------------------------------------------------------------------
  function IsValidKtd(strIn: string; var strGetMes: string) : boolean;
  begin
    //ç†´Æ£Æ¢†Ô °†ß†
    //ç†´Å†ß†
    strGetMes := 'îÆ‡¨†‚ ØÆ´Ô: X.X';
    Result := False;
    Result := CheckError.isRegExpr('^[0-9]{1}[.][1-9]{1}$', strIn)
             or  CheckError.isRegExpr('^[1-9]{1}[.][0-9]{1}$', strIn) ;
  end;

  #declare _InsMes(_AdrXML, _Pole, _StrMes, _CutIterMode=0)
    MessageErrorStop_ALG
    (
      #_AdrXML,
      #_Pole,
      #_StrMes,
      #_CutIterMode
    );
  #end

  #declare _NoKor_(_StrMes, _AdrXML, _Pole, _flIter = 0)
    MessageErrorStop_ALG
    (
      #_AdrXML,
      #_Pole,
      'èÆ´• ≠• ·ÆÆ‚¢•‚·‚¢„•‚ ‰Æ‡¨†‚„. îÆ‡¨†‚ ØÆ´Ô' + getMes+' '+#_StrMes,
      #_flIter
    );
  #end

  #declare _MesNoKor(_AdrXML, _Pole, _CutIterMode=0)
    MessageErrorStop_ALG
    (
      #_AdrXML,
      #_Pole,
      'èÆ´• ≠• ·ÆÆ‚¢•‚·‚¢„•‚ ‡•£„´Ô‡≠Æ¨„ ¢Î‡†¶•≠®Ó. ' + getMes,
      #_CutIterMode
    );
  #end
  //#endregion ëÖêÇàë On_Check
  //**********************************************************************************************************
@begin
  var getMes: string;
  getMes := '';
  var  aKodNO   , aNomKorr   , aPoMestu , aKND , aDataDok , aPeriod , aOtchetGod , aPrPodp , aFamilija , aImja  , aOtchestvo ,
       aNaimDok , aNaimOrg_2 , aTlf , aNaimOrg , aINNJUL  , aFormReorg , aKPP    , aINNJUL_2 , aKPP_2 ,
       sKodNO   , sNomKorr   , sPoMestu , sKND , sDataDok , sPeriod , sOtchetGod , sPrPodp , sFamilija , sImja  , sOtchestvo ,
       sNaimDok , sNaimOrg_2 , sTlf , sNaimOrg , sINNJUL  , sFormReorg , sKPP    , sINNJUL_2 , sKPP_2 :string;

  var tB : Boolean;

  if not IsValidDate(GetStrVal('î†©´/ÑÆ™„¨•≠‚/Ñ†‚†ÑÆ™'), getMes)
    MessageErrorStop_ALG('î†©´/ÑÆ™„¨•≠‚/Ñ†‚†ÑÆ™', '"Ñ†‚†"', 'á†ØÆ´≠®‚• ØÆ´• ®´® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚ §´Ô „·‚†≠Æ¢™® ‚•™„È•© §†‚Î');

  aKodNO     := 'î†©´/ÑÆ™„¨•≠‚/äÆ§çé'                        ;   sKodNO     := GetStrVal(aKodNO    );
  aNomKorr   := 'î†©´/ÑÆ™„¨•≠‚/çÆ¨äÆ‡‡'                      ;   sNomKorr   := GetStrVal(aNomKorr  );
  aPoMestu   := 'î†©´/ÑÆ™„¨•≠‚/èÆå•·‚„'                      ;   sPoMestu   := GetStrVal(aPoMestu  );
  aKND       := 'î†©´/ÑÆ™„¨•≠‚/äçÑ'                          ;   sKND       := GetStrVal(aKND      );
  aDataDok   := 'î†©´/ÑÆ™„¨•≠‚/Ñ†‚†ÑÆ™'                      ;   sDataDok   := GetStrVal(aDataDok  );
  aPeriod    := 'î†©´/ÑÆ™„¨•≠‚/è•‡®Æ§'                       ;   sPeriod    := GetStrVal(aPeriod   );
  aOtchetGod := 'î†©´/ÑÆ™„¨•≠‚/é‚Á•‚ÉÆ§'                     ;   sOtchetGod := GetStrVal(aOtchetGod);
  aPrPodp    := 'î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/è‡èÆ§Ø'             ;   sPrPodp    := GetStrVal(aPrPodp   );
  aFamilija  := 'î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé/î†¨®´®Ô'        ;   sFamilija  := GetStrVal(aFamilija );
  aImja      := 'î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé/à¨Ô'            ;   sImja      := GetStrVal(aImja     );
  aOtchestvo := 'î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/îàé/é‚Á•·‚¢Æ'       ;   sOtchestvo := GetStrVal(aOtchestvo);
  aNaimDok   := 'î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/ë¢è‡•§/ç†®¨ÑÆ™'     ;   sNaimDok   := GetStrVal(aNaimDok  );
  aNaimOrg_2 := 'î†©´/ÑÆ™„¨•≠‚/èÆ§Ø®·†≠‚/ë¢è‡•§/ç†®¨é‡£'     ;   sNaimOrg_2 := GetStrVal(aNaimOrg_2);
  aTlf       := 'î†©´/ÑÆ™„¨•≠‚/ë¢çè/í´‰'                     ;   sTlf       := GetStrVal(aTlf      );
  aNaimOrg   := 'î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ç†®¨é‡£'            ;   sNaimOrg   := GetStrVal(aNaimOrg  );
  aINNJUL    := 'î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/àççûã'              ;   sINNJUL    := GetStrVal(aINNJUL   );
  aKPP       := 'î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/äèè'                ;   sKPP       := GetStrVal(aKPP      );
  aFormReorg := 'î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/îÆ‡¨ê•Æ‡£';   sFormReorg := GetStrVal(aFormReorg);
  aINNJUL_2  := 'î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/àççûã'    ;   sINNJUL_2  := GetStrVal(aINNJUL_2 );
  aKPP_2     := 'î†©´/ÑÆ™„¨•≠‚/ë¢çè/çèûã/ë¢ê•Æ‡£ûã/äèè'      ;   sKPP_2     := GetStrVal(aKPP_2    );

  if (sFormReorg <> '')
  {
    if not IsValidFormReorg(sFormReorg, getMes) #_InsMes(aFormReorg, '"îÆ‡¨† ‡•Æ‡£†≠®ß†Ê®®"', getMes);
    else
    {
      if sFormReorg <> '0'
      {
        if not CheckError.Prov_INN(sINNJUL_2, getMes) #_InsMes(aINNJUL_2, '"àçç ‡•Æ‡£†≠®ßÆ¢†≠≠Æ© Æ‡£†≠®ß†Ê®®"', getMes);
        if not IsValidKPP(sKPP_2, getMes) #_InsMes(aKPP_2, '"äèè ‡•Æ‡£†≠®ßÆ¢†≠≠Æ© Æ‡£†≠®ß†Ê®®"', getMes);
      }
      else
      {
        getMes := 'ë‚‡Æ™† ≠• §Æ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† Ø‡® ‚•™„È•¨ ß≠†Á•≠®® ØÆ´Ô "îÆ‡¨† ‡•Æ‡£†≠®ß†Ê®®"';
        if (Length(sINNJUL_2) > 0) #_InsMes(aINNJUL_2, '"àçç ‡•Æ‡£. Æ‡£."', getMes);
        if (Length(sKPP_2   ) > 0) #_InsMes(aINNJUL_2, '"àçç ‡•Æ‡£. Æ‡£."', getMes);
      }
    }
  }
  else
  {
    getMes := 'ë‚‡Æ™† ≠• §Æ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† Ø‡® ‚•™„È•¨ ß≠†Á•≠®® ØÆ´Ô "îÆ‡¨† ‡•Æ‡£†≠®ß†Ê®®"';
    if (Length(sINNJUL_2) > 0) #_InsMes(aINNJUL_2, '"àçç ‡•Æ‡£. Æ‡£."', getMes);
    if (Length(sKPP_2)    > 0) #_InsMes(aKPP_2   , '"äèè ‡•Æ‡£. Æ‡£."', getMes);
  }

  if not IsValidSONO(sKodNO, getMes) #_MesNoKor(aKodNO, 'äÆ§ ≠†´Æ£Æ¢Æ£Æ Æ‡£†≠†');
  if not CheckError.Prov_INN(sINNJUL, getMes) #_InsMes(aINNJUL, '"àçç"', getMes);
  if not IsValidKPP(sKPP, getMes) #_MesNoKor(aKPP, '"äèè"');
  if (sNaimOrg = '') MessageErrorStop_ALG(aNaimOrg, '"ç†´Æ£ÆØ´†‚•´ÏÈ®™"', 'èÆ´• Æ°Ôß†‚•´Ï≠Æ §´Ô ß†ØÆ´≠•≠®Ô');
  else if not IsValidNaimOrg(sNaimOrg, getMes) #_MesNoKor(aNaimOrg, '"ç†´Æ£ÆØ´†‚•´ÏÈ®™"');
  if (sTlf <> '')
    if not IsValidTlf(sTlf, getMes) #_MesNoKor(aTlf, '"çÆ¨•‡ ™Æ≠‚†™‚≠Æ£Æ ‚•´•‰Æ≠†"');
  if (sNaimDok <> '')
    if not IsValidNaimDok(sNaimDok, getMes) #_MesNoKor(aNaimDok, '"îÆ‡¨† ‡•Æ‡£†≠®ß†Ê®®"');

  if not IsValidFIO(sFamilija, getMes) #_MesNoKor(aFamilija, '"î†¨®´®Ô"');
  if not IsValidFIO(sImja    , getMes) #_MesNoKor(aImja    , '"à¨Ô"'    );
  if sOtchestvo <> ''
    if not IsValidFIO(sOtchestvo, getMes) #_MesNoKor(aOtchestvo, '"é‚Á•·‚¢Æ"');

  if not IsValidPrPodp(sPrPodp, getMes) #_InsMes(aPrPodp, '"è‡®ß≠†™ ØÆ§Ø®·†≠‚†"', getMes)
  else
  {
    if (sPrPodp = '2')
    {
      if not IsValidNaimDok(sNaimDok, getMes) #_InsMes(aNaimDok, '"ç†®¨. §Æ™., ØÆ§‚¢. ØÆ´≠Æ¨ÆÁ®Ô Ø‡•§·‚."', 'èÆ´• Æ°Ôß†‚•´Ï≠Æ §´Ô ß†ØÆ´≠•≠®Ô Ø‡® ß≠†Á•≠®® ØÆ´Ô "è‡®ß≠†™ ØÆ§Ø®·†≠‚†" ‡†¢≠Æ£Æ 2. ' + getMes);
        if sNaimOrg_2 <> ''
          if not IsValidNaimOrg(sNaimOrg_2, getMes) #_InsMes(aNaimOrg_2, '"ç†®¨•≠Æ¢†≠®• Æ‡£†≠®ß†Ê®®"', getMes);
    }
    else
    {
      getMes := 'èÆ´• ß†ØÆ´≠Ô•‚·Ô ‚Æ´Ï™Æ Ø‡® ß≠†Á•≠®® ØÆ´Ô "è‡®ß≠†™ ØÆ§Ø®·†≠‚†" ‡†¢≠Æ£Æ 2';
      if (Length(sNaimDok  ) > 0) MessageErrorStop_ALG(aNaimDok  , '"ç†®¨•≠Æ¢†≠®• §Æ™„¨•≠‚†"'  , getMes);
      if (Length(sNaimOrg_2) > 0) MessageErrorStop_ALG(aNaimOrg_2, '"ç†®¨•≠Æ¢†≠®• Æ‡£†≠®ß†Ê®®"', getMes);
    }
  }
  //***********************************************************************************************
  //***********************************************************************************************


  var i,j,k,g,z,count,countOKTMO,countKodOsn,stj,n :longint;
  var sKBK, sOKTMO, aNalPU, aKBK, aOKTMO , sNalPU, aPriznkKtd,
      aKodDPI, aOKEI, aNalIsch, aSepLicN, aNomLicN, aVidLicN, aKodOsnov, aKolDPI, aKoef, aNalBaza, aPriznkG, aGodNach,
      sKodDPI, sOKEI, sNalIsch, sSepLicN, sNomLicN, sVidLicN, sKodOsnov, sKolDPI, sKoef, sNalBaza, sPriznkG, sGodNach, sPriznkKtd :string;
  var tBool, tbool1, tbool2: boolean;
  var iCutIterMode : integer;
    var flIter :integer;
  for (i := 0; i <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì'); i++)
  {
    if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì' + getIter(i))
    {
      aKBK   :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì' + getIter(i) +'/äÅä'  ; sKBK   := GetStrVal(aKBK   )  ;
      aOKTMO :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì' + getIter(i) +'/éäíåé'; sOKTMO := GetStrVal(aOKTMO )  ;
      aNalPU :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë„¨ç†´èì/ë„¨èì' + getIter(i) +'/ç†´èì'; sNalPU := GetStrVal(aNalPU )  ;
      if not IsValidKBK(sKBK, getMes) #_MesNoKor(aKBK, 'ë‚‡. 010');
      if not IsValidOKTMO(sOKTMO, getMes) #_MesNoKor(aOKTMO, 'ë‚‡. 020');
      if (sNalPU ='' )
        #_InsMes(aNalPU, 'ë‚‡. 030', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
    }
  }

  for (i := 0; i <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'); i++)
  {
    if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i))
    {
      tbool1:= False;
      aKodDPI  :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/äÆ§Ñèà'     ;  sKodDPI  := GetStrVal(aKodDPI  );
      aKBK     :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/äÅä'        ;  sKBK     := GetStrVal(aKBK     );
      aOKEI    :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/éäÖà'       ;  sOKEI    := GetStrVal(aOKEI    );
      if not IsValidKBK(sKBK, getMes) #_MesNoKor(aKBK, 'ë‚‡. 020');
      if (sOKEI ='' )
        #_InsMes(aOKEI, 'ë‚‡. 030', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if (sKodDPI ='' )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if not ((sKodDPI ='03100' ) )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'äÆ§ ¢®§† §Æ°Î‚Æ£Æ ØÆ´•ß≠Æ£Æ ®·™ÆØ†•¨Æ£Æ ¨Æ¶•‚ Ø‡®≠®¨†‚Ï ‚Æ´Ï™Æ ß≠†Á•≠®Ô 03100');
      if (sOKEI <>'168' )
        #_InsMes(aOKEI, 'ë‚‡. 030', 'äÆ§ °Ó§¶•‚≠Æ© ™´†··®‰®™†Ê®® ¨Æ¶•‚ Ø‡®≠®¨†‚Ï ‚Æ´Ï™Æ ß≠†Á•≠®Ô 168');
      tbool := False;
      for (j := 0; j <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'); j++)
      {
        if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) )
        {
          tbool := True;
          aOKTMO   := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/éäíåé'     ;  sOKTMO   := GetStrVal(aOKTMO   );
          aSepLicN := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ë•‡ã®Êç•§‡';  sSepLicN := GetStrVal(aSepLicN );
          aNomLicN := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/çÆ¨ã®Êç•§‡';  sNomLicN := GetStrVal(aNomLicN );
          aVidLicN := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/Ç®§ã®Êç•§‡';  sVidLicN := GetStrVal(aVidLicN );
          if not IsValidOKTMO(sOKTMO, getMes) #_MesNoKor(aOKTMO, 'ë‚‡. 040', iCutIterMode);
          if (sSepLicN ='' )
            #_InsMes(aSepLicN, 'ë‚‡. 050', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidSerL(sSepLicN, getMes) #_MesNoKor(aSepLicN, 'ë‚‡. 050', iCutIterMode);
          if (sNomLicN ='' )
            #_InsMes(aNomLicN, 'ë‚‡. 050', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidNomL(sNomLicN, getMes) #_MesNoKor(aNomLicN, 'ë‚‡. 050', iCutIterMode);
          if (sVidLicN ='' )
            #_InsMes(aVidLicN, 'ë‚‡. 050', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidVidL(sVidLicN, getMes) #_MesNoKor(aVidLicN, 'ë‚‡. 050', iCutIterMode);
          #_IsValidNoKor_Decimal('XXXXXXX.XX'     , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/èÆ™†ßÑ¨'  , 7, 2, 'ë‚‡. 060');
          #_IsValidNoKor_Decimal('XXXX'           , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ä≠§Ø®'    , 4, 0, 'ë‚‡. 070');
          #_IsValidNoKor_Decimal('XXXX.XXXX'      , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/äÆÌ‰äÊ'   , 2, 4, 'ë‚‡. 080');
          #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/äÆÌ‰ä¢'   , 1, 4, 'ë‚‡. 090');
          #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ë‚•Ø•≠Ïë¢', 1, 4, 'ë‚‡. 100');
          #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/äÆÌ‰äß'   , 1, 4, 'ë‚‡. 110');
          #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/äÆÌ‰ä§¢'  , 1, 4, 'ë‚‡. 115');
          #_IsValidNoKor_Decimal('X'              , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/äÆÌ‰ä™†≠' , 1, 0, 'ë‚‡. 120');
          #_IsValidNoKor_Decimal('XXXXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/äÆÌ‰ä†°§‚', 6, 0, 'ë‚‡. 123');
          #_IsValidNoKor_Decimal('XXXXXX.XXXX'    , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/äÆÌ‰ä¨†≠' , 6, 4, 'ë‚‡. 125');
          #_IsValidNoKor_Decimal('X.X'            , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/äÆÌ‰ë¢≠'  , 1, 1, 'ë‚‡. 126');
          #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ç†´à·Á®·´',15, 0, 'ë‚‡. 130');
          #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ç†´ÇÎÁ'   ,15, 0, 'ë‚‡. 140');
          #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ç†´ìØ´'   ,15, 0, 'ë‚‡. 150');
          z := 3;
          stj := 0;
          for (g := 0; g <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚ìÁç•§‡'); g++)
          {
            if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚ìÁç•§‡'+ getIter(g) )
            {
              if j>=1
                 iCutIterMode :=1;
              else
                 iCutIterMode :=-1;
              if (z <= g)
              {
                z:= z+3;
                stj:=stj+3;
              }

              if not IsValidDecimal(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚ìÁç•§‡'+ getIter(g)+'/äÆ´ç•‰‚èç'), 11, 3, getMes,  True)
                 #_NoKor_('XXXXXXXXXXX.XXX' ,'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚ìÁç•§‡'+ getIter(g-stj)+'/äÆ´ç•‰‚èç' , 'ë‚‡. '+string(g+1)+' £‡.2', iCutIterMode);
            }
          }
          for (g := 0; g <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'); g++)
          {
            if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g))
            {
              tbool2:= True;
              // ‡•¶®¨ ¢Î‡•ß™® ®‚•‡†‚Æ‡Æ¢ ®ß †§‡•·† ØÆ™†ß†‚•´Ô
              aKodOsnov:=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/äÆ´Ñèàá†´é·≠'+ getIter(k)+'/äÆ§é·≠Æ¢' ;  sKodOsnov:= GetStrVal(aKodOsnov);
              if (GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/ç†®¨á´¶') ='' )
                #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/ç†®¨á´¶', 'ë‚‡.160', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.', iCutIterMode);
              #No_IsValidNoKor_Decimal('XX.XXXX'      , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/ù‰íÆ´Èè´†·‚' ,  2, 4, 'ë‚‡. 170');
              #No_IsValidNoKor_Decimal('X.XXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/è‡Æ≠®Êá´¶'   ,  1, 7, 'ë‚‡. 180');
              #_IsValidNoKor_Decimal('XXXX'           , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/É´„°è´†·‚'   ,  4, 0, 'ë‚‡. 190');
              #_IsValidNoKor_Decimal('XX.XXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/è´Æ‚≠ç•‰‚'   ,  2, 3, 'ë‚‡. 200');
              #_IsValidNoKor_Decimal('XXXXXXX.XX'     , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/èÆ™†ß†‚Ñ¨'   ,  7, 2, 'ë‚‡. 210');
              #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/ë‚•Ø•≠Ïë¢ß'  ,  1, 4, 'ë‚‡. 220');
              #_IsValidNoKor_Decimal('X.X'            , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/äÆÌ‰ä§'      ,  1, 1, 'ë‚‡. 230');
              #_IsValidNoKor_Decimal('XXX'            , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/äÆ´ç†´è•‡'   ,  3, 0, 'ë‚‡. 240');
              #_IsValidNoKor_Decimal('X.XXXX'        , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/äÆÌ‰ä§¢'     ,  1, 4, 'ë‚‡. 250');
              #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/ç†´à·Á®·´á´¶', 15, 0, 'ë‚‡. 260');

              z := 3;
              n := 0;
              stj := 0;
              for (k := 0; k <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/äÆ´ç•‰‚é·≠'); k++)
              {
                if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/äÆ´ç•‰‚é·≠'+ getIter(k))
                {
                  tbool2:= True;
                  if j>=1
                    iCutIterMode :=1;
                  else
                    iCutIterMode :=-1;
                  if (z <= k)
                  {
                    n:= n+1;
                    z:= z+3;
                    stj:=stj+3;
                  }
                  if not IsValidDecimal(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/äÆ´ç•‰‚é·≠'+ getIter(k)+'/äÆ´ç•‰‚èç'), 11, 3, getMes,  True)
                     #_NoKor_('XXXXXXXXXXX.XXX' ,'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/äÆ´ç•‰‚é·≠'+ getIter(k mod 3)+'/äÆ´ç•‰‚èç', 'ë‚‡. '+string(k+1)+' £‡.2', iCutIterMode);
                }
              }
              if not tbool2
                #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/ÑÆ°ç•‰‚á†´•¶'+ getIter(g)+'/äÆ´ç•‰‚é·≠/äÆ§é·≠Æ¢', '£‡.1', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ï 1 ·‚‡ÆÁ™†');
            }
          }
        }
      }
      if not tbool
        #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚'+ getIter(i) +'/èÆ™ê†·Áç†´/éäíåé' , 'ë‚‡. 040', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ô °Î 1 ê†ß§•´ 3.1');
    }
  }



  for (i := 0; i <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'); i++)
  {
    if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i))
    {
      tbool1:= False;
      aKodDPI  :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÆ§Ñèà'     ;  sKodDPI  := GetStrVal(aKodDPI  );
      aKBK     :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÅä'        ;  sKBK     := GetStrVal(aKBK     );
      aOKEI    :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/éäÖà'       ;  sOKEI    := GetStrVal(aOKEI    );
      if not IsValidKBK(sKBK, getMes) #_MesNoKor(aKBK, 'ë‚‡. 020');
      if (sOKEI ='' )
        #_InsMes(aOKEI, 'ë‚‡. 030', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if (sKodDPI ='' )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if not ((sKodDPI ='03200' ) or (sKodDPI ='03300' )  )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'äÆ§ ¢®§† §Æ°Î‚Æ£Æ ØÆ´•ß≠Æ£Æ ®·™ÆØ†•¨Æ£Æ  ¨Æ¶•‚ Ø‡®≠®¨†‚Ï ·´•§„ÓÈ®• ß≠†Á•≠®Ô (03200, 03300 )');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX'  , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/ë„¨à·Áç†´'  , 15, 0, 'ë‚‡. 040');
      #No_IsValidNoKor_Decimal('XXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/ë„¨ç†´ÇÎÁ'  , 12, 0, 'ë‚‡. 045');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXX'    , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/ë„¨ç†´ìØ´'  , 12, 0, 'ë‚‡. 050');
      #No_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÆÌ‰äË‰´„'  ,  1, 4, 'ë‚‡. 060');
      #No_IsValidNoKor_Decimal('XXXXXXXXXX.XXXX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÆ´å£™'     , 11, 4, 'ë‚‡. 070');
      #No_IsValidNoKor_Decimal('XXXX'           , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/ë‚†¢™†Ç'    ,  4, 0, 'ë‚‡. 080');
      #No_IsValidNoKor_Decimal('XXXXXXXXXXX'    , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™†ß†‚í£'  , 11, 0, 'ë‚‡. 090');
      #No_IsValidNoKor_Decimal('XXXXXX.XXXX'    , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/ñ•≠†ñ£'     ,  6, 4, 'ë‚‡. 100');
      #_IsValidNoKor_Decimal('X.XX'             , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÆÌ‰é¢'     ,  1, 2, 'ë‚‡. 110');
      #_IsValidNoKor_Decimal('X.XX'             , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÆÌ‰ä£Ø≠'   ,  1, 2, 'ë‚‡. 120');
      #No_IsValidNoKor_Decimal('XXXXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/ë‡ñ•≠†ñ¢'   ,  6, 0, 'ë‚‡. 130');
      #No_IsValidNoKor_Decimal('XXXXXX.XXXX'    , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/ê†·Áñ•≠†ñÌ' ,  6, 4, 'ë‚‡. 140');
      #No_IsValidNoKor_Decimal('XXXXXX.XXXX'    , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/ñ•≠†ñ™'     ,  6, 4, 'ë‚‡. 150');
      #No_IsValidNoKor_Decimal('XXX.XXXX'       , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/ì·´ë‚†¢è≠'  ,  3, 4, 'ë‚‡. 160');
      #No_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÆÌ‰ä£Ø'    ,  1, 4, 'ë‚‡. 170');
      #No_IsValidNoKor_Decimal('X.XXXXXXXX'     , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÆÌ‰ä™¨'    ,  1, 8, 'ë‚‡. 180');
      #_IsValidNoKor_Decimal('XXXXXX.XXXX'      , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÆÌ‰ä¨†≠'   ,  6, 4, 'ë‚‡. 185');
      #_IsValidNoKor_Decimal('X.XX'             , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/äÆÌ‰äÆ´ÑÆ°' ,  1, 2, 'ë‚‡. 187');

      tbool := False;
      for (j := 0; j <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'); j++)
      {
        if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) )
        {
          tbool := True;
          aOKTMO   := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/éäíåé'     ;  sOKTMO   := GetStrVal(aOKTMO   );
          aSepLicN := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ë•‡ã®Êç•§‡';  sSepLicN := GetStrVal(aSepLicN );
          aNomLicN := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/çÆ¨ã®Êç•§‡';  sNomLicN := GetStrVal(aNomLicN );
          aVidLicN := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/Ç®§ã®Êç•§‡';  sVidLicN := GetStrVal(aVidLicN );
          if not IsValidOKTMO(sOKTMO, getMes) #_MesNoKor(aOKTMO, 'ë‚‡. 190', iCutIterMode);
          if (sSepLicN ='' )
            #_InsMes(aSepLicN, 'ë‚‡. 090', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidSerL(sSepLicN, getMes) #_MesNoKor(aSepLicN, 'ë‚‡. 200', iCutIterMode);
          if (sNomLicN ='' )
            #_InsMes(aNomLicN, 'ë‚‡. 090', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidNomL(sNomLicN, getMes) #_MesNoKor(aNomLicN, 'ë‚‡. 200', iCutIterMode);
          if (sVidLicN ='' )
            #_InsMes(aVidLicN, 'ë‚‡. 090', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidVidL(sVidLicN, getMes) #_MesNoKor(aVidLicN, 'ë‚‡. 200', iCutIterMode);
          #_IsValidNoKor_Decimal('XXXXXXXXXXX'      , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ë„¨à·Áç†´' , 11, 0, 'ë‚‡. 210');
          #No_IsValidNoKor_Decimal('XXXXXXXXXXX.XX' , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ë„¨ç†´ÇÎÁ' , 11, 2, 'ë‚‡. 215');
          #_IsValidNoKor_Decimal('XXXXXXXXXX'       , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ë„¨ç†´ìØ´' , 10, 0, 'ë‚‡. 220');
          #_IsValidNoKor_Decimal('X.XXXX'           , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/ë‚•Ø•≠Ïë¢£',  1, 4, 'ë‚‡. 230');
          #_IsValidNoKor_Decimal('XXXX.XXXX'        , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/á≠†Á•≠Ö„‚' ,  4, 4, 'ë‚‡. 240');
          #_IsValidNoKor_Decimal('X.XXXX'           , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j)+'/äÆÌ‰Ñ£'    ,  1, 4, 'ë‚‡. 250');
          tbool1 := False;
          for (g := 0; g <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'); g++)
          {
            if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g) )
            {
              tbool1 := True;
              if (GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g) +'/ç†®¨á´¶' ) ='' )
                #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g) +'/ç†®¨á´¶' , 'ë‚‡. 140', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.', iCutIterMode)
              #_IsValidNoKor_Decimal('XXXX'           , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/É´„°è´†·‚'   ,  4, 0, 'ë‚‡. 270');
              #_IsValidNoKor_Decimal('X.XXX'          , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/è´Æ‚≠ìÇëÎ‡ÏÔ',  1, 3, 'ë‚‡. 280');
              #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/á≠†Á•≠®•ä¢£' ,  1, 4, 'ë‚‡. 290');
              #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/á≠†Á•≠®•ä‡'  ,  1, 4, 'ë‚‡. 290');
              #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/á≠†Á•≠®•ä£ß' ,  1, 4, 'ë‚‡. 290');
              #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/á≠†Á•≠®•ä†·' ,  1, 4, 'ë‚‡. 290');
              #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/á≠†Á•≠®•äÆ‡ß',  1, 4, 'ë‚‡. 200');
              #_IsValidNoKor_Decimal('X.XXXX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/äÆÌ‰ä·'      ,  1, 4, 'ë‚‡. 300');
              #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/ç†´à·Á®·´á´¶', 15, 0, 'ë‚‡. 310');
              tbool2 := False
              n := 3;
              z := 0;
              stj:=0;
              for (k := 0; k <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/äÆ´Ñèàá†´é·≠'); k++)
              {
                if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/äÆ´Ñèàá†´é·≠'+ getIter(k))
                {
                  tbool2:= True;
                  if (n <= k)
                  {
                     z:= z+1;
                     n:= n+3;
                     stj:=stj+3;
                  }

                  // ‡•¶®¨ ¢Î‡•ß™® ®‚•‡†‚Æ‡Æ¢ ®ß †§‡•·† ØÆ™†ß†‚•´Ô
                  if i>=1
                    iCutIterMode :=1;
                  else
                    iCutIterMode :=-1;
                  aKodOsnov:=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/äÆ´Ñèàá†´é·≠'+ getIter(k)+'/äÆ§é·≠Æ¢' ;  sKodOsnov:= GetStrVal(aKodOsnov);
                  if (sKodOsnov ='' )
                  {
                    aKodOsnov:=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/äÆ´Ñèàá†´é·≠'+ getIter(k-stj)+'/äÆ§é·≠Æ¢' ;
                    #_InsMes(aKodOsnov,'ë‚‡. '+string(k+1)+ ' £‡.1', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode);
                  }
                  if not IsValidDecimal(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/äÆ´Ñèàá†´é·≠'+ getIter(k)+'/äÆ´Ñèà'), 11, 3, getMes,  True)
                     #_NoKor_('XXXXXXXXXXX.XXX' ,'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/äÆ´Ñèàá†´é·≠'+ getIter(k-stj)+'/äÆ´Ñèà' , 'ë‚‡. '+string(k+1)+' £‡.2', iCutIterMode);
                }
              }
              if not tbool2
                #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´'+ getIter(g)+'/äÆ´Ñèàá†´é·≠/äÆ§é·≠Æ¢', '£‡.1', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ï 1 ·‚‡ÆÁ™†');
            }
          }
          if not tbool1
            #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´'+ getIter(j) +'/äÆ´Ñèàá†´/ç†®¨á´¶' , 'ë‚‡. 260', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ô° 1 ê†ß§•´ 3.1.1');
        }
      }
      if not tbool
        #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß'+ getIter(i) +'/èÆ™ê†·Áç†´/éäíåé' , 'ë‚‡. 190', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ô °Î 1 ê†ß§•´ 3.1');
    }
  }
  for (i := 0; i <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'); i++)
  {
    if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i))
    {
      tbool1:= False;
      aKodDPI  :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i) +'/äÆ§Ñèà'     ;  sKodDPI  := GetStrVal(aKodDPI  );
      aKBK     :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i) +'/äÅä'        ;  sKBK     := GetStrVal(aKBK     );
      aOKEI    :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i) +'/éäÖà'       ;  sOKEI    := GetStrVal(aOKEI    );
      aOKTMO   :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i) +'/éäíåé'      ;  sOKTMO   := GetStrVal(aOKTMO   );
      aSepLicN :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i) +'/ë•‡ã®Êç•§‡' ;  sSepLicN := GetStrVal(aSepLicN );
      aNomLicN :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i) +'/çÆ¨ã®Êç•§‡' ;  sNomLicN := GetStrVal(aNomLicN );
      aVidLicN :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i) +'/Ç®§ã®Êç•§‡' ;  sVidLicN := GetStrVal(aVidLicN );
      if not IsValidKBK(sKBK, getMes) #_MesNoKor(aKBK, 'ë‚‡. 020');
      if (sOKEI ='' )
        #_InsMes(aOKEI, 'ë‚‡. 030', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if (sKodDPI ='' )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if not ((sKodDPI ='03100' ) or (sKodDPI ='03200' ) or (sKodDPI ='03300' )or (sKodDPI ='03401' ) )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'äÆ§ ¢®§† §Æ°Î‚Æ£Æ ØÆ´•ß≠Æ£Æ ®·™ÆØ†•¨Æ£Æ  ¨Æ¶•‚ Ø‡®≠®¨†‚Ï ·´•§„ÓÈ®• ß≠†Á•≠®Ô (03100, 03200, 03300 ®´® 03401 )');
      if (sKodDPI ='03401') and (sKBK <>'00000000000000000000')
        #_InsMes(aKBK, 'ë‚‡. 020', 'èÆ ™Æ§„ ¢®§† ØÆ´•ß≠Æ£Æ ®·™ÆØ†•¨Æ£Æ "03401" äÅä="00000000000000000000")');
      if not IsValidOKTMO(sOKTMO, getMes) #_MesNoKor(aOKTMO, 'ë‚‡. 040', iCutIterMode);
      if (sSepLicN ='' )
        #_InsMes(aSepLicN, 'ë‚‡. 050', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
      else
        if not IsValidSerL(sSepLicN, getMes) #_MesNoKor(aSepLicN, 'ë‚‡. 050', iCutIterMode);
      if (sNomLicN ='' )
        #_InsMes(aNomLicN, 'ë‚‡. 050', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
      else
        if not IsValidNomL(sNomLicN, getMes) #_MesNoKor(aNomLicN, 'ë‚‡. 050', iCutIterMode);
      if (sVidLicN ='' )
        #_InsMes(aVidLicN, 'ë‚‡. 050', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
      else
        if not IsValidVidL(sVidLicN, getMes) #_MesNoKor(aVidLicN, 'ë‚‡. 050', iCutIterMode);
      if (GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i) +'/ç†®¨å•·‚' ) ='' )
        #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i) +'/ç†®¨å•·‚' , 'ë‚‡. 060', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.', iCutIterMode)
      if (GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ç†ÁÑÆ°ìÇë') ='' )
        #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ç†ÁÑÆ°ìÇë', 'ë‚‡. 070', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.')
      else
        if not IsValidMGod(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ç†ÁÑÆ°ìÇë'), getMes) #_MesNoKor('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ç†ÁÑÆ°ìÇë', 'ë‚‡. 070');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ë‚Æ®¨Ö§èà'      , 15, 2 , 'ë‚‡. 080');
      #_IsValidNoKor_Decimal   ('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ë‚Æ®¨Ö§èàå®≠'   , 15, 2 , 'ë‚‡. 090');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXX.XXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/äÆ´ê•†´Ñèà'     , 11, 3 , 'ë‚‡. 100');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ÇÎ‡ê•†´Ñèà'     , 15, 2 , 'ë‚‡. 110');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ÇÎ‡ê•†´Ñèà105.3', 15, 2 , 'ë‚‡. 120');
      #_IsValidNoKor_Decimal   ('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ç†´Å†ß†'        , 15, 2 , 'ë‚‡. 130');
      #_IsValidNoKor_Decimal   ('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ç†´à·Á®·´'      , 15, 0 , 'ë‚‡. 140');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/ç†´à·Á®·´105.3' , 15, 0 , 'ë‚‡. 150');
      tbool := False
      z := 3;
      n := 0;
      stj := 0;
      for (k := 0; k <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/äÆ´èàç†´é·≠'); k++)
      {
        if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/äÆ´èàç†´é·≠'+ getIter(k))
        {
          tbool:= True;
          if (z <= k)
          {
            n:= n+1;
            z:= z+3;
            stj:=stj+3;
          }

          // ‡•¶®¨ ¢Î‡•ß™® ®‚•‡†‚Æ‡Æ¢ ®ß †§‡•·† ØÆ™†ß†‚•´Ô
          if i>=1
             iCutIterMode :=1;
          else
             iCutIterMode :=-1;
          aKodOsnov:=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/äÆ´èàç†´é·≠'+ getIter(k)+'/äÆ§é·≠Æ¢' ;  sKodOsnov:= GetStrVal(aKodOsnov);
          if (sKodOsnov ='' )
          {
            aKodOsnov:=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/äÆ´èàç†´é·≠'+ getIter(k-stj)+'/äÆ§é·≠Æ¢' ;
            #_InsMes(aKodOsnov, 'ë‚‡. '+string(k+1)+' £‡.1', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó', iCutIterMode);
          }
          if not IsValidDecimal(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/äÆ´èàç†´é·≠'+ getIter(k)+'/äÆ´èàç†´'), 11, 3, getMes,  True)
            #_NoKor_('XXXXXXXXXXX.XXX' ,'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/äÆ´èàç†´é·≠'+ getIter(k-stj)+'/äÆ´èàç†´', 'ë‚‡. '+string(k+1)+' £‡.2', iCutIterMode);
        }
      }
      if not tbool
        #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´çÆ¢'+ getIter(i)+'/äÆ´èàç†´é·≠/äÆ´èàç†´', '£‡.1', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ï 1 ·‚‡ÆÁ™†');
    }
  }
  for (i := 0; i <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'); i++)
  {
    if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i))
    {
      tbool1:= False;
      aKodDPI  :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i) +'/äÆ§Ñèà'                             ;  sKodDPI  := GetStrVal(aKodDPI  );
      aKBK     :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i) +'/äÅä'                                ;  sKBK     := GetStrVal(aKBK     );
      aOKEI    :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i) +'/éäÖà'                               ;  sOKEI    := GetStrVal(aOKEI    );
      aNalIsch :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i) +'/ç†´à·Á®·´'                          ;  sNalIsch := GetStrVal(aNalIsch );
      aNalBaza :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i) +'/ç†´Å†ß†'                            ;  sNalBaza := GetStrVal(aNalBaza );
      if not IsValidKBK(sKBK, getMes) #_MesNoKor(aKBK, 'ë‚‡. 020');
      if (sOKEI ='' )
        #_InsMes(aOKEI, 'ë‚‡. 030', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if (sKodDPI ='' )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if (sKodDPI ='03401' )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'ê†ß§•´ 5 ≠• ß†ØÆ´≠Ô•‚·Ô ØÆ ØÆØ„‚≠Æ¨„ £†ß„ (™Æ§ ¢®§† ØÆ´•ß≠Æ£Æ ®·™ÆØ†•¨Æ£Æ "03401")');
      if (sKodDPI ='03400') and (sKBK <>'00000000000000000000')
        #_InsMes(aKBK, 'ë‚‡. 020', 'èÆ ™Æ§„ ¢®§† ØÆ´•ß≠Æ£Æ ®·™ÆØ†•¨Æ£Æ "03400" äÅä="00000000000000000000")');

      #_IsValidNoKor_Decimal   ('XXX.X'             , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i) +'/ç†´ë‚†¢™†'                ,  3,  1, 'ë‚‡. 040');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXXX.XX'  , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/ê†·Áç†´ìØ´/ë‚Æ®¨Ö§èà'      , 15,  2, 'ë‚‡. 070');
      #No_IsValidNoKor_Decimal ('X.XXXXXXXXXXX'     , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/ê†·Áç†´ìØ´/ÑÆ´ÔÑ‡å•‚Ñèà'   ,  1, 10, 'ë‚‡. 080');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXX.XXX'  , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/ê†·Áç†´ìØ´/äÆ´ê•†´Ñèà'     , 11,  3, 'ë‚‡. 090');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/ê†·Áç†´ìØ´/ÇÎ‡ê•†´Ñèà105.3', 15,  2, 'ë‚‡. 110');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/ê†·Áç†´ìØ´/ê†·ÂçèÑÆ·‚'     , 15,  2, 'ë‚‡. 120');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/ê†·Áç†´ìØ´/ê†·ÂçèÄ‰≠¶'     , 15,  2, 'ë‚‡. 130');
      #_IsValidNoKor_Decimal   ('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/ê†·Áç†´ìØ´/ç†´Å†ß†'        , 15,  2, 'ë‚‡. 140');
      #_IsValidNoKor_Decimal   ('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/ê†·Áç†´ìØ´/ç†´à·Á®·´'      , 15,  0, 'ë‚‡. 150');
      #No_IsValidNoKor_Decimal ('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/ê†·Áç†´ìØ´/ç†´à·Á®·´105.3' , 15,  0, 'ë‚‡. 160');
      for (k := 0; k <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'); k++)
      {
        if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k))
        {
          tbool1:= True;
          aOKTMO   :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k) +'/éäíåé'              ;  sOKTMO   := GetStrVal(aOKTMO   );
          aSepLicN :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k) +'/ë•‡ã®Êç•§‡'         ;  sSepLicN := GetStrVal(aSepLicN );
          aNomLicN :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k) +'/çÆ¨ã®Êç•§‡'         ;  sNomLicN := GetStrVal(aNomLicN );
          aVidLicN :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k) +'/Ç®§ã®Êç•§‡'         ;  sVidLicN := GetStrVal(aVidLicN );

          // ‡•¶®¨ ¢Î‡•ß™® ®‚•‡†‚Æ‡Æ¢ ®ß †§‡•·† ØÆ™†ß†‚•´Ô

          if not IsValidOKTMO(sOKTMO, getMes) #_MesNoKor(aOKTMO, 'ë‚‡. 050', iCutIterMode);
          if (sSepLicN ='' )
            #_InsMes(aSepLicN, 'ë‚‡. 060', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidSerL_3_4(sSepLicN, getMes) #_MesNoKor(aSepLicN, 'ë‚‡. 060', iCutIterMode);
          if (sNomLicN ='' )
            #_InsMes(aNomLicN, 'ë‚‡. 060', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidNomL(sNomLicN, getMes) #_MesNoKor(aNomLicN, 'ë‚‡. 060', iCutIterMode);
          if (sVidLicN ='' )
            #_InsMes(aVidLicN, 'ë‚‡. 060', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidVidL(sVidLicN, getMes) #_MesNoKor(aVidLicN, 'ë‚‡. 060', iCutIterMode);
          tBool := False;
          z := 3;
          n := 0;
          stj := 0;
          for (j := 0; j <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'); j++)
          {
            if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j))
            {
              tBool:=True;
              if (z <= j)
              {
                n:= n+1;
                z:= z+3;
                stj:=stj+3;
              }
              if i>=1
                iCutIterMode :=1;
              else
                iCutIterMode :=-1;
              aKodOsnov:=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j)+'/äÆ§é·≠Æ¢' ;  sKodOsnov:= GetStrVal(aKodOsnov);
              if (sKodOsnov ='' )
              {
                aKodOsnov:=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j mod 3)+'/äÆ§é·≠Æ¢' ;
                #_InsMes(aKodOsnov,  'ë‚‡. '+string(j+1)+' £‡.1', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', if(i>0,1,0)+if(k>0,1,0));
              }
              if not IsValidDecimal(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j)+'/äÆ´èàç†´'), 11, 3, getMes,  True)
                #_NoKor_('XXXXXXXXXXX.XXX' ,'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j mod 3)+'/äÆ´èàç†´' , 'ë‚‡. '+string(j+1)+' £‡.2', if(i>0,1,0)+if(k>0,1,0));
              if( GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j)+'/äÆÌ‰äØÆ§ß')<>'' )
                if not IsValidDecimal(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j)+'/äÆÌ‰äØÆ§ß'), 1, 1, getMes,  True)
                  #_NoKor_('X.X' ,'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j mod 3)+'/äÆÌ‰äØÆ§ß' , 'ë‚‡. '+string(j+1)+' £‡.3', if(i>0,1,0)+if(k>0,1,0));
              if( GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j)+'/äÆÌ‰ä‚§')<>'' )
                if not IsValidDecimal(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j)+'/äÆÌ‰ä‚§'), 1, 1, getMes,  True)
                  #_NoKor_('X.X' ,'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j mod 3)+'/äÆÌ‰ä‚§' , 'ë‚‡. '+string(j+1)+' £‡.4', if(i>0,1,0)+if(k>0,1,0));
              aPriznkKtd:=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j)+'/è‡®ß≠ä‚§' ;  sPriznkKtd:= GetStrVal(aPriznkKtd);
              if (sPriznkKtd ='' )
              {
                aPriznkKtd:=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠'+ getIter(j mod 3)+'/è‡®ß≠ä‚§' ;
                #_InsMes(aPriznkKtd,  'ë‚‡. '+string(j+1)+' £‡.5', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', if(i>0,1,0)+if(k>0,1,0));
              }
              else
                if not IsValidPriznKtd(sPriznkKtd, getMes) #_MesNoKor(aPriznkG,  'ë‚‡. '+string(j+1)+' £‡.5', if(i>0,1,0)+if(k>0,1,0));
            }
          }
          if not tbool
            #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´'+ getIter(k)+'/äÆ´èàç†´é·≠/äÆ§é·≠Æ¢', '£‡.1', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ï 1 ·‚‡ÆÁ™†');
        }
      }
      if not tbool1
      #_InsMes( 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´'+ getIter(i)+'/äÆ´èàìÁç†´/éäíåé', 'ë‚‡. 050', 'ÑÆ´¶•≠ °Î‚Ï ß†ØÆ´≠•≠ ÂÆ‚Ï 1 ê†ß§•´ 5.1');
    }
  }
  var aRasxOb, aNachPrav, aKonPrav, sRasxOb, aDolDPI, sNachPrav, sKonPrav, sDolDPI: string;
  if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà')
  {
    if  GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È')
    {
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·ÂÑÆ°è•‡'  , 15, 2 , 'ë‚‡. 010');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/é·‚çèç†Áè•‡'   , 15, 2 , 'ë‚‡. 020');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/é·‚çèäÆ≠è•‡'   , 15, 2 , 'ë‚‡. 030');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·ÂÑèàè•‡'  , 15, 2 , 'ë‚‡. 040');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/Ç≠•‡•†´ê†·ÂÑèà', 15, 2 , 'ë‚‡. 050');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/äÆ·¢ê†·ÂÑèà'   , 15, 2 , 'ë‚‡. 060');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/äÆ·¢ê†·ÂÑ‡'    , 15, 2 , 'ë‚‡. 070');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·Âè•‡é°È'  , 15, 2 , 'ë‚‡. 080');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/äÆ·¢à≠ê†·Âè•‡' , 15, 2 , 'ë‚‡. 090');
      #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/ê†·Âé°ÈÑÆ°è•‡' , 15, 2 , 'ë‚‡. 100')
    }
    else
      #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·ÂÑÆ°è•‡', 'ë‚‡. 010', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ê†ß§•´ 6.1');

    aOKEI   := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/éäÖà'         ; sOKEI   := GetStrVal(aOKEI );

    if (sOKEI='')
      #_InsMes(aOKEI, 'ë‚‡. 110', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.');
    tbool := False;
    z := 7;
    n := 0;
    stj := 0;
    for (i:=0 ; i<GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'); i++)
    {
      if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+ getIter(i))
      {
        tbool := True;
        if (z <= i)
        {
          n:= n+1;
          z:= z+7;
          stj:=stj+7;
        }

        aKodDPI := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+ getIter(i) +'/äÆ§Ñèà'; sKodDPI :=GetStrVal(aKodDPI);
        if (sKodDPI ='' )
        {
           aKodDPI := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+ getIter(i-stj) +'/äÆ§Ñèà';
          #_InsMes(aKodDPI,'ë‚‡. '+string(i+1)+ ' £‡.1', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.');
        }
        if not IsValidDecimal(GetStrVal( 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+ getIter(i) +'/äÆ´®ÁÑèà'), 11, 3, getMes,  True)
          #_NoKor_('XXXXXXXXXXX.XXX' , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+ getIter(i-stj) +'/äÆ´®ÁÑèà' , 'ë‚‡. '+string(i+1)+' £‡.2', iCutIterMode);
        if not IsValidDecimal(GetStrVal( 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+ getIter(i) +'/ÑÆ´ÔÑèàé°ÈäÆ´'), 1, 7, getMes,  True)
          #_NoKor_('X.XXXXXXX' , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+ getIter(i-stj) +'/ÑÆ´ÔÑèàé°ÈäÆ´' , 'ë‚‡. '+string(i+1)+' £‡.2', iCutIterMode);
        if not IsValidDecimal(GetStrVal( 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+ getIter(i) +'/ë„¨ê†·ÂÑÆ°èà'), 10, 2, getMes,  True)
          #_NoKor_('XXXXXXXXXX.XX' , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§'+ getIter(i-stj) +'/ë„¨ê†·ÂÑÆ°èà' , 'ë‚‡. '+string(i+1)+' £‡.2', iCutIterMode);
      }
    }
    if not tbool
      #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§/äÆ§Ñèà', '£‡.1', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ï 1 ·‚‡ÆÁ™†');
  }
  for (i:=0 ; i<GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'); i++)
  {
    if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i))
    {
      aKBK       := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/äÅä'        ;  sKBK     := GetStrVal(aKBK    );
      aSepLicN   := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ë•‡ã®Êç•§‡' ;  sSepLicN := GetStrVal(aSepLicN);
      aNomLicN   := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/çÆ¨ã®Êç•§‡' ;  sNomLicN := GetStrVal(aNomLicN);
      aVidLicN   := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/Ç®§ã®Êç•§‡' ;  sVidLicN := GetStrVal(aVidLicN);
      aOKEI      := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/éäÖà'       ;  sOKEI    := GetStrVal(aOKEI   );
      aOKTMO     := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/éäíåé'      ;  sOKTMO   := GetStrVal(aOKTMO );
      aPriznkKtd := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/è‡®ß≠ä‚§'   ;  sPriznkKtd := GetStrVal(aPriznkKtd );
      if (sKBK ='' )
        #_InsMes(aKBK, 'ë‚‡. 010', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.')
      else
        if not IsValidKBK(sKBK, getMes) #_MesNoKor(aKBK, 'ë‚‡. 010');
      if (sSepLicN ='' )
        #_InsMes(aSepLicN, 'ë‚‡. 020', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.')
      else
        if not IsValidSerL(sSepLicN, getMes) #_MesNoKor(aSepLicN, 'ë‚‡. 020');
      if (sNomLicN ='' )
        #_InsMes(aNomLicN, 'ë‚‡. 020', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.')
      else
        if not IsValidNomL(sNomLicN, getMes) #_MesNoKor(aNomLicN, 'ë‚‡. 020');
      if (sVidLicN ='' )
        #_InsMes(aVidLicN, 'ë‚‡. 020', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.')
      else
        if not IsValidVidL(sVidLicN, getMes) #_MesNoKor(aVidLicN, 'ë‚‡. 020');
      if (sOKEI ='' )
        #_InsMes(aOKEI, 'ë‚‡. 030', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.');
      if (sOKTMO ='' )
        #_InsMes(aOKTMO, 'ë‚‡. 040', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.')
      else
        if not IsValidOKTMO(sOKTMO, getMes) #_MesNoKor(aOKTMO, 'ë‚‡. 040');
      if (sPriznkKtd ='' )
        #_InsMes(aPriznkKtd, 'ë‚‡. 055', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.')
      else
        if not IsValidPriznKtd(sPriznkKtd, getMes) #_MesNoKor(aPriznkKtd, 'ë‚‡. 055');
      if (GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ä‚§') <>'' )
        if not IsValidKtd(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ä‚§'), getMes) #_MesNoKor('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ä‚§', 'ë‚‡. 050');
      tbool := False;
      z:=1;
      k:=19;
      stj:=0;
      for (j :=0; j<GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ'); j++)
      {
        if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ'+ getIter(j))
        {
          if j>=k
          {
           z:=z+1;
           k:=k+19;
           stj:=stj+19;
          }
          if i>=1
            flIter :=1;
          else
            flIter :=-1;

          tbool := True;
          aKodDPI := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ'+ getIter(j) +'/äÆ§Ñèà'; sKodDPI :=GetStrVal(aKodDPI);
          if (sKodDPI ='' )
            #_InsMes(aKodDPI, 'ë‚‡. '+string(j+1) +' £‡.1', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.',flIter);
          else
            if not IsValidKodDpi(sKodDPI, getMes)  #_MesNoKor(aKodDPI,  'ë‚‡. '+string(j+1)+' £‡.1', if(i>0,1,0)+if(k>0,1,0));
          aKodOsnov := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ'+ getIter(j) +'/äÆ§é·≠Æ¢'; sKodOsnov := GetStrVal(aKodOsnov);
          if (sKodOsnov ='' )
            {
              aKodOsnov := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ'+ getIter(j-stj) +'/äÆ§é·≠Æ¢';
              #_InsMes(aKodOsnov, 'ë‚‡. '+string(j+1) + ' £‡.2', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.',flIter);
            }
          else
            if not IsValidKodOsn(sKodOsnov, getMes)  #_MesNoKor(aKodOsnov,  'ë‚‡. '+string(j+1)+' £‡.2', if(i>0,1,0)+if(k>0,1,0));
          aKolDPI   := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ'+ getIter(j) +'/äÆ´Ñèà'  ; sKolDPI   := GetStrVal(aKolDPI  );
          if (sKolDPI ='' )
            {
              aKolDPI   := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ'+ getIter(j-stj) +'/äÆ´Ñèà'  ;
              #_InsMes(aKolDPI,'ë‚‡. '+string(j+1) +' £‡.3', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.',flIter)
            }
        }
      }
      if not tbool
         #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/Ñ†≠Ñèàì£/Ñ†≠Ñèàì£ìÁ/äÆ§Ñèà', '£‡.1', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ï 1 ·‚‡ÆÁ™†');
      if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´')
      {
        #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/é·‚ç†Áè•‡'            , 15, 0, 'ë‚‡. 060');
        #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·Âéíè•‡Ç·', 15, 0, 'ë‚‡. 070');
        #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXï.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/å†‚ê†·Â'    , 15, 2, 'ë‚‡. 080');
        #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·ÂÄ¨à¨„È' , 15, 2, 'ë‚‡. 090');
        #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXïï.XX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·Âê•™Æ≠'  , 15, 2, 'ë‚‡. 100');
        #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/ê†·ÂéíÇÎÁ'            , 15, 0, 'ë‚‡. 110');
        #No_IsValidNoKor_Decimal('X.XXXX'            , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/äÆÌ‰ä‚'               ,  1, 4, 'ë‚‡. 120');
        #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX'     , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/à·Á®·´ìÁì£'           , 15, 0, 'ë‚‡. 130');
        #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/ç†´ÇÎÁè‡•§'           , 15, 0, 'ë‚‡. 140');
        #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/à·Á®·´è•‡ìØ´'         , 15, 0, 'ë‚‡. 150');
        #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX'   , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/é·‚äÆ≠è•‡'            , 15, 0, 'ë‚‡. 160');

        if GetDblVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/äÆÌ‰ä‚')>0.3
          #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/äÆÌ‰ä‚', 'ë‚‡. 120', 'á≠†Á•≠®• ™ÆÌ‰‰®Ê®•≠‚† ä‚ <= 0.3');
      }
      else
        #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ìØ´/à·Á®·´ìÁì£', 'ë‚‡. 130', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ï 1 ê†ß§•´ 7.2');


      for (j := 0; j < GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+getIter(i)+'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡'); j++)
      {
        if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡'+ getIter(j))
        {
          aNachPrav := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡'+ getIter(j) +'/ç†Áè‡†¢ç†´ÇÎÁ' ;  sNachPrav := GetStrVal(aNachPrav);
          aKonPrav  := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡'+ getIter(j) +'/äÆ≠è‡†¢ç†´ÇÎÁ' ;  sKonPrav  := GetStrVal(aKonPrav );
          #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX'  , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡'+ getIter(j) +'/ç†´ÇÎÁç†Á'   , 15, 0, 'ë‚‡. 180');
          #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡'+ getIter(j) +'/ç†´ÇÎÁè‡•§'  , 15, 0, 'ë‚‡. 190');
          #No_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡'+ getIter(j) +'/ç†´ÇÎÁí•™'   , 15, 0, 'ë‚‡. 200');
          #_IsValidNoKor_Decimal('XXXXXXXXXXXXXXX  ', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£'+ getIter(i) +'/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡'+ getIter(j) +'/é·‚ç†´ÇÎÁäÆ≠', 15, 0, 'ë‚‡. 210');
          if (aNachPrav ='' )
            #_InsMes(aNachPrav, 'ë‚‡. 170', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.')
          else
            if not IsValidMGod(sNachPrav, getMes) #_MesNoKor(aNachPrav, 'ë‚‡. 170');
          if (aKonPrav ='' )
            #_InsMes(aKonPrav, 'ë‚‡. 220', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.')
          else
            if not IsValidMGod(sKonPrav, getMes) #_MesNoKor(aKonPrav, 'ë‚‡. 20');
        }
      }
    }
  }

  for (i := 0; i <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'); i++)
  {
    if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i))
    {
      tbool1:= False;
      aKodDPI  :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/äÆ§Ñèà'     ;  sKodDPI  := GetStrVal(aKodDPI  );
      aKBK     :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/äÅä'        ;  sKBK     := GetStrVal(aKBK     );
      aOKEI    :=  'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/éäÖà'       ;  sOKEI    := GetStrVal(aOKEI    );
      if not IsValidKBK(sKBK, getMes) #_MesNoKor(aKBK, 'ë‚‡. 020');
      if (sOKEI ='' )
        #_InsMes(aOKEI, 'ë‚‡. 030', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if (sKodDPI ='' )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚');
      if not ((sKodDPI ='03100' ) )
        #_InsMes(aKodDPI, 'ë‚‡. 010', 'äÆ§ ¢®§† §Æ°Î‚Æ£Æ ØÆ´•ß≠Æ£Æ ®·™ÆØ†•¨Æ£Æ ¨Æ¶•‚ Ø‡®≠®¨†‚Ï ‚Æ´Ï™Æ ß≠†Á•≠®Ô 03100');
      if (sOKEI <>'168' )
        #_InsMes(aOKEI, 'ë‚‡. 030', 'äÆ§ °Ó§¶•‚≠Æ© ™´†··®‰®™†Ê®® ¨Æ¶•‚ Ø‡®≠®¨†‚Ï ‚Æ´Ï™Æ ß≠†Á•≠®Ô 168');
      tbool := False;
      for (j := 0; j <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'); j++)
      {
        if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j) )
        {
          tbool := True;
          aOKTMO   := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/éäíåé'     ;  sOKTMO   := GetStrVal(aOKTMO   );
          aSepLicN := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/ë•‡ã®Êç•§‡';  sSepLicN := GetStrVal(aSepLicN );
          aNomLicN := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/çÆ¨ã®Êç•§‡';  sNomLicN := GetStrVal(aNomLicN );
          aVidLicN := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/Ç®§ã®Êç•§‡';  sVidLicN := GetStrVal(aVidLicN );
          aPriznkG := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/è‡®ß≠ä£'   ;  sPriznkG := GetStrVal(aPriznkG );
          aGodNach := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/ÉÆ§ç†ÁÑÆ°' ;  sGodNach := GetStrVal(aGodNach );

          if not IsValidOKTMO(sOKTMO, getMes) #_MesNoKor(aOKTMO, 'ë‚‡. 040', iCutIterMode);
          if (sSepLicN ='' )
            #_InsMes(aSepLicN, 'ë‚‡. 050', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidSerL(sSepLicN, getMes) #_MesNoKor(aSepLicN, 'ë‚‡. 050', iCutIterMode);
          if (sNomLicN ='' )
            #_InsMes(aNomLicN, 'ë‚‡. 050', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidNomL(sNomLicN, getMes) #_MesNoKor(aNomLicN, 'ë‚‡. 050', iCutIterMode);
          if (sVidLicN ='' )
            #_InsMes(aVidLicN, 'ë‚‡. 050', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidVidL(sVidLicN, getMes) #_MesNoKor(aVidLicN, 'ë‚‡. 050', iCutIterMode);
          if (sGodNach ='' )
            #_InsMes(aGodNach, 'ë‚‡. 070', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidGod(sGodNach, getMes) #_MesNoKor(aGodNach, 'ë‚‡. 070', iCutIterMode);
          if (sPriznkG ='' )
            #_InsMes(aPriznkG, 'ë‚‡. 110', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó. á†ØÆ´≠®‚• •• ® Ø‡Æ®ß¢•§®‚• Ø•‡•‡†·Á•‚', iCutIterMode)
          else
            if not IsValidPrizn(sPriznkG, getMes) #_MesNoKor(aPriznkG, 'ë‚‡. 110', iCutIterMode);



          #_IsValidNoKor_Decimal('X.XX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/ë‚•ØÇÎ‡†°' , 1, 2, 'ë‚‡. 060');
          #_IsValidNoKor_Decimal('XXXXXXXX.XXXX', 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/äÆÌ‰ä≠§§'  , 8, 4, 'ë‚‡. 080');
          #_IsValidNoKor_Decimal('XXX.XX'       , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/ë‡ì‡ñ•≠'   , 3, 2, 'ë‚‡. 090');
          #_IsValidNoKor_Decimal('XXX.XXXX'     , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/ë‡á≠†Áä„‡·', 3, 4, 'ë‚‡. 100');
          #_IsValidNoKor_Decimal('X.XX'         , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/äÆÌ‰ä£'    , 1, 2, 'ë‚‡. 120');
          #_IsValidNoKor_Decimal('XXX.X'        , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/ë‚†¢ùè'    , 3, 1, 'ë‚‡. 130');
          #_IsValidNoKor_Decimal('XXXXXXXXXXX'  , 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j)+'/ë„¨à·Áç†´' ,11, 0, 'ë‚‡. 140');

          z := 3;
          stj := 0;
          for (g := 0; g <  GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j) +'/äÆ´ç•‰‚ç†´é·≠'); g++)
          {
            if GetFldVis('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j) +'/äÆ´ç•‰‚ç†´é·≠'+ getIter(g) )
            {
              if j>=1
                 iCutIterMode :=1;
              else
                 iCutIterMode :=-1;
              if (z <= g)
              {
                z:= z+3;
                stj:=stj+3;
              }
              aKodOsnov := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j) +'/äÆ´ç•‰‚ç†´é·≠'+ getIter(g)+'/äÆ§é·≠Æ¢'; sKodOsnov := GetStrVal(aKodOsnov);
              if (sKodOsnov ='' )
              {
                aKodOsnov := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j) +'/äÆ´ç•‰‚ç†´é·≠'+ getIter(g-stj) +'/äÆ§é·≠Æ¢';
                #_InsMes(aKodOsnov, 'ë‚‡. '+string(j+1) + ' £‡.1', 'ë‚‡Æ™† Æ°Ôß†‚•´Ï≠† ™ ß†ØÆ´≠•≠®Ó.',flIter);
              }
              if not IsValidDecimal(GetStrVal('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j) +'/äÆ´ç•‰‚ç†´é·≠'+ getIter(g)+'/äÆ´ç•‰‚ç†´'), 11, 3, getMes,  True)
                #_NoKor_('XXXXXXXXXXX.XXX' ,'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ'+ getIter(j) +'/äÆ´ç•‰‚ç†´é·≠'+ getIter(g-stj)+'/äÆ´ç•‰‚ç†´' , 'ë‚‡. '+string(g+1)+' £‡.2', iCutIterMode);
            }
          }
        }
      }
      if not tbool
        #_InsMes('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚çÑÑ'+ getIter(i) +'/ê†·Áç†´ìÁ/éäíåé' , 'ë‚‡. 040', 'ÑÆ´¶≠† °Î‚Ï ß†ØÆ´≠•≠† ÂÆ‚Ô °Î 1 ê†ß§•´ 3.1');
    }
  }
 //***************************************************************************************************************************************************
@end.
//#endregion On_Check ÑÖâëíÇàü ÇõèéãçüÖåõÖ èêà èêéÇÖêäÖ èéãÖâ
//************************************************************************************************************


//============================================================================================================
//#region On_Recalc ÑÖâëíÇàü ÇõèéãçüÖåõÖ èêà êÄëóíÖ èéãÖâ
//------------------------------------------------------------------------------------------------------------
@Script On_Recalc : boolean;
  //==========================================================================================================
  //#region ëÖêÇàë On_Recalc
  //----------------------------------------------------------------------------------------------------------
  procedure _Log(_strAdr, _strMes, _strVal : string; _flIter : integer = 1);
  {
    MesError.InsertRasch('', _strAdr, _strMes, _strVal, _flIter);
  }

  function GV(_strAdr : string) : string;
  {
    Result := GetStrValFormat(_strAdr);
  }

  #declare SV(_adr, _val)
    SetFldVal(#_adr, #_val);
    #_val := GetDblVal(#_adr);
  #end
  //#endregion ëÖêÇàë On_Recalc
  //**********************************************************************************************************
@begin
  //ÑÆ™„¨•≠‚
  if ((GetStrVal('î†©´/ÑÆ™„¨•≠‚/Ñ†‚†ÑÆ™') = '') or (GetStrVal('î†©´/ÑÆ™„¨•≠‚/Ñ†‚†ÑÆ™') = 'ÑÑ.åå.ÉÉÉÉ'))
    SetFldVal('î†©´/ÑÆ™„¨•≠‚/Ñ†‚†ÑÆ™', DateToStr(Cur_Date, 'DD.MM.YYYY'));

  var flIter, i, j, k, g : integer;

  var r6a010, r6a020, r6a030, r6a040, r6a050, r6a060, r6a070, r6a080, r6a090, r6a100, r2p1a130, r2p1a140, r2p1a150
    , r6g2a, r6g3a, r6g4a
    , r3a040, r3a045, r3a050 ,r3p1a210 ,r3p1a215 ,r3p1a220, r3p1a310
    , r5p2a070, r5p2a140, aGr5_1, sGr5_1, aGr5_2
    , r7p2a060, r7p2a070, r7p2a080, r7p2a090, r7p2a100, r7p2a110, r7p2a120, r7p2a130, r7p2a140, r7p2a150, r7p2a160
    , r7p3a180, r7p3a190, r7p3a200, r7p3a210

    , mr3v040, mr3v050, mr3v220, mr3v210: string;

  var r6v010, r6v020, r6v030, r6v040, r6v050, r6v060, r6v070, r6v080, r6v090, r6v100, r2p1v130, r2p1v140, r2p1v150
    , r6g2v, r6g3v, r6g4v, Sum_r6g2v
    , r3v040, r3v045, r3v050, r3p1v210, r3p1v215, r3p1v220, r3p1v310
    , r5p2v070, r5p2v140, Summa_Gr5_2, sGr5_2
    , r7p2v060, r7p2v070, r7p2v080, r7p2v090, r7p2v100, r7p2v110, r7p2v120, r7p2v130, r7p2v140, r7p2v150, r7p2v160
    , r7p3v180, r7p3v190, r7p3v200, r7p3v210 : double;

  var XMLAdr : string;
  var CountI, CountJ, CountK : longint;

  CountI := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚');
  for (i := 0; i < CountI; i++)
  {
    XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚' + getIter(i);

    CountJ := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚/èÆ™ê†·Áç†´');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´ç•‰‚' + getIter(i) + '/èÆ™ê†·Áç†´' + getIter(j);

      r2p1a130 := XMLAdr + '/ç†´à·Á®·´';   r2p1v130 := GetStrVal(r2p1a130);
      r2p1a140 := XMLAdr + '/ç†´ÇÎÁ'   ;   r2p1v140 := GetDblVal(r2p1a140);
      r2p1a150 := XMLAdr + '/ç†´ìØ´'   ;   r2p1v150 := GetDblVal(r2p1a150);

      if  r2p1v130 > r2p1v140
      {
        r2p1v150 := r2p1v130 - r2p1v140;   #SV(r2p1a150, r2p1v150);

        _Log(r2p1a150, 'ë‚‡.150 = ·‚‡. 130 - ·‚‡. 140', GV(r2p1a150)+' = '+GV(r2p1a130)+' - '+GV(r2p1a140));
      }
      else
      {
        r2p1v150 := 0;   #SV(r2p1a150, r2p1v150);

        _Log(r2p1a150, 'ë‚‡.150 = 0, ‚.™. ·‚‡. 130 <= ·‚‡. 140', GV(r2p1a150)+' = 0 (≠„´Ó)');
      }

    }
  }

  CountI := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß');
  for (i := 0; i < CountI; i++)
  {
    XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß' + getIter(i);

    r3a040 := XMLAdr + '/ë„¨à·Áç†´';   r3v040 := 0;
    r3a045 := XMLAdr + '/ë„¨ç†´ÇÎÁ';   r3v045 := GetDblVal(r3a045);
    r3a050 := XMLAdr + '/ë„¨ç†´ìØ´';   r3v050 := 0;

    mr3v040 := '';
    mr3v050 := '';

    CountJ := GetCountFld(XMLAdr + '/èÆ™ê†·Áç†´');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß' + getIter(i) + '/èÆ™ê†·Áç†´' + getIter(j);
      r3p1a210 := XMLAdr + '/ë„¨à·Áç†´';   r3p1v210  := 0;
      r3p1a215 := XMLAdr + '/ë„¨ç†´ÇÎÁ';   r3p1v215  := GetDblVal(r3p1a215);
      r3p1a220 := XMLAdr + '/ë„¨ç†´ìØ´';   r3p1v220  := 0;

      CountK := GetCountFld(XMLAdr + '/äÆ´Ñèàá†´');
      for (k := 0; k < CountK; k++)
      {
        XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·Áç†´É†ß' + getIter(i) + '/èÆ™ê†·Áç†´' + getIter(j) + '/äÆ´Ñèàá†´' + getIter(k);
        r3p1a310 := XMLAdr + '/ç†´à·Á®·´á´¶';   r3p1v310  := GetDblVal(r3p1a310);
        r3p1v210  +=          r3p1v310 ;
        mr3v210 += ' + '+GV(r3p1a310);
      }
      mr3v210 := '('+SubStr(mr3v210, 4, Length(mr3v210) - 3)+')';
      #SV(r3p1a210, r3p1v210);
      _Log(r3p1a210, 'ë‚‡. 210 = ë„¨¨†(c‚‡. 310)', GV(r3p1a210)+' = '+mr3v210);

      r3p1v220 := r3p1v210 -r3p1v215;
      mr3v220 := GV(r3p1a210)+' - '+GV(r3p1a215);
      #SV(r3p1a220, r3p1v220);
      _Log(r3p1a220, 'ë‚‡. 220 = c‚‡. 210 - c‚‡. 215', GV(r3p1a220)+' = '+mr3v220);

      r3v040  +=          r3p1v220 ;
      mr3v040 += ' + '+GV(r3p1a220);
    }

    mr3v040 := '('+SubStr(mr3v040, 4, Length(mr3v040) - 3)+')';
    #SV(r3a040, r3v040);
    _Log(r3a040, 'ë‚‡. 040 = ë„¨¨†(c‚‡. 220)', GV(r3a040)+' = '+mr3v040);

    r3v050 := r3v040 -r3v045;
    mr3v050 := GV(r3a040)+' - '+GV(r3a045);
    #SV(r3a050, r3v050);
    _Log(r3a050, 'ë‚‡. 050 = c‚‡. 040 - c‚‡. 045', GV(r3a050)+' = '+mr3v050);

  }

  CountI := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´');
  for (i := 0; i < CountI; i++)
  {
    XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´' + getIter(i);

    r5p2a070 := XMLAdr + '/ê†·Áç†´ìØ´/ë‚Æ®¨Ö§èà';   r5p2v070 := GetDblVal(r5p2a070);
    r5p2a140 := XMLAdr + '/ê†·Áç†´ìØ´/ç†´Å†ß†'  ;   r5p2v140 := 0;

    Summa_Gr5_2 := 0;

    CountJ := GetCountFld(XMLAdr + '/äÆ´èàìÁç†´');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´' + getIter(i) + '/äÆ´èàìÁç†´' + getIter(j);

      CountK := GetCountFld(XMLAdr + '/äÆ´èàç†´é·≠');
      for (k := 0; k < CountK; k++)
      {
        XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´à·™´' + getIter(i) + '/äÆ´èàìÁç†´' + getIter(j) + '/äÆ´èàç†´é·≠' + getIter(k);

        aGr5_1 := XMLAdr + '/äÆ§é·≠Æ¢';   sGr5_1 := GetStrVal(aGr5_1);
        aGr5_2 := XMLAdr + '/äÆ´èàç†´';   sGr5_2 := GetDblVal(aGr5_2);

        if (sGr5_1 <> '')
          if (SubStr(sGr5_1, 1, 1) <> '1')
            Summa_Gr5_2 += sGr5_2;
      }

      r5p2v140 := Summa_Gr5_2 * r5p2v070;
      #SV(r5p2a140, r5p2v140);
      _Log(r5p2a140, 'ë‚‡. 140 = ë„¨¨† (ê5.1, £‡. 2) * ê5.2 ·‚‡. 070', GV(r5p2a140)+' = '+String(Summa_Gr5_2)+' * '+GV(r5p2a070));
    }
  }

  r6a010 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·ÂÑÆ°è•‡'  ;   r6v010 := GetDblVal(r6a010);
  r6a020 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/é·‚çèç†Áè•‡'   ;   r6v020 := GetDblVal(r6a020);
  r6a030 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/é·‚çèäÆ≠è•‡'   ;   r6v030 := GetDblVal(r6a030);
  r6a050 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/Ç≠•‡•†´ê†·ÂÑèà';   r6v050 := GetDblVal(r6a050);
  r6a060 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/äÆ·¢ê†·ÂÑèà'   ;   r6v060 := GetDblVal(r6a060);
  r6a070 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/äÆ·¢ê†·ÂÑ‡'    ;   r6v070 := GetDblVal(r6a070);
  r6a080 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·Âè•‡é°È'  ;   r6v080 := GetDblVal(r6a080);
  r6a040 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/è‡ê†·ÂÑèàè•‡'  ;
  r6a090 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/äÆ·¢à≠ê†·Âè•‡' ;
  r6a100 := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé°È/ê†·Âé°ÈÑÆ°è•‡' ;

  if (r6v080 <> 0)
  {
    r6v090 := r6v050 + r6v060 + r6v070 * r6v010 / r6v080;   #SV(r6a090, r6v090);

    _Log(r6a090, 'ë‚‡.090 = ·‚‡. 050 + ·‚‡. 060 + ·‚‡. 070 * ·‚‡. 010 / ·‚‡. 080', GV(r6a090)+' = '+GV(r6a050) +' + '+GV(r6a060)+' + '+GV(r6a070) +' * '+GV(r6a010) +' / '+GV(r6a080));
  }
  else
  {
    r6v090 := r6v050 + r6v060;   #SV(r6a090, r6v090);

    _Log(r6a090, 'ë‚‡.090 = ·‚‡. 050 + ·‚‡. 060', GV(r6a090)+' = '+ GV(r6a050) +' + '+ GV(r6a060));
  }

  r6v040 := r6v010 + r6v020 - r6v030;   #SV(r6a040, r6v040);
  r6v100 := r6v040 + r6v090         ;   #SV(r6a100, r6v100);

  _Log(r6a040, 'ë‚‡.040 = ·‚‡. 010 + ·‚‡. 020 - ·‚‡. 030', GV(r6a040)+' = '+GV(r6a010)+' + '+GV(r6a020)+' - '+GV(r6a030));
  _Log(r6a100, 'ë‚‡.100 = ·‚‡. 040 + ·‚‡. 090'           , GV(r6a100)+' = '+GV(r6a040)+' + '+GV(r6a090)                 );

  Sum_r6g2v := 0;

  CountI := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§');
  for (i := 0; i < CountI; i++)
  {
    XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§' + getIter(i);

    r6g2a := XMLAdr + '/äÆ´®ÁÑèà';   Sum_r6g2v += GetDblVal(r6g2a);
  }

  if (Sum_r6g2v <> 0)
  {
    for (i := 0; i < CountI; i++)
    {
      XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/ë‚Æ®¨Ö§Ñèà/ë„¨ê†·ÂÑèàé‚§/ë„¨ê†·ÂÑèàäÆ§' + getIter(i);

      r6g2a := XMLAdr + '/äÆ´®ÁÑèà'     ;   r6g2v := GetDblVal(r6g2a);
      r6g3a := XMLAdr + '/ÑÆ´ÔÑèàé°ÈäÆ´';
      r6g4a := XMLAdr + '/ë„¨ê†·ÂÑÆ°èà' ;

      r6g3v := r6g2v / Sum_r6g2v;   #SV(r6g3a, r6g3v);

      _Log(r6g3a, 'ë‚‡. '+LPadCh(String(i+1), '0', 2)+', £‡. 3 = £‡. 2 / c„¨¨†(£‡. 2)', GV(r6g3a)+' = '+ GV(r6g2a)+' / '+String(Sum_r6g2v), -1);

      if (r6g2v <> 0)
      {
        r6g4v := r6g3v * r6v100;   #SV(r6g4a, r6g4v);

        _Log(r6g4a, 'ë‚‡. '+LPadCh(String(i+1), '0', 2)+', £‡. 4 = £‡. 3 * ·‚‡. 100', GV(r6g4a)+' = '+ GV(r6g3a)+' * '+GV(r6a100), -1);
      }
    }
  }

  CountI := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£');
  for (i := 0; i < CountI; i++)
  {
    XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£' + getIter(i);

    r7p2a060 := XMLAdr + '/ê†·Áç†´ìØ´/é·‚ç†Áè•‡'            ;   r7p2v060 := GetDblVal(r7p2a060);
    r7p2a080 := XMLAdr + '/ê†·Áç†´ìØ´/ê†·Âéíè•‡/å†‚ê†·Â'    ;   r7p2v080 := GetDblVal(r7p2a080);
    r7p2a090 := XMLAdr + '/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·ÂÄ¨à¨„È' ;   r7p2v090 := GetDblVal(r7p2a090);
    r7p2a100 := XMLAdr + '/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·Âê•™Æ≠'  ;   r7p2v100 := GetDblVal(r7p2a100);
    r7p2a120 := XMLAdr + '/ê†·Áç†´ìØ´/äÆÌ‰ä‚'               ;   r7p2v120 := GetDblVal(r7p2a120);
    r7p2a130 := XMLAdr + '/ê†·Áç†´ìØ´/à·Á®·´ìÁì£'           ;   r7p2v130 := GetDblVal(r7p2a130);
    r7p2a070 := XMLAdr + '/ê†·Áç†´ìØ´/ê†·Âéíè•‡/ê†·Âéíè•‡Ç·';
    r7p2a110 := XMLAdr + '/ê†·Áç†´ìØ´/ê†·ÂéíÇÎÁ'            ;
    r7p2a140 := XMLAdr + '/ê†·Áç†´ìØ´/ç†´ÇÎÁè‡•§'           ;
    r7p2a150 := XMLAdr + '/ê†·Áç†´ìØ´/à·Á®·´è•‡ìØ´'         ;
    r7p2a160 := XMLAdr + '/ê†·Áç†´ìØ´/é·‚äÆ≠è•‡'            ;

    r7p2v070 := r7p2v080 + r7p2v090 + r7p2v100;   #SV(r7p2a070, r7p2v070);
    r7p2v140 := r7p2v130 * r7p2v120           ;   #SV(r7p2a140, r7p2v140);

    _Log(r7p2a070, 'ë‚‡.070 = ·‚‡. 080 + ·‚‡. 090 + ·‚‡. 100', GV(r7p2a070)+' = '+ GV(r7p2a080)+' + '+GV(r7p2a090)+' + '+GV(r7p2a100));
    _Log(r7p2a140, 'ë‚‡.140 = ·‚‡. 130 * ·‚‡. 120'           , GV(r7p2a140)+' = '+ GV(r7p2a130)+' * '+GV(r7p2a120)                   );

    if ((r7p2v060+ r7p2v070)< r7p2v140 )
    {
      r7p2v110 := r7p2v060 + r7p2v070;   #SV(r7p2a110, r7p2v110);

      _Log(r7p2a110, 'ë‚‡.110 = ·‚‡. 060 + ·‚‡. 070', GV(r7p2a110)+' = '+ GV(r7p2a060)+' + '+GV(r7p2a070));
    }
    else
    {
      r7p2v110 := r7p2v140;   #SV(r7p2a110, r7p2v110);

      _Log(r7p2a110, 'ë‚‡.110 = ·‚‡. 140', GV(r7p2a110 )+' = '+ GV(r7p2a140));
    }

    r7p2v150 := r7p2v130 - r7p2v110           ;   #SV(r7p2a150, r7p2v150);
    r7p2v160 := r7p2v060 + r7p2v070 - r7p2v110;   #SV(r7p2a160, r7p2v160);

    _Log(r7p2a150, 'ë‚‡.150 = ·‚‡. 130 - ·‚‡. 110'           , GV(r7p2a150) +' = '+ GV(r7p2a130)+' - '+GV(r7p2a110)                   );
    _Log(r7p2a160, 'ë‚‡.160 = ·‚‡. 060 + ·‚‡. 070 - ·‚‡. 110', GV(r7p2a160) +' = '+ GV(r7p2a060)+' + '+GV(r7p2a070)+' - '+GV(r7p2a110));

    CountJ := GetCountFld('î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£' + getIter(i) + '/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdr := 'î†©´/ÑÆ™„¨•≠‚/çÑèà/à·ÁìØ´ç†´ì£' + getIter(i) + '/ê†·Áç†´ÇÎÁ/ê†·Áç†´ÇÎÁè•‡' + getIter(j);

      r7p3a180 := XMLAdr + '/ç†´ÇÎÁç†Á'   ;   r7p3v180 := GetDblVal(r7p3a180);
      r7p3a190 := XMLAdr + '/ç†´ÇÎÁè‡•§'  ;   r7p3v190 := GetDblVal(r7p3a190);
      r7p3a200 := XMLAdr + '/ç†´ÇÎÁí•™'   ;   r7p3v200 := GetDblVal(r7p3a200);
      r7p3a210 := XMLAdr + '/é·‚ç†´ÇÎÁäÆ≠';

      if (r7p3v180 <> 0) or (r7p3v190 <> 0) or (r7p3v200 <> 0)
      {
        r7p3v210 := r7p3v180 - r7p3v190 - r7p3v200;   #SV(r7p3a210, r7p3v210);

        _Log(r7p3a210, 'ë‚‡.210 = ·‚‡. 180 - ·‚‡. 190 - ·‚‡. 200', GV(r7p3a210)+' = '+ GV(r7p3a180)+' - '+GV(r7p3a190)+' - '+GV(r7p3a200));
      }
    }
  }
@end.
//#endregion On_Recalc ÑÖâëíÇàü ÇõèéãçüÖåõÖ èêà êÄëóíÖ èéãÖâ
//************************************************************************************************************


//============================================================================================================
//#region On_ExportXML ÑÖâëíÇàü ÇõèéãçüÖåõÖ èêà ùäëèéêíÖ Ç XML
//------------------------------------------------------------------------------------------------------------
@Script On_ExportXML : boolean;
@begin
  SetFldVal('î†©´/à§î†©´', Replace(_IdFail_, '.xml', ''));

  if (not XMLMap.ExpToXml(_XmlFileName_)) {
    Message('On_ExportXML: '+ XMLMap.GetStLastError, cancelButton+Warning);
    Exit;
  }

  message('ÇÎ£‡„¶•≠ ¢ ‰†©´ ' + _XmlFileName_);
@end.
//#endregion On_ExportXML ÑÖâëíÇàü ÇõèéãçüÖåõÖ èêà ùäëèéêíÖ Ç XML
//************************************************************************************************************
