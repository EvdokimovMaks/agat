//------------------------------------------------------------------------------------------------------------
//                                                                                    (c) корпорация Галактика
// Галактика 9.1 - модуль "Электронная отчетность"
// Интерфейс редактирования : "Декларация по акцизам на этиловый спирт (1151090)"
//------------------------------------------------------------------------------------------------------------


//============================================================================================================
// #region СЕРВИСНЫЕ МЕТОДЫ
//------------------------------------------------------------------------------------------------------------
@Script GetStrVal(fld:string):string;
@begin
  Result := Trim(String(XMLMAP.GetAttrValueByName(fld)));
@end.

//------------------------------------------------------------------------------------------------------------
@Script GV(fld:string):string;
@begin
  var bufRes: string;

  bufRes := Trim(String(XMLMAP.GetAttrValueByName(fld)));

  if (bufRes = '')
  then Result := '0'
  else if (Double(bufRes) < 0)
       then Result := '('+bufRes+')'
       else Result := bufRes;
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetDblVal(fld:string):double;
@begin
  Result := Double(XMLMAP.GetAttrValueByName(fld));
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetFldVis(fld:string):boolean;
@begin
  Result := False;
  Result := XMLMAP.GetAttrVisByName(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetFldVisInTree(fld:string):boolean;
@begin
  Result := XMLMAP.GetAttrVisByNameInTree(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetPatVal(expr:string):double;
#include AllTaxObj.Vih
@begin
  Result := Double(ПАТ(expr));
@end.

//------------------------------------------------------------------------------------------------------------
@Script SetDblVal(fld:string;val:double);
@begin
  XMLMAP.SetVariantAttrValueByName_Formula(fld, val, 2);
@end.

//------------------------------------------------------------------------------------------------------------
@Script SetFldVal(fld:string; val:string);
@begin
  XMLMAP.SetVariantAttrValueByName_Formula(fld, string(val), 2);
@end.

//------------------------------------------------------------------------------------------------------------
@Script SetNulVal(fld:string);
@begin
  XMLMAP.SetIsNullAttrValueByName(fld, 2);
@end.

//------------------------------------------------------------------------------------------------------------
@Script SetFldVis(fld:string;vis:boolean);
@begin
  XMLMAP.SetAttrVisByName(fld,vis);
@end.

//------------------------------------------------------------------------------------------------------------
@Script MesErrStop(mesMesAdrXML, mesPole, mesMes: string; mesCountIter : integer = 0; mesMod : integer = 0): boolean;
@begin
  MesError.InsertMesError(mesMesAdrXML, Comp(0), '', mesPole, mesMes, mesCountIter, mesMod);
  Result := True;
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetIter(iter:longint):string;
@begin
  Result := '';

  if (iter > 0)
    Result := '[' + String(iter) + ']';
@end.

//------------------------------------------------------------------------------------------------------------
@Script DTS_I(zName: string): string;
@begin
  Result := DoubleToStr(Round(Double(zName)), '[|-]366666666666666666666');
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetStrNull(fld:string):boolean;
@begin
  Result := XMLMAP.GetIsNullAttrValueByName(fld);
@end.
// #endregion СЕРВИСНЫЕ МЕТОДЫ
//************************************************************************************************************


//============================================================================================================
// #region ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ УСТАНОВКЕ ВИДИМОСТИ ПОЛЕЙ
//------------------------------------------------------------------------------------------------------------
@Script On_Visable : boolean;
  //==========================================================================================================
  // #region СЕРВИС On_Visable
  //----------------------------------------------------------------------------------------------------------
  #declare IfVis(adrIfVis)
    SetFldVis(#adrIfVis, not GetStrNull(#adrIfVis));
  #end

  #declare SetVisF(adrIfVis)
    SetFldVis(#adrIfVis, False);
  #end

  #declare SetVisT(adrIfVis)
    SetFldVis(#adrIfVis, True);
  #end
  // #endregion СЕРВИС On_Visable
  //**********************************************************************************************************
@begin
  // #region Файл/Документ/СвНП
  #IfVis('Файл/Документ/СвНП/Тлф')

  var buf : string;
  buf := GetStrVal('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ФормРеорг');

  if (buf = '0')
  {
    #SetVisT('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ'      )
    #SetVisF('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ИННЮЛ')
    #SetVisF('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/КПП'  )
  }
  else
  {
    if    (buf = '1')
       or (buf = '2')
       or (buf = '3')
       or (buf = '5')
       or (buf = '6')
    {
      #SetVisT('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ'      )
      #SetVisT('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ИННЮЛ')
      #SetVisT('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/КПП'  )
    }
    else #SetVisF('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ');
  }
  // #endregion

  // #region Файл/Документ/СвНП
  if     not GetStrNull('Файл/Документ/Подписант/ФИО/Фамилия')
     and not GetStrNull('Файл/Документ/Подписант/ФИО/Имя'    )
  {
    #SetVisT('Файл/Документ/Подписант/ФИО'         )
    #IfVis  ('Файл/Документ/Подписант/ФИО/Отчество')
  }
  else #SetVisF('Файл/Документ/Подписант/ФИО')

  if    (GetStrVal('Файл/Документ/Подписант/ПрПодп') = '2')
     or not GetStrNull('Файл/Документ/Подписант/СвПред/НаимДок')
  {
    #SetVisT('Файл/Документ/Подписант/СвПред'        )
    #IfVis  ('Файл/Документ/Подписант/СвПред/НаимОрг')
  }
  else #SetVisF('Файл/Документ/Подписант/СвПред')
  // #endregion Файл/Документ/Подписант

  var CountI, CountJ, I, J : integer;
  var XMLAdrI, XMLAdrJ : string;
  var fl : boolean;

  // #region Файл/Документ/АкцСпиртАлк/СумНалПУ
  // #region Файл/Документ/АкцСпиртАлк/СумНалПУ/СумНалПУ_МО/СумНалПУКод
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумНалПУ_МО/СумНалПУКод');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СумНалПУ/СумНалПУ_МО/СумНалПУКод' + getIter(i);

    if     not GetStrNull(XMLAdrI + '/КБК'  )
       and not GetStrNull(XMLAdrI + '/НалПУ')
    {
      #SetVisT(XMLAdrI              )
      #IfVis  (XMLAdrI + '/АвансЗач')
    }
    else #SetVisF(XMLAdrI)
  }
  // #endregion Файл/Документ/АкцСпиртАлк/СумНалПУ/СумНалПУ_МО/СумНалПУКод

  // #region Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл
  fl := false;

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл/СумАвУплКод');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл/СумАвУплКод' + getIter(i);

    if     not GetStrNull(XMLAdrI + '/КБК'    )
       and not GetStrNull(XMLAdrI + '/АвансПУ')
    {
      #SetVisT(XMLAdrI              )
      #IfVis  (XMLAdrI + '/АвансЗач')

      fl := true;
    }
    else #SetVisF(XMLAdrI)
  }

  if     fl
     and not GetStrNull('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл/ОКТМО')
  then #SetVisT('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл')
  else #SetVisF('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл')
  // #endregion Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл
  // #endregion Файл/Документ/АкцСпиртАлк/СумНалПУ

  // #region Файл/Документ/АкцСпиртАлк/РасчАкц
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАкц');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАкц' + getIter(i);
    fl := false;

    // #region Файл/Документ/АкцСпиртАлк/РасчАкц/ОперПТ
    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/ОперПТ/ОперПТКод');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/ОперПТ/ОперПТКод' + getIter(j);

      if     not GetStrNull(XMLAdrJ + '/КодПок'  )
         and not GetStrNull(XMLAdrJ + '/НалБаза' )
         and not GetStrNull(XMLAdrJ + '/СумАкциз')
      {
        #SetVisT(XMLAdrJ               )
        #IfVis  (XMLAdrJ + '/ПризнСтав')

        fl := true;
      }
      else #SetVisF(XMLAdrJ)
    }
    // #endregion Файл/Документ/АкцСпиртАлк/РасчАкц/ОперПТ

    if     fl
       and not GetStrNull(XMLAdrI + '/КодПТ'           )
       and not GetStrNull(XMLAdrI + '/АкцизПУ/КодПок'  )
       and not GetStrNull(XMLAdrI + '/АкцизПУ/СумАкциз')
       and not GetStrNull(XMLAdrI + '/АкцизУм/КодПок'  )
       and not GetStrNull(XMLAdrI + '/АкцизУм/СумАкциз')
    {
      #SetVisT(XMLAdrI)

      // #region Файл/Документ/АкцСпиртАлк/РасчАкц/АкцизВыч/АкцизВычКод
      fl := false;

      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВыч/АкцизВычКод');
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/АкцизВыч/АкцизВычКод' + getIter(j);

        if     not GetStrNull(XMLAdrJ + '/КодПок'  )
           and not GetStrNull(XMLAdrJ + '/ОбъемПТ' )
           and not GetStrNull(XMLAdrJ + '/СумВычет')
        then { #SetVisT(XMLAdrJ) fl := true; }
        else   #SetVisF(XMLAdrJ)
      }

      SetFldVis(XMLAdrI + '/АкцизВыч', fl);
      // #endregion Файл/Документ/АкцСпиртАлк/РасчАкц/АкцизВыч/АкцизВычКод

      if     not GetStrNull(XMLAdrI + '/Акциз203.6/КодПок'  )
         and not GetStrNull(XMLAdrI + '/Акциз203.6/СумАкциз')
      then #SetVisT(XMLAdrI + '/Акциз203.6')
      else #SetVisF(XMLAdrI + '/Акциз203.6')

      // #region Файл/Документ/АкцСпиртАлк/РасчАкц/АкцизВозм
      fl := false;

      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВозм/АкцизВозмКод');
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/АкцизВозм/АкцизВозмКод' + getIter(j);

        if     not GetStrNull(XMLAdrJ + '/КодПок'    )
           and not GetStrNull(XMLAdrJ + '/НалБаза'   )
           and not GetStrNull(XMLAdrJ + '/СумАкциз'  )
           and not GetStrNull(XMLAdrJ + '/НалПерЭксп')
           and not GetStrNull(XMLAdrJ + '/ГодЭксп'   )
        then { #SetVisT(XMLAdrJ) fl := true; }
        else   #SetVisF(XMLAdrJ)
      }

      if fl
      {
        #SetVisT(XMLAdrI + '/АкцизВозм')

        CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВозм/ПревУплВозм');
        for (j := 0; j < CountJ; j++)
        {
          XMLAdrJ := XMLAdrI + '/АкцизВозм/ПревУплВозм' + getIter(j);

          if     not GetStrNull(XMLAdrJ + '/СумПок')
             and not GetStrNull(XMLAdrJ + '/НалПер')
             and not GetStrNull(XMLAdrJ + '/Год'   )
          then #SetVisT(XMLAdrJ)
          else #SetVisF(XMLAdrJ)
        }
      }
      else #SetVisF(XMLAdrI + '/АкцизВозм')

      SetFldVis(XMLAdrI + '/РеалПТЕЭС', fl);
      // #endregion Файл/Документ/АкцСпиртАлк/РасчАкц/АкцизВозм

      // #region Файл/Документ/АкцСпиртАлк/РасчАкц/РеалПТБГ
      fl := false;

      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/РеалПТБГ/РеалПТБГКод');
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/РеалПТБГ/РеалПТБГКод' + getIter(j);

        if     not GetStrNull(XMLAdrJ + '/КодПок'  )
           and not GetStrNull(XMLAdrJ + '/НалБаза' )
           and not GetStrNull(XMLAdrJ + '/СумАкциз')
           and not GetStrNull(XMLAdrJ + '/НаличБГ' )
        then { #SetVisT(XMLAdrJ) fl := true; }
        else   #SetVisF(XMLAdrJ)
      }

      SetFldVis(XMLAdrI + '/РеалПТБГ', fl);
      // #endregion Файл/Документ/АкцСпиртАлк/РасчАкц/РеалПТБГ

      // #region Файл/Документ/АкцСпиртАлк/РасчАкц/РеалПТЕЭС
      fl := false;

      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/РеалПТЕЭС/РеалПТЕЭСКод');
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/РеалПТЕЭС/РеалПТЕЭСКод' + getIter(j);

        if     not GetStrNull(XMLAdrJ + '/КодПок'    )
           and not GetStrNull(XMLAdrJ + '/НалБаза'   )
           and not GetStrNull(XMLAdrJ + '/СумАкциз'  )
           and not GetStrNull(XMLAdrJ + '/НалПерРеал')
           and not GetStrNull(XMLAdrJ + '/ГодРеал'   )
        then { #SetVisT(XMLAdrJ) fl := true; }
        else   #SetVisF(XMLAdrJ)
      }

      SetFldVis(XMLAdrI + '/РеалПТЕЭС', fl);
      // #endregion Файл/Документ/АкцСпиртАлк/РасчАкц/РеалПТЕЭС
    }
    else #SetVisF(XMLAdrI)
  } // #endregion Файл/Документ/АкцСпиртАлк/РасчАкц

  // #region Файл/Документ/АкцСпиртАлк/РасчАвАкц
  fl := false;

  // #region Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцУплЗак
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцУплЗак');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцУплЗак' + getIter(i);

    if     not GetStrNull(XMLAdrI + '/КодПП'         )
       and not GetStrNull(XMLAdrI + '/КодСпирт'      )
       and not GetStrNull(XMLAdrI + '/АвЗакНеСписНач')
       and not GetStrNull(XMLAdrI + '/ОбщОбмЗакПер'  )
    {
      #SetVisT(XMLAdrI                      )
      #IfVis  (XMLAdrI + '/ОбщЗакНеСписНач' )
      #IfVis  (XMLAdrI + '/АвУплЗакПер'     )
      #IfVis  (XMLAdrI + '/ОбщЗакСписПер'   )
      #IfVis  (XMLAdrI + '/АвУплСписПер'    )
      #IfVis  (XMLAdrI + '/ОбщПотерНормПер' )
      #IfVis  (XMLAdrI + '/АвПотерНормПер'  )
      #IfVis  (XMLAdrI + '/ОбщЗакНеСписКон' )
      #IfVis  (XMLAdrI + '/АвУплНеСписКон'  )
      #IfVis  (XMLAdrI + '/ОбщРеалПППер'    )
      #IfVis  (XMLAdrI + '/АкИсчРеалПер'    )
      #IfVis  (XMLAdrI + '/ОбщИспПППер'     )
      #IfVis  (XMLAdrI + '/АвУплРеалПер'    )
      #IfVis  (XMLAdrI + '/ОбщПотерСпПер'   )
      #IfVis  (XMLAdrI + '/АкОбщПотерПер'   )
      #IfVis  (XMLAdrI + '/ОбщЗакИспПППер'  )
      #IfVis  (XMLAdrI + '/АвВычУменАкПотер')
      #IfVis  (XMLAdrI + '/ПревАвИсчИспПер' )
      #IfVis  (XMLAdrI + '/АвОбщРеалКон'    )
      #IfVis  (XMLAdrI + '/ПревАвИсчИспКон' )
      #IfVis  (XMLAdrI + '/ОбщСпиртЗакСлед' )
      #IfVis  (XMLAdrI + '/ОбщАвУплПер'     )

      fl := true;
    }
    else #SetVisF(XMLAdrI)
  }
  // #endregion Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцУплЗак

  // #region Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ204
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ204');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ204' + getIter(i);

    if     not GetStrNull(XMLAdrI + '/КодПП'       )
       and not GetStrNull(XMLAdrI + '/КодСпирт'    )
       and not GetStrNull(XMLAdrI + '/ОбщКолБГПер' )
       and not GetStrNull(XMLAdrI + '/ОбщСумБГПер' )
       and not GetStrNull(XMLAdrI + '/ОбщОбмЗакПер')
    {
      #SetVisT(XMLAdrI                     )
      #IfVis  (XMLAdrI + '/ОбщОбмПотерПер' )
      #IfVis  (XMLAdrI + '/ОбщОбмЗакПотер' )
      #IfVis  (XMLAdrI + '/АвОсвБГУчПотер' )
      #IfVis  (XMLAdrI + '/ОбщРеалПППер'   )
      #IfVis  (XMLAdrI + '/АкИсчРеалПер'   )
      #IfVis  (XMLAdrI + '/АкИсчРеалКонИзв')
      #IfVis  (XMLAdrI + '/ПревАвОсвИсчКон')
      #IfVis  (XMLAdrI + '/ОбщСпиртЗакСлед')
      #IfVis  (XMLAdrI + '/ОбщАвОсвПер'    )

      fl := true;
    }
    else #SetVisF(XMLAdrI)
  }
  // #endregion Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ204

  // #region Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ184
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ184');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ184' + getIter(i);

    if     not GetStrNull(XMLAdrI + '/КодПП'                    )
       and not GetStrNull(XMLAdrI + '/КодСпирт'                 )
       and not GetStrNull(XMLAdrI + '/ОбщКолБГПер'              )
       and not GetStrNull(XMLAdrI + '/ОбщСумБГ'                 )
       and not GetStrNull(XMLAdrI + '/АвОсвУплПерБГ/ОбщОбъемСп' )
       and not GetStrNull(XMLAdrI + '/АвОсвУплПерБГ/СумАвАкциз' )
       and not GetStrNull(XMLAdrI + '/АвОсвУплЗакПер/ОбщОбъемСп')
       and not GetStrNull(XMLAdrI + '/АвОсвУплЗакПер/СумАвАкциз')
    {
      #SetVisT(XMLAdrI                   )
      #IfVis  (XMLAdrI + '/ПревАвОсвРеал')

      SetFldVis(XMLAdrI + '/АкЗакРеалПер'   ,     not GetStrNull(XMLAdrI + '/АкЗакРеалПер/ОбъемРеал'   )
                                              and not GetStrNull(XMLAdrI + '/АкЗакРеалПер/СумАкциз'    ));
      SetFldVis(XMLAdrI + '/АкЭкспНеПдтвНач',     not GetStrNull(XMLAdrI + '/АкЭкспНеПдтвНач/ОбъемРеал')
                                              and not GetStrNull(XMLAdrI + '/АкЭкспНеПдтвНач/СумАкциз' ));
      SetFldVis(XMLAdrI + '/АкЭкспПдтвПер'  ,     not GetStrNull(XMLAdrI + '/АкЭкспПдтвПер/ОбъемРеал'  )
                                              and not GetStrNull(XMLAdrI + '/АкЭкспПдтвПер/СумАкциз'   ));
      SetFldVis(XMLAdrI + '/АкЭкспПдтвКон'  ,     not GetStrNull(XMLAdrI + '/АкЭкспПдтвКон/ОбъемРеал'  )
                                              and not GetStrNull(XMLAdrI + '/АкЭкспПдтвКон/СумАкциз'   ));
      SetFldVis(XMLAdrI + '/АкЭкспНеПдтвКон',     not GetStrNull(XMLAdrI + '/АкЭкспНеПдтвКон/ОбъемРеал')
                                              and not GetStrNull(XMLAdrI + '/АкЭкспНеПдтвКон/СумАкциз' ));
      SetFldVis(XMLAdrI + '/АкРеалРФКон'    ,     not GetStrNull(XMLAdrI + '/АкРеалРФКон/ОбъемРеал'    )
                                              and not GetStrNull(XMLAdrI + '/АкРеалРФКон/СумАкциз'     ));
      SetFldVis(XMLAdrI + '/АкРеалКон'      ,     not GetStrNull(XMLAdrI + '/АкРеалКон/ОбъемРеал'      )
                                              and not GetStrNull(XMLAdrI + '/АкРеалКон/СумАкциз'       ));

      fl := true;
    }
    else #SetVisF(XMLAdrI)
  }
  // #endregion Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ184

  SetFldVis('Файл/Документ/АкцСпиртАлк/РасчАвАкц', fl);
  // #endregion Файл/Документ/АкцСпиртАлк/РасчАвАкц

  // #region Файл/Документ/АкцСпиртАлк/РасчНБВидПТ
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчНБВидПТ');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчНБВидПТ' + getIter(i);
    fl := false;

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/РасчНБКод');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/РасчНБКод' + getIter(j);

      if     not GetStrNull(XMLAdrJ + '/КодПок'  )
         and not GetStrNull(XMLAdrJ + '/СодСпирт')
         and not GetStrNull(XMLAdrJ + '/ОбъемПТ' )
         and not GetStrNull(XMLAdrJ + '/НалБаза' )
      then { #SetVisT(XMLAdrJ) fl := true; }
      else   #SetVisF(XMLAdrJ)
    }

    SetFldVis(XMLAdrI, fl and not GetStrNull(XMLAdrI + '/КодПТ'));
  } // #endregion Файл/Документ/АкцСпиртАлк/РасчНБВидПТ

  // #region Файл/Документ/АкцСпиртАлк/РасчАкОсвБГЭксп
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАкОсвБГЭксп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАкОсвБГЭксп' + getIter(i);

    if     not GetStrNull(XMLAdrI + '/КодПТ'                )
       and not GetStrNull(XMLAdrI + '/ОбщКолБГПер'          )
       and not GetStrNull(XMLAdrI + '/ОбщСумБГПер'          )
       and not GetStrNull(XMLAdrI + '/АкОсвЭкспПер/ОбъемПТ' )
       and not GetStrNull(XMLAdrI + '/АкОсвЭкспПер/СумАкциз')
    {
      #SetVisT(XMLAdrI                        )
      #IfVis  (XMLAdrI + '/АкОсвБГЭкНеПдтвПер')
      #IfVis  (XMLAdrI + '/АкОсвБГЭкПдтвПред' )
      #IfVis  (XMLAdrI + '/АкОсвБГЭкПдтвКон'  )
      #IfVis  (XMLAdrI + '/АкОсвБГЭкНеПдтвКон')
      #IfVis  (XMLAdrI + '/ПрАкОсвБГПдтвКон'  )

      SetFldVis(XMLAdrI + '/АкОсвЭкспПдтвПер' ,     not GetStrNull(XMLAdrI + '/АкОсвЭкспПдтвПер/ОбъемПТ' )
                                                and not GetStrNull(XMLAdrI + '/АкОсвЭкспПдтвПер/СумАкциз'));

      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/БГОсвРеалЭксп');
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/БГОсвРеалЭксп' + getIter(j);

        if     not GetStrNull(XMLAdrJ + '/ДатаВыдБГ'                )
           and not GetStrNull(XMLAdrJ + '/НомерБГ'                  )
           and not GetStrNull(XMLAdrJ + '/ДатаНачБГ'                )
           and not GetStrNull(XMLAdrJ + '/ДатаКонБГ'                )
           and not GetStrNull(XMLAdrJ + '/СуммаБГ'                  )
           and not GetStrNull(XMLAdrJ + '/АкОсвЭкспПер/ОбРеалЭкспПТ')
           and not GetStrNull(XMLAdrJ + '/АкОсвЭкспПер/СумАкциз'    )
        {
          #SetVisT(XMLAdrJ                     )
          #IfVis  (XMLAdrJ + '/ПрАкЭкспПдтвКон')

          SetFldVis(XMLAdrJ + '/АкЭкспНеПдтвНач',     not GetStrNull(XMLAdrJ + '/АкЭкспНеПдтвНач/ОбРеалЭкспПТ')
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспНеПдтвНач/СумАкциз'    )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспНеПдтвНач/НалПерЭксп'  )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспНеПдтвНач/ГодЭксп'     ));
          SetFldVis(XMLAdrJ + '/АкЭкспПдтвПер'  ,     not GetStrNull(XMLAdrJ + '/АкЭкспПдтвПер/ОбРеалЭкспПТ'  )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспПдтвПер/СумАкциз'      )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспПдтвПер/НалПерЭксп'    )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспПдтвПер/ГодЭксп'       ));
          SetFldVis(XMLAdrJ + '/АкЭкспПдтвПред' ,     not GetStrNull(XMLAdrJ + '/АкЭкспПдтвПред/ОбРеалЭкспПТ' )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспПдтвПред/СумАкциз'     ));
          SetFldVis(XMLAdrJ + '/АкЭкспПдтвКон'  ,     not GetStrNull(XMLAdrJ + '/АкЭкспПдтвКон/ОбРеалЭкспПТ'  )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспПдтвКон/СумАкциз'      )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспПдтвКон/НалПерЭксп'    )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспПдтвКон/ГодЭксп'       ));
          SetFldVis(XMLAdrJ + '/АкЭкспНеПдтвКон',     not GetStrNull(XMLAdrJ + '/АкЭкспНеПдтвКон/ОбРеалЭкспПТ')
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспНеПдтвКон/СумАкциз'    )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспНеПдтвКон/НалПерЭксп'  )
                                                  and not GetStrNull(XMLAdrJ + '/АкЭкспНеПдтвКон/ГодЭксп'     ));
        }
        else #SetVisF(XMLAdrJ)
      }
    }
    else #SetVisF(XMLAdrI)
  } // #endregion Файл/Документ/АкцСпиртАлк/РасчАкОсвБГЭксп

  // #region Файл/Документ/АкцСпиртАлк/СпРеалПерПокуп
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СпРеалПерПокуп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СпРеалПерПокуп' + getIter(i);
    fl := false;

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/ОбРеалСпПок');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/ОбРеалСпПок' + getIter(j);

      if     not GetStrNull(XMLAdrJ + '/КодПок'   )
         and not GetStrNull(XMLAdrJ + '/КодСпиртР')
         and not GetStrNull(XMLAdrJ + '/ОбСпРеал' )
         and not GetStrNull(XMLAdrJ + '/КодПП'    )
         and not GetStrNull(XMLAdrJ + '/АвИзвещ'  )
      then { #SetVisT(XMLAdrJ) fl := true; }
      else   #SetVisF(XMLAdrJ)
    }

    SetFldVis(XMLAdrI, fl and not GetStrNull(XMLAdrI + '/ИННЮЛ')
                          and not GetStrNull(XMLAdrI + '/КПП'  ));
  } // #endregion Файл/Документ/АкцСпиртАлк/СпРеалПерПокуп

  // #region Файл/Документ/АкцСпиртАлк/СпПриобПерПрод
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СпПриобПерПрод');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СпПриобПерПрод' + getIter(i);
    fl := false;

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/ОбПриобСпПрод');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/ОбПриобСпПрод' + getIter(j);

      if     not GetStrNull(XMLAdrJ + '/КодПок'   )
         and not GetStrNull(XMLAdrJ + '/КодСпиртП')
         and not GetStrNull(XMLAdrJ + '/ОбПриобСп')
         and not GetStrNull(XMLAdrJ + '/КодПП'    )
         and not GetStrNull(XMLAdrJ + '/АвИзвещ'  )
      then { #SetVisT(XMLAdrJ) fl := true; }
      else   #SetVisF(XMLAdrJ)
    }

    SetFldVis(XMLAdrI, fl and not GetStrNull(XMLAdrI + '/ИННЮЛ')
                          and not GetStrNull(XMLAdrI + '/КПП'  ));
  } // #endregion Файл/Документ/АкцСпиртАлк/СпПриобПерПрод

  // #region Файл/Документ/АкцСпиртАлк/СпПолучСвид
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СпПолучСвид');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СпПолучСвид' + getIter(i);
    fl := false;

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/СвОбСпСчФ');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/СвОбСпСчФ' + getIter(j);

      if     not GetStrNull(XMLAdrJ + '/КодСпирт')
         and not GetStrNull(XMLAdrJ + '/НомСчФ'  )
         and not GetStrNull(XMLAdrJ + '/ДатаСчФ' )
         and not GetStrNull(XMLAdrJ + '/ОбСпСчФ' )
      {
        #SetVisT(XMLAdrJ              )
        #IfVis  (XMLAdrJ + '/НомКСчФ' )
        #IfVis  (XMLAdrJ + '/ДатаКСчФ')
        #IfVis  (XMLAdrJ + '/ОбСпКСчФ')

        fl := true;
      }
      else #SetVisF(XMLAdrJ)
    }

    if     fl
       and not GetStrNull(XMLAdrI + '/НаимОрг'    )
       and not GetStrNull(XMLAdrI + '/ИННЮЛ'      )
       and not GetStrNull(XMLAdrI + '/КПП'        )
       and not GetStrNull(XMLAdrI + '/СерСвидПост')
       and not GetStrNull(XMLAdrI + '/НомСвидПост')
    {
      #SetVisT(XMLAdrI)

      SetFldVis(XMLAdrI + '/ОбПолучСпПер111',     not GetStrNull(XMLAdrI + '/ОбПолучСпПер111/КодСпирт'    )
                                              and not GetStrNull(XMLAdrI + '/ОбПолучСпПер111/ОбПолучСпПер'));
      SetFldVis(XMLAdrI + '/ОбПолучСпПер121',     not GetStrNull(XMLAdrI + '/ОбПолучСпПер121/КодСпирт'    )
                                              and not GetStrNull(XMLAdrI + '/ОбПолучСпПер121/ОбПолучСпПер'));
    }
    else #SetVisF(XMLAdrI)
  } // #endregion Файл/Документ/АкцСпиртАлк/СпПолучСвид

  // #region Файл/Документ/АкцСпиртАлк/СпРеалСвид
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СпРеалСвид');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СпРеалСвид' + getIter(i);
    fl := false;

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/СвОбСпСчФ');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/СвОбСпСчФ' + getIter(j);

      if     not GetStrNull(XMLAdrJ + '/КодСпирт')
         and not GetStrNull(XMLAdrJ + '/НомСчФ'  )
         and not GetStrNull(XMLAdrJ + '/ДатаСчФ' )
         and not GetStrNull(XMLAdrJ + '/ОбСпСчФ' )
      {
        #SetVisT(XMLAdrJ              )
        #IfVis  (XMLAdrJ + '/НомКСчФ' )
        #IfVis  (XMLAdrJ + '/ДатаКСчФ')
        #IfVis  (XMLAdrJ + '/ОбСпКСчФ')

        fl := true;
      }
      else #SetVisF(XMLAdrJ)
    }

    if     fl
       and not GetStrNull(XMLAdrI + '/НаимОрг'   )
       and not GetStrNull(XMLAdrI + '/ИННЮЛ'     )
       and not GetStrNull(XMLAdrI + '/КПП'       )
       and not GetStrNull(XMLAdrI + '/СерСвидПол')
       and not GetStrNull(XMLAdrI + '/НомСвидПол')
    {
      #SetVisT(XMLAdrI)

      SetFldVis(XMLAdrI + '/ОбРеалСпПер111',     not GetStrNull(XMLAdrI + '/ОбРеалСпПер111/КодСпирт'   )
                                             and not GetStrNull(XMLAdrI + '/ОбРеалСпПер111/ОбРеалСпПер'));
      SetFldVis(XMLAdrI + '/ОбРеалСпПер121',     not GetStrNull(XMLAdrI + '/ОбРеалСпПер121/КодСпирт'   )
                                             and not GetStrNull(XMLAdrI + '/ОбРеалСпПер121/ОбРеалСпПер'));
    }
    else #SetVisF(XMLAdrI)
  } // #endregion Файл/Документ/АкцСпиртАлк/СпРеалСвид

  // #region Файл/Документ/АкцСпиртАлк/АвППЗакупСп
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвППЗакупСп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/АвППЗакупСп' + getIter(i);
    fl := false;

    if    GetStrNull(XMLAdrI + '/РегНомИзв' )
       or GetStrNull(XMLAdrI + '/ДатаРегИзв')
       or GetStrNull(XMLAdrI + '/КодСпирт'  )
       or GetStrNull(XMLAdrI + '/КодПП'     )
       or GetStrNull(XMLAdrI + '/ОбСпиртИзв')
       or GetStrNull(XMLAdrI + '/АвУплИзв'  )
    then { #SetVisF(XMLAdrI) continue; }

    #SetVisT(XMLAdrI                       )
    #IfVis  (XMLAdrI + '/ОбЗакНеСписНач'   )
    #IfVis  (XMLAdrI + '/АвЗакНеСписНач'   )
    #IfVis  (XMLAdrI + '/ОбСпЗакИзвПер'    )
    #IfVis  (XMLAdrI + '/АвЗакПер'         )
    #IfVis  (XMLAdrI + '/ОбИзвСписПер'     )
    #IfVis  (XMLAdrI + '/АвСписПер'        )
    #IfVis  (XMLAdrI + '/ОбПотерЗакПерНорм')
    #IfVis  (XMLAdrI + '/АвПотерНорм'      )
    #IfVis  (XMLAdrI + '/ОбЗакНеСписКон'   )
    #IfVis  (XMLAdrI + '/АвНеСписКон'      )
    #IfVis  (XMLAdrI + '/ОбППРеалПерИзв'   )
    #IfVis  (XMLAdrI + '/АкИсчППРеалПер'   )
    #IfVis  (XMLAdrI + '/АвИспППРеалПер'   )
    #IfVis  (XMLAdrI + '/ОбПотерЗакПерСв'  )
    #IfVis  (XMLAdrI + '/АкСвПотерПер'     )
    #IfVis  (XMLAdrI + '/ОбИспППРеалПер'   )
    #IfVis  (XMLAdrI + '/АвВычСвПотерПер'  )
    #IfVis  (XMLAdrI + '/ПрАвЗакРеалПер'   )
    #IfVis  (XMLAdrI + '/АвИсчППРеалПред'  )
    #IfVis  (XMLAdrI + '/АвИсчППРеалКон'   )
    #IfVis  (XMLAdrI + '/ПрАвЗакРеалКон'   )

    SetFldVis(XMLAdrI + '/ОбЗакППРеалПер',     not GetStrNull(XMLAdrI + '/ОбЗакППРеалПер/ОбРеалПП'  )
                                           and not GetStrNull(XMLAdrI + '/ОбЗакППРеалПер/СодСпиртПП')
                                           and not GetStrNull(XMLAdrI + '/ОбЗакППРеалПер/ОбСпСодПП' ));
  } // #endregion Файл/Документ/АкцСпиртАлк/АвППЗакупСп

  // #region Файл/Документ/АкцСпиртАлк/АвОсвБГ204
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвОсвБГ204');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/АвОсвБГ204' + getIter(i);
    fl := false;

    if     not GetStrNull(XMLAdrI + '/РегНомИзв'    )
       and not GetStrNull(XMLAdrI + '/ДатаРегИзв'   )
       and not GetStrNull(XMLAdrI + '/КодСпирт'     )
       and not GetStrNull(XMLAdrI + '/КодПП'        )
       and not GetStrNull(XMLAdrI + '/ДатаВыдБГ'    )
       and not GetStrNull(XMLAdrI + '/НомерБГ'      )
       and not GetStrNull(XMLAdrI + '/ДатаНачБГ'    )
       and not GetStrNull(XMLAdrI + '/ДатаКонБГ'    )
       and not GetStrNull(XMLAdrI + '/СуммаБГ'      )
       and not GetStrNull(XMLAdrI + '/ОбСпиртИзв'   )
       and not GetStrNull(XMLAdrI + '/АвОсвУплИзвещ')
    {
      #SetVisT(XMLAdrI                       )
      #IfVis  (XMLAdrI + '/ОбСпЗакИзвПер'    )
      #IfVis  (XMLAdrI + '/ОбПотерПер'       )
      #IfVis  (XMLAdrI + '/ОбСпЗакПотерПер'  )
      #IfVis  (XMLAdrI + '/АвОсвЗакПер'      )
      #IfVis  (XMLAdrI + '/ОбППРеалПерЗак'   )
      #IfVis  (XMLAdrI + '/АкИсчППРеалПер'   )
      #IfVis  (XMLAdrI + '/АкИсчРеалПППред'  )
      #IfVis  (XMLAdrI + '/АкИсчРеалППКон'   )
      #IfVis  (XMLAdrI + '/ПрАвОсвЗакРеалКон')
    }
    else #SetVisF(XMLAdrI)
  } // #endregion Файл/Документ/АкцСпиртАлк/АвОсвБГ204

  // #region Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп' + getIter(i);
    fl := false;

    if    GetStrNull(XMLAdrI + '/РегНомИзв'    )
       or GetStrNull(XMLAdrI + '/ДатаРегИзв'   )
       or GetStrNull(XMLAdrI + '/КодСпирт'     )
       or GetStrNull(XMLAdrI + '/КодПП'        )
       or GetStrNull(XMLAdrI + '/ДатаВыдБГ'    )
       or GetStrNull(XMLAdrI + '/НомерБГ'      )
       or GetStrNull(XMLAdrI + '/ДатаНачБГ'    )
       or GetStrNull(XMLAdrI + '/ДатаКонБГ'    )
       or GetStrNull(XMLAdrI + '/СуммаБГ'      )
       or GetStrNull(XMLAdrI + '/ОбСпИзвещ'    )
       or GetStrNull(XMLAdrI + '/АвОсвУплИзвещ')
    then { #SetVisF(XMLAdrI) continue;}

    #SetVisT(XMLAdrI                        )
    #IfVis  (XMLAdrI + '/ОбСпЗакИзвПер'     )
    #IfVis  (XMLAdrI + '/ОбПотерПер'        )
    #IfVis  (XMLAdrI + '/ОбСпЗакУчПотерПер' )
    #IfVis  (XMLAdrI + '/АвОсвЗакупПотерПер')
    #IfVis  (XMLAdrI + '/ПрАвОсвРеалКон'    )

    SetFldVis(XMLAdrI + '/АкРеалПдтвКон',     not GetStrNull(XMLAdrI + '/АкРеалПдтвКон/ОбъемРеал')
                                          and not GetStrNull(XMLAdrI + '/АкРеалПдтвКон/СумАкциз' ));
    SetFldVis(XMLAdrI + '/АкРеалРФКон'  ,     not GetStrNull(XMLAdrI + '/АкРеалРФКон/ОбъемРеал'  )
                                          and not GetStrNull(XMLAdrI + '/АкРеалРФКон/СумАкциз'   ));
    SetFldVis(XMLAdrI + '/АкЗакОсвРеал' ,     not GetStrNull(XMLAdrI + '/АкЗакОсвРеал/ОбъемРеал' )
                                          and not GetStrNull(XMLAdrI + '/АкЗакОсвРеал/СумАкциз'  ));

    SetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкРеалЭкспПер'  ,     not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкРеалЭкспПер/ОбРеалЭкспПП'  )
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкРеалЭкспПер/СумАкциз'      ));
    SetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач',     not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/ОбРеалЭкспПП')
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/СумАкциз'    )
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/НалПерЭксп'  )
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/ГодЭксп'     ));
    SetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер'  ,     not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/ОбРеалЭкспПП'  )
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/СумАкциз'      )
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/НалПерЭксп'    )
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/ГодЭксп'       ));
    SetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред' ,     not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред/ОбРеалЭкспПП' )
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред/СумАкциз'     ));
    SetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон',     not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/ОбРеалЭкспПП')
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/СумАкциз'    )
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/НалПерЭксп'  )
                                                            and not GetStrNull(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/ГодЭксп'     ));

    SetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп',    GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкРеалЭкспПер'  )
                                            or GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач')
                                            or GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер'  )
                                            or GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред' )
                                            or GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон'));

    SetFldVis(XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПер' ,     not GetStrNull(XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПер/ОбъемРеал' )
                                                          and not GetStrNull(XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПер/СумАкциз'  ));
    SetFldVis(XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПред',     not GetStrNull(XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПред/ОбъемРеал')
                                                          and not GetStrNull(XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПред/СумАкциз' ));

    SetFldVis(XMLAdrI + '/АвРеалРФОсвБГ',    GetFldVis(XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПер' )
                                          or GetFldVis(XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПред'));
  } // #endregion Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп
@end.
// #endregion ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ УСТАНОВКЕ ВИДИМОСТИ ПОЛЕЙ
//************************************************************************************************************


//============================================================================================================
// #region ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ПРОВЕРКЕ
//------------------------------------------------------------------------------------------------------------
@Script On_Check : boolean;
  //==========================================================================================================
  // #region СЕРВИС On_Check
  //----------------------------------------------------------------------------------------------------------
  #include AllTaxObj.Vih

  // #region ISVALID
  function IsValidPeriod(strIn: string; var strGetMes: string) : boolean;
  begin
    //Налоговый период
    //Период
    strGetMes := 'Возможные значения: 01, 02, 03, 04, 05, 06, 07, 08, 09, 10, 11, 12, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81 или 82';

    Result := False;
    Result :=    CheckError.isRegExpr('^(01|02|03|04|05|06|07|08|09|10|11|12)$', strIn)
              or CheckError.isRegExpr('^(71|72|73|74|75|76|77|78|79|80|81|82)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidPoMestu(strIn: string; var strGetMes: string) : boolean;
  begin
    //По месту нахождения (учета)
    //ПоМесту
    strGetMes := 'Возможные значения: 120, 213, 214, 215, 216, 220 или 331';

    Result := False;
    Result := CheckError.isRegExpr('^(120|213|214|215|216|220|331)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidNalSvid(strIn: string; var strGetMes: string) : boolean;
  begin
    //Наличие свидетельства (свидетельств)
    //НалСвид
    strGetMes := 'Возможные значения: 0 или 1';

    Result := False;
    Result := CheckError.isRegExpr('^(0|1)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPT(strIn: string; var strGetMes: string) : boolean;
  begin
    //Коды видов подакцизных товаров
    //КодПТ
    strGetMes := 'Возможные значения: 100, 111, 121, 140, 150, 160, 161, 162, 163, 130, 164, 165, 170, 200, 231, 224, 232, 284, 285, 271, 272, 291, 292, 293, 300, 310, 320 или 330';

    Result := False;
    Result :=    CheckError.isRegExpr('^(100|111|121|140|150|160|161|162|163|130|164|165|170|200)$', strIn)
              or CheckError.isRegExpr('^(231|224|232|284|285|271|272|291|292|293|300|310|320|330)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPT_111_121(strIn: string; var strGetMes: string) : boolean;
  begin
    //Коды видов подакцизных товаров
    //КодПТ
    strGetMes := 'Возможные значения: 111 или 121';

    Result := False;
    Result :=    CheckError.isRegExpr('^(111|121)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPT_111(strIn: string; var strGetMes: string) : boolean;
  begin
    //Коды видов подакцизных товаров
    //КодПТ
    strGetMes := 'Возможное значение: 111';

    Result := False;
    Result := CheckError.isRegExpr('^(111)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPT_121(strIn: string; var strGetMes: string) : boolean;
  begin
    //Коды видов подакцизных товаров
    //КодПТ
    strGetMes := 'Возможное значение: 121';

    Result := False;
    Result := CheckError.isRegExpr('^(121)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможные значения: 10001, 10006, 10007, 10008, 10009, 10010, 10011, 10012, 10020, 10022, 20003, 20004, 20005, 20009, 20011, 20013 или 20015';

    Result := False;
    Result := CheckError.isRegExpr('^(10001|10006|10007|10008|10009|10010|10011|10012|10020|10022|20003|20004|20005|20009|20011|20013|20015)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidPriznStav(strIn: string; var strGetMes: string) : boolean;
  begin
    //Признак применения ставки акциза на этиловый спирт
    //ПризнСтав
    strGetMes := 'Возможные значения: 0, 1, 2 или 3';

    Result := False;
    Result := CheckError.isRegExpr('^(0|1|2|3)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_2(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможные значения: 30001, 30002, 30003, 30004, 30005, 30009, 30010 или 30012';

    Result := False;
    Result := CheckError.isRegExpr('^(30001|30002|30003|30004|30005|30009|30010|30012)$', strIn);
  end;


  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_3(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможное значение: 40001';

    Result := False;
    Result := CheckError.isRegExpr('^(40001)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_4(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможное значение: 40002';

    Result := False;
    Result := CheckError.isRegExpr('^(40002)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_5(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможное значение: 60008';

    Result := False;
    Result := CheckError.isRegExpr('^(60008)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_6(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможные значения: 20003, 50001, 20009, 20011, 20013, 20015, 50006 или 50007';

    Result := False;
    Result := CheckError.isRegExpr('^(20003|50001|20009|20011|20013|20015|50006|50007)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_7(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможные значения: 20001, 50003, 20008, 20010, 20012, 20014, 50008, 50009, 50010 или 50011';

    Result := False;
    Result := CheckError.isRegExpr('^(20001|50003|20008|20010|20012|20014|50008|50009|50010|50011)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidNalichBG(strIn: string; var strGetMes: string) : boolean;
  begin
    //Признак наличия банковской гарантии
    //НаличБГ
    strGetMes := 'Возможные значения: 0 или 1';

    Result := False;
    Result := (strIn = '0' or strIn = '1');
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_8(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможные значения: 20002, 20004, 50002 или 50004';

    Result := False;
    Result := CheckError.isRegExpr('^(20002|20004|50002|50004)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_9(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможные значения: 10001, 10006-10012, 10020, 10022, 20001-20005, 20008-20015, 30001, 30002, 30004, 30005, 30010, 30012, 50001-50004, 50006-50011';

    Result := False;
    Result :=    CheckError.isRegExpr('^(10001|10006|10007|10008|10009|10010|10011|10012|10020|10022|20001|20002|20003|20004|20005|30001|30002|30004|30005)$'      , strIn)
              or CheckError.isRegExpr('^(30010|30012|50001|50002|50003|50004|20008|20009|20010|20011|20012|20013|20014|20015|50006|50007|50008|50009|50010|50011)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidNomerBG(strIn: string; var strGetMes: string) : boolean;
  begin
    //Номер банковской гарантии
    //НомерБГ
    strGetMes := 'Формат поля: от 1 до 20 символов';

    result := false;
    result := (Length(strIn) >= 1) and (Length(strIn) <= 20);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidText_256(strIn: string; var strGetMes: string) : boolean;
  begin
    strGetMes := 'Формат поля: от 1 до 256 символов';

    result := false;
    result := (Length(strIn) >= 1) and (Length(strIn) <= 256);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidSerSvidPost(strIn: string; var strGetMes: string) : boolean;
  begin
    //Серия свидетельства поставщика
    //СерСвидПост
    strGetMes := 'Формат поля: от 1 до 2 символов';

    result := false;
    result := (Length(strIn) >= 1) and (Length(strIn) <= 2);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidNomSvidPost(strIn: string; var strGetMes: string) : boolean;
  begin
    //Номер свидетельства поставщика
    //НомСвидПост
    strGetMes := 'Формат поля: от 1 до 9 символов';

    result := false;
    result := (Length(strIn) >= 1) and (Length(strIn) <= 9);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidRegNomIzv(strIn: string; var strGetMes: string) : boolean;
  begin
    //Регистрационный номер извещения
    //РегНомИзв
    strGetMes := 'Формат поля: от 1 до 13 символов';

    result := false;
    result := (Length(strIn) >= 1) and (Length(strIn) <= 13);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_10(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможные значения: 60001 или 60002';

    Result := False;
    Result := CheckError.isRegExpr('^(60001|60002)$', strIn);
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidKodPok_11(strIn: string; var strGetMes: string) : boolean;
  begin
    //Код показателя
    //КодПок
    strGetMes := 'Возможные значения: 60003 или 60004';

    Result := False;
    Result := CheckError.isRegExpr('^(60003|60004)$', strIn);
  end;
  // #endregion ISVALID

  // #region DECLARE
  #declare _IsValid(_Valid, _AdrXML, _Pole, _Iter=0, _Mod=0)
    if not #_Valid(GetStrVal(#_AdrXML), getMes)
      MesErrStop
      (
        #_AdrXML
      , #_Pole
      , 'Поле не соответствует формату. ' + getMes
      , #_Iter
      , #_Mod
      );
  #end

  //----------------------------------------------------------------------------------------------------------
  #declare _IsValid_Vis(_Valid, _AdrXML, _Pole, _Iter=0, _Mod=0)
    if GetFldVis(#_AdrXML)
      if not #_Valid(GetStrVal(#_AdrXML), getMes)
        MesErrStop
        (
          #_AdrXML
        , #_Pole
        , 'Поле не соответствует формату. ' + getMes
        , #_Iter
        , #_Mod
        );
  #end

  //----------------------------------------------------------------------------------------------------------
  #declare _IsValid_Dec(_StrMes, _AdrXML, _Pole, _Cel, _Drob, _flMin, _Iter=0, _Mod=0)
    if not IsValidDecimal(GetStrVal(#_AdrXML), #_Cel, #_Drob, getMes, #_flMin)
      MesErrStop
      (
        #_AdrXML
      , #_Pole
      , 'Поле не соответствует формату. Формат поля '+ #_StrMes + getMes
      , #_Iter
      , #_Mod
      );
  #end

  //----------------------------------------------------------------------------------------------------------
  #declare _IsValid_Dec_Vis(_StrMes, _AdrXML, _Pole, _Cel, _Drob, _flMin, _Iter=0, _Mod=0)
    if GetFldVis(#_AdrXML)
      if not IsValidDecimal(GetStrVal(#_AdrXML), #_Cel, #_Drob, getMes, #_flMin)
        MesErrStop
        (
          #_AdrXML
        , #_Pole
        , 'Поле не соответствует формату. Формат поля '+ #_StrMes + getMes
        , #_Iter
      , #_Mod
        );
  #end
  // #endregion DECLARE
  // #endregion СЕРВИС On_Check
  //**********************************************************************************************************
@begin
  var getMes, XMLAdrI, XMLAdrJ : string = '';
  var flI, flJ : boolean;
  var CountI, CountJ, I, J : longint;

  if not IsValidKND(GetStrVal('Файл/Документ/КНД'), '1151090', getMes)
    MesErrStop('Файл/Документ/КНД', 'Код налоговой декларации', 'Поле не соответствует формату. ' + getMes);

  // #region ТИТУЛЬНЫЙ ЛИСТ
  #_IsValid    (IsValidDate   , 'Файл/Документ/ДатаДок'          , 'Дата документа'             )
  #_IsValid    (IsValidOtchGod, 'Файл/Документ/ОтчетГод'         , 'Отчетный год'               )
  #_IsValid    (IsValidSONO   , 'Файл/Документ/КодНО'            , 'Код налогового органа'      )
  #_IsValid    (IsValidOKVED  , 'Файл/Документ/СвНП/ОКВЭД'       , 'Код ОКВЭД'                  )
  #_IsValid    (IsValidNaimOrg, 'Файл/Документ/СвНП/НПЮЛ/НаимОрг', 'Наименование организации'   )
  #_IsValid    (IsValidINNUL  , 'Файл/Документ/СвНП/НПЮЛ/ИННЮЛ'  , 'ИНН'                        )   #_IsValid(CheckError.Prov_INN, 'Файл/Документ/СвНП/НПЮЛ/ИННЮЛ', 'ИНН')
  #_IsValid    (IsValidKPP    , 'Файл/Документ/СвНП/НПЮЛ/КПП'    , 'КПП'                        )
  #_IsValid    (IsValidPrPodp , 'Файл/Документ/Подписант/ПрПодп' , 'Признак подписанта'         )
  #_IsValid_Vis(IsValidTlf    , 'Файл/Документ/СвНП/Тлф'         , 'Контактный телефон'         )
  #_IsValid_Vis(IsValidPeriod , 'Файл/Документ/Период'           , 'Налоговый период'           )
  #_IsValid_Vis(IsValidPoMestu, 'Файл/Документ/ПоМесту'          , 'По месту нахождения (учета)')

  if GetFldVis('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ')
  {
    #_IsValid    (IsValidFormReorg, 'Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ФормРеорг', 'Форма реоргазации')
    #_IsValid_Vis(IsValidINNUL    , 'Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ИННЮЛ'    , 'ИНН'              )   #_IsValid_Vis(CheckError.Prov_INN, 'Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ИННЮЛ', 'ИНН')
    #_IsValid_Vis(IsValidKPP      , 'Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/КПП'      , 'КПП'              )
  }

  #_IsValid    (IsValidFIO, 'Файл/Документ/Подписант/ФИО/Фамилия' , 'Фамилия' )
  #_IsValid    (IsValidFIO, 'Файл/Документ/Подписант/ФИО/Имя'     , 'Имя'     )
  #_IsValid_Vis(IsValidFIO, 'Файл/Документ/Подписант/ФИО/Отчество', 'Отчество')

  if GetFldVis('Файл/Документ/Подписант/СвПред')
  {
    #_IsValid    (IsValidNaimDok, 'Файл/Документ/Подписант/СвПред/НаимДок', 'Наименование документа'  )
    #_IsValid_Vis(IsValidNaimOrg, 'Файл/Документ/Подписант/СвПред/НаимОрг', 'Наименование организации')
  }
  // #endregion ТИТУЛЬНЫЙ ЛИСТ

  // #region РАЗДЕЛ 1
  #_IsValid(IsValidNalSvid, 'Файл/Документ/АкцСпиртАлк/СумНалПУ/НалСвид', 'Наличие свидетельства (свидетельств)')

  // #region РАЗДЕЛ 1.1
  #_IsValid(IsValidOKTMO, 'Файл/Документ/АкцСпиртАлк/СумНалПУ/СумНалПУ_МО/ОКТМО', 'Разд.1.1: стр. 010')

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумНалПУ_МО/СумНалПУКод');   flI := false;
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СумНалПУ/СумНалПУ_МО/СумНалПУКод' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;
    flI := true;

    #_IsValid        (IsValidKBK   , XMLAdrI + '/КБК'     , 'Разд.1.1: стр. 020 ('     + String((i mod 3) + 1) + ')'              , -1, 3)
    #_IsValid_Dec    ('XXXXXXXXXXX', XMLAdrI + '/НалПУ'   , 'Разд.1.1: стр. 030/040 (' + String((i mod 3) + 1) + ')', 11, 0,  True, -1, 3)
    #_IsValid_Dec_Vis('XXXXXXXXXXX', XMLAdrI + '/АвансЗач', 'Разд.1.1: стр. 050 ('     + String((i mod 3) + 1) + ')', 11, 0, False, -1, 3)
  }

  if (not flI) MesErrStop('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумНалПУ_МО/СумНалПУКод/КБК', 'Раздел 1.1', 'Необходимо заполнить хотя бы одну связку строк 020 - 050');
  // #endregion РАЗДЕЛ 1.1

  // #region РАЗДЕЛ 1.2
  if GetFldVis('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл')
  {
    #_IsValid(IsValidOKTMO, 'Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл/ОКТМО', 'Разд.1.2: стр. 010')

    CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл/СумАвУплКод');   flI := false;
    for (i := 0; i < CountI; i++)
    {
      XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл/СумАвУплКод' + getIter(i);
      if not GetFldVis(XMLAdrI) continue;
      flI := true;

      #_IsValid    (IsValidKBK   , XMLAdrI + '/КБК'    , 'Разд.1.2: стр. 020 (' + String((i mod 3) + 1) + ')'              , -1, 3)
      #_IsValid_Dec('XXXXXXXXXXX', XMLAdrI + '/АвансПУ', 'Разд.1.2: стр. 030 (' + String((i mod 3) + 1) + ')', 11, 0, False, -1, 3)
    }

    if (not flI) MesErrStop('Файл/Документ/АкцСпиртАлк/СумНалПУ/СумАвУпл/СумАвУплКод/КБК', 'Раздел 1.2', 'Необходимо заполнить хотя бы одну связку строк 020 - 030');
  } // #endregion РАЗДЕЛ 1.2
  // #endregion РАЗДЕЛ 1

  // #region РАЗДЕЛ 2
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАкц');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАкц' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid(IsValidKodPT, XMLAdrI + '/КодПТ', 'Стр. 010')

    // #region РАЗДЕЛ 2.1 - 2.3
    // #region РАЗДЕЛ 2.1
    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/ОперПТ/ОперПТКод');   flJ := false;
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/ОперПТ/ОперПТКод' + getIter(j);
      if not GetFldVis(XMLAdrJ) continue;
      flJ := true;

      #_IsValid    (IsValidKodPok   , XMLAdrJ + '/КодПок'   , 'Разд.2.1: стр. ' + String((j mod 8) + 1) + ', гр. 1'              , if(i=0, -1, 1), 8)
      #_IsValid_Vis(IsValidPriznStav, XMLAdrJ + '/ПризнСтав', 'Разд.2.1: стр. ' + String((j mod 8) + 1) + ', гр. 2'              , if(i=0, -1, 1), 8)
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/НалБаза'  , 'Разд.2.1: стр. ' + String((j mod 8) + 1) + ', гр. 3', 13, 3, False, if(i=0, -1, 1), 8)
      #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/СумАкциз' , 'Разд.2.1: стр. ' + String((j mod 8) + 1) + ', гр. 4', 11, 0, False, if(i=0, -1, 1), 8)
    }

    if (not flJ) MesErrStop(XMLAdrI + '/ОперПТ/ОперПТКод/КодПок', 'Раздел 2.1', 'Необходимо заполнить хотя бы одну строку раздела');
    // #endregion РАЗДЕЛ 2.1

    // #region РАЗДЕЛ 2.2
    if GetFldVis(XMLAdrI + '/АкцизВыч')
    {
      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВыч/АкцизВычКод');   flJ := false;
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/АкцизВыч/АкцизВычКод' + getIter(j);
        if not GetFldVis(XMLAdrJ) continue;
        flJ := true;

        #_IsValid    (IsValidKodPok_2 , XMLAdrJ + '/КодПок'   , 'Разд.2.2: стр. ' + String((j mod 8) + 1) + ', гр. 1'              , if(i=0, -1, 1), 8)
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/ОбъемПТ'  , 'Разд.2.2: стр. ' + String((j mod 8) + 1) + ', гр. 2', 13, 3, False, if(i=0, -1, 1), 8)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/СумВычет' , 'Разд.2.2: стр. ' + String((j mod 8) + 1) + ', гр. 3', 11, 0, False, if(i=0, -1, 1), 8)
      }

      if (not flJ) MesErrStop(XMLAdrI + '/АкцизВыч/АкцизВычКод/КодПок', 'Раздел 2.2', 'Необходимо заполнить хотя бы одну строку раздела');
    } // #endregion РАЗДЕЛ 2.2

    // #region РАЗДЕЛ 2.3
    #_IsValid    (IsValidKodPok_3, XMLAdrI + '/АкцизПУ/КодПок'  , 'Разд.2.3: стр. 1, гр. 1'              )
    #_IsValid    (IsValidKodPok_4, XMLAdrI + '/АкцизУм/КодПок'  , 'Разд.2.3: стр. 2, гр. 1'              )
    #_IsValid_Dec('XXXXXXXXXXX'  , XMLAdrI + '/АкцизПУ/СумАкциз', 'Разд.2.3: стр. 1, гр. 2', 11, 0, False)
    #_IsValid_Dec('XXXXXXXXXXX'  , XMLAdrI + '/АкцизУм/СумАкциз', 'Разд.2.3: стр. 2, гр. 2', 11, 0, False)
    // #endregion РАЗДЕЛ 2.3

    // #region РАЗДЕЛ 2.3.1
    if GetFldVis(XMLAdrI + '/Акциз203.6')
    {
      #_IsValid    (IsValidKodPok_5, XMLAdrI + '/Акциз203.6/КодПок'  , 'Разд.2.3.1: гр. 1'              )
      #_IsValid_Dec('XXXXXXXXXXX'  , XMLAdrI + '/Акциз203.6/СумАкциз', 'Разд.2.3.1: гр. 2', 11, 0, False)
    } // #endregion РАЗДЕЛ 2.3.1
    // #endregion РАЗДЕЛ 2.1 - 2.3

    // #region РАЗДЕЛ 2.4 - 2.6
    // #region РАЗДЕЛ 2.4
    if GetFldVis(XMLAdrI + '/АкцизВозм')
    {
      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВозм/АкцизВозмКод');   flJ := false;
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/АкцизВозм/АкцизВозмКод' + getIter(j);
        if not GetFldVis(XMLAdrJ) continue;
        flJ := true;

        #_IsValid    (IsValidKodPok_6 , XMLAdrJ + '/КодПок'    , 'Разд.2.4: стр. ' + String((j mod 4) + 1) + ', гр. 1'              , if(i=0, -1, 1), 4)
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/НалБаза'   , 'Разд.2.4: стр. ' + String((j mod 4) + 1) + ', гр. 2', 13, 3, False, if(i=0, -1, 1), 4)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/СумАкциз'  , 'Разд.2.4: стр. ' + String((j mod 4) + 1) + ', гр. 3', 11, 0, False, if(i=0, -1, 1), 4)
        #_IsValid    (IsValidPeriod   , XMLAdrJ + '/НалПерЭксп', 'Разд.2.4: стр. ' + String((j mod 4) + 1) + ', гр. 4'              , if(i=0, -1, 1), 4)
        #_IsValid    (IsValidOtchGod  , XMLAdrJ + '/ГодЭксп'   , 'Разд.2.4: стр. ' + String((j mod 4) + 1) + ', гр. 5'              , if(i=0, -1, 1), 4)
      }

      if (not flJ) MesErrStop(XMLAdrI + '/АкцизВозм/АкцизВозмКод/КодПок', 'Раздел 2.4', 'Необходимо заполнить хотя бы одну строку раздела');

      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВозм/ПревУплВозм');   flJ := false;
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/АкцизВозм/ПревУплВозм' + getIter(j);
        if not GetFldVis(XMLAdrJ) continue;
        flJ := true;

        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/СумПок', 'Разд.2.4: стр. 010 (' + String((j mod 4) + 1) + '), гр. 3', 11, 0, False, if(i=0, -1, 1), 4)
        #_IsValid    (IsValidPeriod   , XMLAdrJ + '/НалПер', 'Разд.2.4: стр. 010 (' + String((j mod 4) + 1) + '), гр. 4'              , if(i=0, -1, 1), 4)
        #_IsValid    (IsValidOtchGod  , XMLAdrJ + '/Год'   , 'Разд.2.4: стр. 010 (' + String((j mod 4) + 1) + '), гр. 5'              , if(i=0, -1, 1), 4)
      }
    } // #endregion РАЗДЕЛ 2.4

    // #region РАЗДЕЛ 2.5
    if GetFldVis(XMLAdrI + '/РеалПТБГ')
    {
      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/РеалПТБГ/РеалПТБГКод');   flJ := false;
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/РеалПТБГ/РеалПТБГКод' + getIter(j);
        if not GetFldVis(XMLAdrJ) continue;
        flJ := true;

        #_IsValid    (IsValidKodPok_7 , XMLAdrJ + '/КодПок'  , 'Разд.2.5: стр. ' + String((j mod 4) + 1) + ', гр. 1'              , if(i=0, -1, 1), 4)
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/НалБаза' , 'Разд.2.5: стр. ' + String((j mod 4) + 1) + ', гр. 2', 13, 3, False, if(i=0, -1, 1), 4)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/СумАкциз', 'Разд.2.5: стр. ' + String((j mod 4) + 1) + ', гр. 3', 11, 0, False, if(i=0, -1, 1), 4)
        #_IsValid    (IsValidNalichBG , XMLAdrJ + '/НаличБГ' , 'Разд.2.5: стр. ' + String((j mod 4) + 1) + ', гр. 4'              , if(i=0, -1, 1), 4)
      }

      if (not flJ) MesErrStop(XMLAdrI + '/РеалПТБГ/РеалПТБГКод/КодПок', 'Раздел 2.5', 'Необходимо заполнить хотя бы одну строку раздела');
    } // #endregion РАЗДЕЛ 2.5

    // #region РАЗДЕЛ 2.6
    if GetFldVis(XMLAdrI + '/РеалПТЕЭС')
    {
      CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/РеалПТЕЭС/РеалПТЕЭСКод');   flJ := false;
      for (j := 0; j < CountJ; j++)
      {
        XMLAdrJ := XMLAdrI + '/РеалПТЕЭС/РеалПТЕЭСКод' + getIter(j);
        if not GetFldVis(XMLAdrJ) continue;
        flJ := true;

        #_IsValid    (IsValidKodPok_8 , XMLAdrJ + '/КодПок'    , 'Разд.2.6: стр. ' + String((j mod 4) + 1) + ', гр. 1'              , if(i=0, -1, 1), 4)
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/НалБаза'   , 'Разд.2.6: стр. ' + String((j mod 4) + 1) + ', гр. 2', 13, 3, False, if(i=0, -1, 1), 4)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/СумАкциз'  , 'Разд.2.6: стр. ' + String((j mod 4) + 1) + ', гр. 3', 11, 0, False, if(i=0, -1, 1), 4)
        #_IsValid    (IsValidPeriod   , XMLAdrJ + '/НалПерРеал', 'Разд.2.6: стр. ' + String((j mod 4) + 1) + ', гр. 4'              , if(i=0, -1, 1), 4)
        #_IsValid    (IsValidOtchGod  , XMLAdrJ + '/ГодРеал'   , 'Разд.2.6: стр. ' + String((j mod 4) + 1) + ', гр. 5'              , if(i=0, -1, 1), 4)
      }

      if (not flJ) MesErrStop(XMLAdrI + '/РеалПТЕЭС/РеалПТЕЭСКод/КодПок', 'Раздел 2.6', 'Необходимо заполнить хотя бы одну строку раздела');
    } // #endregion РАЗДЕЛ 2.6
    // #endregion РАЗДЕЛ 2.4 - 2.6
  } // #endregion РАЗДЕЛ 2

  // #region РАЗДЕЛ 3
  if GetFldVis('Файл/Документ/АкцСпиртАлк/РасчАвАкц')
  {
    // #region РАЗДЕЛ 3.1
    CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцУплЗак');
    for (i := 0; i < CountI; i++)
    {
      XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцУплЗак' + getIter(i);
      if not GetFldVis(XMLAdrI) continue;

      #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодПП'           , 'Стр. 010'              )
      #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодСпирт'        , 'Стр. 020'              )
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщЗакНеСписНач' , 'Стр. 030', 13, 3, False)
      #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/АвЗакНеСписНач'  , 'Стр. 040', 11, 0, False)
      #_IsValid_Dec    ('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщОбмЗакПер'    , 'Стр. 050', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвУплЗакПер'     , 'Стр. 060', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщЗакСписПер'   , 'Стр. 070', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвУплСписПер'    , 'Стр. 080', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщПотерНормПер' , 'Стр. 090', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвПотерНормПер'  , 'Стр. 100', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщЗакНеСписКон' , 'Стр. 110', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвУплНеСписКон'  , 'Стр. 120', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщРеалПППер'    , 'Стр. 130', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкИсчРеалПер'    , 'Стр. 140', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщИспПППер'     , 'Стр. 150', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвУплРеалПер'    , 'Стр. 160', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщПотерСпПер'   , 'Стр. 170', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкОбщПотерПер'   , 'Стр. 180', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщЗакИспПППер'  , 'Стр. 190', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвВычУменАкПотер', 'Стр. 200', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ПревАвИсчИспПер' , 'Стр. 210', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвОбщРеалКон'    , 'Стр. 220', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ПревАвИсчИспКон' , 'Стр. 230', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщСпиртЗакСлед' , 'Стр. 240', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ОбщАвУплПер'     , 'Стр. 250', 11, 0, False)
    } // #endregion РАЗДЕЛ 3.1

    // #region РАЗДЕЛ 3.2
    CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ204');
    for (i := 0; i < CountI; i++)
    {
      XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ204' + getIter(i);
      if not GetFldVis(XMLAdrI) continue;

      #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодПП'          , 'Стр. 010'              )
      #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодСпирт'       , 'Стр. 020'              )
      #_IsValid_Dec    ('XXXX'          , XMLAdrI + '/ОбщКолБГПер'    , 'Стр. 030',  4, 0, False)
      #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/ОбщСумБГПер'    , 'Стр. 040', 11, 0, False)
      #_IsValid_Dec    ('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщОбмЗакПер'   , 'Стр. 050', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщОбмПотерПер' , 'Стр. 060', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщОбмЗакПотер' , 'Стр. 070', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвОсвБГУчПотер' , 'Стр. 080', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщРеалПППер'   , 'Стр. 090', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкИсчРеалПер'   , 'Стр. 100', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкИсчРеалКонИзв', 'Стр. 110', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ПревАвОсвИсчКон', 'Стр. 120', 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбщСпиртЗакСлед', 'Стр. 130', 13, 3, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ОбщАвОсвПер'    , 'Стр. 140', 11, 0, False)
    } // #endregion РАЗДЕЛ 3.2

    // #region РАЗДЕЛ 3.3
    CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ184');
    for (i := 0; i < CountI; i++)
    {
      XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ184' + getIter(i);
      if not GetFldVis(XMLAdrI) continue;

      #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодПП'                    , 'Стр. 010'                     )
      #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодСпирт'                 , 'Стр. 020'                     )
      #_IsValid_Dec    ('XXXX'          , XMLAdrI + '/ОбщКолБГПер'              , 'Стр. 030'       ,  4, 0, False)
      #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/ОбщСумБГ'                 , 'Стр. 040'       , 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ПревАвОсвРеал'            , 'Стр. 140, гр. 4', 11, 0, False)
      #_IsValid_Dec    ('XXXXXXXXXX.XXX', XMLAdrI + '/АвОсвУплПерБГ/ОбщОбъемСп' , 'Стр. 050, гр. 3', 13, 3, False)
      #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/АвОсвУплПерБГ/СумАвАкциз' , 'Стр. 050, гр. 4', 11, 0, False)
      #_IsValid_Dec    ('XXXXXXXXXX.XXX', XMLAdrI + '/АвОсвУплЗакПер/ОбщОбъемСп', 'Стр. 060, гр. 3', 13, 3, False)
      #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/АвОсвУплЗакПер/СумАвАкциз', 'Стр. 060, гр. 4', 11, 0, False)

      if GetFldVis(XMLAdrI + '/АкЗакРеалПер'   ) { #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкЗакРеалПер/ОбъемРеал'   , 'Стр. 070, гр. 3', 13, 3, False)
                                                   #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкЗакРеалПер/СумАкциз'    , 'Стр. 070, гр. 4', 11, 0, False) }
      if GetFldVis(XMLAdrI + '/АкЭкспНеПдтвНач') { #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкЭкспНеПдтвНач/ОбъемРеал', 'Стр. 080, гр. 3', 13, 3, False)
                                                   #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкЭкспНеПдтвНач/СумАкциз' , 'Стр. 080, гр. 4', 11, 0, False) }
      if GetFldVis(XMLAdrI + '/АкЭкспПдтвПер'  ) { #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкЭкспПдтвПер/ОбъемРеал'  , 'Стр. 090, гр. 3', 13, 3, False)
                                                   #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкЭкспПдтвПер/СумАкциз'   , 'Стр. 090, гр. 4', 11, 0, False) }
      if GetFldVis(XMLAdrI + '/АкЭкспПдтвКон'  ) { #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкЭкспПдтвКон/ОбъемРеал'  , 'Стр. 100, гр. 3', 13, 3, False)
                                                   #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкЭкспПдтвКон/СумАкциз'   , 'Стр. 100, гр. 4', 11, 0, False) }
      if GetFldVis(XMLAdrI + '/АкЭкспНеПдтвКон') { #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкЭкспНеПдтвКон/ОбъемРеал', 'Стр. 110, гр. 3', 13, 3, False)
                                                   #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкЭкспНеПдтвКон/СумАкциз' , 'Стр. 110, гр. 4', 11, 0, False) }
      if GetFldVis(XMLAdrI + '/АкРеалРФКон'    ) { #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкРеалРФКон/ОбъемРеал'    , 'Стр. 120, гр. 3', 13, 3, False)
                                                   #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкРеалРФКон/СумАкциз'     , 'Стр. 120, гр. 4', 11, 0, False) }
      if GetFldVis(XMLAdrI + '/АкРеалКон'      ) { #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкРеалКон/ОбъемРеал'      , 'Стр. 130, гр. 3', 13, 3, False)
                                                   #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкРеалКон/СумАкциз'       , 'Стр. 130, гр. 4', 11, 0, False) }
    } // #endregion РАЗДЕЛ 3.3
  } // #endregion РАЗДЕЛ 3

  // #region ПРИЛОЖЕНИЕ 1
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчНБВидПТ');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчНБВидПТ' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid(IsValidKodPT, XMLAdrI + '/КодПТ', 'Стр. 010')

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/РасчНБКод');   flJ := false;
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/РасчНБКод' + getIter(j);
      if not GetFldVis(XMLAdrJ) continue;
      flJ := true;

      #_IsValid    (IsValidKodPok_9 , XMLAdrJ + '/КодПок'  , 'Стр. '+LPadCh(String((j mod 20) + 1), '0', 2)+', гр. 1'              , if(i=0, -1, 1), 20)
      #_IsValid_Dec('XXX.X'         , XMLAdrJ + '/СодСпирт', 'Стр. '+LPadCh(String((j mod 20) + 1), '0', 2)+', гр. 2',  4, 1, False, if(i=0, -1, 1), 20)
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/ОбъемПТ' , 'Стр. '+LPadCh(String((j mod 20) + 1), '0', 2)+', гр. 3', 13, 3, False, if(i=0, -1, 1), 20)
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/НалБаза' , 'Стр. '+LPadCh(String((j mod 20) + 1), '0', 2)+', гр. 4', 13, 3, False, if(i=0, -1, 1), 20)
    }

    if (not flJ) MesErrStop(XMLAdrI + '/РасчНБКод/КодПок', 'Приложение 1', 'Необходимо заполнить хотя бы одну строку раздела');
  } // #endregion ПРИЛОЖЕНИЕ 1

  // #region ПРИЛОЖЕНИЕ 2.1
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАкОсвБГЭксп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАкОсвБГЭксп' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодПТ'                , 'Стр. 010'                     )
    #_IsValid_Dec    ('XXXX'          , XMLAdrI + '/ОбщКолБГПер'          , 'Стр. 020'       ,  4, 0, False)
    #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/ОбщСумБГПер'          , 'Стр. 030'       , 11, 0, False)
    #_IsValid_Dec    ('XXXXXXXXXX.XXX', XMLAdrI + '/АкОсвЭкспПер/ОбъемПТ ', 'Стр. 040, гр. 3', 13, 3, False)
    #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвЭкспПер/СумАкциз', 'Стр. 040, гр. 4', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвБГЭкНеПдтвПер'   , 'Стр. 050, гр. 4', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвБГЭкПдтвПред'    , 'Стр. 070, гр. 4', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвБГЭкПдтвКон'     , 'Стр. 080, гр. 4', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвБГЭкНеПдтвКон'   , 'Стр. 090, гр. 4', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ПрАкОсвБГПдтвКон'     , 'Стр. 100, гр. 4', 11, 0, False)

    if GetFldVis(XMLAdrI + '/АкОсвЭкспПдтвПер') {
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкОсвЭкспПдтвПер/ОбъемПТ' , 'Стр. 060, гр. 3', 13, 3, False)
      #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвЭкспПдтвПер/СумАкциз', 'Стр. 060, гр. 4', 11, 0, False)
    }

    // #region ПРИЛОЖЕНИЕ 2.2
    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/БГОсвРеалЭксп');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/БГОсвРеалЭксп' + getIter(j);
      if not GetFldVis(XMLAdrJ) continue;

      #_IsValid        (IsValidDate     , XMLAdrJ + '/ДатаВыдБГ'                , 'Стр. 115'                     )
      #_IsValid        (IsValidNomerBG  , XMLAdrJ + '/НомерБГ'                  , 'Стр. 120'                     )
      #_IsValid        (IsValidDate     , XMLAdrJ + '/ДатаНачБГ'                , 'Стр. 130'                     )
      #_IsValid        (IsValidDate     , XMLAdrJ + '/ДатаКонБГ'                , 'Стр. 140'                     )
      #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrJ + '/СуммаБГ'                  , 'Стр. 150'       , 11, 0, False)
      #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrJ + '/ПрАкЭкспПдтвКон'          , 'Стр. 220, гр. 4', 11, 0, False)
      #_IsValid_Dec    ('XXXXXXXXXX.XXX', XMLAdrJ + '/АкОсвЭкспПер/ОбРеалЭкспПТ', 'Стр. 160, гр. 3', 13, 3, False)
      #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrJ + '/АкОсвЭкспПер/СумАкциз'    , 'Стр. 160, гр. 4', 11, 0, False)

      if GetFldVis(XMLAdrJ + '/АкЭкспНеПдтвНач') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/АкЭкспНеПдтвНач/ОбРеалЭкспПТ', 'Стр. 170, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/АкЭкспНеПдтвНач/СумАкциз'    , 'Стр. 170, гр. 4', 11, 0, False)
        #_IsValid    (IsValidPeriod   , XMLAdrJ + '/АкЭкспНеПдтвНач/НалПерЭксп'  , 'Стр. 170, гр. 5'              )
        #_IsValid    (IsValidOtchGod  , XMLAdrJ + '/АкЭкспНеПдтвНач/ГодЭксп'     , 'Стр. 170, гр. 6'              )
      }

      if GetFldVis(XMLAdrJ + '/АкЭкспПдтвПер') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/АкЭкспПдтвПер/ОбРеалЭкспПТ', 'Стр. 180, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/АкЭкспПдтвПер/СумАкциз'    , 'Стр. 180, гр. 4', 11, 0, False)
        #_IsValid    (IsValidPeriod   , XMLAdrJ + '/АкЭкспПдтвПер/НалПерЭксп'  , 'Стр. 180, гр. 5'              )
        #_IsValid    (IsValidOtchGod  , XMLAdrJ + '/АкЭкспПдтвПер/ГодЭксп'     , 'Стр. 180, гр. 6'              )
      }

      if GetFldVis(XMLAdrJ + '/АкЭкспПдтвПред') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/АкЭкспПдтвПред/ОбРеалЭкспПТ', 'Стр. 190, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/АкЭкспПдтвПред/СумАкциз'    , 'Стр. 190, гр. 4', 11, 0, False)
      }

      if GetFldVis(XMLAdrJ + '/АкЭкспПдтвКон') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/АкЭкспПдтвКон/ОбРеалЭкспПТ', 'Стр. 200, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/АкЭкспПдтвКон/СумАкциз'    , 'Стр. 200, гр. 4', 11, 0, False)
        #_IsValid    (IsValidPeriod   , XMLAdrJ + '/АкЭкспПдтвКон/НалПерЭксп'  , 'Стр. 200, гр. 5'              )
        #_IsValid    (IsValidOtchGod  , XMLAdrJ + '/АкЭкспПдтвКон/ГодЭксп'     , 'Стр. 200, гр. 6'              )
      }

      if GetFldVis(XMLAdrJ + '/АкЭкспНеПдтвКон') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/АкЭкспНеПдтвКон/ОбРеалЭкспПТ', 'Стр. 210, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/АкЭкспНеПдтвКон/СумАкциз'    , 'Стр. 210, гр. 4', 11, 0, False)
        #_IsValid    (IsValidPeriod   , XMLAdrJ + '/АкЭкспНеПдтвКон/НалПерЭксп'  , 'Стр. 210, гр. 5'              )
        #_IsValid    (IsValidOtchGod  , XMLAdrJ + '/АкЭкспНеПдтвКон/ГодЭксп'     , 'Стр. 210, гр. 6'              )
      }
    } // #endregion ПРИЛОЖЕНИЕ 2.2
  } // #endregion ПРИЛОЖЕНИЕ 2.1

  // #region ПРИЛОЖЕНИЕ 3.1
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СпРеалПерПокуп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СпРеалПерПокуп' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid(IsValidINNUL       , XMLAdrI + '/ИННЮЛ', 'Стр. 010')
    #_IsValid(CheckError.Prov_INN, XMLAdrI + '/ИННЮЛ', 'Стр. 010')
    #_IsValid(IsValidKPP         , XMLAdrI + '/КПП'  , 'Стр. 020')

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/ОбРеалСпПок');   flJ := false;
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/ОбРеалСпПок' + getIter(j);
      if not GetFldVis(XMLAdrJ) continue;
      flJ := true;

      #_IsValid    (IsValidKodPok_10, XMLAdrJ + '/КодПок'   , 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 1'              , if(i=0, -1, 1), 18)
      #_IsValid    (IsValidKodPT    , XMLAdrJ + '/КодСпиртР', 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 2'              , if(i=0, -1, 1), 18)
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/ОбСпРеал' , 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 3', 13, 3, False, if(i=0, -1, 1), 18)
      #_IsValid    (IsValidKodPT    , XMLAdrJ + '/КодПП'    , 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 4'              , if(i=0, -1, 1), 18)
      #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/АвИзвещ'  , 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 5', 11, 0, False, if(i=0, -1, 1), 18)
    }

    if (not flJ) MesErrStop(XMLAdrI + '/ОбРеалСпПок/КодПок', 'Приложение 3.1', 'Необходимо заполнить хотя бы одну строку раздела');
  } // #endregion ПРИЛОЖЕНИЕ 3.1

  // #region ПРИЛОЖЕНИЕ 3.2
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СпПриобПерПрод');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СпПриобПерПрод' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid(IsValidINNUL       , XMLAdrI + '/ИННЮЛ', 'Стр. 010')
    #_IsValid(CheckError.Prov_INN, XMLAdrI + '/ИННЮЛ', 'Стр. 010')
    #_IsValid(IsValidKPP         , XMLAdrI + '/КПП'  , 'Стр. 020')

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/ОбПриобСпПрод');   flJ := false;
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/ОбПриобСпПрод' + getIter(j);
      if not GetFldVis(XMLAdrJ) continue;
      flJ := true;

      #_IsValid    (IsValidKodPok_11, XMLAdrJ + '/КодПок'   , 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 1'              , if(i=0, -1, 1), 18)
      #_IsValid    (IsValidKodPT    , XMLAdrJ + '/КодСпиртП', 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 2'              , if(i=0, -1, 1), 18)
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrJ + '/ОбПриобСп', 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 3', 13, 3, False, if(i=0, -1, 1), 18)
      #_IsValid    (IsValidKodPT    , XMLAdrJ + '/КодПП'    , 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 4'              , if(i=0, -1, 1), 18)
      #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrJ + '/АвИзвещ'  , 'Стр. '+LPadCh(String((j mod 18) + 1), '0', 2)+', гр. 5', 11, 0, False, if(i=0, -1, 1), 18)
    }

    if (not flJ) MesErrStop(XMLAdrI + '/ОбПриобСпПрод/КодПок', 'Приложение 3.2', 'Необходимо заполнить хотя бы одну строку раздела');
  } // #endregion ПРИЛОЖЕНИЕ 3.2

  // #region ПРИЛОЖЕНИЕ 4
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СпПолучСвид');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СпПолучСвид' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid(IsValidNaimOrg     , XMLAdrI + '/НаимОрг'    , 'Стр. 010'        )
    #_IsValid(IsValidINNUL       , XMLAdrI + '/ИННЮЛ'      , 'Стр. 020'        )
    #_IsValid(CheckError.Prov_INN, XMLAdrI + '/ИННЮЛ'      , 'Стр. 020'        )
    #_IsValid(IsValidKPP         , XMLAdrI + '/КПП'        , 'Стр. 030'        )
    #_IsValid(IsValidSerSvidPost , XMLAdrI + '/СерСвидПост', 'Стр. 040 (серия)')
    #_IsValid(IsValidNomSvidPost , XMLAdrI + '/НомСвидПост', 'Стр. 040 (номер)')

    if GetFldVis(XMLAdrI + '/ОбПолучСпПер111') {
      #_IsValid    (IsValidKodPT_111, XMLAdrI + '/ОбПолучСпПер111/КодСпирт'    , 'Стр. 050, гр. 1'              )
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/ОбПолучСпПер111/ОбПолучСпПер', 'Стр. 050, гр. 3', 13, 3, False)
    }

    if GetFldVis(XMLAdrI + '/ОбПолучСпПер121') {
      #_IsValid    (IsValidKodPT_121, XMLAdrI + '/ОбПолучСпПер121/КодСпирт'    , 'Стр. 060, гр. 1'              )
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/ОбПолучСпПер121/ОбПолучСпПер', 'Стр. 060, гр. 3', 13, 3, False)
    }

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/СвОбСпСчФ');   flJ := false;
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/СвОбСпСчФ' + getIter(j);
      if not GetFldVis(XMLAdrJ) continue;
      flJ := true;

      #_IsValid        (IsValidKodPT_111_121, XMLAdrJ + '/КодСпирт', 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 1'              , if(i=0, -1, 1), 3)
      #_IsValid        (IsValidText_256     , XMLAdrJ + '/НомСчФ'  , 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 2'              , if(i=0, -1, 1), 3)
      #_IsValid        (IsValidDate         , XMLAdrJ + '/ДатаСчФ' , 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 3'              , if(i=0, -1, 1), 3)
      #_IsValid_Dec    ('XXXXXXXXXX.XXX'    , XMLAdrJ + '/ОбСпСчФ' , 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 4', 13, 3, False, if(i=0, -1, 1), 3)
      #_IsValid_Vis    (IsValidText_256     , XMLAdrJ + '/НомКСчФ' , 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 5'              , if(i=0, -1, 1), 3)
      #_IsValid_Vis    (IsValidDate         , XMLAdrJ + '/ДатаКСчФ', 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 6'              , if(i=0, -1, 1), 3)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX'    , XMLAdrJ + '/ОбСпКСчФ', 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 7', 13, 3, False, if(i=0, -1, 1), 3)
    }

    if (not flJ) MesErrStop(XMLAdrI + '/СвОбСпСчФ/КодСпирт', 'Приложение 4', 'Необходимо заполнить хотя бы одну строку раздела');
  } // #endregion ПРИЛОЖЕНИЕ 4

  // #region ПРИЛОЖЕНИЕ 5
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/СпРеалСвид');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/СпРеалСвид' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid(IsValidNaimOrg     , XMLAdrI + '/НаимОрг'   , 'Стр. 010'        )
    #_IsValid(IsValidINNUL       , XMLAdrI + '/ИННЮЛ'     , 'Стр. 020'        )
    #_IsValid(CheckError.Prov_INN, XMLAdrI + '/ИННЮЛ'     , 'Стр. 020'        )
    #_IsValid(IsValidKPP         , XMLAdrI + '/КПП'       , 'Стр. 030'        )
    #_IsValid(IsValidSerSvidPost , XMLAdrI + '/СерСвидПол', 'Стр. 040 (серия)')
    #_IsValid(IsValidNomSvidPost , XMLAdrI + '/НомСвидПол', 'Стр. 040 (номер)')

    if GetFldVis(XMLAdrI + '/ОбРеалСпПер111') {
      #_IsValid    (IsValidKodPT_111, XMLAdrI + '/ОбРеалСпПер111/КодСпирт'   , 'Стр. 050, гр. 1'              )
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/ОбРеалСпПер111/ОбРеалСпПер', 'Стр. 050, гр. 3', 13, 3, False)
    }

    if GetFldVis(XMLAdrI + '/ОбРеалСпПер121') {
      #_IsValid    (IsValidKodPT_121, XMLAdrI + '/ОбРеалСпПер121/КодСпирт'   , 'Стр. 060, гр. 1'              )
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/ОбРеалСпПер121/ОбРеалСпПер', 'Стр. 060, гр. 3', 13, 3, False)
    }

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/СвОбСпСчФ');   flJ := false;
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/СвОбСпСчФ' + getIter(j);
      if not GetFldVis(XMLAdrJ) continue;
      flJ := true;

      #_IsValid        (IsValidKodPT_111_121, XMLAdrJ + '/КодСпирт', 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 1'              , if(i=0, -1, 1), 3)
      #_IsValid        (IsValidText_256     , XMLAdrJ + '/НомСчФ'  , 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 2'              , if(i=0, -1, 1), 3)
      #_IsValid        (IsValidDate         , XMLAdrJ + '/ДатаСчФ' , 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 3'              , if(i=0, -1, 1), 3)
      #_IsValid_Dec    ('XXXXXXXXXX.XXX'    , XMLAdrJ + '/ОбСпСчФ' , 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 4', 13, 3, False, if(i=0, -1, 1), 3)
      #_IsValid_Vis    (IsValidText_256     , XMLAdrJ + '/НомКСчФ' , 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 5'              , if(i=0, -1, 1), 3)
      #_IsValid_Vis    (IsValidDate         , XMLAdrJ + '/ДатаКСчФ', 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 6'              , if(i=0, -1, 1), 3)
      #_IsValid_Dec_Vis('XXXXXXXXXX.XXX'    , XMLAdrJ + '/ОбСпКСчФ', 'Стр. 070 (' + String((j mod 3) + 1) + '), гр. 7', 13, 3, False, if(i=0, -1, 1), 3)
    }

    if (not flJ) MesErrStop(XMLAdrI + '/СвОбСпСчФ/КодСпирт', 'Приложение 5', 'Необходимо заполнить хотя бы одну строку раздела');
  } // #endregion ПРИЛОЖЕНИЕ 5

  // #region ПРИЛОЖЕНИЕ 6
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвППЗакупСп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/АвППЗакупСп' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid        (IsValidRegNomIzv, XMLAdrI + '/РегНомИзв'                 , 'Стр. 010'                     )
    #_IsValid        (IsValidDate     , XMLAdrI + '/ДатаРегИзв'                , 'Стр. 020'                     )
    #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодСпирт'                  , 'Стр. 030'                     )
    #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодПП'                     , 'Стр. 040'                     )
    #_IsValid_Dec    ('XXXXXXXXXX.XXX', XMLAdrI + '/ОбСпиртИзв'                , 'Стр. 050'       , 13, 3, False)
    #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/АвУплИзв'                  , 'Стр. 060'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбЗакНеСписНач'            , 'Стр. 070'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвЗакНеСписНач'            , 'Стр. 080'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбСпЗакИзвПер'             , 'Стр. 090'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвЗакПер'                  , 'Стр. 100'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбИзвСписПер'              , 'Стр. 110'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвСписПер'                 , 'Стр. 120'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбПотерЗакПерНорм'         , 'Стр. 130'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвПотерНорм'               , 'Стр. 140'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбЗакНеСписКон'            , 'Стр. 150'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвНеСписКон'               , 'Стр. 160'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбППРеалПерИзв'            , 'Стр. 170'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкИсчППРеалПер'            , 'Стр. 180'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбЗакППРеалПер/ОбРеалПП'   , 'Стр. 190, гр. 3', 13, 3, False)
    #_IsValid_Dec_Vis('XX.X'          , XMLAdrI + '/ОбЗакППРеалПер/СодСпиртПП' , 'Стр. 190, гр. 4',  3, 1, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбЗакППРеалПер/ОбСпСодПП'  , 'Стр. 190, гр. 5', 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвИспППРеалПер'            , 'Стр. 200'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбПотерЗакПерСв'           , 'Стр. 210'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкСвПотерПер'              , 'Стр. 220'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбИспППРеалПер'            , 'Стр. 230'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвВычСвПотерПер'           , 'Стр. 240'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ПрАвЗакРеалПер'            , 'Стр. 250'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвИсчППРеалПред'           , 'Стр. 260'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвИсчППРеалКон'            , 'Стр. 270'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ПрАвЗакРеалКон'            , 'Стр. 280'       , 11, 0, False)
  } // #endregion ПРИЛОЖЕНИЕ 6

  // #region ПРИЛОЖЕНИЕ 7
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвОсвБГ204');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/АвОсвБГ204' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid        (IsValidRegNomIzv, XMLAdrI + '/РегНомИзв'        , 'Стр. 010'              )
    #_IsValid        (IsValidDate     , XMLAdrI + '/ДатаРегИзв'       , 'Стр. 020'              )
    #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодСпирт'         , 'Стр. 030'              )
    #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодПП'            , 'Стр. 040'              )
    #_IsValid        (IsValidDate     , XMLAdrI + '/ДатаВыдБГ'        , 'Стр. 045'              )
    #_IsValid        (IsValidNomerBG  , XMLAdrI + '/НомерБГ'          , 'Стр. 050'              )
    #_IsValid        (IsValidDate     , XMLAdrI + '/ДатаНачБГ'        , 'Стр. 060'              )
    #_IsValid        (IsValidDate     , XMLAdrI + '/ДатаКонБГ'        , 'Стр. 070'              )
    #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/СуммаБГ'          , 'Стр. 080', 11, 0, False)
    #_IsValid_Dec    ('XXXXXXXXXX.XXX', XMLAdrI + '/ОбСпиртИзв'       , 'Стр. 090', 13, 3, False)
    #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/АвОсвУплИзвещ'    , 'Стр. 100', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбСпЗакИзвПер'    , 'Стр. 110', 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбПотерПер'       , 'Стр. 120', 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбСпЗакПотерПер'  , 'Стр. 130', 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвОсвЗакПер'      , 'Стр. 140', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбППРеалПерЗак'   , 'Стр. 150', 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкИсчППРеалПер'   , 'Стр. 160', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкИсчРеалПППред'  , 'Стр. 170', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АкИсчРеалППКон'   , 'Стр. 180', 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ПрАвОсвЗакРеалКон', 'Стр. 190', 11, 0, False)
  } // #endregion ПРИЛОЖЕНИЕ 7

  // #region ПРИЛОЖЕНИЕ 8
  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп' + getIter(i);
    if not GetFldVis(XMLAdrI) continue;

    #_IsValid        (IsValidRegNomIzv, XMLAdrI + '/РегНомИзв'         , 'Стр. 010'                     )
    #_IsValid        (IsValidDate     , XMLAdrI + '/ДатаРегИзв'        , 'Стр. 020'                     )
    #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодСпирт'          , 'Стр. 030'                     )
    #_IsValid        (IsValidKodPT    , XMLAdrI + '/КодПП'             , 'Стр. 040'                     )
    #_IsValid        (IsValidDate     , XMLAdrI + '/ДатаВыдБГ'         , 'Стр. 045'                     )
    #_IsValid        (IsValidNomerBG  , XMLAdrI + '/НомерБГ'           , 'Стр. 050'                     )
    #_IsValid        (IsValidDate     , XMLAdrI + '/ДатаНачБГ'         , 'Стр. 060'                     )
    #_IsValid        (IsValidDate     , XMLAdrI + '/ДатаКонБГ'         , 'Стр. 070'                     )
    #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/СуммаБГ'           , 'Стр. 080'       , 11, 0, False)
    #_IsValid_Dec    ('XXXXXXXXXX.XXX', XMLAdrI + '/ОбСпИзвещ'         , 'Стр. 090'       , 13, 3, False)
    #_IsValid_Dec    ('XXXXXXXXXXX'   , XMLAdrI + '/АвОсвУплИзвещ'     , 'Стр. 100'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбСпЗакИзвПер'     , 'Стр. 110'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбПотерПер'        , 'Стр. 120'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXX.XXX', XMLAdrI + '/ОбСпЗакУчПотерПер' , 'Стр. 130'       , 13, 3, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/АвОсвЗакупПотерПер', 'Стр. 140'       , 11, 0, False)
    #_IsValid_Dec_Vis('XXXXXXXXXXX'   , XMLAdrI + '/ПрАвОсвРеалКон'    , 'Стр. 180, гр. 4', 11, 0, False)

    if GetFldVis(XMLAdrI + '/АкРеалПдтвКон') {
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкРеалПдтвКон/ОбъемРеал', 'Стр. 150, гр. 3', 13, 3, False)
      #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкРеалПдтвКон/СумАкциз' , 'Стр. 150, гр. 4', 11, 0, False)
    }

    if GetFldVis(XMLAdrI + '/АкРеалРФКон') {
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкРеалРФКон/ОбъемРеал', 'Стр. 160, гр. 3', 13, 3, False)
      #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкРеалРФКон/СумАкциз' , 'Стр. 160, гр. 4', 11, 0, False)
    }

    if GetFldVis(XMLAdrI + '/АкЗакОсвРеал') {
      #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкЗакОсвРеал/ОбъемРеал', 'Стр. 170, гр. 3', 13, 3, False)
      #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкЗакОсвРеал/СумАкциз' , 'Стр. 170, гр. 4', 11, 0, False)
    }

    if GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп') {
      if GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкРеалЭкспПер') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкОсвБГРеалЭксп/АкРеалЭкспПер/ОбРеалЭкспПП', 'Стр. 190, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвБГРеалЭксп/АкРеалЭкспПер/СумАкциз'    , 'Стр. 190, гр. 4', 11, 0, False)
      }

      if GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/ОбРеалЭкспПП', 'Стр. 200, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/СумАкциз'    , 'Стр. 200, гр. 4', 11, 0, False)
        #_IsValid    (IsValidPeriod   , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/НалПерЭксп'  , 'Стр. 200, гр. 5'              )
        #_IsValid    (IsValidOtchGod  , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/ГодЭксп'     , 'Стр. 200, гр. 6'              )
      }

      if GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/ОбРеалЭкспПП', 'Стр. 210, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/СумАкциз'    , 'Стр. 210, гр. 4', 11, 0, False)
        #_IsValid    (IsValidPeriod   , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/НалПерЭксп'  , 'Стр. 210, гр. 5'              )
        #_IsValid    (IsValidOtchGod  , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/ГодЭксп'     , 'Стр. 210, гр. 6'              )
      }

      if GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред/ОбРеалЭкспПП', 'Стр. 220, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред/СумАкциз'    , 'Стр. 220, гр. 4', 11, 0, False)
      }

      if GetFldVis(XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/ОбРеалЭкспПП', 'Стр. 230, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/СумАкциз'    , 'Стр. 230, гр. 4', 11, 0, False)
        #_IsValid    (IsValidPeriod   , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/НалПерЭксп'  , 'Стр. 230, гр. 5'              )
        #_IsValid    (IsValidOtchGod  , XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/ГодЭксп'     , 'Стр. 230, гр. 6'              )
      }
    }

    if GetFldVis(XMLAdrI + '/АвРеалРФОсвБГ') {
      if GetFldVis(XMLAdrI + '/АкИсчРеалРФПер') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПер/ОбъемРеал', 'Стр. 240, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПер/СумАкциз' , 'Стр. 240, гр. 4', 11, 0, False)
      }

      if GetFldVis(XMLAdrI + '/АкИсчРеалРФПред') {
        #_IsValid_Dec('XXXXXXXXXX.XXX', XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПред/ОбъемРеал', 'Стр. 250, гр. 3', 13, 3, False)
        #_IsValid_Dec('XXXXXXXXXXX'   , XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПред/СумАкциз' , 'Стр. 250, гр. 4', 11, 0, False)
      }
    }
  } // #endregion ПРИЛОЖЕНИЕ 8
@end.
// #endregion ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ПРОВЕРКЕ
//************************************************************************************************************


//============================================================================================================
// #region ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ РАСЧЕТЕ
//------------------------------------------------------------------------------------------------------------
@Script On_Recalc : boolean;
  //==========================================================================================================
  // #region СЕРВИС On_Recalc
  //----------------------------------------------------------------------------------------------------------
  procedure Log(_strAdr, _strMes, _strVal : string);
  {
    MesError.InsertRasch('', _strAdr, _strMes, _strVal);
  }

  procedure LogIter(_strAdr, _strMes, _strVal : string; _iter, _mod : integer);
  {
    MesError.InsertRasch('', _strAdr, _strMes, _strVal, _iter, _mod);
  }

  procedure LogProc(_strAdr, _strMes, _strVal : string; fl : boolean);
  {
    if fl
    then MesError.InsertRasch('', _strAdr, _strMes + ' / 100', _strVal + ' / 100')
    else MesError.InsertRasch('', _strAdr, _strMes, _strVal);
  }

  procedure SV(_adr : string; var _val : double);
  {
    SetDblVal(_adr, _val);
    _val := GetDblVal(_adr);
  }

  procedure SetNulVal_Get(_adr : string; var _val : double);
  {
    SetNulVal(_adr);
    _val := GetDblVal(_adr);
  }

  procedure GetCutStr (var inputStr : string);
  {
    inputStr := SubStr(inputStr, 1, Length(inputStr) - 3);
    if (inputStr = '') inputStr := '0';
  }

  function GetNStr (_Num, _Count : longint) : string;
  { Result := if (Length(String(_Count)) > 1, LPadCh(String((_Num mod _Count) + 1), '0', Length(String(_Count))), String((_Num mod _Count) + 1)); }
  // #endregion СЕРВИС On_Recalc
  //**********************************************************************************************************
@begin
  On_Visable;
  //------------------------------------------------------------------------------------------------------------

  if ((GetStrVal('Файл/Документ/ДатаДок') = '') or (GetStrVal('Файл/Документ/ДатаДок') = 'ДД.ММ.ГГГГ'))
    SetFldVal('Файл/Документ/ДатаДок', DateToStr(Cur_Date, XMLMap.GetAttrVFormatByName('Файл/Документ/ДатаДок')));

  var KodOKEI_EdIzm_744 : double;
  KodOKEI_EdIzm_744 := 1;

  var XMLAdrI, XMLAdrJ, XMLAdrK : string;
  var CountI, CountJ, CountK
    , I, J, K : integer;
  var fl, flProc : boolean;

  var aStAkc : string;
  var valStAkc : double;

  // #region РАЗДЕЛ 2
  var buf_vR24_010_20003, buf_vR24_010_50001
    , buf_vR21_Gr4, buf_vR22_Gr3
    , aR23_Gr2_40001, aR23_Gr2_40002, vR23_Gr3, mR23_Gr3
    , sR24_Gr4, sR24_Gr5
    , aR21_Gr1, aR21_Gr3, aR21_Gr4, mR21_Gr4, vR21_Gr4
    , aR22_Gr1, aR22_Gr2, aR22_Gr3
    , aR24_Gr1, aR24_Gr2, aR24_Gr3, aR24_Gr4, aR24_Gr5, mR24_Gr3, vR24_Gr3
    , aR25_Gr1, aR25_Gr2, aR25_Gr3, aR25_Gr4, mR25_Gr3, vR25_Gr3
    , aR26_Gr1, aR26_Gr2, aR26_Gr3, aR26_Gr4, aR26_Gr5, mR26_Gr3, vR26_Gr3 : string = '';
  var buf_dR21_Gr4, buf_dR22_Gr3, dR23_Gr2
    , buf_dR24_010_20003, buf_dR24_010_50001
    , dR21_Gr2, dR21_Gr3, dR21_Gr4
    , dR22_Gr3
    , dR24_Gr2, dR24_Gr3
    , dR25_Gr2, dR25_Gr3
    , dR26_Gr2, dR26_Gr3 : double;

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАкц');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАкц' + getIter(i);

    if GetStrNull(XMLAdrI + '/КодПТ') continue;

    aStAkc := XMLAdrI + '/СтАкц';
    valStAkc := GetDblVal(aStAkc);

    flProc := (GetDblVal(XMLAdrI + '/ЕдИзм') = KodOKEI_EdIzm_744);
    if (flProc) valStAkc := valStAkc / 100;

    // #region РАЗДЕЛ 2.1
    buf_dR21_Gr4 := 0;
    buf_vR21_Gr4 := '';

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/ОперПТ/ОперПТКод');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/ОперПТ/ОперПТКод' + getIter(j);

      aR21_Gr1 := XMLAdrJ + '/КодПок'  ;
      aR21_Gr3 := XMLAdrJ + '/НалБаза' ;   dR21_Gr3 := GetDblVal(aR21_Gr3);
      aR21_Gr4 := XMLAdrJ + '/СумАкциз';

      if     not GetStrNull(aR21_Gr1)
         and not GetStrNull(aR21_Gr3)
      {
        dR21_Gr4 := dR21_Gr3 * valStAkc;   SV(aR21_Gr4, dR21_Gr4);

        buf_dR21_Gr4 += dR21_Gr4;   buf_vR21_Gr4 += GV(aR21_Gr4) + ' + ';

        if (flProc)
        {
          vR21_Gr4 := GV(aR21_Gr4)+' = '+GV(aR21_Gr3)+' * '+GV(aStAkc)+' / 100';
          mR21_Gr4 := 'Раздел 2.1 (' + GetNStr(j,8) + '): Гр. 4 = гр. 3 * Ставку акциза / 100';
        } else {
          vR21_Gr4 := GV(aR21_Gr4)+' = '+GV(aR21_Gr3)+' * '+GV(aStAkc);
          mR21_Gr4 := 'Раздел 2.1 (' + GetNStr(j,8) + '): Гр. 4 = гр. 3 * Ставку акциза';
        }

        LogIter(aR21_Gr4, mR21_Gr4, vR21_Gr4, if(i=0, -1, 1), 8);
      }
      else SetNulVal_Get(aR21_Gr4, dR21_Gr3);
    } // #endregion РАЗДЕЛ 2.1

    // #region РАЗДЕЛ 2.2
    buf_dR22_Gr3 := 0;
    buf_vR22_Gr3 := '';

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВыч/АкцизВычКод');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/АкцизВыч/АкцизВычКод' + getIter(j);

      aR22_Gr1 := XMLAdrJ + '/КодПок'  ;
      aR22_Gr2 := XMLAdrJ + '/ОбъемПТ' ;
      aR22_Gr3 := XMLAdrJ + '/СумВычет';   dR22_Gr3 := GetDblVal(aR22_Gr3);

      if     not GetStrNull(aR22_Gr1)
         and not GetStrNull(aR22_Gr2)
         and not GetStrNull(aR22_Gr3)
      {
        buf_dR22_Gr3 += dR22_Gr3;   buf_vR22_Gr3 += GV(aR22_Gr3) + ' + ';
      }
    } // #endregion РАЗДЕЛ 2.2

    // #region РАЗДЕЛ 2.3
    dR23_Gr2 := buf_dR21_Gr4 - buf_dR22_Gr3;

    aR23_Gr2_40001 := XMLAdrI + '/АкцизПУ/СумАкциз';
    aR23_Gr2_40002 := XMLAdrI + '/АкцизУм/СумАкциз';

    GetCutStr(buf_vR21_Gr4);
    GetCutStr(buf_vR22_Gr3);

    if (dR23_Gr2 > 0)
    {
      SV(aR23_Gr2_40001, dR23_Gr2);
      SV(aR23_Gr2_40002, 0       );

      vR23_Gr3 := GV(aR23_Gr2_40001)+' = ('+buf_vR21_Gr4+') - ('+buf_vR22_Gr3+')';
      mR23_Gr3 := 'Раздел 2.3, код 40001: Гр. 2 = сумма(Разд.2.1, гр.4) - сумма(Разд.2.2, гр.3)';

      Log(aR23_Gr2_40001, mR23_Gr3, vR23_Gr3);
    } else {
      SV(aR23_Gr2_40002, ABS(dR23_Gr2));
      SV(aR23_Gr2_40001, 0            );

      vR23_Gr3 := GV(aR23_Gr2_40002)+' = модуль(('+buf_vR21_Gr4+') - ('+buf_vR22_Gr3+'))';
      mR23_Gr3 := 'Раздел 2.3, код 40002: Гр. 2 = модуль(сумма(Разд.2.1, гр.4) - сумма(Разд.2.2, гр.3))';

      Log(aR23_Gr2_40002, mR23_Gr3, vR23_Gr3);
    } // #endregion РАЗДЕЛ 2.3

    // #region РАЗДЕЛ 2.4
    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВозм/АкцизВозмКод');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/АкцизВозм/АкцизВозмКод' + getIter(j);

      aR24_Gr1 := XMLAdrJ + '/КодПок'    ;
      aR24_Gr2 := XMLAdrJ + '/НалБаза'   ;   dR24_Gr2 := GetDblVal(aR24_Gr2);
      aR24_Gr3 := XMLAdrJ + '/СумАкциз'  ;
      aR24_Gr4 := XMLAdrJ + '/НалПерЭксп';
      aR24_Gr5 := XMLAdrJ + '/ГодЭксп'   ;

      if (    GetStrNull(aR24_Gr1)
           or GetStrNull(aR24_Gr2)
           or GetStrNull(aR24_Gr4)
           or GetStrNull(aR24_Gr5) )
      then { SetNulVal_Get(aR24_Gr3, dR24_Gr3); continue; }

      dR24_Gr3 := dR24_Gr2 * valStAkc;   SV(aR24_Gr3, dR24_Gr3);

      if (flProc)
      {
        vR24_Gr3 := GV(aR24_Gr3)+' = '+GV(aR24_Gr2)+' * '+GV(aStAkc)+' / 100';
        mR24_Gr3 := 'Раздел 2.4 (' + GetNStr(j,4) + '): Гр. 3 = гр. 2 * Ставку акциза / 100';
      } else {
        vR24_Gr3 := GV(aR24_Gr3)+' = '+GV(aR24_Gr2)+' * '+GV(aStAkc);
        mR24_Gr3 := 'Раздел 2.4 (' + GetNStr(j,4) + '): Гр. 3 = гр. 2 * Ставку акциза';
      }

      LogIter(aR24_Gr3, mR24_Gr3, vR24_Gr3, if(i=0, -1, 1), 4);
    }

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВозм/ПревУплВозм');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/АкцизВозм/ПревУплВозм' + getIter(j);

      aR24_Gr3 := XMLAdrJ + '/СумПок';
      aR24_Gr4 := XMLAdrJ + '/НалПер';   sR24_Gr4 := GetStrVal(aR24_Gr4);
      aR24_Gr5 := XMLAdrJ + '/Год'   ;   sR24_Gr5 := GetStrVal(aR24_Gr5);

      buf_dR24_010_20003 := buf_dR24_010_50001 := 0;
      buf_vR24_010_20003 := buf_vR24_010_50001 := '';

      if (    GetStrNull(aR24_Gr4)
           or GetStrNull(aR24_Gr5) )
      then { SetNulVal_Get(aR24_Gr3, dR24_Gr3); continue; }

      fl := false;

      CountK := XMLMap.GetNodeCountByName(XMLAdrI + '/АкцизВозм/АкцизВозмКод');
      for (k := 0; k < CountK; k++)
      {
        XMLAdrK := XMLAdrI + '/АкцизВозм/АкцизВозмКод' + getIter(k);

        aR24_Gr1 := XMLAdrK + '/КодПок'    ;
        aR24_Gr2 := XMLAdrK + '/НалБаза'   ;
        aR24_Gr3 := XMLAdrK + '/СумАкциз'  ;   dR24_Gr3 := GetDblVal(aR24_Gr3);
        aR24_Gr4 := XMLAdrK + '/НалПерЭксп';
        aR24_Gr5 := XMLAdrK + '/ГодЭксп'   ;

        if    GetStrNull(aR24_Gr1)
           or GetStrNull(aR24_Gr2)
           or GetStrNull(aR24_Gr3)
           or GetStrNull(aR24_Gr4)
           or GetStrNull(aR24_Gr5)
        then continue;

        if     (GetStrVal(aR24_Gr4) = sR24_Gr4)
           and (GetStrVal(aR24_Gr5) = sR24_Gr5)
        {
          case GetStrVal(aR24_Gr1) of
            '20003' : { buf_dR24_010_20003 += dR24_Gr3; buf_vR24_010_20003 += GV(aR24_Gr3) + ' + '; fl := true; }
            '50001' : { buf_dR24_010_50001 += dR24_Gr3; buf_vR24_010_50001 += GV(aR24_Gr3) + ' + '; fl := true; }
          end;
        }
      }

      GetCutStr(buf_vR24_010_20003);
      GetCutStr(buf_vR24_010_50001);

      aR24_Gr3 := XMLAdrJ + '/СумПок';

      if (not fl) { SetNulVal_Get(aR24_Gr3, dR24_Gr3); continue; }

      dR24_Gr3 := buf_dR24_010_20003 - buf_dR24_010_50001;   SV(aR24_Gr3, dR24_Gr3);
      vR24_Gr3 := GV(aR24_Gr3)+' = ('+buf_vR24_010_20003+') - ('+buf_vR24_010_50001+')';
      mR24_Gr3 := 'Раздел 2.4, стр. 010, гр. 3 (' + GetNStr(j,4) + ') = сумма(Разд.2.4, гр.3, гр.1=20003) - сумма(Разд.2.4, гр.3, гр.1=50001)';
      LogIter(aR24_Gr3, mR24_Gr3, vR24_Gr3, if(i=0, -1, 1), 4);
    }
    // #endregion РАЗДЕЛ 2.4

    // #region РАЗДЕЛ 2.5
    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/РеалПТБГ/РеалПТБГКод');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/РеалПТБГ/РеалПТБГКод' + getIter(j);

      aR25_Gr1 := XMLAdrJ + '/КодПок'  ;
      aR25_Gr2 := XMLAdrJ + '/НалБаза' ;   dR25_Gr2 := GetDblVal(aR25_Gr2);
      aR25_Gr3 := XMLAdrJ + '/СумАкциз';
      aR25_Gr4 := XMLAdrJ + '/НаличБГ' ;

      if     not GetStrNull(aR25_Gr1)
         and not GetStrNull(aR25_Gr2)
         and not GetStrNull(aR25_Gr4)
      {
        dR25_Gr3 := dR25_Gr2 * valStAkc;   SV(aR25_Gr3, dR25_Gr3);

        if (flProc)
        {
          vR25_Gr3 := GV(aR25_Gr3)+' = '+GV(aR25_Gr2)+' * '+GV(aStAkc)+' / 100';
          mR25_Gr3 := 'Раздел 2.5 (' + GetNStr(j,4) + '): Гр. 3 = гр. 2 * Ставку акциза / 100';
        } else {
          vR25_Gr3 := GV(aR25_Gr3)+' = '+GV(aR25_Gr2)+' * '+GV(aStAkc);
          mR25_Gr3 := 'Раздел 2.5 (' + GetNStr(j,4) + '): Гр. 3 = гр. 2 * Ставку акциза';
        }

        LogIter(aR25_Gr3, mR25_Gr3, vR25_Gr3, if(i=0, -1, 1), 4);
      }
      else SetNulVal_Get(aR25_Gr3, dR25_Gr3)
    } // #endregion РАЗДЕЛ 2.5

    // #region РАЗДЕЛ 2.6
    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/РеалПТЕЭС/РеалПТЕЭСКод');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/РеалПТЕЭС/РеалПТЕЭСКод' + getIter(j);

      aR26_Gr1 := XMLAdrJ + '/КодПок'    ;
      aR26_Gr2 := XMLAdrJ + '/НалБаза'   ;   dR26_Gr2 := GetDblVal(aR26_Gr2);
      aR26_Gr3 := XMLAdrJ + '/СумАкциз'  ;
      aR26_Gr4 := XMLAdrJ + '/НалПерРеал';
      aR26_Gr5 := XMLAdrJ + '/ГодРеал'   ;

      if     not GetStrNull(aR26_Gr1)
         and not GetStrNull(aR26_Gr2)
         and not GetStrNull(aR26_Gr4)
         and not GetStrNull(aR26_Gr5)
      {
        dR26_Gr3 := dR26_Gr2 * valStAkc;   SV(aR26_Gr3, dR26_Gr3);

        if (flProc)
        {
          vR26_Gr3 := GV(aR26_Gr3)+' = '+GV(aR26_Gr2)+' * '+GV(aStAkc)+' / 100';
          mR26_Gr3 := 'Раздел 2.6 (' + GetNStr(j,4) + '): Гр. 3 = гр. 2 * Ставку акциза / 100';
        } else {
          vR26_Gr3 := GV(aR26_Gr3)+' = '+GV(aR26_Gr2)+' * '+GV(aStAkc);
          mR26_Gr3 := 'Раздел 2.6 (' + GetNStr(j,4) + '): Гр. 3 = гр. 2 * Ставку акциза';
        }

        LogIter(aR26_Gr3, mR26_Gr3, vR26_Gr3, if(i=0, -1, 1), 4);
      }
      else SetNulVal_Get(aR26_Gr3, dR26_Gr3)
    } // #endregion РАЗДЕЛ 2.6
  } // #endregion РАЗДЕЛ 2

  // #region ПРИЛОЖЕНИЕ 1
  var aP1_Gr2, aP1_Gr3, aP1_Gr4 : string;
  var dP1_Gr2, dP1_Gr3, dP1_Gr4 : double;

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчНБВидПТ');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчНБВидПТ' + getIter(i);

    if GetStrNull(XMLAdrI + '/КодПТ') continue;

    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/РасчНБКод');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/РасчНБКод' + getIter(j);

      if    GetStrNull(XMLAdrJ + '/КодПок'  )
         or GetStrNull(XMLAdrJ + '/СодСпирт')
         or GetStrNull(XMLAdrJ + '/ОбъемПТ' ) continue;

      // #region XML адреса
      aP1_Gr2 := XMLAdrJ + '/СодСпирт';   dP1_Gr2 := GetDblVal(aP1_Gr2);
      aP1_Gr3 := XMLAdrJ + '/ОбъемПТ' ;   dP1_Gr3 := GetDblVal(aP1_Gr3);
      aP1_Gr4 := XMLAdrJ + '/НалБаза' ;
      // #endregion XML адреса

      dP1_Gr4 := dP1_Gr2 * dP1_Gr3 / 100;   SV(aP1_Gr4, dP1_Gr4);
      LogIter(aP1_Gr4, 'Стр. ' + GetNStr(j,20) + ': гр. 4 = гр. 2 * гр. 3 / 100', GV(aP1_Gr4)+' = '+GV(aP1_Gr2)+' * '+GV(aP1_Gr3)+' / 100', if(i=0, -1, 1), 20);
    }
  } // #endregion ПРИЛОЖЕНИЕ 1

  // #region ПРИЛОЖЕНИЕ 2.1
  var vP2_1_030
    , vP2_1_040_Gr3, vP2_1_040_Gr4, vP2_1_050_Gr4, vP2_1_060_Gr3, vP2_1_060_Gr4, vP2_1_070_Gr4, vP2_1_080_Gr4, vP2_1_090_Gr4, vP2_1_100_Gr4
    , aP2_1_020, aP2_1_030
    , aP2_1_040_Gr3, aP2_1_040_Gr4, aP2_1_050_Gr4, aP2_1_060_Gr3, aP2_1_060_Gr4, aP2_1_070_Gr4, aP2_1_080_Gr4, aP2_1_090_Gr4, aP2_1_100_Gr4
    , aP2_2_150
    , aP2_2_160_Gr3, aP2_2_160_Gr4, aP2_2_170_Gr3, aP2_2_170_Gr4, aP2_2_170_Gr5, aP2_2_170_Gr6, aP2_2_180_Gr3, aP2_2_180_Gr4, aP2_2_180_Gr5
    , aP2_2_180_Gr6, aP2_2_190_Gr3, aP2_2_190_Gr4, aP2_2_200_Gr3, aP2_2_200_Gr4, aP2_2_200_Gr5, aP2_2_200_Gr6, aP2_2_210_Gr3, aP2_2_210_Gr4
    , aP2_2_210_Gr5, aP2_2_210_Gr6, aP2_2_220_Gr4 : string;
  var dP2_1_020, dP2_1_030
    , dP2_1_040_Gr3, dP2_1_040_Gr4, dP2_1_050_Gr4, dP2_1_060_Gr3, dP2_1_060_Gr4, dP2_1_070_Gr4, dP2_1_080_Gr4, dP2_1_090_Gr4, dP2_1_100_Gr4
    , dP2_2_150
    , dP2_2_160_Gr3, dP2_2_160_Gr4, dP2_2_170_Gr3, dP2_2_170_Gr4, dP2_2_180_Gr3, dP2_2_180_Gr4, dP2_2_190_Gr3
    , dP2_2_190_Gr4, dP2_2_200_Gr3, dP2_2_200_Gr4, dP2_2_210_Gr3, dP2_2_210_Gr4, dP2_2_220_Gr4 : double;

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАкОсвБГЭксп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАкОсвБГЭксп' + getIter(i);

    if GetStrNull(XMLAdrI + '/КодПТ') continue;

    aStAkc := XMLAdrI + '/СтАкц';
    valStAkc := GetDblVal(aStAkc);

    flProc := (GetDblVal(XMLAdrI + '/ЕдИзм') = KodOKEI_EdIzm_744);
    if (flProc) valStAkc := valStAkc / 100;

    // #region XML адреса
    aP2_1_020     := XMLAdrI + '/ОбщКолБГПер'              ;
    aP2_1_030     := XMLAdrI + '/ОбщСумБГПер'              ;
    aP2_1_040_Gr3 := XMLAdrI + '/АкОсвЭкспПер/ОбъемПТ'     ;
    aP2_1_040_Gr4 := XMLAdrI + '/АкОсвЭкспПер/СумАкциз'    ;
    aP2_1_050_Gr4 := XMLAdrI + '/АкОсвБГЭкНеПдтвПер'       ;
    aP2_1_060_Gr3 := XMLAdrI + '/АкОсвЭкспПдтвПер/ОбъемПТ' ;
    aP2_1_060_Gr4 := XMLAdrI + '/АкОсвЭкспПдтвПер/СумАкциз';
    aP2_1_070_Gr4 := XMLAdrI + '/АкОсвБГЭкПдтвПред'        ;
    aP2_1_080_Gr4 := XMLAdrI + '/АкОсвБГЭкПдтвКон'         ;
    aP2_1_090_Gr4 := XMLAdrI + '/АкОсвБГЭкНеПдтвКон'       ;
    aP2_1_100_Gr4 := XMLAdrI + '/ПрАкОсвБГПдтвКон'         ;
    // #endregion XML адреса

    vP2_1_030 := vP2_1_040_Gr3 := vP2_1_040_Gr4 := vP2_1_050_Gr4 := vP2_1_060_Gr3 := vP2_1_060_Gr4 := vP2_1_070_Gr4 := vP2_1_080_Gr4 := vP2_1_090_Gr4 := vP2_1_100_Gr4 := '';
    dP2_1_020 := dP2_1_030 := dP2_1_040_Gr3 := dP2_1_040_Gr4 := dP2_1_050_Gr4 := dP2_1_060_Gr3 := dP2_1_060_Gr4 := dP2_1_070_Gr4 := dP2_1_080_Gr4 := dP2_1_090_Gr4 := dP2_1_100_Gr4 := 0;

    // #region ПРИЛОЖЕНИЕ 2.2
    CountJ := XMLMap.GetNodeCountByName(XMLAdrI + '/БГОсвРеалЭксп');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := XMLAdrI + '/БГОсвРеалЭксп' + getIter(j);

      if    GetStrNull(XMLAdrJ + '/ДатаВыдБГ'                )
         or GetStrNull(XMLAdrJ + '/НомерБГ'                  )
         or GetStrNull(XMLAdrJ + '/ДатаНачБГ'                )
         or GetStrNull(XMLAdrJ + '/ДатаКонБГ'                )
         or GetStrNull(XMLAdrJ + '/СуммаБГ'                  )
         or GetStrNull(XMLAdrJ + '/АкОсвЭкспПер/ОбРеалЭкспПТ') continue;

      // #region XML адреса
      aP2_2_150     := XMLAdrJ + '/СуммаБГ'                     ;   dP2_2_150     := GetDblVal(aP2_2_150    );
      aP2_2_160_Gr3 := XMLAdrJ + '/АкОсвЭкспПер/ОбРеалЭкспПТ'   ;   dP2_2_160_Gr3 := GetDblVal(aP2_2_160_Gr3);
      aP2_2_160_Gr4 := XMLAdrJ + '/АкОсвЭкспПер/СумАкциз'       ;
      aP2_2_170_Gr3 := XMLAdrJ + '/АкЭкспНеПдтвНач/ОбРеалЭкспПТ';   dP2_2_170_Gr3 := GetDblVal(aP2_2_170_Gr3);
      aP2_2_170_Gr4 := XMLAdrJ + '/АкЭкспНеПдтвНач/СумАкциз'    ;
      aP2_2_170_Gr5 := XMLAdrJ + '/АкЭкспНеПдтвНач/НалПерЭксп'  ;
      aP2_2_170_Gr6 := XMLAdrJ + '/АкЭкспНеПдтвНач/ГодЭксп'     ;
      aP2_2_180_Gr3 := XMLAdrJ + '/АкЭкспПдтвПер/ОбРеалЭкспПТ'  ;   dP2_2_180_Gr3 := GetDblVal(aP2_2_180_Gr3);
      aP2_2_180_Gr4 := XMLAdrJ + '/АкЭкспПдтвПер/СумАкциз'      ;
      aP2_2_180_Gr5 := XMLAdrJ + '/АкЭкспПдтвПер/НалПерЭксп'    ;
      aP2_2_180_Gr6 := XMLAdrJ + '/АкЭкспПдтвПер/ГодЭксп'       ;
      aP2_2_190_Gr3 := XMLAdrJ + '/АкЭкспПдтвПред/ОбРеалЭкспПТ' ;   dP2_2_190_Gr3 := GetDblVal(aP2_2_190_Gr3);
      aP2_2_190_Gr4 := XMLAdrJ + '/АкЭкспПдтвПред/СумАкциз'     ;
      aP2_2_200_Gr3 := XMLAdrJ + '/АкЭкспПдтвКон/ОбРеалЭкспПТ'  ;   dP2_2_200_Gr3 := GetDblVal(aP2_2_200_Gr3);
      aP2_2_200_Gr4 := XMLAdrJ + '/АкЭкспПдтвКон/СумАкциз'      ;
      aP2_2_200_Gr5 := XMLAdrJ + '/АкЭкспПдтвКон/НалПерЭксп'    ;
      aP2_2_200_Gr6 := XMLAdrJ + '/АкЭкспПдтвКон/ГодЭксп'       ;
      aP2_2_210_Gr3 := XMLAdrJ + '/АкЭкспНеПдтвКон/ОбРеалЭкспПТ';
      aP2_2_210_Gr4 := XMLAdrJ + '/АкЭкспНеПдтвКон/СумАкциз'    ;
      aP2_2_210_Gr5 := XMLAdrJ + '/АкЭкспНеПдтвКон/НалПерЭксп'  ;
      aP2_2_210_Gr6 := XMLAdrJ + '/АкЭкспНеПдтвКон/ГодЭксп'     ;
      aP2_2_220_Gr4 := XMLAdrJ + '/ПрАкЭкспПдтвКон'             ;
      // #endregion XML адреса

      // #region стр. 160, гр. 4
      if not GetStrNull(aP2_2_160_Gr3)
      {
        dP2_2_160_Gr4 := dP2_2_160_Gr3 * valStAkc;   SV(aP2_2_160_Gr4, dP2_2_160_Gr4);
        LogProc(aP2_2_160_Gr4, 'Стр. 160: Гр. 4 = гр. 3 * Ставку акциза', GV(aP2_2_160_Gr4)+' = '+GV(aP2_2_160_Gr3)+' * '+GV(aStAkc), flProc);
      }
      else SetNulVal_Get(aP2_2_160_Gr4, dP2_2_160_Gr4);
      // #endregion стр. 160, гр. 4

      // #region стр. 170, гр. 4
      if     not GetStrNull(aP2_2_170_Gr3)
         and not GetStrNull(aP2_2_170_Gr5)
         and not GetStrNull(aP2_2_170_Gr6)
      {
        dP2_2_170_Gr4 := dP2_2_170_Gr3 * valStAkc;   SV(aP2_2_170_Gr4, dP2_2_170_Gr4);
        LogProc(aP2_2_170_Gr4, 'Стр. 170: Гр. 4 = гр. 3 * Ставку акциза', GV(aP2_2_170_Gr4)+' = '+GV(aP2_2_170_Gr3)+' * '+GV(aStAkc), flProc);
      }
      else SetNulVal_Get(aP2_2_170_Gr4, dP2_2_170_Gr4);
      // #endregion стр. 170, гр. 4

      // #region стр. 180, гр. 4
      if     not GetStrNull(aP2_2_180_Gr3)
         and not GetStrNull(aP2_2_180_Gr5)
         and not GetStrNull(aP2_2_180_Gr6)
      {
        dP2_2_180_Gr4 := dP2_2_180_Gr3 * valStAkc;   SV(aP2_2_180_Gr4, dP2_2_180_Gr4);
        LogProc(aP2_2_180_Gr4, 'Стр. 180: Гр. 4 = гр. 3 * Ставку акциза', GV(aP2_2_180_Gr4)+' = '+GV(aP2_2_180_Gr3)+' * '+GV(aStAkc), flProc);
      }
      else SetNulVal_Get(aP2_2_180_Gr4, dP2_2_180_Gr4);
      // #endregion стр. 180, гр. 4

      // #region стр. 190, гр. 4
      if not GetStrNull(aP2_2_190_Gr3)
      {
        dP2_2_190_Gr4 := dP2_2_190_Gr3 * valStAkc;   SV(aP2_2_190_Gr4, dP2_2_190_Gr4);
        LogProc(aP2_2_190_Gr4, 'Стр. 190: Гр. 4 = гр. 3 * Ставку акциза', GV(aP2_2_190_Gr4)+' = '+GV(aP2_2_190_Gr3)+' * '+GV(aStAkc), flProc);
      }
      else SetNulVal_Get(aP2_2_190_Gr4, dP2_2_190_Gr4);
      // #endregion стр. 190, гр. 4

      // #region стр. 200
      if     not GetStrNull(aP2_2_200_Gr5)
         and not GetStrNull(aP2_2_200_Gr6)
      {
        // #region стр. 200, гр. 3
        if    not GetStrNull(aP2_2_180_Gr3)
           or not GetStrNull(aP2_2_190_Gr3)
        {
          dP2_2_200_Gr3 := dP2_2_180_Gr3 + dP2_2_190_Gr3;   SV(aP2_2_200_Gr3, dP2_2_200_Gr3);
          LogProc(aP2_2_200_Gr3, 'Стр. 200: Гр. 3 = стр. 180, гр. 3 + стр. 190, гр. 3', GV(aP2_2_200_Gr3)+' = '+GV(aP2_2_180_Gr3)+' + '+GV(aP2_2_190_Gr3), flProc);
        }
        else SetNulVal_Get(aP2_2_200_Gr3, dP2_2_200_Gr3);
        // #endregion стр. 200, гр. 3

        // #region стр. 200, гр. 4
        if    not GetStrNull(aP2_2_180_Gr4)
           or not GetStrNull(aP2_2_190_Gr4)
        {
          dP2_2_200_Gr4 := dP2_2_180_Gr4 + dP2_2_190_Gr4;   SV(aP2_2_200_Gr4, dP2_2_200_Gr4);
          LogProc(aP2_2_200_Gr4, 'Стр. 200: Гр. 4 = стр. 180, гр. 4 + стр. 190, гр. 4', GV(aP2_2_200_Gr4)+' = '+GV(aP2_2_180_Gr4)+' + '+GV(aP2_2_190_Gr4), flProc);
        }
        else SetNulVal_Get(aP2_2_200_Gr4, dP2_2_200_Gr4);
        // #endregion стр. 200, гр. 4
      } else {
         SetNulVal_Get(aP2_2_200_Gr3, dP2_2_200_Gr3);
         SetNulVal_Get(aP2_2_200_Gr4, dP2_2_200_Gr4);
      } // #endregion стр. 200

      // #region стр. 210
      if     not GetStrNull(aP2_2_210_Gr5)
         and not GetStrNull(aP2_2_210_Gr6)
      {
        // #region стр. 210, гр. 3
        if     not GetStrNull(aP2_2_180_Gr3)
           and not GetStrNull(aP2_2_180_Gr4)
           and not GetStrNull(aP2_2_180_Gr5)
           and not GetStrNull(aP2_2_180_Gr6)
        {
          if     not GetStrNull(aP2_2_170_Gr3)
             and not GetStrNull(aP2_2_170_Gr4)
             and not GetStrNull(aP2_2_170_Gr5)
             and not GetStrNull(aP2_2_170_Gr6)
          {
            dP2_2_210_Gr3 := dP2_2_170_Gr3 - dP2_2_180_Gr3;   SV(aP2_2_210_Gr3, dP2_2_210_Gr3);
            LogProc(aP2_2_210_Gr3, 'Стр. 210: Гр. 3 = стр. 170 - стр. 180', GV(aP2_2_210_Gr3)+' = '+GV(aP2_2_170_Gr3)+' - '+GV(aP2_2_180_Gr3), flProc);
          }
          else  if not GetStrNull(aP2_2_160_Gr3)
                {
                  dP2_2_210_Gr3 := dP2_2_160_Gr3 - dP2_2_180_Gr3;   SV(aP2_2_210_Gr3, dP2_2_210_Gr3);
                  LogProc(aP2_2_210_Gr3, 'Стр. 210: Гр. 3 = стр. 160 - стр. 180', GV(aP2_2_210_Gr3)+' = '+GV(aP2_2_160_Gr3)+' - '+GV(aP2_2_180_Gr3), flProc);
                }
                else SetNulVal_Get(aP2_2_210_Gr3, dP2_2_210_Gr3);
        }
        else  if not GetStrNull(aP2_2_160_Gr3)
              {
                dP2_2_210_Gr3 := dP2_2_160_Gr3;   SV(aP2_2_210_Gr3, dP2_2_210_Gr3);
                LogProc(aP2_2_210_Gr3, 'Стр. 210: Гр. 3 = стр. 160', GV(aP2_2_210_Gr3)+' = '+GV(aP2_2_160_Gr3), flProc);
              }
              else SetNulVal_Get(aP2_2_210_Gr3, dP2_2_210_Gr3);
        // #endregion стр. 210, гр. 3

        // #region стр. 210, гр. 4
        if not GetStrNull(aP2_2_210_Gr3)
        {
          dP2_2_210_Gr4 := dP2_2_210_Gr3 * valStAkc;   SV(aP2_2_210_Gr4, dP2_2_210_Gr4);
          LogProc(aP2_2_210_Gr4, 'Стр. 210: Гр. 4 = гр. 3 * Ставку акциза', GV(aP2_2_210_Gr4)+' = '+GV(aP2_2_210_Gr3)+' * '+GV(aStAkc), flProc);
        }
        else SetNulVal_Get(aP2_2_210_Gr4, dP2_2_210_Gr4);
        // #endregion стр. 210, гр. 4
      } else {
         SetNulVal_Get(aP2_2_210_Gr3, dP2_2_210_Gr3);
         SetNulVal_Get(aP2_2_210_Gr4, dP2_2_210_Gr4);
      } // #endregion стр. 210

      // #region стр. 220, гр. 4
      if    not GetStrNull(aP2_2_160_Gr4)
         or not GetStrNull(aP2_2_200_Gr4)
      {
        dP2_2_220_Gr4 := dP2_2_160_Gr4 - dP2_2_200_Gr4;   SV(aP2_2_220_Gr4, dP2_2_220_Gr4);
        LogProc(aP2_2_220_Gr4, 'Стр. 220: Гр. 4 = стр. 160, гр. 4 - стр. 200, гр. 4', GV(aP2_2_220_Gr4)+' = '+GV(aP2_2_160_Gr4)+' - '+GV(aP2_2_200_Gr4), flProc);
      }
      else SetNulVal_Get(aP2_2_220_Gr4, dP2_2_220_Gr4);
      // #endregion стр. 220, гр. 4

                                                                                                                                      dP2_1_020     += 1            ;
                                                                               vP2_1_030     += GV(aP2_2_150    ) + ' + ';   dP2_1_030     += dP2_2_150    ;
      if     not GetStrNull(aP2_2_160_Gr3) and not GetStrNull(aP2_2_160_Gr4) { vP2_1_040_Gr3 += GV(aP2_2_160_Gr3) + ' + ';   dP2_1_040_Gr3 += dP2_2_160_Gr3;
                                                                               vP2_1_040_Gr4 += GV(aP2_2_160_Gr4) + ' + ';   dP2_1_040_Gr4 += dP2_2_160_Gr4; }
      if     not GetStrNull(aP2_2_170_Gr3) and not GetStrNull(aP2_2_170_Gr4)
         and not GetStrNull(aP2_2_170_Gr5) and not GetStrNull(aP2_2_170_Gr6) { vP2_1_050_Gr4 += GV(aP2_2_170_Gr4) + ' + ';   dP2_1_050_Gr4 += dP2_2_170_Gr4; }
      if     not GetStrNull(aP2_2_180_Gr3) and not GetStrNull(aP2_2_180_Gr4)
         and not GetStrNull(aP2_2_180_Gr5) and not GetStrNull(aP2_2_180_Gr6) { vP2_1_060_Gr3 += GV(aP2_2_180_Gr3) + ' + ';   dP2_1_060_Gr3 += dP2_2_180_Gr3;
                                                                               vP2_1_060_Gr4 += GV(aP2_2_180_Gr4) + ' + ';   dP2_1_060_Gr4 += dP2_2_180_Gr4; }
      if     not GetStrNull(aP2_2_190_Gr3) and not GetStrNull(aP2_2_190_Gr4) { vP2_1_070_Gr4 += GV(aP2_2_190_Gr4) + ' + ';   dP2_1_070_Gr4 += dP2_2_190_Gr4; }
      if     not GetStrNull(aP2_2_200_Gr3) and not GetStrNull(aP2_2_200_Gr4)
         and not GetStrNull(aP2_2_200_Gr5) and not GetStrNull(aP2_2_200_Gr6) { vP2_1_080_Gr4 += GV(aP2_2_200_Gr4) + ' + ';   dP2_1_080_Gr4 += dP2_2_200_Gr4; }
      if     not GetStrNull(aP2_2_210_Gr3) and not GetStrNull(aP2_2_210_Gr4)
         and not GetStrNull(aP2_2_210_Gr5) and not GetStrNull(aP2_2_210_Gr6) { vP2_1_090_Gr4 += GV(aP2_2_210_Gr4) + ' + ';   dP2_1_090_Gr4 += dP2_2_210_Gr4; }
      if     not GetStrNull(aP2_2_220_Gr4)                                   { vP2_1_100_Gr4 += GV(aP2_2_220_Gr4) + ' + ';   dP2_1_100_Gr4 += dP2_2_220_Gr4; }
    } // #endregion ПРИЛОЖЕНИЕ 2.2

    SV(aP2_1_020, dP2_1_020);
    Log(aP2_1_020, 'Стр. 020 = колич(Прил.2, разд.2)', GV(aP2_1_020)+' = '+GV(aP2_1_020));

    GetCutStr(vP2_1_030    );
    GetCutStr(vP2_1_040_Gr3);
    GetCutStr(vP2_1_040_Gr4);
    GetCutStr(vP2_1_050_Gr4);
    GetCutStr(vP2_1_060_Gr3);
    GetCutStr(vP2_1_060_Gr4);
    GetCutStr(vP2_1_070_Gr4);
    GetCutStr(vP2_1_080_Gr4);
    GetCutStr(vP2_1_090_Gr4);
    GetCutStr(vP2_1_100_Gr4);

    if (vP2_1_030     <> '0') { SV(aP2_1_030    , dP2_1_030    ); Log(aP2_1_030    , 'Стр. 030 = сумма(стр. 150, Прил.2, разд.2)'              , GV(aP2_1_030    )+' = '+vP2_1_030    ); } else SetNulVal_Get(aP2_1_030    , dP2_1_030    );
    if (vP2_1_040_Gr3 <> '0') { SV(aP2_1_040_Gr3, dP2_1_040_Gr3); Log(aP2_1_040_Gr3, 'Стр. 040, гр. 3 = сумма(стр. 160, гр. 3, Прил.2, разд.2)', GV(aP2_1_040_Gr3)+' = '+vP2_1_040_Gr3); } else SetNulVal_Get(aP2_1_040_Gr3, dP2_1_040_Gr3);
    if (vP2_1_040_Gr4 <> '0') { SV(aP2_1_040_Gr4, dP2_1_040_Gr4); Log(aP2_1_040_Gr4, 'Стр. 040, гр. 4 = сумма(стр. 160, гр. 4, Прил.2, разд.2)', GV(aP2_1_040_Gr4)+' = '+vP2_1_040_Gr4); } else SetNulVal_Get(aP2_1_040_Gr4, dP2_1_040_Gr4);
    if (vP2_1_050_Gr4 <> '0') { SV(aP2_1_050_Gr4, dP2_1_050_Gr4); Log(aP2_1_050_Gr4, 'Стр. 050, гр. 4 = сумма(стр. 170, гр. 4, Прил.2, разд.2)', GV(aP2_1_050_Gr4)+' = '+vP2_1_050_Gr4); } else SetNulVal_Get(aP2_1_050_Gr4, dP2_1_050_Gr4);
    if (vP2_1_060_Gr3 <> '0') { SV(aP2_1_060_Gr3, dP2_1_060_Gr3); Log(aP2_1_060_Gr3, 'Стр. 060, гр. 3 = сумма(стр. 180, гр. 3, Прил.2, разд.2)', GV(aP2_1_060_Gr3)+' = '+vP2_1_060_Gr3); } else SetNulVal_Get(aP2_1_060_Gr3, dP2_1_060_Gr3);
    if (vP2_1_060_Gr4 <> '0') { SV(aP2_1_060_Gr4, dP2_1_060_Gr4); Log(aP2_1_060_Gr4, 'Стр. 060, гр. 4 = сумма(стр. 180, гр. 4, Прил.2, разд.2)', GV(aP2_1_060_Gr4)+' = '+vP2_1_060_Gr4); } else SetNulVal_Get(aP2_1_060_Gr4, dP2_1_060_Gr4);
    if (vP2_1_070_Gr4 <> '0') { SV(aP2_1_070_Gr4, dP2_1_070_Gr4); Log(aP2_1_070_Gr4, 'Стр. 070, гр. 4 = сумма(стр. 190, гр. 4, Прил.2, разд.2)', GV(aP2_1_070_Gr4)+' = '+vP2_1_070_Gr4); } else SetNulVal_Get(aP2_1_070_Gr4, dP2_1_070_Gr4);
    if (vP2_1_080_Gr4 <> '0') { SV(aP2_1_080_Gr4, dP2_1_080_Gr4); Log(aP2_1_080_Gr4, 'Стр. 080, гр. 4 = сумма(стр. 200, гр. 4, Прил.2, разд.2)', GV(aP2_1_080_Gr4)+' = '+vP2_1_080_Gr4); } else SetNulVal_Get(aP2_1_080_Gr4, dP2_1_080_Gr4);
    if (vP2_1_090_Gr4 <> '0') { SV(aP2_1_090_Gr4, dP2_1_090_Gr4); Log(aP2_1_090_Gr4, 'Стр. 090, гр. 4 = сумма(стр. 210, гр. 4, Прил.2, разд.2)', GV(aP2_1_090_Gr4)+' = '+vP2_1_090_Gr4); } else SetNulVal_Get(aP2_1_090_Gr4, dP2_1_090_Gr4);
    if (vP2_1_100_Gr4 <> '0') { SV(aP2_1_100_Gr4, dP2_1_100_Gr4); Log(aP2_1_100_Gr4, 'Стр. 100, гр. 4 = сумма(стр. 220, гр. 4, Прил.2, разд.2)', GV(aP2_1_100_Gr4)+' = '+vP2_1_100_Gr4); } else SetNulVal_Get(aP2_1_100_Gr4, dP2_1_100_Gr4);
  } // #endregion ПРИЛОЖЕНИЕ 2.1

  // #region ПРИЛОЖЕНИЕ 6
  var aP6_050, aP6_060, aP6_070, aP6_080, aP6_090, aP6_100, aP6_110, aP6_120, aP6_130, aP6_140, aP6_150, aP6_160, aP6_170
    , aP6_180, aP6_190_Gr3, aP6_190_Gr4, aP6_190_Gr5, aP6_200, aP6_210, aP6_220, aP6_230, aP6_240, aP6_260, aP6_270       : string;
  var dP6_050, dP6_060, dP6_070, dP6_080, dP6_090, dP6_100, dP6_110, dP6_120, dP6_130, dP6_140, dP6_150, dP6_160, dP6_170
    , dP6_180, dP6_190_Gr5, dP6_200, dP6_210, dP6_220, dP6_230, dP6_240, dP6_260, dP6_270                                 : double;

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвППЗакупСп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/АвППЗакупСп' + getIter(i);

    if    GetStrNull(XMLAdrI + '/РегНомИзв' )
       or GetStrNull(XMLAdrI + '/ДатаРегИзв')
       or GetStrNull(XMLAdrI + '/КодСпирт'  )
       or GetStrNull(XMLAdrI + '/КодПП'     )
       or GetStrNull(XMLAdrI + '/ОбСпиртИзв') continue;

    aStAkc := XMLAdrI + '/СтАкц';
    valStAkc := GetDblVal(aStAkc);

    flProc := (GetDblVal(XMLAdrI + '/ЕдИзм') = KodOKEI_EdIzm_744);
    if (flProc) valStAkc := valStAkc / 100;

    // #region XML адреса
    aP6_050     := XMLAdrI + '/ОбСпиртИзв'               ;   dP6_050     := GetDblVal(aP6_050    );
    aP6_060     := XMLAdrI + '/АвУплИзв'                 ;
    aP6_070     := XMLAdrI + '/ОбЗакНеСписНач'           ;   dP6_070     := GetDblVal(aP6_070    );
    aP6_080     := XMLAdrI + '/АвЗакНеСписНач'           ;
    aP6_090     := XMLAdrI + '/ОбСпЗакИзвПер'            ;   dP6_090     := GetDblVal(aP6_090    );
    aP6_100     := XMLAdrI + '/АвЗакПер'                 ;
    aP6_110     := XMLAdrI + '/ОбИзвСписПер'             ;   dP6_110     := GetDblVal(aP6_110    );
    aP6_120     := XMLAdrI + '/АвСписПер'                ;
    aP6_130     := XMLAdrI + '/ОбПотерЗакПерНорм'        ;   dP6_130     := GetDblVal(aP6_130    );
    aP6_140     := XMLAdrI + '/АвПотерНорм'              ;
    aP6_150     := XMLAdrI + '/ОбЗакНеСписКон'           ;
    aP6_160     := XMLAdrI + '/АвНеСписКон'              ;
    aP6_170     := XMLAdrI + '/ОбППРеалПерИзв'           ;   dP6_170     := GetDblVal(aP6_170    );
    aP6_180     := XMLAdrI + '/АкИсчППРеалПер'           ;
    aP6_190_Gr3 := XMLAdrI + '/ОбЗакППРеалПер/ОбРеалПП'  ;
    aP6_190_Gr4 := XMLAdrI + '/ОбЗакППРеалПер/СодСпиртПП';
    aP6_190_Gr5 := XMLAdrI + '/ОбЗакППРеалПер/ОбСпСодПП' ;   dP6_190_Gr5 := GetDblVal(aP6_190_Gr5);
    aP6_200     := XMLAdrI + '/АвИспППРеалПер'           ;
    aP6_210     := XMLAdrI + '/ОбПотерЗакПерСв'          ;   dP6_210     := GetDblVal(aP6_210    );
    aP6_220     := XMLAdrI + '/АкСвПотерПер'             ;
    aP6_230     := XMLAdrI + '/ОбИспППРеалПер'           ;
    aP6_240     := XMLAdrI + '/АвВычСвПотерПер'          ;
    aP6_260     := XMLAdrI + '/АвИсчППРеалПред'          ;   dP6_260     := GetDblVal(aP6_260    );
    aP6_270     := XMLAdrI + '/АвИсчППРеалКон'           ;
    // #endregion XML адреса

    // #region стр. 060
    dP6_060 := dP6_050 * valStAkc;   SV(aP6_060, dP6_060);
    LogProc(aP6_060, 'Стр. 060 = стр. 050 * Ставку акциза', GV(aP6_060)+' = '+GV(aP6_050)+' * '+GV(aStAkc), flProc);
    // #endregion стр. 060

    // #region стр. 080
    if not GetStrNull(aP6_070)
    {
      dP6_080 := dP6_070 * valStAkc;   SV(aP6_080, dP6_080);
      LogProc(aP6_080, 'Стр. 080 = стр. 070 * Ставку акциза', GV(aP6_080)+' = '+GV(aP6_070)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP6_080, dP6_080);
    // #endregion стр. 080

    // #region стр. 100
    if not GetStrNull(aP6_090)
    {
      dP6_100 := dP6_090 * valStAkc;   SV(aP6_100, dP6_100);

      LogProc(aP6_100, 'Стр. 100 = стр. 090 * Ставку акциза', GV(aP6_100)+' = '+GV(aP6_090)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP6_100, dP6_100);
    // #endregion стр. 100

    // #region стр. 120
    if not GetStrNull(aP6_110)
    {
      dP6_120 := dP6_110 * valStAkc;   SV(aP6_120, dP6_120);
      LogProc(aP6_120, 'Стр. 120 = стр. 110 * Ставку акциза', GV(aP6_120)+' = '+GV(aP6_110)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP6_120, dP6_120);
    // #endregion стр. 120

    // #region стр. 140
    if not GetStrNull(aP6_130)
    {
      dP6_140 := dP6_130 * valStAkc;   SV(aP6_140, dP6_140);
      LogProc(aP6_140, 'Стр. 140 = стр. 130 * Ставку акциза', GV(aP6_140)+' = '+GV(aP6_130)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP6_140, dP6_140);
    // #endregion стр. 140

    // #region стр. 150
    if    not GetStrNull(aP6_070)
       or not GetStrNull(aP6_090)
       or not GetStrNull(aP6_110)
       or not GetStrNull(aP6_130)
    {
      dP6_150 := dP6_070 + dP6_090 - dP6_110 - dP6_130;   SV(aP6_150, dP6_150);
      Log(aP6_150, 'Стр. 150 = стр. 070 + стр. 090 - стр. 110 - стр. 130', GV(aP6_150)+' = '+GV(aP6_070)+' + '+GV(aP6_090)+' - '+GV(aP6_110)+' - '+GV(aP6_130));
    }
    else SetNulVal_Get(aP6_150, dP6_150);
    // #endregion стр. 150

    // #region стр. 160
    if    not GetStrNull(aP6_080)
       or not GetStrNull(aP6_100)
       or not GetStrNull(aP6_120)
       or not GetStrNull(aP6_140)
    {
      dP6_160 := dP6_080 + dP6_100 - dP6_120 - dP6_140;   SV(aP6_160, dP6_160);
      Log(aP6_160, 'Стр. 160 = стр. 080 + стр. 100 - стр. 120 - стр. 140', GV(aP6_160)+' = '+GV(aP6_080)+' + '+GV(aP6_100)+' - '+GV(aP6_120)+' - '+GV(aP6_140));
    }
    else SetNulVal_Get(aP6_160, dP6_160);
    // #endregion стр. 160

    // #region стр. 180
    if not GetStrNull(aP6_170)
    {
      dP6_180 := dP6_170 * valStAkc;   SV(aP6_180, dP6_180);
      LogProc(aP6_180, 'Стр. 180 = стр. 170 * Ставку акциза', GV(aP6_180)+' = '+GV(aP6_170)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP6_180, dP6_180);
    // #endregion стр. 180

    // #region стр. 200
    if     not GetStrNull(aP6_190_Gr3)
       and not GetStrNull(aP6_190_Gr4)
       and not GetStrNull(aP6_190_Gr5)
    {
      dP6_200 := dP6_190_Gr5 * valStAkc;   SV(aP6_200, dP6_200);
      LogProc(aP6_200, 'Стр. 200 = стр. 190, гр. 5 * Ставку акциза', GV(aP6_200)+' = '+GV(aP6_190_Gr5)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP6_200, dP6_200);
    // #endregion стр. 200

    // #region стр. 220
    if not GetStrNull(aP6_210)
    {
      dP6_220 := dP6_210 * valStAkc;   SV(aP6_220, dP6_220);
      LogProc(aP6_220, 'Стр. 220 = стр. 210 * Ставку акциза', GV(aP6_220)+' = '+GV(aP6_210)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP6_220, dP6_220);
    // #endregion стр. 220

    // #region стр. 230
    if     not GetStrNull(aP6_190_Gr3)
       and not GetStrNull(aP6_190_Gr4)
       and not GetStrNull(aP6_190_Gr5)
    {
      if not GetStrNull(aP6_210)
      {
        dP6_230 := dP6_190_Gr5 - dP6_210;   SV(aP6_230, dP6_230);
        LogProc(aP6_230, 'Стр. 230 = стр. 190, гр. 5 - стр. 210', GV(aP6_230)+' = '+GV(aP6_190_Gr5)+' - '+GV(aP6_210), flProc);
      } else {
        dP6_230 := dP6_190_Gr5;   SV(aP6_230, dP6_230);
        LogProc(aP6_230, 'Стр. 230 = стр. 190, гр. 5', GV(aP6_230)+' = '+GV(aP6_190_Gr5), flProc);
      }
    }
    else SetNulVal_Get(aP6_230, dP6_230);
    // #endregion стр. 230

    // #region стр. 240
    if    not GetStrNull(aP6_200)
       or not GetStrNull(aP6_220)
    {
      dP6_240 := dP6_200 - dP6_220;   SV(aP6_240, dP6_240);
      LogProc(aP6_240, 'Стр. 240 = стр. 200 - стр. 220', GV(aP6_240)+' = '+GV(aP6_200)+' - '+GV(aP6_220), flProc);
    }
    else SetNulVal_Get(aP6_240, dP6_240);
    // #endregion стр. 240

    // #region стр. 270
    if    not GetStrNull(aP6_180)
       or not GetStrNull(aP6_260)
    {
      dP6_270 := dP6_180 + dP6_260;   SV(aP6_270, dP6_270);
      LogProc(aP6_270, 'Стр. 270 = стр. 180 + стр. 260', GV(aP6_270)+' = '+GV(aP6_180)+' + '+GV(aP6_260), flProc);
    }
    else SetNulVal_Get(aP6_270, dP6_270);
    // #endregion стр. 270
  } // #endregion ПРИЛОЖЕНИЕ 6

  // #region ПРИЛОЖЕНИЕ 7
  var aP7_090, aP7_100, aP7_130, aP7_140, aP7_150, aP7_160, aP7_170, aP7_180, aP7_190 : string;
  var dP7_090, dP7_100, dP7_130, dP7_140, dP7_150, dP7_160, dP7_170, dP7_180, dP7_190 : double;

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвОсвБГ204');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/АвОсвБГ204' + getIter(i);

    if    GetStrNull(XMLAdrI + '/РегНомИзв' )
       or GetStrNull(XMLAdrI + '/ДатаРегИзв')
       or GetStrNull(XMLAdrI + '/КодСпирт'  )
       or GetStrNull(XMLAdrI + '/КодПП'     )
       or GetStrNull(XMLAdrI + '/ДатаВыдБГ' )
       or GetStrNull(XMLAdrI + '/НомерБГ'   )
       or GetStrNull(XMLAdrI + '/ДатаНачБГ' )
       or GetStrNull(XMLAdrI + '/ДатаКонБГ' )
       or GetStrNull(XMLAdrI + '/СуммаБГ'   )
       or GetStrNull(XMLAdrI + '/ОбСпиртИзв') continue;

    aStAkc := XMLAdrI + '/СтАкц';
    valStAkc := GetDblVal(aStAkc);

    flProc := (GetDblVal(XMLAdrI + '/ЕдИзм') = KodOKEI_EdIzm_744);
    if (flProc) valStAkc := valStAkc / 100;

    // #region XML адреса
    aP7_090 := XMLAdrI + '/ОбСпиртИзв'       ;   dP7_090 := GetDblVal(aP7_090);
    aP7_100 := XMLAdrI + '/АвОсвУплИзвещ'    ;
    aP7_130 := XMLAdrI + '/ОбСпЗакПотерПер'  ;   dP7_130 := GetDblVal(aP7_130);
    aP7_140 := XMLAdrI + '/АвОсвЗакПер'      ;
    aP7_150 := XMLAdrI + '/ОбППРеалПерЗак'   ;   dP7_150 := GetDblVal(aP7_150);
    aP7_160 := XMLAdrI + '/АкИсчППРеалПер'   ;
    aP7_170 := XMLAdrI + '/АкИсчРеалПППред'  ;   dP7_170 := GetDblVal(aP7_170);
    aP7_180 := XMLAdrI + '/АкИсчРеалППКон'   ;
    aP7_190 := XMLAdrI + '/ПрАвОсвЗакРеалКон';
    // #endregion XML адреса

    // #region стр. 100
    dP7_100 := dP7_090 * valStAkc;   SV(aP7_100, dP7_100);
    LogProc(aP7_100, 'Стр. 100 = стр. 090 * Ставку акциза', GV(aP7_100)+' = '+GV(aP7_090)+' * '+GV(aStAkc), flProc);
    // #endregion стр. 100

    // #region стр. 140
    if not GetStrNull(aP7_130)
    {
      dP7_140 := dP7_130 * valStAkc;   SV(aP7_140, dP7_140);
      LogProc(aP7_140, 'Стр. 140 = стр. 130 * Ставку акциза', GV(aP7_140)+' = '+GV(aP7_130)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP7_140, dP7_140);
    // #endregion стр. 140

    // #region стр. 160
    if not GetStrNull(aP7_150)
    {
      dP7_160 := dP7_150 * valStAkc;   SV(aP7_160, dP7_160);
      LogProc(aP7_160, 'Стр. 160 = стр. 150 * Ставку акциза', GV(aP7_160)+' = '+GV(aP7_150)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP7_160, dP7_160);
    // #endregion стр. 160

    // #region стр. 180
    if    not GetStrNull(aP7_160)
       or not GetStrNull(aP7_170)
    {
      dP7_180 := dP7_160 + dP7_170;   SV(aP7_180, dP7_180);
      Log(aP7_180, 'Стр. 180 = стр. 160 + стр. 170', GV(aP7_180)+' = '+GV(aP7_160)+' + '+GV(aP7_170));
    }
    else SetNulVal_Get(aP7_180, dP7_180);
    // #endregion стр. 180

    // #region стр. 190
    if    not GetStrNull(aP7_140)
       or not GetStrNull(aP7_180)
    {
      dP7_190 := dP7_140 - dP7_180;   SV(aP7_190, dP7_190);
      Log(aP7_190, 'Стр. 190 = стр. 140 - стр. 180', GV(aP7_190)+' = '+GV(aP7_140)+' - '+GV(aP7_180));
    }
    else SetNulVal_Get(aP7_190, dP7_190);
    // #endregion стр. 190
  } // #endregion ПРИЛОЖЕНИЕ 7

  // #region ПРИЛОЖЕНИЕ 8
  // #region VAR
  var aP8_090, aP8_100, aP8_130, aP8_140
    , aP8_150_Gr3, aP8_150_Gr4, aP8_160_Gr3, aP8_160_Gr4, aP8_170_Gr3, aP8_170_Gr4, aP8_180_Gr4, aP8_190_Gr3, aP8_190_Gr4
    , aP8_200_Gr3, aP8_200_Gr4, aP8_200_Gr5, aP8_200_Gr6, aP8_210_Gr3, aP8_210_Gr4, aP8_210_Gr5, aP8_210_Gr6, aP8_220_Gr3
    , aP8_220_Gr4, aP8_230_Gr3, aP8_230_Gr4, aP8_230_Gr5, aP8_230_Gr6, aP8_240_Gr3, aP8_240_Gr4, aP8_250_Gr3, aP8_250_Gr4 : string;
  var dP8_090, dP8_100, dP8_130, dP8_140
    , dP8_150_Gr3, dP8_150_Gr4, dP8_160_Gr3, dP8_160_Gr4, dP8_170_Gr3, dP8_170_Gr4, dP8_190_Gr3, dP8_190_Gr4, dP8_200_Gr3, dP8_200_Gr4
    , dP8_210_Gr3, dP8_210_Gr4, dP8_220_Gr3, dP8_220_Gr4, dP8_230_Gr3, dP8_230_Gr4, dP8_240_Gr3, dP8_240_Gr4, dP8_250_Gr3, dP8_250_Gr4
    , dP8_180_Gr4 : double;
  var mP8 : string;
  // #endregion VAR

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп' + getIter(i);

    if    GetStrNull(XMLAdrI + '/РегНомИзв' )
       or GetStrNull(XMLAdrI + '/ДатаРегИзв')
       or GetStrNull(XMLAdrI + '/КодСпирт'  )
       or GetStrNull(XMLAdrI + '/КодПП'     )
       or GetStrNull(XMLAdrI + '/ДатаВыдБГ' )
       or GetStrNull(XMLAdrI + '/НомерБГ'   )
       or GetStrNull(XMLAdrI + '/ДатаНачБГ' )
       or GetStrNull(XMLAdrI + '/ДатаКонБГ' )
       or GetStrNull(XMLAdrI + '/СуммаБГ'   )
       or GetStrNull(XMLAdrI + '/ОбСпИзвещ' ) continue;

    aStAkc := XMLAdrI + '/СтАкц';
    valStAkc := GetDblVal(aStAkc);

    flProc := (GetDblVal(XMLAdrI + '/ЕдИзм') = KodOKEI_EdIzm_744);
    if (flProc) valStAkc := valStAkc / 100;

    // #region XML адреса
    aP8_090     := XMLAdrI + '/ОбСпИзвещ'                                   ;   dP8_090     := GetDblVal(aP8_090    );
    aP8_100     := XMLAdrI + '/АвОсвУплИзвещ'                               ;
    aP8_130     := XMLAdrI + '/ОбСпЗакУчПотерПер'                           ;   dP8_130     := GetDblVal(aP8_130    );
    aP8_140     := XMLAdrI + '/АвОсвЗакупПотерПер'                          ;
    aP8_150_Gr3 := XMLAdrI + '/АкРеалПдтвКон/ОбъемРеал'                     ;   dP8_150_Gr3 := GetDblVal(aP8_150_Gr3);
    aP8_150_Gr4 := XMLAdrI + '/АкРеалПдтвКон/СумАкциз'                      ;
    aP8_160_Gr3 := XMLAdrI + '/АкРеалРФКон/ОбъемРеал'                       ;   dP8_160_Gr3 := GetDblVal(aP8_160_Gr3);
    aP8_160_Gr4 := XMLAdrI + '/АкРеалРФКон/СумАкциз'                        ;
    aP8_170_Gr3 := XMLAdrI + '/АкЗакОсвРеал/ОбъемРеал'                      ;   dP8_170_Gr3 := GetDblVal(aP8_170_Gr3);
    aP8_170_Gr4 := XMLAdrI + '/АкЗакОсвРеал/СумАкциз'                       ;
    aP8_180_Gr4 := XMLAdrI + '/ПрАвОсвРеалКон'                              ;
    aP8_190_Gr3 := XMLAdrI + '/АкОсвБГРеалЭксп/АкРеалЭкспПер/ОбРеалЭкспПП'  ;   dP8_190_Gr3 := GetDblVal(aP8_190_Gr3);
    aP8_190_Gr4 := XMLAdrI + '/АкОсвБГРеалЭксп/АкРеалЭкспПер/СумАкциз'      ;
    aP8_200_Gr3 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/ОбРеалЭкспПП';   dP8_200_Gr3 := GetDblVal(aP8_200_Gr3);
    aP8_200_Gr4 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/СумАкциз'    ;
    aP8_200_Gr5 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/НалПерЭксп'  ;
    aP8_200_Gr6 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/ГодЭксп'     ;
    aP8_210_Gr3 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/ОбРеалЭкспПП'  ;   dP8_210_Gr3 := GetDblVal(aP8_210_Gr3);
    aP8_210_Gr4 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/СумАкциз'      ;
    aP8_210_Gr5 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/НалПерЭксп'    ;
    aP8_210_Gr6 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/ГодЭксп'       ;
    aP8_220_Gr3 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред/ОбРеалЭкспПП' ;   dP8_220_Gr3 := GetDblVal(aP8_220_Gr3);
    aP8_220_Gr4 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред/СумАкциз'     ;
    aP8_230_Gr3 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/ОбРеалЭкспПП';   dP8_230_Gr3 := GetDblVal(aP8_230_Gr3);
    aP8_230_Gr4 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/СумАкциз'    ;
    aP8_230_Gr5 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/НалПерЭксп'  ;
    aP8_230_Gr6 := XMLAdrI + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/ГодЭксп'     ;
    aP8_240_Gr3 := XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПер/ОбъемРеал'      ;   dP8_240_Gr3 := GetDblVal(aP8_240_Gr3);
    aP8_240_Gr4 := XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПер/СумАкциз'       ;
    aP8_250_Gr3 := XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПред/ОбъемРеал'     ;   dP8_250_Gr3 := GetDblVal(aP8_250_Gr3);
    aP8_250_Gr4 := XMLAdrI + '/АвРеалРФОсвБГ/АкИсчРеалРФПред/СумАкциз'      ;
    // #endregion XML адреса

    mP8 := ': Гр. 4 = гр. 3 * Ставку акциза';

    // #region стр. 100
    dP8_100 := dP8_090 * valStAkc;   SV(aP8_100, dP8_100);
    LogProc(aP8_100, 'Стр. 100 = стр. 090 * Ставку акциза', GV(aP8_100)+' = '+GV(aP8_090)+' * '+GV(aStAkc), flProc);
    // #endregion стр. 100

    // #region стр. 140
    if not GetStrNull(aP8_130)
    {
      dP8_140 := dP8_130 * valStAkc;   SV(aP8_140, dP8_140);
      LogProc(aP8_140, 'Стр. 140 = стр. 130 * Ставку акциза', GV(aP8_140)+' = '+GV(aP8_130)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_140, dP8_140);
    // #endregion стр. 140

    // #region стр. 190, гр. 4
    if not GetStrNull(aP8_190_Gr3)
    {
      dP8_190_Gr4 := dP8_190_Gr3 * valStAkc;   SV(aP8_190_Gr4, dP8_190_Gr4);
      LogProc(aP8_190_Gr4, 'Стр. 190' + mP8, GV(aP8_190_Gr4)+' = '+GV(aP8_190_Gr3)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_190_Gr4, dP8_190_Gr4);
    // #endregion стр. 190, гр. 4

    // #region стр. 200, гр. 4
    if     not GetStrNull(aP8_200_Gr3)
       and not GetStrNull(aP8_200_Gr5)
       and not GetStrNull(aP8_200_Gr6)
    {
      dP8_200_Gr4 := dP8_200_Gr3 * valStAkc;   SV(aP8_200_Gr4, dP8_200_Gr4);
      LogProc(aP8_200_Gr4, 'Стр. 200' + mP8, GV(aP8_200_Gr4)+' = '+GV(aP8_200_Gr3)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_200_Gr4, dP8_200_Gr4);
    // #endregion стр. 200, гр. 4

    // #region стр. 210, гр. 4
    if     not GetStrNull(aP8_210_Gr3)
       and not GetStrNull(aP8_210_Gr5)
       and not GetStrNull(aP8_210_Gr6)
    {
      dP8_210_Gr4 := dP8_210_Gr3 * valStAkc;   SV(aP8_210_Gr4, dP8_210_Gr4);
      LogProc(aP8_210_Gr4, 'Стр. 210' + mP8, GV(aP8_210_Gr4)+' = '+GV(aP8_210_Gr3)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_210_Gr4, dP8_210_Gr4);
    // #endregion стр. 210, гр. 4

    // #region стр. 220, гр. 4
    if not GetStrNull(aP8_220_Gr3)
    {
      dP8_220_Gr4 := dP8_220_Gr3 * valStAkc;   SV(aP8_220_Gr4, dP8_220_Gr4);
      LogProc(aP8_220_Gr4, 'Стр. 220' + mP8, GV(aP8_220_Gr4)+' = '+GV(aP8_220_Gr3)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_220_Gr4, dP8_220_Gr4);
    // #endregion стр. 220, гр. 4

    // #region стр. 230
    if     not GetStrNull(aP8_230_Gr5)
       and not GetStrNull(aP8_230_Gr6)
    {
      // #region стр. 230, гр. 3
      if     not GetStrNull(aP8_210_Gr3)
         and not GetStrNull(aP8_210_Gr4)
         and not GetStrNull(aP8_210_Gr5)
         and not GetStrNull(aP8_210_Gr6)
      {
        if     not GetStrNull(aP8_200_Gr3)
           and not GetStrNull(aP8_200_Gr4)
           and not GetStrNull(aP8_200_Gr5)
           and not GetStrNull(aP8_200_Gr6)
        {
          dP8_230_Gr3 := dP8_200_Gr3 - dP8_210_Gr3;   SV(aP8_230_Gr3, dP8_230_Gr3);
          Log(aP8_230_Gr3, 'Стр. 230: Гр. 3 = стр. 200, гр. 3 - стр. 210, гр. 3', GV(aP8_230_Gr3)+' = '+GV(aP8_200_Gr3)+' - '+GV(aP8_210_Gr3));
        }
        else  if     not GetStrNull(aP8_190_Gr3)
                 and not GetStrNull(aP8_190_Gr4)
              {
                dP8_230_Gr3 := dP8_190_Gr3 - dP8_210_Gr3;   SV(aP8_230_Gr3, dP8_230_Gr3);
                Log(aP8_230_Gr3, 'Стр. 230: Гр. 3 = стр. 190, гр. 3 - стр. 210, гр. 3', GV(aP8_230_Gr3)+' = '+GV(aP8_190_Gr3)+' - '+GV(aP8_210_Gr3));
              }
              else SetNulVal_Get(aP8_230_Gr3, dP8_230_Gr3);
      }
      else  if     not GetStrNull(aP8_190_Gr3)
               and not GetStrNull(aP8_190_Gr4)
            {
              dP8_230_Gr3 := dP8_190_Gr3;   SV(aP8_230_Gr3, dP8_230_Gr3);
              Log(aP8_230_Gr3, 'Стр. 230: Гр. 3 = стр. 190, гр. 3', GV(aP8_230_Gr3)+' = '+GV(aP8_190_Gr3));
            }
            else SetNulVal_Get(aP8_230_Gr3, dP8_230_Gr3);
      // #endregion стр. 230, гр. 3

      // #region стр. 230, гр. 4
      if not GetStrNull(aP8_230_Gr3)
      {
        dP8_230_Gr4 := dP8_230_Gr3 * valStAkc;   SV(aP8_230_Gr4, dP8_230_Gr4);
        LogProc(aP8_230_Gr4, 'Стр. 230' + mP8, GV(aP8_230_Gr4)+' = '+GV(aP8_230_Gr3)+' * '+GV(aStAkc), flProc);
      }
      else SetNulVal_Get(aP8_230_Gr4, dP8_230_Gr4);
      // #endregion стр. 230, гр. 4
    } // #endregion стр. 230

    // #region стр. 240, гр. 4
    if not GetStrNull(aP8_240_Gr3)
    {
      dP8_240_Gr4 := dP8_240_Gr3 * valStAkc;   SV(aP8_240_Gr4, dP8_240_Gr4);
      LogProc(aP8_240_Gr4, 'Стр. 240' + mP8, GV(aP8_240_Gr4)+' = '+GV(aP8_240_Gr3)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_240_Gr4, dP8_240_Gr4);
    // #endregion стр. 240, гр. 4

    // #region стр. 250, гр. 4
    if not GetStrNull(aP8_250_Gr3)
    {
      dP8_250_Gr4 := dP8_250_Gr3 * valStAkc;   SV(aP8_250_Gr4, dP8_250_Gr4);
      LogProc(aP8_250_Gr4, 'Стр. 250' + mP8, GV(aP8_250_Gr4)+' = '+GV(aP8_250_Gr3)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_250_Gr4, dP8_250_Gr4);
    // #endregion стр. 250, гр. 4

    // #region стр. 150, гр. 3
    if    (not GetStrNull(aP8_210_Gr3) and not GetStrNull(aP8_210_Gr4) and not GetStrNull(aP8_210_Gr5) and not GetStrNull(aP8_210_Gr6))
       or (not GetStrNull(aP8_220_Gr3) and not GetStrNull(aP8_220_Gr4))
    {
      dP8_150_Gr3 := dP8_210_Gr3 + dP8_220_Gr3;   SV(aP8_150_Gr3, dP8_150_Gr3);
      Log(aP8_150_Gr3, 'Стр. 150, гр. 3 = стр. 210, гр. 3 + стр. 220, гр. 3', GV(aP8_150_Gr3)+' = '+GV(aP8_210_Gr3)+' + '+GV(aP8_220_Gr3));
    }
    else SetNulVal_Get(aP8_150_Gr3, dP8_150_Gr3);
    // #endregion стр. 150, гр. 3

    // #region стр. 150, гр. 4
    if not GetStrNull(aP8_150_Gr3)
    {
      dP8_150_Gr4 := dP8_150_Gr3 * valStAkc;   SV(aP8_150_Gr4, dP8_150_Gr4);
      LogProc(aP8_150_Gr4, 'Стр. 150' + mP8, GV(aP8_150_Gr4)+' = '+GV(aP8_150_Gr3)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_150_Gr4, dP8_150_Gr4);
    // #endregion стр. 150, гр. 4

    // #region стр. 160, гр. 3
    if    (not GetStrNull(aP8_240_Gr3) and not GetStrNull(aP8_240_Gr4))
       or (not GetStrNull(aP8_250_Gr3) and not GetStrNull(aP8_250_Gr4))
    {
      dP8_160_Gr3 := dP8_240_Gr3 + dP8_250_Gr3;   SV(aP8_160_Gr3, dP8_160_Gr3);
      Log(aP8_160_Gr3, 'Стр. 160, гр. 3 = стр. 240, гр. 3 + стр. 250, гр. 3', GV(aP8_160_Gr3)+' = '+GV(aP8_240_Gr3)+' + '+GV(aP8_250_Gr3));
    }
    else SetNulVal_Get(aP8_160_Gr3, dP8_160_Gr3);
    // #endregion стр. 160, гр. 3

    // #region стр. 160, гр. 4
    if not GetStrNull(aP8_160_Gr3)
    {
      dP8_160_Gr4 := dP8_160_Gr3 * valStAkc;   SV(aP8_160_Gr4, dP8_160_Gr4);
      LogProc(aP8_160_Gr4, 'Стр. 160' + mP8, GV(aP8_160_Gr4)+' = '+GV(aP8_160_Gr3)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_160_Gr4, dP8_160_Gr4);
    // #endregion стр. 160, гр. 4

    // #region стр. 170, гр. 3
    if    (not GetStrNull(aP8_150_Gr3) and not GetStrNull(aP8_150_Gr4))
       or (not GetStrNull(aP8_160_Gr3) and not GetStrNull(aP8_160_Gr4))
    {
      dP8_170_Gr3 := dP8_150_Gr3 + dP8_160_Gr3;   SV(aP8_170_Gr3, dP8_170_Gr3);
      Log(aP8_170_Gr3, 'Стр. 170, гр. 3 = стр. 150, гр. 3 + стр. 160, гр. 3', GV(aP8_170_Gr3)+' = '+GV(aP8_150_Gr3)+' + '+GV(aP8_160_Gr3));
    }
    else SetNulVal_Get(aP8_170_Gr3, dP8_170_Gr3);
    // #endregion стр. 170, гр. 3

    // #region стр. 170, гр. 4
    if not GetStrNull(aP8_170_Gr3)
    {
      dP8_170_Gr4 := dP8_170_Gr3 * valStAkc;   SV(aP8_170_Gr4, dP8_170_Gr4);
      LogProc(aP8_170_Gr4, 'Стр. 170' + mP8, GV(aP8_170_Gr4)+' = '+GV(aP8_170_Gr3)+' * '+GV(aStAkc), flProc);
    }
    else SetNulVal_Get(aP8_170_Gr4, dP8_170_Gr4);
    // #endregion стр. 170, гр. 4

    // #region стр. 180, гр. 4
    if     not GetStrNull(aP8_140    )
       or (not GetStrNull(aP8_170_Gr3) and not GetStrNull(aP8_170_Gr4))
    {
      dP8_180_Gr4 := dP8_140 - dP8_170_Gr4;   SV(aP8_180_Gr4, dP8_180_Gr4);
      Log(aP8_180_Gr4, 'Стр. 180, гр. 4 = стр. 140 - стр. 170, гр. 4', GV(aP8_180_Gr4)+' = '+GV(aP8_140)+' - '+GV(aP8_170_Gr4));
    }
    else SetNulVal_Get(aP8_180_Gr4, dP8_180_Gr4);
    // #endregion стр. 180, гр. 4
  } // #endregion ПРИЛОЖЕНИЕ 8

  // #region РАЗДЕЛ 3.1
  var sR3_1_010, sR3_1_020
    , vR3_1_030, vR3_1_040, vR3_1_050, vR3_1_060, vR3_1_070, vR3_1_080, vR3_1_090, vR3_1_100, vR3_1_110, vR3_1_120, vR3_1_130, vR3_1_140
    , vR3_1_150, vR3_1_160, vR3_1_170, vR3_1_180, vR3_1_190, vR3_1_200, vR3_1_210, vR3_1_220, vR3_1_230, vR3_1_240, vR3_1_250
    , aR3_1_030, aR3_1_040, aR3_1_050, aR3_1_060, aR3_1_070, aR3_1_080, aR3_1_090, aR3_1_100, aR3_1_110, aR3_1_120, aR3_1_130, aR3_1_140
    , aR3_1_150, aR3_1_160, aR3_1_170, aR3_1_180, aR3_1_190, aR3_1_200, aR3_1_210, aR3_1_220, aR3_1_230, aR3_1_240, aR3_1_250 : string;
  var dR3_1_030, dR3_1_040, dR3_1_050, dR3_1_060, dR3_1_070, dR3_1_080, dR3_1_090, dR3_1_100, dR3_1_110, dR3_1_120, dR3_1_130, dR3_1_140
    , dR3_1_150, dR3_1_160, dR3_1_170, dR3_1_180, dR3_1_190, dR3_1_200, dR3_1_210, dR3_1_220, dR3_1_230, dR3_1_240, dR3_1_250 : double;

  var aP6_250, aP6_280 : string;
  var dP6_250, dP6_280 : double;

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцУплЗак');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцУплЗак' + getIter(i);

    sR3_1_010 := GetStrVal(XMLAdrI + '/КодПП'   );
    sR3_1_020 := GetStrVal(XMLAdrI + '/КодСпирт');

    if    (sR3_1_010 = '')
       or (sR3_1_020 = '') continue;

    dR3_1_030 := dR3_1_040 := dR3_1_050 := dR3_1_060 := dR3_1_070 := dR3_1_080 := dR3_1_090 := dR3_1_100 := dR3_1_110 := dR3_1_120 := dR3_1_130 := dR3_1_140 :=
    dR3_1_150 := dR3_1_160 := dR3_1_170 := dR3_1_180 := dR3_1_190 := dR3_1_200 := dR3_1_210 := dR3_1_220 := dR3_1_230 := dR3_1_240 := dR3_1_250 := 0;
    vR3_1_030 := vR3_1_040 := vR3_1_050 := vR3_1_060 := vR3_1_070 := vR3_1_080 := vR3_1_090 := vR3_1_100 := vR3_1_110 := vR3_1_120 := vR3_1_130 := vR3_1_140 :=
    vR3_1_150 := vR3_1_160 := vR3_1_170 := vR3_1_180 := vR3_1_190 := vR3_1_200 := vR3_1_210 := vR3_1_220 := vR3_1_230 := vR3_1_240 := vR3_1_250 := '';

    // #region XML адреса
    aR3_1_030 := XMLAdrI + '/ОбщЗакНеСписНач' ;
    aR3_1_040 := XMLAdrI + '/АвЗакНеСписНач'  ;
    aR3_1_050 := XMLAdrI + '/ОбщОбмЗакПер'    ;
    aR3_1_060 := XMLAdrI + '/АвУплЗакПер'     ;
    aR3_1_070 := XMLAdrI + '/ОбщЗакСписПер'   ;
    aR3_1_080 := XMLAdrI + '/АвУплСписПер'    ;
    aR3_1_090 := XMLAdrI + '/ОбщПотерНормПер' ;
    aR3_1_100 := XMLAdrI + '/АвПотерНормПер'  ;
    aR3_1_110 := XMLAdrI + '/ОбщЗакНеСписКон' ;
    aR3_1_120 := XMLAdrI + '/АвУплНеСписКон'  ;
    aR3_1_130 := XMLAdrI + '/ОбщРеалПППер'    ;
    aR3_1_140 := XMLAdrI + '/АкИсчРеалПер'    ;
    aR3_1_150 := XMLAdrI + '/ОбщИспПППер'     ;
    aR3_1_160 := XMLAdrI + '/АвУплРеалПер'    ;
    aR3_1_170 := XMLAdrI + '/ОбщПотерСпПер'   ;
    aR3_1_180 := XMLAdrI + '/АкОбщПотерПер'   ;
    aR3_1_190 := XMLAdrI + '/ОбщЗакИспПППер'  ;
    aR3_1_200 := XMLAdrI + '/АвВычУменАкПотер';
    aR3_1_210 := XMLAdrI + '/ПревАвИсчИспПер' ;
    aR3_1_220 := XMLAdrI + '/АвОбщРеалКон'    ;
    aR3_1_230 := XMLAdrI + '/ПревАвИсчИспКон' ;
    aR3_1_240 := XMLAdrI + '/ОбщСпиртЗакСлед' ;
    aR3_1_250 := XMLAdrI + '/ОбщАвУплПер'     ;
    // #endregion XML адреса

    // #region ПРИЛОЖЕНИЕ 6
    CountJ := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвППЗакупСп');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := 'Файл/Документ/АкцСпиртАлк/АвППЗакупСп' + getIter(j);

      if    GetStrNull(XMLAdrJ + '/РегНомИзв' )
         or GetStrNull(XMLAdrJ + '/ДатаРегИзв')
         or GetStrNull(XMLAdrJ + '/КодСпирт'  )
         or GetStrNull(XMLAdrJ + '/КодПП'     )
         or GetStrNull(XMLAdrJ + '/ОбСпиртИзв')
         or GetStrNull(XMLAdrJ + '/АвУплИзв'  ) continue;

      if    (sR3_1_010 <> GetStrVal(XMLAdrJ + '/КодПП'   ))
         or (sR3_1_020 <> GetStrVal(XMLAdrJ + '/КодСпирт')) continue;

      // #region XML адреса
      aP6_050     := XMLAdrJ + '/ОбСпиртИзв'               ;   dP6_050     := GetDblVal(aP6_050    );
      aP6_060     := XMLAdrJ + '/АвУплИзв'                 ;   dP6_060     := GetDblVal(aP6_060    );
      aP6_070     := XMLAdrJ + '/ОбЗакНеСписНач'           ;   dP6_070     := GetDblVal(aP6_070    );
      aP6_080     := XMLAdrJ + '/АвЗакНеСписНач'           ;   dP6_080     := GetDblVal(aP6_080    );
      aP6_090     := XMLAdrJ + '/ОбСпЗакИзвПер'            ;   dP6_090     := GetDblVal(aP6_090    );
      aP6_100     := XMLAdrJ + '/АвЗакПер'                 ;   dP6_100     := GetDblVal(aP6_100    );
      aP6_110     := XMLAdrJ + '/ОбИзвСписПер'             ;   dP6_110     := GetDblVal(aP6_110    );
      aP6_120     := XMLAdrJ + '/АвСписПер'                ;   dP6_120     := GetDblVal(aP6_120    );
      aP6_130     := XMLAdrJ + '/ОбПотерЗакПерНорм'        ;   dP6_130     := GetDblVal(aP6_130    );
      aP6_140     := XMLAdrJ + '/АвПотерНорм'              ;   dP6_140     := GetDblVal(aP6_140    );
      aP6_150     := XMLAdrJ + '/ОбЗакНеСписКон'           ;   dP6_150     := GetDblVal(aP6_150    );
      aP6_160     := XMLAdrJ + '/АвНеСписКон'              ;   dP6_160     := GetDblVal(aP6_160    );
      aP6_170     := XMLAdrJ + '/ОбППРеалПерИзв'           ;   dP6_170     := GetDblVal(aP6_170    );
      aP6_180     := XMLAdrJ + '/АкИсчППРеалПер'           ;   dP6_180     := GetDblVal(aP6_180    );
      aP6_190_Gr3 := XMLAdrJ + '/ОбЗакППРеалПер/ОбРеалПП'  ;
      aP6_190_Gr4 := XMLAdrJ + '/ОбЗакППРеалПер/СодСпиртПП';
      aP6_190_Gr5 := XMLAdrJ + '/ОбЗакППРеалПер/ОбСпСодПП' ;   dP6_190_Gr5 := GetDblVal(aP6_190_Gr5);
      aP6_200     := XMLAdrJ + '/АвИспППРеалПер'           ;   dP6_200     := GetDblVal(aP6_200    );
      aP6_210     := XMLAdrJ + '/ОбПотерЗакПерСв'          ;   dP6_210     := GetDblVal(aP6_210    );
      aP6_220     := XMLAdrJ + '/АкСвПотерПер'             ;   dP6_220     := GetDblVal(aP6_220    );
      aP6_230     := XMLAdrJ + '/ОбИспППРеалПер'           ;   dP6_230     := GetDblVal(aP6_230    );
      aP6_240     := XMLAdrJ + '/АвВычСвПотерПер'          ;   dP6_240     := GetDblVal(aP6_240    );
      aP6_250     := XMLAdrJ + '/ПрАвЗакРеалПер'           ;   dP6_250     := GetDblVal(aP6_250    );
      aP6_270     := XMLAdrJ + '/АвИсчППРеалКон'           ;   dP6_270     := GetDblVal(aP6_270    );
      aP6_280     := XMLAdrJ + '/ПрАвЗакРеалКон'           ;   dP6_280     := GetDblVal(aP6_280    );
      // #endregion XML адреса

      if     not GetStrNull(aP6_070    )  { vR3_1_030 += GV(aP6_070    ) + ' + ';   dR3_1_030 += dP6_070    ; }
      if     not GetStrNull(aP6_080    )  { vR3_1_040 += GV(aP6_080    ) + ' + ';   dR3_1_040 += dP6_080    ; }
      if     not GetStrNull(aP6_090    )  { vR3_1_050 += GV(aP6_090    ) + ' + ';   dR3_1_050 += dP6_090    ; }
      if     not GetStrNull(aP6_100    )  { vR3_1_060 += GV(aP6_100    ) + ' + ';   dR3_1_060 += dP6_100    ; }
      if     not GetStrNull(aP6_110    )  { vR3_1_070 += GV(aP6_110    ) + ' + ';   dR3_1_070 += dP6_110    ; }
      if     not GetStrNull(aP6_120    )  { vR3_1_080 += GV(aP6_120    ) + ' + ';   dR3_1_080 += dP6_120    ; }
      if     not GetStrNull(aP6_130    )  { vR3_1_090 += GV(aP6_130    ) + ' + ';   dR3_1_090 += dP6_130    ; }
      if     not GetStrNull(aP6_140    )  { vR3_1_100 += GV(aP6_140    ) + ' + ';   dR3_1_100 += dP6_140    ; }
      if     not GetStrNull(aP6_150    )  { vR3_1_110 += GV(aP6_150    ) + ' + ';   dR3_1_110 += dP6_150    ; }
      if     not GetStrNull(aP6_160    )  { vR3_1_120 += GV(aP6_160    ) + ' + ';   dR3_1_120 += dP6_160    ; }
      if     not GetStrNull(aP6_170    )  { vR3_1_130 += GV(aP6_170    ) + ' + ';   dR3_1_130 += dP6_170    ; }
      if     not GetStrNull(aP6_180    )  { vR3_1_140 += GV(aP6_180    ) + ' + ';   dR3_1_140 += dP6_180    ; }
      if     not GetStrNull(aP6_190_Gr3)
         and not GetStrNull(aP6_190_Gr4)
         and not GetStrNull(aP6_190_Gr5)  { vR3_1_150 += GV(aP6_190_Gr5) + ' + ';   dR3_1_150 += dP6_190_Gr5; }
      if     not GetStrNull(aP6_200    )  { vR3_1_160 += GV(aP6_200    ) + ' + ';   dR3_1_160 += dP6_200    ; }
      if     not GetStrNull(aP6_210    )  { vR3_1_170 += GV(aP6_210    ) + ' + ';   dR3_1_170 += dP6_210    ; }
      if     not GetStrNull(aP6_220    )  { vR3_1_180 += GV(aP6_220    ) + ' + ';   dR3_1_180 += dP6_220    ; }
      if     not GetStrNull(aP6_230    )  { vR3_1_190 += GV(aP6_230    ) + ' + ';   dR3_1_190 += dP6_230    ; }
      if     not GetStrNull(aP6_240    )  { vR3_1_200 += GV(aP6_240    ) + ' + ';   dR3_1_200 += dP6_240    ; }
      if     not GetStrNull(aP6_250    )  { vR3_1_210 += GV(aP6_250    ) + ' + ';   dR3_1_210 += dP6_250    ; }
      if     not GetStrNull(aP6_270    )  { vR3_1_220 += GV(aP6_270    ) + ' + ';   dR3_1_220 += dP6_270    ; }
      if     not GetStrNull(aP6_280    )  { vR3_1_230 += GV(aP6_280    ) + ' + ';   dR3_1_230 += dP6_280    ; }
      if     not GetStrNull(aP6_050    )  { vR3_1_240 += GV(aP6_050    ) + ' + ';   dR3_1_240 += dP6_050    ; }
      if     not GetStrNull(aP6_060    )  { vR3_1_250 += GV(aP6_060    ) + ' + ';   dR3_1_250 += dP6_060    ; }
    } // #endregion ПРИЛОЖЕНИЕ 6

    GetCutStr(vR3_1_040);
    GetCutStr(vR3_1_050);

    if (vR3_1_040 <> '0') and (vR3_1_050 <> '0')
    then {
      SV(aR3_1_040, dR3_1_040); Log(aR3_1_040, 'Стр. 040 = сумма(стр. 080, Прил.6)', GV(aR3_1_040)+' = '+vR3_1_040);
      SV(aR3_1_050, dR3_1_050); Log(aR3_1_050, 'Стр. 050 = сумма(стр. 090, Прил.6)', GV(aR3_1_050)+' = '+vR3_1_050);
    } else {
      SetNulVal_Get(aR3_1_040, dR3_1_040);
      SetNulVal_Get(aR3_1_050, dR3_1_050);
      continue;
    }

    GetCutStr(vR3_1_030);   if (vR3_1_030 <> '0') { SV(aR3_1_030, dR3_1_030); Log(aR3_1_030, 'Стр. 030 = сумма(стр. 070, Прил.6)'       , GV(aR3_1_030)+' = '+vR3_1_030); } else SetNulVal_Get(aR3_1_030, dR3_1_030);
    GetCutStr(vR3_1_060);   if (vR3_1_060 <> '0') { SV(aR3_1_060, dR3_1_060); Log(aR3_1_060, 'Стр. 060 = сумма(стр. 100, Прил.6)'       , GV(aR3_1_060)+' = '+vR3_1_060); } else SetNulVal_Get(aR3_1_060, dR3_1_060);
    GetCutStr(vR3_1_070);   if (vR3_1_070 <> '0') { SV(aR3_1_070, dR3_1_070); Log(aR3_1_070, 'Стр. 070 = сумма(стр. 110, Прил.6)'       , GV(aR3_1_070)+' = '+vR3_1_070); } else SetNulVal_Get(aR3_1_070, dR3_1_070);
    GetCutStr(vR3_1_080);   if (vR3_1_080 <> '0') { SV(aR3_1_080, dR3_1_080); Log(aR3_1_080, 'Стр. 080 = сумма(стр. 120, Прил.6)'       , GV(aR3_1_080)+' = '+vR3_1_080); } else SetNulVal_Get(aR3_1_080, dR3_1_080);
    GetCutStr(vR3_1_090);   if (vR3_1_090 <> '0') { SV(aR3_1_090, dR3_1_090); Log(aR3_1_090, 'Стр. 090 = сумма(стр. 130, Прил.6)'       , GV(aR3_1_090)+' = '+vR3_1_090); } else SetNulVal_Get(aR3_1_090, dR3_1_090);
    GetCutStr(vR3_1_100);   if (vR3_1_100 <> '0') { SV(aR3_1_100, dR3_1_100); Log(aR3_1_100, 'Стр. 100 = сумма(стр. 140, Прил.6)'       , GV(aR3_1_100)+' = '+vR3_1_100); } else SetNulVal_Get(aR3_1_100, dR3_1_100);
    GetCutStr(vR3_1_110);   if (vR3_1_110 <> '0') { SV(aR3_1_110, dR3_1_110); Log(aR3_1_110, 'Стр. 110 = сумма(стр. 150, Прил.6)'       , GV(aR3_1_110)+' = '+vR3_1_110); } else SetNulVal_Get(aR3_1_110, dR3_1_110);
    GetCutStr(vR3_1_120);   if (vR3_1_120 <> '0') { SV(aR3_1_120, dR3_1_120); Log(aR3_1_120, 'Стр. 120 = сумма(стр. 160, Прил.6)'       , GV(aR3_1_120)+' = '+vR3_1_120); } else SetNulVal_Get(aR3_1_120, dR3_1_120);
    GetCutStr(vR3_1_130);   if (vR3_1_130 <> '0') { SV(aR3_1_130, dR3_1_130); Log(aR3_1_130, 'Стр. 130 = сумма(стр. 170, Прил.6)'       , GV(aR3_1_130)+' = '+vR3_1_130); } else SetNulVal_Get(aR3_1_130, dR3_1_130);
    GetCutStr(vR3_1_140);   if (vR3_1_140 <> '0') { SV(aR3_1_140, dR3_1_140); Log(aR3_1_140, 'Стр. 140 = сумма(стр. 180, Прил.6)'       , GV(aR3_1_140)+' = '+vR3_1_140); } else SetNulVal_Get(aR3_1_140, dR3_1_140);
    GetCutStr(vR3_1_150);   if (vR3_1_150 <> '0') { SV(aR3_1_150, dR3_1_150); Log(aR3_1_150, 'Стр. 150 = сумма(стр. 190, гр. 5, Прил.6)', GV(aR3_1_150)+' = '+vR3_1_150); } else SetNulVal_Get(aR3_1_150, dR3_1_150);
    GetCutStr(vR3_1_160);   if (vR3_1_160 <> '0') { SV(aR3_1_160, dR3_1_160); Log(aR3_1_160, 'Стр. 160 = сумма(стр. 200, Прил.6)'       , GV(aR3_1_160)+' = '+vR3_1_160); } else SetNulVal_Get(aR3_1_160, dR3_1_160);
    GetCutStr(vR3_1_170);   if (vR3_1_170 <> '0') { SV(aR3_1_170, dR3_1_170); Log(aR3_1_170, 'Стр. 170 = сумма(стр. 210, Прил.6)'       , GV(aR3_1_170)+' = '+vR3_1_170); } else SetNulVal_Get(aR3_1_170, dR3_1_170);
    GetCutStr(vR3_1_180);   if (vR3_1_180 <> '0') { SV(aR3_1_180, dR3_1_180); Log(aR3_1_180, 'Стр. 180 = сумма(стр. 220, Прил.6)'       , GV(aR3_1_180)+' = '+vR3_1_180); } else SetNulVal_Get(aR3_1_180, dR3_1_180);
    GetCutStr(vR3_1_190);   if (vR3_1_190 <> '0') { SV(aR3_1_190, dR3_1_190); Log(aR3_1_190, 'Стр. 190 = сумма(стр. 230, Прил.6)'       , GV(aR3_1_190)+' = '+vR3_1_190); } else SetNulVal_Get(aR3_1_190, dR3_1_190);
    GetCutStr(vR3_1_200);   if (vR3_1_200 <> '0') { SV(aR3_1_200, dR3_1_200); Log(aR3_1_200, 'Стр. 200 = сумма(стр. 240, Прил.6)'       , GV(aR3_1_200)+' = '+vR3_1_200); } else SetNulVal_Get(aR3_1_200, dR3_1_200);
    GetCutStr(vR3_1_210);   if (vR3_1_210 <> '0') { SV(aR3_1_210, dR3_1_210); Log(aR3_1_210, 'Стр. 210 = сумма(стр. 250, Прил.6)'       , GV(aR3_1_210)+' = '+vR3_1_210); } else SetNulVal_Get(aR3_1_210, dR3_1_210);
    GetCutStr(vR3_1_220);   if (vR3_1_220 <> '0') { SV(aR3_1_220, dR3_1_220); Log(aR3_1_220, 'Стр. 220 = сумма(стр. 270, Прил.6)'       , GV(aR3_1_220)+' = '+vR3_1_220); } else SetNulVal_Get(aR3_1_220, dR3_1_220);
    GetCutStr(vR3_1_230);   if (vR3_1_230 <> '0') { SV(aR3_1_230, dR3_1_230); Log(aR3_1_230, 'Стр. 230 = сумма(стр. 280, Прил.6)'       , GV(aR3_1_230)+' = '+vR3_1_230); } else SetNulVal_Get(aR3_1_230, dR3_1_230);
    GetCutStr(vR3_1_240);   if (vR3_1_240 <> '0') { SV(aR3_1_240, dR3_1_240); Log(aR3_1_240, 'Стр. 240 = сумма(стр. 050, Прил.6)'       , GV(aR3_1_240)+' = '+vR3_1_240); } else SetNulVal_Get(aR3_1_240, dR3_1_240);
    GetCutStr(vR3_1_250);   if (vR3_1_250 <> '0') { SV(aR3_1_250, dR3_1_250); Log(aR3_1_250, 'Стр. 250 = сумма(стр. 060, Прил.6)'       , GV(aR3_1_250)+' = '+vR3_1_250); } else SetNulVal_Get(aR3_1_250, dR3_1_250);
  } // #endregion РАЗДЕЛ 3.1

  // #region РАЗДЕЛ 3.2
  var sR3_2_010, sR3_2_020
    , vR3_2_030, vR3_2_040, vR3_2_050, vR3_2_060, vR3_2_070, vR3_2_080, vR3_2_090, vR3_2_100, vR3_2_110, vR3_2_120, vR3_2_130, vR3_2_140
    , aR3_2_030, aR3_2_040, aR3_2_050, aR3_2_060, aR3_2_070, aR3_2_080, aR3_2_090, aR3_2_100, aR3_2_110, aR3_2_120, aR3_2_130, aR3_2_140 : string;
  var dR3_2_030, dR3_2_040, dR3_2_050, dR3_2_060, dR3_2_070, dR3_2_080, dR3_2_090, dR3_2_100, dR3_2_110, dR3_2_120, dR3_2_130, dR3_2_140 : double;

  var aP7_080, aP7_110, aP7_120 : string;
  var dP7_080, dP7_110, dP7_120 : double;

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ204');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ204' + getIter(i);

    sR3_2_010 := GetStrVal(XMLAdrI + '/КодПП'   );
    sR3_2_020 := GetStrVal(XMLAdrI + '/КодСпирт');

    if    (sR3_2_010 = '')
       or (sR3_2_020 = '') continue;

    dR3_2_030 := dR3_2_040 := dR3_2_050 := dR3_2_060 := dR3_2_070 := dR3_2_080 := dR3_2_090 := dR3_2_100 := dR3_2_110 := dR3_2_120 := dR3_2_130 := dR3_2_140 := 0;
    vR3_2_040 := vR3_2_050 := vR3_2_060 := vR3_2_070 := vR3_2_080 := vR3_2_090 := vR3_2_100 := vR3_2_110 := vR3_2_120 := vR3_2_130 := vR3_2_140 := '';

    // #region XML адреса
    aR3_2_030 := XMLAdrI + '/ОбщКолБГПер'    ;
    aR3_2_040 := XMLAdrI + '/ОбщСумБГПер'    ;
    aR3_2_050 := XMLAdrI + '/ОбщОбмЗакПер'   ;
    aR3_2_060 := XMLAdrI + '/ОбщОбмПотерПер' ;
    aR3_2_070 := XMLAdrI + '/ОбщОбмЗакПотер' ;
    aR3_2_080 := XMLAdrI + '/АвОсвБГУчПотер' ;
    aR3_2_090 := XMLAdrI + '/ОбщРеалПППер'   ;
    aR3_2_100 := XMLAdrI + '/АкИсчРеалПер'   ;
    aR3_2_110 := XMLAdrI + '/АкИсчРеалКонИзв';
    aR3_2_120 := XMLAdrI + '/ПревАвОсвИсчКон';
    aR3_2_130 := XMLAdrI + '/ОбщСпиртЗакСлед';
    aR3_2_140 := XMLAdrI + '/ОбщАвОсвПер'    ;
    // #endregion XML адреса

    // #region ПРИЛОЖЕНИЕ 7
    CountJ := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвОсвБГ204');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := 'Файл/Документ/АкцСпиртАлк/АвОсвБГ204' + getIter(j);

      if    GetStrNull(XMLAdrJ + '/РегНомИзв'    )
         or GetStrNull(XMLAdrJ + '/ДатаРегИзв'   )
         or GetStrNull(XMLAdrJ + '/КодСпирт'     )
         or GetStrNull(XMLAdrJ + '/КодПП'        )
         or GetStrNull(XMLAdrJ + '/ДатаВыдБГ'    )
         or GetStrNull(XMLAdrJ + '/НомерБГ'      )
         or GetStrNull(XMLAdrJ + '/ДатаНачБГ'    )
         or GetStrNull(XMLAdrJ + '/ДатаКонБГ'    )
         or GetStrNull(XMLAdrJ + '/СуммаБГ'      )
         or GetStrNull(XMLAdrJ + '/ОбСпиртИзв'   )
         or GetStrNull(XMLAdrJ + '/АвОсвУплИзвещ') continue;

      if    (sR3_2_010 <> GetStrVal(XMLAdrJ + '/КодПП'   ))
         or (sR3_2_020 <> GetStrVal(XMLAdrJ + '/КодСпирт')) continue;

      // #region XML адреса
      aP7_080 := XMLAdrJ + '/СуммаБГ'          ;   dP7_080 := GetDblVal(aP7_080);
      aP7_090 := XMLAdrJ + '/ОбСпиртИзв'       ;   dP7_090 := GetDblVal(aP7_090);
      aP7_100 := XMLAdrJ + '/АвОсвУплИзвещ'    ;   dP7_100 := GetDblVal(aP7_100);
      aP7_110 := XMLAdrJ + '/ОбСпЗакИзвПер'    ;   dP7_110 := GetDblVal(aP7_110);
      aP7_120 := XMLAdrJ + '/ОбПотерПер'       ;   dP7_120 := GetDblVal(aP7_120);
      aP7_130 := XMLAdrJ + '/ОбСпЗакПотерПер'  ;   dP7_130 := GetDblVal(aP7_130);
      aP7_140 := XMLAdrJ + '/АвОсвЗакПер'      ;   dP7_140 := GetDblVal(aP7_140);
      aP7_150 := XMLAdrJ + '/ОбППРеалПерЗак'   ;   dP7_150 := GetDblVal(aP7_150);
      aP7_160 := XMLAdrJ + '/АкИсчППРеалПер'   ;   dP7_160 := GetDblVal(aP7_160);
      aP7_180 := XMLAdrJ + '/АкИсчРеалППКон'   ;   dP7_180 := GetDblVal(aP7_180);
      aP7_190 := XMLAdrJ + '/ПрАвОсвЗакРеалКон';   dP7_190 := GetDblVal(aP7_190);
      // #endregion XML адреса

                                                                       dR3_2_030 += 1      ;
      if not GetStrNull(aP7_080) { vR3_2_040 += GV(aP7_080) + ' + ';   dR3_2_040 += dP7_080; }
      if not GetStrNull(aP7_090) { vR3_2_050 += GV(aP7_110) + ' + ';   dR3_2_050 += dP7_110; }
      if not GetStrNull(aP7_100) { vR3_2_060 += GV(aP7_120) + ' + ';   dR3_2_060 += dP7_120; }
      if not GetStrNull(aP7_110) { vR3_2_070 += GV(aP7_130) + ' + ';   dR3_2_070 += dP7_130; }
      if not GetStrNull(aP7_120) { vR3_2_080 += GV(aP7_140) + ' + ';   dR3_2_080 += dP7_140; }
      if not GetStrNull(aP7_130) { vR3_2_090 += GV(aP7_150) + ' + ';   dR3_2_090 += dP7_150; }
      if not GetStrNull(aP7_140) { vR3_2_100 += GV(aP7_160) + ' + ';   dR3_2_100 += dP7_160; }
      if not GetStrNull(aP7_150) { vR3_2_110 += GV(aP7_180) + ' + ';   dR3_2_110 += dP7_180; }
      if not GetStrNull(aP7_160) { vR3_2_120 += GV(aP7_190) + ' + ';   dR3_2_120 += dP7_190; }
      if not GetStrNull(aP7_180) { vR3_2_130 += GV(aP7_090) + ' + ';   dR3_2_130 += dP7_090; }
      if not GetStrNull(aP7_190) { vR3_2_140 += GV(aP7_100) + ' + ';   dR3_2_140 += dP7_100; }
    } // #endregion ПРИЛОЖЕНИЕ 7

    if (dR3_2_030 <> 0) { SV(aR3_2_030, dR3_2_030); Log(aR3_2_030, 'Стр. 030 = колич(Прил.7)', GV(aR3_2_030)+' = '+String(dR3_2_030)); } else SetNulVal_Get(aR3_2_030, dR3_2_030);

    GetCutStr(vR3_2_040);   if (vR3_2_040 <> '0') { SV(aR3_2_040, dR3_2_040); Log(aR3_2_040, 'Стр. 040 = сумма(стр. 080, Прил.7)', GV(aR3_2_040)+' = '+vR3_2_040); } else SetNulVal_Get(aR3_2_040, dR3_2_040);
    GetCutStr(vR3_2_050);   if (vR3_2_050 <> '0') { SV(aR3_2_050, dR3_2_050); Log(aR3_2_050, 'Стр. 050 = сумма(стр. 110, Прил.7)', GV(aR3_2_050)+' = '+vR3_2_050); } else SetNulVal_Get(aR3_2_050, dR3_2_050);
    GetCutStr(vR3_2_060);   if (vR3_2_060 <> '0') { SV(aR3_2_060, dR3_2_060); Log(aR3_2_060, 'Стр. 060 = сумма(стр. 120, Прил.7)', GV(aR3_2_060)+' = '+vR3_2_060); } else SetNulVal_Get(aR3_2_060, dR3_2_060);
    GetCutStr(vR3_2_070);   if (vR3_2_070 <> '0') { SV(aR3_2_070, dR3_2_070); Log(aR3_2_070, 'Стр. 070 = сумма(стр. 130, Прил.7)', GV(aR3_2_070)+' = '+vR3_2_070); } else SetNulVal_Get(aR3_2_070, dR3_2_070);
    GetCutStr(vR3_2_080);   if (vR3_2_080 <> '0') { SV(aR3_2_080, dR3_2_080); Log(aR3_2_080, 'Стр. 080 = сумма(стр. 140, Прил.7)', GV(aR3_2_080)+' = '+vR3_2_080); } else SetNulVal_Get(aR3_2_080, dR3_2_080);
    GetCutStr(vR3_2_090);   if (vR3_2_090 <> '0') { SV(aR3_2_090, dR3_2_090); Log(aR3_2_090, 'Стр. 090 = сумма(стр. 150, Прил.7)', GV(aR3_2_090)+' = '+vR3_2_090); } else SetNulVal_Get(aR3_2_090, dR3_2_090);
    GetCutStr(vR3_2_100);   if (vR3_2_100 <> '0') { SV(aR3_2_100, dR3_2_100); Log(aR3_2_100, 'Стр. 100 = сумма(стр. 160, Прил.7)', GV(aR3_2_100)+' = '+vR3_2_100); } else SetNulVal_Get(aR3_2_100, dR3_2_100);
    GetCutStr(vR3_2_110);   if (vR3_2_110 <> '0') { SV(aR3_2_110, dR3_2_110); Log(aR3_2_110, 'Стр. 110 = сумма(стр. 180, Прил.7)', GV(aR3_2_110)+' = '+vR3_2_110); } else SetNulVal_Get(aR3_2_110, dR3_2_110);
    GetCutStr(vR3_2_120);   if (vR3_2_120 <> '0') { SV(aR3_2_120, dR3_2_120); Log(aR3_2_120, 'Стр. 120 = сумма(стр. 190, Прил.7)', GV(aR3_2_120)+' = '+vR3_2_120); } else SetNulVal_Get(aR3_2_120, dR3_2_120);
    GetCutStr(vR3_2_130);   if (vR3_2_130 <> '0') { SV(aR3_2_130, dR3_2_130); Log(aR3_2_130, 'Стр. 130 = сумма(стр. 090, Прил.7)', GV(aR3_2_130)+' = '+vR3_2_130); } else SetNulVal_Get(aR3_2_130, dR3_2_130);
    GetCutStr(vR3_2_140);   if (vR3_2_140 <> '0') { SV(aR3_2_140, dR3_2_140); Log(aR3_2_140, 'Стр. 140 = сумма(стр. 100, Прил.7)', GV(aR3_2_140)+' = '+vR3_2_140); } else SetNulVal_Get(aR3_2_140, dR3_2_140);
  } // #endregion РАЗДЕЛ 3.2

  // #region РАЗДЕЛ 3.3
  var sR3_3_010, sR3_3_020
    , vR3_3_040, vR3_3_050_Gr3, vR3_3_050_Gr4, vR3_3_060_Gr3, vR3_3_060_Gr4, vR3_3_070_Gr3, vR3_3_070_Gr4, vR3_3_080_Gr3, vR3_3_080_Gr4, vR3_3_090_Gr3
    , vR3_3_090_Gr4, vR3_3_100_Gr3, vR3_3_100_Gr4, vR3_3_110_Gr3, vR3_3_110_Gr4, vR3_3_120_Gr3, vR3_3_120_Gr4, vR3_3_130_Gr3, vR3_3_130_Gr4, vR3_3_140_Gr4
    , aR3_3_030, aR3_3_040, aR3_3_050_Gr3, aR3_3_050_Gr4, aR3_3_060_Gr3, aR3_3_060_Gr4, aR3_3_070_Gr3, aR3_3_070_Gr4, aR3_3_080_Gr3, aR3_3_080_Gr4, aR3_3_090_Gr3
    , aR3_3_090_Gr4 , aR3_3_100_Gr3, aR3_3_100_Gr4, aR3_3_110_Gr3, aR3_3_110_Gr4, aR3_3_120_Gr3, aR3_3_120_Gr4, aR3_3_130_Gr3, aR3_3_130_Gr4, aR3_3_140_Gr4
    , aP8_080: string;
  var dR3_3_030, dR3_3_040, dR3_3_050_Gr3, dR3_3_050_Gr4, dR3_3_060_Gr3, dR3_3_060_Gr4, dR3_3_070_Gr3, dR3_3_070_Gr4, dR3_3_080_Gr3, dR3_3_080_Gr4, dR3_3_090_Gr3
    , dR3_3_090_Gr4 , dR3_3_100_Gr3, dR3_3_100_Gr4, dR3_3_110_Gr3, dR3_3_110_Gr4, dR3_3_120_Gr3, dR3_3_120_Gr4, dR3_3_130_Gr3, dR3_3_130_Gr4, dR3_3_140_Gr4
    , dP8_080 : double;

  CountI := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ184');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/АкцСпиртАлк/РасчАвАкц/АвАкцОсвБГ184' + getIter(i);

    if    GetStrNull(XMLAdrI + '/КодПП'                    )
       or GetStrNull(XMLAdrI + '/КодСпирт'                 ) continue;

    sR3_3_010 := GetStrVal(XMLAdrI + '/КодПП'   );
    sR3_3_020 := GetStrVal(XMLAdrI + '/КодСпирт');

    if    (sR3_3_010 = '')
       or (sR3_3_020 = '') continue;

    dR3_3_030 := dR3_3_040 :=
    dR3_3_050_Gr3 := dR3_3_050_Gr4 := dR3_3_060_Gr3 := dR3_3_060_Gr4 := dR3_3_070_Gr3 := dR3_3_070_Gr4 := dR3_3_080_Gr3 := dR3_3_080_Gr4 := dR3_3_090_Gr3 := dR3_3_090_Gr4 :=
    dR3_3_100_Gr3 := dR3_3_100_Gr4 := dR3_3_110_Gr3 := dR3_3_110_Gr4 := dR3_3_120_Gr3 := dR3_3_120_Gr4 := dR3_3_130_Gr3 := dR3_3_130_Gr4 := dR3_3_140_Gr4 := 0;

    vR3_3_040 :=
    vR3_3_050_Gr3 := vR3_3_050_Gr4 := vR3_3_060_Gr3 := vR3_3_060_Gr4 := vR3_3_070_Gr3 := vR3_3_070_Gr4 := vR3_3_080_Gr3 := vR3_3_080_Gr4 := vR3_3_090_Gr3 := vR3_3_090_Gr4 :=
    vR3_3_100_Gr3 := vR3_3_100_Gr4 := vR3_3_110_Gr3 := vR3_3_110_Gr4 := vR3_3_120_Gr3 := vR3_3_120_Gr4 := vR3_3_130_Gr3 := vR3_3_130_Gr4 := vR3_3_140_Gr4 := '';

    // #region XML адреса
    aR3_3_030     := XMLAdrI + '/ОбщКолБГПер'              ;
    aR3_3_040     := XMLAdrI + '/ОбщСумБГ'                 ;
    aR3_3_050_Gr3 := XMLAdrI + '/АвОсвУплПерБГ/ОбщОбъемСп' ;
    aR3_3_050_Gr4 := XMLAdrI + '/АвОсвУплПерБГ/СумАвАкциз' ;
    aR3_3_060_Gr3 := XMLAdrI + '/АвОсвУплЗакПер/ОбщОбъемСп';
    aR3_3_060_Gr4 := XMLAdrI + '/АвОсвУплЗакПер/СумАвАкциз';
    aR3_3_070_Gr3 := XMLAdrI + '/АкЗакРеалПер/ОбъемРеал'   ;
    aR3_3_070_Gr4 := XMLAdrI + '/АкЗакРеалПер/СумАкциз'    ;
    aR3_3_080_Gr3 := XMLAdrI + '/АкЭкспНеПдтвНач/ОбъемРеал';
    aR3_3_080_Gr4 := XMLAdrI + '/АкЭкспНеПдтвНач/СумАкциз' ;
    aR3_3_090_Gr3 := XMLAdrI + '/АкЭкспПдтвПер/ОбъемРеал'  ;
    aR3_3_090_Gr4 := XMLAdrI + '/АкЭкспПдтвПер/СумАкциз'   ;
    aR3_3_100_Gr3 := XMLAdrI + '/АкЭкспПдтвКон/ОбъемРеал'  ;
    aR3_3_100_Gr4 := XMLAdrI + '/АкЭкспПдтвКон/СумАкциз'   ;
    aR3_3_110_Gr3 := XMLAdrI + '/АкЭкспНеПдтвКон/ОбъемРеал';
    aR3_3_110_Gr4 := XMLAdrI + '/АкЭкспНеПдтвКон/СумАкциз' ;
    aR3_3_120_Gr3 := XMLAdrI + '/АкРеалРФКон/ОбъемРеал'    ;
    aR3_3_120_Gr4 := XMLAdrI + '/АкРеалРФКон/СумАкциз'     ;
    aR3_3_130_Gr3 := XMLAdrI + '/АкРеалКон/ОбъемРеал'      ;
    aR3_3_130_Gr4 := XMLAdrI + '/АкРеалКон/СумАкциз'       ;
    aR3_3_140_Gr4 := XMLAdrI + '/ПревАвОсвРеал'            ;
    // #endregion XML адреса

    // #region ПРИЛОЖЕНИЕ 8
    CountJ := XMLMap.GetNodeCountByName('Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := 'Файл/Документ/АкцСпиртАлк/АвОсвБГ184Эксп' + getIter(j);

      if    GetStrNull(XMLAdrJ + '/РегНомИзв'    )
         or GetStrNull(XMLAdrJ + '/ДатаРегИзв'   )
         or GetStrNull(XMLAdrJ + '/КодСпирт'     )
         or GetStrNull(XMLAdrJ + '/КодПП'        )
         or GetStrNull(XMLAdrJ + '/ДатаВыдБГ'    )
         or GetStrNull(XMLAdrJ + '/НомерБГ'      )
         or GetStrNull(XMLAdrJ + '/ДатаНачБГ'    )
         or GetStrNull(XMLAdrJ + '/ДатаКонБГ'    )
         or GetStrNull(XMLAdrJ + '/СуммаБГ'      )
         or GetStrNull(XMLAdrJ + '/ОбСпИзвещ'    )
         or GetStrNull(XMLAdrJ + '/АвОсвУплИзвещ') continue;

      if    (sR3_3_010 <> GetStrVal(XMLAdrJ + '/КодПП'   ))
         or (sR3_3_020 <> GetStrVal(XMLAdrJ + '/КодСпирт')) continue;

      // #region XML адреса
      aP8_080     := XMLAdrJ + '/СуммаБГ'                                     ;   dP8_080     := GetDblVal(aP8_080    );
      aP8_090     := XMLAdrJ + '/ОбСпИзвещ'                                   ;   dP8_090     := GetDblVal(aP8_090    );
      aP8_100     := XMLAdrJ + '/АвОсвУплИзвещ'                               ;   dP8_100     := GetDblVal(aP8_100    );
      aP8_130     := XMLAdrJ + '/ОбСпЗакУчПотерПер'                           ;   dP8_130     := GetDblVal(aP8_130    );
      aP8_140     := XMLAdrJ + '/АвОсвЗакупПотерПер'                          ;   dP8_140     := GetDblVal(aP8_140    );
      aP8_150_Gr3 := XMLAdrJ + '/АкРеалПдтвКон/ОбъемРеал'                     ;   dP8_150_Gr3 := GetDblVal(aP8_150_Gr3);
      aP8_150_Gr4 := XMLAdrJ + '/АкРеалПдтвКон/СумАкциз'                      ;   dP8_150_Gr4 := GetDblVal(aP8_150_Gr4);
      aP8_160_Gr3 := XMLAdrJ + '/АкРеалРФКон/ОбъемРеал'                       ;   dP8_160_Gr3 := GetDblVal(aP8_160_Gr3);
      aP8_160_Gr4 := XMLAdrJ + '/АкРеалРФКон/СумАкциз'                        ;   dP8_160_Gr4 := GetDblVal(aP8_160_Gr4);
      aP8_170_Gr3 := XMLAdrJ + '/АкЗакОсвРеал/ОбъемРеал'                      ;   dP8_170_Gr3 := GetDblVal(aP8_170_Gr3);
      aP8_170_Gr4 := XMLAdrJ + '/АкЗакОсвРеал/СумАкциз'                       ;   dP8_170_Gr4 := GetDblVal(aP8_170_Gr4);
      aP8_180_Gr4 := XMLAdrJ + '/ПрАвОсвРеалКон'                              ;   dP8_180_Gr4 := GetDblVal(aP8_180_Gr4);
      aP8_190_Gr3 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкРеалЭкспПер/ОбРеалЭкспПП'  ;   dP8_190_Gr3 := GetDblVal(aP8_190_Gr3);
      aP8_190_Gr4 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкРеалЭкспПер/СумАкциз'      ;   dP8_190_Gr4 := GetDblVal(aP8_190_Gr4);
      aP8_200_Gr3 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/ОбРеалЭкспПП';   dP8_200_Gr3 := GetDblVal(aP8_200_Gr3);
      aP8_200_Gr4 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/СумАкциз'    ;   dP8_200_Gr4 := GetDblVal(aP8_200_Gr4);
      aP8_200_Gr5 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/НалПерЭксп'  ;
      aP8_200_Gr6 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвНач/ГодЭксп'     ;
      aP8_210_Gr3 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/ОбРеалЭкспПП'  ;   dP8_210_Gr3 := GetDblVal(aP8_210_Gr3);
      aP8_210_Gr4 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/СумАкциз'      ;   dP8_210_Gr4 := GetDblVal(aP8_210_Gr4);
      aP8_210_Gr5 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/НалПерЭксп'    ;
      aP8_210_Gr6 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспПдтвПер/ГодЭксп'       ;
      aP8_220_Gr3 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред/ОбРеалЭкспПП' ;   dP8_220_Gr3 := GetDblVal(aP8_220_Gr3);
      aP8_220_Gr4 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспПдтвПред/СумАкциз'     ;   dP8_220_Gr4 := GetDblVal(aP8_220_Gr4);
      aP8_230_Gr3 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/ОбРеалЭкспПП';   dP8_230_Gr3 := GetDblVal(aP8_230_Gr3);
      aP8_230_Gr4 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/НалПерЭксп'  ;   dP8_230_Gr4 := GetDblVal(aP8_230_Gr4);
      aP8_230_Gr5 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/НалПерЭксп'  ;
      aP8_230_Gr6 := XMLAdrJ + '/АкОсвБГРеалЭксп/АкЭкспНеПдтвКон/ГодЭксп'     ;
      aP8_240_Gr3 := XMLAdrJ + '/АвРеалРФОсвБГ/АкИсчРеалРФПер/ОбъемРеал'      ;   dP8_240_Gr3 := GetDblVal(aP8_240_Gr3);
      aP8_240_Gr4 := XMLAdrJ + '/АвРеалРФОсвБГ/АкИсчРеалРФПер/СумАкциз'       ;   dP8_240_Gr4 := GetDblVal(aP8_240_Gr4);
      aP8_250_Gr3 := XMLAdrJ + '/АвРеалРФОсвБГ/АкИсчРеалРФПред/ОбъемРеал'     ;   dP8_250_Gr3 := GetDblVal(aP8_250_Gr3);
      aP8_250_Gr4 := XMLAdrJ + '/АвРеалРФОсвБГ/АкИсчРеалРФПред/СумАкциз'      ;   dP8_250_Gr4 := GetDblVal(aP8_250_Gr4);
      // #endregion XML адреса

                                                                                                                       dR3_3_030     += 1          ;
      if     not GetStrNull(aP8_080    )                                 { vR3_3_040     += GV(aP8_080    ) + ' + ';   dR3_3_040     += dP8_080    ; }
      if     not GetStrNull(aP8_090    )                                 { vR3_3_050_Gr3 += GV(aP8_090    ) + ' + ';   dR3_3_050_Gr3 += dP8_090    ; }
      if     not GetStrNull(aP8_100    )                                 { vR3_3_050_Gr4 += GV(aP8_100    ) + ' + ';   dR3_3_050_Gr4 += dP8_100    ; }
      if     not GetStrNull(aP8_130    )                                 { vR3_3_060_Gr3 += GV(aP8_130    ) + ' + ';   dR3_3_060_Gr3 += dP8_130    ; }
      if     not GetStrNull(aP8_140    )                                 { vR3_3_060_Gr4 += GV(aP8_140    ) + ' + ';   dR3_3_060_Gr4 += dP8_140    ; }
      if     not GetStrNull(aP8_190_Gr3) and not GetStrNull(aP8_190_Gr4) { vR3_3_070_Gr3 += GV(aP8_190_Gr3) + ' + ';   dR3_3_070_Gr3 += dP8_190_Gr3;
                                                                           vR3_3_070_Gr4 += GV(aP8_190_Gr4) + ' + ';   dR3_3_070_Gr4 += dP8_190_Gr4; }
      if     not GetStrNull(aP8_200_Gr3) and not GetStrNull(aP8_200_Gr4)
         and not GetStrNull(aP8_200_Gr5) and not GetStrNull(aP8_200_Gr6) { vR3_3_080_Gr3 += GV(aP8_200_Gr3) + ' + ';   dR3_3_080_Gr3 += dP8_200_Gr3;
                                                                           vR3_3_080_Gr4 += GV(aP8_200_Gr4) + ' + ';   dR3_3_080_Gr4 += dP8_200_Gr4; }
      if     not GetStrNull(aP8_210_Gr3) and not GetStrNull(aP8_210_Gr4)
         and not GetStrNull(aP8_210_Gr5) and not GetStrNull(aP8_210_Gr6) { vR3_3_090_Gr3 += GV(aP8_210_Gr3) + ' + ';   dR3_3_090_Gr3 += dP8_210_Gr3;
                                                                           vR3_3_090_Gr4 += GV(aP8_210_Gr4) + ' + ';   dR3_3_090_Gr4 += dP8_210_Gr4; }
      if     not GetStrNull(aP8_150_Gr3) and not GetStrNull(aP8_150_Gr4) { vR3_3_100_Gr3 += GV(aP8_150_Gr3) + ' + ';   dR3_3_100_Gr3 += dP8_150_Gr3;
                                                                           vR3_3_100_Gr4 += GV(aP8_150_Gr4) + ' + ';   dR3_3_100_Gr4 += dP8_150_Gr4; }
      if     not GetStrNull(aP8_160_Gr3) and not GetStrNull(aP8_160_Gr4) { vR3_3_120_Gr3 += GV(aP8_160_Gr3) + ' + ';   dR3_3_120_Gr3 += dP8_160_Gr3;
                                                                           vR3_3_120_Gr4 += GV(aP8_160_Gr4) + ' + ';   dR3_3_120_Gr4 += dP8_160_Gr4; }
      if     not GetStrNull(aP8_170_Gr3) and not GetStrNull(aP8_170_Gr4) { vR3_3_130_Gr3 += GV(aP8_170_Gr3) + ' + ';   dR3_3_130_Gr3 += dP8_170_Gr3;
                                                                           vR3_3_130_Gr4 += GV(aP8_170_Gr4) + ' + ';   dR3_3_130_Gr4 += dP8_170_Gr4; }
      if     not GetStrNull(aP8_180_Gr4)                                 { vR3_3_140_Gr4 += GV(aP8_180_Gr4) + ' + ';   dR3_3_140_Gr4 += dP8_180_Gr4; }
    } // #endregion ПРИЛОЖЕНИЕ 8

    GetCutStr(vR3_3_040    );
    GetCutStr(vR3_3_050_Gr3);
    GetCutStr(vR3_3_050_Gr4);
    GetCutStr(vR3_3_060_Gr3);
    GetCutStr(vR3_3_060_Gr4);
    GetCutStr(vR3_3_070_Gr3);
    GetCutStr(vR3_3_070_Gr4);
    GetCutStr(vR3_3_080_Gr3);
    GetCutStr(vR3_3_080_Gr4);
    GetCutStr(vR3_3_090_Gr3);
    GetCutStr(vR3_3_090_Gr4);
    GetCutStr(vR3_3_100_Gr3);
    GetCutStr(vR3_3_100_Gr4);
    GetCutStr(vR3_3_120_Gr3);
    GetCutStr(vR3_3_120_Gr4);
    GetCutStr(vR3_3_130_Gr3);
    GetCutStr(vR3_3_130_Gr4);
    GetCutStr(vR3_3_140_Gr4);

    if (dR3_3_030 <> 0)
    {
      SV (aR3_3_030, dR3_3_030);
      Log(aR3_3_030, 'Стр. 030 = колич(Прил.8)', GV(aR3_3_030)+' = '+String(dR3_3_030));
    }
    else SetNulVal_Get(aR3_3_030, dR3_3_030);

    if (vR3_3_040     <> '0') { SV(aR3_3_040    , dR3_3_040    ); Log(aR3_3_040    , 'Стр. 040 = сумма(стр. 080, Прил.8)'              , GV(aR3_3_040    )+' = '+vR3_3_040    ); } else SetNulVal_Get(aR3_3_040    , dR3_3_040    );
    if (vR3_3_050_Gr3 <> '0') { SV(aR3_3_050_Gr3, dR3_3_050_Gr3); Log(aR3_3_050_Gr3, 'Стр. 050, гр. 3 = сумма(стр. 090, Прил.8)'       , GV(aR3_3_050_Gr3)+' = '+vR3_3_050_Gr3); } else SetNulVal_Get(aR3_3_050_Gr3, dR3_3_050_Gr3);
    if (vR3_3_050_Gr4 <> '0') { SV(aR3_3_050_Gr4, dR3_3_050_Gr4); Log(aR3_3_050_Gr4, 'Стр. 050, гр. 4 = сумма(стр. 100, Прил.8)'       , GV(aR3_3_050_Gr4)+' = '+vR3_3_050_Gr4); } else SetNulVal_Get(aR3_3_050_Gr4, dR3_3_050_Gr4);
    if (vR3_3_060_Gr3 <> '0') { SV(aR3_3_060_Gr3, dR3_3_060_Gr3); Log(aR3_3_060_Gr3, 'Стр. 060, гр. 3 = сумма(стр. 130, Прил.8)'       , GV(aR3_3_060_Gr3)+' = '+vR3_3_060_Gr3); } else SetNulVal_Get(aR3_3_060_Gr3, dR3_3_060_Gr3);
    if (vR3_3_060_Gr4 <> '0') { SV(aR3_3_060_Gr4, dR3_3_060_Gr4); Log(aR3_3_060_Gr4, 'Стр. 060, гр. 4 = сумма(стр. 140, Прил.8)'       , GV(aR3_3_060_Gr4)+' = '+vR3_3_060_Gr4); } else SetNulVal_Get(aR3_3_060_Gr4, dR3_3_060_Gr4);
    if (vR3_3_070_Gr3 <> '0') { SV(aR3_3_070_Gr3, dR3_3_070_Gr3); Log(aR3_3_070_Gr3, 'Стр. 070, гр. 3 = сумма(стр. 190, гр. 3, Прил.8)', GV(aR3_3_070_Gr3)+' = '+vR3_3_070_Gr3); } else SetNulVal_Get(aR3_3_070_Gr3, dR3_3_070_Gr3);
    if (vR3_3_070_Gr4 <> '0') { SV(aR3_3_070_Gr4, dR3_3_070_Gr4); Log(aR3_3_070_Gr4, 'Стр. 070, гр. 4 = сумма(стр. 190, гр. 4, Прил.8)', GV(aR3_3_070_Gr4)+' = '+vR3_3_070_Gr4); } else SetNulVal_Get(aR3_3_070_Gr4, dR3_3_070_Gr4);
    if (vR3_3_080_Gr3 <> '0') { SV(aR3_3_080_Gr3, dR3_3_080_Gr3); Log(aR3_3_080_Gr3, 'Стр. 080, гр. 3 = сумма(стр. 200, гр. 3, Прил.8)', GV(aR3_3_080_Gr3)+' = '+vR3_3_080_Gr3); } else SetNulVal_Get(aR3_3_080_Gr3, dR3_3_080_Gr3);
    if (vR3_3_080_Gr4 <> '0') { SV(aR3_3_080_Gr4, dR3_3_080_Gr4); Log(aR3_3_080_Gr4, 'Стр. 080, гр. 4 = сумма(стр. 200, гр. 4, Прил.8)', GV(aR3_3_080_Gr4)+' = '+vR3_3_080_Gr4); } else SetNulVal_Get(aR3_3_080_Gr4, dR3_3_080_Gr4);
    if (vR3_3_090_Gr3 <> '0') { SV(aR3_3_090_Gr3, dR3_3_090_Gr3); Log(aR3_3_090_Gr3, 'Стр. 090, гр. 3 = сумма(стр. 210, гр. 3, Прил.8)', GV(aR3_3_090_Gr3)+' = '+vR3_3_090_Gr3); } else SetNulVal_Get(aR3_3_090_Gr3, dR3_3_090_Gr3);
    if (vR3_3_090_Gr4 <> '0') { SV(aR3_3_090_Gr4, dR3_3_090_Gr4); Log(aR3_3_090_Gr4, 'Стр. 090, гр. 4 = сумма(стр. 210, гр. 4, Прил.8)', GV(aR3_3_090_Gr4)+' = '+vR3_3_090_Gr4); } else SetNulVal_Get(aR3_3_090_Gr4, dR3_3_090_Gr4);
    if (vR3_3_100_Gr3 <> '0') { SV(aR3_3_100_Gr3, dR3_3_100_Gr3); Log(aR3_3_100_Gr3, 'Стр. 100, гр. 3 = сумма(стр. 150, гр. 3, Прил.8)', GV(aR3_3_100_Gr3)+' = '+vR3_3_100_Gr3); } else SetNulVal_Get(aR3_3_100_Gr3, dR3_3_100_Gr3);
    if (vR3_3_100_Gr4 <> '0') { SV(aR3_3_100_Gr4, dR3_3_100_Gr4); Log(aR3_3_100_Gr4, 'Стр. 100, гр. 4 = сумма(стр. 150, гр. 4, Прил.8)', GV(aR3_3_100_Gr4)+' = '+vR3_3_100_Gr4); } else SetNulVal_Get(aR3_3_100_Gr4, dR3_3_100_Gr4);
    if (vR3_3_120_Gr3 <> '0') { SV(aR3_3_120_Gr3, dR3_3_120_Gr3); Log(aR3_3_120_Gr3, 'Стр. 120, гр. 3 = сумма(стр. 160, гр. 3, Прил.8)', GV(aR3_3_120_Gr3)+' = '+vR3_3_120_Gr3); } else SetNulVal_Get(aR3_3_120_Gr3, dR3_3_120_Gr3);
    if (vR3_3_120_Gr4 <> '0') { SV(aR3_3_120_Gr4, dR3_3_120_Gr4); Log(aR3_3_120_Gr4, 'Стр. 120, гр. 4 = сумма(стр. 160, гр. 4, Прил.8)', GV(aR3_3_120_Gr4)+' = '+vR3_3_120_Gr4); } else SetNulVal_Get(aR3_3_120_Gr4, dR3_3_120_Gr4);
    if (vR3_3_130_Gr3 <> '0') { SV(aR3_3_130_Gr3, dR3_3_130_Gr3); Log(aR3_3_130_Gr3, 'Стр. 130, гр. 3 = сумма(стр. 170, гр. 3, Прил.8)', GV(aR3_3_130_Gr3)+' = '+vR3_3_130_Gr3); } else SetNulVal_Get(aR3_3_130_Gr3, dR3_3_130_Gr3);
    if (vR3_3_130_Gr4 <> '0') { SV(aR3_3_130_Gr4, dR3_3_130_Gr4); Log(aR3_3_130_Gr4, 'Стр. 130, гр. 4 = сумма(стр. 170, гр. 4, Прил.8)', GV(aR3_3_130_Gr4)+' = '+vR3_3_130_Gr4); } else SetNulVal_Get(aR3_3_130_Gr4, dR3_3_130_Gr4);
    if (vR3_3_140_Gr4 <> '0') { SV(aR3_3_140_Gr4, dR3_3_140_Gr4); Log(aR3_3_140_Gr4, 'Стр. 140, гр. 4 = сумма(стр. 180, гр. 4, Прил.8)', GV(aR3_3_140_Gr4)+' = '+vR3_3_140_Gr4); } else SetNulVal_Get(aR3_3_140_Gr4, dR3_3_140_Gr4);

    // #region стр. 110
    if    (not GetStrNull(aR3_3_080_Gr3) and not GetStrNull(aR3_3_080_Gr4))
       or (not GetStrNull(aR3_3_090_Gr3) and not GetStrNull(aR3_3_090_Gr4))
    {
      dR3_3_110_Gr3 := dR3_3_080_Gr3 - dR3_3_090_Gr3;   SV(aR3_3_110_Gr3, dR3_3_110_Gr3);
      dR3_3_110_Gr4 := dR3_3_080_Gr4 - dR3_3_090_Gr4;   SV(aR3_3_110_Gr4, dR3_3_110_Gr4);

      Log(aR3_3_110_Gr3, 'Стр. 110, гр. 3 = стр. 080, гр. 3 - стр. 090, гр. 3', GV(aR3_3_110_Gr3)+' = '+GV(aR3_3_080_Gr3)+' - '+GV(aR3_3_090_Gr3));
      Log(aR3_3_110_Gr4, 'Стр. 110, гр. 4 = стр. 080, гр. 4 - стр. 090, гр. 4', GV(aR3_3_110_Gr4)+' = '+GV(aR3_3_080_Gr4)+' - '+GV(aR3_3_090_Gr4));
    } else {
      SetNulVal_Get(aR3_3_110_Gr3, dR3_3_110_Gr3);
      SetNulVal_Get(aR3_3_110_Gr4, dR3_3_110_Gr4);
    } // #endregion стр. 110
  } // #endregion РАЗДЕЛ 3.3
@end.
// #endregion ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ РАСЧЕТЕ
//************************************************************************************************************


//============================================================================================================
// #region ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ЭКСПОРТЕ В XML
//------------------------------------------------------------------------------------------------------------
@Script On_ExportXML : boolean;
@begin
  SetFldVal('Файл/ИдФайл', Replace(_IdFail_, '.xml', ''));

  if (not XMLMap.ExpToXml(_XmlFileName_)) {
    Message('On_ExportXML: '+ XMLMap.GetStLastError, cancelButton+Warning);
    Exit;
  }

  message('Выгружен в файл ' + _XmlFileName_);
@end.
// #endregion ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ЭКСПОРТЕ В XML
//************************************************************************************************************
