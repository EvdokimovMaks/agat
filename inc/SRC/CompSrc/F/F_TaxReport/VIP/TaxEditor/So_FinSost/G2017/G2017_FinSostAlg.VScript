//------------------------------------------------------------------------------------------------------------
//                                                                                    (c) корпорация Галактика
// Галактика 9.1 - модуль "Электронная отчетность"
// Алгоритмы расчета : "Сведения о финансовом состоянии организации (П-3) (2017)"
//------------------------------------------------------------------------------------------------------------

//============================================================================================================
// #region СЕРВИСНЫЕ МЕТОДЫ
//------------------------------------------------------------------------------------------------------------
@Script GetStrVal(fld: string) : string;
@begin
  Result := Trim(XMLMAP.GetAttrValueByName(fld));
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetDblVal(fld: string) : double;
@begin
  Result := Round(Double(XMLMAP.GetAttrValueByName(fld)), 2);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetStrValFormat(fld:string):string;
@begin
  var bufRes: string;

  bufRes := Trim(String(XMLMAP.GetAttrValueByName(fld)));

  if (bufRes = '')
  then Result := '0'
  else if (Double(bufRes) < 0)
       then Result := '('+bufRes+')'
       else Result := bufRes;
@end.

//------------------------------------------------------------------------------------------------------------
@Script SetFldVal(fld:string;val:string);
@begin
  XMLMAP.SetAttrValueByName(fld,val,2);
@end.

//------------------------------------------------------------------------------------------------------------
@Script SetFldNull(fld:string);
@begin
  XMLMAP.SetIsNullAttrValueByName(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetPatVal(expr: string) : double;
#include AllTaxObj.Vih
@begin
  Result := Double(ПАТ(expr));
@end.

//------------------------------------------------------------------------------------------------------------
@Script MesErrStop(mesMesAdrXML, mesPole, mesMes: string): Boolean;
@begin
  MesError.InsertMesError(mesMesAdrXML, Comp(0), '', mesPole, mesMes, 0, 0);
  Result := True;
@end.

//------------------------------------------------------------------------------------------------------------
@Script NullStr(fld:string):Boolean;
@begin
  Result := (GetStrVal(fld) = '');
@end.
// #endregion СЕРВИСНЫЕ МЕТОДЫ
//************************************************************************************************************


//============================================================================================================
//#region ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ПРОВЕРКЕ
//------------------------------------------------------------------------------------------------------------
@Script On_Check : Boolean;
  //==========================================================================================================
  //#region СЕРВИС
  //----------------------------------------------------------------------------------------------------------
  #undef SG
  #declare SG(_Name, _Adr)
    a#_Name := #_Adr;
    d#_Name := GetDblVal(a#_Name);
  #end

  //----------------------------------------------------------------------------------------------------------
  #undef   KS
  #declare KS(_if, _XMLAdr, _Field)
    if (not (#_if))
    { MesErrStop(#_XMLAdr, #_Field, getMes); }
  #end

  //----------------------------------------------------------------------------------------------------------
  #undef   KSm
  #declare KSm(_if, _XMLAdr, _Field, _Mes)
    if (not (#_if))
    { MesErrStop(#_XMLAdr, #_Field, #_Mes); }
  #end

  //----------------------------------------------------------------------------------------------------------
  #undef   _KSm
  #declare _KSm(_XMLAdr, _Field)
    if (not NullStr(#_XMLAdr))
      if (GetDblVal(#_XMLAdr) <> 0.0)
      { MesErrStop(#_XMLAdr, #_Field, getMes); }
  #end

  //----------------------------------------------------------------------------------------------------------
  #declare _IsValid(_Valid, _AdrXML, _Pole)
    if not #_Valid(#_AdrXML, getMes)
      MesErrStop
      (
        #_AdrXML
      , #_Pole
      , 'Поле не соответствует формату. ' + getMes
      );
  #end

  //----------------------------------------------------------------------------------------------------------
  function IsValidPrimUSN(_adr: string; var _mes: string) : boolean;
  begin //Применяла ли организация УСН в отчетном периоде
    _mes := 'Возможные значения: 1 или 0';

    Result := False;
    Result := CheckError.isRegExpr('^(1|0)$', GetStrVal(_adr));
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidDate(_adr: string; var _mes: string) : boolean;
  begin //Дата
    _mes := 'Поле обязательно к заполнению';

    Result := False;
    Result := ((not NullStr(_adr)) and (GetStrVal(_adr) <> 'ДД мес ГГГГ'));
  end;

  //----------------------------------------------------------------------------------------------------------
  function IsValidNull(_adr: string; var _mes: string) : boolean;
  begin // Обязательные поля
    _mes := 'Поле обязательно к заполнению';

    Result := False;
    Result := not NullStr(_adr);
  end;
  //#endregion СЕРВИС
  //**********************************************************************************************************
@begin
  //----------------------------------------------------------------------------------------------------------
  // #region ОБЪЯВЛЕНИЕ И ИНИЦИАЛИЗАЦИЯ ПЕРЕМЕННЫХ
  //----------------------------------------------------------------------------------------------------------
  var isEndOfQuarter, isEndOfYear : Boolean;
  var getMes : String;
  var
  // Раздел 1
    aR1_01_1, aR1_02_1, aR1_03_1, aR1_03_2, aR1_05_1, aR1_05_2, aR1_06_1, aR1_06_2, aR1_07_1, aR1_07_2, aR1_12_1, aR1_12_2, aR1_13_1, aR1_13_2, aR1_15_1, aR1_15_2, aR1_18_1
  , aR1_18_2, aR1_19_1, aR1_19_2, aR1_20_1, aR1_20_2, aR1_25_1, aR1_25_2, aR1_26_1, aR1_26_2, aR1_27_1, aR1_27_2
  // Раздел 2
  , aR2_30_1, aR2_30_2, aR2_31_1, aR2_31_2, aR2_32_1, aR2_32_2, aR2_33_1, aR2_33_2, aR2_34_1, aR2_34_2, aR2_35_1, aR2_35_2
  // Раздел 3
  , aR3_36_1, aR3_36_2, aR3_37_1, aR3_37_2, aR3_38_1, aR3_38_2, aR3_39_1, aR3_39_2, aR3_40_1, aR3_40_2, aR3_41_1, aR3_41_2, aR3_42_1, aR3_42_2, aR3_43_1, aR3_43_2, aR3_44_1
  , aR3_44_2, aR3_45_1, aR3_45_2, aR3_46_1, aR3_46_2, aR3_47_1, aR3_47_2, aR3_48_1, aR3_48_2, aR3_49_1, aR3_49_2, aR3_50_1, aR3_50_2, aR3_50a_1, aR3_50a_2
  // Раздел 4
  , aR4_51_1, aR4_51_2, aR4_51_3, aR4_51_4, aR4_51_5, aR4_51_6, aR4_51_7
  , aR4_52_1, aR4_52_2, aR4_52_3, aR4_52_4, aR4_52_5, aR4_52_6, aR4_52_7
  , aR4_53_1, aR4_53_2, aR4_53_3, aR4_53_4, aR4_53_5, aR4_53_6, aR4_53_7
  , aR4_54_1, aR4_54_2, aR4_54_3, aR4_54_4, aR4_54_5, aR4_54_6, aR4_54_7
  , aR4_55_1, aR4_55_2, aR4_55_3, aR4_55_4, aR4_55_5, aR4_55_6, aR4_55_7
  , aR4_56_1, aR4_56_2, aR4_56_3, aR4_56_4, aR4_56_5, aR4_56_6, aR4_56_7
  , aR4_57_1, aR4_57_2, aR4_57_3, aR4_57_4, aR4_57_5, aR4_57_6, aR4_57_7
  , aR4_58_1, aR4_58_2, aR4_58_3, aR4_58_4, aR4_58_5, aR4_58_6, aR4_58_7
  , aR4_59_1, aR4_59_2, aR4_59_3, aR4_59_4, aR4_59_5, aR4_59_6, aR4_59_7
  , aR4_60_1, aR4_60_2, aR4_60_3, aR4_60_4, aR4_60_5, aR4_60_6, aR4_60_7
  , aR4_61_1, aR4_61_2, aR4_61_3, aR4_61_4, aR4_61_5, aR4_61_6, aR4_61_7
  , aR4_62_1, aR4_62_2, aR4_62_3, aR4_62_4, aR4_62_5, aR4_62_6, aR4_62_7
  , aR4_63_1, aR4_63_2, aR4_63_3, aR4_63_4, aR4_63_5, aR4_63_6, aR4_63_7 : String;

  var
  // Раздел 1
    dR1_01_1, dR1_02_1, dR1_03_1, dR1_03_2, dR1_05_1, dR1_05_2, dR1_06_1, dR1_06_2, dR1_07_1, dR1_07_2, dR1_12_1, dR1_12_2, dR1_13_1, dR1_13_2, dR1_15_1, dR1_15_2, dR1_18_1
  , dR1_18_2, dR1_19_1, dR1_19_2, dR1_20_1, dR1_20_2, dR1_25_1, dR1_25_2, dR1_26_1, dR1_26_2, dR1_27_1, dR1_27_2
  // Раздел 2
  , dR2_30_1, dR2_30_2, dR2_31_1, dR2_31_2, dR2_32_1, dR2_32_2, dR2_33_1, dR2_33_2, dR2_34_1, dR2_34_2, dR2_35_1, dR2_35_2
  // Раздел 3
  , dR3_36_1, dR3_36_2, dR3_37_1, dR3_37_2, dR3_38_1, dR3_38_2, dR3_39_1, dR3_39_2, dR3_40_1, dR3_40_2, dR3_41_1, dR3_41_2, dR3_42_1, dR3_42_2, dR3_43_1, dR3_43_2, dR3_44_1
  , dR3_44_2, dR3_45_1, dR3_45_2, dR3_46_1, dR3_46_2, dR3_47_1, dR3_47_2, dR3_48_1, dR3_48_2, dR3_49_1, dR3_49_2, dR3_50_1, dR3_50_2, dR3_50a_1, dR3_50a_2
  // Раздел 4
  , dR4_51_1, dR4_51_2, dR4_51_3, dR4_51_4, dR4_51_5, dR4_51_6, dR4_51_7
  , dR4_52_1, dR4_52_2, dR4_52_3, dR4_52_4, dR4_52_5, dR4_52_6, dR4_52_7
  , dR4_53_1, dR4_53_2, dR4_53_3, dR4_53_4, dR4_53_5, dR4_53_6, dR4_53_7
  , dR4_54_1, dR4_54_2, dR4_54_3, dR4_54_4, dR4_54_5, dR4_54_6, dR4_54_7
  , dR4_55_1, dR4_55_2, dR4_55_3, dR4_55_4, dR4_55_5, dR4_55_6, dR4_55_7
  , dR4_56_1, dR4_56_2, dR4_56_3, dR4_56_4, dR4_56_5, dR4_56_6, dR4_56_7
  , dR4_57_1, dR4_57_2, dR4_57_3, dR4_57_4, dR4_57_5, dR4_57_6, dR4_57_7
  , dR4_58_1, dR4_58_2, dR4_58_3, dR4_58_4, dR4_58_5, dR4_58_6, dR4_58_7
  , dR4_59_1, dR4_59_2, dR4_59_3, dR4_59_4, dR4_59_5, dR4_59_6, dR4_59_7
  , dR4_60_1, dR4_60_2, dR4_60_3, dR4_60_4, dR4_60_5, dR4_60_6, dR4_60_7
  , dR4_61_1, dR4_61_2, dR4_61_3, dR4_61_4, dR4_61_5, dR4_61_6, dR4_61_7
  , dR4_62_1, dR4_62_2, dR4_62_3, dR4_62_4, dR4_62_5, dR4_62_6, dR4_62_7
  , dR4_63_1, dR4_63_2, dR4_63_3, dR4_63_4, dR4_63_5, dR4_63_6, dR4_63_7 : Double;

  // Раздел 1
  #SG(R1_01_1, 'Документ/Разделы/Раздел1/Стр01/Гр1')
  #SG(R1_02_1, 'Документ/Разделы/Раздел1/Стр02/Гр1')
  #SG(R1_03_1, 'Документ/Разделы/Раздел1/Стр03/Гр1')   #SG(R1_03_2, 'Документ/Разделы/Раздел1/Стр03/Гр2')
  #SG(R1_05_1, 'Документ/Разделы/Раздел1/Стр05/Гр1')   #SG(R1_05_2, 'Документ/Разделы/Раздел1/Стр05/Гр2')
  #SG(R1_06_1, 'Документ/Разделы/Раздел1/Стр06/Гр1')   #SG(R1_06_2, 'Документ/Разделы/Раздел1/Стр06/Гр2')
  #SG(R1_07_1, 'Документ/Разделы/Раздел1/Стр07/Гр1')   #SG(R1_07_2, 'Документ/Разделы/Раздел1/Стр07/Гр2')
  #SG(R1_12_1, 'Документ/Разделы/Раздел1/Стр12/Гр1')   #SG(R1_12_2, 'Документ/Разделы/Раздел1/Стр12/Гр2')
  #SG(R1_13_1, 'Документ/Разделы/Раздел1/Стр13/Гр1')   #SG(R1_13_2, 'Документ/Разделы/Раздел1/Стр13/Гр2')
  #SG(R1_15_1, 'Документ/Разделы/Раздел1/Стр15/Гр1')   #SG(R1_15_2, 'Документ/Разделы/Раздел1/Стр15/Гр2')
  #SG(R1_18_1, 'Документ/Разделы/Раздел1/Стр18/Гр1')   #SG(R1_18_2, 'Документ/Разделы/Раздел1/Стр18/Гр2')
  #SG(R1_19_1, 'Документ/Разделы/Раздел1/Стр19/Гр1')   #SG(R1_19_2, 'Документ/Разделы/Раздел1/Стр19/Гр2')
  #SG(R1_20_1, 'Документ/Разделы/Раздел1/Стр20/Гр1')   #SG(R1_20_2, 'Документ/Разделы/Раздел1/Стр20/Гр2')
  #SG(R1_25_1, 'Документ/Разделы/Раздел1/Стр25/Гр1')   #SG(R1_25_2, 'Документ/Разделы/Раздел1/Стр25/Гр2')
  #SG(R1_26_1, 'Документ/Разделы/Раздел1/Стр26/Гр1')   #SG(R1_26_2, 'Документ/Разделы/Раздел1/Стр26/Гр2')
  #SG(R1_27_1, 'Документ/Разделы/Раздел1/Стр27/Гр1')   #SG(R1_27_2, 'Документ/Разделы/Раздел1/Стр27/Гр2')

  // Раздел 2
  #SG(R2_30_1, 'Документ/Разделы/Раздел2/Стр30/Гр1')   #SG(R2_30_2, 'Документ/Разделы/Раздел2/Стр30/Гр2')
  #SG(R2_31_1, 'Документ/Разделы/Раздел2/Стр31/Гр1')   #SG(R2_31_2, 'Документ/Разделы/Раздел2/Стр31/Гр2')
  #SG(R2_32_1, 'Документ/Разделы/Раздел2/Стр32/Гр1')   #SG(R2_32_2, 'Документ/Разделы/Раздел2/Стр32/Гр2')
  #SG(R2_33_1, 'Документ/Разделы/Раздел2/Стр33/Гр1')   #SG(R2_33_2, 'Документ/Разделы/Раздел2/Стр33/Гр2')
  #SG(R2_34_1, 'Документ/Разделы/Раздел2/Стр34/Гр1')   #SG(R2_34_2, 'Документ/Разделы/Раздел2/Стр34/Гр2')
  #SG(R2_35_1, 'Документ/Разделы/Раздел2/Стр35/Гр1')   #SG(R2_35_2, 'Документ/Разделы/Раздел2/Стр35/Гр2')

  // Раздел 3
  #SG(R3_36_1 , 'Документ/Разделы/Раздел3/Стр36/Гр1' )   #SG(R3_36_2 , 'Документ/Разделы/Раздел3/Стр36/Гр2' )
  #SG(R3_37_1 , 'Документ/Разделы/Раздел3/Стр37/Гр1' )   #SG(R3_37_2 , 'Документ/Разделы/Раздел3/Стр37/Гр2' )
  #SG(R3_38_1 , 'Документ/Разделы/Раздел3/Стр38/Гр1' )   #SG(R3_38_2 , 'Документ/Разделы/Раздел3/Стр38/Гр2' )
  #SG(R3_39_1 , 'Документ/Разделы/Раздел3/Стр39/Гр1' )   #SG(R3_39_2 , 'Документ/Разделы/Раздел3/Стр39/Гр2' )
  #SG(R3_40_1 , 'Документ/Разделы/Раздел3/Стр40/Гр1' )   #SG(R3_40_2 , 'Документ/Разделы/Раздел3/Стр40/Гр2' )
  #SG(R3_41_1 , 'Документ/Разделы/Раздел3/Стр41/Гр1' )   #SG(R3_41_2 , 'Документ/Разделы/Раздел3/Стр41/Гр2' )
  #SG(R3_42_1 , 'Документ/Разделы/Раздел3/Стр42/Гр1' )   #SG(R3_42_2 , 'Документ/Разделы/Раздел3/Стр42/Гр2' )
  #SG(R3_43_1 , 'Документ/Разделы/Раздел3/Стр43/Гр1' )   #SG(R3_43_2 , 'Документ/Разделы/Раздел3/Стр43/Гр2' )
  #SG(R3_44_1 , 'Документ/Разделы/Раздел3/Стр44/Гр1' )   #SG(R3_44_2 , 'Документ/Разделы/Раздел3/Стр44/Гр2' )
  #SG(R3_45_1 , 'Документ/Разделы/Раздел3/Стр45/Гр1' )   #SG(R3_45_2 , 'Документ/Разделы/Раздел3/Стр45/Гр2' )
  #SG(R3_46_1 , 'Документ/Разделы/Раздел3/Стр46/Гр1' )   #SG(R3_46_2 , 'Документ/Разделы/Раздел3/Стр46/Гр2' )
  #SG(R3_47_1 , 'Документ/Разделы/Раздел3/Стр47/Гр1' )   #SG(R3_47_2 , 'Документ/Разделы/Раздел3/Стр47/Гр2' )
  #SG(R3_48_1 , 'Документ/Разделы/Раздел3/Стр48/Гр1' )   #SG(R3_48_2 , 'Документ/Разделы/Раздел3/Стр48/Гр2' )
  #SG(R3_49_1 , 'Документ/Разделы/Раздел3/Стр49/Гр1' )   #SG(R3_49_2 , 'Документ/Разделы/Раздел3/Стр49/Гр2' )
  #SG(R3_50_1 , 'Документ/Разделы/Раздел3/Стр50/Гр1' )   #SG(R3_50_2 , 'Документ/Разделы/Раздел3/Стр50/Гр2' )
  #SG(R3_50a_1, 'Документ/Разделы/Раздел3/Стр50а/Гр1')   #SG(R3_50a_2, 'Документ/Разделы/Раздел3/Стр50а/Гр2')

  // Раздел 4
  #SG(R4_51_1, 'Документ/Разделы/Раздел4/Стр51/Гр1')
  #SG(R4_51_2, 'Документ/Разделы/Раздел4/Стр51/Гр2')
  #SG(R4_51_3, 'Документ/Разделы/Раздел4/Стр51/Гр3')
  #SG(R4_51_4, 'Документ/Разделы/Раздел4/Стр51/Гр4')
  #SG(R4_51_5, 'Документ/Разделы/Раздел4/Стр51/Гр5')
  #SG(R4_51_6, 'Документ/Разделы/Раздел4/Стр51/Гр6')
  #SG(R4_51_7, 'Документ/Разделы/Раздел4/Стр51/Гр7')

  #SG(R4_52_1, 'Документ/Разделы/Раздел4/Стр52/Гр1')
  #SG(R4_52_2, 'Документ/Разделы/Раздел4/Стр52/Гр2')
  #SG(R4_52_3, 'Документ/Разделы/Раздел4/Стр52/Гр3')
  #SG(R4_52_4, 'Документ/Разделы/Раздел4/Стр52/Гр4')
  #SG(R4_52_5, 'Документ/Разделы/Раздел4/Стр52/Гр5')
  #SG(R4_52_6, 'Документ/Разделы/Раздел4/Стр52/Гр6')
  #SG(R4_52_7, 'Документ/Разделы/Раздел4/Стр52/Гр7')

  #SG(R4_53_1, 'Документ/Разделы/Раздел4/Стр53/Гр1')
  #SG(R4_53_2, 'Документ/Разделы/Раздел4/Стр53/Гр2')
  #SG(R4_53_3, 'Документ/Разделы/Раздел4/Стр53/Гр3')
  #SG(R4_53_4, 'Документ/Разделы/Раздел4/Стр53/Гр4')
  #SG(R4_53_5, 'Документ/Разделы/Раздел4/Стр53/Гр5')
  #SG(R4_53_6, 'Документ/Разделы/Раздел4/Стр53/Гр6')
  #SG(R4_53_7, 'Документ/Разделы/Раздел4/Стр53/Гр7')

  #SG(R4_54_1, 'Документ/Разделы/Раздел4/Стр54/Гр1')
  #SG(R4_54_2, 'Документ/Разделы/Раздел4/Стр54/Гр2')
  #SG(R4_54_3, 'Документ/Разделы/Раздел4/Стр54/Гр3')
  #SG(R4_54_4, 'Документ/Разделы/Раздел4/Стр54/Гр4')
  #SG(R4_54_5, 'Документ/Разделы/Раздел4/Стр54/Гр5')
  #SG(R4_54_6, 'Документ/Разделы/Раздел4/Стр54/Гр6')
  #SG(R4_54_7, 'Документ/Разделы/Раздел4/Стр54/Гр7')

  #SG(R4_55_1, 'Документ/Разделы/Раздел4/Стр55/Гр1')
  #SG(R4_55_2, 'Документ/Разделы/Раздел4/Стр55/Гр2')
  #SG(R4_55_3, 'Документ/Разделы/Раздел4/Стр55/Гр3')
  #SG(R4_55_4, 'Документ/Разделы/Раздел4/Стр55/Гр4')
  #SG(R4_55_5, 'Документ/Разделы/Раздел4/Стр55/Гр5')
  #SG(R4_55_6, 'Документ/Разделы/Раздел4/Стр55/Гр6')
  #SG(R4_55_7, 'Документ/Разделы/Раздел4/Стр55/Гр7')

  #SG(R4_56_1, 'Документ/Разделы/Раздел4/Стр56/Гр1')
  #SG(R4_56_2, 'Документ/Разделы/Раздел4/Стр56/Гр2')
  #SG(R4_56_3, 'Документ/Разделы/Раздел4/Стр56/Гр3')
  #SG(R4_56_4, 'Документ/Разделы/Раздел4/Стр56/Гр4')
  #SG(R4_56_5, 'Документ/Разделы/Раздел4/Стр56/Гр5')
  #SG(R4_56_6, 'Документ/Разделы/Раздел4/Стр56/Гр6')
  #SG(R4_56_7, 'Документ/Разделы/Раздел4/Стр56/Гр7')

  #SG(R4_57_1, 'Документ/Разделы/Раздел4/Стр57/Гр1')
  #SG(R4_57_2, 'Документ/Разделы/Раздел4/Стр57/Гр2')
  #SG(R4_57_3, 'Документ/Разделы/Раздел4/Стр57/Гр3')
  #SG(R4_57_4, 'Документ/Разделы/Раздел4/Стр57/Гр4')
  #SG(R4_57_5, 'Документ/Разделы/Раздел4/Стр57/Гр5')
  #SG(R4_57_6, 'Документ/Разделы/Раздел4/Стр57/Гр6')
  #SG(R4_57_7, 'Документ/Разделы/Раздел4/Стр57/Гр7')

  #SG(R4_58_1, 'Документ/Разделы/Раздел4/Стр58/Гр1')
  #SG(R4_58_2, 'Документ/Разделы/Раздел4/Стр58/Гр2')
  #SG(R4_58_3, 'Документ/Разделы/Раздел4/Стр58/Гр3')
  #SG(R4_58_4, 'Документ/Разделы/Раздел4/Стр58/Гр4')
  #SG(R4_58_5, 'Документ/Разделы/Раздел4/Стр58/Гр5')
  #SG(R4_58_6, 'Документ/Разделы/Раздел4/Стр58/Гр6')
  #SG(R4_58_7, 'Документ/Разделы/Раздел4/Стр58/Гр7')

  #SG(R4_59_1, 'Документ/Разделы/Раздел4/Стр59/Гр1')
  #SG(R4_59_2, 'Документ/Разделы/Раздел4/Стр59/Гр2')
  #SG(R4_59_3, 'Документ/Разделы/Раздел4/Стр59/Гр3')
  #SG(R4_59_4, 'Документ/Разделы/Раздел4/Стр59/Гр4')
  #SG(R4_59_5, 'Документ/Разделы/Раздел4/Стр59/Гр5')
  #SG(R4_59_6, 'Документ/Разделы/Раздел4/Стр59/Гр6')
  #SG(R4_59_7, 'Документ/Разделы/Раздел4/Стр59/Гр7')

  #SG(R4_60_1, 'Документ/Разделы/Раздел4/Стр60/Гр1')
  #SG(R4_60_2, 'Документ/Разделы/Раздел4/Стр60/Гр2')
  #SG(R4_60_3, 'Документ/Разделы/Раздел4/Стр60/Гр3')
  #SG(R4_60_4, 'Документ/Разделы/Раздел4/Стр60/Гр4')
  #SG(R4_60_5, 'Документ/Разделы/Раздел4/Стр60/Гр5')
  #SG(R4_60_6, 'Документ/Разделы/Раздел4/Стр60/Гр6')
  #SG(R4_60_7, 'Документ/Разделы/Раздел4/Стр60/Гр7')

  #SG(R4_61_1, 'Документ/Разделы/Раздел4/Стр61/Гр1')
  #SG(R4_61_2, 'Документ/Разделы/Раздел4/Стр61/Гр2')
  #SG(R4_61_3, 'Документ/Разделы/Раздел4/Стр61/Гр3')
  #SG(R4_61_4, 'Документ/Разделы/Раздел4/Стр61/Гр4')
  #SG(R4_61_5, 'Документ/Разделы/Раздел4/Стр61/Гр5')
  #SG(R4_61_6, 'Документ/Разделы/Раздел4/Стр61/Гр6')
  #SG(R4_61_7, 'Документ/Разделы/Раздел4/Стр61/Гр7')

  #SG(R4_62_1, 'Документ/Разделы/Раздел4/Стр62/Гр1')
  #SG(R4_62_2, 'Документ/Разделы/Раздел4/Стр62/Гр2')
  #SG(R4_62_3, 'Документ/Разделы/Раздел4/Стр62/Гр3')
  #SG(R4_62_4, 'Документ/Разделы/Раздел4/Стр62/Гр4')
  #SG(R4_62_5, 'Документ/Разделы/Раздел4/Стр62/Гр5')
  #SG(R4_62_6, 'Документ/Разделы/Раздел4/Стр62/Гр6')
  #SG(R4_62_7, 'Документ/Разделы/Раздел4/Стр62/Гр7')

  #SG(R4_63_1, 'Документ/Разделы/Раздел4/Стр63/Гр1')
  #SG(R4_63_2, 'Документ/Разделы/Раздел4/Стр63/Гр2')
  #SG(R4_63_3, 'Документ/Разделы/Раздел4/Стр63/Гр3')
  #SG(R4_63_4, 'Документ/Разделы/Раздел4/Стр63/Гр4')
  #SG(R4_63_5, 'Документ/Разделы/Раздел4/Стр63/Гр5')
  #SG(R4_63_6, 'Документ/Разделы/Раздел4/Стр63/Гр6')
  #SG(R4_63_7, 'Документ/Разделы/Раздел4/Стр63/Гр7')
  //----------------------------------------------------------------------------------------------------------
  // #endregion ОБЪЯВЛЕНИЕ И ИНИЦИАЛИЗАЦИЯ ПЕРЕМЕННЫХ
  //----------------------------------------------------------------------------------------------------------

  isEndOfQuarter := (Month(TaxDat.dEnd) =  3) or
                    (Month(TaxDat.dEnd) =  6) or
                    (Month(TaxDat.dEnd) =  9) or
                    (Month(TaxDat.dEnd) = 12);

  isEndOfYear := (Month(TaxDat.dEnd) = 12);

  #_IsValid(IsValidNull   , 'Документ/НаимОрг'            , 'Наименование организации')
  #_IsValid(IsValidNull   , 'Документ/Адрес'              , 'Адрес'                   )
  #_IsValid(IsValidNull   , 'Документ/ОКПО'               , 'ОКПО'                    )
  #_IsValid(IsValidNull   , 'Документ/Тел'                , 'Телефон'                 )
  #_IsValid(IsValidNull   , 'Документ/E_Mail'             , 'E-mail'                  )
  #_IsValid(IsValidDate   , 'Документ/ДатаДок'            , 'Дата документа'          )
  #_IsValid(IsValidNull   , 'Документ/Подписант/Должность', 'Должность'               )
  #_IsValid(IsValidNull   , 'Документ/Подписант/ФИО'      , 'ФИО'                     )
  #_IsValid(IsValidPrimUSN, 'Документ/Разделы/ПримУСН'    , 'УСН'                     )

  //----------------------------------------------------------------------------------------------------------
  // #region КОНТРОЛЬНЫЕ ПАРАМЕТРЫ
  //----------------------------------------------------------------------------------------------------------
  //КП 01
  getMes := 'КП01: Гр. 1 >= гр. 2 (стр. с 03 по 27)';
  #KS(dR1_03_1 >= dR1_03_2, aR1_03_1, 'Стр. 03, гр. 1')
  #KS(dR1_05_1 >= dR1_05_2, aR1_05_1, 'Стр. 05, гр. 1')
  #KS(dR1_06_1 >= dR1_06_2, aR1_06_1, 'Стр. 06, гр. 1')
  #KS(dR1_07_1 >= dR1_07_2, aR1_07_1, 'Стр. 07, гр. 1')
  #KS(dR1_12_1 >= dR1_12_2, aR1_12_1, 'Стр. 12, гр. 1')
  #KS(dR1_13_1 >= dR1_13_2, aR1_13_1, 'Стр. 13, гр. 1')
  #KS(dR1_15_1 >= dR1_15_2, aR1_15_1, 'Стр. 15, гр. 1')
  #KS(dR1_18_1 >= dR1_18_2, aR1_18_1, 'Стр. 18, гр. 1')
  #KS(dR1_19_1 >= dR1_19_2, aR1_19_1, 'Стр. 19, гр. 1')
  #KS(dR1_20_1 >= dR1_20_2, aR1_20_1, 'Стр. 20, гр. 1')
  #KS(dR1_25_1 >= dR1_25_2, aR1_25_1, 'Стр. 25, гр. 1')
  #KS(dR1_26_1 >= dR1_26_2, aR1_26_1, 'Стр. 26, гр. 1')
  #KS(dR1_27_1 >= dR1_27_2, aR1_27_1, 'Стр. 27, гр. 1')

  //КП 02
  getMes := 'КП02: Стр. 05 <= стр. 03';
  #KS(dR1_05_1 <= dR1_03_1, aR1_05_1, 'Стр. 05, гр. 1')
  #KS(dR1_05_2 <= dR1_03_2, aR1_05_2, 'Стр. 05, гр. 2')

  //КП 03
  getMes := 'КП03: Стр. 05 >= стр. 06 + стр. 07';
  #KS(dR1_05_1 >= dR1_06_1 + dR1_07_1, aR1_05_1, 'Стр. 05, гр. 1')
  #KS(dR1_05_2 >= dR1_06_2 + dR1_07_2, aR1_05_2, 'Стр. 05, гр. 2')

  //КП 05
  getMes := 'КП05: Стр. 12 <= стр. 03';
  #KS(dR1_12_1 <= dR1_03_1, aR1_12_1, 'Стр. 12, гр. 1')
  #KS(dR1_12_2 <= dR1_03_2, aR1_12_2, 'Стр. 12, гр. 2')

  //КП 06
  getMes := 'КП06: Стр. 15 + стр. 18 + стр. 19 <= стр. 13';
  #KS(dR1_15_1 + dR1_18_1 + dR1_19_1 <= dR1_13_1, aR1_13_1, 'Стр. 13, гр. 1')
  #KS(dR1_15_2 + dR1_18_2 + dR1_19_2 <= dR1_13_2, aR1_13_2, 'Стр. 13, гр. 2')

  //КП 08
  getMes := 'КП08: Стр. 20 <= стр. 19';
  #KS(dR1_20_1 <= dR1_19_1, aR1_20_1, 'Стр. 20, гр. 1')
  #KS(dR1_20_2 <= dR1_19_2, aR1_20_2, 'Стр. 20, гр. 2')

  //КП 10
  getMes := 'КП10: Стр. 25 <= стр. 13';
  #KS(dR1_25_1 <= dR1_13_1, aR1_25_1, 'Стр. 25, гр. 1')
  #KS(dR1_25_2 <= dR1_13_2, aR1_25_2, 'Стр. 25, гр. 2')

  //КП 11
  getMes := 'КП11: Стр. 27 <= стр. 26';
  #KS(dR1_27_1 <= dR1_26_1, aR1_27_1, 'Стр. 27, гр. 1')
  #KS(dR1_27_2 <= dR1_26_2, aR1_27_2, 'Стр. 27, гр. 2')

  //КП 12
  getMes := 'КП12: Строки с 03 по стр. 27 >= 0';
  #KS(dR1_03_1 >= 0, aR1_03_1, 'Стр. 03, гр. 1')   #KS(dR1_03_2 >= 0, aR1_03_2, 'Стр. 03, гр. 2')
  #KS(dR1_05_1 >= 0, aR1_05_1, 'Стр. 05, гр. 1')   #KS(dR1_05_2 >= 0, aR1_05_2, 'Стр. 05, гр. 2')
  #KS(dR1_06_1 >= 0, aR1_06_1, 'Стр. 06, гр. 1')   #KS(dR1_06_2 >= 0, aR1_06_2, 'Стр. 06, гр. 2')
  #KS(dR1_07_1 >= 0, aR1_07_1, 'Стр. 07, гр. 1')   #KS(dR1_07_2 >= 0, aR1_07_2, 'Стр. 07, гр. 2')
  #KS(dR1_12_1 >= 0, aR1_12_1, 'Стр. 12, гр. 1')   #KS(dR1_12_2 >= 0, aR1_12_2, 'Стр. 12, гр. 2')
  #KS(dR1_13_1 >= 0, aR1_13_1, 'Стр. 13, гр. 1')   #KS(dR1_13_2 >= 0, aR1_13_2, 'Стр. 13, гр. 2')
  #KS(dR1_15_1 >= 0, aR1_15_1, 'Стр. 15, гр. 1')   #KS(dR1_15_2 >= 0, aR1_15_2, 'Стр. 15, гр. 2')
  #KS(dR1_18_1 >= 0, aR1_18_1, 'Стр. 18, гр. 1')   #KS(dR1_18_2 >= 0, aR1_18_2, 'Стр. 18, гр. 2')
  #KS(dR1_19_1 >= 0, aR1_19_1, 'Стр. 19, гр. 1')   #KS(dR1_19_2 >= 0, aR1_19_2, 'Стр. 19, гр. 2')
  #KS(dR1_20_1 >= 0, aR1_20_1, 'Стр. 20, гр. 1')   #KS(dR1_20_2 >= 0, aR1_20_2, 'Стр. 20, гр. 2')
  #KS(dR1_25_1 >= 0, aR1_25_1, 'Стр. 25, гр. 1')   #KS(dR1_25_2 >= 0, aR1_25_2, 'Стр. 25, гр. 2')
  #KS(dR1_26_1 >= 0, aR1_26_1, 'Стр. 26, гр. 1')   #KS(dR1_26_2 >= 0, aR1_26_2, 'Стр. 26, гр. 2')
  #KS(dR1_27_1 >= 0, aR1_27_1, 'Стр. 27, гр. 1')   #KS(dR1_27_2 >= 0, aR1_27_2, 'Стр. 27, гр. 2')

  //КП 30, 31
  #KSm(dR1_03_1 - dR1_05_1 >= dR1_03_2 - dR1_05_2, aR1_03_1, 'Стр. 03, гр. 1', 'КП30: Стр. 03 - стр. 05 по гр. 1 >= стр. 03 - стр. 05 по гр. 2')
  #KSm(dR1_03_1 - dR1_12_1 >= dR1_03_2 - dR1_12_2, aR1_03_1, 'Стр. 03, гр. 1', 'КП31: Стр. 03 - стр. 12 по гр. 1 >= стр. 03 - стр. 12 по гр. 2')

  //КП 32
  getMes := 'КП32: Стр. 05 - стр. 06 - стр. 07 по гр. 1 >= стр. 05 - стр. 06 - стр. 07 по гр. 2';
  #KS(dR1_05_1 - dR1_06_1 - dR1_07_1 >= dR1_05_2 - dR1_06_2 - dR1_07_2, aR1_05_1, 'Стр. 05, гр. 1')

  //КП 33
  getMes := 'КП33: Стр. 13 - стр. 15 - стр. 18 - стр. 19 по гр. 1 >= стр. 13 - стр. 15 - стр. 18 - стр. 19 по гр. 2';
  #KS(dR1_13_1 - dR1_15_1 - dR1_18_1 - dR1_19_1 >= dR1_13_2 - dR1_15_2 - dR1_18_2 - dR1_19_2, aR1_13_1, 'Стр. 13, гр. 1')

  //КП 34 - 37
  #KSm(dR1_13_1 - dR1_25_1 >= dR1_13_2 - dR1_25_2, aR1_13_1, 'Стр. 13, гр. 1', 'КП34: Стр. 13 - стр. 25 по гр. 1 >= стр. 13 - стр. 25 по гр. 2')
  #KSm(dR1_19_1 - dR1_20_1 >= dR1_19_2 - dR1_20_2, aR1_19_1, 'Стр. 19, гр. 1', 'КП35: Стр. 19 - стр. 20 по гр. 1 >= стр. 19 - стр. 20 по гр. 2')
  #KSm(dR1_26_1 - dR1_27_1 >= dR1_26_2 - dR1_27_2, aR1_26_1, 'Стр. 26, гр. 1', 'КП37: Стр. 26 - стр. 27 по гр. 1 >= стр. 26 - стр. 27 по гр. 2')

  // Если конец года
  if isEndOfYear
  {
    #KS(dR3_50a_1 >= 0, aR3_50a_1, 'Стр. 50.a, гр. 1')
    #KS(dR3_50a_2 >= 0, aR3_50a_2, 'Стр. 50.a, гр. 2')
  }
  else
  { // Если это не конец года -> рекомендация обнулить поле
    getMes := 'Поле заполняется только в конце года. Обнулите поле';

    #_KSm(aR3_50a_1, 'Стр. 50.a, гр. 1')
    #_KSm(aR3_50a_2, 'Стр. 50.a, гр. 1')
  }

  // Если конец квартала
  if isEndOfQuarter
  {
    //КП 13
    getMes := 'КП13: Стр. 33 = стр. 30 - стр. 31 - стр. 32';
    #KS(dR2_33_1 = dR2_30_1 - dR2_31_1 - dR2_32_1, aR2_33_1, 'Стр. 33, гр. 1')
    #KS(dR2_33_2 = dR2_30_2 - dR2_31_2 - dR2_32_2, aR2_33_2, 'Стр. 33, гр. 2')

    //КП 14
    getMes := 'КП14: Строки 30, 31, 32, 34, 35 >= 0';
    #KS(dR2_30_1 >= 0, aR2_30_1, 'Стр. 30, гр. 1')   #KS(dR2_30_2 >= 0, aR2_30_2, 'Стр. 30, гр. 2')
    #KS(dR2_31_1 >= 0, aR2_31_1, 'Стр. 31, гр. 1')   #KS(dR2_31_2 >= 0, aR2_31_2, 'Стр. 31, гр. 2')
    #KS(dR2_32_1 >= 0, aR2_32_1, 'Стр. 32, гр. 1')   #KS(dR2_32_2 >= 0, aR2_32_2, 'Стр. 32, гр. 2')
    #KS(dR2_34_1 >= 0, aR2_34_1, 'Стр. 34, гр. 1')   #KS(dR2_34_2 >= 0, aR2_34_2, 'Стр. 34, гр. 2')
    #KS(dR2_35_1 >= 0, aR2_35_1, 'Стр. 35, гр. 1')   #KS(dR2_35_2 >= 0, aR2_35_2, 'Стр. 35, гр. 2')

    //КП 15
    getMes := 'КП15: Стр. 36 гр. 1, 2 >= стр. 37 + стр. 39 + стр. 41';
    #KS(dR3_36_1 >= dR3_37_1 + dR3_39_1 + dR3_41_1, aR3_36_1, 'Стр. 36, гр. 1')
    #KS(dR3_36_2 >= dR3_37_2 + dR3_39_2 + dR3_41_2, aR3_36_2, 'Стр. 36, гр. 2')

    //КП 17
    getMes := 'КП16: Стр. 37 >= стр. 38';
    #KS(dR3_37_1 >= dR3_38_1, aR3_37_1, 'Стр. 37, гр. 1')
    #KS(dR3_37_2 >= dR3_38_2, aR3_37_2, 'Стр. 37, гр. 2')

    //КП 17
    getMes := 'КП17: Стр. 39 >= стр. 40';
    #KS(dR3_39_1 >= dR3_40_1, aR3_39_1, 'Стр. 39, гр. 1')
    #KS(dR3_39_2 >= dR3_40_2, aR3_39_2, 'Стр. 39, гр. 2')

    //КП 18
    getMes := 'КП18: Стр. 42 гр. 1 >= стр. 43 + стр. 48 + стр. 49 + стр. 50 + стр. 12 гр. 1';
    #KS(dR3_42_1 >= dR3_43_1 + dR3_48_1 + dR3_49_1 + dR3_50_1 + dR1_12_1, aR3_42_1, 'Стр. 42, гр. 1')

    //КП 19
    getMes := 'КП19: Стр. 42 гр. 2 >= стр. 43 + стр. 48 + стр. 49 + стр. 50 гр. 2';
    #KS(dR3_42_2 >= dR3_43_2 + dR3_48_2 + dR3_49_2 + dR3_50_2, aR3_42_2, 'Стр. 42, гр. 2')

    //КП 20
    getMes := 'КП20: Стр. 43 гр. 1, 2 >= стр. 44 + стр. 45 + стр. 46 + стр. 47 гр. 1, 2';
    #KS(dR3_43_1 >= dR3_44_1 + dR3_45_1 + dR3_46_1 + dR3_47_1, aR3_43_1, 'Стр. 43, гр. 1')
    #KS(dR3_43_2 >= dR3_44_2 + dR3_45_2 + dR3_46_2 + dR3_47_2, aR3_43_2, 'Стр. 43, гр. 2')

    //КП 21
    getMes := 'КП21: Стр. 36 по стр. 50 >= 0';
    #KS(dR3_36_1  >= 0, aR3_36_1 , 'Стр. 36, гр. 1' )   #KS(dR3_36_2  >= 0, aR3_36_2 , 'Стр. 36, гр. 2' )
    #KS(dR3_37_1  >= 0, aR3_37_1 , 'Стр. 37, гр. 1' )   #KS(dR3_37_2  >= 0, aR3_37_2 , 'Стр. 37, гр. 2' )
    #KS(dR3_38_1  >= 0, aR3_38_1 , 'Стр. 38, гр. 1' )   #KS(dR3_38_2  >= 0, aR3_38_2 , 'Стр. 38, гр. 2' )
    #KS(dR3_39_1  >= 0, aR3_39_1 , 'Стр. 39, гр. 1' )   #KS(dR3_39_2  >= 0, aR3_39_2 , 'Стр. 39, гр. 2' )
    #KS(dR3_40_1  >= 0, aR3_40_1 , 'Стр. 40, гр. 1' )   #KS(dR3_40_2  >= 0, aR3_40_2 , 'Стр. 40, гр. 2' )
    #KS(dR3_41_1  >= 0, aR3_41_1 , 'Стр. 41, гр. 1' )   #KS(dR3_41_2  >= 0, aR3_41_2 , 'Стр. 41, гр. 2' )
    #KS(dR3_42_1  >= 0, aR3_42_1 , 'Стр. 42, гр. 1' )   #KS(dR3_42_2  >= 0, aR3_42_2 , 'Стр. 42, гр. 2' )
    #KS(dR3_43_1  >= 0, aR3_43_1 , 'Стр. 43, гр. 1' )   #KS(dR3_43_2  >= 0, aR3_43_2 , 'Стр. 43, гр. 2' )
    #KS(dR3_44_1  >= 0, aR3_44_1 , 'Стр. 44, гр. 1' )   #KS(dR3_44_2  >= 0, aR3_44_2 , 'Стр. 44, гр. 2' )
    #KS(dR3_45_1  >= 0, aR3_45_1 , 'Стр. 45, гр. 1' )   #KS(dR3_45_2  >= 0, aR3_45_2 , 'Стр. 45, гр. 2' )
    #KS(dR3_46_1  >= 0, aR3_46_1 , 'Стр. 46, гр. 1' )   #KS(dR3_46_2  >= 0, aR3_46_2 , 'Стр. 46, гр. 2' )
    #KS(dR3_47_1  >= 0, aR3_47_1 , 'Стр. 47, гр. 1' )   #KS(dR3_47_2  >= 0, aR3_47_2 , 'Стр. 47, гр. 2' )
    #KS(dR3_48_1  >= 0, aR3_48_1 , 'Стр. 48, гр. 1' )   #KS(dR3_48_2  >= 0, aR3_48_2 , 'Стр. 48, гр. 2' )
    #KS(dR3_49_1  >= 0, aR3_49_1 , 'Стр. 49, гр. 1' )   #KS(dR3_49_2  >= 0, aR3_49_2 , 'Стр. 49, гр. 2' )
    #KS(dR3_50_1  >= 0, aR3_50_1 , 'Стр. 50, гр. 1' )   #KS(dR3_50_2  >= 0, aR3_50_2 , 'Стр. 50, гр. 2' )

    //КП 22
    getMes := 'КП22: Стр. 52 = сумме строк с стр. 53 по стр. 62 гр. с 1 по 7';
    #KS(dR4_52_1 = dR4_53_1 + dR4_54_1 + dR4_55_1 + dR4_56_1 + dR4_57_1 + dR4_58_1 + dR4_59_1 + dR4_60_1 + dR4_61_1 + dR4_62_1, aR4_52_1, 'Стр. 52, гр. 1')
    #KS(dR4_52_2 = dR4_53_2 + dR4_54_2 + dR4_55_2 + dR4_56_2 + dR4_57_2 + dR4_58_2 + dR4_59_2 + dR4_60_2 + dR4_61_2 + dR4_62_2, aR4_52_2, 'Стр. 52, гр. 2')
    #KS(dR4_52_3 = dR4_53_3 + dR4_54_3 + dR4_55_3 + dR4_56_3 + dR4_57_3 + dR4_58_3 + dR4_59_3 + dR4_60_3 + dR4_61_3 + dR4_62_3, aR4_52_3, 'Стр. 52, гр. 3')
    #KS(dR4_52_4 = dR4_53_4 + dR4_54_4 + dR4_55_4 + dR4_56_4 + dR4_57_4 + dR4_58_4 + dR4_59_4 + dR4_60_4 + dR4_61_4 + dR4_62_4, aR4_52_4, 'Стр. 52, гр. 4')
    #KS(dR4_52_5 = dR4_53_5 + dR4_54_5 + dR4_55_5 + dR4_56_5 + dR4_57_5 + dR4_58_5 + dR4_59_5 + dR4_60_5 + dR4_61_5 + dR4_62_5, aR4_52_5, 'Стр. 52, гр. 5')
    #KS(dR4_52_6 = dR4_53_6 + dR4_54_6 + dR4_55_6 + dR4_56_6 + dR4_57_6 + dR4_58_6 + dR4_59_6 + dR4_60_6 + dR4_61_6 + dR4_62_6, aR4_52_6, 'Стр. 52, гр. 6')
    #KS(dR4_52_7 = dR4_53_7 + dR4_54_7 + dR4_55_7 + dR4_56_7 + dR4_57_7 + dR4_58_7 + dR4_59_7 + dR4_60_7 + dR4_61_7 + dR4_62_7, aR4_52_7, 'Стр. 52, гр. 7')

    //КП 23 - 28
    #KSm(dR1_05_1 = (dR4_51_2 + dR4_52_2 + dR4_63_2), aR1_05_1, 'Стр. 05, гр. 1', 'КП23: Стр. 05 гр. 1 = (стр. 51 + стр. 52 + стр. 63) гр. 2')
    #KSm(dR1_19_1 = (dR4_51_4 + dR4_52_4 + dR4_63_4), aR1_19_1, 'Стр. 19, гр. 1', 'КП24: Стр. 19 гр. 1 = (стр. 51 + стр. 52 + стр. 63) гр. 4')
    #KSm(dR1_26_1 = (dR4_51_6 + dR4_52_6 + dR4_63_6), aR1_26_1, 'Стр. 26, гр. 1', 'КП25: Стр. 26 гр. 1 = (стр. 51 + стр. 52 + стр. 63) гр. 6')
    #KSm(dR1_05_2 = (dR4_51_3 + dR4_52_3 + dR4_63_3), aR1_05_2, 'Стр. 05, гр. 2', 'КП26: Стр. 05 гр. 2 = (стр. 51 + стр. 52 + стр. 63) гр. 3')
    #KSm(dR1_19_2 = (dR4_51_5 + dR4_52_5 + dR4_63_5), aR1_19_2, 'Стр. 19, гр. 2', 'КП27: Стр. 19 гр. 2 = (стр. 51 + стр. 52 + стр. 63) гр. 5')
    #KSm(dR1_26_2 = (dR4_51_7 + dR4_52_7 + dR4_63_7), aR1_26_2, 'Стр. 26, гр. 2', 'КП28: Стр. 26 гр. 2 = (стр. 51 + стр. 52 + стр. 63) гр. 7')
  }
  else
  { // Если это не конец квартала -> рекомендация обнулить поле
    getMes := 'Поле заполняется только в конце квартала. Обнулите поле';

    // Раздел 2
    #_KSm(aR2_30_1, 'Стр. 30, гр. 1')   #_KSm(aR2_30_2, 'Стр. 30, гр. 2')
    #_KSm(aR2_31_1, 'Стр. 31, гр. 1')   #_KSm(aR2_31_2, 'Стр. 31, гр. 2')
    #_KSm(aR2_32_1, 'Стр. 32, гр. 1')   #_KSm(aR2_32_2, 'Стр. 32, гр. 2')
    #_KSm(aR2_33_1, 'Стр. 33, гр. 1')   #_KSm(aR2_33_2, 'Стр. 33, гр. 2')
    #_KSm(aR2_34_1, 'Стр. 34, гр. 1')   #_KSm(aR2_34_2, 'Стр. 34, гр. 2')
    #_KSm(aR2_35_1, 'Стр. 35, гр. 1')   #_KSm(aR2_35_2, 'Стр. 35, гр. 2')

    // Раздел 3
    #_KSm(aR3_36_1, 'Стр. 36, гр. 1')   #_KSm(aR3_36_2, 'Стр. 36, гр. 2')
    #_KSm(aR3_37_1, 'Стр. 37, гр. 1')   #_KSm(aR3_37_2, 'Стр. 37, гр. 2')
    #_KSm(aR3_38_1, 'Стр. 38, гр. 1')   #_KSm(aR3_38_2, 'Стр. 38, гр. 2')
    #_KSm(aR3_39_1, 'Стр. 39, гр. 1')   #_KSm(aR3_39_2, 'Стр. 39, гр. 2')
    #_KSm(aR3_40_1, 'Стр. 40, гр. 1')   #_KSm(aR3_40_2, 'Стр. 40, гр. 2')
    #_KSm(aR3_41_1, 'Стр. 41, гр. 1')   #_KSm(aR3_41_2, 'Стр. 41, гр. 2')
    #_KSm(aR3_42_1, 'Стр. 42, гр. 1')   #_KSm(aR3_42_2, 'Стр. 42, гр. 2')
    #_KSm(aR3_43_1, 'Стр. 43, гр. 1')   #_KSm(aR3_43_2, 'Стр. 43, гр. 2')
    #_KSm(aR3_44_1, 'Стр. 44, гр. 1')   #_KSm(aR3_44_2, 'Стр. 44, гр. 2')
    #_KSm(aR3_45_1, 'Стр. 45, гр. 1')   #_KSm(aR3_45_2, 'Стр. 45, гр. 2')
    #_KSm(aR3_46_1, 'Стр. 46, гр. 1')   #_KSm(aR3_46_2, 'Стр. 46, гр. 2')
    #_KSm(aR3_47_1, 'Стр. 47, гр. 1')   #_KSm(aR3_47_2, 'Стр. 47, гр. 2')
    #_KSm(aR3_48_1, 'Стр. 48, гр. 1')   #_KSm(aR3_48_2, 'Стр. 48, гр. 2')
    #_KSm(aR3_49_1, 'Стр. 49, гр. 1')   #_KSm(aR3_49_2, 'Стр. 49, гр. 2')
    #_KSm(aR3_50_1, 'Стр. 50, гр. 1')   #_KSm(aR3_50_2, 'Стр. 50, гр. 2')

    // Раздел 4
    #_KSm(aR4_51_1, 'Стр. 51, гр. 1') #_KSm(aR4_51_2, 'Стр. 51, гр. 2') #_KSm(aR4_51_3, 'Стр. 51, гр. 3') #_KSm(aR4_51_4, 'Стр. 51, гр. 4') #_KSm(aR4_51_5, 'Стр. 51, гр. 5') #_KSm(aR4_51_6, 'Стр. 51, гр. 6') #_KSm(aR4_51_7, 'Стр. 51, гр. 7')
    #_KSm(aR4_52_1, 'Стр. 52, гр. 1') #_KSm(aR4_52_2, 'Стр. 52, гр. 2') #_KSm(aR4_52_3, 'Стр. 52, гр. 3') #_KSm(aR4_52_4, 'Стр. 52, гр. 4') #_KSm(aR4_52_5, 'Стр. 52, гр. 5') #_KSm(aR4_52_6, 'Стр. 52, гр. 6') #_KSm(aR4_52_7, 'Стр. 52, гр. 7')
    #_KSm(aR4_53_1, 'Стр. 53, гр. 1') #_KSm(aR4_53_2, 'Стр. 53, гр. 2') #_KSm(aR4_53_3, 'Стр. 53, гр. 3') #_KSm(aR4_53_4, 'Стр. 53, гр. 4') #_KSm(aR4_53_5, 'Стр. 53, гр. 5') #_KSm(aR4_53_6, 'Стр. 53, гр. 6') #_KSm(aR4_53_7, 'Стр. 53, гр. 7')
    #_KSm(aR4_54_1, 'Стр. 54, гр. 1') #_KSm(aR4_54_2, 'Стр. 54, гр. 2') #_KSm(aR4_54_3, 'Стр. 54, гр. 3') #_KSm(aR4_54_4, 'Стр. 54, гр. 4') #_KSm(aR4_54_5, 'Стр. 54, гр. 5') #_KSm(aR4_54_6, 'Стр. 54, гр. 6') #_KSm(aR4_54_7, 'Стр. 54, гр. 7')
    #_KSm(aR4_55_1, 'Стр. 55, гр. 1') #_KSm(aR4_55_2, 'Стр. 55, гр. 2') #_KSm(aR4_55_3, 'Стр. 55, гр. 3') #_KSm(aR4_55_4, 'Стр. 55, гр. 4') #_KSm(aR4_55_5, 'Стр. 55, гр. 5') #_KSm(aR4_55_6, 'Стр. 55, гр. 6') #_KSm(aR4_55_7, 'Стр. 55, гр. 7')
    #_KSm(aR4_56_1, 'Стр. 56, гр. 1') #_KSm(aR4_56_2, 'Стр. 56, гр. 2') #_KSm(aR4_56_3, 'Стр. 56, гр. 3') #_KSm(aR4_56_4, 'Стр. 56, гр. 4') #_KSm(aR4_56_5, 'Стр. 56, гр. 5') #_KSm(aR4_56_6, 'Стр. 56, гр. 6') #_KSm(aR4_56_7, 'Стр. 56, гр. 7')
    #_KSm(aR4_57_1, 'Стр. 57, гр. 1') #_KSm(aR4_57_2, 'Стр. 57, гр. 2') #_KSm(aR4_57_3, 'Стр. 57, гр. 3') #_KSm(aR4_57_4, 'Стр. 57, гр. 4') #_KSm(aR4_57_5, 'Стр. 57, гр. 5') #_KSm(aR4_57_6, 'Стр. 57, гр. 6') #_KSm(aR4_57_7, 'Стр. 57, гр. 7')
    #_KSm(aR4_58_1, 'Стр. 58, гр. 1') #_KSm(aR4_58_2, 'Стр. 58, гр. 2') #_KSm(aR4_58_3, 'Стр. 58, гр. 3') #_KSm(aR4_58_4, 'Стр. 58, гр. 4') #_KSm(aR4_58_5, 'Стр. 58, гр. 5') #_KSm(aR4_58_6, 'Стр. 58, гр. 6') #_KSm(aR4_58_7, 'Стр. 58, гр. 7')
    #_KSm(aR4_59_1, 'Стр. 59, гр. 1') #_KSm(aR4_59_2, 'Стр. 59, гр. 2') #_KSm(aR4_59_3, 'Стр. 59, гр. 3') #_KSm(aR4_59_4, 'Стр. 59, гр. 4') #_KSm(aR4_59_5, 'Стр. 59, гр. 5') #_KSm(aR4_59_6, 'Стр. 59, гр. 6') #_KSm(aR4_59_7, 'Стр. 59, гр. 7')
    #_KSm(aR4_60_1, 'Стр. 60, гр. 1') #_KSm(aR4_60_2, 'Стр. 60, гр. 2') #_KSm(aR4_60_3, 'Стр. 60, гр. 3') #_KSm(aR4_60_4, 'Стр. 60, гр. 4') #_KSm(aR4_60_5, 'Стр. 60, гр. 5') #_KSm(aR4_60_6, 'Стр. 60, гр. 6') #_KSm(aR4_60_7, 'Стр. 60, гр. 7')
    #_KSm(aR4_61_1, 'Стр. 61, гр. 1') #_KSm(aR4_61_2, 'Стр. 61, гр. 2') #_KSm(aR4_61_3, 'Стр. 61, гр. 3') #_KSm(aR4_61_4, 'Стр. 61, гр. 4') #_KSm(aR4_61_5, 'Стр. 61, гр. 5') #_KSm(aR4_61_6, 'Стр. 61, гр. 6') #_KSm(aR4_61_7, 'Стр. 61, гр. 7')
    #_KSm(aR4_62_1, 'Стр. 62, гр. 1') #_KSm(aR4_62_2, 'Стр. 62, гр. 2') #_KSm(aR4_62_3, 'Стр. 62, гр. 3') #_KSm(aR4_62_4, 'Стр. 62, гр. 4') #_KSm(aR4_62_5, 'Стр. 62, гр. 5') #_KSm(aR4_62_6, 'Стр. 62, гр. 6') #_KSm(aR4_62_7, 'Стр. 62, гр. 7')
    #_KSm(aR4_63_1, 'Стр. 63, гр. 1') #_KSm(aR4_63_2, 'Стр. 63, гр. 2') #_KSm(aR4_63_3, 'Стр. 63, гр. 3') #_KSm(aR4_63_4, 'Стр. 63, гр. 4') #_KSm(aR4_63_5, 'Стр. 63, гр. 5') #_KSm(aR4_63_6, 'Стр. 63, гр. 6') #_KSm(aR4_63_7, 'Стр. 63, гр. 7')
  }
  //----------------------------------------------------------------------------------------------------------
  // #endregion КОНТРОЛЬНЫЕ ПАРАМЕТРЫ
  //----------------------------------------------------------------------------------------------------------
@end.
//#endregion ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ПРОВЕРКЕ
//************************************************************************************************************


//============================================================================================================
//#region ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ РАСЧЕТЕ
//------------------------------------------------------------------------------------------------------------
@Script On_Recalc : Boolean;
  //==========================================================================================================
  //#region СЕРВИС
  //----------------------------------------------------------------------------------------------------------
  #undef SG
  #declare SG(_Name, _Adr)
    a#_Name := #_Adr;
    d#_Name := GetDblVal(a#_Name);
  #end

  procedure Log(_strAdr, _strMes, _strVal : string);
  { MesError.InsertRasch('', _strAdr, _strMes, _strVal); }

  function GV(_strAdr : string) : string;
  { Result := GetStrValFormat(_strAdr); }

  procedure SV(_adr : string; var _val : double);
  {
    XMLMAP.SetVariantAttrValueByName_Formula(_adr, Round(_val), 2);
    _val := GetDblVal(_adr);
  }
  //#endregion СЕРВИС
  //**********************************************************************************************************
@begin
  Result := False;

  //Документ
  if ((GetStrVal('Документ/ДатаДок') = '') or (GetStrVal('Документ/ДатаДок') = 'DD mon YYYY'))
     SetFldVal('Документ/ДатаДок', DateToStr(Cur_Date, 'DD mon YYYY'));

  //----------------------------------------------------------------------------------------------------------
  // #region ОБЪЯВЛЕНИЕ И ИНИЦИАЛИЗАЦИЯ ПЕРЕМЕННЫХ
  //----------------------------------------------------------------------------------------------------------
  var isEndOfQuarter : Boolean;
  var
  // Раздел 1
    aR1_01_1, aR1_02_1, aR1_03_1, aR1_03_2, aR1_05_1, aR1_05_2, aR1_06_1, aR1_06_2, aR1_07_1, aR1_07_2, aR1_12_1, aR1_12_2, aR1_13_1, aR1_13_2, aR1_15_1, aR1_15_2, aR1_18_1
  , aR1_18_2, aR1_19_1, aR1_19_2, aR1_20_1, aR1_20_2, aR1_25_1, aR1_25_2, aR1_26_1, aR1_26_2, aR1_27_1, aR1_27_2
  // Раздел 2
  , aR2_30_1, aR2_30_2, aR2_31_1, aR2_31_2, aR2_32_1, aR2_32_2, aR2_33_1, aR2_33_2, aR2_34_1, aR2_34_2, aR2_35_1, aR2_35_2
  // Раздел 3
  , aR3_36_1, aR3_36_2, aR3_37_1, aR3_37_2, aR3_38_1, aR3_38_2, aR3_39_1, aR3_39_2, aR3_40_1, aR3_40_2, aR3_41_1, aR3_41_2, aR3_42_1, aR3_42_2, aR3_43_1, aR3_43_2, aR3_44_1
  , aR3_44_2, aR3_45_1, aR3_45_2, aR3_46_1, aR3_46_2, aR3_47_1, aR3_47_2, aR3_48_1, aR3_48_2, aR3_49_1, aR3_49_2, aR3_50_1, aR3_50_2, aR3_50a_1, aR3_50a_2
  // Раздел 4
  , aR4_51_1, aR4_51_2, aR4_51_3, aR4_51_4, aR4_51_5, aR4_51_6, aR4_51_7
  , aR4_52_1, aR4_52_2, aR4_52_3, aR4_52_4, aR4_52_5, aR4_52_6, aR4_52_7
  , aR4_53_1, aR4_53_2, aR4_53_3, aR4_53_4, aR4_53_5, aR4_53_6, aR4_53_7
  , aR4_54_1, aR4_54_2, aR4_54_3, aR4_54_4, aR4_54_5, aR4_54_6, aR4_54_7
  , aR4_55_1, aR4_55_2, aR4_55_3, aR4_55_4, aR4_55_5, aR4_55_6, aR4_55_7
  , aR4_56_1, aR4_56_2, aR4_56_3, aR4_56_4, aR4_56_5, aR4_56_6, aR4_56_7
  , aR4_57_1, aR4_57_2, aR4_57_3, aR4_57_4, aR4_57_5, aR4_57_6, aR4_57_7
  , aR4_58_1, aR4_58_2, aR4_58_3, aR4_58_4, aR4_58_5, aR4_58_6, aR4_58_7
  , aR4_59_1, aR4_59_2, aR4_59_3, aR4_59_4, aR4_59_5, aR4_59_6, aR4_59_7
  , aR4_60_1, aR4_60_2, aR4_60_3, aR4_60_4, aR4_60_5, aR4_60_6, aR4_60_7
  , aR4_61_1, aR4_61_2, aR4_61_3, aR4_61_4, aR4_61_5, aR4_61_6, aR4_61_7
  , aR4_62_1, aR4_62_2, aR4_62_3, aR4_62_4, aR4_62_5, aR4_62_6, aR4_62_7
  , aR4_63_1, aR4_63_2, aR4_63_3, aR4_63_4, aR4_63_5, aR4_63_6, aR4_63_7 : string;

  var
    a2, b2, c2, a4, b4, c4, a401, b401, a402, b402, c402, d402
  // Раздел 1
  , dR1_01_1, dR1_02_1, dR1_03_1, dR1_03_2, dR1_05_1, dR1_05_2, dR1_06_1, dR1_06_2, dR1_07_1, dR1_07_2, dR1_12_1, dR1_12_2, dR1_13_1, dR1_13_2, dR1_15_1, dR1_15_2, dR1_18_1
  , dR1_18_2, dR1_19_1, dR1_19_2, dR1_20_1, dR1_20_2, dR1_25_1, dR1_25_2, dR1_26_1, dR1_26_2, dR1_27_1, dR1_27_2
  // Раздел 2
  , dR2_30_1, dR2_30_2, dR2_31_1, dR2_31_2, dR2_32_1, dR2_32_2, dR2_33_1, dR2_33_2, dR2_34_1, dR2_34_2, dR2_35_1, dR2_35_2
  // Раздел 3
  , dR3_36_1, dR3_36_2, dR3_37_1, dR3_37_2, dR3_38_1, dR3_38_2, dR3_39_1, dR3_39_2, dR3_40_1, dR3_40_2, dR3_41_1, dR3_41_2, dR3_42_1, dR3_42_2, dR3_43_1, dR3_43_2, dR3_44_1
  , dR3_44_2, dR3_45_1, dR3_45_2, dR3_46_1, dR3_46_2, dR3_47_1, dR3_47_2, dR3_48_1, dR3_48_2, dR3_49_1, dR3_49_2, dR3_50_1, dR3_50_2, dR3_50a_1, dR3_50a_2
  // Раздел 4
  , dR4_51_1, dR4_51_2, dR4_51_3, dR4_51_4, dR4_51_5, dR4_51_6, dR4_51_7
  , dR4_52_1, dR4_52_2, dR4_52_3, dR4_52_4, dR4_52_5, dR4_52_6, dR4_52_7
  , dR4_53_1, dR4_53_2, dR4_53_3, dR4_53_4, dR4_53_5, dR4_53_6, dR4_53_7
  , dR4_54_1, dR4_54_2, dR4_54_3, dR4_54_4, dR4_54_5, dR4_54_6, dR4_54_7
  , dR4_55_1, dR4_55_2, dR4_55_3, dR4_55_4, dR4_55_5, dR4_55_6, dR4_55_7
  , dR4_56_1, dR4_56_2, dR4_56_3, dR4_56_4, dR4_56_5, dR4_56_6, dR4_56_7
  , dR4_57_1, dR4_57_2, dR4_57_3, dR4_57_4, dR4_57_5, dR4_57_6, dR4_57_7
  , dR4_58_1, dR4_58_2, dR4_58_3, dR4_58_4, dR4_58_5, dR4_58_6, dR4_58_7
  , dR4_59_1, dR4_59_2, dR4_59_3, dR4_59_4, dR4_59_5, dR4_59_6, dR4_59_7
  , dR4_60_1, dR4_60_2, dR4_60_3, dR4_60_4, dR4_60_5, dR4_60_6, dR4_60_7
  , dR4_61_1, dR4_61_2, dR4_61_3, dR4_61_4, dR4_61_5, dR4_61_6, dR4_61_7
  , dR4_62_1, dR4_62_2, dR4_62_3, dR4_62_4, dR4_62_5, dR4_62_6, dR4_62_7
  , dR4_63_1, dR4_63_2, dR4_63_3, dR4_63_4, dR4_63_5, dR4_63_6, dR4_63_7 : double;

  // Раздел 1
  #SG(R1_01_1, 'Документ/Разделы/Раздел1/Стр01/Гр1')
  #SG(R1_02_1, 'Документ/Разделы/Раздел1/Стр02/Гр1')
  #SG(R1_03_1, 'Документ/Разделы/Раздел1/Стр03/Гр1')   #SG(R1_03_2, 'Документ/Разделы/Раздел1/Стр03/Гр2')
  #SG(R1_05_1, 'Документ/Разделы/Раздел1/Стр05/Гр1')   #SG(R1_05_2, 'Документ/Разделы/Раздел1/Стр05/Гр2')
  #SG(R1_06_1, 'Документ/Разделы/Раздел1/Стр06/Гр1')   #SG(R1_06_2, 'Документ/Разделы/Раздел1/Стр06/Гр2')
  #SG(R1_07_1, 'Документ/Разделы/Раздел1/Стр07/Гр1')   #SG(R1_07_2, 'Документ/Разделы/Раздел1/Стр07/Гр2')
  #SG(R1_12_1, 'Документ/Разделы/Раздел1/Стр12/Гр1')   #SG(R1_12_2, 'Документ/Разделы/Раздел1/Стр12/Гр2')
  #SG(R1_13_1, 'Документ/Разделы/Раздел1/Стр13/Гр1')   #SG(R1_13_2, 'Документ/Разделы/Раздел1/Стр13/Гр2')
  #SG(R1_15_1, 'Документ/Разделы/Раздел1/Стр15/Гр1')   #SG(R1_15_2, 'Документ/Разделы/Раздел1/Стр15/Гр2')
  #SG(R1_18_1, 'Документ/Разделы/Раздел1/Стр18/Гр1')   #SG(R1_18_2, 'Документ/Разделы/Раздел1/Стр18/Гр2')
  #SG(R1_19_1, 'Документ/Разделы/Раздел1/Стр19/Гр1')   #SG(R1_19_2, 'Документ/Разделы/Раздел1/Стр19/Гр2')
  #SG(R1_20_1, 'Документ/Разделы/Раздел1/Стр20/Гр1')   #SG(R1_20_2, 'Документ/Разделы/Раздел1/Стр20/Гр2')
  #SG(R1_25_1, 'Документ/Разделы/Раздел1/Стр25/Гр1')   #SG(R1_25_2, 'Документ/Разделы/Раздел1/Стр25/Гр2')
  #SG(R1_26_1, 'Документ/Разделы/Раздел1/Стр26/Гр1')   #SG(R1_26_2, 'Документ/Разделы/Раздел1/Стр26/Гр2')
  #SG(R1_27_1, 'Документ/Разделы/Раздел1/Стр27/Гр1')   #SG(R1_27_2, 'Документ/Разделы/Раздел1/Стр27/Гр2')

  // Раздел 2
  #SG(R2_30_1, 'Документ/Разделы/Раздел2/Стр30/Гр1')   #SG(R2_30_2, 'Документ/Разделы/Раздел2/Стр30/Гр2')
  #SG(R2_31_1, 'Документ/Разделы/Раздел2/Стр31/Гр1')   #SG(R2_31_2, 'Документ/Разделы/Раздел2/Стр31/Гр2')
  #SG(R2_32_1, 'Документ/Разделы/Раздел2/Стр32/Гр1')   #SG(R2_32_2, 'Документ/Разделы/Раздел2/Стр32/Гр2')
  #SG(R2_33_1, 'Документ/Разделы/Раздел2/Стр33/Гр1')   #SG(R2_33_2, 'Документ/Разделы/Раздел2/Стр33/Гр2')
  #SG(R2_34_1, 'Документ/Разделы/Раздел2/Стр34/Гр1')   #SG(R2_34_2, 'Документ/Разделы/Раздел2/Стр34/Гр2')
  #SG(R2_35_1, 'Документ/Разделы/Раздел2/Стр35/Гр1')   #SG(R2_35_2, 'Документ/Разделы/Раздел2/Стр35/Гр2')

  // Раздел 3
  #SG(R3_36_1 , 'Документ/Разделы/Раздел3/Стр36/Гр1' )   #SG(R3_36_2 , 'Документ/Разделы/Раздел3/Стр36/Гр2' )
  #SG(R3_37_1 , 'Документ/Разделы/Раздел3/Стр37/Гр1' )   #SG(R3_37_2 , 'Документ/Разделы/Раздел3/Стр37/Гр2' )
  #SG(R3_38_1 , 'Документ/Разделы/Раздел3/Стр38/Гр1' )   #SG(R3_38_2 , 'Документ/Разделы/Раздел3/Стр38/Гр2' )
  #SG(R3_39_1 , 'Документ/Разделы/Раздел3/Стр39/Гр1' )   #SG(R3_39_2 , 'Документ/Разделы/Раздел3/Стр39/Гр2' )
  #SG(R3_40_1 , 'Документ/Разделы/Раздел3/Стр40/Гр1' )   #SG(R3_40_2 , 'Документ/Разделы/Раздел3/Стр40/Гр2' )
  #SG(R3_41_1 , 'Документ/Разделы/Раздел3/Стр41/Гр1' )   #SG(R3_41_2 , 'Документ/Разделы/Раздел3/Стр41/Гр2' )
  #SG(R3_42_1 , 'Документ/Разделы/Раздел3/Стр42/Гр1' )   #SG(R3_42_2 , 'Документ/Разделы/Раздел3/Стр42/Гр2' )
  #SG(R3_43_1 , 'Документ/Разделы/Раздел3/Стр43/Гр1' )   #SG(R3_43_2 , 'Документ/Разделы/Раздел3/Стр43/Гр2' )
  #SG(R3_44_1 , 'Документ/Разделы/Раздел3/Стр44/Гр1' )   #SG(R3_44_2 , 'Документ/Разделы/Раздел3/Стр44/Гр2' )
  #SG(R3_45_1 , 'Документ/Разделы/Раздел3/Стр45/Гр1' )   #SG(R3_45_2 , 'Документ/Разделы/Раздел3/Стр45/Гр2' )
  #SG(R3_46_1 , 'Документ/Разделы/Раздел3/Стр46/Гр1' )   #SG(R3_46_2 , 'Документ/Разделы/Раздел3/Стр46/Гр2' )
  #SG(R3_47_1 , 'Документ/Разделы/Раздел3/Стр47/Гр1' )   #SG(R3_47_2 , 'Документ/Разделы/Раздел3/Стр47/Гр2' )
  #SG(R3_48_1 , 'Документ/Разделы/Раздел3/Стр48/Гр1' )   #SG(R3_48_2 , 'Документ/Разделы/Раздел3/Стр48/Гр2' )
  #SG(R3_49_1 , 'Документ/Разделы/Раздел3/Стр49/Гр1' )   #SG(R3_49_2 , 'Документ/Разделы/Раздел3/Стр49/Гр2' )
  #SG(R3_50_1 , 'Документ/Разделы/Раздел3/Стр50/Гр1' )   #SG(R3_50_2 , 'Документ/Разделы/Раздел3/Стр50/Гр2' )
  #SG(R3_50a_1, 'Документ/Разделы/Раздел3/Стр50а/Гр1')   #SG(R3_50a_2, 'Документ/Разделы/Раздел3/Стр50а/Гр2')

  // Раздел 4
  #SG(R4_51_1, 'Документ/Разделы/Раздел4/Стр51/Гр1')
  #SG(R4_51_2, 'Документ/Разделы/Раздел4/Стр51/Гр2')
  #SG(R4_51_3, 'Документ/Разделы/Раздел4/Стр51/Гр3')
  #SG(R4_51_4, 'Документ/Разделы/Раздел4/Стр51/Гр4')
  #SG(R4_51_5, 'Документ/Разделы/Раздел4/Стр51/Гр5')
  #SG(R4_51_6, 'Документ/Разделы/Раздел4/Стр51/Гр6')
  #SG(R4_51_7, 'Документ/Разделы/Раздел4/Стр51/Гр7')

  #SG(R4_52_1, 'Документ/Разделы/Раздел4/Стр52/Гр1')
  #SG(R4_52_2, 'Документ/Разделы/Раздел4/Стр52/Гр2')
  #SG(R4_52_3, 'Документ/Разделы/Раздел4/Стр52/Гр3')
  #SG(R4_52_4, 'Документ/Разделы/Раздел4/Стр52/Гр4')
  #SG(R4_52_5, 'Документ/Разделы/Раздел4/Стр52/Гр5')
  #SG(R4_52_6, 'Документ/Разделы/Раздел4/Стр52/Гр6')
  #SG(R4_52_7, 'Документ/Разделы/Раздел4/Стр52/Гр7')

  #SG(R4_53_1, 'Документ/Разделы/Раздел4/Стр53/Гр1')
  #SG(R4_53_2, 'Документ/Разделы/Раздел4/Стр53/Гр2')
  #SG(R4_53_3, 'Документ/Разделы/Раздел4/Стр53/Гр3')
  #SG(R4_53_4, 'Документ/Разделы/Раздел4/Стр53/Гр4')
  #SG(R4_53_5, 'Документ/Разделы/Раздел4/Стр53/Гр5')
  #SG(R4_53_6, 'Документ/Разделы/Раздел4/Стр53/Гр6')
  #SG(R4_53_7, 'Документ/Разделы/Раздел4/Стр53/Гр7')

  #SG(R4_54_1, 'Документ/Разделы/Раздел4/Стр54/Гр1')
  #SG(R4_54_2, 'Документ/Разделы/Раздел4/Стр54/Гр2')
  #SG(R4_54_3, 'Документ/Разделы/Раздел4/Стр54/Гр3')
  #SG(R4_54_4, 'Документ/Разделы/Раздел4/Стр54/Гр4')
  #SG(R4_54_5, 'Документ/Разделы/Раздел4/Стр54/Гр5')
  #SG(R4_54_6, 'Документ/Разделы/Раздел4/Стр54/Гр6')
  #SG(R4_54_7, 'Документ/Разделы/Раздел4/Стр54/Гр7')

  #SG(R4_55_1, 'Документ/Разделы/Раздел4/Стр55/Гр1')
  #SG(R4_55_2, 'Документ/Разделы/Раздел4/Стр55/Гр2')
  #SG(R4_55_3, 'Документ/Разделы/Раздел4/Стр55/Гр3')
  #SG(R4_55_4, 'Документ/Разделы/Раздел4/Стр55/Гр4')
  #SG(R4_55_5, 'Документ/Разделы/Раздел4/Стр55/Гр5')
  #SG(R4_55_6, 'Документ/Разделы/Раздел4/Стр55/Гр6')
  #SG(R4_55_7, 'Документ/Разделы/Раздел4/Стр55/Гр7')

  #SG(R4_56_1, 'Документ/Разделы/Раздел4/Стр56/Гр1')
  #SG(R4_56_2, 'Документ/Разделы/Раздел4/Стр56/Гр2')
  #SG(R4_56_3, 'Документ/Разделы/Раздел4/Стр56/Гр3')
  #SG(R4_56_4, 'Документ/Разделы/Раздел4/Стр56/Гр4')
  #SG(R4_56_5, 'Документ/Разделы/Раздел4/Стр56/Гр5')
  #SG(R4_56_6, 'Документ/Разделы/Раздел4/Стр56/Гр6')
  #SG(R4_56_7, 'Документ/Разделы/Раздел4/Стр56/Гр7')

  #SG(R4_57_1, 'Документ/Разделы/Раздел4/Стр57/Гр1')
  #SG(R4_57_2, 'Документ/Разделы/Раздел4/Стр57/Гр2')
  #SG(R4_57_3, 'Документ/Разделы/Раздел4/Стр57/Гр3')
  #SG(R4_57_4, 'Документ/Разделы/Раздел4/Стр57/Гр4')
  #SG(R4_57_5, 'Документ/Разделы/Раздел4/Стр57/Гр5')
  #SG(R4_57_6, 'Документ/Разделы/Раздел4/Стр57/Гр6')
  #SG(R4_57_7, 'Документ/Разделы/Раздел4/Стр57/Гр7')

  #SG(R4_58_1, 'Документ/Разделы/Раздел4/Стр58/Гр1')
  #SG(R4_58_2, 'Документ/Разделы/Раздел4/Стр58/Гр2')
  #SG(R4_58_3, 'Документ/Разделы/Раздел4/Стр58/Гр3')
  #SG(R4_58_4, 'Документ/Разделы/Раздел4/Стр58/Гр4')
  #SG(R4_58_5, 'Документ/Разделы/Раздел4/Стр58/Гр5')
  #SG(R4_58_6, 'Документ/Разделы/Раздел4/Стр58/Гр6')
  #SG(R4_58_7, 'Документ/Разделы/Раздел4/Стр58/Гр7')

  #SG(R4_59_1, 'Документ/Разделы/Раздел4/Стр59/Гр1')
  #SG(R4_59_2, 'Документ/Разделы/Раздел4/Стр59/Гр2')
  #SG(R4_59_3, 'Документ/Разделы/Раздел4/Стр59/Гр3')
  #SG(R4_59_4, 'Документ/Разделы/Раздел4/Стр59/Гр4')
  #SG(R4_59_5, 'Документ/Разделы/Раздел4/Стр59/Гр5')
  #SG(R4_59_6, 'Документ/Разделы/Раздел4/Стр59/Гр6')
  #SG(R4_59_7, 'Документ/Разделы/Раздел4/Стр59/Гр7')

  #SG(R4_60_1, 'Документ/Разделы/Раздел4/Стр60/Гр1')
  #SG(R4_60_2, 'Документ/Разделы/Раздел4/Стр60/Гр2')
  #SG(R4_60_3, 'Документ/Разделы/Раздел4/Стр60/Гр3')
  #SG(R4_60_4, 'Документ/Разделы/Раздел4/Стр60/Гр4')
  #SG(R4_60_5, 'Документ/Разделы/Раздел4/Стр60/Гр5')
  #SG(R4_60_6, 'Документ/Разделы/Раздел4/Стр60/Гр6')
  #SG(R4_60_7, 'Документ/Разделы/Раздел4/Стр60/Гр7')

  #SG(R4_61_1, 'Документ/Разделы/Раздел4/Стр61/Гр1')
  #SG(R4_61_2, 'Документ/Разделы/Раздел4/Стр61/Гр2')
  #SG(R4_61_3, 'Документ/Разделы/Раздел4/Стр61/Гр3')
  #SG(R4_61_4, 'Документ/Разделы/Раздел4/Стр61/Гр4')
  #SG(R4_61_5, 'Документ/Разделы/Раздел4/Стр61/Гр5')
  #SG(R4_61_6, 'Документ/Разделы/Раздел4/Стр61/Гр6')
  #SG(R4_61_7, 'Документ/Разделы/Раздел4/Стр61/Гр7')

  #SG(R4_62_1, 'Документ/Разделы/Раздел4/Стр62/Гр1')
  #SG(R4_62_2, 'Документ/Разделы/Раздел4/Стр62/Гр2')
  #SG(R4_62_3, 'Документ/Разделы/Раздел4/Стр62/Гр3')
  #SG(R4_62_4, 'Документ/Разделы/Раздел4/Стр62/Гр4')
  #SG(R4_62_5, 'Документ/Разделы/Раздел4/Стр62/Гр5')
  #SG(R4_62_6, 'Документ/Разделы/Раздел4/Стр62/Гр6')
  #SG(R4_62_7, 'Документ/Разделы/Раздел4/Стр62/Гр7')

  #SG(R4_63_1, 'Документ/Разделы/Раздел4/Стр63/Гр1')
  #SG(R4_63_2, 'Документ/Разделы/Раздел4/Стр63/Гр2')
  #SG(R4_63_3, 'Документ/Разделы/Раздел4/Стр63/Гр3')
  #SG(R4_63_4, 'Документ/Разделы/Раздел4/Стр63/Гр4')
  #SG(R4_63_5, 'Документ/Разделы/Раздел4/Стр63/Гр5')
  #SG(R4_63_6, 'Документ/Разделы/Раздел4/Стр63/Гр6')
  #SG(R4_63_7, 'Документ/Разделы/Раздел4/Стр63/Гр7')
  //----------------------------------------------------------------------------------------------------------
  // #endregion ОБЪЯВЛЕНИЕ И ИНИЦИАЛИЗАЦИЯ ПЕРЕМЕННЫХ
  //----------------------------------------------------------------------------------------------------------

  isEndOfQuarter := (Month(TaxDat.dEnd) =  3) or
                    (Month(TaxDat.dEnd) =  6) or
                    (Month(TaxDat.dEnd) =  9) or
                    (Month(TaxDat.dEnd) = 12);

  a2   := GetPatVal('&lk_a2'  );
  b2   := GetPatVal('&lk_b2'  );
  c2   := GetPatVal('&lk_c2'  );
  a4   := GetPatVal('&lk_a4'  );
  b4   := GetPatVal('&lk_b4'  );
  c4   := GetPatVal('&lk_c4'  );
  a402 := GetPatVal('&lk_a402');
  b402 := GetPatVal('&lk_b402');
  c402 := GetPatVal('&lk_c402');
  d402 := GetPatVal('&lk_d402');

  //Раздел 1
  dR1_01_1 := GetPatVal('&lk_p01_1');   SV(aR1_01_1, dR1_01_1);   Log(aR1_01_1, 'Стр. 01 (гр. 1) = ПАТ-формула', GV(aR1_01_1)+' = '+String(GetPatVal('&lk_p01_1')));
  dR1_02_1 := a2 + b2 + c2;             SV(aR1_02_1, dR1_02_1);   Log(aR1_02_1, 'Стр. 02 (гр. 1) = ПАТ-формула', GV(aR1_02_1)+' = '+String(a2)+' + '+String(b2)+' + '+String(c2));
  dR1_03_1 := GetPatVal('&lk_p03_1');   SV(aR1_03_1, dR1_03_1);   Log(aR1_03_1, 'Стр. 03 (гр. 1) = ПАТ-формула', GV(aR1_03_1)+' = '+String(GetPatVal('&lk_p03_1')));
  dR1_06_1 := GetPatVal('&lk_p06_1');   SV(aR1_06_1, dR1_06_1);   Log(aR1_06_1, 'Стр. 06 (гр. 1) = ПАТ-формула', GV(aR1_06_1)+' = '+String(GetPatVal('&lk_p06_1')));
  dR1_12_1 := GetPatVal('&lk_p12_1');   SV(aR1_12_1, dR1_12_1);   Log(aR1_12_1, 'Стр. 12 (гр. 1) = ПАТ-формула', GV(aR1_12_1)+' = '+String(GetPatVal('&lk_p12_1')));
  dR1_13_1 := GetPatVal('&lk_p13_1');   SV(aR1_13_1, dR1_13_1);   Log(aR1_13_1, 'Стр. 13 (гр. 1) = ПАТ-формула', GV(aR1_13_1)+' = '+String(GetPatVal('&lk_p13_1')));
  dR1_15_1 := GetPatVal('&lk_p15_1');   SV(aR1_15_1, dR1_15_1);   Log(aR1_15_1, 'Стр. 15 (гр. 1) = ПАТ-формула', GV(aR1_15_1)+' = '+String(GetPatVal('&lk_p15_1')));
  dR1_18_1 := GetPatVal('&lk_p18_1');   SV(aR1_18_1, dR1_18_1);   Log(aR1_18_1, 'Стр. 18 (гр. 1) = ПАТ-формула', GV(aR1_18_1)+' = '+String(GetPatVal('&lk_p18_1')));
  dR1_20_1 := GetPatVal('&lk_p20_1');   SV(aR1_20_1, dR1_20_1);   Log(aR1_20_1, 'Стр. 20 (гр. 1) = ПАТ-формула', GV(aR1_20_1)+' = '+String(GetPatVal('&lk_p20_1')));
  dR1_25_1 := GetPatVal('&lk_p25_1');   SV(aR1_25_1, dR1_25_1);   Log(aR1_25_1, 'Стр. 25 (гр. 1) = ПАТ-формула', GV(aR1_25_1)+' = '+String(GetPatVal('&lk_p25_1')));
  dR1_27_1 := GetPatVal('&lk_p27_1');   SV(aR1_27_1, dR1_27_1);   Log(aR1_27_1, 'Стр. 27 (гр. 1) = ПАТ-формула', GV(aR1_27_1)+' = '+String(GetPatVal('&lk_p27_1')));

  if isEndOfQuarter // #region THEN
  {
    //Раздел 2
    dR2_30_1 := GetPatVal('&lk_p30_1');   SV(aR2_30_1, dR2_30_1);   Log(aR2_30_1, 'Стр. 30 (гр. 1) = ПАТ-формула', GV(aR2_30_1)+' = '+String(GetPatVal('&lk_p30_1')));
    dR2_30_2 := GetPatVal('&lk_p30_2');   SV(aR2_30_2, dR2_30_2);   Log(aR2_30_2, 'Стр. 30 (гр. 2) = ПАТ-формула', GV(aR2_30_2)+' = '+String(GetPatVal('&lk_p30_2')));
    dR2_31_1 := GetPatVal('&lk_p31_1');   SV(aR2_31_1, dR2_31_1);   Log(aR2_31_1, 'Стр. 31 (гр. 1) = ПАТ-формула', GV(aR2_31_1)+' = '+String(GetPatVal('&lk_p31_1')));
    dR2_31_2 := GetPatVal('&lk_p31_2');   SV(aR2_31_2, dR2_31_2);   Log(aR2_31_2, 'Стр. 31 (гр. 2) = ПАТ-формула', GV(aR2_31_2)+' = '+String(GetPatVal('&lk_p31_2')));
    dR2_32_1 := GetPatVal('&lk_p32_1');   SV(aR2_32_1, dR2_32_1);   Log(aR2_32_1, 'Стр. 32 (гр. 1) = ПАТ-формула', GV(aR2_32_1)+' = '+String(GetPatVal('&lk_p32_1')));
    dR2_32_2 := GetPatVal('&lk_p32_2');   SV(aR2_32_2, dR2_32_2);   Log(aR2_32_2, 'Стр. 32 (гр. 2) = ПАТ-формула', GV(aR2_32_2)+' = '+String(GetPatVal('&lk_p32_2')));

    dR2_33_1 := dR2_30_1 - dR2_31_1 - dR2_32_1;   SV(aR2_33_1, dR2_33_1);
    dR2_33_2 := dR2_30_2 - dR2_31_2 - dR2_32_2;   SV(aR2_33_2, dR2_33_2);

    dR2_34_1 := GetPatVal('&lk_p34_1');   SV(aR2_34_1, dR2_34_1);   Log(aR2_34_1, 'Стр. 34 (гр. 1) = ПАТ-формула', GV(aR2_34_1)+' = '+String(GetPatVal('&lk_p34_1')));
    dR2_34_2 := GetPatVal('&lk_p34_2');   SV(aR2_34_2, dR2_34_2);   Log(aR2_34_2, 'Стр. 34 (гр. 2) = ПАТ-формула', GV(aR2_34_2)+' = '+String(GetPatVal('&lk_p34_2')));

    //Раздел 3
    dR3_36_1 := GetPatVal('&lk_p36_1');   SV(aR3_36_1, dR3_36_1);   Log(aR3_36_1, 'Стр. 36 (гр. 1) = ПАТ-формула', GV(aR3_36_1)+' = '+String(GetPatVal('&lk_p36_1')));
    dR3_37_1 := GetPatVal('&lk_p37_1');   SV(aR3_37_1, dR3_37_1);   Log(aR3_37_1, 'Стр. 37 (гр. 1) = ПАТ-формула', GV(aR3_37_1)+' = '+String(GetPatVal('&lk_p37_1')));
    dR3_38_1 := GetPatVal('&lk_p38_1');   SV(aR3_38_1, dR3_38_1);   Log(aR3_38_1, 'Стр. 38 (гр. 1) = ПАТ-формула', GV(aR3_38_1)+' = '+String(GetPatVal('&lk_p38_1')));
    dR3_39_1 := GetPatVal('&lk_p39_1');   SV(aR3_39_1, dR3_39_1);   Log(aR3_39_1, 'Стр. 39 (гр. 1) = ПАТ-формула', GV(aR3_39_1)+' = '+String(GetPatVal('&lk_p39_1')));
    dR3_40_1 := GetPatVal('&lk_p40_1');   SV(aR3_40_1, dR3_40_1);   Log(aR3_40_1, 'Стр. 40 (гр. 1) = ПАТ-формула', GV(aR3_40_1)+' = '+String(GetPatVal('&lk_p40_1')));
    dR3_41_1 := GetPatVal('&lk_p41_1');   SV(aR3_41_1, dR3_41_1);   Log(aR3_41_1, 'Стр. 41 (гр. 1) = ПАТ-формула', GV(aR3_41_1)+' = '+String(GetPatVal('&lk_p41_1')));
    dR3_42_1 := GetPatVal('&lk_p42_1');   SV(aR3_42_1, dR3_42_1);   Log(aR3_42_1, 'Стр. 42 (гр. 1) = ПАТ-формула', GV(aR3_42_1)+' = '+String(GetPatVal('&lk_p42_1')));
    dR3_43_1 := GetPatVal('&lk_p43_1');   SV(aR3_43_1, dR3_43_1);   Log(aR3_43_1, 'Стр. 43 (гр. 1) = ПАТ-формула', GV(aR3_43_1)+' = '+String(GetPatVal('&lk_p43_1')));
    dR3_44_1 := GetPatVal('&lk_p44_1');   SV(aR3_44_1, dR3_44_1);   Log(aR3_44_1, 'Стр. 44 (гр. 1) = ПАТ-формула', GV(aR3_44_1)+' = '+String(GetPatVal('&lk_p44_1')));
    dR3_45_1 := GetPatVal('&lk_p45_1');   SV(aR3_45_1, dR3_45_1);   Log(aR3_45_1, 'Стр. 45 (гр. 1) = ПАТ-формула', GV(aR3_45_1)+' = '+String(GetPatVal('&lk_p45_1')));
    dR3_46_1 := GetPatVal('&lk_p46_1');   SV(aR3_46_1, dR3_46_1);   Log(aR3_46_1, 'Стр. 46 (гр. 1) = ПАТ-формула', GV(aR3_46_1)+' = '+String(GetPatVal('&lk_p46_1')));
    dR3_47_1 := GetPatVal('&lk_p47_1');   SV(aR3_47_1, dR3_47_1);   Log(aR3_47_1, 'Стр. 47 (гр. 1) = ПАТ-формула', GV(aR3_47_1)+' = '+String(GetPatVal('&lk_p47_1')));
    dR3_48_1 := GetPatVal('&lk_p48_1');   SV(aR3_48_1, dR3_48_1);   Log(aR3_48_1, 'Стр. 48 (гр. 1) = ПАТ-формула', GV(aR3_48_1)+' = '+String(GetPatVal('&lk_p48_1')));
    dR3_49_1 := GetPatVal('&lk_p49_1');   SV(aR3_49_1, dR3_49_1);   Log(aR3_49_1, 'Стр. 49 (гр. 1) = ПАТ-формула', GV(aR3_49_1)+' = '+String(GetPatVal('&lk_p49_1')));
    dR3_50_1 := GetPatVal('&lk_p50_1');   SV(aR3_50_1, dR3_50_1);   Log(aR3_50_1, 'Стр. 50 (гр. 1) = ПАТ-формула', GV(aR3_50_1)+' = '+String(GetPatVal('&lk_p50_1')));

    dR3_36_2 := GetPatVal('&lk_p36_2');   SV(aR3_36_2, dR3_36_2);   Log(aR3_36_2, 'Стр. 36 (гр. 2) = ПАТ-формула', GV(aR3_36_2)+' = '+String(GetPatVal('&lk_p36_2')));
    dR3_37_2 := GetPatVal('&lk_p37_2');   SV(aR3_37_2, dR3_37_2);   Log(aR3_37_2, 'Стр. 37 (гр. 2) = ПАТ-формула', GV(aR3_37_2)+' = '+String(GetPatVal('&lk_p37_2')));
    dR3_38_2 := GetPatVal('&lk_p38_2');   SV(aR3_38_2, dR3_38_2);   Log(aR3_38_2, 'Стр. 38 (гр. 2) = ПАТ-формула', GV(aR3_38_2)+' = '+String(GetPatVal('&lk_p38_2')));
    dR3_39_2 := GetPatVal('&lk_p39_2');   SV(aR3_39_2, dR3_39_2);   Log(aR3_39_2, 'Стр. 39 (гр. 2) = ПАТ-формула', GV(aR3_39_2)+' = '+String(GetPatVal('&lk_p39_2')));
    dR3_40_2 := GetPatVal('&lk_p40_2');   SV(aR3_40_2, dR3_40_2);   Log(aR3_40_2, 'Стр. 40 (гр. 2) = ПАТ-формула', GV(aR3_40_2)+' = '+String(GetPatVal('&lk_p40_2')));
    dR3_41_2 := GetPatVal('&lk_p41_2');   SV(aR3_41_2, dR3_41_2);   Log(aR3_41_2, 'Стр. 41 (гр. 2) = ПАТ-формула', GV(aR3_41_2)+' = '+String(GetPatVal('&lk_p41_2')));
    dR3_42_2 := GetPatVal('&lk_p42_2');   SV(aR3_42_2, dR3_42_2);   Log(aR3_42_2, 'Стр. 42 (гр. 2) = ПАТ-формула', GV(aR3_42_2)+' = '+String(GetPatVal('&lk_p42_2')));
    dR3_43_2 := GetPatVal('&lk_p43_2');   SV(aR3_43_2, dR3_43_2);   Log(aR3_43_2, 'Стр. 43 (гр. 2) = ПАТ-формула', GV(aR3_43_2)+' = '+String(GetPatVal('&lk_p43_2')));
    dR3_44_2 := GetPatVal('&lk_p44_2');   SV(aR3_44_2, dR3_44_2);   Log(aR3_44_2, 'Стр. 44 (гр. 2) = ПАТ-формула', GV(aR3_44_2)+' = '+String(GetPatVal('&lk_p44_2')));
    dR3_45_2 := GetPatVal('&lk_p45_2');   SV(aR3_45_2, dR3_45_2);   Log(aR3_45_2, 'Стр. 45 (гр. 2) = ПАТ-формула', GV(aR3_45_2)+' = '+String(GetPatVal('&lk_p45_2')));
    dR3_46_2 := GetPatVal('&lk_p46_2');   SV(aR3_46_2, dR3_46_2);   Log(aR3_46_2, 'Стр. 46 (гр. 2) = ПАТ-формула', GV(aR3_46_2)+' = '+String(GetPatVal('&lk_p46_2')));
    dR3_47_2 := GetPatVal('&lk_p47_2');   SV(aR3_47_2, dR3_47_2);   Log(aR3_47_2, 'Стр. 47 (гр. 2) = ПАТ-формула', GV(aR3_47_2)+' = '+String(GetPatVal('&lk_p47_2')));
    dR3_48_2 := GetPatVal('&lk_p48_2');   SV(aR3_48_2, dR3_48_2);   Log(aR3_48_2, 'Стр. 48 (гр. 2) = ПАТ-формула', GV(aR3_48_2)+' = '+String(GetPatVal('&lk_p48_2')));
    dR3_49_2 := GetPatVal('&lk_p49_2');   SV(aR3_49_2, dR3_49_2);   Log(aR3_49_2, 'Стр. 49 (гр. 2) = ПАТ-формула', GV(aR3_49_2)+' = '+String(GetPatVal('&lk_p49_2')));
    dR3_50_2 := GetPatVal('&lk_p50_2');   SV(aR3_50_2, dR3_50_2);   Log(aR3_50_2, 'Стр. 50 (гр. 2) = ПАТ-формула', GV(aR3_50_2)+' = '+String(GetPatVal('&lk_p50_2')));

    //Раздел 4
    dR4_52_1 := dR4_53_1 + dR4_54_1 + dR4_55_1 + dR4_56_1 + dR4_57_1 + dR4_58_1 + dR4_59_1 + dR4_60_1 + dR4_61_1 + dR4_62_1;   SV(aR4_52_1, dR4_52_1);
    dR4_52_2 := dR4_53_2 + dR4_54_2 + dR4_55_2 + dR4_56_2 + dR4_57_2 + dR4_58_2 + dR4_59_2 + dR4_60_2 + dR4_61_2 + dR4_62_2;   SV(aR4_52_2, dR4_52_2);
    dR4_52_3 := dR4_53_3 + dR4_54_3 + dR4_55_3 + dR4_56_3 + dR4_57_3 + dR4_58_3 + dR4_59_3 + dR4_60_3 + dR4_61_3 + dR4_62_3;   SV(aR4_52_3, dR4_52_3);
    dR4_52_4 := dR4_53_4 + dR4_54_4 + dR4_55_4 + dR4_56_4 + dR4_57_4 + dR4_58_4 + dR4_59_4 + dR4_60_4 + dR4_61_4 + dR4_62_4;   SV(aR4_52_4, dR4_52_4);
    dR4_52_5 := dR4_53_5 + dR4_54_5 + dR4_55_5 + dR4_56_5 + dR4_57_5 + dR4_58_5 + dR4_59_5 + dR4_60_5 + dR4_61_5 + dR4_62_5;   SV(aR4_52_5, dR4_52_5);
    dR4_52_6 := dR4_53_6 + dR4_54_6 + dR4_55_6 + dR4_56_6 + dR4_57_6 + dR4_58_6 + dR4_59_6 + dR4_60_6 + dR4_61_6 + dR4_62_6;   SV(aR4_52_6, dR4_52_6);
    dR4_52_7 := dR4_53_7 + dR4_54_7 + dR4_55_7 + dR4_56_7 + dR4_57_7 + dR4_58_7 + dR4_59_7 + dR4_60_7 + dR4_61_7 + dR4_62_7;   SV(aR4_52_7, dR4_52_7);

    //Раздел 1
    dR1_05_1 := dR4_51_2 + dR4_52_2 + dR4_63_2;   SV(aR1_05_1, dR1_05_1);
    dR1_05_2 := dR4_51_3 + dR4_52_3 + dR4_63_3;   SV(aR1_05_2, dR1_05_2);

    dR1_19_1 := dR4_51_4 + dR4_52_4 + dR4_63_4;   SV(aR1_19_1, dR1_19_1);
    dR1_19_2 := dR4_51_5 + dR4_52_5 + dR4_63_5;   SV(aR1_19_2, dR1_19_2);

    dR1_26_1 := dR4_51_6 + dR4_52_6 + dR4_63_6;   SV(aR1_26_1, dR1_26_1);
    dR1_26_2 := dR4_51_7 + dR4_52_7 + dR4_63_7;   SV(aR1_26_2, dR1_26_2);

    // Логирование расчетов
    Log(aR1_05_1, 'Стр. 05 (гр. 1) = сумма стр. (51, 52, 63) по гр. 2', GV(aR1_05_1)+' = '+GV(aR4_51_2)+' + '+GV(aR4_52_2)+' + '+GV(aR4_63_2))
    Log(aR1_05_2, 'Стр. 05 (гр. 2) = сумма стр. (51, 52, 63) по гр. 3', GV(aR1_05_2)+' = '+GV(aR4_51_3)+' + '+GV(aR4_52_3)+' + '+GV(aR4_63_3))

    Log(aR1_19_1, 'Стр. 19 (гр. 1) = сумма стр. (51, 52, 63) по гр. 4', GV(aR1_19_1)+' = '+GV(aR4_51_4)+' + '+GV(aR4_52_4)+' + '+GV(aR4_63_4))
    Log(aR1_19_2, 'Стр. 19 (гр. 2) = сумма стр. (51, 52, 63) по гр. 5', GV(aR1_19_2)+' = '+GV(aR4_51_5)+' + '+GV(aR4_52_5)+' + '+GV(aR4_63_5))

    Log(aR1_26_1, 'Стр. 26 (гр. 1) = сумма стр. (51, 52, 63) по гр. 6', GV(aR1_26_1)+' = '+GV(aR4_51_6)+' + '+GV(aR4_52_6)+' + '+GV(aR4_63_6))
    Log(aR1_26_2, 'Стр. 26 (гр. 2) = сумма стр. (51, 52, 63) по гр. 7', GV(aR1_26_2)+' = '+GV(aR4_51_7)+' + '+GV(aR4_52_7)+' + '+GV(aR4_63_7))

    Log(aR2_33_1, 'Стр. 33 (гр. 1) = стр. 30 - стр. 31 - стр. 32', GV(aR2_33_1)+' = '+GV(aR2_30_1)+' - '+GV(aR2_31_1)+' - '+GV(aR2_32_1))
    Log(aR2_33_2, 'Стр. 33 (гр. 2) = стр. 30 - стр. 31 - стр. 32', GV(aR2_33_2)+' = '+GV(aR2_30_2)+' - '+GV(aR2_31_2)+' - '+GV(aR2_32_2))

    var mR4_52_1, mR4_52_2, mR4_52_3, mR4_52_4, mR4_52_5, mR4_52_6, mR4_52_7 : string;
    mR4_52_1 := GV(aR4_52_1)+' = '+GV(aR4_53_1)+' + '+GV(aR4_54_1)+' + '+GV(aR4_55_1)+' + '+GV(aR4_56_1)+' + '+GV(aR4_57_1)+' + '+GV(aR4_58_1)+' + '+GV(aR4_59_1)+' + '+GV(aR4_60_1)+' + '+GV(aR4_61_1)+' + '+GV(aR4_62_1);
    mR4_52_2 := GV(aR4_52_2)+' = '+GV(aR4_53_2)+' + '+GV(aR4_54_2)+' + '+GV(aR4_55_2)+' + '+GV(aR4_56_2)+' + '+GV(aR4_57_2)+' + '+GV(aR4_58_2)+' + '+GV(aR4_59_2)+' + '+GV(aR4_60_2)+' + '+GV(aR4_61_2)+' + '+GV(aR4_62_2);
    mR4_52_3 := GV(aR4_52_3)+' = '+GV(aR4_53_3)+' + '+GV(aR4_54_3)+' + '+GV(aR4_55_3)+' + '+GV(aR4_56_3)+' + '+GV(aR4_57_3)+' + '+GV(aR4_58_3)+' + '+GV(aR4_59_3)+' + '+GV(aR4_60_3)+' + '+GV(aR4_61_3)+' + '+GV(aR4_62_3);
    mR4_52_4 := GV(aR4_52_4)+' = '+GV(aR4_53_4)+' + '+GV(aR4_54_4)+' + '+GV(aR4_55_4)+' + '+GV(aR4_56_4)+' + '+GV(aR4_57_4)+' + '+GV(aR4_58_4)+' + '+GV(aR4_59_4)+' + '+GV(aR4_60_4)+' + '+GV(aR4_61_4)+' + '+GV(aR4_62_4);
    mR4_52_5 := GV(aR4_52_5)+' = '+GV(aR4_53_5)+' + '+GV(aR4_54_5)+' + '+GV(aR4_55_5)+' + '+GV(aR4_56_5)+' + '+GV(aR4_57_5)+' + '+GV(aR4_58_5)+' + '+GV(aR4_59_5)+' + '+GV(aR4_60_5)+' + '+GV(aR4_61_5)+' + '+GV(aR4_62_5);
    mR4_52_6 := GV(aR4_52_6)+' = '+GV(aR4_53_6)+' + '+GV(aR4_54_6)+' + '+GV(aR4_55_6)+' + '+GV(aR4_56_6)+' + '+GV(aR4_57_6)+' + '+GV(aR4_58_6)+' + '+GV(aR4_59_6)+' + '+GV(aR4_60_6)+' + '+GV(aR4_61_6)+' + '+GV(aR4_62_6);
    mR4_52_7 := GV(aR4_52_7)+' = '+GV(aR4_53_7)+' + '+GV(aR4_54_7)+' + '+GV(aR4_55_7)+' + '+GV(aR4_56_7)+' + '+GV(aR4_57_7)+' + '+GV(aR4_58_7)+' + '+GV(aR4_59_7)+' + '+GV(aR4_60_7)+' + '+GV(aR4_61_7)+' + '+GV(aR4_62_7);

    Log(aR4_52_1, 'Стр. 52 (гр. 1) = сумма стр. (53, ..., 62)', mR4_52_1)
    Log(aR4_52_2, 'Стр. 52 (гр. 2) = сумма стр. (53, ..., 62)', mR4_52_2)
    Log(aR4_52_3, 'Стр. 52 (гр. 3) = сумма стр. (53, ..., 62)', mR4_52_3)
    Log(aR4_52_4, 'Стр. 52 (гр. 4) = сумма стр. (53, ..., 62)', mR4_52_4)
    Log(aR4_52_5, 'Стр. 52 (гр. 5) = сумма стр. (53, ..., 62)', mR4_52_5)
    Log(aR4_52_6, 'Стр. 52 (гр. 6) = сумма стр. (53, ..., 62)', mR4_52_6)
    Log(aR4_52_7, 'Стр. 52 (гр. 7) = сумма стр. (53, ..., 62)', mR4_52_7)
  } // #endregion THEN
  else // #region ELSE
  {
    //Раздел 1
    SetFldNull(aR1_05_1);   SetFldNull(aR1_05_2);
    SetFldNull(aR1_19_1);   SetFldNull(aR1_19_2);
    SetFldNull(aR1_26_1);   SetFldNull(aR1_26_2);

    //Раздел 2
    SetFldNull(aR2_30_1);   SetFldNull(aR2_30_2);
    SetFldNull(aR2_31_1);   SetFldNull(aR2_31_2);
    SetFldNull(aR2_32_1);   SetFldNull(aR2_32_2);
    SetFldNull(aR2_33_1);   SetFldNull(aR2_33_2);
    SetFldNull(aR2_34_1);   SetFldNull(aR2_34_2);

    //Раздел 3
    SetFldNull(aR3_36_1);   SetFldNull(aR3_36_2);
    SetFldNull(aR3_37_1);   SetFldNull(aR3_37_2);
    SetFldNull(aR3_38_1);   SetFldNull(aR3_38_2);
    SetFldNull(aR3_39_1);   SetFldNull(aR3_39_2);
    SetFldNull(aR3_40_1);   SetFldNull(aR3_40_2);
    SetFldNull(aR3_41_1);   SetFldNull(aR3_41_2);
    SetFldNull(aR3_42_1);   SetFldNull(aR3_42_2);
    SetFldNull(aR3_43_1);   SetFldNull(aR3_43_2);
    SetFldNull(aR3_44_1);   SetFldNull(aR3_44_2);
    SetFldNull(aR3_45_1);   SetFldNull(aR3_45_2);
    SetFldNull(aR3_46_1);   SetFldNull(aR3_46_2);
    SetFldNull(aR3_47_1);   SetFldNull(aR3_47_2);
    SetFldNull(aR3_48_1);   SetFldNull(aR3_48_2);
    SetFldNull(aR3_49_1);   SetFldNull(aR3_49_2);
    SetFldNull(aR3_50_1);   SetFldNull(aR3_50_2);

    //Раздел 4
    SetFldNull(aR4_52_1);
    SetFldNull(aR4_52_2);
    SetFldNull(aR4_52_3);
    SetFldNull(aR4_52_4);
    SetFldNull(aR4_52_5);
    SetFldNull(aR4_52_6);
    SetFldNull(aR4_52_7);
  } // #endregion ELSE

  //----------------------------------------------------------------------------------------------------------

  Result := True;
@end.
//#endregion ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ РАСЧЕТЕ
//************************************************************************************************************


//============================================================================================================
//#region ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ЭКСПОРТЕ В XML
//------------------------------------------------------------------------------------------------------------
@Script On_ExportXML : Boolean;
@begin
  if (not XMLMap.ExpToXml(_XmlFileName_)) {
    Message('On_ExportXML: '+ XMLMap.GetStLastError, cancelButton+Warning);
    Exit;
  }

  message('Выгружен в файл ' + _XmlFileName_);
@end.
//#endregion ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ЭКСПОРТЕ В XML
//************************************************************************************************************
