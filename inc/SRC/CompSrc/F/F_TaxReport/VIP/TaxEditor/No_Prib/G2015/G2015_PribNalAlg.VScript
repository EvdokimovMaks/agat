//------------------------------------------------------------------------------------------------------------
//                                                                                    (c) корпорация Галактика
// Галактика 9.1 - модуль "Электронная отчетность"
// Алгоритмы расчета : "Декларация по налогу на прибыль"
//------------------------------------------------------------------------------------------------------------

//============================================================================================================
//#region ДОБЫЧА ДАННЫХ ИЗ ГАЛАКТИКИ
//------------------------------------------------------------------------------------------------------------
// код ОКЕИ для вывода сумм
// при расчете значение возьмется из соответствующего поля отчета
&lk_OKEI = 0

//------------------------------------------------------------------------------------------------------------
// ЗНАЧЕНИЯ ПО ГРАФАМ
// формат Y_X где:
//   Y - название страницы
//   X - номер строки

&Prib_List02_220 = SumOKEI(СК68_04, &lk_OKEI)
&Prib_List02_230 = SumOKEI(СК68_04, &lk_OKEI)

&Prib_List02_Pril2_030 = SumOKEI(ПД90\41_04, &lk_OKEI)
&Prib_List02_Pril2_041 = SumOKEI(СК68, &lk_OKEI)
&Prib_List02_Pril2_131 = SumOKEI(СК02, &lk_OKEI)

//#endregion ДОБЫЧА ДАННЫХ ИЗ ГАЛАКТИКИ
//************************************************************************************************************


//============================================================================================================
//#region СЕРВИСНЫЕ МЕТОДЫ
//------------------------------------------------------------------------------------------------------------
@Script SetFldVal(fld:string; val:variant);
@begin
  XMLMAP.SetVariantAttrValueByName_Formula(fld,val, 2);
@end.

//------------------------------------------------------------------------------------------------------------
@Script SetFldVis(fld:string;vis:boolean);
@begin
  XMLMAP.SetAttrVisByName(fld,vis);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetStrVal(fld:string):string;
@begin
  Result := Trim(String(XMLMAP.GetAttrValueByName(fld)));
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetDblVal(fld:string):double;
@begin
  Result := Double(XMLMAP.GetAttrValueByName(fld));
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetIntVal(fld:string):double;
@begin
  Result := Integer(XMLMAP.GetAttrValueByName(fld));
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetFldVis(fld:string):boolean;
@begin
  Result := XMLMAP.GetAttrVisByName(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetFldVisInTree(fld:string):boolean;
@begin
  Result := XMLMAP.GetAttrVisByNameInTree(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetIter(iter:longint):string;
@begin
  Result := '';

  if (iter > 0)
    Result := '[' + String(iter) + ']';
@end.

//------------------------------------------------------------------------------------------------------------
// Вставить сообщение об "ошибке"
@Script MessageErrorStop_ALG(mesMesAdrXML, mesStr, mesPole, mesMes: string; mesCountIter: integer = 0): boolean;
@begin
  MesError.InsertMesError(mesMesAdrXML, Comp(0), mesStr, mesPole, mesMes, mesCountIter);
  Result := True;
@end.

//------------------------------------------------------------------------------------------------------------
// Вставить сообщение об "предупреждении"
@Script MessageWarningStop_ALG(mesMesAdrXML, mesStr, mesPole, mesMes: string; mesCountIter: integer = 0): boolean;
@begin
  MesError.InsertMesWarning(mesMesAdrXML, Comp(0), mesStr, mesPole, mesMes, mesCountIter);
  Result := True;
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetStrNull(fld:string):boolean;
@begin
  Result := XMLMAP.GetIsNullAttrValueByName(fld);
@end.

//------------------------------------------------------------------------------------------------------------
@Script GetPatVal(expr:string):string;
#include AllTaxObj.Vih
@begin
  Result := ПАТ(expr);
@end.
//#endregion СЕРВИСНЫЕ МЕТОДЫ
//************************************************************************************************************


//============================================================================================================
//#region On_Visable ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ УСТАНОВКЕ ВИДИМОСТИ ПОЛЕЙ
//------------------------------------------------------------------------------------------------------------
@Script On_Visable : boolean;
  //==========================================================================================================
  //#region СЕРВИС On_Visable
  //----------------------------------------------------------------------------------------------------------
  #declare IfVis(adrIfVis)
    SetFldVis(#adrIfVis, not GetStrNull(#adrIfVis));
  #end

  #declare SetVisF(adrIfVis)
    SetFldVis(#adrIfVis, False);
  #end

  #declare SetVisT(adrIfVis)
    SetFldVis(#adrIfVis, True);
  #end


  //----------------------------------------------------------------------------------------------------------
  // Проверка на соответствие значения поля ФормРеорг условиям
  function _FormReorg : boolean;
  {
    var val : Integer;
    val := GetIntVal('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ФормРеорг');

    Result := False;
    Result := ((val = 1) or (val = 2) or (val = 3) or (val = 5) or (val = 6));
  }
  //----------------------------------------------------------------------------------------------------------
  // Проверка на соответствие значения поля ПоМесту условиям
  function _PoMestu_1 : boolean;
  {
    var val : Integer;
    val := GetIntVal('Файл/Документ/ПоМесту');

    Result := False;
    Result := ((val = 231) or (val = 229) or (val = 235));
  }
  //----------------------------------------------------------------------------------------------------------
  // Проверка на соответствие значения полей ПоМесту и Период условиям
  function _PoMestu_2 : boolean;
  {
    var val_1, val_2 : Integer;
    val_1 := GetIntVal('Файл/Документ/ПоМесту');
    val_2 := GetIntVal('Файл/Документ/Период' );

    Result := False;
    Result := ((val_1 = 231) or (val_2 = 34) or (val_2 = 46) or (val_2 = 50) or (val_2 = 68));
  }
  //----------------------------------------------------------------------------------------------------------
  // Проверка равенства текущего значения поля ПоМесту значению 231
  function _PoMestu_3 : boolean;
  {
    Result := False;
    Result := (GetIntVal('Файл/Документ/ПоМесту') = 231);
  }
  //----------------------------------------------------------------------------------------------------------
  // Проверка равенства текущего значения поля ТипНП значению 4
  function _TipNP(_adrXML_: string) : boolean;
  {
    Result := False;
    Result := (GetIntVal(_adrXML_) = 4);
  }
  //----------------------------------------------------------------------------------------------------------
  // Проверка равенства текущего значения поля Гражд значению 643
  function _Gragd(_adrXML_: string) : boolean;
  {
    Result := False;
    Result := (GetIntVal(_adrXML_) = 643);
  }
  //----------------------------------------------------------------------------------------------------------
  // Проверка равенства текущего значения поля СтатусНП значению 1
  function _Status(_adrXML_: string) : boolean;
  {
    Result := False;
    Result := (GetIntVal(_adrXML_) = 1);
  }
  //#endregion СЕРВИС On_Visable
  //**********************************************************************************************************
@begin
  var i, j, k : longint;
  var fl1, fl2 : boolean;


  //==========================================================================================================
  //#region ТИТУЛЬНЫЙ ЛИСТ
  //----------------------------------------------------------------------------------------------------------
  #IfVis('Файл/Документ/СвНП/Тлф');

  if not GetStrNull('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ФормРеорг')
  {
    #SetVisT('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ'      );

    if _FormReorg
    {
      #SetVisT('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ИННЮЛ');
      #SetVisT('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/КПП'  );
    }
    else
    {
      #IfVis('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ИННЮЛ');
      #IfVis('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/КПП'  );
    }
  }
  else #SetVisF('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ');

  #IfVis('Файл/Документ/Подписант/ФИО/Отчество');

  if    not GetStrNull('Файл/Документ/Подписант/СвПред/НаимДок')
     or    (GetIntVal ('Файл/Документ/Подписант/ПрПодп') = 2)
  {
    #SetVisT('Файл/Документ/Подписант/СвПред'        );
    #IfVis  ('Файл/Документ/Подписант/СвПред/НаимОрг');
  }
  else #SetVisF('Файл/Документ/Подписант/СвПред');
  //#endregion ТИТУЛЬНЫЙ ЛИСТ
  //**********************************************************************************************************


  //==========================================================================================================
  //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.1
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУАв'); i++)
  {
    if not _PoMestu_1
    {
      #SetVisT('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i));

      if     not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж/КБК'  )
         and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж/НалПУ')
      then #SetVisT('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж')
      else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж');

      if     not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж/КБК'  )
         and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж/НалПУ')
      then #SetVisT('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж')
      else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж');

      /*
      if     not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ОКТМО' )
         and     GetFldVis ('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж')
         and     GetFldVis ('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж')
      then #SetVisT('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i))
      else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i));
      */
    }
    else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i));
  }
  //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.1
  //**********************************************************************************************************


  //==========================================================================================================
  //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУМес'); i++)
  {
    if not _PoMestu_2
    {
      #IfVis('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/КвИсчислАв');

      if     not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/КБК'    )
         and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат1')
         and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат2')
         and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат3')
      then #SetVisT('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж')
      else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж');

      if     not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/КБК'    )
         and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат1')
         and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат2')
         and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат3')
      then #SetVisT('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж')
      else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж');

      if not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ОКТМО')
      then #SetVisT('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i))
      else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i));
    }
    else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i));
  }
  //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
  //**********************************************************************************************************


  //==========================================================================================================
  //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.3
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУПроц'); i++)
  {
    fl1 := False;

    for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'); j++)
    {
      if     not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'+getIter(j)+'/Срок' )
         and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'+getIter(j)+'/НалПУ')
      {
        fl1 := True;
        #SetVisT('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'+getIter(j));
      }
      else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'+getIter(j));
    }

    if    (not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/ВидПлат')
       and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/ОКТМО'  )
       and not GetStrNull('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/КБК'    )
       and     fl1)
       or  _PoMestu_3
    then #SetVisT('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i))
    else #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i));
  }
  //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.3
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 02
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'); i++)
  {
    if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ТипНП')
    {
      #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i));

      if _TipNP('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ТипНП')
      {
        #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СерЛицНедр');
        #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НомЛицНедр');
        #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ВидЛицНедр');
        #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НомМорМест');
      }
      else
      {
        #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СерЛицНедр');
        #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НомЛицНедр');
        #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ВидЛицНедр');
        #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НомМорМест');
      }

      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеал'        );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохВнереал'     );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхУмРеал'     );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхВнереал'    );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/Убытки'         );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ПрибУб'         );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохИсклПриб'    );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ПрибБРСт0'      );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СумЛьгот'       );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБаза'        );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУмНБ'       );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБазаИсч'     );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБазаИсчСуб'  );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалВсего'   );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалФБ'      );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалСуб'     );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалСуб284'  );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчисл'      );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислФБ'    );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб'   );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачисл'       );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислФБ'     );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислСуб'    );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311'     );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311ФБ'   );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311Суб'  );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалДоплФБ'      );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалДоплСуб'     );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалУменФБ'      );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалУменСуб'     );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМес'      );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесФБ'    );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесСуб'   );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1Кв'   );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1КвФБ' );
      #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1КвСуб');


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 1
      //----------------------------------------------------------------------------------------------------------
      {
        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ТипНП')
        {
          #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал');

          if _TipNP('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ТипНП')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/СерЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/НомЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ВидЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/НомМорМест');
          }
          else
          {
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/СерЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/НомЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ВидЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/НомМорМест');
          }

          if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалИтог')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал'              );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалПред'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалОпер32');

            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалВс'    );
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалТовСоб');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалТовПок');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалИмПрав');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалИмПроч');

            if    GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалВс'    )
               or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалТовСоб')
               or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалТовПок')
               or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалИмПрав')
               or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалИмПроч')
            then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал')
            else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал');

            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ВырРеалЦБВс'   );
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ОтклВырЦБОбр'  );
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ОтклВырЦБНеОбр');

            if    GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ВырРеалЦБВс'   )
               or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ОтклВырЦБОбр'  )
               or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ОтклВырЦБНеОбр')
            then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ')
            else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ');

            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр/ВырРеалЦБВс' );
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр/ОтклВырЦБМин');

            if    GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр/ВырРеалЦБВс' )
               or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр/ОтклВырЦБМин')
            then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр')
            else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр');
          }
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал');
        }
        else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал');

        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохВс')
        {
          #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал'                  );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохПр'     );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохСт'     );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохБезв'   );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохИзл'    );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохВРасх'  );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохРынЦБДД');
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохКор'    );
        }
        else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал');
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 1
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 2
      //----------------------------------------------------------------------------------------------------------
      {
        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/ТипНП')
        {
          #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал');

          if _TipNP('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/ТипНП')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СерЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/НомЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/ВидЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/НомМорМест');
          }
          else
          {
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СерЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/НомЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/ВидЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/НомМорМест');
          }

          if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхПризнИтого')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал'               );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхРеал'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РеалИмущПрав'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобрРеалИмущ');
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/АктивРеалПред' );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобРеалЦБ'   );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/СумОтклЦен'    );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобРеалЦБОрг');
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/СумОтклЦенОрг' );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхОпер32'    );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытПрошОбсл'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытРеалАмИм'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытРеалЗемУч' );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/НадбПокПред'   );

            if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхТорг/ПрямРасхТоргВс')
            {
              #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхТорг'           );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхТорг/РеалПокТов');
            }
            else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхТорг');

            if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/КосвРасхВс')
            {
              #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх'                 );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/Налоги'          );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхКапВл10'     );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхКапВл30'     );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхТрудИнв'     );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхОргИнв'      );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУчВс'     );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУчСрокНП' );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУч30пр'   );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУчСрокРас');
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУчСрокАр' );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/НИОКР'           );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/НИОКРнеПолРез'   );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/НИОКРПер'        );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/НИОКРПерНеРез'   );
            }
            else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх');
          }
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал');

          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерЛ'   );
          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерНмАЛ');
          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерН'   );
          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерНмАН');
          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/МетодНачАморт'  );

          if    GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерЛ'   )
             or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерНмАЛ')
             or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерН'   )
             or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерНмАН')
             or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/МетодНачАморт'  )
          then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт')
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт');

          if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнеРеалВс')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал'                );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнереалПрДО');
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнереалРзрв');
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/УбытРеалПравТр' );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхЛиквОС'     );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхШтраф'      );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхРынЦБДД'    );
          }
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал');

          if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн/УбытПриравнВс')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн'              );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн/УбытПрошПер'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн/СумБезнадДолг');
          }
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн');

          if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишВс')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш');

            for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишГод'); j++)
            {
              if     not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишГод'+getIter(j)+'/Год'       )
                 and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишГод'+getIter(j)+'/КорНБЛишВс')
              then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишГод'+getIter(j))
              else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишГод'+getIter(j));
            }
          }
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш');
        }
        else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал');
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 2
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 3
      //----------------------------------------------------------------------------------------------------------
      {
        if     not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ТипНП'       )
           and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручОп302Ит')
           and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхОп302Ит' )
           and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытОп302'   )
        {
          #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер');

          if _TipNP('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ТипНП')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СерЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/НомЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВидЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/НомМорМест');
          }
          else
          {
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СерЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/НомЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВидЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/НомМорМест');
          }

          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/КолОбРеалАИ'     );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/КолОбРеалАИУб'   );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалАИ'     );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ОстСтРеалАИ'     );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ПрибРеалАИ'      );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалАИ'      );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалТов'    );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхРеалТов'     );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытОбОбсл'      );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытОбОбслНеобл' );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ДохДоговДУИ'     );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ДохДоговДУИ_ВнР' );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхДоговДУИ'    );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхДоговДУИ_ВнР');
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытДоговДУИ'    );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ЦенРеалПрЗУ'     );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/НеВозЗатрПрЗУ'   );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПрЗУ'    );

          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ/ВыручРеалПТДоСр' );
          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ/ВыручРеалПТПосСр');

          if    GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ/ВыручРеалПТДоСр' )
             or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ/ВыручРеалПТПосСр')
          then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ')
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ');

          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ/СтоимРеалПТДоСр' );
          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ/СтоимРеалПТПосСр');

          if    GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ/СтоимРеалПТДоСр' )
             or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ/СтоимРеалПТПосСр')
          then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ')
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ');

          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1/Убыт1Соот269');
          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1/Убыт1Прев269');

          if    GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1/Убыт1Соот269')
             or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1/Убыт1Прев269')
          then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1')
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1');

          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2/Убыт2РеалПТ');
          #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2/Убыт2ВнРасх');

          if    GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2/Убыт2РеалПТ')
             or GetFldVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2/Убыт2ВнРасх')
          then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2')
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2');
        }
        else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер');
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 3
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 4
      //----------------------------------------------------------------------------------------------------------
      for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'); j++)
      {
        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ТипНП')
        {
          #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j));

          if _TipNP('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ТипНП')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/СерЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НомЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ВидЛицНедр');
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НомМорМест');
          }
          else
          {
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/СерЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НомЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ВидЛицНедр');
            #IfVis('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НомМорМест');
          }

          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачВс'   );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытЗавСд'   );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытЗавСдНач');
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НалБаза'        );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБаза'  );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБазаЗС');
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонВс'   );
          #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонЗС'   );

          for (k := 0; k < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачПерГод'); k++)
          {
            if     not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачПерГод'+getIter(k)+'/Год'    )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачПерГод'+getIter(k)+'/ОстУбыт')
               then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачПерГод'+getIter(k))
               else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачПерГод'+getIter(k));
          }
        }
        else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j));
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 4
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 1
      //----------------------------------------------------------------------------------------------------------
      {
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'); j++)
        {
          if     not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ТипНП'       )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ОбРасч'      )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НаимОП'      )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/КППОП'       )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ОбязУплНалОП')
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)                    );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаОрг'      );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаБезЛиквОП');
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ДоляНалБаз'      );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаДоля'     );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СтавНалСубРФ'    );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНал'          );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалНачислСубРФ'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалВыплВнеРФ'    );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНалП'         );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат'       );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат1КвСлед');
          }
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j));
        }
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 1
      //----------------------------------------------------------------------------------------------------------


      //==========================================================================================================
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 6
      //----------------------------------------------------------------------------------------------------------
      {
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'); j++)
        {
          //----------------------------------------------------------------------------------------------------------
          //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 6A
          //----------------------------------------------------------------------------------------------------------
          for (k := 0; k < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'); k++)
          {
            fl1 := False;

            if     not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ИННЮЛ'      )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/КПП'        )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ОКТМО'      )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НаимУч'     )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ОбРасч'     )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаГр'  )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаДоля')
            {
              fl1 := True;

              #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)                 );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаБезОП' );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СрЧислРаб'    );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СрОстСтАмИмущ');
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СредАрифВел'  );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ДоляНалБаз'   );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаДоляСн');
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СтавНалСубРФ' );
              #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СумНал'       );
            }
            else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k));
          }
          //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 6A
          //----------------------------------------------------------------------------------------------------------

          if     not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/ИННЮЛ'      )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/КПП'        )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/ОКТМО'      )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НаимУч'     )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/СубРФ'      )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/КолПрил'    )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаГр'  )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаДоля')
             and     fl1
          {
            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)                    );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаБезОП'    );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/ДоляНалБаз'      );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаДоляСтН'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/СумНал'          );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалНачислСубРФ'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалВыплВнеРФ'    );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/СумНалП'         );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/МесАвПлат'       );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/МесАвПлат1КвСлед');
          }
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j));
        }
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 6
      //**********************************************************************************************************

      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 6Б
      //----------------------------------------------------------------------------------------------------------
      {
        fl1 := False;

        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'); j++)
        {
          if     not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ИННЮЛ'     )
             and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ПрибУчГруп')
          {
            fl1 := True;

            #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)               );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ДохУчГруп'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ВнеРеалДох' );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/РасхУмДох'  );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ВнеРеалРасх');
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/УбытОпер302');
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ДохИсклПриб');
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ПрибОперЦБ' );
            #IfVis  ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/УбытОперЦБ' );
          }
          else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j));
        }

        if fl1
        then #SetVisT('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ')
        else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ');
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 6Б
      //----------------------------------------------------------------------------------------------------------
    }
    else #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i));
  }
  //#endregion ЛИСТ 02
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 2
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РаспрНалСубРФ'); i++)
  {
    if     not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ТипНП'       )
       and not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ОбРасч'      )
       and not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НаимОП'      )
       and not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/КППОП'       )
       and not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ОбязУплНалОП')
    {
      #SetVisT('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)                    );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалБазаОрг'      );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалБазаБезЛиквОП');
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ДоляНалБаз'      );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалБазаДоля'     );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/СтавНалСубРФ'    );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/СумНал'          );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалНачислСубРФ'  );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалВыплВнеРФ'    );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/СумНалП'         );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/МесАвПлат'       );
      #IfVis  ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/МесАвПлат1КвСлед');
    }
    else #SetVisF('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i));
  }
  //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 2
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 03
  //----------------------------------------------------------------------------------------------------------
  {
    fl1 := False;
    fl2 := False;

    //==========================================================================================================
    //#region ЛИСТ 03 (СТР. 1)
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохДив'); i++)
    {
      if     not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/КатегорНА'  )
         and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ВидДив'     )
         and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалПер'     )
         and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ОтчетГод'   )
         and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРаспрПол')
         and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивВсего'   )
      {
        fl1 := True;

        #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)                );
        #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ИННЮЛ_ЭмЦБ'  );
        #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛРез'    );
        #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивИнОрг'    );
        #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивСтатНеУст');
        #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНеДоход'  );
        #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРаспрУм'  );
        #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалИсчисл'   );
        #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалДивПред'  );
        #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалДивПосл'  );

        if not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосОргВс')
        {
          #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг'             );
          #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосСтав0' );
          #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосСтав9' );
          #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосСтавИн');
          #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосНеНП'  );
        }
        else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг');

        #IfVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛНеРезВс' );
        #IfVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтав0'   );
        #IfVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтав5'   );
        #IfVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтав10'  );
        #IfVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтавСв10');

        if    GetFldVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛНеРезВс' )
           or GetFldVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтав0'   )
           or GetFldVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтав5'   )
           or GetFldVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтав10'  )
           or GetFldVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтавСв10')
        then #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез');
        else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез');

        #IfVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА/ДивНАдоРас' );
        #IfVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА/ДивНАБезУч0');

        if    GetFldVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА/ДивНАдоРас' )
           or GetFldVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА/ДивНАБезУч0')
        then #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА');
        else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА');

        #IfVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал/ДивНал9');
        #IfVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал/ДивНал0');

        if    GetFldVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал/ДивНал9')
           or GetFldVis('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал/ДивНал0')
        then #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал');
        else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал');

        //----------------------------------------------------------------------------------------------------------
        //#region ЛИСТ 03 (СТР. 3). ВЕРСИЯ 1 (К РАЗДЕЛУ А)
        //----------------------------------------------------------------------------------------------------------
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'); j++)
        {
          if     not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/ПрПринадл'                  )
             and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/Тип'                        )
             and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/ДатаПерДив'                 )
             and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СумДив'                     )
             and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СумНал'                     )
             and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ИННПолуч'           )
             and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/КПППолуч'           )
             and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/НаимПолуч'          )
             and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/КодРегион')
          {
            #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)                                );
            #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/Тлф'                 );
            #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Индекс'    );
            #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Район'     );
            #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Город'     );
            #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/НаселПункт');
            #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Улица'     );
            #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Дом'       );
            #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Корпус'    );
            #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Кварт'     );

            if     not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Фамилия')
               and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Имя'    )
            {
              #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук'         );
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Отчество');
            }
            else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук');
          }
          else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j));
        }
        //#endregion ЛИСТ 03 (СТР. 3). ВЕРСИЯ 1 (К РАЗДЕЛУ А)
        //----------------------------------------------------------------------------------------------------------
      }
      else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i));
    }
    //#endregion ЛИСТ 03 (СТР. 1)
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ЛИСТ 03 (СТР. 2)
    //----------------------------------------------------------------------------------------------------------
    {
      for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'); i++)
      {
        if     not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/ВидДоход' )
           and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалБаза'  )
           and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/СтавНал'  )
           and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалИсчисл')
        {
          fl2 := True;

          #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)                 );
          #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалНачислПред');
          #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалНачислПосл');

          //----------------------------------------------------------------------------------------------------------
          //#region ЛИСТ 03 (СТР. 3). ВЕРСИЯ 2 (К РАЗДЕЛУ Б)
          //----------------------------------------------------------------------------------------------------------
          for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'); j++)
          {
            if     not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/ПрПринадл'                  )
               and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/Тип'                        )
               and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/ДатаПерДив'                 )
               and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СумДив'                     )
               and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СумНал'                     )
               and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ИННПолуч'           )
               and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/КПППолуч'           )
               and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/НаимПолуч'          )
               and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/КодРегион')
            {
              #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)                                );
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/Тлф'                 );
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Индекс'    );
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Район'     );
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Город'     );
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/НаселПункт');
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Улица'     );
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Дом'       );
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Корпус'    );
              #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Кварт'     );

              if     not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Фамилия')
                 and not GetStrNull('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Имя'    )
              {
                #SetVisT('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук'         );
                #IfVis  ('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Отчество');
              }
              else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук');
            }
            else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j));
          }
          //#endregion ЛИСТ 03 (СТР. 3). ВЕРСИЯ 2 (К РАЗДЕЛУ Б)
          //----------------------------------------------------------------------------------------------------------
        }
        else #SetVisF('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i));
      }
    }
    //#endregion ЛИСТ 03 (СТР. 2)
    //**********************************************************************************************************

    if fl1 or fl2
    then #SetVisT('Файл/Документ/Прибыль/НалУдНА');
    else #SetVisF('Файл/Документ/Прибыль/НалУдНА');
  }
  //#endregion ЛИСТ 03
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 04
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалДохСтав'); i++)
  {
    if     not GetStrNull('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/ВидДоход' )
       and not GetStrNull('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалБаза'  )
       and not GetStrNull('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/СтавНал'  )
       and not GetStrNull('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалИсчисл')
    {
      #SetVisT('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)                  );
      #IfVis  ('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/ДохУмНалБаз'   );
      #IfVis  ('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалДивНеРФПред');
      #IfVis  ('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалДивНеРФ'    );
      #IfVis  ('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПред' );
      #IfVis  ('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПосл' );
    }
    else #SetVisF('Файл/Документ/Прибыль/НалДохСтав'+getIter(i));
  }
  //#endregion ЛИСТ 04
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 05 (ДО 01.01.2015)
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалБазОпОсобС'); i++)
  {
    if     not GetStrNull('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/ВидОпер'      )
       and not GetStrNull('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/ДохВыбытПогаш')
       and not GetStrNull('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/Прибыль'      )
       and not GetStrNull('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/НалБаза'      )
    {
      #SetVisT('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)                    );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумОтклМинЦ'     );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/РасхПриобРеал'   );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумОтклМаксЦ'    );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/КорПриб'         );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/НалБазаБезУбПред');
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумУбытПред'     );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумУбытУменНБ'   );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумНеучУбытПер'  );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумУбытНеПогаш'  );
    }
    else #SetVisF('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i));
  }
  //#endregion ЛИСТ 05 (ДО 01.01.2015)
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 05 (С 01.01.2015)
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалБазОпОсобН'); i++)
  {
    if     not GetStrNull('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ВидОпер')
       and not GetStrNull('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/Прибыль')
       and not GetStrNull('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/НалБаза')
    {
      #SetVisT('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)                     );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохВыбыт'         );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохВыбЦБНеОрг'    );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохЦБНеОргМин'    );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохВыбФИССНеОрг'  );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохФИССНеОргМин'  );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхПриобРеал'    );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхЦБНеОрг'      );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхЦБНеОргМакс'  );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхФИССНеОрг'    );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхФИССНеОргМакс');
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/КорПриб'          );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/НалБазаБезУбПред' );
      #IfVis  ('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/СумУбытУменНБ'    );
    }
    else #SetVisF('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i));
  }
  //#endregion ЛИСТ 05 (С 01.01.2015)
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 06
  //----------------------------------------------------------------------------------------------------------
  {
    if     not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/СумПенсРез'                   )
       and not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ДоходНПФВс'          )
       and not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ДоходНПФСтРефВс')
       and
       (
            not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ПрибЦБРын'         )
         or not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклПрибЦБРын'  )
         or not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ПрибЦБНеРын'       )
         or not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклПрибЦБНеРын')
         or not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДохПроцЦБ'         )
         or not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДохПроцЭм2007'     )
         or not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДрИнвВлож'         )
         or not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклДрИнвВлож'  )
       )
    {
      #SetVisT('Файл/Документ/Прибыль/ДохРасНалБазаНПФ'                           );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПроцДохРазмРез'            );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/НалБаза'                   );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/РеалЦБРын'        );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ОтклВырЦБРын'     );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/РеалЦБНеРын'      );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ОтклВырЦБНеРын'   );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцГосЦБ'        );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцЦБЭм2007'     );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ДолУчДрОрг'       );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцГосЦБУдНА'    );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцМунЦБ2007НА'  );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ДрИнвВлож'        );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ЦБРын'       );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ЦБНеРын'     );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ПроцГосЦБ'   );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ПроцЦБЭм2007');
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ДрИнвВлож'   );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ПрибЦБРын'          );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклПрибЦБРын'   );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ПрибЦБНеРын'        );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклПрибЦБНеРын' );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДохПроцЦБ'          );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДохПроцЭм2007'      );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДрИнвВлож'          );
      #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклДрИнвВлож'   );

      if not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/РасходВс')
      {
        #SetVisT('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход'               );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/ВлЦБРын'       );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/СумОтклЦБРын'  );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/ВлЦБНеРын'     );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/СумОтклЦБНеРын');
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/ДрИнвВлож'     );
      }
      else #SetVisF('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход');

      if not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ОтчРазмРезУставВс')
      {
        #SetVisT('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав'                 );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ЦБРын'           );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ЦБНеРын'         );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБ'          );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБЭм2007'    );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ДолУчДрОрг'      );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБУдНА'      );
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБЭм2007УдНА');
        #IfVis  ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ДрИнвВлож'       );
      }
      else #SetVisF('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав');

      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/НалБаза'    );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумУбПред'  );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумУбПриз'  );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумНеучУбыт');

      if    GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/НалБаза'    )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумУбПред'  )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумУбПриз'  )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумНеучУбыт')
      then #SetVisT('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын');
      else #SetVisF('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын');

      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/НалБаза'        );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбСдНеОбр'   );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбСдНеОбрНач');
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПред'      );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПриз'      );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПриз458'   );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумНеучУбыт'    );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбыт458'     );

      if    GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/НалБаза'        )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбСдНеОбр'   )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбСдНеОбрНач')
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПред'      )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПриз'      )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПриз458'   )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумНеучУбыт'    )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбыт458'     )
      then #SetVisT('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын');
      else #SetVisF('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын');

      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/НалБаза'    );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумУбПред'  );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумУбПриз'  );
      #IfVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумНеучУбыт');

      if    GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/НалБаза'    )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумУбПред'  )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумУбПриз'  )
         or GetFldVis('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумНеучУбыт')
      then #SetVisT('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож');
      else #SetVisF('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож');
    }
    else #SetVisF('Файл/Документ/Прибыль/ДохРасНалБазаНПФ');
  }
  //#endregion ЛИСТ 06
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 07
  //----------------------------------------------------------------------------------------------------------
  {
    fl1 := False;

    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'); i++)
    {
      if     not GetStrNull('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/КодВидПост')
         and not GetStrNull('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СтИмущСрд' )
      {
        fl1 := True;

        #SetVisT('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)                );
        #IfVis  ('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/ДатаПост'    );
        #IfVis  ('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СрокИспол'   );
        #IfVis  ('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СумСрокНеИст');
        #IfVis  ('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СумИспНазн'  );
        #IfVis  ('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СумНеИсп'    );
      }
      else #SetVisF('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i));
    }

    if     not GetStrNull('Файл/Документ/Прибыль/ЦелИспИмущ/СтИмущСрдИт')
       and     fl1
    {
      #SetVisT('Файл/Документ/Прибыль/ЦелИспИмущ'               );
      #IfVis  ('Файл/Документ/Прибыль/ЦелИспИмущ/СумСрокНеИстИт');
      #IfVis  ('Файл/Документ/Прибыль/ЦелИспИмущ/СумИспНазнИт'  );
      #IfVis  ('Файл/Документ/Прибыль/ЦелИспИмущ/СумНеИспИт'    );
    }
    else #SetVisF('Файл/Документ/Прибыль/ЦелИспИмущ');
  }
  //#endregion ЛИСТ 07
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ПРИЛОЖЕНИЕ 1 К ДЕКЛАРАЦИИ
  //----------------------------------------------------------------------------------------------------------
  {
    fl1 := False;

    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'); i++)
    {
      #IfVis('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/КодВидДоход' );
      #IfVis('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/СумДоход'    );
      #IfVis('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/КодВидРасход');
      #IfVis('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/СумРасход'   );

      if    not GetStrNull('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/КодВидДоход' )
         or not GetStrNull('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/СумДоход'    )
         or not GetStrNull('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/КодВидРасход')
         or not GetStrNull('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/СумРасход'   )
      {
        fl1 := True;

        #SetVisT('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i))
      }
      else #SetVisF('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i));
    }

    if fl1
    then #SetVisT('Файл/Документ/Прибыль/ДохНеУч_РасхУч')
    else #SetVisF('Файл/Документ/Прибыль/ДохНеУч_РасхУч');
  }
  //#endregion ПРИЛОЖЕНИЕ 1 К ДЕКЛАРАЦИИ
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ
  //----------------------------------------------------------------------------------------------------------
  var buXMLAdr_i, buXMLAdr_j, buXMLAdr_k : string = '';

  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/СведДохФЛ'); i++)
  {
    buXMLAdr_i := 'Файл/Документ/Прибыль/СведДохФЛ'+getIter(i);

    if     not GetStrNull(buXMLAdr_i+'/НомерСправ'            )
       and not GetStrNull(buXMLAdr_i+'/ДатаСправ'             )
       and not GetStrNull(buXMLAdr_i+'/Тип'                   )
       and not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/СтатусНП'   )
       and not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/ДатаРожд'   )
       and not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/Гражд'      )
       and not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/КодВидДок'  )
       and not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/СерНомДок'  )
       and not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/ФИО/Фамилия')
       and not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/ФИО/Имя'    )
       and not GetStrNull(buXMLAdr_i+'/ДохНалПер/Ставка'      )
       and not GetStrNull(buXMLAdr_i+'/ДохНалПер/СумДохОбщ'   )
       and not GetStrNull(buXMLAdr_i+'/ДохНалПер/НалБаза'     )
       and not GetStrNull(buXMLAdr_i+'/ДохНалПер/НалИсчисл'   )
    {
      #SetVisT(buXMLAdr_i                           );
      #IfVis  (buXMLAdr_i+'/ФЛПолучДох/ИННФЛ'       )
      #IfVis  (buXMLAdr_i+'/ФЛПолучДох/ИННИно'      )
      #IfVis  (buXMLAdr_i+'/ФЛПолучДох/ФИО/Отчество')
      #IfVis  (buXMLAdr_i+'/ДохНалПер/СумВычОбщ'    )
      #IfVis  (buXMLAdr_i+'/ДохНалПер/НалУдерж'     )
      #IfVis  (buXMLAdr_i+'/ДохНалПер/НалУплач'     )
      #IfVis  (buXMLAdr_i+'/ДохНалПер/НалУдержЛиш'  )
      #IfVis  (buXMLAdr_i+'/ДохНалПер/НалНеУдерж'   )

      if    not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/КодРегион')
         or (    _Gragd (buXMLAdr_i+'/ФЛПолучДох/Гражд'   )
              or _Status(buXMLAdr_i+'/ФЛПолучДох/СтатусНП') )
      {
        #SetVisT(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ'           );
        #IfVis  (buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Индекс'    );
        #IfVis  (buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Район'     );
        #IfVis  (buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Город'     );
        #IfVis  (buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/НаселПункт');
        #IfVis  (buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Улица'     );
        #IfVis  (buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Дом'       );
        #IfVis  (buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Корпус'    );
        #IfVis  (buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Кварт'     );
      }
      else #SetVisF(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ');

      if     not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/АдрМЖИно/ОКСМ'    )
         and not GetStrNull(buXMLAdr_i+'/ФЛПолучДох/АдрМЖИно/АдрТекст')
         or (     not _Gragd   (buXMLAdr_i+'/ФЛПолучДох/Гражд'  )
              and not GetFldVis(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ') )
      then #SetVisT(buXMLAdr_i+'/ФЛПолучДох/АдрМЖИно')
      else #SetVisF(buXMLAdr_i+'/ФЛПолучДох/АдрМЖИно');

      fl1 := False;

      for (j := 0; j < XMLMAP.GetNodeCountByName(buXMLAdr_i+'/СпрДохФЛ/СумДох'); j++)
      {
        buXMLAdr_j := buXMLAdr_i+'/СпрДохФЛ/СумДох'+getIter(j);

        if     not GetStrNull(buXMLAdr_j+'/КодДоход')
           and not GetStrNull(buXMLAdr_j+'/СумДоход')
        {
          fl1 := True;

          #SetVisT(buXMLAdr_j);

          for (k := 0; k < XMLMAP.GetNodeCountByName(buXMLAdr_j+'/СумВыч'); k++)
          {
            buXMLAdr_k := buXMLAdr_j+'/СумВыч'+getIter(k);

            if     not GetStrNull(buXMLAdr_k+'/КодВычет')
               and not GetStrNull(buXMLAdr_k+'/СумВычет')
            then #SetVisT(buXMLAdr_k)
            else #SetVisF(buXMLAdr_k);
          }
        }
        else #SetVisF(buXMLAdr_j);
      }

      if fl1
      then #SetVisT(buXMLAdr_i+'/СпрДохФЛ')
      else #SetVisF(buXMLAdr_i+'/СпрДохФЛ');

      fl1 := False;

      for (j := 0; j < XMLMAP.GetNodeCountByName(buXMLAdr_i+'/НалВычСтанд/СумВыч'); j++)
      {
        buXMLAdr_j := buXMLAdr_i+'/НалВычСтанд/СумВыч'+getIter(j);

        if     not GetStrNull(buXMLAdr_j+'/КодВычет')
           and not GetStrNull(buXMLAdr_j+'/СумВычет')
        {
          fl1 := True;

          #SetVisT(buXMLAdr_j);
        }
        else #SetVisF(buXMLAdr_j);
      }

      if fl1
      then #SetVisT(buXMLAdr_i+'/НалВычСтанд')
      else #SetVisF(buXMLAdr_i+'/НалВычСтанд');
    }
    else #SetVisF(buXMLAdr_i);
  }
  //#endregion ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ
  //**********************************************************************************************************

  if (GetPatVal('&СобсОрг[Рез:КПП]') = GetStrVal('Файл/Документ/СвНП/НПЮЛ/КПП'))
  {
    //==========================================================================================================
    //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 2
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РаспрНалСубРФ'); i++)
    {
      #SetVisF('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i));
    }
    //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 2
    //**********************************************************************************************************
  }
  else
  {
    //==========================================================================================================
    //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.1
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУАв'); i++)
    {
      #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж');
    }
    //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.1
    //**********************************************************************************************************


    //==========================================================================================================
    //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУМес'); i++)
    {
      #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i));
    }
    //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
    //**********************************************************************************************************


    //==========================================================================================================
    //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.3
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУПроц'); i++)
    {
      #SetVisF('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i));
    }
    //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.3
    //**********************************************************************************************************

    //==========================================================================================================
    //#region ЛИСТ 02
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'); i++)
    {
      #SetVisF('Файл/Документ/Прибыль/РасчНал'+getIter(i));
    }
    //#endregion ЛИСТ 02
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ЛИСТ 03
    //----------------------------------------------------------------------------------------------------------
    {
      #SetVisF('Файл/Документ/Прибыль/НалУдНА');
    }
    //#endregion ЛИСТ 03
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ЛИСТ 04
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалДохСтав'); i++)
    {
      #SetVisF('Файл/Документ/Прибыль/НалДохСтав'+getIter(i));
    }
    //#endregion ЛИСТ 04
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ЛИСТ 05 (ДО 01.01.2015)
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалБазОпОсобС'); i++)
    {
      #SetVisF('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i));
    }
    //#endregion ЛИСТ 05 (ДО 01.01.2015)
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ЛИСТ 05 (С 01.01.2015)
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалБазОпОсобН'); i++)
    {
      #SetVisF('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i));
    }
    //#endregion ЛИСТ 05 (С 01.01.2015)
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ЛИСТ 06
    //----------------------------------------------------------------------------------------------------------
    {
      #SetVisF('Файл/Документ/Прибыль/ДохРасНалБазаНПФ');
    }
    //#endregion ЛИСТ 06
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ЛИСТ 07
    //----------------------------------------------------------------------------------------------------------
    {
      #SetVisF('Файл/Документ/Прибыль/ЦелИспИмущ');
    }
    //#endregion ЛИСТ 07
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ПРИЛОЖЕНИЕ 1 К ДЕКЛАРАЦИИ
    //----------------------------------------------------------------------------------------------------------
    {
      #SetVisF('Файл/Документ/Прибыль/ДохНеУч_РасхУч');
    }
    //#endregion ПРИЛОЖЕНИЕ 1 К ДЕКЛАРАЦИИ
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/СведДохФЛ'); i++)
    {
      #SetVisF('Файл/Документ/Прибыль/СведДохФЛ'+getIter(i));
    }
    //#endregion ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ
    //**********************************************************************************************************
  }
@end.
//#endregion On_Visable ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ УСТАНОВКЕ ВИДИМОСТИ ПОЛЕЙ
//**********************************************************************************************************


//============================================================================================================
//#region On_Check ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ПРОВЕРКЕ ПОЛЕЙ
//------------------------------------------------------------------------------------------------------------
@Script On_Check : boolean;
  //==========================================================================================================
  //#region СЕРВИС On_Check
  //----------------------------------------------------------------------------------------------------------
  #include AllTaxObj.Vih

  //----------------------------------------------------------------------------------------------------------
  //Контроль значения элемента ПоМесту в зависимости от значения элемента КПП
  function IsValidPoMestu_KPP(_PoMestu, _KPP: string; var strGetMes: string) : boolean;
  {
    strGetMes := 'Ошибка контроля значения элемента ПоМесту в зависимости от значения элемента КПП';

    Result := False;

    var bufKPP : string;
    bufKPP := subStr(_KPP, 5, 2);

    if (bufKPP = '50' and _PoMestu = '213')
    then Result := True
    else
    {
      if ((bufKPP = '01' or bufKPP = '50' or bufKPP = '4U') and _PoMestu = '218')
      then Result := True
      else
      {
        if (bufKPP <> '4U' and (    _PoMestu = '214' or _PoMestu = '215' or _PoMestu = '216' or _PoMestu = '220' or _PoMestu = '223'
                                 or _PoMestu = '225' or _PoMestu = '226' or _PoMestu = '228' or _PoMestu = '229' or _PoMestu = '231'
                                 or _PoMestu = '234' or _PoMestu = '235' or _PoMestu = '236' or _PoMestu = '237' ))
        then Result := True;
      }
    }
  };
  //----------------------------------------------------------------------------------------------------------
  //Контроль условий присутствия (отсутствия) Подраздела 1.1 Раздела 1 в зависимости от значения элементаПоМесту
  function IsValidR1P1_1(strIn: string; var strGetMes: string) : boolean;
  {
    strGetMes := 'Если ПоМесту имеет значение 231, 229 или 235, то Подраздел 1.1 Раздела 1 не заполненяется. При других значениях подраздел обязателен';

    Result := False;

    var i  : integer;
    var fl : boolean;   fl := False;

    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУАв'); i++)
      if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i))
      {
        fl := True;
        break;
      }

    if (strIn = '231' or strIn = '229' or strIn = '235')
    {
      if not fl Result := True;
    }
    else
    {
      if fl Result := True;
    };
  };
  //----------------------------------------------------------------------------------------------------------
  //Контроль условий присутствия (отсутствия) Подраздела 1.2 Раздела 1 в зависимости от значения элементов ПоМесту и Период
  function IsValidR1P1_2(strInPoMestu, strInPeriod: string; var strGetMes: string) : boolean;
  {
    strGetMes := 'Если ПоМесту имеет значение 231 или Период имеет значение 34, 46, 50 или 68, то Подраздел 1.2 Раздела 1 не заполненяется. При других значениях подраздел не обязателен';

    Result := False;

    var i  : integer;
    var fl : boolean;   fl := False;

    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУМес'); i++)
      if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i))
      {
        fl := True;
        break;
      }

    if (strInPoMestu = '231' or (strInPeriod = '34' or strInPeriod = '46' or strInPeriod = '50' or strInPeriod = '68'))
    {
      if not fl Result := True;
    }
    else Result := True;
  };
  //----------------------------------------------------------------------------------------------------------
  //Контроль условий присутствия (отсутствия) Подраздела 1.3 Раздела 1 в зависимости от значения элемента ПоМесту
  function IsValidR1P1_3(strIn: string; var strGetMes: string) : boolean;
  {
    strGetMes := 'Если ПоМесту имеет значение 231, то Подраздел 1.3 Раздела 1 обязателен к заполнению. При других значениях подраздел не обязателен';

    Result := True;

    var i  : integer;
    var fl : boolean;   fl := False;

    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУПроц'); i++)
      if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i))
      {
        fl := True;
        break;
      }

    if (strIn = '231' and not fl)
    then Result := False;
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidKvIschislAv(strIn: string; var strGetMes: string) : boolean;
  {
    //Квартал, на который исчисляются авансовые платежи
    //КвИсчислАв

    strGetMes := 'Возможные значения: 21 или 24. Формат: 2 символа';

    Result := False;
    Result := CheckError.isRegExpr('^(21|24)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidVidPlat(strIn: string; var strGetMes: string) : boolean;
  {
    //Вид платежа (код)
    //ВидПлат

    strGetMes := 'Возможные значения: 1, 2, 3, 4 или 5. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2|3|4|5)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidPeriod(strIn: string; var strGetMes: string) : boolean;
  {
    //Налоговый период
    //Период

    strGetMes := 'Возможные значения: 13, 14, 15, 16, 21, 31, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 50, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68. Формат: 2 символа';

    Result := False;
    Result :=    CheckError.isRegExpr('^(13|14|15|16|21|31|33|34|35|36|37|38|39|40)$', strIn)
              or CheckError.isRegExpr('^(41|42|43|44|45|46|50|57|58|59|60|61|62|63)$', strIn)
              or CheckError.isRegExpr('^(64|65|66|67|68)$'                           , strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidPoMestu(strIn: string; var strGetMes: string) : boolean;
  {
    //По месту нахождения (учета)
    //ПоМесту

    strGetMes := 'Возможные значения: 213, 214, 215, 216, 218, 220, 223, 225, 226, 228, 229, 231, 234, 235. Формат: 3 символа';

    Result := False;
    Result := CheckError.isRegExpr('^(213|214|215|216|218|220|223|225|226|228|229|231|234|235)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidTipNP(strIn: string; var strGetMes: string) : boolean;
  {
    //Признак налогоплательщика (код)
    //ТипНП

    strGetMes := 'Возможные значения: 1, 2, 3, 4. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2|3|4)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidTipNP_2(strIn: string; var strGetMes: string) : boolean;
  {
    //Признак налогоплательщика (код)
    //ТипНП

    strGetMes := 'Возможные значения: 1, 3, 4, 5. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|3|4|5)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidMetodNachAmort(strIn: string; var strGetMes: string) : boolean;
  {
    //Метод начисления амортизации
    //МетодНачАморт

    strGetMes := 'Возможные значения: 1, 2. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidTipNP_3(strIn: string; var strGetMes: string) : boolean;
  {
    //Признак налогоплательщика (код)
    //ТипНП

    strGetMes := 'Возможные значения: 1, 2, 3. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2|3)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidObRasch(strIn: string; var strGetMes: string) : boolean;
  {
    //Расчет составлен (код)
    //ОбРасч

    strGetMes := 'Возможные значения: 1, 2, 3, 4. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2|3|4)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidObyzUplNalOP(strIn: string; var strGetMes: string) : boolean;
  {
    //Отметка о возложении обязанности по уплате налога на обособленное подразделение
    //ОбязУплНалОП

    strGetMes := 'Возможные значения: 0, 1. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(0|1)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidKategorNA(strIn: string; var strGetMes: string) : boolean;
  {
    //Категория налогового агента
    //КатегорНА

    strGetMes := 'Возможные значения: 1, 2. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidVidDiv(strIn: string; var strGetMes: string) : boolean;
  {
    //Вид дивидендов
    //ВидДив

    strGetMes := 'Возможные значения: 1, 2. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidNalPer(strIn: string; var strGetMes: string) : boolean;
  {
    //Налоговый (отчетный) период
    //НалПер

    strGetMes := 'Возможные значения: 21, 31, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 50. Формат: 2 символа';

    Result := False;
    Result :=    CheckError.isRegExpr('^(21|31|33|34|35|36|37|38|39|40|41|42|43|44)$', strIn)
              or CheckError.isRegExpr('^(45|46|50)$'                                 , strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidPrPrinadl_A(strIn: string; var strGetMes: string) : boolean;
  {
    //Признак принадлежности
    //ПрПринадл

    strGetMes := 'Возможное значение: А. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(А)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidPrPrinadl_B(strIn: string; var strGetMes: string) : boolean;
  {
    //Признак принадлежности
    //ПрПринадл

    strGetMes := 'Возможное значение: Б. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(Б)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidVidDohod(strIn: string; var strGetMes: string) : boolean;
  {
    //Вид дохода
    //ВидДоход

    strGetMes := 'Возможное значение: 1, 2. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidVidDohod_2(strIn: string; var strGetMes: string) : boolean;
  {
    //Вид дохода
    //ВидДоход

    strGetMes := 'Возможное значение: 1, 2, 3, 4, 5, 6, 7. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2|3|4|5|6|7)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidVidOper(strIn: string; var strGetMes: string) : boolean;
  {
    //Вид операции
    //ВидОпер

    strGetMes := 'Возможное значение: 1, 2, 3, 4, 5. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2|3|4|5)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidTip(strIn: string; var strGetMes: string) : boolean;
  {
    //Тип
    //Тип

    strGetMes := 'Возможное значение: 00, 01-99. Формат: 2 цифры';

    Result := False;
    Result := CheckError.isRegExpr('^[0-9]{2}$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidStatusNP(strIn: string; var strGetMes: string) : boolean;
  {
    //Статус налогоплательщика
    //СтатусНП

    strGetMes := 'Возможное значение: 1, 2, 3, 4. Формат: 1 символ';

    Result := False;
    Result := CheckError.isRegExpr('^(1|2|3|4)$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidKodVidDohod(strIn: string; var strGetMes: string) : boolean;
  {
    //Код вида доходов
    //КодВидДоход

    strGetMes := 'Формат: 4 цифры';

    Result := False;
    Result := CheckError.isRegExpr('^[0-9]{4}$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  function IsValidKodVidRash(strIn: string; var strGetMes: string) : boolean;
  {
    //Код вида расходов
    //КодВидРасход

    strGetMes := 'Формат: 3 цифры';

    Result := False;
    Result := CheckError.isRegExpr('^[0-9]{3}$', strIn);
  };
  //----------------------------------------------------------------------------------------------------------
  //Проверка на соответствие текущего значения поля Период значению Год
  function _NalPer_God : boolean;
  begin
    var val : Integer;
    val := GetIntVal('Файл/Документ/Период');

    Result := False;
    Result := ((val = 16) or (val = 34) or (val = 46) or (val = 68));
  end;
  //----------------------------------------------------------------------------------------------------------
  //Проверка на соответствие текущего значения поля Период значению 11 или 9 месяцев
  function _NalPer_9_11 : boolean;
  begin
    var val : Integer;
    val := GetIntVal('Файл/Документ/Период');

    Result := False;
    Result := ((val = 15) or (val = 33) or (val = 43) or (val = 45) or (val = 65) or (val = 67));
  end;
  //----------------------------------------------------------------------------------------------------------
  //Проверка на соответствие текущего значения поля Период значению 1го квартала или года
  function _NalPer_1kv_God : boolean;
  begin
    var val : Integer;
    val := GetIntVal('Файл/Документ/Период' );

    Result := False;
    Result := ((val = 13) or (val = 16) or (val = 21) or (val = 34) or (val = 46) or (val = 68));
  end;

  #declare _NoKor(_adrXML, _Pole)
    MessageErrorStop_ALG
    (
      #_adrXML,
      NameStr,
      #_Pole,
      'Поле не соответствует формату. ' + getMes
    );
  #end

  #declare _IsValidNoKorIter(_Valid, _adrXML, _Pole, _Iter)
    if not #_Valid(GetStrVal(#_adrXML), getMes)
      MessageErrorStop_ALG
      (
        #_adrXML,
        NameStr,
        #_Pole,
        'Поле не соответствует формату. ' + getMes,
        #_Iter
      );
  #end

  #declare _IsValidNoKor(_Valid, _adrXML, _Pole)
    if not #_Valid(GetStrVal(#_adrXML), getMes)
      MessageErrorStop_ALG
      (
        #_adrXML,
        NameStr,
        #_Pole,
        'Поле не соответствует формату. ' + getMes
      );
  #end

  #declare _IsValidNoKorVis(_Valid, _adrXML, _Pole)
    if GetFldVisInTree(#_adrXML)
      if not #_Valid(GetStrVal(#_adrXML), getMes)
        MessageErrorStop_ALG
        (
          #_adrXML,
          NameStr,
          #_Pole,
          'Поле не соответствует формату. ' + getMes
        );
  #end

  #declare _IsValidNoKorVis_I(_Valid, _adrXML, _Pole, _Iter)
    if GetFldVisInTree(#_adrXML)
      if not #_Valid(GetStrVal(#_adrXML), getMes)
        MessageErrorStop_ALG
        (
          #_adrXML,
          NameStr,
          #_Pole,
          'Поле не соответствует формату. ' + getMes,
          #_Iter
        );
  #end

  #declare _IsValidNoKorVis_Lic(_adrXML, _Count, _Pole)
    if GetFldVisInTree(#_adrXML)
      if not IsValidLenStr(GetStrVal(#_adrXML), #_Count, #_Count, getMes)
        MessageErrorStop_ALG
        (
          #_adrXML,
          NameStr,
          #_Pole,
          'Поле не соответствует формату. ' + getMes
        );
  #end

  #declare _IsValidNoKorVis_Number_I(_adrXML, _Min, _Max, _Pole, _Iter, _flMin=False)
    if GetFldVisInTree(#_adrXML)
      if not IsValidLenNumber(GetStrVal(#_adrXML), #_Min, #_Max, getMes, #_flMin)
        MessageErrorStop_ALG
        (
          #_adrXML,
          NameStr,
          #_Pole,
          'Поле не соответствует формату. ' + getMes,
          #_Iter
        );
  #end

  #declare _IsValidNoKorVis_Number(_adrXML, _Min, _Max, _Pole, _flMin=False)
    if GetFldVisInTree(#_adrXML)
      if not IsValidLenNumber(GetStrVal(#_adrXML), #_Min, #_Max, getMes, #_flMin)
        MessageErrorStop_ALG
        (
          #_adrXML,
          NameStr,
          #_Pole,
          'Поле не соответствует формату. ' + getMes
        );
  #end

  #declare _IsValidNoKor_Number(_adrXML, _Min, _Max, _Pole, _flMin=False)
    if not IsValidLenNumber(GetStrVal(#_adrXML), #_Min, #_Max, getMes, #_flMin)
      MessageErrorStop_ALG
      (
        #_adrXML,
        NameStr,
        #_Pole,
        'Поле не соответствует формату. ' + getMes
      );
  #end

  #declare _IsValidNoKor_Decimal(_StrMes,_adrXML, _Cel, _Drob, _Pole, _flMin=False)
    if not IsValidDecimal(GetStrVal(#_adrXML), #_Cel, #_Drob, getMes, #_flMin)
      MessageErrorStop_ALG
      (
        #_adrXML,
        NameStr,
        #_Pole,
        'Поле не соответствует формату. Формат поля '+  #_StrMes + getMes
      );
  #end

  #declare _IsValidNoKor_Decimal_I(_StrMes,_adrXML, _Cel, _Drob, _Pole, _Iter, _flMin=False)
    if not IsValidDecimal(GetStrVal(#_adrXML), #_Cel, #_Drob, getMes, #_flMin)
      MessageErrorStop_ALG
      (
        #_adrXML,
        NameStr,
        #_Pole,
        'Поле не соответствует формату. Формат поля '+  #_StrMes + getMes  ,
        #_Iter
      );
  #end

  #declare _IsValidNoKorVis_Decimal(_StrMes,_adrXML, _Cel, _Drob, _Pole, _flMin=False)
    if GetFldVisInTree(#_adrXML)
      if not IsValidDecimal(GetStrVal(#_adrXML), #_Cel, #_Drob, getMes, #_flMin)
        MessageErrorStop_ALG
        (
          #_adrXML,
          NameStr,
          #_Pole,
          'Поле не соответствует формату. Формат поля '+  #_StrMes + getMes
        );
  #end

  #declare _IsValidNoKor_Str(_adrXML, _Min, _Max, _Pole)
    if not IsValidLenStr(GetStrVal(#_adrXML), #_Min, #_Max, getMes)
      MessageErrorStop_ALG
      (
        #_adrXML,
        NameStr,
        #_Pole,
        'Поле не соответствует формату. ' + getMes
      );
  #end

  #declare _IsValidNoKor_Str_I(_adrXML, _Min, _Max, _Pole, _Iter)
    if not IsValidLenStr(GetStrVal(#_adrXML), #_Min, #_Max, getMes)
      MessageErrorStop_ALG
      (
        #_adrXML,
        NameStr,
        #_Pole,
        'Поле не соответствует формату. ' + getMes,
        #_Iter
      );
  #end

  #declare _IsValidNoKorVis_Str(_adrXML, _Min, _Max, _Pole)
    if GetFldVisInTree(#_adrXML)
      if not IsValidLenStr(GetStrVal(#_adrXML), #_Min, #_Max, getMes)
        MessageErrorStop_ALG
        (
          #_adrXML,
          NameStr,
          #_Pole,
          'Поле не соответствует формату. ' + getMes
        );
  #end

  #declare _IsValidNoKorVis_Str_I(_adrXML, _Min, _Max, _Pole, _Iter)
    if GetFldVisInTree(#_adrXML)
      if not IsValidLenStr(GetStrVal(#_adrXML), #_Min, #_Max, getMes)
        MessageErrorStop_ALG
        (
          #_adrXML,
          NameStr,
          #_Pole,
          'Поле не соответствует формату. ' + getMes,
          #_Iter
        );
  #end
  //----------------------------------------------------------------------------------------------------------
  function IsValidLic(_adrXML, NameStr: string) : boolean;
  {
    //Проверка лицензии
    var getMes : string;

    #_IsValidNoKorVis_Lic(_adrXML + '/СерЛицНедр', 3, 'Лицензия: серия'           );
    #_IsValidNoKorVis_Lic(_adrXML + '/НомЛицНедр', 5, 'Лицензия: номер'           );
    #_IsValidNoKorVis_Lic(_adrXML + '/ВидЛицНедр', 2, 'Лицензия: вид'             );
    #_IsValidNoKorVis_Lic(_adrXML + '/НомМорМест', 2, 'Лицензия: порядковый номер');
  };
  //#endregion СЕРВИС On_Check
  //**********************************************************************************************************
@begin
  var fl, flKPP, flRavKPP, flP5L2, flPovtorKPP : boolean;
  var i, j, k : integer;
  var getMes, NameStr, KPPTitul : string;
  var bufL03RA_120, bufL03RB_050, bufL04_080_Vid1_2, bufL04_080_Vid4, bufL04_080_Vid5, bufR1P1_040, bufR1P2_Sum, bufL2P5v1_080 : double;

  KPPTitul := GetStrVal('Файл/Документ/СвНП/НПЮЛ/КПП');
  flRavKPP := (GetPatVal('&СобсОрг[Рез:КПП]') = KPPTitul);

  flKPP       := False;
  flP5L2      := False;
  flPovtorKPP := False;

  //==========================================================================================================
  //#region ИЗ XSD
  //----------------------------------------------------------------------------------------------------------
  NameStr := 'Структура';

  if not IsValidR1P1_1(GetStrVal('Файл/Документ/ПоМесту'), getMes)
  then MessageErrorStop_ALG('Файл/Документ/ПоМесту', NameStr, 'По месту', getMes);

  if not IsValidR1P1_2(GetStrVal('Файл/Документ/ПоМесту'), GetStrVal('Файл/Документ/Период'), getMes)
  then MessageErrorStop_ALG('Файл/Документ/ПоМесту', NameStr, 'По месту', getMes);

  if not IsValidR1P1_3(GetStrVal('Файл/Документ/ПоМесту'), getMes)
  then MessageErrorStop_ALG('Файл/Документ/ПоМесту', NameStr, 'По месту', getMes);
  //#endregion ИЗ XSD
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ТИТУЛЬНЫЙ ЛИСТ
  //----------------------------------------------------------------------------------------------------------
  NameStr := pFH.Func('myGetPage_Title');

  if not IsValidPoMestu_KPP(GetStrVal('Файл/Документ/ПоМесту'), GetStrVal('Файл/Документ/СвНП/НПЮЛ/КПП'), getMes)
  then MessageErrorStop_ALG('Файл/Документ/ПоМесту', NameStr, 'По месту', getMes);

  if not IsValidKND(GetStrVal('Файл/Документ/КНД'), '1151006', getMes)
    #_NoKor('Файл/Документ/КНД', 'Код налоговой декларации');

  #_IsValidNoKor   (IsValidDate   , 'Файл/Документ/ДатаДок'          , 'Дата документа'             );
  #_IsValidNoKor   (IsValidOtchGod, 'Файл/Документ/ОтчетГод'         , 'Отчетный год'               );
  #_IsValidNoKor   (IsValidSONO   , 'Файл/Документ/КодНО'            , 'Код налогового органа'      );
  #_IsValidNoKor   (IsValidPeriod , 'Файл/Документ/Период'           , 'Налоговый период'           );
  #_IsValidNoKor   (IsValidNomKorr, 'Файл/Документ/НомКорр'          , 'Номер корректировки'        );
  #_IsValidNoKor   (IsValidPoMestu, 'Файл/Документ/ПоМесту'          , 'По месту нахождения (учета)');
  #_IsValidNoKor   (IsValidOKVED  , 'Файл/Документ/СвНП/ОКВЭД'       , 'Код ОКВЭД'                  );
  #_IsValidNoKor   (IsValidNaimOrg, 'Файл/Документ/СвНП/НПЮЛ/НаимОрг', 'Наименование организации'   );
  #_IsValidNoKor   (IsValidINNUL  , 'Файл/Документ/СвНП/НПЮЛ/ИННЮЛ'  , 'ИНН'                        );   #_IsValidNoKor(CheckError.Prov_INN, 'Файл/Документ/СвНП/НПЮЛ/ИННЮЛ', 'ИНН');
  #_IsValidNoKor   (IsValidKPP    , 'Файл/Документ/СвНП/НПЮЛ/КПП'    , 'КПП'                        );
  #_IsValidNoKor   (IsValidPrPodp , 'Файл/Документ/Подписант/ПрПодп' , 'Признак подписанта'         );
  #_IsValidNoKorVis(IsValidTlf    , 'Файл/Документ/СвНП/Тлф'         , 'Контактный телефон'         );

  if GetFldVisInTree('Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ')
  {
    #_IsValidNoKor   (IsValidFormReorg, 'Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ФормРеорг', 'Форма реоргазации');
    #_IsValidNoKorVis(IsValidINNUL    , 'Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ИННЮЛ'    , 'ИНН'              );   #_IsValidNoKorVis(CheckError.Prov_INN, 'Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/ИННЮЛ', 'ИНН');
    #_IsValidNoKorVis(IsValidKPP      , 'Файл/Документ/СвНП/НПЮЛ/СвРеоргЮЛ/КПП'      , 'КПП'              );
  }

  #_IsValidNoKor   (IsValidFIO, 'Файл/Документ/Подписант/ФИО/Фамилия' , 'Фамилия' );
  #_IsValidNoKor   (IsValidFIO, 'Файл/Документ/Подписант/ФИО/Имя'     , 'Имя'     );
  #_IsValidNoKorVis(IsValidFIO, 'Файл/Документ/Подписант/ФИО/Отчество', 'Отчество');

  if GetFldVisInTree('Файл/Документ/Подписант/СвПред')
  {
    #_IsValidNoKor   (IsValidNaimDok, 'Файл/Документ/Подписант/СвПред/НаимДок', 'Наименование документа');
    #_IsValidNoKorVis(IsValidNaimOrg, 'Файл/Документ/Подписант/СвПред/НаимОрг', 'Наименование организации');
  }
  //#endregion ТИТУЛЬНЫЙ ЛИСТ
  //**********************************************************************************************************


  //==========================================================================================================
  //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.1
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУАв'); i++)
  {
    if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i))
    {
      NameStr := pFH.Func('myGetPage_R1P11', i+1);

      #_IsValidNoKor(IsValidOKTMO, 'Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ОКТМО', 'Стр. 010');

      if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж')
      {
        #_IsValidNoKor(IsValidKBK, 'Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж/КБК', 'Стр. 030');
        if ((GetStrVal('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж/КБК')<>'18210101011011000110') and (GetStrVal('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж/КБК')<>'18210101013011000110') )
          MessageWarningStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж/КБК', NameStr, 'Стр. 010', 'Возможна ошибка при выборе КБК, убедитесь в правильности выбранного КБК');

        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/ФедБдж/НалПУ', 1, 15, 'Стр. 040/050', True);
      }

      if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж')
      {
        #_IsValidNoKor(IsValidKBK, 'Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж/КБК', 'Стр. 060');
        if ((GetStrVal('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж/КБК')<>'18210101012021000110') )
          MessageWarningStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж/КБК', NameStr, 'Стр. 060', 'Возможна ошибка при выборе КБК, убедитесь в правильности выбранного КБК = "18210101011011000110" или "18210101013011000110"');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалПУ/НалПУАв'+getIter(i)+'/СубБдж/НалПУ', 1, 15, 'Стр. 070/080', True);
      }
    }
  }
  //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.1
  //**********************************************************************************************************


  //==========================================================================================================
  //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУМес'); i++)
  {
    if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i))
    {
      NameStr := pFH.Func('myGetPage_R1P12', i+1);
      if (GetStrVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/КвИсчислАв')<>'')
        if (GetStrVal('Файл/Документ/Период')<>'15' and GetStrVal('Файл/Документ/Период')<>'33' )
        then MessageErrorStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/КвИсчислАв', NameStr, 'Стр. 001', 'Реквизит "Квартал, на который исчисляются ежемесячные авансовые платежи" заполняется только в декларациях за 9 месяцев')
      else
        #_IsValidNoKorVis(IsValidKvIschislAv, 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/КвИсчислАв', 'Стр. 001');
      #_IsValidNoKor   (IsValidOKTMO      , 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ОКТМО'     , 'Стр. 010');

      if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж')
      {
        #_IsValidNoKor(IsValidKBK, 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/КБК', 'Стр. 110');
        if ((GetStrVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/КБК')<>'18210101011011000110') and (GetStrVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/КБК')<>'18210101013011000110') )
          MessageWarningStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/КБК', NameStr, 'Стр. 110', 'Возможна ошибка при выборе КБК, убедитесь в правильности выбранного КБК = "18210101011011000110" или "18210101013011000110"');

        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат1', 1, 15, 'Стр. 120');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат2', 1, 15, 'Стр. 130');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат3', 1, 15, 'Стр. 140');
      }

      if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж')
      {
        #_IsValidNoKor(IsValidKBK, 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/КБК', 'Стр. 210');
        if ((GetStrVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/КБК')<>'18210101012021000110') )
        then MessageWarningStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/КБК', NameStr, 'Стр. 210', 'Возможна ошибка при выборе КБК, убедитесь в правильности выбранного КБК = "18210101012021000110"');

        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат1', 1, 15, 'Стр. 220');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат2', 1, 15, 'Стр. 230');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат3', 1, 15, 'Стр. 240');
      }
    }
  }
  //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
  //**********************************************************************************************************


  //==========================================================================================================
  //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.3
  //----------------------------------------------------------------------------------------------------------
    //==========================================================================================================
    //#region ПОЛУЧЕНИЕ ДАННЫХ
    //----------------------------------------------------------------------------------------------------------
    bufL03RA_120      := 0;
    bufL03RB_050      := 0;
    bufL04_080_Vid1_2 := 0;
    bufL04_080_Vid4   := 0;
    bufL04_080_Vid5   := 0;

    //==========================================================================================================
    //#region ЛИСТ 03
    //----------------------------------------------------------------------------------------------------------
      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 03 (СТР. 1)
      //----------------------------------------------------------------------------------------------------------
      for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУМес'); i++)
      {
        if     GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)              )
           and GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалДивПосл')
        then bufL03RA_120 := bufL03RA_120 + GetDblVal('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалДивПосл');
      }
      //#endregion ЛИСТ 03 (СТР. 1)
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 03 (СТР. 2)
      //----------------------------------------------------------------------------------------------------------
      for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'); i++)
      {
        if     GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)                 )
           and GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалНачислПосл')
        then bufL03RB_050 := bufL03RB_050 + GetDblVal('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалНачислПосл');
      }
      //#endregion ЛИСТ 03 (СТР. 2)
      //----------------------------------------------------------------------------------------------------------
    //#endregion ЛИСТ 03
    //**********************************************************************************************************


    //----------------------------------------------------------------------------------------------------------
    //#region ЛИСТ 04
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалДохСтав'); i++)
    {
      if     GetFldVisInTree('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/ВидДоход'     )
         and GetFldVisInTree('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПосл')
      {
        case GetStrVal('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/ВидДоход') of
          '1'
         ,'2' : bufL04_080_Vid1_2 := bufL04_080_Vid1_2 + GetDblVal('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПосл');
          '4' : bufL04_080_Vid4   := bufL04_080_Vid4   + GetDblVal('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПосл');
          '5' : bufL04_080_Vid5   := bufL04_080_Vid5   + GetDblVal('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПосл');
        end;
      }
    }
    //#endregion ЛИСТ 04
    //----------------------------------------------------------------------------------------------------------
    //#endregion ПОЛУЧЕНИЕ ДАННЫХ
    //----------------------------------------------------------------------------------------------------------

  bufR1P1_040 := 0;

  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУПроц'); i++)
  {
    if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i))
    {
      NameStr := pFH.Func('myGetPage_R1P13', i+1);

      #_IsValidNoKor(IsValidVidPlat, 'Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/ВидПлат', 'Стр. 010');
      #_IsValidNoKor(IsValidOKTMO  , 'Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/ОКТМО'  , 'Стр. 020');
      #_IsValidNoKor(IsValidKBK    , 'Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/КБК'    , 'Стр. 030');

      fl := False;

      for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'); j++)
      {
        if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'+getIter(j))
        {
          fl := True;
          #_IsValidNoKorIter        (IsValidDate, 'Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'+getIter(j)+'/Срок' ,        if(j<9, '0', '')+String(j+1)+': Срок уплаты' , if(i=0,-1,1));
          #_IsValidNoKorVis_Number_I(             'Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'+getIter(j)+'/НалПУ', 1, 15, if(j<9, '0', '')+String(j+1)+': Сумма налога', if(i=0,-1,1));

          if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'+getIter(j)+'/НалПУ')
          then bufR1P1_040 := bufR1P1_040 + GetDblVal('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/УплСрок'+getIter(j)+'/НалПУ');
        }
      }

      if not fl MessageErrorStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУПроц/УплСрок/Срок', NameStr, 'Срок уплаты / Сумма налога', 'Обязательна к заполнению хотябы 1а строка с информацией');

      if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/ВидПлат')
      {
        case GetStrVal('Файл/Документ/Прибыль/НалПУ/НалПУПроц'+getIter(i)+'/ВидПлат') of
          '1' : {
                  if (bufL03RA_120 <> bufR1P1_040)
                  then MessageErrorStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУПроц/УплСрок/НалПУ', NameStr, 'Сумма налога', 'Если стр. 010 = 1, то сумма налога по стр. 040 должна быть равна сумме строк 120 Разд. А Листа 03');
                }
          '2' : {
                  if (bufL03RB_050 <> bufR1P1_040)
                  then MessageErrorStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУПроц/УплСрок/НалПУ', NameStr, 'Сумма налога', 'Если стр. 010 = 2, то сумма налога по стр. 040 должна быть равна сумме строк 050 Разд. Б Листа 03');
                }
          '3' : {
                  if (bufL04_080_Vid1_2 <> bufR1P1_040)
                  then MessageErrorStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУПроц/УплСрок/НалПУ', NameStr, 'Сумма налога', 'Если стр. 010 = 3, то сумма налога по стр. 040 должна быть равна сумме строк 080 Листа 040 (с полем Вид = 1, 2)');
                }
          '4' : {
                  if (bufL04_080_Vid4 <> bufR1P1_040)
                  then MessageErrorStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУПроц/УплСрок/НалПУ', NameStr, 'Сумма налога', 'Если стр. 010 = 4, то сумма налога по стр. 040 должна быть равна сумме строк 080 Листа 040 (с полем Вид = 4)');
                }
          '5' : {
                  if (bufL04_080_Vid5 <> bufR1P1_040)
                  then MessageErrorStop_ALG('Файл/Документ/Прибыль/НалПУ/НалПУПроц/УплСрок/НалПУ', NameStr, 'Сумма налога', 'Если стр. 010 = 5, то сумма налога по стр. 040 должна быть равна сумме строк 080 Листа 040 (с полем Вид = 6)');
                }
        end;
      }
    }
  }
  //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.3
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 02
  //----------------------------------------------------------------------------------------------------------
    //==========================================================================================================
    //#region ПОЛУЧЕНИЕ ДАННЫХ
    //----------------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------------
    //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
    //----------------------------------------------------------------------------------------------------------
    bufR1P2_Sum := 0;

    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУМес'); i++)
    {
      if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i))
      {
        if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат1') then bufR1P2_Sum := bufR1P2_Sum + GetDblVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат1');
        if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат2') then bufR1P2_Sum := bufR1P2_Sum + GetDblVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат2');
        if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат3') then bufR1P2_Sum := bufR1P2_Sum + GetDblVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат3');
        if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат1') then bufR1P2_Sum := bufR1P2_Sum + GetDblVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат1');
        if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат2') then bufR1P2_Sum := bufR1P2_Sum + GetDblVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат2');
        if GetFldVisInTree('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат3') then bufR1P2_Sum := bufR1P2_Sum + GetDblVal('Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат3');

      }
    }
    //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
    //----------------------------------------------------------------------------------------------------------
    //#endregion ПОЛУЧЕНИЕ ДАННЫХ
    //----------------------------------------------------------------------------------------------------------

  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'); i++)
  {
    if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i))
    {
      NameStr := pFH.Func('myGetPage_L2_1', i+1);

      #_IsValidNoKor(IsValidTipNP, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ТипНП', 'Признак налогоплательщика (код)');

      IsValidLic('Файл/Документ/Прибыль/РасчНал'+getIter(i), NameStr);

      #_IsValidNoKorVis_Decimal('XX.XX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалВсего' , 2,  2, 'Стр. 140');
      #_IsValidNoKorVis_Decimal('XX.XX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалФБ'    , 2,  2, 'Стр. 150');
      #_IsValidNoKorVis_Decimal('XX.XX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалСуб'   , 2,  2, 'Стр. 160');
      #_IsValidNoKorVis_Decimal('XX.XX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалСуб284', 2,  2, 'Стр. 170');

      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеал'      , 1, 15, 'Стр. 010');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохВнереал'   , 1, 15, 'Стр. 020');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхУмРеал'   , 1, 15, 'Стр. 030');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхВнереал'  , 1, 15, 'Стр. 040');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/Убытки'       , 1, 15, 'Стр. 050');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ПрибУб'       , 1, 15, 'Стр. 060');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохИсклПриб'  , 1, 15, 'Стр. 070');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ПрибБРСт0'    , 1, 15, 'Стр. 080');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СумЛьгот'     , 1, 15, 'Стр. 090');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБаза'      , 1, 15, 'Стр. 100');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУмНБ'     , 1, 15, 'Стр. 110');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБазаИсч'   , 1, 15, 'Стр. 120');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБазаИсчСуб', 1, 15, 'Стр. 130');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчисл'    , 1, 15, 'Стр. 180');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислФБ'  , 1, 15, 'Стр. 190');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб' , 1, 15, 'Стр. 200');

      if (GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхПризнИтого')<>GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхУмРеал'))
      then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхУмРеал', NameStr, 'Стр. 030', 'В закладке "Лист 02 ('+getIter(i+1)+')"  стр.030 не равна стр.130 соответствующего приложения 2');

      var L2_r120, L2_r190, L2_z150, L2_z130, L2_z160, L2_z170, L2_r200 : double;
      L2_r120 :=  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБазаИсч'   );
      L2_z130 :=  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБазаИсчСуб');
      L2_z150 :=  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалФБ'    );
      L2_z160 :=  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалСуб'   );
      L2_z170 :=  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалСуб284');
      if L2_r120 > 0
      {
        L2_r190 := round(L2_r120 * L2_z150 / 100)                                        ;
        L2_r200 := round((L2_r120 - L2_z130) * L2_z160 / 100 + (L2_z130 * L2_z170 / 100));
        if (GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислФБ')<>L2_r190)
        then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислФБ', NameStr, 'Стр. 190', 'Возможна ошибка в сумме налога Стр. 190 = стр. 120 * стр. 150 / 100');

        if (GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб')<>L2_r200)
        then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб', NameStr, 'Стр. 200', 'Возможна ошибка в сумме налога Стр. 200 = (стр. 120 - стр. 130) * стр. 160 / 100 + (стр. 130 * стр. 170 / 100)');
      }
      else
      {
        L2_r190 := 0;
        L2_r200 := round((-1 * L2_z130) * L2_z160 / 100 + (L2_z130 * L2_z170 / 100));
        if (GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб')<>L2_r200)
        then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб', NameStr, 'Стр. 200', 'Возможна ошибка в сумме налога Стр. 200 := (-1 * стр. 130) * стр. 160 / 100 + (стр. 130 * стр. 170 / 100)');
      }

      NameStr := pFH.Func('myGetPage_L2_2', i+1);
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачисл'       , 1, 15, 'Стр. 210');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислФБ'     , 1, 15, 'Стр. 220');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислСуб'    , 1, 15, 'Стр. 230');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311'     , 1, 15, 'Стр. 240');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311ФБ'   , 1, 15, 'Стр. 250');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311Суб'  , 1, 15, 'Стр. 260');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалДоплФБ'      , 1, 15, 'Стр. 270');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалДоплСуб'     , 1, 15, 'Стр. 271');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалУменФБ'      , 1, 15, 'Стр. 280');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалУменСуб'     , 1, 15, 'Стр. 281');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМес'      , 1, 15, 'Стр. 290');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесФБ'    , 1, 15, 'Стр. 300');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесСуб'   , 1, 15, 'Стр. 310');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1Кв'   , 1, 15, 'Стр. 320');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1КвФБ' , 1, 15, 'Стр. 330');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1КвСуб', 1, 15, 'Стр. 340');

      if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб')>
         GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислСуб')+
         GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311Суб')
        if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалДоплСуб')<>
           GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб')-
           GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислСуб')-
           GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311Суб')
       then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалДоплСуб', NameStr, 'Стр. 271', 'Показатель по строке 271 должен быть равен выражению Стр.200 - Стр.230 - Стр.260');

      //Показатели по строкам 240 - 260 не больше показателей по строкам 180 - 200
      if (GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311') > GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчисл'))
      then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311', NameStr, 'Стр. 240', 'Показатель по строке 240 должен быть не больше показателя по строке 180');

      if (GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311ФБ') > GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислФБ'))
      then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311ФБ', NameStr, 'Стр. 250', 'Показатель по строке 250 должен быть не больше показателя по строке 190');

      if (GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311Суб') > GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб'))
      then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311Суб', NameStr, 'Стр. 260', 'Показатель по строке 260 должен быть не больше показателя по строке 200');

      //Показатели по строкам 290 - 310 не заполняются за налоговый период
      if (_NalPer_God)
      {
        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМес')
        then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМес', NameStr, 'Стр. 290', 'Показатель по строке 290 не заполняются за налоговый период');

        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесФБ')
        then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесФБ', NameStr, 'Стр. 300', 'Показатель по строке 300 не заполняются за налоговый период');

        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесСуб')
        then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесСуб', NameStr, 'Стр. 310', 'Показатель по строке 310 не заполняются за налоговый период');
      }
      else
      {
        var L2_r300, L2_r310, L2_r290 : double;
        L2_r300 :=  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесФБ' );
        L2_r310 :=  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесСуб');
        L2_r290 := L2_r300 + L2_r310
        if  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМес' ) <>L2_r290
          then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМес', NameStr, 'Стр. 290', 'Cумма авансового платежа по стр.290 не равна сумме стр.300,310');
      }
      //Показатели по строкам 320 - 340 заполняются только в декларации 11 и 9 месяцев
      if (not _NalPer_9_11)
      {
        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1Кв')
        then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1Кв', NameStr, 'Стр. 320', 'Показатель по строке 320 заполняются только в декларации 11 и 9 месяцев');

        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1КвФБ')
        then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1КвФБ', NameStr, 'Стр. 330', 'Показатель по строке 330 заполняются только в декларации 11 и 9 месяцев');

        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1КвСуб')
        then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатУпл1КвСуб', NameStr, 'Стр. 340', 'Показатель по строке 340 заполняются только в декларации 11 и 9 месяцев');
      }

      if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМес') <> bufR1P2_Sum
      then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМес', NameStr, 'Стр. 290', 'Показатель по строке 290 должен быть равен сумме строк 120, 130, 140, 220, 230, 240 Разделп 1. Подразд. 1.2');

      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 1
      //----------------------------------------------------------------------------------------------------------
      if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал')
      {
        NameStr := pFH.Func('myGetPage_L2P1', i+1);

        #_IsValidNoKor(IsValidTipNP, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ТипНП', 'Признак налогоплательщика (код)');

        IsValidLic('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал', NameStr);

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалПред'  , 1, 15, 'Стр. 027');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалОпер32', 1, 15, 'Стр. 030');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалИтог'  , 1, 15, 'Стр. 040');

          if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал')
          {
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалВс'    , 1, 15, 'Стр. 010');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалТовСоб', 1, 15, 'Стр. 011');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалТовПок', 1, 15, 'Стр. 012');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалИмПрав', 1, 15, 'Стр. 013');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалИмПроч', 1, 15, 'Стр. 014');
          }

          if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ')
          {
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ВырРеалЦБВс'   , 1, 15, 'Стр. 020');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ОтклВырЦБОбр'  , 1, 15, 'Стр. 021');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ОтклВырЦБНеОбр', 1, 15, 'Стр. 022');
          }

          if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр')
          {
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр/ВырРеалЦБВс' , 1, 15, 'Стр. 023');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр/ОтклВырЦБМин', 1, 15, 'Стр. 024');
          }
        }

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохВс'     , 1, 15, 'Стр. 100');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохПр'     , 1, 15, 'Стр. 101');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохСт'     , 1, 15, 'Стр. 102');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохБезв'   , 1, 15, 'Стр. 103');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохИзл'    , 1, 15, 'Стр. 104');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохВРасх'  , 1, 15, 'Стр. 105');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохРынЦБДД', 1, 15, 'Стр. 106');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохКор'    , 1, 15, 'Стр. 107');

          //100 >= 101 + 102 + 103 + 104 + 105 + 106 + 107
          if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохВс'     ) <
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохПр'     ) +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохСт'     ) +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохБезв'   ) +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохИзл'    ) +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохВРасх'  ) +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохРынЦБДД') +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохКор'    )
          then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохВс', NameStr, 'Стр. 100', 'Показатель по строке 100 должен быть больше либо равен сумме строк 101, 102, 103, 104, 105, 106, 107');
        }
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 1
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 2
      //----------------------------------------------------------------------------------------------------------
      if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал')
      {
        NameStr := pFH.Func('myGetPage_L2P2_1', i+1);

        #_IsValidNoKor(IsValidTipNP, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/ТипНП', 'Признак налогоплательщика (код)');

        IsValidLic('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал', NameStr);

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхРеал'  , 1, 15, 'Стр. 010');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РеалИмущПрав'  , 1, 15, 'Стр. 059');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобрРеалИмущ', 1, 15, 'Стр. 060');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/АктивРеалПред' , 1, 15, 'Стр. 061');

          NameStr := pFH.Func('myGetPage_L2P2_2', i+1);
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобРеалЦБ'   , 1, 15, 'Стр. 070');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/СумОтклЦен'    , 1, 15, 'Стр. 071');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобРеалЦБОрг', 1, 15, 'Стр. 072');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/СумОтклЦенОрг' , 1, 15, 'Стр. 073');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхОпер32'    , 1, 15, 'Стр. 080');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытПрошОбсл'  , 1, 15, 'Стр. 090');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытРеалАмИм'  , 1, 15, 'Стр. 100');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытРеалЗемУч' , 1, 15, 'Стр. 110');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/НадбПокПред'   , 1, 15, 'Стр. 120');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхПризнИтого', 1, 15, 'Стр. 130');

          NameStr := pFH.Func('myGetPage_L2P2_1', i+1);

          if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхТорг')
          {
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхТорг/ПрямРасхТоргВс', 1, 15, 'Стр. 020');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхТорг/РеалПокТов'    , 1, 15, 'Стр. 030');
          }

          if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх')
          {
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/КосвРасхВс'      , 1, 15, 'Стр. 040');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/Налоги'          , 1, 15, 'Стр. 041');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхКапВл10'     , 1, 15, 'Стр. 042');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхКапВл30'     , 1, 15, 'Стр. 043');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхТрудИнв'     , 1, 15, 'Стр. 045');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхОргИнв'      , 1, 15, 'Стр. 046');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУчВс'     , 1, 15, 'Стр. 047');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУчСрокНП' , 1, 15, 'Стр. 048');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУч30пр'   , 1, 15, 'Стр. 049');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУчСрокРас', 1, 15, 'Стр. 050');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУчСрокАр' , 1, 15, 'Стр. 051');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/НИОКР'           , 1, 15, 'Стр. 052');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/НИОКРнеПолРез'   , 1, 15, 'Стр. 053');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/НИОКРПер'        , 1, 15, 'Стр. 054');
            #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/НИОКРПерНеРез'   , 1, 15, 'Стр. 055');

            //040 >= 041 + 042 + 043 + 045 + 046 + 047 + 052
            if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/КосвРасхВс' ) <
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/Налоги'     ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхКапВл10') +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхКапВл30') +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхТрудИнв') +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхОргИнв' ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/РасхЗемУчВс') +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/НИОКР'      )
            then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/КосвРасхВс', NameStr, 'Стр. 040', 'Показатель по строке 040 должен быть больше либо равен сумме строк 041, 042, 043, 045, 046, 047, 052');

            NameStr := pFH.Func('myGetPage_L2P2_2', i+1);
            if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхПризнИтого') <>
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхРеал'               ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхТорг/ПрямРасхТоргВс') +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/КосвРасхВс'        ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РеалИмущПрав'               ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобрРеалИмущ'             ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/АктивРеалПред'              ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобРеалЦБ'                ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/СумОтклЦен'                 ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобРеалЦБОрг'             ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/СумОтклЦенОрг'              ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхОпер32'                 ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытПрошОбсл'               ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытРеалАмИм'               ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытРеалЗемУч'              ) +
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/НадбПокПред'                )
            then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхПризнИтого', NameStr, 'Стр. 130', 'Показатель по строке 130 должен быть равен сумме строк стр.010,020,040, 059-120');
          }
        }

        NameStr := pFH.Func('myGetPage_L2P2_2', i+1);

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерЛ'   , 1, 15, 'Стр. 131');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерНмАЛ', 1, 15, 'Стр. 132');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерН'   , 1, 15, 'Стр. 133');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/СумАмортПерНмАН', 1, 15, 'Стр. 134');

          #_IsValidNoKorVis(IsValidMetodNachAmort, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/СумАморт/МетодНачАморт' , 'Стр. 135');
        }

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнеРеалВс'  , 1, 15, 'Стр. 200');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнереалПрДО', 1, 15, 'Стр. 201');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнереалРзрв', 1, 15, 'Стр. 202');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/УбытРеалПравТр' , 1, 15, 'Стр. 203');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхЛиквОС'     , 1, 15, 'Стр. 204');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхШтраф'      , 1, 15, 'Стр. 205');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхРынЦБДД'    , 1, 15, 'Стр. 206');

          //200 >= 201 + 202 + 203 + 204 + 205 + 206
          if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнеРеалВс'  ) <
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнереалПрДО') +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнереалРзрв') +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/УбытРеалПравТр' ) +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхЛиквОС'     ) +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхШтраф'      ) +
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхРынЦБДД'    )
          then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнеРеалВс', NameStr, 'Стр. 200', 'Показатель по строке 200 должен быть больше либо равен сумме строк 201, 202, 203, 204, 205, 206');
        }

        NameStr := pFH.Func('myGetPage_L2P2_3', i+1);

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн/УбытПриравнВс', 1, 15, 'Стр. 300');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн/УбытПрошПер'  , 1, 15, 'Стр. 301');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн/СумБезнадДолг', 1, 15, 'Стр. 302');
        }

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишВс', 1, 15, 'Стр. 400');

          for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишГод'); j++)
          {
            if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишГод'+getIter(j))
            {
              #_IsValidNoKorVis_I       (IsValidOtchGod, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишГод'+getIter(j)+'/Год'       ,        '40'+String(j+1)+': Год'  , if (i=0, -1, 1));
              #_IsValidNoKorVis_Number_I(                'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишГод'+getIter(j)+'/КорНБЛишВс', 1, 15, '40'+String(j+1)+': Сумма', if (i=0, -1, 1));
            }
          }
        }
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 2
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 3
      //----------------------------------------------------------------------------------------------------------
      if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер')
      {
        NameStr := pFH.Func('myGetPage_L2P3_1', i+1);

        #_IsValidNoKor(IsValidTipNP, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ТипНП', 'Признак налогоплательщика (код)');

        IsValidLic('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер', NameStr);

        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/КолОбРеалАИ'     , 1, 15, 'Стр. 010');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/КолОбРеалАИУб'   , 1, 15, 'Стр. 020');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалАИ'     , 1, 15, 'Стр. 030');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ОстСтРеалАИ'     , 1, 15, 'Стр. 040');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ПрибРеалАИ'      , 1, 15, 'Стр. 050');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалАИ'      , 1, 15, 'Стр. 060');

        NameStr := pFH.Func('myGetPage_L2P3_2', i+1);
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалТов'    , 1, 15, 'Стр. 180');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхРеалТов'     , 1, 15, 'Стр. 190');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытОбОбсл'      , 1, 15, 'Стр. 200');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытОбОбслНеобл' , 1, 15, 'Стр. 201');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ДохДоговДУИ'     , 1, 15, 'Стр. 210');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ДохДоговДУИ_ВнР' , 1, 15, 'Стр. 211');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхДоговДУИ'    , 1, 15, 'Стр. 220');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхДоговДУИ_ВнР', 1, 15, 'Стр. 221');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытДоговДУИ'    , 1, 15, 'Стр. 230');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ЦенРеалПрЗУ'     , 1, 15, 'Стр. 240');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/НеВозЗатрПрЗУ'   , 1, 15, 'Стр. 250');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПрЗУ'    , 1, 15, 'Стр. 260');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручОп302Ит'    , 1, 15, 'Стр. 340');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхОп302Ит'     , 1, 15, 'Стр. 350');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытОп302'       , 1, 15, 'Стр. 360');

        NameStr := pFH.Func('myGetPage_L2P3_1', i+1);
        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ/ВыручРеалПТДоСр' , 1, 15, 'Стр. 100');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ/ВыручРеалПТПосСр', 1, 15, 'Стр. 110');
        }

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ/СтоимРеалПТДоСр' , 1, 15, 'Стр. 120');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ/СтоимРеалПТПосСр', 1, 15, 'Стр. 130');
        }

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1/Убыт1Соот269', 1, 15, 'Стр. 140');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1/Убыт1Прев269', 1, 15, 'Стр. 150');
        }

        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2/Убыт2РеалПТ', 1, 15, 'Стр. 160');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2/Убыт2ВнРасх', 1, 15, 'Стр. 170');
        }
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 3
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 4
      //----------------------------------------------------------------------------------------------------------
      for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'); j++)
        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j))
        {
          NameStr := pFH.Func('myGetPage_L2P4', i+1, j+1);

          if not _NalPer_1kv_God
          then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ТипНП', NameStr, 'Признак налогоплательщика (код)',
                                    'Лист 02. Прил. 4 включается в состав Декларации только за I квартал и налоговый период. Обнулите данное поле, чтобы страница не попала в выгрузку');

          #_IsValidNoKor(IsValidTipNP_2, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ТипНП', 'Признак налогоплательщика (код)');

          IsValidLic('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j), NameStr);

          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачВс'   , 1, 15, 'Стр. 010');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытЗавСд'   , 1, 15, 'Стр. 135');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытЗавСдНач', 1, 15, 'Стр. 136');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НалБаза'        , 1, 15, 'Стр. 140');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБаза'  , 1, 15, 'Стр. 150');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБазаЗС', 1, 15, 'Стр. 151');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонВс'   , 1, 15, 'Стр. 160');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонЗС'   , 1, 15, 'Стр. 161');

          for (k := 0; k < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачПерГод'); k++)
          {
            if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачПерГод'+getIter(k))
            {
              #_IsValidNoKorVis_I       (IsValidOtchGod, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачПерГод'+getIter(k)+'/Год'    ,        if((k+5<10),'0','')+String(k+5)+'0: Год'  , if (i=0, -1, 1));
              #_IsValidNoKorVis_Number_I(                'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачПерГод'+getIter(k)+'/ОстУбыт', 1, 15, if((k+5<10),'0','')+String(k+5)+'0: Сумма', if (i=0, -1, 1));
            }
          }

          if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НалБаза' ) <> GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБаза' )
          then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НалБаза', NameStr, 'Стр. 140', 'Показатель по строке 140 не равен стр. 100 листа 02');

          //Показатель 150 не может быть больше показателя 140
          if     GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБаза')
             and GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НалБаза'      )
          {
            //Показатель 150 не может быть больше показателя 140

            if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБаза') >
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НалБаза'      )
            then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБаза', NameStr, 'Стр. 150', 'Показатель по строке 150 не может быть больше значения стр. 140');
          }

          //Показатель 151 не может быть больше 20% показателя 135.
          if     GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБазаЗС')
             and GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытЗавСд'   )
          {
            if  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБазаЗС') >
               (GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытЗавСд'   ) * 0.2)
            then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБазаЗС', NameStr, 'Стр. 151', 'Показатель по строке 151 не может быть больше 20% от значения стр. 135');
          }

          //Показатели по строкам 160, 161 заполняются за налоговый период
          if (not _NalPer_God)
          {
            if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонВс')
            then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонВс', NameStr, 'Стр. 160', 'Показатель по строке 160 заполняются за налоговый период');

            if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонЗС')
            then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонЗС', NameStr, 'Стр. 161', 'Показатель по строке 161 заполняются за налоговый период');
          }
        }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 4
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 1
      //----------------------------------------------------------------------------------------------------------
      bufL2P5v1_080 := 0;

      for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'); j++)
      {
        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j))
        {
          NameStr := pFH.Func('myGetPage_L2P5v1', i+1, j+1);
          flP5L2 := True;

          #_IsValidNoKor(IsValidTipNP_3     , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ТипНП'       , 'Признак налогоплательщика (код)');
          #_IsValidNoKor(IsValidObRasch     , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ОбРасч'      , 'Расчёт составлен (код)'         );
          #_IsValidNoKor(IsValidNaimOrg     , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НаимОП'      , 'Наименование'                   );
          #_IsValidNoKor(IsValidKPP         , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/КППОП'       , 'КПП'                            );
          #_IsValidNoKor(IsValidObyzUplNalOP, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ОбязУплНалОП', 'Обязательность по уплате'       );

          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаОрг'      , 1, 15, 'Стр. 030'    );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаБезЛиквОП', 1, 15, 'Стр. 031'    );
          #_IsValidNoKorVis_Decimal('XXX.XXXXXXXXXXX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ДоляНалБаз'      , 3, 11, 'Стр. 040'    );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаДоля'     , 1, 15, 'Стр. 050'    );
          #_IsValidNoKorVis_Decimal('XX.XX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СтавНалСубРФ'    , 2,  2, 'Стр. 060'    );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНал'          , 1, 15, 'Стр. 070'    );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалНачислСубРФ'  , 1, 15, 'Стр. 080'    );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалВыплВнеРФ'    , 1, 15, 'Стр. 090'    );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНалП'         , 1, 15, 'Стр. 100/110', True);
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат'       , 1, 15, 'Стр. 120'    );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат1КвСлед', 1, 15, 'Стр. 121'    );

          bufL2P5v1_080 := bufL2P5v1_080 + GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалНачислСубРФ');

          if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаДоля')>0

            if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНал' )<>
               Round(GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаДоля')*
               GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СтавНалСубРФ')/100 )
            then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНал', NameStr, 'Стр. 070', 'Показатель по строке 070 не равен выражению (стр.050 * стр.060 / 100)');

          if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНал' )>
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалНачислСубРФ' )+
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалВыплВнеРФ')
            if  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНалП' ) <>
                GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНал' )-
                GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалНачислСубРФ' )-
                GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалВыплВнеРФ')
            then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНалП', NameStr, 'Стр. 100', 'Показатель по строке 100 не равен выражению (стр.070 - стр.080 - стр.090)');
          if GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНал' )<
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалНачислСубРФ' )+
             GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалВыплВнеРФ')
            if  GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНалП' ) <>
                GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНал' )  -
                GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалНачислСубРФ' )-
                GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалВыплВнеРФ')
            then MessageWarningStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНалП', NameStr, 'Стр. 110', 'Показатель по строке 110 не равен выражению (стр.070 - стр.080 - стр.090)');

          //Строка 120 не заполняется за налоговый период
          if _NalPer_God and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат')
          then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат', NameStr, 'Стр. 120', 'Показатель по строке 120 не заполняются за налоговый период');

          //Строки 120, 121 не заполняется при Расчёт составлен (код) = 3
          if GetStrVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ОбРасч') = '3'
          {
            if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат')
            then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат', NameStr, 'Стр. 120', 'Показатель по строке 120 не заполняются при Расчёт составлен (код) равном 3');

            if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат1КвСлед')
            then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат1КвСлед', NameStr, 'Стр. 121', 'Показатель по строке 121 не заполняются при Расчёт составлен (код) равном 3');
          }

          if (flRavKPP)
            if (KPPTitul = GetStrVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/КППОП'))
            {
              if (flKPP)
                flPovtorKPP := True;

              flKPP := True;
            }
        }
      }

      NameStr := pFH.Func('myGetPage_L2P5v1', i+1, 1);
      if (bufL2P5v1_080 <> GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислСуб'))
         and GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислСуб') and flP5L2
      then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал/РаспрНалСубРФ/НалНачислСубРФ', NameStr, 'Стр. 080', 'Сумма показатель по строке 080 должна равняться строке 230 Листа 02');

      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 1
      //----------------------------------------------------------------------------------------------------------


      //==========================================================================================================
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 6
      //----------------------------------------------------------------------------------------------------------
      for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'); j++)
      {
        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j))
        {
          NameStr := pFH.Func('myGetPage_L2P6', i+1, j+1);

          #_IsValidNoKor(IsValidINNUL       , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/ИННЮЛ' , 'ИНН'         );
          #_IsValidNoKor(CheckError.Prov_INN, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/ИННЮЛ' , 'ИНН'         );
          #_IsValidNoKor(IsValidKPP         , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/КПП'   , 'КПП'         );
          #_IsValidNoKor(IsValidOKTMO       , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/ОКТМО' , 'Код по ОКТМО');
          #_IsValidNoKor(IsValidNaimOrg     , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НаимУч', 'Наименование');
          #_IsValidNoKor(IsValidSSRF        , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/СубРФ' , 'Регион (код)');

          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/КолПрил'         , 1,  4, 'Количество прил. 6а');
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаГр'       , 1, 15, 'Стр. 030'           );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаБезОП'    , 1, 15, 'Стр. 031'           );
          #_IsValidNoKorVis_Decimal('XXX.XXXXXXXXXXX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/ДоляНалБаз'      , 3, 11, 'Стр. 040'           );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаДоля'     , 1, 15, 'Стр. 050'           );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаДоляСтН'  , 1, 15, 'Стр. 051'           );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/СумНал'          , 1, 15, 'Стр. 070'           );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалНачислСубРФ'  , 1, 15, 'Стр. 080'           );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалВыплВнеРФ'    , 1, 15, 'Стр. 090'           );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/СумНалП'         , 1, 15, 'Стр. 100/110' , True);
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/МесАвПлат'       , 1, 15, 'Стр. 120'           );
          #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/МесАвПлат1КвСлед', 1, 15, 'Стр. 121'           );

          //Строка 120 не заполняется за налоговый период
          if _NalPer_God and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/МесАвПлат')
          then MessageErrorStop_ALG('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/МесАвПлат', NameStr, 'Стр. 120', 'Показатель по строке 120 не заполняются за налоговый период');

          //----------------------------------------------------------------------------------------------------------
          //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 6
          //----------------------------------------------------------------------------------------------------------
          for (k := 0; k < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'); k++)
          {
            if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k))
            {
              NameStr := pFH.Func('myGetPage_L2P6a', i+1, j+1, k+1);

              #_IsValidNoKor(IsValidINNUL       , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ИННЮЛ' , 'ИНН'                   );
              #_IsValidNoKor(CheckError.Prov_INN, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ИННЮЛ' , 'ИНН'                   );
              #_IsValidNoKor(IsValidKPP         , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/КПП'   , 'КПП'                   );
              #_IsValidNoKor(IsValidOKTMO       , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ОКТМО' , 'Код по ОКТМО'          );
              #_IsValidNoKor(IsValidNaimOrg     , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НаимУч', 'Наименование'          );
              #_IsValidNoKor(IsValidObRasch     , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ОбРасч', 'Расчет составлен (код)');

              #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаГр'    , 1, 15, 'Стр. 030');
              #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаБезОП' , 1, 15, 'Стр. 031');
              #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СрЧислРаб'    , 1, 15, 'Стр. 032');
              #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СрОстСтАмИмущ', 1, 15, 'Стр. 033');
              #_IsValidNoKorVis_Decimal('XXX.XXXXXXXXXXX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СредАрифВел'  , 3, 11, 'Стр. 034');
              #_IsValidNoKorVis_Decimal('XXX.XXXXXXXXXXX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ДоляНалБаз'   , 3, 11, 'Стр. 040');
              #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаДоля'  , 1, 15, 'Стр. 050');
              #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаДоляСн', 1, 15, 'Стр. 051');
              #_IsValidNoKorVis_Decimal('XX.XX', 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СтавНалСубРФ' , 2,  2, 'Стр. 060');
              #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СумНал'       , 1, 15, 'Стр. 070');
            }
          }
          //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 6а
          //----------------------------------------------------------------------------------------------------------
        }
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 6
      //**********************************************************************************************************


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 6б
      //----------------------------------------------------------------------------------------------------------
      for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'); j++)
      {
        if GetFldVisInTree('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j))
        {
          NameStr := pFH.Func('myGetPage_L2P6b', i+1, (j div 2) + 1);

          #_IsValidNoKorIter(IsValidINNUL       , 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ИННЮЛ', if((j div 2)=0,'1','2')+': Стр. 010', if (i=0, -1, 1));
          #_IsValidNoKorIter(CheckError.Prov_INN, 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ИННЮЛ', if((j div 2)=0,'1','2')+': Стр. 010', if (i=0, -1, 1));

          #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ДохУчГруп'  , 1, 15, if((j div 2)=0,'1','2')+': Стр. 020', if (i=0, -1, 1));
          #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ВнеРеалДох' , 1, 15, if((j div 2)=0,'1','2')+': Стр. 021', if (i=0, -1, 1));
          #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/РасхУмДох'  , 1, 15, if((j div 2)=0,'1','2')+': Стр. 030', if (i=0, -1, 1));
          #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ВнеРеалРасх', 1, 15, if((j div 2)=0,'1','2')+': Стр. 031', if (i=0, -1, 1));
          #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/УбытОпер302', 1, 15, if((j div 2)=0,'1','2')+': Стр. 040', if (i=0, -1, 1));
          #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ДохИсклПриб', 1, 15, if((j div 2)=0,'1','2')+': Стр. 050', if (i=0, -1, 1));
          #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ПрибОперЦБ' , 1, 15, if((j div 2)=0,'1','2')+': Стр. 060', if (i=0, -1, 1));
          #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/УбытОперЦБ' , 1, 15, if((j div 2)=0,'1','2')+': Стр. 061', if (i=0, -1, 1));
          #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ПрибУчГруп' , 1, 15, if((j div 2)=0,'1','2')+': Стр. 070', if (i=0, -1, 1));
        }
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 6
      //----------------------------------------------------------------------------------------------------------
    }
  }
  //#endregion ЛИСТ 02
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 2
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РаспрНалСубРФ'); i++)
  {
    if GetFldVisInTree('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i))
    {
      NameStr := pFH.Func('myGetPage_L2P5v2', i+1);
      flP5L2 := True;

      #_IsValidNoKor(IsValidTipNP_3     , 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ТипНП'       , 'Признак налогоплательщика (код)');
      #_IsValidNoKor(IsValidObRasch     , 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ОбРасч'      , 'Расчёт составлен (код)'         );
      #_IsValidNoKor(IsValidNaimOrg     , 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НаимОП'      , 'Наименование'                   );
      #_IsValidNoKor(IsValidKPP         , 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/КППОП'       , 'КПП'                            );
      #_IsValidNoKor(IsValidObyzUplNalOP, 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ОбязУплНалОП', 'Обязательность по уплате'       );

      #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалБазаОрг'      , 1, 15, 'Стр. 030'    );
      #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалБазаБезЛиквОП', 1, 15, 'Стр. 031'    );
      #_IsValidNoKorVis_Decimal('XXX.XXXXXXXXXXX', 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ДоляНалБаз'      , 3, 11, 'Стр. 040'    );
      #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалБазаДоля'     , 1, 15, 'Стр. 050'    );
      #_IsValidNoKorVis_Decimal('XX.XX', 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/СтавНалСубРФ'    , 2,  2, 'Стр. 060'    );
      #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/СумНал'          , 1, 15, 'Стр. 070'    );
      #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалНачислСубРФ'  , 1, 15, 'Стр. 080'    );
      #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалВыплВнеРФ'    , 1, 15, 'Стр. 090'    );
      #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/СумНалП'         , 1, 15, 'Стр. 100/110', True);
      #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/МесАвПлат'       , 1, 15, 'Стр. 120'    );
      #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/МесАвПлат1КвСлед', 1, 15, 'Стр. 121'    );

      if (not flRavKPP)
        if (KPPTitul = GetStrVal('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/КППОП'))
        {
          if (flKPP)
            flPovtorKPP := True;

          flKPP := True;
        }
    }
  }
  //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 2
  //----------------------------------------------------------------------------------------------------------


  //==========================================================================================================
  //#region ЛИСТ 03
  //----------------------------------------------------------------------------------------------------------
    //==========================================================================================================
    //#region ЛИСТ 03 (СТР. 1)
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУМес'); i++)
    {
      if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i))
      {
        NameStr := pFH.Func('myGetPage_L3_1', i+1);

        #_IsValidNoKor   (IsValidKategorNA   , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/КатегорНА' , 'Категория налогового агента'      );
        #_IsValidNoKorVis(IsValidINNUL       , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ИННЮЛ_ЭмЦБ', 'ИННН орг. - эмитента ценных бумаг');
        #_IsValidNoKorVis(CheckError.Prov_INN, 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ИННЮЛ_ЭмЦБ', 'ИННН орг. - эмитента ценных бумаг');
        #_IsValidNoKor   (IsValidVidDiv      , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ВидДив'    , 'Вид дивидентов'                   );
        #_IsValidNoKor   (IsValidNalPer      , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалПер'    , 'Налоговый (отчётный) период (код)');
        #_IsValidNoKor   (IsValidOtchGod     , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ОтчетГод'  , 'Отчетный год'                     );

        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРаспрПол' , 1, 15, 'Стр. 001');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивВсего'    , 1, 15, 'Стр. 010');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛРез'    , 1, 15, 'Стр. 030');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивИнОрг'    , 1, 15, 'Стр. 040');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивСтатНеУст', 1, 15, 'Стр. 060');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНеДоход'  , 1, 15, 'Стр. 070');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРаспрУм'  , 1, 15, 'Стр. 090');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалИсчисл'   , 1, 15, 'Стр. 100');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалДивПред'  , 1, 15, 'Стр. 110');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалДивПосл'  , 1, 15, 'Стр. 120');

        if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосОргВс' , 1, 15, 'Стр. 020');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосСтав0' , 1, 15, 'Стр. 021');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосСтав9' , 1, 15, 'Стр. 022');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосСтавИн', 1, 15, 'Стр. 023');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосНеНП'  , 1, 15, 'Стр. 024');
        }

        if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛНеРезВс' , 1, 15, 'Стр. 050');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтав0'   , 1, 15, 'Стр. 051');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтав5'   , 1, 15, 'Стр. 052');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтав10'  , 1, 15, 'Стр. 053');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛСтавСв10', 1, 15, 'Стр. 054');
        }

        if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА/ДивНАдоРас' , 1, 15, 'Стр. 080');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА/ДивНАБезУч0', 1, 15, 'Стр. 081');
        }

        if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал')
        {
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал/ДивНал9', 1, 15, 'Стр. 091');
          #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал/ДивНал0', 1, 15, 'Стр. 092');
        }

        //----------------------------------------------------------------------------------------------------------
        //#region ЛИСТ 03 (СТР. 3). ВЕРСИЯ 1 (К РАЗДЕЛУ А)
        //----------------------------------------------------------------------------------------------------------
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'); j++)
        {
          if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(i))
          {
            NameStr := pFH.Func('myGetPage_L3_3v1', i+1, j+1);

            #_IsValidNoKor       (IsValidPrPrinadl_A, 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/ПрПринадл' ,        'Признак принадлежности');
            #_IsValidNoKor_Str   (                    'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/Тип'       , 2,  2, 'Стр. 005: Тип'         );
            #_IsValidNoKor       (IsValidDate       , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/ДатаПерДив',        'Стр. 050'              );
            #_IsValidNoKor_Number(                    'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СумДив'    , 1, 15, 'Стр. 060'              );
            #_IsValidNoKor_Number(                    'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СумНал'    , 1, 15, 'Стр. 070'              );

            {
              #_IsValidNoKor   (IsValidINNUL       , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ИННПолуч' , 'Стр. 005: ИНН получателя');
              #_IsValidNoKor   (CheckError.Prov_INN, 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ИННПолуч' , 'Стр. 005: ИНН получателя');
              #_IsValidNoKor   (IsValidKPP         , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/КПППолуч' , 'Стр. 005: КПП '          );
              #_IsValidNoKor   (IsValidNaimOrg     , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/НаимПолуч', 'Стр. 010'                );
              #_IsValidNoKorVis(IsValidTlf         , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/Тлф'      , 'Стр. 040'               );

              {
                #_IsValidNoKorVis(IsValidIndex, 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Индекс'   , 'Стр. 020: Индекс'     );
                #_IsValidNoKor   (IsValidSSRF , 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/КодРегион', 'Стр. 020: Код региона');

                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Район'     , 1, 50, 'Стр. 020: Район'           );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Город'     , 1, 50, 'Стр. 020: Город'           );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/НаселПункт', 1, 50, 'Стр. 020: Населённый пункт');
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Улица'     , 1, 50, 'Стр. 020: Улица'           );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Дом'       , 1, 20, 'Стр. 020: Дом'             );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Корпус'    , 1, 20, 'Стр. 020: Корпус'          );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Кварт'     , 1, 20, 'Стр. 020: Кварт'           );
              }

              if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук')
              {
                #_IsValidNoKor   (IsValidFIO, 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Фамилия' , 'Стр. 030: Фамилия' );
                #_IsValidNoKor   (IsValidFIO, 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Имя'     , 'Стр. 030: Имя'     );
                #_IsValidNoKorVis(IsValidFIO, 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Отчество', 'Стр. 030: Отчество');
              }
            }
          }
        }
        //#endregion ЛИСТ 03 (СТР. 3). ВЕРСИЯ 1 (К РАЗДЕЛУ А)
        //----------------------------------------------------------------------------------------------------------
      }
    }
    //#endregion ЛИСТ 03 (СТР. 1)
    //**********************************************************************************************************


    //==========================================================================================================
    //#region ЛИСТ 03 (СТР. 2)
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'); i++)
    {
      if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i))
      {
        NameStr := pFH.Func('myGetPage_L3_2', i+1);

        #_IsValidNoKor(IsValidVidDohod, 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/ВидДоход','Вид дохода');

        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалБаза'      , 1, 15, 'Стр. 010');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/СтавНал'      , 2,  2, 'Стр. 020');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалИсчисл'    , 1, 15, 'Стр. 030');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалНачислПред', 1, 15, 'Стр. 040');
        #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалНачислПосл', 1, 15, 'Стр. 050');

        //----------------------------------------------------------------------------------------------------------
        //#region ЛИСТ 03 (СТР. 3). ВЕРСИЯ 1 (К РАЗДЕЛУ Б)
        //----------------------------------------------------------------------------------------------------------
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'); j++)
        {
          if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(i))
          {
            NameStr := pFH.Func('myGetPage_L3_3v2', i+1, j+1);

            #_IsValidNoKor       (IsValidPrPrinadl_B, 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/ПрПринадл' ,        'Признак принадлежности');
            #_IsValidNoKor_Str   (                    'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/Тип'       , 2,  2, 'Стр. 005: Тип'         );
            #_IsValidNoKor       (IsValidDate       , 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/ДатаПерДив',        'Стр. 050'              );
            #_IsValidNoKor_Number(                    'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СумДив'    , 1, 15, 'Стр. 060'              );
            #_IsValidNoKor_Number(                    'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СумНал'    , 1, 15, 'Стр. 070'              );

            {
              #_IsValidNoKor   (IsValidINNUL       , 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ИННПолуч' , 'Стр. 005: ИНН получателя');
              #_IsValidNoKor   (CheckError.Prov_INN, 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ИННПолуч' , 'Стр. 005: ИНН получателя');
              #_IsValidNoKor   (IsValidKPP         , 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/КПППолуч' , 'Стр. 005: КПП '          );
              #_IsValidNoKor   (IsValidNaimOrg     , 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/НаимПолуч', 'Стр. 010'                );
              #_IsValidNoKorVis(IsValidTlf         , 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/Тлф'      , 'Стр. 040'               );

              {
                #_IsValidNoKorVis(IsValidIndex, 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Индекс'   , 'Стр. 020: Индекс'     );
                #_IsValidNoKor   (IsValidSSRF , 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/КодРегион', 'Стр. 020: Код региона');

                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Район'     , 1, 50, 'Стр. 020: Район'           );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Город'     , 1, 50, 'Стр. 020: Город'           );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/НаселПункт', 1, 50, 'Стр. 020: Населённый пункт');
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Улица'     , 1, 50, 'Стр. 020: Улица'           );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Дом'       , 1, 20, 'Стр. 020: Дом'             );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Корпус'    , 1, 20, 'Стр. 020: Корпус'          );
                #_IsValidNoKorVis_Str('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/МНПолучРФ/Кварт'     , 1, 20, 'Стр. 020: Кварт'           );
              }

              if GetFldVisInTree('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук')
              {
                #_IsValidNoKor   (IsValidFIO, 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Фамилия' , 'Стр. 030: Фамилия' );
                #_IsValidNoKor   (IsValidFIO, 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Имя'     , 'Стр. 030: Имя'     );
                #_IsValidNoKorVis(IsValidFIO, 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/РеестрСумДив'+getIter(j)+'/СвПолуч/ФИОРук/Отчество', 'Стр. 030: Отчество');
              }
            }
          }
        }
        //#endregion ЛИСТ 03 (СТР. 3). ВЕРСИЯ 1 (К РАЗДЕЛУ Б)
        //----------------------------------------------------------------------------------------------------------
      }
    }
    //#endregion ЛИСТ 03 (СТР. 2)
    //**********************************************************************************************************
  //#endregion ЛИСТ 03
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 04
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалДохСтав'); i++)
  {
    if GetFldVisInTree('Файл/Документ/Прибыль/НалДохСтав'+getIter(i))
    {
      NameStr := pFH.Func('myGetPage_L4', i+1);

      #_IsValidNoKor(IsValidVidDohod_2, 'Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/ВидДоход', 'Вид дохода');

      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалБаза'       , 1, 15, 'Стр. 010');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/ДохУмНалБаз'   , 1, 15, 'Стр. 020');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/СтавНал'       , 2,  2, 'Стр. 030');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалИсчисл'     , 1, 15, 'Стр. 040');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалДивНеРФПред', 1, 15, 'Стр. 050');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалДивНеРФ'    , 1, 15, 'Стр. 060');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПред' , 1, 15, 'Стр. 070');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПосл' , 1, 15, 'Стр. 080');
    }
  }
  //#endregion ЛИСТ 04
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 05 (ДО 01.01.2015)
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалБазОпОсобС'); i++)
  {
    if GetFldVisInTree('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i))
    {
      NameStr := pFH.Func('myGetPage_L5v1', i+1);

      #_IsValidNoKor(IsValidVidOper, 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/ВидОпер', 'Вид операции');

      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/ДохВыбытПогаш'   , 1, 15, 'Стр. 010');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумОтклМинЦ'     , 1, 15, 'Стр. 020');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/РасхПриобРеал'   , 1, 15, 'Стр. 030');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумОтклМаксЦ'    , 1, 15, 'Стр. 031');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/Прибыль'         , 1, 15, 'Стр. 040');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/КорПриб'         , 1, 15, 'Стр. 050');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/НалБазаБезУбПред', 1, 15, 'Стр. 060');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумУбытПред'     , 1, 15, 'Стр. 070');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумУбытУменНБ'   , 1, 15, 'Стр. 080');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумНеучУбытПер'  , 1, 15, 'Стр. 090');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумУбытНеПогаш'  , 1, 15, 'Стр. 091');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/НалБаза'         , 1, 15, 'Стр. 100');
    }
  }
  //#endregion ЛИСТ 05 (ДО 01.01.2015)
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 05 (С 01.01.2015)
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалБазОпОсобН'); i++)
  {
    if GetFldVisInTree('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i))
    {
      NameStr := pFH.Func('myGetPage_L5v2', i+1);

      #_IsValidNoKor(IsValidVidOper, 'Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ВидОпер', 'Вид операции');

      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохВыбыт'         , 1, 15, 'Стр. 010');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохВыбЦБНеОрг'    , 1, 15, 'Стр. 011');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохЦБНеОргМин'    , 1, 15, 'Стр. 012');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохВыбФИССНеОрг'  , 1, 15, 'Стр. 013');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохФИССНеОргМин'  , 1, 15, 'Стр. 014');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхПриобРеал'    , 1, 15, 'Стр. 020');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхЦБНеОрг'      , 1, 15, 'Стр. 021');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхЦБНеОргМакс'  , 1, 15, 'Стр. 022');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхФИССНеОрг'    , 1, 15, 'Стр. 023');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхФИССНеОргМакс', 1, 15, 'Стр. 024');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/Прибыль'          , 1, 15, 'Стр. 040');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/КорПриб'          , 1, 15, 'Стр. 050');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/НалБазаБезУбПред' , 1, 15, 'Стр. 060');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/СумУбытУменНБ'    , 1, 15, 'Стр. 080');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/НалБаза'          , 1, 15, 'Стр. 100');
    }
  }
  //#endregion ЛИСТ 05 (С 01.01.2015)
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 06
  //----------------------------------------------------------------------------------------------------------
  if GetFldVisInTree('Файл/Документ/Прибыль/ДохРасНалБазаНПФ')
  {
    NameStr := pFH.Func('myGetPage_L6_1');

    #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/СумПенсРез'    , 1, 15, 'Стр. 120');

    NameStr := pFH.Func('myGetPage_L6_2');

    #_IsValidNoKorVis_Decimal('XXX.XXXX', 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПроцДохРазмРез', 3,  4, 'Стр. 230');

    NameStr := pFH.Func('myGetPage_L6_3');

    #_IsValidNoKorVis_Number ('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/НалБаза'       , 1, 15, 'Стр. 530');

    NameStr := pFH.Func('myGetPage_L6_1');

    {
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ДоходНПФВс'     , 1, 15, 'Стр. 010');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/РеалЦБРын'      , 1, 15, 'Стр. 020');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ОтклВырЦБРын'   , 1, 15, 'Стр. 030');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/РеалЦБНеРын'    , 1, 15, 'Стр. 040');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ОтклВырЦБНеРын' , 1, 15, 'Стр. 050');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцГосЦБ'      , 1, 15, 'Стр. 060');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцЦБЭм2007'   , 1, 15, 'Стр. 070');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ДолУчДрОрг'     , 1, 15, 'Стр. 080');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцГосЦБУдНА'  , 1, 15, 'Стр. 090');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцМунЦБ2007НА', 1, 15, 'Стр. 100');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ДрИнвВлож'      , 1, 15, 'Стр. 110');
    }

    {
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ДоходНПФСтРефВс', 1, 15, 'Стр. 130');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ЦБРын'          , 1, 15, 'Стр. 140');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ЦБНеРын'        , 1, 15, 'Стр. 150');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ПроцГосЦБ'      , 1, 15, 'Стр. 160');

      NameStr := pFH.Func('myGetPage_L6_2');

      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ПроцЦБЭм2007'   , 1, 15, 'Стр. 170');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ДрИнвВлож'      , 1, 15, 'Стр. 180');
    }

    NameStr := pFH.Func('myGetPage_L6_2');

    if GetFldVisInTree('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход')
    {
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/РасходВс'      , 1, 15, 'Стр. 190');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/ВлЦБРын'       , 1, 15, 'Стр. 200');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/СумОтклЦБРын'  , 1, 15, 'Стр. 201');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/ВлЦБНеРын'     , 1, 15, 'Стр. 210');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/СумОтклЦБНеРын', 1, 15, 'Стр. 211');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/ДрИнвВлож'     , 1, 15, 'Стр. 220');
    }

    if GetFldVisInTree('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав')
    {
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ОтчРазмРезУставВс', 1, 15, 'Стр. 240');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ЦБРын'            , 1, 15, 'Стр. 250');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ЦБНеРын'          , 1, 15, 'Стр. 260');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБ'           , 1, 15, 'Стр. 270');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБЭм2007'     , 1, 15, 'Стр. 280');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ДолУчДрОрг'       , 1, 15, 'Стр. 290');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБУдНА'       , 1, 15, 'Стр. 300');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБЭм2007УдНА' , 1, 15, 'Стр. 310');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ДрИнвВлож'        , 1, 15, 'Стр. 320');
    }

    NameStr := pFH.Func('myGetPage_L6_3');

    {
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ПрибЦБРын'         , 1, 15, 'Стр. 330');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклПрибЦБРын'  , 1, 15, 'Стр. 340');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ПрибЦБНеРын'       , 1, 15, 'Стр. 320');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклПрибЦБНеРын', 1, 15, 'Стр. 360');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДохПроцЦБ'         , 1, 15, 'Стр. 370');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДохПроцЭм2007'     , 1, 15, 'Стр. 380');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДрИнвВлож'         , 1, 15, 'Стр. 390');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклДрИнвВлож'  , 1, 15, 'Стр. 400');
    }

    if GetFldVisInTree('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын')
    {
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/НалБаза'    , 1, 15, 'Стр. 410');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумУбПред'  , 1, 15, 'Стр. 420');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумУбПриз'  , 1, 15, 'Стр. 430');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумНеучУбыт', 1, 15, 'Стр. 440');
    }

    if GetFldVisInTree('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын')
    {
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/НалБаза'        , 1, 15, 'Стр. 450');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбСдНеОбр'   , 1, 15, 'Стр. 458');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбСдНеОбрНач', 1, 15, 'Стр. 459');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПред'      , 1, 15, 'Стр. 460');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПриз'      , 1, 15, 'Стр. 470');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПриз458'   , 1, 15, 'Стр. 471');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумНеучУбыт'    , 1, 15, 'Стр. 480');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбыт458'     , 1, 15, 'Стр. 481');
    }

    if GetFldVisInTree('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож')
    {
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/НалБаза'    , 1, 15, 'Стр. 490');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумУбПред'  , 1, 15, 'Стр. 500');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумУбПриз'  , 1, 15, 'Стр. 510');
      #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумНеучУбыт', 1, 15, 'Стр. 520');
    }
  }
  //#endregion ЛИСТ 06
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 07
  //----------------------------------------------------------------------------------------------------------
  if GetFldVisInTree('Файл/Документ/Прибыль/ЦелИспИмущ')
  {
    NameStr := pFH.Func('myGetPage_L7');

    #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ЦелИспИмущ/СтИмущСрдИт'   , 1, 15, 'Итог: гр. 3');
    #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ЦелИспИмущ/СумСрокНеИстИт', 1, 15, 'Итог: гр. 6');
    #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ЦелИспИмущ/СумИспНазнИт'  , 1, 15, 'Итог: гр. 4');
    #_IsValidNoKorVis_Number('Файл/Документ/Прибыль/ЦелИспИмущ/СумНеИспИт'    , 1, 15, 'Итог: гр. 7');

    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'); i++)
    {
      if GetFldVisInTree('Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i))
      {
        #_IsValidNoKor_Str_I      (             'Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/КодВидПост'  , 3,  3, if(i<9, '0','')+String(i+1)+': гр. 1', -1);
        #_IsValidNoKorIter        (IsValidDate, 'Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/ДатаПост'    ,        if(i<9, '0','')+String(i+1)+': гр. 2', -1);
        #_IsValidNoKorIter        (IsValidDate, 'Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СрокИспол'   ,        if(i<9, '0','')+String(i+1)+': гр. 5', -1);
        #_IsValidNoKorVis_Number_I(             'Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СтИмущСрд'   , 1, 15, if(i<9, '0','')+String(i+1)+': гр. 3', -1);
        #_IsValidNoKorVis_Number_I(             'Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СумСрокНеИст', 1, 15, if(i<9, '0','')+String(i+1)+': гр. 6', -1);
        #_IsValidNoKorVis_Number_I(             'Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СумИспНазн'  , 1, 15, if(i<9, '0','')+String(i+1)+': гр. 4', -1);
        #_IsValidNoKorVis_Number_I(             'Файл/Документ/Прибыль/ЦелИспИмущ/СвЦелСред'+getIter(i)+'/СумНеИсп'    , 1, 15, if(i<9, '0','')+String(i+1)+': гр. 7', -1);
      }
    }
  }
  //#endregion ЛИСТ 07
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ПРИЛОЖЕНИЕ 1 К ДЕКЛАРАЦИИ
  //----------------------------------------------------------------------------------------------------------
  if GetFldVisInTree('Файл/Документ/Прибыль/ДохНеУч_РасхУч')
  {
    NameStr := pFH.Func('myGetPage_P1');

    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'); i++)
    {
      if GetFldVisInTree('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i))
      {
        #_IsValidNoKorVis_Str_I   ('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/КодВидДоход' , 3,  3, if(i<9, '0','')+String(i+1)+': гр. 1', -1);
        #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/СумДоход'    , 1, 15, if(i<9, '0','')+String(i+1)+': гр. 2', -1);
        #_IsValidNoKorVis_Str_I   ('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/КодВидРасход', 3,  3, if(i<9, '0','')+String(i+1)+': гр. 3', -1);
        #_IsValidNoKorVis_Number_I('Файл/Документ/Прибыль/ДохНеУч_РасхУч/СвЦелСред'+getIter(i)+'/СумРасход'   , 1, 15, if(i<9, '0','')+String(i+1)+': гр. 4', -1);
      }
    }
  }
  //#endregion ПРИЛОЖЕНИЕ 1 К ДЕКЛАРАЦИИ
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ (СТР. 1)
  //----------------------------------------------------------------------------------------------------------
  var buXMLAdr_i : string = '';

  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/СведДохФЛ'); i++)
  {
    buXMLAdr_i := 'Файл/Документ/Прибыль/СведДохФЛ'+getIter(i);

    if GetFldVisInTree(buXMLAdr_i)
    {
      NameStr := pFH.Func('myGetPage_P2_1', i+1);

      #_IsValidNoKor_Number(             buXMLAdr_i+'/НомерСправ', 1, 10, 'Справка №'       );
      #_IsValidNoKor       (IsValidDate, buXMLAdr_i+'/ДатаСправ' ,        'Дата составления');
      #_IsValidNoKor       (IsValidTip , buXMLAdr_i+'/Тип'       ,        'Тип'             );

      {
        #_IsValidNoKorVis    (IsValidINNFL       , buXMLAdr_i+'/ФЛПолучДох/ИННФЛ'    ,        'ИНН в РФ'                            );
        #_IsValidNoKorVis    (CheckError.Prov_INN, buXMLAdr_i+'/ФЛПолучДох/ИННФЛ'    ,        'ИНН в РФ'                            );
        #_IsValidNoKorVis_Str(                     buXMLAdr_i+'/ФЛПолучДох/ИННИно'   , 1, 50, 'ИНН в стране гражданства'            );
        #_IsValidNoKor       (IsValidStatusNP    , buXMLAdr_i+'/ФЛПолучДох/СтатусНП' ,        'Статус налогоплательщика'            );
        #_IsValidNoKor       (IsValidDate        , buXMLAdr_i+'/ФЛПолучДох/ДатаРожд' ,        'Дата рождения'                       );
        #_IsValidNoKor       (IsValidOKSM        , buXMLAdr_i+'/ФЛПолучДох/Гражд'    ,        'Стр. Гражданство (код страны)'       );
        #_IsValidNoKor       (IsValidSPDUL       , buXMLAdr_i+'/ФЛПолучДох/КодВидДок',        'Код вида документа удостов. личность');
        #_IsValidNoKor_Str   (                     buXMLAdr_i+'/ФЛПолучДох/СерНомДок', 1, 25, 'Серия и номер документа'             );

        {
          #_IsValidNoKor   (IsValidFIO, buXMLAdr_i+'/ФЛПолучДох/ФИО/Фамилия' , 'Фамилия' );
          #_IsValidNoKor   (IsValidFIO, buXMLAdr_i+'/ФЛПолучДох/ФИО/Имя'     , 'Имя'     );
          #_IsValidNoKorVis(IsValidFIO, buXMLAdr_i+'/ФЛПолучДох/ФИО/Отчество', 'Отчество');
        }

        if GetFldVisInTree(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ')
        {
          #_IsValidNoKorVis(IsValidIndex, buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Индекс'   , 'Адрес в РФ: Индекс'     );
          #_IsValidNoKor   (IsValidSSRF , buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/КодРегион', 'Адрес в РФ: Код региона');

          #_IsValidNoKorVis_Str(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Район'     , 1, 50, 'Адрес в РФ: Район'           );
          #_IsValidNoKorVis_Str(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Город'     , 1, 50, 'Адрес в РФ: Город'           );
          #_IsValidNoKorVis_Str(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/НаселПункт', 1, 50, 'Адрес в РФ: Населённый пункт');
          #_IsValidNoKorVis_Str(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Улица'     , 1, 50, 'Адрес в РФ: Улица'           );
          #_IsValidNoKorVis_Str(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Дом'       , 1, 20, 'Адрес в РФ: Дом'             );
          #_IsValidNoKorVis_Str(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Корпус'    , 1, 20, 'Адрес в РФ: Корпус'          );
          #_IsValidNoKorVis_Str(buXMLAdr_i+'/ФЛПолучДох/АдрМЖРФ/Кварт'     , 1, 20, 'Адрес в РФ: Кварт'           );
        }

        if GetFldVisInTree(buXMLAdr_i+'/ФЛПолучДох/АдрМЖИно')
        {
          #_IsValidNoKor    (IsValidOKSM, buXMLAdr_i+'/ФЛПолучДох/АдрМЖИно/ОКСМ'    ,          'Адрес за пределами РФ: Код страны');
          #_IsValidNoKor_Str(             buXMLAdr_i+'/ФЛПолучДох/АдрМЖИно/АдрТекст', 1,  255, 'Адрес за пределами РФ: Адрес'     );
        }
      }

      {
        #_IsValidNoKor_Number    (                      buXMLAdr_i+'/ДохНалПер/Ставка'     ,  2, 2 , 'Стр. 010');
        #_IsValidNoKor_Decimal   ('XXXXXXXXXXXXXXX.XX', buXMLAdr_i+'/ДохНалПер/СумДохОбщ'  , 15, 2 , 'Стр. 020');
        #_IsValidNoKorVis_Decimal('XXXXXXXXXXXXXXX.XX', buXMLAdr_i+'/ДохНалПер/СумВычОбщ'  , 15, 2 , 'Стр. 021');
        #_IsValidNoKor_Decimal   ('XXXXXXXXXXXXXXX.XX', buXMLAdr_i+'/ДохНалПер/НалБаза'    , 15, 2 , 'Стр. 022');
        #_IsValidNoKor_Number    (                      buXMLAdr_i+'/ДохНалПер/НалИсчисл'  ,  1, 15, 'Стр. 030');
        #_IsValidNoKorVis_Number (                      buXMLAdr_i+'/ДохНалПер/НалУдерж'   ,  1, 15, 'Стр. 031');
        #_IsValidNoKorVis_Number (                      buXMLAdr_i+'/ДохНалПер/НалУплач'   ,  1, 15, 'Стр. 032');
        #_IsValidNoKorVis_Number (                      buXMLAdr_i+'/ДохНалПер/НалУдержЛиш',  1, 15, 'Стр. 033');
        #_IsValidNoKorVis_Number (                      buXMLAdr_i+'/ДохНалПер/НалНеУдерж' ,  1, 15, 'Стр. 034');
      }

      //==========================================================================================================
      //#region ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ (СТР. 2)
      //----------------------------------------------------------------------------------------------------------
      var RemoveIter : integer;
      if GetFldVisInTree('Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/СпрДохФЛ')
      {
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/СпрДохФЛ/СумДох'); j++)
        {
          if GetFldVisInTree('Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/СпрДохФЛ/СумДох'+getIter(j))
          {
            NameStr := pFH.Func('myGetPage_P2_2_Dohod', i+1, j+1);
            RemoveIter := if(i=0,-1,1);

            #_IsValidNoKorIter      (IsValidKodVidDohod,  'Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/СпрДохФЛ/СумДох'+getIter(j)+'/КодДоход',        'стр. 040', RemoveIter);
            #_IsValidNoKor_Decimal_I('XXXXXXXXXXXXXXX.XX','Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/СпрДохФЛ/СумДох'+getIter(j)+'/СумДоход', 15, 2, 'стр. 041', RemoveIter);

            for (k := 0; k < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/СпрДохФЛ/СумДох'+getIter(j)+'/СумВыч'); k++)
            {
              if GetFldVisInTree('Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/СпрДохФЛ/СумДох'+getIter(j)+'/СумВыч'+getIter(k))
              {
                NameStr := pFH.Func('myGetPage_P2_2_DohodVych', i+1, j+1, (k div 5)+1);
                RemoveIter := if(i=0 and j=0,-1,if(((i=0 and j<>0) or (i<>0 and j=0)),1,2));

                #_IsValidNoKorIter      (IsValidKodVidRash,   'Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/СпрДохФЛ/СумДох'+getIter(j)+'/СумВыч'+getIter(k mod 5)+'/КодВычет',        String(k+1)+': стр. 042', RemoveIter);
                #_IsValidNoKor_Decimal_I('XXXXXXXXXXXXXXX.XX','Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/СпрДохФЛ/СумДох'+getIter(j)+'/СумВыч'+getIter(k mod 5)+'/СумВычет', 15, 2, String(k+1)+': стр. 043', RemoveIter);
              }
            }
          }
        }
      }

      if GetFldVisInTree('Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/НалВычСтанд')
      {
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/НалВычСтанд/СумВыч'); j++)
        {
          if GetFldVisInTree('Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/НалВычСтанд/СумВыч'+getIter(j))
          {
            NameStr := pFH.Func('myGetPage_P2_2_StandVych', i+1, (j div 2)+1);

            #_IsValidNoKorIter      (IsValidKodVidRash   , 'Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/НалВычСтанд/СумВыч'+getIter(j mod 2)+'/КодВычет',        String(j+1)+': стр. 051', if(i=0,-1,1));
            #_IsValidNoKor_Decimal_I('XXXXXXXXXXXXXXX.XX', 'Файл/Документ/Прибыль/СведДохФЛ'+getIter(i)+'/НалВычСтанд/СумВыч'+getIter(j mod 2)+'/СумВычет', 15, 2, String(j+1)+': стр. 052', if(i=0,-1,1));
          }
        }
      }
      //#endregion ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ (СТР. 2)
      //**********************************************************************************************************
    }
  }
  //#endregion ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ (СТР. 1)
  //**********************************************************************************************************


  //==========================================================================================================
  //#region СТРУКТУРА
  //----------------------------------------------------------------------------------------------------------
  {
    if (flP5L2)
    {
      if (not flKPP)
        MessageErrorStop_ALG('', 'Структура', 'КПП', 'Нет ни одного Прил. 5 к Листу 02, у которого значение поля КПП = значению КПП титульного листа');

      if (flPovtorKPP)
        MessageErrorStop_ALG('', 'Структура', 'КПП', 'Несколько Прил. 5 к Листу 02 имеют значения поля КПП = значению КПП титульного листа');
    }
  }
  //#endregion СТРУКТУРА
  //**********************************************************************************************************

@end.
//#endregion On_Check ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ПРОВЕРКЕ ПОЛЕЙ
//**********************************************************************************************************


//============================================================================================================
//#region On_Recalc ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ РАСЧЁТЕ ПОЛЕЙ
//------------------------------------------------------------------------------------------------------------
@Script On_Recalc : boolean;
  //==========================================================================================================
  //#region СЕРВИС On_Recalc
  //----------------------------------------------------------------------------------------------------------
  #declare _Log(_strAdr, _strMes, _strVal)
    MesError.InsertRasch(NameStr, #_strAdr, #_strMes, #_strVal, 0);
  #end

  #declare _LogC(_strAdr, _strMes, _strVal, _N)
    MesError.InsertRasch(NameStr, #_strAdr, #_strMes, #_strVal, #_N);
  #end

  #declare GDS0(_val)
    IF(#_val < 0, '('+DoubleToStr(Round(#_val), '[|-]36666666666666666666666666')+')', DoubleToStr(Round(#_val), '[|-]36666666666666666666666666'))
  #end

  #declare GDS2(_val)
    IF(#_val < 0, '('+DoubleToStr(Round(#_val, 2), '[|-]36666666666666666666666666~99')+')', DoubleToStr(Round(#_val, 2), '[|-]36666666666666666666666666~99'))
  #end

  #declare GDS11(_val)
    IF(#_val < 0, '('+DoubleToStr(Round(#_val, 11), '[|-]36666666666666666666666666~99999999999')+')', DoubleToStr(Round(#_val, 11), '[|-]36666666666666666666666666~99999999999'))
  #end

  #declare _SetFld(_fld, _val)
    SetFldVal(#_fld, #_val)
  #end

  #declare _SetFldGV(_fld, _val)
    SetFldVal(#_fld, #_val);
    #_val := GetDblVal(#_fld);
  #end

  #declare SetSNull(_fld, _val)
    XMLMAP.SetIsNullAttrValueByName(#_fld, 2);
    #_val := GetDblVal(#_fld);
  #end

  //----------------------------------------------------------------------------------------------------------
  //Проверка на соответствие текущего значения поля Период значению Год
  function _NalPer_God : boolean;
  begin
    var val : Integer;
    val := GetIntVal('Файл/Документ/Период');

    Result := False;
    Result := ((val = 16) or (val = 34) or (val = 46) or (val = 68));
  end;

  //----------------------------------------------------------------------------------------------------------
  //Проверка на соответствие текущего значения поля Период значению 1й квартал
  function _NalPer_1kv : boolean;
  begin
    var val : Integer;
    val := GetIntVal('Файл/Документ/Период');

    Result := False;
    Result := ((val = 13) or (val = 21));
  end;

  //----------------------------------------------------------------------------------------------------------
  //Проверка на соответствие текущего значения поля КатегорНА значению 2
  function _KategorNA(_adrXML_: string) : boolean;
  begin
    Result := False;
    Result := (GetIntVal(_adrXML_) = 2);
  end;

  //----------------------------------------------------------------------------------------------------------
  //Проверка на соответствие текущего значения поля ТипНП условию
  function _TipNP(_adrXML_: string) : boolean;
  begin
    var val : Integer;
    val := GetIntVal(_adrXML_);

    Result := False;
    Result := ((val = 1) or (val = 3) or (val = 4));
  end;
  //#endregion СЕРВИС On_Recalc
  //**********************************************************************************************************
@begin
  On_Visable;
  /*********/

  //==========================================================================================================
  //#region ЗНАЧЕНИЯ ПО УМОЛЧАНИЮ
  //----------------------------------------------------------------------------------------------------------
  if ((GetStrVal('Файл/Документ/ДатаДок') = '') or (GetStrVal('Файл/Документ/ДатаДок') = 'ДД.ММ.ГГГГ'))
    SetFldVal('Файл/Документ/ДатаДок', DateToStr(Cur_Date, XMLMap.GetAttrVFormatByName('Файл/Документ/ДатаДок')));

  var bufPeriod, valPeriod : string;

  bufPeriod := if(Length(MesCurPeriod) > 8, SubStr(MesCurPeriod, 1, Length(MesCurPeriod) - 8), '');
  valPeriod := '';

  if (GetStrVal('Файл/Документ/Период') = '')
  {
    if (Pos('квартал', bufPeriod) = 3)
    {
      case SubStr(bufPeriod, 1, 1) of
        '1' : valPeriod := '21';   //1ый квартал
        '2' : valPeriod := '31';   //2ой квартал | Полугодие
        '3' : valPeriod := '33';   //3ий квартал | Девять месяцев
        '4' : valPeriod := '34';   //4ый квартал | Год
      end;
    }
    else
    {
      case bufPeriod of
        'Январь'  : valPeriod := '35';   //Январь   | Один месяц
        'Февраль' : valPeriod := '36';   //Февраль  | Два месяца
        'Март'    : valPeriod := '37';   //Март     | Три месяца
        'Апрель'  : valPeriod := '38';   //Апрель   | Четыре месяца
        'Май'     : valPeriod := '39';   //Май      | Пять месяцев
        'Июнь'    : valPeriod := '40';   //Июнь     | Шесть месяцев
        'Июль'    : valPeriod := '41';   //Июль     | Семь месяцев
        'Август'  : valPeriod := '42';   //Август   | Восемь месяцев
        'Сентябрь': valPeriod := '43';   //Сентябрь | Девять месяцев
        'Октябрь' : valPeriod := '44';   //Октябрь  | Десять месяцев
        'Ноябрь'  : valPeriod := '45';   //Ноябрь   | Одиннадцать месяцев
        'Декабрь' : valPeriod := '46';   //Декабрь  | Год
        ''        : valPeriod := '34';   //Год
      end;
    }

    SetFldVal('Файл/Документ/Период', valPeriod);
  }
  //#endregion ЗНАЧЕНИЯ ПО УМОЛЧАНИЮ
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ОБЪЯВЛЕНИЕ ПЕРЕМЕННЫХ
  //----------------------------------------------------------------------------------------------------------
  var i, j, k, n,  CountI, CountJ, CountK, CountN : integer = 0;
  var fl1, fl_L5_1_r100, fl_L5_2_r100, fl_L2P4_z150 : boolean = False;
  var NameStr, bufXMLAd, vRes : string = '';
  var bufL2P6a_z040, bufL2P6a_r050, bufL2P6a_z051, bufL2P6a_r070, bufL5_2_r100, bufL5_1_r100, bufL2P4_z150, bufL2_r270_r280, bufL2_r271_r281, bufL2_300, bufL2_310, bufL2P6_rKolPril, bufRes : double = 0.0;

  //Данные. Тип: Double
  var P2_r020, P2_r021, P2_r022, P2_r030, P2_z010, P2_z041, P2_z043, P2_z052,
      L6_r010, L6_r190, L6_r240, L6_r330, L6_r350, L6_r370, L6_r380, L6_r390, L6_r410, L6_r440, L6_r450, L6_r480, L6_r481, L6_r490, L6_r520, L6_r530, L6_z020, L6_z030, L6_z040, L6_z050, L6_z060,
      L6_z070, L6_z080, L6_z090, L6_z100, L6_z110, L6_z140, L6_z150, L6_z160, L6_z170, L6_z180, L6_z200, L6_z210, L6_z220, L6_z250, L6_z260, L6_z270, L6_z280, L6_z290, L6_z300, L6_z310, L6_z320,
      L6_z340, L6_z360, L6_z400, L6_z420, L6_z430, L6_z459, L6_z460, L6_z470, L6_z471, L6_z500, L6_z510,
      L5_2_r040, L5_2_r060, L5_2_r080, L5_2_r100, L5_2_z010, L5_2_z020, L5_2_z050,
      L5_1_r040, L5_1_r060, L5_1_r090, L5_1_r100, L5_1_z010, L5_1_z020, L5_1_z030, L5_1_z031, L5_1_z050, L5_1_z070, L5_1_z080,
      L4_r080, L4_z040, L4_z050, L4_z060, L4_z070,
      L3Ra_r010, L3Ra_r020, L3Ra_r090, L3Ra_z091, L3Ra_z092, L3Ra_z100, L3Ra_z110, L3Ra_z120, L3Ra_z001, L3Ra_z021, L3Ra_z022, L3Ra_z023, L3Ra_z024, L3Ra_z030, L3Ra_z040, L3Ra_z050, L3Ra_z060,
      L3Ra_z070, L3Ra_z080, L3Ra_z081, L3Ra_Form,
      L3Rb_r030, L3Rb_z010, L3Rb_z020,
      L2P6b_r070, L2P6b_z020, L2P6b_z021, L2P6b_z030, L2P6b_z031, L2P6b_z040, L2P6b_z050, L2P6b_z060,
      L2P6a_r050, L2P6a_r070, L2P6a_z030, L2P6a_z040, L2P6a_z051, L2P6a_z060,
      L2P6_r040, L2P6_r050, L2P6_r051, L2P6_r070, L2P6_r100_110, L2P6_r120, L2P6_z080, L2P6_z090, L2P6_rKolPril,
      L2P5_r030, L2P5_r050, L2P5_r070, L2P5_r100_110, L2P5_r120, L2P5_z040, L2P5_z060, L2P5_z080, L2P5_z090,
      L2P4_r140, L2P4_r160, L2P4_r161, L2P4_z010, L2P4_z135, L2P4_z136, L2P4_z150, L2P4_z151,
      L2P3_r150, L2P3_r160, L2P3_r340, L2P3_r350, L2P3_r360, L2P3_z030, L2P3_z040, L2P3_z060, L2P3_z100, L2P3_z110, L2P3_z120, L2P3_z130, L2P3_z140, L2P3_z180,
      L2P3_z190, L2P3_z201, L2P3_z210, L2P3_z211, L2P3_z220, L2P3_z221, L2P3_z230, L2P3_z240, L2P3_z250, L2P3_z260,
      L2P2_r080, L2P2_r130, L2P2_z010,  L2P2_z020, L2P2_z040, L2P2_z059, L2P2_z060, L2P2_z061, L2P2_z070, L2P2_z072, L2P2_z090, L2P2_z100, L2P2_z110, L2P2_z120, L2P2_z200, L2P2_z300, L2P2_z400,
      L2P1_r010, L2P1_r030, L2P1_r040, L2P1_z011, L2P1_z012, L2P1_z013, L2P1_z014, L2P1_z020, L2P1_z023, L2P1_z027, L2P1_z100,
      L2_zTip, L2_r010, L2_r020, L2_r030, L2_r040, L2_r050, L2_r060, L2_r100, L2_r110, L2_r120, L2_r140, L2_r180, L2_r190, L2_r200, L2_r210, L2_r270, L2_r271, L2_r280, L2_r281, L2_z070, L2_z080,
      L2_z090, L2_z130, L2_z150, L2_z160, L2_z170, L2_r220, L2_r230, L2_z250, L2_z260, L2_r290, L2_r300, L2_r310,
      R1P12_r120, R1P12_r130, R1P12_r140, R1P12_r220, R1P12_r230, R1P12_r240,
      R1P11_040_050 : double = 0.0;

  //XML адреса переменных. Тип: String
  var aP2_r020, aP2_r021, aP2_r022, aP2_r030, aP2_z010, aP2_z041, aP2_z043, aP2_z052,
      aL6_r010, aL6_r190, aL6_r240, aL6_r330, aL6_r350, aL6_r370, aL6_r380, aL6_r390, aL6_r410, aL6_r440, aL6_r450, aL6_r480, aL6_r481, aL6_r490, aL6_r520, aL6_r530, aL6_z020, aL6_z030, aL6_z040, aL6_z050, aL6_z060,
      aL6_z070, aL6_z080, aL6_z090, aL6_z100, aL6_z110, aL6_z140, aL6_z150, aL6_z160, aL6_z170, aL6_z180, aL6_z200, aL6_z210, aL6_z220, aL6_z250, aL6_z260, aL6_z270, aL6_z280, aL6_z290, aL6_z300, aL6_z310, aL6_z320,
      aL6_z340, aL6_z360, aL6_z400, aL6_z420, aL6_z430, aL6_z459, aL6_z460, aL6_z470, aL6_z471, aL6_z500, aL6_z510,
      aL5_2_r040, aL5_2_r060, aL5_2_r080, aL5_2_r100, aL5_2_z010, aL5_2_z020, aL5_2_z050,
      aL5_1_r040, aL5_1_r060, aL5_1_r090, aL5_1_r100, aL5_1_z010, aL5_1_z020, aL5_1_z030, aL5_1_z031, aL5_1_z050, aL5_1_z070, aL5_1_z080,
      aL4_r080, aL4_z040, aL4_z050, aL4_z060, aL4_z070,
      aL3Ra_r010, aL3Ra_r020, aL3Ra_r090, aL3Ra_z001, aL3Ra_z021, aL3Ra_z022, aL3Ra_z023, aL3Ra_z024, aL3Ra_z030, aL3Ra_z040, aL3Ra_z050, aL3Ra_z060, aL3Ra_z070, aL3Ra_z081, aL3Ra_Form, aL3Ra_z080,
      aL3Rb_r030, aL3Rb_z010, aL3Rb_z020, aL3Ra_z091, aL3Ra_z092, aL3Ra_z100, aL3Ra_z110, aL3Ra_z120,
      aL2P6b_r070, aL2P6b_z020, aL2P6b_z021, aL2P6b_z030, aL2P6b_z031, aL2P6b_z040, aL2P6b_z050, aL2P6b_z060,
      aL2P6a_r050, aL2P6a_r070, aL2P6a_z030, aL2P6a_z040, aL2P6a_z051, aL2P6a_z060,
      aL2P6_r040, aL2P6_r050, aL2P6_r051, aL2P6_r070, aL2P6_r100_110, aL2P6_r120, aL2P6_z080, aL2P6_z090, aL2P6_rKolPril,
      aL2P5_r030, aL2P5_r050, aL2P5_r070, aL2P5_r100_110, aL2P5_r120, aL2P5_z040, aL2P5_z060, aL2P5_z080, aL2P5_z090,
      aL2P4_r140, aL2P4_r160, aL2P4_r161, aL2P4_z010, aL2P4_z135, aL2P4_z136, aL2P4_z150, aL2P4_z151,
      aL2P3_r150, aL2P3_r160, aL2P3_r340, aL2P3_r350, aL2P3_r360, aL2P3_z030, aL2P3_z040, aL2P3_z060, aL2P3_z100, aL2P3_z110, aL2P3_z120, aL2P3_z130, aL2P3_z140, aL2P3_z180,
      aL2P3_z190, aL2P3_z201, aL2P3_z210, aL2P3_z211, aL2P3_z220, aL2P3_z221, aL2P3_z230, aL2P3_z240, aL2P3_z250, aL2P3_z260,
      aL2P2_r080, aL2P2_r130, aL2P2_z010,  aL2P2_z020, aL2P2_z040, aL2P2_z059, aL2P2_z060, aL2P2_z061, aL2P2_z070, aL2P2_z072, aL2P2_z090, aL2P2_z100, aL2P2_z110, aL2P2_z120, aL2P2_z200, aL2P2_z300, aL2P2_z400,
      aL2P1_r010, aL2P1_r030, aL2P1_r040, aL2P1_z011, aL2P1_z012, aL2P1_z013, aL2P1_z014, aL2P1_z020, aL2P1_z023, aL2P1_z027, aL2P1_z100,
      aL2_r010, aL2_r020, aL2_r030, aL2_r040, aL2_r050, aL2_r060, aL2_r100, aL2_r110, aL2_r120, aL2_r140, aL2_r180, aL2_r190, aL2_r200, aL2_r210, aL2_r270, aL2_r271, aL2_r280, aL2_r281, aL2_r290, aL2_r300, aL2_r310,
      aL2_zTip, aL2_z070, aL2_z080, aL2_z090, aL2_z130, aL2_z150, aL2_z160, aL2_z170, aL2_r220, aL2_r230, aL2_z250, aL2_z260,
      aR1P12_r120, aR1P12_r130, aR1P12_r140, aR1P12_r220, aR1P12_r230, aR1P12_r240,
      aR1P11_040_050, aR1P11_070_080 : string = '';

  //Сообщения. Тип: String
  var mP2_r020, mP2_r021, mP2_r022, mP2_r030,
      mL6_r010, mL6_r190, mL6_r240, mL6_r330, mL6_r350, mL6_r370, mL6_r380, mL6_r390, mL6_r410, mL6_r440, mL6_r450, mL6_r480, mL6_r481, mL6_r490, mL6_r520, mL6_r530,
      mL5_2_r040, mL5_2_r060, mL5_2_r080, mL5_2_r100,
      mL5_1_r040, mL5_1_r060, mL5_1_r090, mL5_1_r100,
      mL4_r080,
      mL3Ra_r010, mL3Ra_r020, mL3Ra_r090,
      mL3Rb_r030,
      mL2P6b_r070,
      mL2P6a_r050, mL2P6a_r070,
      mL2P6_r040, mL2P6_r050, mL2P6_r051, mL2P6_r070, mL2P6_r100_110, mL2P6_r120, mL2P6_rKolPril,
      mL2P5_r030, mL2P5_r050, mL2P5_r070, mL2P5_r100_110, mL2P5_r120,
      mL2P4_r140, mL2P4_r160, mL2P4_r161,
      mL2P3_r150, mL2P3_r160, mL2P3_r340, mL2P3_r350, mL2P3_r360,
      mL2P2_r080, mL2P2_r130,
      mL2P1_r010, mL2P1_r030, mL2P1_r040,
      mL2_r010, mL2_r020, mL2_r030, mL2_r040, mL2_r050, mL2_r060, mL2_r100, mL2_r110, mL2_r120, mL2_r140, mL2_r180, mL2_r190, mL2_r200, mL2_r210, mL2_r220, mL2_r230, mL2_r270, mL2_r271, mL2_r280, mL2_r281, mL2_r290, mL2_r300, mL2_r310,
      mR1P12_r120, mR1P12_r220,
      mR1P11_040_050, mR1P11_070_080 : string = '';

  //Формулы с данными. Тип: String
  var vbufL2_r270_r280, vbufL2_r271_r281, vbufL2_300, vbufL2_310,
      vP2_r020, vP2_r021, vP2_r022, vP2_r030,
      vL6_r010, vL6_r190, vL6_r240, vL6_r330, vL6_r350, vL6_r370, vL6_r380, vL6_r390, vL6_r410, vL6_r440, vL6_r450, vL6_r480, vL6_r481, vL6_r490, vL6_r520, vL6_r530,
      vL5_2_r040, vL5_2_r060, vL5_2_r080, vL5_2_r100,
      vL5_1_r040, vL5_1_r060, vL5_1_r090, vL5_1_r100,
      vL4_r080,
      vL3Ra_r010, vL3Ra_r020, vL3Ra_r090,
      vL3Rb_r030,
      vL2P6b_r070,
      vL2P6a_r050, vL2P6a_r070,
      vL2P6_r040, vL2P6_r050, vL2P6_r051, vL2P6_r070, vL2P6_r100_110, vL2P6_r120, vL2P6_rKolPril,
      vL2P5_r030, vL2P5_r050, vL2P5_r070, vL2P5_r100_110, vL2P5_r120,
      vL2P4_r140, vL2P4_r160, vL2P4_r161,
      vL2P3_r150, vL2P3_r160, vL2P3_r340, vL2P3_r350, vL2P3_r360,
      vL2P2_r080, vL2P2_r130,
      vL2P1_r010, vL2P1_r030, vL2P1_r040,
      vL2_r010, vL2_r020, vL2_r030, vL2_r040, vL2_r050, vL2_r060, vL2_r100, vL2_r110, vL2_r120, vL2_r140, vL2_r180, vL2_r190, vL2_r200, vL2_r210, vL2_r220, vL2_r230, vL2_r270, vL2_r271, vL2_r280, vL2_r281, vL2_r290, vL2_r300, vL2_r310,
      vR1P12_r120, vR1P12_r220,
      vR1P12_r140, vR1P12_r240,
      vR1P11_040_050, vR1P11_070_080 : string = '';
  //#endregion ОБЪЯВЛЕНИЕ ПЕРЕМЕННЫХ
  //**********************************************************************************************************


  //==============================================================================
  //#region ИНИЦИАЛИЗАЦИЯ РАСЧЕТА ПОКАЗАТЕЛЕЙ С УЧЕТОМ ДАННЫХ ПРЕДЫДУЩЕГО ПЕРИОДА
  //------------------------------------------------------------------------------
  var bufPath : string;
  var flPath : boolean;
  var tmpXMLMap : XmlStruct new;

  bufPath := String(pFH.Func('myPathSelectionLatestTaxReport'));
  flPath := (bufPath <> '');

  if flPath
  {
    tmpXMLMap := new (XMLStruct);
    tmpXMLMap.ImpXml(bufPath);
  }
  //#endregion ИНИЦИАЛИЗАЦИЯ РАСЧЕТА ПОКАЗАТЕЛЕЙ С УЧЕТОМ ДАННЫХ ПРЕДЫДУЩЕГО ПЕРИОДА
  //==============================================================================


  //==============================================================================
  //#region ИНИЦИАЛИЗАЦИЯ ПЕРЕМЕННЫХ
  //------------------------------------------------------------------------------
  aL6_r010 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ДоходНПФВс'              ;
  aL6_r190 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/РасходВс'                  ;
  aL6_r240 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ОтчРазмРезУставВс';
  aL6_r330 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ПрибЦБРын'                 ;
  aL6_r350 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ПрибЦБНеРын'               ;
  aL6_r370 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДохПроцЦБ'                 ;
  aL6_r380 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДохПроцЭм2007'             ;
  aL6_r390 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/ДрИнвВлож'                 ;
  aL6_r410 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/НалБаза'               ;
  aL6_r440 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумНеучУбыт'           ;
  aL6_r450 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/НалБаза'             ;
  aL6_r480 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумНеучУбыт'         ;
  aL6_r481 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбыт458'          ;
  aL6_r490 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/НалБаза'                ;
  aL6_r520 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумНеучУбыт'            ;
  aL6_r530 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/НалБаза'                          ;
  aL6_z020 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/РеалЦБРын'               ;   L6_z020 := GetDblVal(aL6_z020);
  aL6_z030 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ОтклВырЦБРын'            ;   L6_z030 := GetDblVal(aL6_z030);
  aL6_z040 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/РеалЦБНеРын'             ;   L6_z040 := GetDblVal(aL6_z040);
  aL6_z050 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ОтклВырЦБНеРын'          ;   L6_z050 := GetDblVal(aL6_z050);
  aL6_z060 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцГосЦБ'               ;   L6_z060 := GetDblVal(aL6_z060);
  aL6_z070 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцЦБЭм2007'            ;   L6_z070 := GetDblVal(aL6_z070);
  aL6_z080 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ДолУчДрОрг'              ;   L6_z080 := GetDblVal(aL6_z080);
  aL6_z090 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцГосЦБУдНА'           ;   L6_z090 := GetDblVal(aL6_z090);
  aL6_z100 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ПроцМунЦБ2007НА'         ;   L6_z100 := GetDblVal(aL6_z100);
  aL6_z110 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФ/ДрИнвВлож'               ;   L6_z110 := GetDblVal(aL6_z110);
  aL6_z140 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ЦБРын'              ;   L6_z140 := GetDblVal(aL6_z140);
  aL6_z150 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ЦБНеРын'            ;   L6_z150 := GetDblVal(aL6_z150);
  aL6_z160 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ПроцГосЦБ'          ;   L6_z160 := GetDblVal(aL6_z160);
  aL6_z170 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ПроцЦБЭм2007'       ;   L6_z170 := GetDblVal(aL6_z170);
  aL6_z180 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ДрИнвВлож'          ;   L6_z180 := GetDblVal(aL6_z180);
  aL6_z200 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/ВлЦБРын'                   ;   L6_z200 := GetDblVal(aL6_z200);
  aL6_z210 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/ВлЦБНеРын'                 ;   L6_z210 := GetDblVal(aL6_z210);
  aL6_z220 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/Расход/ДрИнвВлож'                 ;   L6_z220 := GetDblVal(aL6_z220);
  aL6_z250 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ЦБРын'            ;   L6_z250 := GetDblVal(aL6_z250);
  aL6_z260 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ЦБНеРын'          ;   L6_z260 := GetDblVal(aL6_z260);
  aL6_z270 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБ'           ;   L6_z270 := GetDblVal(aL6_z270);
  aL6_z280 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБЭм2007'     ;   L6_z280 := GetDblVal(aL6_z280);
  aL6_z290 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ДолУчДрОрг'       ;   L6_z290 := GetDblVal(aL6_z290);
  aL6_z300 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБУдНА'       ;   L6_z300 := GetDblVal(aL6_z300);
  aL6_z310 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ПроцЦБЭм2007УдНА' ;   L6_z310 := GetDblVal(aL6_z310);
  aL6_z320 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ОтчРазмРезУстав/ДрИнвВлож'        ;   L6_z320 := GetDblVal(aL6_z320);
  aL6_z340 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклПрибЦБРын'          ;   L6_z340 := GetDblVal(aL6_z340);
  aL6_z360 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклПрибЦБНеРын'        ;   L6_z360 := GetDblVal(aL6_z360);
  aL6_z400 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ПрибУб/СумИсклДрИнвВлож'          ;   L6_z400 := GetDblVal(aL6_z400);
  aL6_z420 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумУбПред'             ;   L6_z420 := GetDblVal(aL6_z420);
  aL6_z430 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргРын/СумУбПриз'             ;   L6_z430 := GetDblVal(aL6_z430);
  aL6_z459 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/ОстУбСдНеОбрНач'     ;   L6_z459 := GetDblVal(aL6_z459);
  aL6_z460 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПред'           ;   L6_z460 := GetDblVal(aL6_z460);
  aL6_z470 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПриз'           ;   L6_z470 := GetDblVal(aL6_z470);
  aL6_z471 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ВлЦБОргНеРын/СумУбПриз458'        ;   L6_z471 := GetDblVal(aL6_z471);
  aL6_z500 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумУбПред'              ;   L6_z500 := GetDblVal(aL6_z500);
  aL6_z510 := 'Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДрИнвВлож/СумУбПриз'              ;   L6_z510 := GetDblVal(aL6_z510);

  L6_r530 := 0;

  bufL2_r270_r280 := 0;
  bufL2_r271_r281 := 0;
  bufL2_300       := 0;
  bufL2_310       := 0;
  bufL5_1_r100    := 0;
  bufL5_2_r100    := 0;

  fl_L5_1_r100 := False;
  fl_L5_2_r100 := False;

  vbufL2_r270_r280 := '';
  vbufL2_r271_r281 := '';
  vbufL2_300       := '';
  vbufL2_310       := '';
  //#endregion ИНИЦИАЛИЗАЦИЯ ПЕРЕМЕННЫХ
  //==============================================================================


  //==========================================================================================================
  //#region ЛИСТ 05 (ДО 01.01.2015)
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалБазОпОсобС'); i++)
  {
    if not GetStrNull('Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/ВидОпер')
    {
      NameStr := pFH.Func('myGetPage_L5v1', i+1);

      fl_L5_1_r100 := True;

      aL5_1_r040 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/Прибыль'         ;
      aL5_1_r060 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/НалБазаБезУбПред';
      aL5_1_r090 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумНеучУбытПер'  ;
      aL5_1_r100 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/НалБаза'         ;
      aL5_1_z010 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/ДохВыбытПогаш'   ;   L5_1_z010 := GetDblVal(aL5_1_z010);
      aL5_1_z020 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумОтклМинЦ'     ;   L5_1_z020 := GetDblVal(aL5_1_z020);
      aL5_1_z030 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/РасхПриобРеал'   ;   L5_1_z030 := GetDblVal(aL5_1_z030);
      aL5_1_z031 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумОтклМаксЦ'    ;   L5_1_z031 := GetDblVal(aL5_1_z031);
      aL5_1_z050 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/КорПриб'         ;   L5_1_z050 := GetDblVal(aL5_1_z050);
      aL5_1_z070 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумУбытПред'     ;   L5_1_z070 := GetDblVal(aL5_1_z070);
      aL5_1_z080 := 'Файл/Документ/Прибыль/НалБазОпОсобС'+getIter(i)+'/СумУбытУменНБ'   ;   L5_1_z080 := GetDblVal(aL5_1_z080);

      mL5_1_r040 := 'Стр. 040 = стр. 010 + стр. 020 - стр. 030 + стр. 031';
      mL5_1_r060 := 'Cтр. 060 = стр. 040 - стр. 050'                      ;
      mL5_1_r100 := 'Стр. 100 = стр. 060 - стр. 080'                      ;



      L5_1_r040 := L5_1_z010 + L5_1_z020 - L5_1_z030 + L5_1_z031;
      vL5_1_r040 := #GDS0(L5_1_r040)+' = '+#GDS0(L5_1_z010)+' + '+#GDS0(L5_1_z020)+' - '+#GDS0(L5_1_z030)+' + '+#GDS0(L5_1_z031);
      #_SetFldGV(aL5_1_r040, L5_1_r040);

      L5_1_r060 := L5_1_r040 - L5_1_z050;
      vL5_1_r060 := #GDS0(L5_1_r060)+' = '+#GDS0(L5_1_r040)+' - '+#GDS0(L5_1_z050);

      if (L5_1_r060 < 0)
      {
        L5_1_r060 := 0;
        vL5_1_r060 := 'Cтр. 060 = 0 (нулю) (т.к. значение меньше нуля)';
        vL5_1_r060 := #GDS0(L5_1_r060)+' = 0';
      }

      #_SetFldGV(aL5_1_r060, L5_1_r060);

      L5_1_r100 := L5_1_r060 - L5_1_z080;
      vL5_1_r100 := #GDS0(L5_1_r100)+' = '+#GDS0(L5_1_r060)+' - '+#GDS0(L5_1_z080);
      #_SetFldGV(aL5_1_r100, L5_1_r100);

      bufL5_1_r100 := bufL5_1_r100 + L5_1_r100;

      if ((L5_1_r040 < 0) and _NalPer_God)
      {
        L5_1_r090 := Abs(L5_1_r040 + L5_1_z070);
        vL5_1_r090 := 'Стр. 090 = Модуль(стр. 040 + стр. 070)';
        vL5_1_r090 := #GDS0(L5_1_r090)+' = Модуль('+#GDS0(L5_1_r040)+' + '+#GDS0(L5_1_z070)+')';
      }
      else
      {
        L5_1_r090 := L5_1_z070 - L5_1_z080;
        mL5_1_r090 := 'Стр. 090 = стр. 070 - стр. 080';
        vL5_1_r090 := #GDS0(L5_1_r090)+' = '+#GDS0(L5_1_z070)+' - '+#GDS0(L5_1_z080);
      }

      #_SetFld(aL5_1_r090, L5_1_r090);



      #_Log(aL5_1_r040, mL5_1_r040, vL5_1_r040);
      #_Log(aL5_1_r060, mL5_1_r060, vL5_1_r060);
      #_Log(aL5_1_r090, mL5_1_r090, vL5_1_r090);
      #_Log(aL5_1_r100, mL5_1_r100, vL5_1_r100);
    }
  }
  //#endregion ЛИСТ 05 (ДО 01.01.2015)
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 05 (С 01.01.2015)
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалБазОпОсобН'); i++)
  {
    if not GetStrNull('Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ВидОпер')
    {
      NameStr := pFH.Func('myGetPage_L5v2', i+1);

      fl_L5_2_r100 := True;

      aL5_2_r040 := 'Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/Прибыль'         ;
      aL5_2_r060 := 'Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/НалБазаБезУбПред';
      aL5_2_r080 := 'Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/СумУбытУменНБ'   ;
      aL5_2_r100 := 'Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/НалБаза'         ;
      aL5_2_z010 := 'Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/ДохВыбыт'        ;   L5_2_z010 := GetDblVal(aL5_2_z010);
      aL5_2_z020 := 'Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/РасхПриобРеал'   ;   L5_2_z020 := GetDblVal(aL5_2_z020);
      aL5_2_z050 := 'Файл/Документ/Прибыль/НалБазОпОсобН'+getIter(i)+'/КорПриб'         ;   L5_2_z050 := GetDblVal(aL5_2_z050);

      mL5_2_r040 := 'Стр. 040 = стр. 010 - стр. 020';
      mL5_2_r060 := 'Стр. 060 = стр. 040 - стр. 050';
      mL5_2_r080 := 'Стр. 080 = сумма стр. 150 Прил. 4 Листа 02 (с типом налогоплат. равным 5)';
      mL5_2_r100 := 'Стр. 100 = стр. 060 - стр. 080';



      L5_2_r040 := L5_2_z010 - L5_2_z020;
      vL5_2_r040 := #GDS0(L5_2_r040)+' = '+#GDS0(L5_2_z010)+' - '+#GDS0(L5_2_z020);
      #_SetFldGV(aL5_2_r040, L5_2_r040);

      L5_2_r060 := L5_2_r040 - L5_2_z050;
      vL5_2_r060 := #GDS0(L5_2_r060)+' = '+#GDS0(L5_2_r040)+' - '+#GDS0(L5_2_z050);

      if (L5_2_r060 < 0)
      {
        L5_2_r060 := 0;
        vL5_2_r060 := 'Cтр. 060 = 0 (нулю) (т.к. значение меньше нуля)';
        vL5_2_r060 := #GDS0(L5_2_r060)+' = 0';
      }

      #_SetFldGV(aL5_2_r060, L5_2_r060);

      vL5_2_r080 := '';
      L2P4_z150 := 0;
      fl1 := False;

      for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'); j++)
      {
        if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/ТипНП')
          for (k := 0; k < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/УбытУменНБ'); k++)
          {
            if     not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/УбытУменНБ'+getIter(k)+'/ТипНП')
               and    (GetIntVal ('Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/УбытУменНБ'+getIter(k)+'/ТипНП') = 5)
            {
              fl1 := True;
              bufL2P4_z150 := GetDblVal('Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/УбытУменНБ'+getIter(k)+'/УбытУмНалБаза');
              L2P4_z150 := L2P4_z150 + bufL2P4_z150;

              vL5_2_r080 := vL5_2_r080+#GDS0(bufL2P4_z150)+' + ';
            }
          }
      }

      if fl1
      {
        L5_2_r080 := L2P4_z150;
        vL5_2_r080 := #GDS0(L5_2_r080)+' = ('+SubStr(vL5_2_r080, 1, Length(vL5_2_r080) - 3)+')';
        #_Log(aL5_2_r080, mL5_2_r080, vL5_2_r080);

        #_SetFld(aL5_2_r080, L5_2_r080);
      }
      else { #SetSNull(aL5_2_r080, L5_2_r080); }

      L5_2_r100 := L5_2_r060 - L5_2_r080;
      vL5_2_r100 := #GDS0(L5_2_r100)+' = '+#GDS0(L5_2_r060)+' - '+#GDS0(L5_2_r080);

      #_SetFldGV(aL5_2_r100, L5_2_r100);

      bufL5_2_r100 := bufL5_2_r100 + L5_2_r100;



      #_Log(aL5_2_r040, mL5_2_r040, vL5_2_r040);
      #_Log(aL5_2_r060, mL5_2_r060, vL5_2_r060);
      #_Log(aL5_2_r100, mL5_2_r100, vL5_2_r100);
    }
  }
  //#endregion ЛИСТ 05 (С 01.01.2015)
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 06
  //----------------------------------------------------------------------------------------------------------
  if     not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/СумПенсРез'                   )
     and not GetStrNull('Файл/Документ/Прибыль/ДохРасНалБазаНПФ/ДоходНПФСтРеф/ДоходНПФСтРефВс')
  {
    NameStr := pFH.Func('myGetPage_L6_3');

    mL6_r010 := 'Стр. 010 = стр. 020 + стр. 030 + стр. 040 + стр. 050 + стр. 060 + стр. 070 + стр. 080 + стр. 090 + стр. 100 + стр. 110';
    mL6_r190 := 'Стр. 190 = стр. 200 + стр. 210 + стр. 220'                                                                             ;
    mL6_r240 := 'Стр. 240 = стр. 250 + стр. 260 + стр. 270 + стр. 280 + стр. 290 + стр. 300 + стр. 310 + стр. 320                    '  ;
    mL6_r330 := 'Стр. 330 = стр. 020 + стр. 030 - стр. 140 - стр. 200 - стр. 250'                                                       ;
    mL6_r350 := 'Стр. 350 = стр. 040 + стр. 050 - стр. 150 - стр. 210 - стр. 260'                                                       ;
    mL6_r370 := 'Стр. 370 = стр. 060 - стр. 160 - стр. 270'                                                                             ;
    mL6_r380 := 'Стр. 380 = стр. 070 - стр. 170 - стр. 280'                                                                             ;
    mL6_r390 := 'Стр. 390 = стр. 110 - стр. 180 - стр. 220 - стр. 320'                                                                  ;
    mL6_r410 := 'Стр. 410 = стр. 330 - стр. 340'                                                                                        ;
    mL6_r440 := 'Стр. 440 = стр. 420 - стр. 430'                                                                                        ;
    mL6_r450 := 'Стр. 450 = стр. 350 - стр. 360'                                                                                        ;
    mL6_r480 := 'Стр. 480 = стр. 460 - стр. 470 - стр. 471'                                                                             ;
    mL6_r481 := 'Стр. 481 = стр. 459 - стр. 471'                                                                                        ;
    mL6_r490 := 'Стр. 490 = стр. 390 - стр. 400'                                                                                        ;
    mL6_r520 := 'Стр. 520 = стр. 500 - стр. 510'                                                                                        ;



    L6_r010 := L6_z020 + L6_z030 + L6_z040 + L6_z050 + L6_z060 + L6_z070 + L6_z080 + L6_z090 + L6_z100 + L6_z110;                                 #_SetFld  (aL6_r010, L6_r010);
    L6_r190 := L6_z200 + L6_z210 + L6_z220                                                                      ;                                 #_SetFld  (aL6_r190, L6_r190);
    L6_r240 := L6_z250 + L6_z260 + L6_z270 + L6_z280 + L6_z290 + L6_z300 + L6_z310 + L6_z320                    ;                                 #_SetFld  (aL6_r240, L6_r240);
    L6_r330 := L6_z020 + L6_z030 - L6_z140 - L6_z200 - L6_z250                                                  ;   vL6_r330 := #GDS0(L6_r330);   #_SetFldGV(aL6_r330, L6_r330);
    L6_r350 := L6_z040 + L6_z050 - L6_z150 - L6_z210 - L6_z260                                                  ;   vL6_r350 := #GDS0(L6_r350);   #_SetFldGV(aL6_r350, L6_r350);
    L6_r370 := L6_z060 - L6_z160 - L6_z270                                                                      ;                                 #_SetFld  (aL6_r370, L6_r370);
    L6_r380 := L6_z070 - L6_z170 - L6_z280                                                                      ;                                 #_SetFld  (aL6_r380, L6_r380);
    L6_r390 := L6_z110 - L6_z180 - L6_z220 - L6_z320                                                            ;   vL6_r390 := #GDS0(L6_r390);   #_SetFldGV(aL6_r390, L6_r390);
    L6_r410 := L6_r330 - L6_z340                                                                                ;

    vL6_r010 := #GDS0(L6_r010)+' = '+#GDS0(L6_z020)+' + '+#GDS0(L6_z030)+' + '+#GDS0(L6_z040)+' + '+#GDS0(L6_z050)+' + '+#GDS0(L6_z060)+' + '+#GDS0(L6_z070)+' + '+#GDS0(L6_z080)+' + '+#GDS0(L6_z090)+' + '+#GDS0(L6_z100)+' + '+#GDS0(L6_z110);
    vL6_r190 := #GDS0(L6_r190)+' = '+#GDS0(L6_z200)+' + '+#GDS0(L6_z210)+' + '+#GDS0(L6_z220)                                                                                                                                                   ;
    vL6_r240 := #GDS0(L6_r240)+' = '+#GDS0(L6_z250)+' + '+#GDS0(L6_z260)+' + '+#GDS0(L6_z270)+' + '+#GDS0(L6_z280)+' + '+#GDS0(L6_z290)+' + '+#GDS0(L6_z300)+' + '+#GDS0(L6_z310)+' + '+#GDS0(L6_z320)                                          ;
    vL6_r330 := vL6_r330      +' = '+#GDS0(L6_z020)+' + '+#GDS0(L6_z030)+' - '+#GDS0(L6_z140)+' - '+#GDS0(L6_z200)+' - '+#GDS0(L6_z250)                                                                                                         ;
    vL6_r350 := vL6_r350      +' = '+#GDS0(L6_z040)+' + '+#GDS0(L6_z050)+' - '+#GDS0(L6_z150)+' - '+#GDS0(L6_z210)+' - '+#GDS0(L6_z260)                                                                                                         ;
    vL6_r370 := #GDS0(L6_r370)+' = '+#GDS0(L6_z060)+' - '+#GDS0(L6_z160)+' - '+#GDS0(L6_z270)                                                                                                                                                   ;
    vL6_r380 := #GDS0(L6_r380)+' = '+#GDS0(L6_z070)+' - '+#GDS0(L6_z170)+' - '+#GDS0(L6_z280)                                                                                                                                                   ;
    vL6_r390 := vL6_r390      +' = '+#GDS0(L6_z110)+' - '+#GDS0(L6_z180)+' - '+#GDS0(L6_z220)+' - '+#GDS0(L6_z320)                                                                                                                              ;
    vL6_r410 := #GDS0(L6_r410)+' = '+#GDS0(L6_r330)+' - '+#GDS0(L6_z340)                                                                                                                                                                        ;

    if _NalPer_God
    {
      L6_r440 := L6_z420 - L6_z430;
      vL6_r440 := #GDS0(L6_r440)+' = '+#GDS0(L6_z420)+' - '+#GDS0(L6_z430);
      #_Log(aL6_r440, mL6_r440, vL6_r440);
      #_SetFld(aL6_r440, L6_r440);
    }
    else { #SetSNull(aL6_r440, L6_r440); }

    L6_r450 := L6_r350 - L6_z360          ;
    L6_r480 := L6_z460 - L6_z470 - L6_z471;   #_SetFld(aL6_r480, L6_r480);
    L6_r481 := L6_z459 - L6_z471          ;   #_SetFld(aL6_r481, L6_r481);
    L6_r490 := L6_r390 - L6_z400          ;

    vL6_r450 := #GDS0(L6_r450)+' = '+#GDS0(L6_r350)+' - '+#GDS0(L6_z360)                     ;
    vL6_r480 := #GDS0(L6_r480)+' = '+#GDS0(L6_z460)+' - '+#GDS0(L6_z470)+' - '+#GDS0(L6_z471);
    vL6_r481 := #GDS0(L6_r481)+' = '+#GDS0(L6_z459)+' - '+#GDS0(L6_z471)                     ;
    vL6_r490 := #GDS0(L6_r490)+' = '+#GDS0(L6_r390)+' - '+#GDS0(L6_z400)                     ;

    if _NalPer_God
    {
      L6_r520 := L6_z500 - L6_z510;
      vL6_r520 := #GDS0(L6_r520)+' = '+#GDS0(L6_z500)+' - '+#GDS0(L6_z510);
      #_Log(aL6_r520, mL6_r520, vL6_r520);
      #_SetFld(aL6_r520, L6_r520);
    }
    else { #SetSNull(aL6_r520, L6_r520); }

    if (L6_r330 < 0) {L6_r410 := 0;   mL6_r410 := 'Cтр. 410 = 0 (нулю) (т.к. стр. 330 меньше нуля)';   vL6_r410 := #GDS0(L6_r410)+' = 0';}   #_SetFldGV(aL6_r410, L6_r410);
    if (L6_r350 < 0) {L6_r450 := 0;   mL6_r450 := 'Cтр. 450 = 0 (нулю) (т.к. стр. 350 меньше нуля)';   vL6_r450 := #GDS0(L6_r450)+' = 0';}   #_SetFldGV(aL6_r450, L6_r450);
    if (L6_r390 < 0) {L6_r490 := 0;   mL6_r490 := 'Cтр. 490 = 0 (нулю) (т.к. стр. 390 меньше нуля)';   vL6_r490 := #GDS0(L6_r490)+' = 0';}   #_SetFldGV(aL6_r490, L6_r490);

    if L6_r330 < 0
    {
      L6_r530 := L6_r330 + L6_r410 + L6_r450 - L6_z470 + L6_r490 - L6_z510;
      mL6_r530 := 'Cтр. 530 = стр. 330 + стр. 410 + стр. 450 - стр. 470 + стр. 490 - стр. 510';
      vL6_r530 := #GDS0(L6_r530)+' = '+#GDS0(L6_r330)+' + '+#GDS0(L6_r410)+' + '+#GDS0(L6_r450)+' - '+#GDS0(L6_z470)+' + '+#GDS0(L6_r490)+' - '+#GDS0(L6_z510);
    }
    else
    {
      L6_r530 := L6_r410 + L6_r450 - L6_z470 + L6_r490 - L6_z510;
      mL6_r530 := 'Cтр. 530 = стр. 410 + стр. 450 - стр. 470 + стр. 490 - стр. 510';
      vL6_r530 := #GDS0(L6_r530)+' = '+#GDS0(L6_r410)+' + '+#GDS0(L6_r450)+' - '+#GDS0(L6_z470)+' + '+#GDS0(L6_r490)+' - '+#GDS0(L6_z510);
    }

    #_SetFld(aL6_r530, L6_r530);



    NameStr := pFH.Func('myGetPage_L6_1');
    #_Log(aL6_r010, mL6_r010, vL6_r010);

    NameStr := pFH.Func('myGetPage_L6_2');
    #_Log(aL6_r190, mL6_r190, vL6_r190);
    #_Log(aL6_r240, mL6_r240, vL6_r240);

    NameStr := pFH.Func('myGetPage_L6_3');
    #_Log(aL6_r330, mL6_r330, vL6_r330);
    #_Log(aL6_r350, mL6_r350, vL6_r350);
    #_Log(aL6_r370, mL6_r370, vL6_r370);
    #_Log(aL6_r380, mL6_r380, vL6_r380);
    #_Log(aL6_r390, mL6_r390, vL6_r390);
    #_Log(aL6_r410, mL6_r410, vL6_r410);
    #_Log(aL6_r450, mL6_r450, vL6_r450);
    #_Log(aL6_r480, mL6_r480, vL6_r480);
    #_Log(aL6_r481, mL6_r481, vL6_r481);
    #_Log(aL6_r490, mL6_r490, vL6_r490);
    #_Log(aL6_r530, mL6_r530, vL6_r530);
  }
  //#endregion ЛИСТ 06
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 02
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'); i++)
  {
    if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ТипНП')
    {
      L2P1_r040 := 0;
      L2P1_z100 := 0;
      L2P2_r130 := 0;
      L2P2_z200 := 0;
      L2P2_z300 := 0;
      L2P2_z400 := 0;
      L2P3_r340 := 0;
      L2P3_r350 := 0;
      L2P3_r360 := 0;

      bufL2P4_z150 := 0;
      fl_L2P4_z150 := False;

      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 3
      //----------------------------------------------------------------------------------------------------------
      if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ТипНП')
      {
        aL2P3_r150 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1/Убыт1Прев269'    ;
        aL2P3_r160 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ2/Убыт2РеалПТ'     ;
        aL2P3_r340 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручОп302Ит'                ;
        aL2P3_r350 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхОп302Ит'                 ;
        aL2P3_r360 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытОп302'                   ;
        aL2P3_z030 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалАИ'                 ;   L2P3_z030 := GetDblVal(aL2P3_z030);
        aL2P3_z040 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ОстСтРеалАИ'                 ;   L2P3_z040 := GetDblVal(aL2P3_z040);
        aL2P3_z060 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалАИ'                  ;   L2P3_z060 := GetDblVal(aL2P3_z060);
        aL2P3_z100 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ/ВыручРеалПТДоСр' ;   L2P3_z100 := GetDblVal(aL2P3_z100);
        aL2P3_z110 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалПТ/ВыручРеалПТПосСр';   L2P3_z110 := GetDblVal(aL2P3_z110);
        aL2P3_z120 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ/СтоимРеалПТДоСр' ;   L2P3_z120 := GetDblVal(aL2P3_z120);
        aL2P3_z130 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/СтоимРеалПТ/СтоимРеалПТПосСр';   L2P3_z130 := GetDblVal(aL2P3_z130);
        aL2P3_z140 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПТ1/Убыт1Соот269'    ;   L2P3_z140 := GetDblVal(aL2P3_z140);
        aL2P3_z180 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ВыручРеалТов'                ;   L2P3_z180 := GetDblVal(aL2P3_z180);
        aL2P3_z190 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхРеалТов'                 ;   L2P3_z190 := GetDblVal(aL2P3_z190);
        aL2P3_z201 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытОбОбслНеобл'             ;   L2P3_z201 := GetDblVal(aL2P3_z201);
        aL2P3_z210 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ДохДоговДУИ'                 ;   L2P3_z210 := GetDblVal(aL2P3_z210);
        aL2P3_z211 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ДохДоговДУИ_ВнР'             ;   L2P3_z211 := GetDblVal(aL2P3_z211);
        aL2P3_z220 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхДоговДУИ'                ;   L2P3_z220 := GetDblVal(aL2P3_z220);
        aL2P3_z221 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/РасхДоговДУИ_ВнР'            ;   L2P3_z221 := GetDblVal(aL2P3_z221);
        aL2P3_z230 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытДоговДУИ'                ;   L2P3_z230 := GetDblVal(aL2P3_z230);
        aL2P3_z240 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/ЦенРеалПрЗУ'                 ;   L2P3_z240 := GetDblVal(aL2P3_z240);
        aL2P3_z250 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/НеВозЗатрПрЗУ'               ;   L2P3_z250 := GetDblVal(aL2P3_z250);
        aL2P3_z260 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчРасхОпер/УбытРеалПрЗУ'                ;   L2P3_z260 := GetDblVal(aL2P3_z260);

        if (L2P3_z120 > L2P3_z140)
        {
          L2P3_r150 := L2P3_z120 - L2P3_z100 - L2P3_z140;
          mL2P3_r150 := 'Cтр. 150 = стр. 120 - стр. 100 - стр. 140';
          vL2P3_r150 := #GDS0(L2P3_r150)+' = '+#GDS0(L2P3_z120)+' - '+#GDS0(L2P3_z100)+' - '+#GDS0(L2P3_z140);
          #_SetFldGV(aL2P3_r150, L2P3_r150);
        }
        else
        {
          L2P3_r150 := 0;
          mL2P3_r150 := 'Cтр. 150 = 0';
          vL2P3_r150 := #GDS0(L2P3_r150)+' = 0';
          #SetSNull(aL2P3_r150, L2P3_r150);
        }

        if (L2P3_z130 > L2P3_z110)
        {
          L2P3_r160 := L2P3_z130 - L2P3_z110;
          mL2P3_r160 := 'Стр. 160 = стр. 130 - стр. 110';
          vL2P3_r160 := #GDS0(L2P3_r160)+' = '+#GDS0(L2P3_z130)+' - '+#GDS0(L2P3_z110);
          #_SetFldGV(aL2P3_r160, L2P3_r160);
        }
        else
        {
          L2P3_r160 := 0;
          mL2P3_r160 := 'Cтр. 160 = 0';
          vL2P3_r160 := #GDS0(L2P3_r160)+' = 0';
          #SetSNull(aL2P3_r160, L2P3_r160);
        }

        L2P3_r340 := L2P3_z030 + L2P3_z100 + L2P3_z110 + L2P3_z180 + L2P3_z210 - L2P3_z211 + L2P3_z240;   vL2P3_r340 := #GDS0(L2P3_r340);   #_SetFldGV(aL2P3_r340, L2P3_r340);
        L2P3_r350 := L2P3_z040 + L2P3_z120 + L2P3_z130 + L2P3_z190 + L2P3_z220 - L2P3_z221 + L2P3_z250;   vL2P3_r350 := #GDS0(L2P3_r350);   #_SetFldGV(aL2P3_r350, L2P3_r350);
        L2P3_r360 := L2P3_z060 + L2P3_r150 + L2P3_r160 + L2P3_z201 + L2P3_z230 + L2P3_z260            ;   vL2P3_r360 := #GDS0(L2P3_r360);   #_SetFldGV(aL2P3_r360, L2P3_r360);



        mL2P3_r340 := 'Стр. 340 = стр. 030 + стр. 100 + стр. 110 + стр. 180 + стр. 210 - стр. 211 + стр.240';
        mL2P3_r350 := 'Стр. 350 = стр. 040 + стр. 120 + стр. 130 + стр. 190 + стр. 220 - стр. 221 + стр.250';
        mL2P3_r360 := 'Стр. 360 = стр. 060 + стр. 150 + стр. 160 + стр. 201 + стр. 230 + стр. 260'          ;

        vL2P3_r340 := vL2P3_r340+' = '+#GDS0(L2P3_z030)+' + '+#GDS0(L2P3_z100)+' + '+#GDS0(L2P3_z110)+' + '+#GDS0(L2P3_z180)+' + '+#GDS0(L2P3_z210)+' - '+#GDS0(L2P3_z211)+' + '+#GDS0(L2P3_z240);
        vL2P3_r350 := vL2P3_r350+' = '+#GDS0(L2P3_z040)+' + '+#GDS0(L2P3_z120)+' + '+#GDS0(L2P3_z130)+' + '+#GDS0(L2P3_z190)+' + '+#GDS0(L2P3_z220)+' - '+#GDS0(L2P3_z221)+' + '+#GDS0(L2P3_z250);
        vL2P3_r360 := vL2P3_r360+' = '+#GDS0(L2P3_z060)+' + '+#GDS0(L2P3_r150)+' + '+#GDS0(L2P3_r160)+' + '+#GDS0(L2P3_z201)+' + '+#GDS0(L2P3_z230)+' + '+#GDS0(L2P3_z260)                       ;

        NameStr := pFH.Func('myGetPage_L2P3_1', i+1);
        #_Log(aL2P3_r150, mL2P3_r150, vL2P3_r150);
        #_Log(aL2P3_r160, mL2P3_r160, vL2P3_r160);

        NameStr := pFH.Func('myGetPage_L2P3_2', i+1);
        #_Log(aL2P3_r340, mL2P3_r340, vL2P3_r340);
        #_Log(aL2P3_r350, mL2P3_r350, vL2P3_r350);
        #_Log(aL2P3_r360, mL2P3_r360, vL2P3_r360);
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 3
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 1
      //----------------------------------------------------------------------------------------------------------
      if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ТипНП')
      {
        aL2P1_r010 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалВс'       ;
        aL2P1_r030 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалОпер32'           ;
        aL2P1_r040 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалИтог'             ;
        aL2P1_z011 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалТовСоб'   ;   L2P1_z011 := GetDblVal(aL2P1_z011);
        aL2P1_z012 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалТовПок'   ;   L2P1_z012 := GetDblVal(aL2P1_z012);
        aL2P1_z013 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалИмПрав'   ;   L2P1_z013 := GetDblVal(aL2P1_z013);
        aL2P1_z014 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеал/ВырРеалИмПроч'   ;   L2P1_z014 := GetDblVal(aL2P1_z014);
        aL2P1_z020 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБ/ВырРеалЦБВс'   ;   L2P1_z020 := GetDblVal(aL2P1_z020);
        aL2P1_z023 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалЦБОбр/ВырРеалЦБВс';   L2P1_z023 := GetDblVal(aL2P1_z023);
        aL2P1_z027 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохРеал/ВырРеалПред'             ;   L2P1_z027 := GetDblVal(aL2P1_z027);
        aL2P1_z100 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеалВнеРеал/ДохВнеРеал/ВнеРеалДохВс'         ;   L2P1_z100 := GetDblVal(aL2P1_z100);

        L2P1_r010 := L2P1_z011 + L2P1_z012 + L2P1_z013 + L2P1_z014            ;   vL2P1_r010 := #GDS0(L2P1_r010);   #_SetFldGV(aL2P1_r010, L2P1_r010);
        L2P1_r030 := L2P3_r340                                                ;   vL2P1_r030 := #GDS0(L2P1_r030);   #_SetFldGV(aL2P1_r030, L2P1_r030);
        L2P1_r040 := L2P1_r010 + L2P1_z020 + L2P1_z023 + L2P1_z027 + L2P1_r030;   vL2P1_r040 := #GDS0(L2P1_r040);   #_SetFldGV(aL2P1_r040, L2P1_r040);

        mL2P1_r010 := 'Стр. 010 = стр. 011 + стр. 012 + стр. 013 + стр. 014'           ;
        mL2P1_r030 := 'Стр. 030 = стр. 340 Прил. 3 Листа 02'                           ;
        mL2P1_r040 := 'Стр. 040 = стр. 010 + стр. 020 + стр. 023 + стр. 027 + стр. 030';

        vL2P1_r010 := vL2P1_r010+' = '+#GDS0(L2P1_z011)+' + '+#GDS0(L2P1_z012)+' + '+#GDS0(L2P1_z013)+' + '+#GDS0(L2P1_z014)                       ;
        vL2P1_r030 := vL2P1_r030+' = '+#GDS0(L2P3_r340)                                                                                            ;
        vL2P1_r040 := vL2P1_r040+' = '+#GDS0(L2P1_r010)+' + '+#GDS0(L2P1_z020)+' + '+#GDS0(L2P1_z023)+' + '+#GDS0(L2P1_z027)+' + '+#GDS0(L2P1_r030);

        NameStr := pFH.Func('myGetPage_L2P1', i+1);
        #_Log(aL2P1_r010, mL2P1_r010, vL2P1_r010);
        #_Log(aL2P1_r030, mL2P1_r030, vL2P1_r030);
        #_Log(aL2P1_r040, mL2P1_r040, vL2P1_r040);
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 1
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 2
      //----------------------------------------------------------------------------------------------------------
      if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/ТипНП')
      {
        aL2P2_r080 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхОпер32'                 ;
        aL2P2_r130 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РасхПризнИтого'             ;
        aL2P2_z010 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхРеал'               ;   L2P2_z010 := GetDblVal(aL2P2_z010);
        aL2P2_z020 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПрямРасхТорг/ПрямРасхТоргВс';   L2P2_z020 := GetDblVal(aL2P2_z020);
        aL2P2_z040 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/КосвРасх/КосвРасхВс'        ;   L2P2_z040 := GetDblVal(aL2P2_z040);
        aL2P2_z059 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/РеалИмущПрав'               ;   L2P2_z059 := GetDblVal(aL2P2_z059);
        aL2P2_z060 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобрРеалИмущ'             ;   L2P2_z060 := GetDblVal(aL2P2_z060);
        aL2P2_z061 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/АктивРеалПред'              ;   L2P2_z061 := GetDblVal(aL2P2_z061);
        aL2P2_z070 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобРеалЦБ'                ;   L2P2_z070 := GetDblVal(aL2P2_z070);
        aL2P2_z072 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/ПриобРеалЦБОрг'             ;   L2P2_z072 := GetDblVal(aL2P2_z072);
        aL2P2_z090 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытПрошОбсл'               ;   L2P2_z090 := GetDblVal(aL2P2_z090);
        aL2P2_z100 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытРеалАмИм'               ;   L2P2_z100 := GetDblVal(aL2P2_z100);
        aL2P2_z110 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/УбытРеалЗемУч'              ;   L2P2_z110 := GetDblVal(aL2P2_z110);
        aL2P2_z120 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхРеал/НадбПокПред'                ;   L2P2_z120 := GetDblVal(aL2P2_z120);
        aL2P2_z200 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/РасхВнеРеал/РасхВнеРеалВс'           ;   L2P2_z200 := GetDblVal(aL2P2_z200);
        aL2P2_z300 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/УбытПриравн/УбытПриравнВс'           ;   L2P2_z300 := GetDblVal(aL2P2_z300);
        aL2P2_z400 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхРеалВнеРеал/КорНБЛиш/КорНБЛишВс'                 ;   L2P2_z400 := GetDblVal(aL2P2_z400);

        L2P2_r080 := L2P3_r350                                                                                                                                                ;   vL2P2_r080 := #GDS0(L2P2_r080);   #_SetFldGV(aL2P2_r080, L2P2_r080);
        L2P2_r130 := L2P2_z010 + L2P2_z020 + L2P2_z040 + L2P2_z059 + L2P2_z060 + L2P2_z061 + L2P2_z070 + L2P2_z072 + L2P2_r080 + L2P2_z090 + L2P2_z100 + L2P2_z110 + L2P2_z120;   vL2P2_r130 := #GDS0(L2P2_r130);   #_SetFldGV(aL2P2_r130, L2P2_r130);

        mL2P2_r080 := 'Стр. 080 = стр. 350 Прил. 3 Листа 02';
        mL2P2_r130 := 'Стр. 130 = стр. 010 + стр. 020 + стр. 040 + стр. 059 + стр. 060 + стр. 061 + стр. 070 + стр. 072 + стр. 080 + стр. 090 + стр. 100 + стр. 110 + стр. 120';

        vL2P2_r080 := vL2P2_r080+' = '+#GDS0(L2P3_r350);
        vL2P2_r130 := vL2P2_r130+' = '+#GDS0(L2P2_z010)+' + '+#GDS0(L2P2_z020)+' + '+#GDS0(L2P2_z040)+' + '+#GDS0(L2P2_z059)+' + '+#GDS0(L2P2_z060)+' + '+#GDS0(L2P2_z061)+' + '+#GDS0(L2P2_z070)+' + '+
                                       #GDS0(L2P2_z072)+' + '+#GDS0(L2P2_r080)+' + '+#GDS0(L2P2_z090)+' + '+#GDS0(L2P2_z100)+' + '+#GDS0(L2P2_z110)+' + '+#GDS0(L2P2_z120);

        NameStr := pFH.Func('myGetPage_L2P2_2', i+1);
        #_Log(aL2P2_r080, mL2P2_r080, vL2P2_r080);
        #_Log(aL2P2_r130, mL2P2_r130, vL2P2_r130);
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 2
      //----------------------------------------------------------------------------------------------------------


      //----------------------------------------------------------------------------------------------------------
      //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 6Б
      //----------------------------------------------------------------------------------------------------------
      for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'); j++)
      {
        NameStr := pFH.Func('myGetPage_L2P6b', i+1, (j div 2) + 1);

        aL2P6b_r070 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ПрибУчГруп' ;
        aL2P6b_z020 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ДохУчГруп'  ;   L2P6b_z020 := GetDblVal(aL2P6b_z020);
        aL2P6b_z021 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ВнеРеалДох' ;   L2P6b_z021 := GetDblVal(aL2P6b_z021);
        aL2P6b_z030 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/РасхУмДох'  ;   L2P6b_z030 := GetDblVal(aL2P6b_z030);
        aL2P6b_z031 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ВнеРеалРасх';   L2P6b_z031 := GetDblVal(aL2P6b_z031);
        aL2P6b_z040 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/УбытОпер302';   L2P6b_z040 := GetDblVal(aL2P6b_z040);
        aL2P6b_z050 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ДохИсклПриб';   L2P6b_z050 := GetDblVal(aL2P6b_z050);
        aL2P6b_z060 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРасхУчГрупНБ/ДохРасхУчГруп'+getIter(j)+'/ПрибОперЦБ' ;   L2P6b_z060 := GetDblVal(aL2P6b_z060);

        L2P6b_r070 := L2P6b_z020 + L2P6b_z021 - L2P6b_z030 - L2P6b_z031 + L2P6b_z040 - L2P6b_z050 + L2P6b_z060;
        vL2P6b_r070 := #GDS0(L2P6b_r070)+' = '+#GDS0(L2P6b_z020)+' + '+#GDS0(L2P6b_z021)+' - '+#GDS0(L2P6b_z030)+' - '+#GDS0(L2P6b_z031)+' + '+#GDS0(L2P6b_z040)+' - '+#GDS0(L2P6b_z050)+' + '+#GDS0(L2P6b_z060);
        #_SetFld(aL2P6b_r070, L2P6b_r070);

        mL2P6b_r070 := 'Стр. 070 ('+String((j mod 2) + 1)+') = стр. 020 + стр. 021 - стр. 030 - стр. 031 + стр. 040 - стр. 050 + стр. 060';
        #_LogC(aL2P6b_r070, mL2P6b_r070, vL2P6b_r070, if (i=0, -1, 1));
      }
      //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 6Б
      //----------------------------------------------------------------------------------------------------------


      {
        aL2_r010 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохРеал'      ;
        aL2_r020 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохВнереал'   ;
        aL2_r030 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхУмРеал'   ;
        aL2_r040 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасхВнереал'  ;
        aL2_r050 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/Убытки'       ;
        aL2_r060 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ПрибУб'       ;
        aL2_r100 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБаза'      ;
        aL2_r110 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУмНБ'     ;
        aL2_r120 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБазаИсч'   ;
        aL2_r140 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалВсего' ;
        aL2_r180 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчисл'    ;
        aL2_r190 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислФБ'  ;
        aL2_r200 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалИсчислСуб' ;
        aL2_r210 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачисл'     ;
        aL2_r270 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалДоплФБ'    ;
        aL2_r271 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалДоплСуб'   ;
        aL2_r280 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалУменФБ'    ;
        aL2_r281 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалУменСуб'   ;
        aL2_r290 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМес'    ;
        aL2_r300 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесФБ'  ;
        aL2_r310 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвПлатМесСуб' ;
        aL2_z070 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ДохИсклПриб'  ;   L2_z070 := GetDblVal(aL2_z070);
        aL2_z080 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ПрибБРСт0'    ;   L2_z080 := GetDblVal(aL2_z080);
        aL2_z090 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СумЛьгот'     ;   L2_z090 := GetDblVal(aL2_z090);
        aL2_z130 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалБазаИсчСуб';   L2_z130 := GetDblVal(aL2_z130);
        aL2_z150 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалФБ'    ;   L2_z150 := GetDblVal(aL2_z150);
        aL2_z160 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалСуб'   ;   L2_z160 := GetDblVal(aL2_z160);
        aL2_z170 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/СтавНалСуб284';   L2_z170 := GetDblVal(aL2_z170);
        aL2_r220 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислФБ'   ;   L2_r220 := GetDblVal(aL2_r220);
        aL2_r230 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/АвНачислСуб'  ;   L2_r230 := GetDblVal(aL2_r230);
        aL2_z250 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311ФБ' ;   L2_z250 := GetDblVal(aL2_z250);
        aL2_z260 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/НалВыпл311Суб';   L2_z260 := GetDblVal(aL2_z260);
        aL2_zTip := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/ТипНП'        ;   L2_zTip := GetStrVal(aL2_zTip);

        L2_r010 := L2P1_r040                                      ;   vL2_r010 := #GDS0(L2_r010);    #_SetFldGV(aL2_r010, L2_r010);
        L2_r020 := L2P1_z100                                      ;   vL2_r020 := #GDS0(L2_r020);    #_SetFldGV(aL2_r020, L2_r020);
        L2_r030 := L2P2_r130                                      ;   vL2_r030 := #GDS0(L2_r030);    #_SetFldGV(aL2_r030, L2_r030);
        L2_r040 := L2P2_z200 + L2P2_z300                          ;   vL2_r040 := #GDS0(L2_r040);    #_SetFldGV(aL2_r040, L2_r040);
        L2_r050 := L2P3_r360                                      ;   vL2_r050 := #GDS0(L2_r050);    #_SetFldGV(aL2_r050, L2_r050);
        L2_r060 := L2_r010 + L2_r020 - L2_r030 - L2_r040 + L2_r050;   vL2_r060 := #GDS0(L2_r060);    #_SetFldGV(aL2_r060, L2_r060);

        if fl_L5_2_r100
        {
          L2_r100 := L2_r060 - L2_z070 - L2_z080 - L2_z090 - L2P2_z400 + L5_2_r100 + L6_r530;
          mL2_r100 := 'Стр. 100 = стр. 060 - стр. 070 - стр. 080 - стр. 090 - стр. 400 Прил. 2 Листа 02 + стр. 100 Листа 05 (версия 2) + стр. 530 Листа 06';
          vL2_r100 := #GDS0(L2_r100)+' = '+#GDS0(L2_r060)+' - '+#GDS0(L2_z070)+' - '+#GDS0(L2_z080)+' - '+#GDS0(L2_z090)+' - '+#GDS0(L2P2_z400)+' + '+#GDS0(L5_2_r100)+' + '+#GDS0(L6_r530);
        }
        else
        {
          if fl_L5_1_r100
          {
            L2_r100 := L2_r060 - L2_z070 - L2_z080 - L2_z090 - L2P2_z400 + L5_1_r100 + L6_r530;
            mL2_r100 := 'Стр. 100 = стр. 060 - стр. 070 - стр. 080 - стр. 090 - стр. 400 Прил. 2 Листа 02 + стр. 100 Листа 05 (версия 1) + стр. 530 Листа 06';
            vL2_r100 := #GDS0(L2_r100)+' = '+#GDS0(L2_r060)+' - '+#GDS0(L2_z070)+' - '+#GDS0(L2_z080)+' - '+#GDS0(L2_z090)+' - '+#GDS0(L2P2_z400)+' + '+#GDS0(L5_1_r100)+' + '+#GDS0(L6_r530);
          }
          else
          {
            L2_r100 := L2_r060 - L2_z070 - L2_z080 - L2_z090 - L2P2_z400 + L6_r530;
            mL2_r100 := 'Стр. 100 = стр.  060 - стр. 070 - стр. 080 - стр. 090 - стр. 400 Прил. 2 Листа 02 + стр. 530 Листа 06';
            vL2_r100 := #GDS0(L2_r100)+' = '+#GDS0(L2_r060)+' - '+#GDS0(L2_z070)+' - '+#GDS0(L2_z080)+' - '+#GDS0(L2_z090)+' - '+#GDS0(L2P2_z400)+' + '+#GDS0(L6_r530);
          }
        }

        #_SetFldGV(aL2_r100, L2_r100);

        fl_L2P4_z150 := False;

        //----------------------------------------------------------------------------------------------------------
        //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 4
        //----------------------------------------------------------------------------------------------------------
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'); j++)
          if not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ТипНП')
          {
            aL2P4_r140 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/НалБаза'        ;
            aL2P4_r160 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонВс'   ;
            aL2P4_r161 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытКонЗС'   ;
            aL2P4_z010 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытНачВс'   ;   L2P4_z010 := GetDblVal(aL2P4_z010);
            aL2P4_z135 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытЗавСд'   ;   L2P4_z135 := GetDblVal(aL2P4_z135);
            aL2P4_z136 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ОстУбытЗавСдНач';   L2P4_z136 := GetDblVal(aL2P4_z136);
            aL2P4_z150 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБаза'  ;   L2P4_z150 := GetDblVal(aL2P4_z150);
            aL2P4_z151 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/УбытУмНалБазаЗС';   L2P4_z151 := GetDblVal(aL2P4_z151);

            NameStr := pFH.Func('myGetPage_L2P4', i+1, j+1);

            L2P4_r140 := L2_r100;
            mL2P4_r140 := 'Стр. 140 = стр. 100 Листа 02';
            vL2P4_r140 := #GDS0(L2P4_r140)+' = '+#GDS0(L2_r100);
            #_Log(aL2P4_r140, mL2P4_r140, vL2P4_r140);
            #_SetFld(aL2P4_r140, L2P4_r140);

            if _NalPer_God
            {
              L2P4_r160 := (L2P4_z010 + L2P4_z136) - L2P4_z150;   #_SetFld(aL2P4_r160, L2P4_r160);
              L2P4_r161 := L2P4_z136 - L2P4_z151              ;   #_SetFld(aL2P4_r161, L2P4_r161);

              mL2P4_r160 := 'Стр. 160 = (стр. 010 + стр. 136) - стр. 150';
              mL2P4_r161 := 'Стр. 161 = стр. 136 - стр. 151'             ;

              vL2P4_r160 := #GDS0(L2P4_r160)+' = ('+#GDS0(L2P4_z010)+' + '+#GDS0(L2P4_z136)+') - '+#GDS0(L2P4_z150);
              vL2P4_r161 := #GDS0(L2P4_r161)+' = '+#GDS0(L2P4_z136)+' - '+#GDS0(L2P4_z151)                         ;

              #_Log(aL2P4_r160, mL2P4_r160, vL2P4_r160);
              #_Log(aL2P4_r161, mL2P4_r161, vL2P4_r161);
            }
            else
            {
              #SetSNull(aL2P4_r160, L2P4_r160);
              #SetSNull(aL2P4_r161, L2P4_r161);
            }

            if _TipNP('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/УбытУменНБ'+getIter(j)+'/ТипНП')
            {
              fl_L2P4_z150 := True;
              bufL2P4_z150 := bufL2P4_z150 + L2P4_z150;
              vL2_r110 := vL2_r110+#GDS0(L2P4_z150)+' + ';
            }
          }
        //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 4
        //----------------------------------------------------------------------------------------------------------

        if fl_L2P4_z150 and (_NalPer_God or _NalPer_1kv)
        {
          L2_r110 := bufL2P4_z150;
          mL2_r110 := 'Стр. 110 = сумма стр. 150 Прил. 4 Листа 02';
          vL2_r110 := #GDS0(L2_r110)+' = ('+SubStr(vL2_r110, 1, Length(vL2_r110) - 3)+')';

          #_SetFldGV(aL2_r110, L2_r110);
        }
        else
        {
          L2_r110 := 0;
          mL2_r110 := 'Cтр. 110 = 0 (нулю) (не выполнены условия; прис. Прил. 4 с Типом налогоплат. = 1, 3 или 4 и Период = Год или 1й квартал)';
          vL2_r110 := #GDS0(L2_r110)+' = 0';
          #SetSNull(aL2_r110, L2_r110);
        }

        if (L2_r100 < 0)
        {
          L2_r120 := 0;
          mL2_r120 := 'Cтр. 120 = 0 (нулю) (не выполнены условия; стр. 100 < 0';
          vL2_r120 := #GDS0(L2_r120)+' = 0';
        }
        else
        {
          L2_r120 := L2_r100 - L2_r110;
          mL2_r120 := 'Cтр. 120 = стр. 100 - стр. 110';
          vL2_r120 := #GDS0(L2_r120)+' = '+#GDS0(L2_r100)+' - '+#GDS0(L2_r110);
        }

        #_SetFldGV(aL2_r120, L2_r120);

        if L2_r120 > 0
        {
          L2_r190 := L2_r120 * L2_z150 / 100                                        ;
          L2_r200 := (L2_r120 - L2_z130) * L2_z160 / 100 + (L2_z130 * L2_z170 / 100);

          mL2_r190 := 'Стр. 190 = стр. 120 * стр. 150 / 100'                                           ;
          mL2_r200 := 'Стр. 200 = (стр. 120 - стр. 130) * стр. 160 / 100 + (стр. 130 * стр. 170 / 100)';

          vL2_r190 := #GDS0(L2_r190)+' = '+#GDS0(L2_r120)+' * '+#GDS2(L2_z150)+' / 100'                                                                        ;
          vL2_r200 := #GDS0(L2_r200)+' = ('+#GDS0(L2_r120)+' - '+#GDS0(L2_z130)+') * '+#GDS2(L2_z160)+' / 100 + ('+#GDS0(L2_z130)+' * '+#GDS2(L2_z170)+' / 100)';
        }
        else
        {
          L2_r190 := 0;
          L2_r200 := (-1 * L2_z130) * L2_z160 / 100 + (L2_z130 * L2_z170 / 100);

          mL2_r190 := 'Стр. 190 := 0'                                                             ;
          mL2_r200 := 'Стр. 200 := (-1 * стр. 130) * стр. 160 / 100 + (стр. 130 * стр. 170 / 100)';

          vL2_r190 := #GDS0(L2_r190)+' = 0'                                                                                                     ;
          vL2_r200 := #GDS0(L2_r200)+' = (-1 * '+#GDS0(L2_z130)+') * '+#GDS2(L2_z160)+' / 100 + ('+#GDS0(L2_z130)+' * '+#GDS2(L2_z170)+' / 100)';
        }

        #_SetFldGV(aL2_r190, L2_r190);
        #_SetFldGV(aL2_r200, L2_r200);


        L2_r140 := L2_z150 + L2_z160;   #_SetFld(aL2_r140, L2_r140);
        L2_r180 := L2_r190 + L2_r200;   #_SetFld(aL2_r180, L2_r180);


        //==============================================================================
        //#region РАСЧЕТ ПОКАЗАТЕЛЕЙ 290-310 С УЧЕТОМ ДАННЫХ ПРЕДЫДУЩЕГО ПЕРИОДА
        //------------------------------------------------------------------------------
        if flPath
        {
          var aL2_180p, aL2_190p, aL2_200p, aL2_250p, aL2_260p, aL2_300p, aL2_310p : string = '';
          var  L2_180p,  L2_190p,  L2_200p,  L2_250p,  L2_260p,  L2_300p,  L2_310p : double = 0.0;

          for (j := 0; j < tmpXMLMap.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'); j++)
          {
            if (L2_zTip <> tmpXMLMap.GetAttrValueByName('Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/ТипНП')) continue;

            aL2_180p := 'Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/НалИсчисл'    ;   L2_180p := Double(tmpXMLMap.GetAttrValueByName(aL2_180p));
            aL2_190p := 'Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/НалИсчислФБ'  ;   L2_190p := Double(tmpXMLMap.GetAttrValueByName(aL2_190p));
            aL2_200p := 'Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/НалИсчислСуб' ;   L2_200p := Double(tmpXMLMap.GetAttrValueByName(aL2_200p));
            aL2_300p := 'Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/АвПлатМесФБ'  ;   L2_300p := Double(tmpXMLMap.GetAttrValueByName(aL2_300p));
            aL2_310p := 'Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/АвПлатМесСуб' ;   L2_310p := Double(tmpXMLMap.GetAttrValueByName(aL2_310p));
            aL2_250p := 'Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/НалВыпл311ФБ' ;   L2_250p := Double(tmpXMLMap.GetAttrValueByName(aL2_250p));
            aL2_260p := 'Файл/Документ/Прибыль/РасчНал'+getIter(j)+'/НалВыпл311Суб';   L2_260p := Double(tmpXMLMap.GetAttrValueByName(aL2_260p));

            break;
          }


          //------------------------------------------------------------------------------
          //#region СТРОКИ 290-310
          //------------------------------------------------------------------------------
          L2_r290 := L2_r180 - L2_180p;
          L2_r300 := L2_r190 - L2_190p;
          L2_r310 := L2_r200 - L2_200p;

          mL2_r290 := 'Стр. 290 = стр. 180 - стр. 180 (предыдущего периода)';   vL2_r290 := #GDS0(L2_r290)+' = '+#GDS0(L2_r180)+' - '+#GDS0(L2_180p);
          mL2_r300 := 'Стр. 300 = стр. 190 - стр. 190 (предыдущего периода)';   vL2_r300 := #GDS0(L2_r300)+' = '+#GDS0(L2_r190)+' - '+#GDS0(L2_190p);
          mL2_r310 := 'Стр. 310 = стр. 200 - стр. 200 (предыдущего периода)';   vL2_r310 := #GDS0(L2_r310)+' = '+#GDS0(L2_r200)+' - '+#GDS0(L2_200p);

          if (L2_r290 > 0) { #_SetFldGV(aL2_r290, L2_r290); } else { #SetSNull(aL2_r290, L2_r290); vL2_r290 := 'Значение не установлено, т.к. результат <= 0 (нуля) (' + vL2_r290 + ')'; }
          if (L2_r300 > 0) { #_SetFldGV(aL2_r300, L2_r300); } else { #SetSNull(aL2_r300, L2_r300); vL2_r300 := 'Значение не установлено, т.к. результат <= 0 (нуля) (' + vL2_r300 + ')'; }
          if (L2_r310 > 0) { #_SetFldGV(aL2_r310, L2_r310); } else { #SetSNull(aL2_r310, L2_r310); vL2_r310 := 'Значение не установлено, т.к. результат <= 0 (нуля) (' + vL2_r310 + ')'; }
          //#endregion СТРОКИ 290-310
          //------------------------------------------------------------------------------


          //------------------------------------------------------------------------------
          //#region СТРОКИ 210-230
          //------------------------------------------------------------------------------
          XMLMAP.SetFormulaValueByName(aL2_r220,'');
          XMLMAP.SetFormulaValueByName(aL2_r230,'');

          L2_r220 := L2_190p + L2_300p - L2_250p;   #_SetFldGV(aL2_r220, L2_r220);
          L2_r230 := L2_200p + L2_310p - L2_260p;   #_SetFldGV(aL2_r230, L2_r230);

          mL2_r220 := 'Стр. 220 = стр. предыдущего периода (190 + 300 - 250)';   vL2_r220 := #GDS0(L2_r220)+' = '+#GDS0(L2_190p)+' + '+#GDS0(L2_300p)+' - '+#GDS0(L2_250p);
          mL2_r230 := 'Стр. 230 = стр. предыдущего периода (200 + 310 - 260)';   vL2_r230 := #GDS0(L2_r230)+' = '+#GDS0(L2_200p)+' + '+#GDS0(L2_310p)+' - '+#GDS0(L2_260p);
          //#endregion СТРОКИ 290-310
          //------------------------------------------------------------------------------


          NameStr := pFH.Func('myGetPage_L2_2', i+1);
          #_Log(aL2_r220, mL2_r220, vL2_r220);
          #_Log(aL2_r230, mL2_r230, vL2_r230);
          #_Log(aL2_r290, mL2_r290, vL2_r290);
          #_Log(aL2_r300, mL2_r300, vL2_r300);
          #_Log(aL2_r310, mL2_r310, vL2_r310);
        }
        else
        {
          L2_r290 := GetDblVal(aL2_r290);
          L2_r300 := GetDblVal(aL2_r300);
          L2_r310 := GetDblVal(aL2_r310);

          if (XMLMAP.GetFormulaValueByName(aL2_r220) = '') { XMLMAP.SetFormulaValueByName(aL2_r220, '&Prib_List02_220');   L2_r220 := GetPatVal('&Prib_List02_220');   #_SetFldGV(aL2_r220, L2_r220); }
          if (XMLMAP.GetFormulaValueByName(aL2_r230) = '') { XMLMAP.SetFormulaValueByName(aL2_r230, '&Prib_List02_230');   L2_r230 := GetPatVal('&Prib_List02_230');   #_SetFldGV(aL2_r230, L2_r230); }
        }
        //#endregion РАСЧЕТ ПОКАЗАТЕЛЕЙ 290-310 С УЧЕТОМ ДАННЫХ ПРЕДЫДУЩЕГО ПЕРИОДА
        //******************************************************************************


        L2_r210 := L2_r220 + L2_r230;   #_SetFld(aL2_r210, L2_r210);


        //==========================================================================================================
        //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 6
        //----------------------------------------------------------------------------------------------------------
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'); j++)
        {
          aL2P6_r040     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/ДоляНалБаз'    ;
          aL2P6_r050     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаДоля'   ;
          aL2P6_r051     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалБазаДоляСтН';
          aL2P6_r070     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/СумНал'        ;
          aL2P6_r100_110 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/СумНалП'       ;
          aL2P6_r120     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/МесАвПлат'     ;
          aL2P6_rKolPril := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/КолПрил'       ;
          aL2P6_z080     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалНачислСубРФ';   L2P6_z080 := GetDblVal(aL2P6_z080);
          aL2P6_z090     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/НалВыплВнеРФ'  ;   L2P6_z090 := GetDblVal(aL2P6_z090);

          bufL2P6a_z040    := 0;   vL2P6_r040 := '';
          bufL2P6a_r050    := 0;   vL2P6_r050 := '';
          bufL2P6a_z051    := 0;   vL2P6_r051 := '';
          bufL2P6a_r070    := 0;   vL2P6_r070 := '';
          bufL2P6_rKolPril := 0;

          //----------------------------------------------------------------------------------------------------------
          //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 6A
          //----------------------------------------------------------------------------------------------------------
          for (k := 0; k < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'); k++)
          {
            if     not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ИННЮЛ'      )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/КПП'        )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ОКТМО'      )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НаимУч'     )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ОбРасч'     )
               and not GetStrNull('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаГр'  )
            {
              bufL2P6_rKolPril := bufL2P6_rKolPril + 1;

              aL2P6a_r050 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаДоля'  ;
              aL2P6a_r070 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СумНал'       ;
              aL2P6a_z030 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаГр'    ;   L2P6a_z030 := GetDblVal(aL2P6a_z030);
              aL2P6a_z040 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/ДоляНалБаз'   ;   L2P6a_z040 := GetDblVal(aL2P6a_z040);
              aL2P6a_z051 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/НалБазаДоляСн';   L2P6a_z051 := GetDblVal(aL2P6a_z051);
              aL2P6a_z060 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РасчНалГруп'+getIter(j)+'/РасчНалУчГруп'+getIter(k)+'/СтавНалСубРФ' ;   L2P6a_z060 := GetDblVal(aL2P6a_z060);

              L2P6a_r050 := L2P6a_z030 * (L2P6a_z040 / 100);                                        ;   vL2P6a_r050 := #GDS0(L2P6a_r050);   #_SetFldGV(aL2P6a_r050, L2P6a_r050);
              L2P6a_r070 := ((L2P6a_r050 - L2P6a_z051) * 18 / 100) + (L2P6a_z051 * L2P6a_z060 / 100);   vL2P6a_r070 := #GDS0(L2P6a_r070);   #_SetFldGV(aL2P6a_r070, L2P6a_r070);

              bufL2P6a_z040 := bufL2P6a_z040 + L2P6a_z040;
              bufL2P6a_r050 := bufL2P6a_r050 + L2P6a_r050;
              bufL2P6a_z051 := bufL2P6a_z051 + L2P6a_z051;
              bufL2P6a_r070 := bufL2P6a_r070 + L2P6a_r070;



              mL2P6a_r050 := 'Стр. 050 = стр. 030 * (стр. 040 / 100)'                                     ;
              mL2P6a_r070 := 'Стр. 070 = ((стр. 050 - стр. 051) * 18 / 100) + (стр. 051 * стр. 060 / 100)';

              vL2P6a_r050    := vL2P6a_r050+' = '+#GDS0(L2P6a_z030)+' * ('+#GDS11(L2P6a_z040)+' / 100)'                                                               ;
              vL2P6a_r070    := vL2P6a_r070+' = (('+#GDS0(L2P6a_r050)+' - '+#GDS0(L2P6a_z051)+') * 18 / 100) + ('+#GDS0(L2P6a_z051)+' * '+#GDS11(L2P6a_z060)+' / 100)';

              NameStr := pFH.Func('myGetPage_L2P6a', i+1, j+1, k+1);
              #_Log(aL2P6a_r050, mL2P6a_r050, vL2P6a_r050);
              #_Log(aL2P6a_r070, mL2P6a_r070, vL2P6a_r070);

              vL2P6_r040 := vL2P6_r040+#GDS11(L2P6a_z040)+' + ';
              vL2P6_r050 := vL2P6_r050+#GDS0 (L2P6a_r050)+' + ';
              vL2P6_r051 := vL2P6_r051+#GDS0 (L2P6a_z051)+' + ';
              vL2P6_r070 := vL2P6_r070+#GDS0 (L2P6a_r070)+' + ';
            }
          }
          //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 6A
          //----------------------------------------------------------------------------------------------------------

          L2P6_rKolPril := bufL2P6_rKolPril;                                                                                               #_SetFld  (aL2P6_rKolPril, L2P6_rKolPril);
          L2P6_r040     := bufL2P6a_z040   ;   vL2P6_r040 := #GDS11(L2P6_r040)+' = ('+SubStr(vL2P6_r040, 1, Length(vL2P6_r040) - 3)+')';   #_SetFldGV(aL2P6_r040    , L2P6_r040    );
          L2P6_r050     := bufL2P6a_r050   ;                                                                                               #_SetFld  (aL2P6_r050    , L2P6_r050    );
          L2P6_r051     := bufL2P6a_z051   ;                                                                                               #_SetFld  (aL2P6_r051    , L2P6_r051    );
          L2P6_r070     := bufL2P6a_r070   ;   vL2P6_r070 := #GDS0(L2P6_r070 )+' = ('+SubStr(vL2P6_r070, 1, Length(vL2P6_r070) - 3)+')';   #_SetFldGV(aL2P6_r070    , L2P6_r070    );

          L2P6_r100_110 := L2P6_r070 - L2P6_z080 - L2P6_z090;

          #_SetFld(aL2P6_r100_110, L2P6_r100_110);

          NameStr := pFH.Func('myGetPage_L2P6', i+1, j+1);

          if not _NalPer_God
          {
            L2P6_r120 := L2_r310 * L2P6_r040 / 100;
            mL2P6_r120 := 'Стр. 120 = стр. 310 Листа 02 * стр. 040 / 100';
            vL2P6_r120 := #GDS0(L2P6_r120)+' = '+#GDS0(L2_r310)+' * '+#GDS0(L2P6_r040)+' / 100';
            #_Log(aL2P6_r120, mL2P6_r120, vL2P6_r120);
            #_SetFld(aL2P6_r120, L2P6_r120);
          }
          else { #SetSNull(aL2P6_r120, L2P6_r120); }

          vL2P6_rKolPril := #GDS0(bufL2P6_rKolPril)+' = '+#GDS0(bufL2P6_rKolPril)                                    ;
          vL2P6_r050     := #GDS0(L2P6_r050)+' = ('+SubStr(vL2P6_r050, 1, Length(vL2P6_r050) - 3)+')'                ;
          vL2P6_r051     := #GDS0(L2P6_r051)+' = ('+SubStr(vL2P6_r051, 1, Length(vL2P6_r051) - 3)+')'                ;
          vL2P6_r100_110 := #GDS0(L2P6_r100_110)+' = '+#GDS0(L2P6_r070)+' - '+#GDS0(L2P6_z080)+' - '+#GDS0(L2P6_z090);

          mL2P6_rKolPril := 'Кол. приложений = количество вложеных разделов 6а';
          mL2P6_r040     := 'Стр. 040 = сумма стр. 040 Прил. 6a Листа 02'      ;
          mL2P6_r050     := 'Стр. 050 = сумма стр. 050 Прил. 6a Листа 02'      ;
          mL2P6_r051     := 'Стр. 051 = сумма стр. 051 Прил. 6a Листа 02'      ;
          mL2P6_r070     := 'Стр. 070 = сумма стр. 070 Прил. 6a Листа 02'      ;
          mL2P6_r100_110 := 'Стр. 100/110 = стр. 070 - стр. 080 - стр. 090'    ;

          #_Log(aL2P6_rKolPril, mL2P6_rKolPril, vL2P6_rKolPril);
          #_Log(aL2P6_r040    , mL2P6_r040    , vL2P6_r040    );
          #_Log(aL2P6_r050    , mL2P6_r050    , vL2P6_r050    );
          #_Log(aL2P6_r051    , mL2P6_r051    , vL2P6_r051    );
          #_Log(aL2P6_r070    , mL2P6_r070    , vL2P6_r070    );
          #_Log(aL2P6_r100_110, mL2P6_r100_110, vL2P6_r100_110);
        }
        //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 6
        //**********************************************************************************************************


        //----------------------------------------------------------------------------------------------------------
        //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 1
        //----------------------------------------------------------------------------------------------------------
        for (j := 0; j < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'); j++)
        {
          var aL2P5_TipNP, aL2P5_ObRasch, aL2P5_Naim, aL2P5_KPP, aL2P5_ObyzUpl
            , zL2P5_TipNP, zL2P5_ObRasch, zL2P5_Naim, zL2P5_KPP, zL2P5_ObyzUpl : string = '';

          aL2P5_TipNP   := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ТипНП'       ;
          aL2P5_ObRasch := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ОбРасч'      ;
          aL2P5_Naim    := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НаимОП'      ;
          aL2P5_KPP     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/КППОП'       ;
          aL2P5_ObyzUpl := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ОбязУплНалОП';

          if      not GetStrNull(aL2P5_TipNP  )
              and not GetStrNull(aL2P5_ObRasch)
              and not GetStrNull(aL2P5_Naim   )
              and not GetStrNull(aL2P5_KPP    )
              and not GetStrNull(aL2P5_ObyzUpl)
          {
            NameStr := pFH.Func('myGetPage_L2P5v1', i+1, j+1);

            aL2P5_r030     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаОрг'    ;
            aL2P5_r050     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалБазаДоля'   ;
            aL2P5_r070     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНал'        ;
            aL2P5_r100_110 := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СумНалП'       ;
            aL2P5_r120     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/МесАвПлат'     ;
            aL2P5_z080     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалНачислСубРФ';
            aL2P5_z040     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ДоляНалБаз'    ;   L2P5_z040  := GetDblVal(aL2P5_z040);
            aL2P5_z060     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/СтавНалСубРФ'  ;   L2P5_z060  := GetDblVal(aL2P5_z060);
            aL2P5_z090     := 'Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/НалВыплВнеРФ'  ;   L2P5_z090  := GetDblVal(aL2P5_z090);

            zL2P5_TipNP   := GetStrVal(aL2P5_TipNP  );
            zL2P5_ObRasch := GetStrVal(aL2P5_ObRasch);
            zL2P5_Naim    := GetStrVal(aL2P5_Naim   );
            zL2P5_KPP     := GetStrVal(aL2P5_KPP    );
            zL2P5_ObyzUpl := GetStrVal(aL2P5_ObyzUpl);


            //==============================================================================
            //#region РАСЧЕТ ПОКАЗАТЕЛЯ 080 С УЧЕТОМ ДАННЫХ ПРЕДЫДУЩЕГО ПЕРИОДА
            //------------------------------------------------------------------------------
            if flPath
            {
              var aL2P5_old_TipNP, aL2P5_old_ObRasch, aL2P5_old_Naim, aL2P5_old_KPP, aL2P5_old_ObyzUpl : string = '';
              var zL2P5_old_070, zL2P5_old_120 : double = 0;

              bufRes := 0;
              vRes := '';

              CountK := tmpXMLMap.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал');
              for (k := 0; k < CountK; k++)
              {
                if (L2_zTip <> tmpXMLMap.GetAttrValueByName('Файл/Документ/Прибыль/РасчНал'+getIter(k)+'/ТипНП')) continue;

                CountN := tmpXMLMap.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал'+getIter(k)+'/РаспрНалСубРФ');
                for (n := 0; n < CountN; n++)
                {
                  bufXMLAd := 'Файл/Документ/Прибыль/РасчНал'+getIter(k)+'/РаспрНалСубРФ'+getIter(n);

                  aL2P5_old_TipNP   := bufXMLAd + '/ТипНП'       ;
                  aL2P5_old_ObRasch := bufXMLAd + '/ОбРасч'      ;
                  aL2P5_old_Naim    := bufXMLAd + '/НаимОП'      ;
                  aL2P5_old_KPP     := bufXMLAd + '/КППОП'       ;
                  aL2P5_old_ObyzUpl := bufXMLAd + '/ОбязУплНалОП';

                  if     (zL2P5_TipNP   = String(tmpXMLMap.GetAttrValueByName(aL2P5_old_TipNP  )))
                     and (zL2P5_ObRasch = String(tmpXMLMap.GetAttrValueByName(aL2P5_old_ObRasch)))
                     and (zL2P5_Naim    = String(tmpXMLMap.GetAttrValueByName(aL2P5_old_Naim   )))
                     and (zL2P5_KPP     = String(tmpXMLMap.GetAttrValueByName(aL2P5_old_KPP    )))
                     and (zL2P5_ObyzUpl = String(tmpXMLMap.GetAttrValueByName(aL2P5_old_ObyzUpl)))
                  {
                    zL2P5_old_070 := Double(tmpXMLMap.GetAttrValueByName(bufXMLAd + '/СумНал'   ));
                    zL2P5_old_120 := Double(tmpXMLMap.GetAttrValueByName(bufXMLAd + '/МесАвПлат'));

                    bufRes := zL2P5_old_070 + zL2P5_old_120;
                    vRes := #GDS0(zL2P5_old_070)+' + '+#GDS0(zL2P5_old_120);

                    break;
                  }
                }
              }

              vRes := if (vRes <> '', #GDS0(bufRes)+' = '+vRes, '0 = 0 + 0 (нет данных для расчета)');

              #_SetFldGV(aL2P5_z080, bufRes);
              #_Log     (aL2P5_z080, 'Стр. 080 = стр. предыдущего периода (070 + 120)', vRes);
            }
            //#endregion РАСЧЕТ ПОКАЗАТЕЛЯ 080 С УЧЕТОМ ДАННЫХ ПРЕДЫДУЩЕГО ПЕРИОДА
            //==============================================================================


            L2P5_z080 := GetDblVal(aL2P5_z080);

            L2P5_r030  := L2_r120                              ;   #_SetFldGV(aL2P5_r030, L2P5_r030);
            mL2P5_r030 := 'Стр. 030 = стр. 120 Листа 02'       ;
            vL2P5_r030 := #GDS0(L2P5_r030)+' = '+#GDS0(L2_r120);

            L2P5_r050     := L2P5_r030 * (L2P5_z040 / 100)    ;   #_SetFldGV(aL2P5_r050    , L2P5_r050    );
            L2P5_r070     := L2P5_r050 * (L2P5_z060 / 100)    ;   #_SetFldGV(aL2P5_r070    , L2P5_r070    );
            L2P5_r100_110 := L2P5_r070 - L2P5_z080 - L2P5_z090;   #_SetFld  (aL2P5_r100_110, L2P5_r100_110);

            mL2P5_r050     := 'Стр. 050 = стр. 030 * (стр. 040 / 100)'       ;
            mL2P5_r070     := 'Стр. 070 = стр. 050 * (стр. 060 / 100)'       ;
            mL2P5_r100_110 := 'Стр. 100/110 = стр. 070 - стр. 080 - стр. 090';

            vL2P5_r050     := #GDS0(L2P5_r050)+' = '+#GDS0(L2P5_r030)+' * ('+#GDS11(L2P5_z040)+' / 100)'               ;
            vL2P5_r070     := #GDS0(L2P5_r070)+' = '+#GDS0(L2P5_r050)+' * ('+#GDS2(L2P5_z060)+' / 100)'                ;
            vL2P5_r100_110 := #GDS0(L2P5_r100_110)+' = '+#GDS0(L2P5_r070)+' - '+#GDS0(L2P5_z080)+' - '+#GDS0(L2P5_z090);

            #_Log(aL2P5_r030    , mL2P5_r030    , vL2P5_r030    );
            #_Log(aL2P5_r050    , mL2P5_r050    , vL2P5_r050    );
            #_Log(aL2P5_r070    , mL2P5_r070    , vL2P5_r070    );
            #_Log(aL2P5_r100_110, mL2P5_r100_110, vL2P5_r100_110);

            //Строка 120 не заполняется за налоговый период
            if    _NalPer_God
               or GetStrVal('Файл/Документ/Прибыль/РасчНал'+getIter(i)+'/РаспрНалСубРФ'+getIter(j)+'/ОбРасч') = '3'
            {
              L2P5_r120 := 0;
              mL2P5_r120 := 'Cтр. 120 = 0 (нулю) (за налоговый период не заполняется; не заполняются при Расчёт составлен (код) равном 3)';
              vL2P5_r120 := #GDS0(L2P5_r120)+' = 0';
              #SetSNull(aL2P5_r120, L2P5_r120);
            }
            else
            {
              L2P5_r120  := L2_r310 * L2P5_z040 / 100                                             ;
              mL2P5_r120 := 'Стр. 120 = стр. 310 Листа 02 * стр. 040 / 100'                       ;
              vL2P5_r120 := #GDS0(L2P5_r120)+' = '+#GDS0(L2_r310)+' * '+#GDS11(L2P5_z040)+' / 100';
              #_SetFld(aL2P5_r120, L2P5_r120);
            }
            #_Log(aL2P5_r120, mL2P5_r120, vL2P5_r120);
          }
        }
        //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 1
        //----------------------------------------------------------------------------------------------------------


        if (L2_r190 > L2_r220 + L2_z250)
        {
          L2_r270 := L2_r190 - L2_r220 - L2_z250;
          L2_r280 := 0;

          mL2_r270 := 'Стр. 270 = стр. 190 - стр. 220 - стр. 250';
          mL2_r280 := 'Стр. 280 = 0 (нулю)'                      ;

          vL2_r270 := #GDS0(L2_r270)+' = '+#GDS0(L2_r190)+' - '+#GDS0(L2_r220)+' - '+#GDS0(L2_z250);
          vL2_r280 := #GDS0(L2_r280)+' = 0'                                                        ;

          #_SetFldGV(aL2_r270, L2_r270);
          #SetSNull (aL2_r280, L2_r280);
        }
        else
        {
          L2_r270 := 0;
          L2_r280 := L2_r220 + L2_z250 - L2_r190;

          mL2_r270 := 'Стр. 270 = 0 (нулю)'                      ;
          mL2_r280 := 'Стр. 280 = стр. 220 + стр. 250 - стр. 190';

          vL2_r270 := #GDS0(L2_r270)+' = 0'                                                        ;
          vL2_r280 := #GDS0(L2_r280)+' = '+#GDS0(L2_r220)+' + '+#GDS0(L2_z250)+' - '+#GDS0(L2_r190);

          #_SetFldGV(aL2_r280, L2_r280);
          #SetSNull (aL2_r270, L2_r270);
        }

        if (L2_r200 > L2_r230 + L2_z260)
        {
          L2_r271 := L2_r200 - L2_r230 - L2_z260;
          L2_r281 := 0                          ;

          mL2_r271 := 'Стр. 271 = стр. 200 - стр. 230 - стр. 260';
          mL2_r281 := 'Стр. 281 = 0 (нулю)'                      ;

          vL2_r271 := #GDS0(L2_r271)+' = '+#GDS0(L2_r200)+' - '+#GDS0(L2_r230)+' - '+#GDS0(L2_z260);
          vL2_r281 := #GDS0(L2_r281)+' = 0'                                                        ;

          #_SetFld (aL2_r271, L2_r271);
          #SetSNull(aL2_r281, L2_r281);
        }
        else
        {
          L2_r271 := 0;
          L2_r281 := L2_r230 + L2_z260 - L2_r200;

          mL2_r271 := 'Стр. 271 = 0 (нулю)'                      ;
          mL2_r281 := 'Стр. 281 = стр. 230 + стр. 260 - стр. 200';

          vL2_r271 := #GDS0(L2_r271)+' = 0'                                                        ;
          vL2_r281 := #GDS0(L2_r281)+' = '+#GDS0(L2_r230)+' + '+#GDS0(L2_z260)+' - '+#GDS0(L2_r200);

          #_SetFld (aL2_r281, L2_r281);
          #SetSNull(aL2_r271, L2_r271);
        }

        bufL2_r270_r280 := bufL2_r270_r280 + L2_r270 - L2_r280;
        bufL2_r271_r281 := bufL2_r271_r281 + L2_r271 - L2_r281;
        bufL2_300       := bufL2_300 + L2_r300                ;
        bufL2_310       := bufL2_310 + L2_r310                ;

        vbufL2_r270_r280 := vbufL2_r270_r280+'('+#GDS0(L2_r270)+' - '+#GDS0(L2_r280)+') + ';
        vbufL2_r271_r281 := vbufL2_r271_r281+'('+#GDS0(L2_r271)+' - '+#GDS0(L2_r281)+') + ';
        vbufL2_300       := vbufL2_300 +#GDS0(L2_r300)+' + '                               ;
        vbufL2_310       := vbufL2_310 +#GDS0(L2_r310)+' + '                               ;



        mL2_r010 := 'Стр. 010 = стр. 040 Прил. 1 Листа 02'                            ;
        mL2_r020 := 'Стр. 020 = стр. 100 Прил. 1 Листа 02'                            ;
        mL2_r030 := 'Стр. 030 = стр. 130 Прил. 2 Листа 02'                            ;
        mL2_r040 := 'Стр. 040 = стр. 200 Прил. 2 Листа 02 + стр. 300 Прил. 2 Листа 02';
        mL2_r050 := 'Стр. 050 = стр. 360 Прил. 3 Листа 02'                            ;
        mL2_r060 := 'Стр. 060 = стр. 010 + стр. 020 - 030 - стр. 040 + стр. 050'      ;
        mL2_r140 := 'Стр. 140 = стр. 150 + стр. 160'                                  ;
        mL2_r180 := 'Стр. 180 = стр. 190 + стр. 200'                                  ;
        mL2_r210 := 'Стр. 210 = стр. 220 + стр. 230'                                  ;

        vL2_r010 := vL2_r010+' = '+#GDS0(L2P1_r040)                                                                                  ;
        vL2_r020 := vL2_r020+' = '+#GDS0(L2P1_z100)                                                                                  ;
        vL2_r030 := vL2_r030+' = '+#GDS0(L2P2_r130)                                                                                  ;
        vL2_r040 := vL2_r040+' = '+#GDS0(L2P2_z200)+' + '+#GDS0(L2P2_z300)                                                           ;
        vL2_r050 := vL2_r050+' = '+#GDS0(L2P3_r360)                                                                                  ;
        vL2_r060 := vL2_r060+' = '+#GDS0(L2_r010)+' + '+#GDS0(L2_r020)+' - '+#GDS0(L2_r030)+' - '+#GDS0(L2_r040)+' + '+#GDS0(L2_r050);
        vL2_r140 := #GDS2(L2_r140)+' = '+#GDS2(L2_z150)+' + '+#GDS2(L2_z160)                                                         ;
        vL2_r180 := #GDS0(L2_r180)+' = '+#GDS0(L2_r190)+' + '+#GDS0(L2_r200)                                                         ;
        vL2_r210 := #GDS0(L2_r210)+' = '+#GDS0(L2_r220)+' + '+#GDS0(L2_r230)                                                         ;

        NameStr := pFH.Func('myGetPage_L2_1', i+1);
        #_Log(aL2_r010, mL2_r010, vL2_r010);
        #_Log(aL2_r020, mL2_r020, vL2_r020);
        #_Log(aL2_r030, mL2_r030, vL2_r030);
        #_Log(aL2_r040, mL2_r040, vL2_r040);
        #_Log(aL2_r050, mL2_r050, vL2_r050);
        #_Log(aL2_r060, mL2_r060, vL2_r060);
        #_Log(aL2_r100, mL2_r100, vL2_r100);
        #_Log(aL2_r110, mL2_r110, vL2_r110);
        #_Log(aL2_r120, mL2_r120, vL2_r120);
        #_Log(aL2_r190, mL2_r190, vL2_r190);
        #_Log(aL2_r200, mL2_r200, vL2_r200);

        NameStr := pFH.Func('myGetPage_L2_2', i+1);
        #_Log(aL2_r270, mL2_r270, vL2_r270);
        #_Log(aL2_r271, mL2_r271, vL2_r271);
        #_Log(aL2_r280, mL2_r280, vL2_r280);
        #_Log(aL2_r281, mL2_r281, vL2_r281);
      }
    }
  }
  //#endregion ЛИСТ 02
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 2
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РаспрНалСубРФ'); i++)
  {
    if      not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ТипНП'       )
        and not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ОбРасч'      )
        and not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НаимОП'      )
        and not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/КППОП'       )
        and not GetStrNull('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ОбязУплНалОП')
    {
      aL2_r120       := 'Файл/Документ/Прибыль/РасчНал/НалБазаИсч'                        ;   L2_r120   := GetDblVal(aL2_r120  );

      aL2P5_r070     := 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/СумНал'        ;
      aL2P5_r050     := 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалБазаДоля'   ;
      aL2P5_r100_110 := 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/СумНалП'       ;
      aL2P5_r120     := 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/МесАвПлат'     ;
      aL2P5_r030     := 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалБазаОрг'    ;   L2P5_r030 := GetDblVal(aL2P5_r030);
      aL2P5_z040     := 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ДоляНалБаз'    ;   L2P5_z040 := GetDblVal(aL2P5_z040);
      aL2P5_z060     := 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/СтавНалСубРФ'  ;   L2P5_z060 := GetDblVal(aL2P5_z060);
      aL2P5_z080     := 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалНачислСубРФ';   L2P5_z080 := GetDblVal(aL2P5_z080);
      aL2P5_z090     := 'Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/НалВыплВнеРФ'  ;   L2P5_z090 := GetDblVal(aL2P5_z090);

      if (L2_r120 = 0)
      {
        L2P5_r030  := 0                      ;   #_SetFldGV(aL2P5_r030, L2P5_r030);
        mL2P5_r030 := 'Стр. 030 = 0'         ;
        vL2P5_r030 := #GDS0(L2P5_r030)+' = 0';
      }
      else
      {
        L2P5_r030  := L2_r120                              ;   #_SetFldGV(aL2P5_r030, L2P5_r030);
        mL2P5_r030 := 'Стр. 030 = стр. 120 Листа 02'       ;
        vL2P5_r030 := #GDS0(L2P5_r030)+' = '+#GDS0(L2_r120);
      }

      L2P5_r050     := L2P5_r030 * (L2P5_z040 / 100)    ;   #_SetFldGV(aL2P5_r050    , L2P5_r050    );
      L2P5_r070     := L2P5_r050 * (L2P5_z060 / 100)    ;   #_SetFldGV(aL2P5_r070    , L2P5_r070    );
      L2P5_r100_110 := L2P5_r070 - L2P5_z080 - L2P5_z090;   #_SetFld  (aL2P5_r100_110, L2P5_r100_110);

      mL2P5_r050     := 'Стр. 050 = стр. 030 * (стр. 040 / 100)'       ;
      mL2P5_r070     := 'Стр. 070 = стр. 050 * (стр. 060 / 100)'       ;
      mL2P5_r100_110 := 'Стр. 100/110 = стр. 070 - стр. 080 - стр. 090';

      vL2P5_r050     := #GDS0(L2P5_r050)+' = '+#GDS0(L2P5_r030)+' * ('+#GDS11(L2P5_z040)+' / 100)'               ;
      vL2P5_r070     := #GDS0(L2P5_r070)+' = '+#GDS0(L2P5_r050)+' * ('+#GDS2 (L2P5_z060)+' / 100)'               ;
      vL2P5_r100_110 := #GDS0(L2P5_r100_110)+' = '+#GDS0(L2P5_r070)+' - '+#GDS0(L2P5_z080)+' - '+#GDS0(L2P5_z090);

      NameStr := pFH.Func('myGetPage_L2P5v2', i+1);
      #_Log(aL2P5_r030    , mL2P5_r030    , vL2P5_r030    );
      #_Log(aL2P5_r050    , mL2P5_r050    , vL2P5_r050    );
      #_Log(aL2P5_r070    , mL2P5_r070    , vL2P5_r070    );
      #_Log(aL2P5_r100_110, mL2P5_r100_110, vL2P5_r100_110);

      //Строка 120 не заполняется за налоговый период
      if    _NalPer_God
         or GetStrVal('Файл/Документ/Прибыль/РаспрНалСубРФ'+getIter(i)+'/ОбРасч') = '3'
      {
        L2P5_r120 := 0;
        mL2P5_r120 := 'Cтр. 120 = 0 (нулю) (за налоговый период не заполняется; не заполняются при Расчёт составлен (код) равном 3)';
        vL2P5_r120 := #GDS0(L2P5_r120)+' = 0';
        #SetSNull(aL2P5_r120, L2P5_r120);
      }
      else
      {
        aL2_r310 := 'Файл/Документ/Прибыль/РасчНал/АвПлатМесСуб';   L2_r310 := GetDblVal(aL2_r310);

        L2P5_r120  := L2_r310 * L2P5_z040 / 100                                             ;
        mL2P5_r120 := 'Стр. 120 = стр. 310 Листа 02 * стр. 040 / 100'                       ;
        vL2P5_r120 := #GDS0(L2P5_r120)+' = '+#GDS0(L2_r310)+' * '+#GDS11(L2P5_z040)+' / 100';
        #_SetFld(aL2P5_r120, L2P5_r120);
      }
      #_Log(aL2P5_r120, mL2P5_r120, vL2P5_r120);
    }
  }
  //#endregion ЛИСТ 02. ПРИЛОЖЕНИЕ 5. ВЕРСИЯ 2
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 03
  //----------------------------------------------------------------------------------------------------------
  {
    //----------------------------------------------------------------------------------------------------------
    //#region ЛИСТ 03 (СТР. 1)
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'); i++)
    {
      aL3Ra_r010 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивВсего'               ;
      aL3Ra_r020 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосОргВс'  ;
      aL3Ra_r090 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРаспрУм'             ;
      aL3Ra_z001 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРаспрПол'            ;   L3Ra_z001 := GetDblVal(aL3Ra_z001);
      aL3Ra_z021 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосСтав0'  ;   L3Ra_z021 := GetDblVal(aL3Ra_z021);
      aL3Ra_z022 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосСтав9'  ;   L3Ra_z022 := GetDblVal(aL3Ra_z022);
      aL3Ra_z023 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосСтавИн' ;   L3Ra_z023 := GetDblVal(aL3Ra_z023);
      aL3Ra_z024 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивРосОрг/ДивРосНеНП'   ;   L3Ra_z024 := GetDblVal(aL3Ra_z024);
      aL3Ra_z030 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛРез'               ;   L3Ra_z030 := GetDblVal(aL3Ra_z030);
      aL3Ra_z040 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивИнОрг'               ;   L3Ra_z040 := GetDblVal(aL3Ra_z040);
      aL3Ra_z050 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивФЛНеРез/ДивФЛНеРезВс';   L3Ra_z050 := GetDblVal(aL3Ra_z050);
      aL3Ra_z060 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивСтатНеУст'           ;   L3Ra_z060 := GetDblVal(aL3Ra_z060);
      aL3Ra_z070 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНеДоход'             ;   L3Ra_z070 := GetDblVal(aL3Ra_z070);
      aL3Ra_Form := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/Формула_Л03_Стр090'     ;   L3Ra_Form := GetStrVal(aL3Ra_Form);
      aL3Ra_z080 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА/ДивНАдоРас'       ;   L3Ra_z080 := GetDblVal(aL3Ra_z080);
      aL3Ra_z081 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНА/ДивНАБезУч0'      ;   L3Ra_z081 := GetDblVal(aL3Ra_z081);
      aL3Ra_z091 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал/ДивНал9'         ;   L3Ra_z091 := GetDblVal(aL3Ra_z091);
      aL3Ra_z092 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/ДивНал/ДивНал0'         ;   L3Ra_z092 := GetDblVal(aL3Ra_z092);
      aL3Ra_z100 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалИсчисл'              ;   L3Ra_z100 := GetDblVal(aL3Ra_z100);
      aL3Ra_z110 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалДивПред'             ;   L3Ra_z110 := GetDblVal(aL3Ra_z110);
      aL3Ra_z120 := 'Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/НалДивПосл'             ;   L3Ra_z120 := GetDblVal(aL3Ra_z120);

      L3Ra_r020 := L3Ra_z021 + L3Ra_z022 + L3Ra_z023 + L3Ra_z024            ;   vL3Ra_r020 := #GDS0(L3Ra_r020);   #_SetFldGV(aL3Ra_r020, L3Ra_r020);
      L3Ra_r010 := L3Ra_r020 + L3Ra_z030 + L3Ra_z040 + L3Ra_z050 + L3Ra_z060;   vL3Ra_r010 := #GDS0(L3Ra_r010);   #_SetFldGV(aL3Ra_r010, L3Ra_r010);

      NameStr := pFH.Func('myGetPage_L3_1', i+1);

      if _KategorNA('Файл/Документ/Прибыль/НалУдНА/НалДохДив'+getIter(i)+'/КатегорНА')
      {
        #SetSNull(aL3Ra_z080, L3Ra_z080);   #_Log(aL3Ra_z080, 'Стр. 080 = 0 (нулю) (т.к. Катег. НА = 2)', '0 = 0');
        #SetSNull(aL3Ra_z081, L3Ra_z081);   #_Log(aL3Ra_z081, 'Стр. 081 = 0 (нулю) (т.к. Катег. НА = 2)', '0 = 0');
      }
      else
      {
        case L3Ra_Form of
          '0':  {
                  L3Ra_r090 := L3Ra_z001 - L3Ra_z081;
                  mL3Ra_r090 := 'Стр. 090 = стр. 001 - стр. 081';
                  vL3Ra_r090 := #GDS0(L3Ra_r090)+' = '+#GDS0(L3Ra_z001)+' - '+#GDS0(L3Ra_z081);
                  #_Log(aL3Ra_r090, mL3Ra_r090, vL3Ra_r090);
                  #_SetFldGV(aL3Ra_r090, L3Ra_r090);
                }
          '1':  {
                  L3Ra_r090 := L3Ra_r010 + L3Ra_z070 - L3Ra_z081;
                  mL3Ra_r090 := 'Стр. 090 = стр. 010 + стр. 070 - стр. 081';
                  vL3Ra_r090 := #GDS0(L3Ra_r090)+' = '+#GDS0(L3Ra_r010)+' + '+#GDS0(L3Ra_z070)+' - '+#GDS0(L3Ra_z081);
                  #_Log(aL3Ra_r090, mL3Ra_r090, vL3Ra_r090);
                  #_SetFldGV(aL3Ra_r090, L3Ra_r090);
                }
          else { #SetSNull(aL3Ra_r090, L3Ra_r090); }
        end;

        if (L3Ra_r090 < 0)
        {
          #SetSNull(aL3Ra_r090, L3Ra_r090);   #_Log(aL3Ra_r090, 'Стр. 090 = 0 (нулю) (т.к. стр. 090 < 0)', '0 = 0');
          #SetSNull(aL3Ra_z091, L3Ra_z091);   #_Log(aL3Ra_z091, 'Стр. 091 = 0 (нулю) (т.к. стр. 090 < 0)', '0 = 0');
          #SetSNull(aL3Ra_z092, L3Ra_z092);   #_Log(aL3Ra_z092, 'Стр. 092 = 0 (нулю) (т.к. стр. 090 < 0)', '0 = 0');
          #SetSNull(aL3Ra_z100, L3Ra_z100);   #_Log(aL3Ra_z100, 'Стр. 100 = 0 (нулю) (т.к. стр. 090 < 0)', '0 = 0');
          #SetSNull(aL3Ra_z110, L3Ra_z110);   #_Log(aL3Ra_z110, 'Стр. 110 = 0 (нулю) (т.к. стр. 090 < 0)', '0 = 0');
          #SetSNull(aL3Ra_z120, L3Ra_z120);   #_Log(aL3Ra_z120, 'Стр. 120 = 0 (нулю) (т.к. стр. 090 < 0)', '0 = 0');
        }
      }

      mL3Ra_r010 := 'Стр. 010 = стр. 020 + стр. 030 + стр. 040 + стр. 050 + стр. 060';
      mL3Ra_r020 := 'Стр. 020 = стр. 021 + стр. 022 + стр. 023 + стр. 024'           ;

      vL3Ra_r010 := vL3Ra_r010+' = '+#GDS0(L3Ra_r020)+' + '+#GDS0(L3Ra_z030)+' + '+#GDS0(L3Ra_z040)+' + '+#GDS0(L3Ra_z050)+' + '+#GDS0(L3Ra_z060);
      vL3Ra_r020 := vL3Ra_r020+' = '+#GDS0(L3Ra_z021)+' + '+#GDS0(L3Ra_z022)+' + '+#GDS0(L3Ra_z023)+' + '+#GDS0(L3Ra_z024)                       ;

      #_Log(aL3Ra_r010, mL3Ra_r010, vL3Ra_r010);
      #_Log(aL3Ra_r020, mL3Ra_r020, vL3Ra_r020);
    }
    //#endregion ЛИСТ 03 (СТР. 1)
    //----------------------------------------------------------------------------------------------------------


    //----------------------------------------------------------------------------------------------------------
    //#region ЛИСТ 03 (СТР. 2)
    //----------------------------------------------------------------------------------------------------------
    for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'); i++)
    {
      aL3Rb_r030 := 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалИсчисл';
      aL3Rb_z010 := 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/НалБаза'  ;   L3Rb_z010 := GetDblVal(aL3Rb_z010);
      aL3Rb_z020 := 'Файл/Документ/Прибыль/НалУдНА/НалДохЦБ'+getIter(i)+'/СтавНал'  ;   L3Rb_z020 := GetDblVal(aL3Rb_z020);

      L3Rb_r030 := L3Rb_z010 * L3Rb_z020 / 100;
      mL3Rb_r030 := 'Стр. 030 = стр. 010 * стр. 020 / 100';
      vL3Rb_r030 := #GDS0(L3Rb_r030)+' = '+#GDS0(L3Rb_z010)+' * '+#GDS0(L3Rb_z020)+' / 100';

      NameStr := pFH.Func('myGetPage_L3_2', i+1);
      #_Log(aL3Rb_r030, mL3Rb_r030, vL3Rb_r030);

      #_SetFld(aL3Rb_r030, L3Rb_r030);
    }
    //#endregion ЛИСТ 03 (СТР. 2)
    //----------------------------------------------------------------------------------------------------------
  }
  //#endregion ЛИСТ 03
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ЛИСТ 04
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалДохСтав'); i++)
  {
    aL4_r080 := 'Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПосл' ;
    aL4_z040 := 'Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалИсчисл'     ;   L4_z040 := GetDblVal(aL4_z040);
    aL4_z050 := 'Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалДивНеРФПред';   L4_z050 := GetDblVal(aL4_z050);
    aL4_z060 := 'Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалДивНеРФ'    ;   L4_z060 := GetDblVal(aL4_z060);
    aL4_z070 := 'Файл/Документ/Прибыль/НалДохСтав'+getIter(i)+'/НалНачислПред' ;   L4_z070 := GetDblVal(aL4_z070);

    L4_r080 := L4_z040 - L4_z050 - L4_z060 - L4_z070;
    mL4_r080 := 'Стр. 080 = стр. 040 - стр. 050 - стр. 060 - стр. 070';
    vL4_r080 := #GDS0(L4_r080)+' = '+#GDS0(L4_z040)+' - '+#GDS0(L4_z050)+' - '+#GDS0(L4_z060)+' - '+#GDS0(L4_z070);

    NameStr := pFH.Func('myGetPage_L4', i+1);
    #_Log(aL4_r080, mL4_r080, vL4_r080);

    #_SetFld(aL4_r080, L4_r080);
  }
  //#endregion ЛИСТ 04
  //**********************************************************************************************************


  //==========================================================================================================
  //#region ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ
  //----------------------------------------------------------------------------------------------------------
  var bufXMLAdr_i, bufXMLAdr_j, bufXMLAdr_k : string = '';
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/СведДохФЛ'); i++)
  {
    bufXMLAdr_i := 'Файл/Документ/Прибыль/СведДохФЛ'+getIter(i);

    aP2_r020 := bufXMLAdr_i+'/ДохНалПер/СумДохОбщ';
    aP2_r021 := bufXMLAdr_i+'/ДохНалПер/СумВычОбщ';
    aP2_r022 := bufXMLAdr_i+'/ДохНалПер/НалБаза'  ;
    aP2_r030 := bufXMLAdr_i+'/ДохНалПер/НалИсчисл';
    aP2_z010 := bufXMLAdr_i+'/ДохНалПер/Ставка'   ;   P2_z010 := GetDblVal(aP2_z010);

    P2_r020 := 0;

    vP2_r020 := '';
    vP2_r021 := '';

    for (j := 0; j < XMLMAP.GetNodeCountByName(bufXMLAdr_i+'/СпрДохФЛ/СумДох'); j++)
    {
      bufXMLAdr_j := bufXMLAdr_i+'/СпрДохФЛ/СумДох'+getIter(j);

      if     not GetStrNull(bufXMLAdr_j+'/КодДоход')
         and not GetStrNull(bufXMLAdr_j+'/СумДоход')
      {
        aP2_z041 := bufXMLAdr_j+'/СумДоход';   P2_z041 := GetDblVal(aP2_z041);

        P2_r020 := P2_r020 + P2_z041;
        vP2_r020 := vP2_r020+#GDS2(P2_z041)+' + ';

        for (k := 0; k < XMLMAP.GetNodeCountByName(bufXMLAdr_j+'/СумВыч'); k++)
        {
          bufXMLAdr_k := bufXMLAdr_j+'/СумВыч'+getIter(k);

          if     not GetStrNull(bufXMLAdr_k+'/КодВычет')
             and not GetStrNull(bufXMLAdr_k+'/СумВычет')
          {
            aP2_z043 := bufXMLAdr_k+'/СумВычет';   P2_z043 := GetDblVal(aP2_z043);

            P2_r021 := P2_r021 + P2_z043;
            vP2_r021 := vP2_r021+#GDS2(P2_z043)+' + ';
          }
        }
      }
    }

    for (j := 0; j < XMLMAP.GetNodeCountByName(bufXMLAdr_i+'/НалВычСтанд/СумВыч'); j++)
    {
      bufXMLAdr_j := bufXMLAdr_i+'/НалВычСтанд/СумВыч'+getIter(j);

      if     not GetStrNull(bufXMLAdr_j+'/КодВычет')
         and not GetStrNull(bufXMLAdr_j+'/СумВычет')
      {
        aP2_z052 := bufXMLAdr_j+'/СумВычет';   P2_z052 := GetDblVal(aP2_z052);

        P2_r021 := P2_r021 + P2_z052;
        vP2_r021 := vP2_r021+#GDS0(P2_z052)+' + ';
      }
    }

    vP2_r020 := #GDS2(P2_r020)+' = '+SubStr(vP2_r020, 1, Length(vP2_r020) - 3);   if (vP2_r020 = '0 = ') vP2_r020 := '0 = 0';
    vP2_r021 := #GDS2(P2_r021)+' = '+SubStr(vP2_r021, 1, Length(vP2_r021) - 3);   if (vP2_r021 = '0 = ') vP2_r021 := '0 = 0';

    #_SetFldGV(aP2_r020, P2_r020);
    #_SetFldGV(aP2_r021, P2_r021);

    P2_r022 := P2_r020 - P2_r021;
    vP2_r022 := #GDS2(P2_r022)+' = '+#GDS2(P2_r020)+' - '+#GDS2(P2_r021);

    #_SetFldGV(aP2_r022, P2_r022);

    P2_r030 := P2_r022 * P2_z010 / 100;
    vP2_r030 := #GDS0(P2_r030)+' = '+#GDS2(P2_r022)+' * '+#GDS0(P2_z010)+' / 100';

    #_SetFld(aP2_r030, P2_r030);



    mP2_r020 := 'Стр. 020 = сумма стр. 041 Прил. №2 (продолжение)';
    mP2_r021 := 'Стр. 021 = сумма стр. 043 Прил. №2 (продолжение)';
    mP2_r022 := 'Стр. 022 = стр. 020 - стр. 021'                  ;
    mP2_r030 := 'Стр. 030 = стр. 022 * стр. 010 / 100'            ;

    NameStr := pFH.Func('myGetPage_P2_1', i+1);
    #_Log(aP2_r020, mP2_r020, vP2_r020);
    #_Log(aP2_r021, mP2_r021, vP2_r021);
    #_Log(aP2_r022, mP2_r022, vP2_r022);
    #_Log(aP2_r030, mP2_r030, vP2_r030);

    if (GetStrVal(bufXMLAdr_i + '/Импорт') = '1')
    {
      #_SetFld(bufXMLAdr_i + '/ДохНалПер/НалУдерж', P2_r030);   #_Log(bufXMLAdr_i + '/ДохНалПер/НалУдерж', 'Стр. 031 = стр. 030 (т.к. данная страница сформирована автоматически)', #GDS0(P2_r030)+' = '+vP2_r030);
      #_SetFld(bufXMLAdr_i + '/ДохНалПер/НалУплач', P2_r030);   #_Log(bufXMLAdr_i + '/ДохНалПер/НалУплач', 'Стр. 032 = стр. 030 (т.к. данная страница сформирована автоматически)', #GDS0(P2_r030)+' = '+vP2_r030);
    }
  }
  //#endregion ПРИЛОЖЕНИЕ 2 К ДЕКЛАРАЦИИ
  //**********************************************************************************************************


  On_Visable;


  //==========================================================================================================
  //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.1
  //----------------------------------------------------------------------------------------------------------
  var XMLAdrI, XMLAdrJ, XMLAdrK
    , aR1P11_OKTMO, aL2_271, aL2_281
    , sR1P11_OKTMO : string = '';
  var R1P11_070_080 : double = 0;
  var fl, fl6, fl5 : boolean = false;

  CountI := XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУАв');
  for (i := 0; i < CountI; i++)
  {
    XMLAdrI := 'Файл/Документ/Прибыль/НалПУ/НалПУАв' + getIter(i);
    fl := fl6 := fl5 := false;

    NameStr := pFH.Func('myGetPage_R1P11', i+1);

    aR1P11_040_050 := XMLAdrI + '/ФедБдж/НалПУ';
    aR1P11_070_080 := XMLAdrI + '/СубБдж/НалПУ';
    aR1P11_OKTMO   := XMLAdrI + '/ОКТМО'       ;   sR1P11_OKTMO := GetStrVal(aR1P11_OKTMO);

    R1P11_040_050 := bufL2_r270_r280                                                                           ;
    mR1P11_040_050 := 'Стр. 040/050 = разница стр. 270 и 280 Листа 02'                                         ;
    vR1P11_040_050 := #GDS0(R1P11_040_050)+' = ('+SubStr(vbufL2_r270_r280, 1, Length(vbufL2_r270_r280) - 3)+')';
    #_SetFld(aR1P11_040_050, R1P11_040_050);

    R1P11_070_080  := 0;
    mR1P11_070_080 := 'Стр. 070/080 = 0 (нет данных для расчета)';
    vR1P11_070_080 := '0 = 0';

    CountJ := XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/РасчНал');
    for (j := 0; j < CountJ; j++)
    {
      XMLAdrJ := 'Файл/Документ/Прибыль/РасчНал' + getIter(j);

      if GetFldVis(XMLAdrJ)
      {
        // ПРИЛОЖЕНИЕ 6 К ЛИСТУ 02
        CountK  := XMLMAP.GetNodeCountByName(XMLAdrJ + '/РасчНалГруп');
        for (k := 0; k < CountK; k++)
        {
          XMLAdrK := XMLAdrJ + '/РасчНалГруп' + getIter(k);

          if GetFldVis(XMLAdrK)
          {
            fl6 := true;
            if (sR1P11_OKTMO = GetStrVal(XMLAdrK + '/ОКТМО'))
            {
              fl := true;
              R1P11_070_080 := GetDblVal(XMLAdrK + '/СумНалП');   #_SetFld(aR1P11_070_080, R1P11_070_080);

              mR1P11_070_080 := 'Стр. 070/080 = стр. 100/110 '+pFH.Func('myGetPage_L2P6', j+1, k+1);
              vR1P11_070_080 := #GDS0(GetDblVal(aR1P11_070_080))+' = ('+#GDS0(GetDblVal(XMLAdrK+'/СумНалП'))+')';

              break;
            }
          }
        }

        if not fl6
        {
          // ПРИЛОЖЕНИЕ 5 К ЛИСТУ 02
          CountK  := XMLMAP.GetNodeCountByName(XMLAdrJ + '/РаспрНалСубРФ');
          for (k := 0; k < CountK; k++)
          {
            XMLAdrK := XMLAdrJ + '/РаспрНалСубРФ' + getIter(k);

            if GetFldVis(XMLAdrK)
            {
              fl5 := true;
              if (GetStrVal(XMLAdrK+'/ОбязУплНалОП') = '1')
              {
                fl := true;
                R1P11_070_080 := GetDblVal(XMLAdrK+'/СумНалП');   #_SetFld(aR1P11_070_080, R1P11_070_080);

                mR1P11_070_080 := 'Стр. 070/080 = стр. 100/110 ('+pFH.Func('myGetPage_L2P5v1', j+1, k+1)+')';
                vR1P11_070_080 := #GDS0(GetDblVal(aR1P11_070_080))+' = '+#GDS0(GetDblVal(XMLAdrK+'/СумНалП'));

                break;
              }
            }
          }

          if not fl5
          {
            fl := true;

            aL2_271 := XMLAdrJ + '/НалДоплСуб'
            aL2_281 := XMLAdrJ + '/НалУменСуб'

            R1P11_070_080 := GetDblVal(aL2_271) - GetDblVal(aL2_281);   #_SetFld(aR1P11_070_080, R1P11_070_080);

            mR1P11_070_080 := 'Стр. 070/080 = разница стр. 271 и 281 Листа 02';
            vR1P11_070_080 := #GDS0(GetDblVal(aR1P11_070_080))+' = '+#GDS0(GetDblVal(aL2_271))+' - '+#GDS0(GetDblVal(aL2_281));
          }
        }

        if fl
        {
          #_Log(aR1P11_070_080, mR1P11_070_080, vR1P11_070_080);
          break;
        }
      }
    }

    #_Log(aR1P11_040_050, mR1P11_040_050, vR1P11_040_050);
  }
  //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.1
  //**********************************************************************************************************


  //==========================================================================================================
  //#region РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
  //----------------------------------------------------------------------------------------------------------
  for (i := 0; i < XMLMAP.GetNodeCountByName('Файл/Документ/Прибыль/НалПУ/НалПУМес'); i++)
  {
    aR1P12_r120 := 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат1';
    aR1P12_r130 := 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат2';
    aR1P12_r140 := 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/ФедБдж/АвПлат3';
    aR1P12_r220 := 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат1';
    aR1P12_r230 := 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат2';
    aR1P12_r240 := 'Файл/Документ/Прибыль/НалПУ/НалПУМес'+getIter(i)+'/СубБдж/АвПлат3';

    R1P12_r120 := bufL2_300 / 3;   #_SetFldGV(aR1P12_r120, R1P12_r120);
    R1P12_r130 := bufL2_300 / 3;   #_SetFldGV(aR1P12_r130, R1P12_r130);

    R1P12_r220 := bufL2_310 / 3;   #_SetFldGV(aR1P12_r220, R1P12_r220);
    R1P12_r230 := bufL2_310 / 3;   #_SetFldGV(aR1P12_r230, R1P12_r230);

    R1P12_r140 := bufL2_300 - R1P12_r120 - R1P12_r130;   #_SetFldGV(aR1P12_r140, R1P12_r140);
    R1P12_r240 := bufL2_310 - R1P12_r220 - R1P12_r230;   #_SetFldGV(aR1P12_r240, R1P12_r240);

    mR1P12_r120 := ' = сумма стр. 300 Листа 02 / 3';
    mR1P12_r220 := ' = сумма стр. 310 Листа 02 / 3';

    vR1P12_r120 := #GDS0(R1P12_r120)+' = ('+SubStr(vbufL2_300, 1, Length(vbufL2_300) - 3)+') / 3';
    vR1P12_r220 := #GDS0(R1P12_r220)+' = ('+SubStr(vbufL2_310, 1, Length(vbufL2_310) - 3)+') / 3';

    vR1P12_r140 := #GDS0(R1P12_r140)+' = ('+SubStr(vbufL2_300, 1, Length(vbufL2_300) - 3)+') - '+#GDS0(R1P12_r120)+' - '+#GDS0(R1P12_r130);
    vR1P12_r240 := #GDS0(R1P12_r240)+' = ('+SubStr(vbufL2_310, 1, Length(vbufL2_310) - 3)+') - '+#GDS0(R1P12_r220)+' - '+#GDS0(R1P12_r230);

    NameStr := pFH.Func('myGetPage_R1P12', i+1);
    #_Log(aR1P12_r120, 'Стр. 120'+mR1P12_r120, vR1P12_r120);
    #_Log(aR1P12_r130, 'Стр. 130'+mR1P12_r120, vR1P12_r120);
    #_Log(aR1P12_r220, 'Стр. 220'+mR1P12_r220, vR1P12_r220);
    #_Log(aR1P12_r230, 'Стр. 230'+mR1P12_r220, vR1P12_r220);

    #_Log(aR1P12_r140, 'Стр. 140 = сумма стр. 300 Листа 02 - стр. 120 - стр. 130', vR1P12_r140);
    #_Log(aR1P12_r240, 'Стр. 240 = сумма стр. 310 Листа 02 - стр. 220 - стр. 230', vR1P12_r240);
  }
  //#endregion РАЗДЕЛ 1. ПОДРАЗДЕЛ 1.2
  //**********************************************************************************************************
@end.
//#endregion On_Recalc ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ РАСЧЁТЕ ПОЛЕЙ
//**********************************************************************************************************


//============================================================================================================
//#region On_ExportXML ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ЭКСПОРТЕ В XML
//------------------------------------------------------------------------------------------------------------
@Script On_ExportXML : boolean;
@begin
  SetFldVal('Файл/ИдФайл', Replace(_IdFail_, '.xml', ''));

  if (not XMLMap.ExpToXml(_XmlFileName_)) {
    Message('On_ExportXML: '+ XMLMap.GetStLastError, cancelButton+Warning);
    Exit;
  }

  Message('Выгружен в файл ' + _XmlFileName_);
@end.
//#endregion On_ExportXML ДЕЙСТВИЯ ВЫПОЛНЯЕМЫЕ ПРИ ЭКСПОРТЕ В XML
//**********************************************************************************************************
