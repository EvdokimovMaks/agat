#ifndef __StavkaDiskont_vih__
#define __StavkaDiskont_vih__

#component "F_OS"

//-----------------------------------------------------------------------------
ObjInterface iStavkaDiskont;

  // Получит ставку
  Function GetStavkaExt (_cStavka: comp; _dtBeg: date; _dtPlan : date = ZeroDate): tSumma;
  Function GetStavka ( _dtBeg: date; _dtPlan : date = ZeroDate): tSumma;
  // Количество периодов исполнения между датами
  Function KolPeriodIspoln ( _dt1: date; _dt2 : date; _ForPrevPeriod : boolean = false) : word;
  // Определяет, последнюю дату периода дисконтирования
  Function LastDayOfDiscPeriod ( _dt1: date ) : date;
  // Коэффициент дисконтирования
  Function KoefDiskont ( KolPeriod : word; Stavka : tSumma) : tSumma;

    // Ставка дисконтирования в расчете на период в процентах  т.е. возвращает 0,05
  Function CDP ( _Stavka : tSumma ) : tSumma;

  Function GetSD0_Crt ( _dtOper,  _dtPlanNew : date; _PlanSumRashNew, _StavkaNew, _NewSumIsp : tSumma; _ForPrevPeriod : boolean = false) : tSumma;

  // Изменение суммы резерва в связи с приближение срока исполнения
  Function GetSD1 ( _dtOper,  _dtPlanOld : date; _SumReservOld,  _PlanSumRashOld, _StavkaOld, _OldSumIsp : tSumma; _ForPrevPeriod : boolean = false) : tSumma;
  // Изменение суммы резерва в связи с изменением ставки дисконта
  Function GetSD2 ( _dtOper,  _dtPlanOld : date;  _PlanSumRashOld, _StavkaOld, _StavkaNew, _OldSumIsp : tSumma; _ForPrevPeriod : boolean = false) : tSumma;
  // Изменение суммы резерва в связи с изменением оценочных значений
  Function GetSD3 ( _dtOper,  _dtPlanOld,  _dtPlanNew : date; _PlanSumRashOld,  _PlanSumRashNew, _StavkaNew, _OldSumIsp, _NewSumIsp : tSumma; _ForPrevPeriod : boolean = false) : tSumma;

    // Изменение суммы резерва в связи с приближение срока исполнения
  Function GetSD1_CalcProc ( _dtOper,  _dtPlanOld : date; _SumReservOld,  _PlanSumRashOld, _StavkaOld, _OldSumIsp : tSumma; _ForPrevPeriod : boolean = false) : tSumma;
  // Изменение суммы резерва в связи с изменением ставки дисконта
  Function GetSD2_CalcProc ( _dtOper,  _dtPlanOld : date;  _PlanSumRashOld, _StavkaOld, _StavkaNew, _OldSumIsp : tSumma; _ForPrevPeriod : boolean = false) : tSumma;
  // Изменение суммы резерва в связи с изменением оценочных значений
  Function GetSD3_CalcProc ( _dtOper,  _dtPlanOld,  _dtPlanNew : date; _PlanSumRashOld,  _PlanSumRashNew, _StavkaNew, _OldSumIsp, _NewSumIsp : tSumma; _ForPrevPeriod : boolean = false) : tSumma;

  // для Операции использования резерва
  // Изменение суммы резерва в связи с приближение срока исполнения
  Function GetSD1_Isp ( _dtOper,  _dtPlanOld : date; _SumReservOld,  _PlanSumRashOld, _StavkaOld, _OldSumIsp : tSumma; _ForPrevPeriod : boolean = false) : tSumma;
  // Изменение суммы резерва в связи с изменением ставки дисконта
  Function GetSD2_Isp ( _dtOper,  _dtPlanOld : date;  _PlanSumRashOld, _StavkaOld, _StavkaNew, _OldSumIsp : tSumma; _ForPrevPeriod : boolean = false) : tSumma;
  // Изменение суммы резерва в связи с изменением оценочных значений
  Function GetSD3_Isp ( _dtOper,  _dtPlanOld,  _dtPlanNew : date; _PlanSumRashOld, _PlanSumRashNew, _StavkaNew, _OldSumIsp, _NewSumIsp, _SumRsrvTek  : tSumma; _ForPrevPeriod : boolean = false) : tSumma;

end;


//=============================================================================
VipInterface StavkaDiskont implements iStavkaDiskont
  Parameters (wIntMode : word; cGetRec : comp)
  Licensed (Free);

#endif
