#doc
  Функция создания основного объекта для работы с интерфейсами библиотеки activeds.dll.
  Результат исполнения: если объект успешно создан, то возвращается его адрес, иначе 0.
#end
function ADSI_Create: #TPtr; external 'GalADSI.dll#ADSI_Create';

#doc
  Функция освобождения основного объекта и вспомогательных ресурсов.
  Входные параметры:
    aADSI - адрес ADSI-объекта.
  Результат исполнения: если объект успешно освобожден, то возвращается True, иначе False.
#end
function ADSI_Free(aADSI: #TPtr): Boolean; external 'GalADSI.dll#ADSI_Free';

#doc
  Функция установки глобальных параметров работы библиотеки.
  Входные параметры:
    aParameters - строка параметров через разделитель ';' (точка с запятой). Значение параметра задается после знака '='. Например: 'EnableCP866=1;WorkingDirectory=D:\Temp'.
  Используемые глобальные параметры (иные параметры игнорируются):
    a) EnableCP866 - устанавливает признак необходимости конвертировать получаемые и передаваемые строковые значения из/в CP866 (OEM) кодировку. По умолчанию EnableCP866 равен 'True'. Если равно 'False', то кодировка будет системной (Windows 1251). Данный параметр должен быть первым, т.к. он определяет в какой кодировке будут последующие за ним строковые параметры. Принимаемые значения: 'True', 'False', '1' и '0';
    b) WorkingDirectory - установка рабочей папки для сохранения отчета исключений 'galadsi.txt', бинарных значений атрибутов объектов (например, фотографий объекта класса 'Пользователь') и всех данных в CSV-файл (с помощью функции ADSI_DirectorySearch_SaveDataToFile). Данный параметр устанавливается только один раз. По умолчанию значение пустое и данные будут сохраняться относительно пути исполняемого процесса.
  Результат исполнения: если параметры успешно установлены, то возвращается True, иначе False.
#end
function ADSI_SetParameters(aParameters: String): Boolean; external 'GalADSI.dll#ADSI_SetParameters';

#doc
  Функция исполнения запроса на выборку данных в службе каталогов.
  Входные параметры:
    a) aADSI - адрес ADSI-объекта;
    b) aDirectoryServicePath - строка, указывающая путь, используемый для привязки к объекту в службе каталогов. Смотри https://msdn.microsoft.com/en-us/library/aa746384(v=vs.85).aspx;
    c) aSearchFilter - строка фильтра поиска в формате LDAP. Например, '(objectClass=user)';
    d) aAttributeNames - строка имен атрибутов, для которых запрашиваются данные, через разделитель ';' (точка с запятой). Например: 'name;samAccountName;ADsPath;memberOf'. Для получения всех атрибутов объекта можно использовать маску '*'.
  Результат исполнения: если запрос успешно выполнен и по нему получены данные, то возвращается True, иначе False.
#end
function ADSI_DirectorySearch_Execute(aADSI: #TPtr, aDirectoryServicePath: String, aSearchFilter: String, aAttributeNames: String): Boolean; external 'GalADSI.dll#ADSI_DirectorySearch_Execute';

#doc
  Функция получения размерности данных при успешном исполнении запроса на выборку данных в службе каталогов.
  Входные параметры:
    a) aADSI - адрес ADSI-объекта;
    b) aDimensionType - определяет тип возвращаемой размерности. Принимает значения: 0 - для возврата количества строк данных; 1 - для возврата количества колонок данных. Количество колонок соответствует количеству имен атрибутов, явно заданных через функцию ADSI_DirectorySearch_Execute или количеству всех атрибутов при использовании маски '*'). Иные значения параметра игнорируютсяы;
  Результат исполнения: если данные по запросу корректно получены и имеют размерность заданного типа, то возвращается значение размерности, иначе 0.
#end
function ADSI_DirectorySearch_GetDataSize(aADSI: #TPtr, aDimensionType: LongInt): LongInt; external 'GalADSI.dll#ADSI_DirectorySearch_GetDataSize';

#doc
  Функция получения строкового значения атрибута из данных при успешном исполнении запроса на выборку данных в службе каталогов.
  Входные параметры:
    a) aADSI - адрес ADSI-объекта;
    b) aRowIndex - индекс строки данных. Индексация строк начинается с 0. Количество строк получается с помощью функции ADSI_DirectorySearch_GetDataSize;
    c) aColumnIndex - индекс колонок данных. Индексация колонок начинается с 0. Количество колонок получается с помощью функции ADSI_DirectorySearch_GetDataSize.
    d) aChunk - получаемый блок длинной строки. Индексация блока начинается с 0. Из-за ограничения языка Vip на длину строки 255 (ShortString) приходиться длинные строки считывать блоками. Если исходная строка полностью помещается в размер менее 255, то чтение происходит за одни этап (aChunk = 0). Иначе необходимо заново вызывать данную функцию с увеличением aChunk пока длина возвращаемого строкового значения будет равна 255.
  Данная функция позволяет возвращать следующие типы значения атрибута: строковые, логические, целочисленные, дата/время (с учетом локальной зоны), списочные (элементы списка объединяются через разделитель ';' и вся строка обрамляется двойными кавычками ('"item1;item2;item3;"')) и бинарные (сохранение значения выполняется в отдельный файл с именем атрибута, порядковым номером и расширением '.bin' ('thumbnailPhoto1528.bin')); при успешном сохранении файла возвращаемое строковое значение будет содержать размер файла в байтах, иначе пусто; путь директории файла задается параметром 'WorkingDirectory' с помощью функции ADSI_SetParameters; если файл уже существует, то он будет перезаписан).
  Результат исполнения: возвращается строковое значение атрибута.
#end
function ADSI_DirectorySearch_GetValue(aADSI: #TPtr, aRowIndex: LongInt, aColumnIndex: LongInt, aChunk: LongInt): String; external 'GalADSI.dll#ADSI_DirectorySearch_GetValue';

#doc
  Функция сохранения данных при успешном исполнении запроса на выборку данных в службе каталогов в заданный файл.
  Входные параметры:
    a) aADSI - адрес ADSI-объекта;
    b) aFileName - имя файла, в который сохраняются данные. Расширение файла заменяется на '.csv' для открытия в Excel. Если файл уже существует, то он будет перезаписан. Путь директории файла задается параметром 'WorkingDirectory' с помощью функции ADSI_SetParameters.
  Значения всех колонок (атрибутов) одной строки объединяются через разделитель ';' и записываются в файл.
  Результат исполнения: если данные по запросу корректно сохранены в файл, то возвращается True, иначе False.
#end
function ADSI_DirectorySearch_SaveDataToFile(aADSI: #TPtr, aFileName: String): Boolean; external 'GalADSI.dll#ADSI_DirectorySearch_SaveDataToFile';

#doc
  Функция получения строкового значения свойства объекта в службе каталогов.
  Входные параметры:
    a) aADSI - адрес ADSI-объекта;
    b) aDirectoryServicePath - строка, указывающая путь, используемый для привязки к объекту в службе каталогов;
    c) aPropertyName - имя свойства объекта в службе каталогов.
  Результат исполнения: возвращается строковое значение свойства объекта в службе каталогов.
#end
function ADSI_ADs_GetProperty(aADSI: #TPtr, aDirectoryServicePath: String, aPropertyName: String): String; external 'GalADSI.dll#ADSI_ADs_GetProperty';