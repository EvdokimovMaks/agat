#ifndef _Mail_Template_VIH_INCLUDED_
#define _Mail_Template_VIH_INCLUDED_

#component "C_Common"

#include Mail_Param.vih

#doc
  Функции для работы с параметрами для замены в рассылках
#end
ObjInterface iMail_Template;
  #doc
    Удалить все записи с списком параметров для замены
  #end
  function ClearRows : boolean;
  #doc
    Добавить в шаблон список параметров с их значениями для замены
  #end
  function InsertRow(objMailParam : iMail_Param) : boolean;
  #doc
    Добавить шаблон в существующий шаблон
  #end
  function AddTemplate(objMailTemplate : iMail_Template) : boolean;

  #doc
    Код шаблона
  #end
  property TemplateCode : string read;
  #doc
    Код рассылки
  #end
  property MailCode : string read;
  #doc
    Указатель на тело шаблона
  #end
  property TemplateBody : TPtr read;
end;

vipInterface Mail_Template implements iMail_Template licensed(free);
public:
  constructor Init;
  constructor InitByMailCode(sMailCode : string);
  constructor InitByMailCodeAndtemplate(sMailCode : string; sMailTemplate : string);
  destructor Done;
end;

#endif
