//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
// Галактика 8.1 - Бухгалтерский контур
// Отчеты по операциям модуля ОС (НМА)
//------------------------------------------------------------------------------
// #include PREDEFS.INC

#include FeeSigners.frn

#doc
  Форма для печати отчетов по операциям модуля ОС (НМА).<br>
#end
.form osOne
.group 'Поступление ОС <<Россия>>'
!.group 'Поступление ОС <<Беларусь>>'
!.group 'Поступление ОС <<Казахстан>>'
.group 'Поступление ОС <<ВСМН>>'
!.group 'Поступление НМА <<Россия>>' // Поступление из капстроя
!.group 'Поступление НМА <<Беларусь>>' // Поступление из капстроя
!.group 'Поступление НМА <<Казахстан>>'
!.group 'Поступление НМА <<ВСМН>>'
!.group 'Внутреннее перемещение ОС <<Россия>>'
!.group 'Внутреннее перемещение ОС <<Беларусь>>'
!.group 'Внутреннее перемещение ОС <<Казахстан>>'
!.group 'Внутреннее перемещение ОС <<ВСМН>>'
!.group 'Внутреннее перемещение НМА <<Россия>>'
!.group 'Внутреннее перемещение НМА <<Беларусь>>'
!.group 'Внутреннее перемещение НМА <<Казахстан>>'
!.group 'Внутреннее перемещение НМА <<ВСМН>>'
!.group 'Изменение стоимости ОС <<Россия>>' // Изменение стоимости из капстроя
!.group 'Изменение стоимости ОС <<Беларусь>>' // Изменение стоимости из капстроя
!.group 'Изменение стоимости ОС <<ВСМН>>' // Изменение стоимости из капстроя
!.group 'Изменение стоимости НМА <<Россия>>'
!.group 'Изменение стоимости НМА <<Беларусь>>'
!.group 'Изменение стоимости НМА <<ВСМН>>'
!.group 'Выбытие ОС <<Россия>>'
!.group 'Выбытие ОС <<Беларусь>>'
!.group 'Выбытие ОС <<Казахстан>>'
!.group 'Выбытие ОС <<ВСМН>>'
!.group 'Выбытие НМА <<Россия>>'
!.group 'Выбытие НМА <<Беларусь>>'
!.group 'Выбытие НМА <<Казахстан>>'
!.group 'Выбытие НМА <<ВСМН>>'
.hide

  // При изменении потока необходимо помнить, что
  // Поток заполняется из 2-х мест:
  // Основные средства и Нематериальные активы - в F_OSOper\Vip\OSPrint.vip)
  //                         и для строительства в F_OSOper\Vip\VvStroy_Rep.vpp
.fields

  SpMoveOsNRec               : comp
  MoveOsNRec                 : comp
  SpMoveNRec                 : comp
  isBudjetOrg                : boolean
  isPrintOrgSdat             : boolean

  Печатать_аналитику_по_счету                   : boolean
  Не_заполнять_раздел_2_в_ОС1                   : boolean // для России для операции выбытия

  Поставщик
  Поставщик_ОКПО
  Поставщик_УНН
  Поставщик_Адрес
  Поставщик_Тел
  Поставщик_ОКОНХ
  Поставщик_КПП
  Поставщик_БАНК_Имя
  Поставщик_БАНК_Адрес
  Поставщик_БАНК_Счет
  Поставщик_БАНК_Счет_в_РКЦ
  Поставщик_БАНК_Счет_ПДокументов
  Поставщик_БАНК_МФО
  Поставщик_БАНК_РКЦ

  Получатель
  Получатель_ОКПО
  Получатель_УНН
  Получатель_Адрес
  Получатель_Тел
  Получатель_ОКОНХ
  Получатель_КПП
  Получатель_БАНК_Имя
  Получатель_БАНК_Адрес
  Получатель_БАНК_Счет
  Получатель_БАНК_Счет_в_РКЦ
  Получатель_БАНК_Счет_ПДокументов
  Получатель_БАНК_МФО
  Получатель_БАНК_РКЦ

  Руководитель_Поставщика_nRec                  : comp
  Руководитель_Поставщика
  Руководитель_Поставщика_Должность

  Главный_бухгалтер_Поставщика_nRec             : comp
  Главный_бухгалтер_Поставщика
  Главный_бухгалтер_Поставщика_Должность

  Руководитель_Получателя_nRec                  : comp
  Руководитель_Получателя
  Руководитель_Получателя_Должность

  Главный_бухгалтер_Получателя_nRec             : comp
  Главный_бухгалтер_Получателя
  Главный_бухгалтер_Получателя_Должность

  Структурное_подразделение_Поставщика
  Вид_деятельности_Поставщика                   : longint // Для НА-1 <<Беларусь>>

  Структурное_подразделение_Получателя
  Вид_деятельности_Получателя                   : longint // Для НА-1 <<Беларусь>>

  МОЛ_Поставщика_nRec                           : comp
  МОЛ_Поставщика
  Табельный_номер_Поставщика
  МОЛ_Должность_Поставщика

  МОЛ_Получателя_nRec                           : comp
  МОЛ_Получателя
  Табельный_номер_Получателя
  МОЛ_Должность_Получателя

  Накладная_NRec                                : comp   // Для ОС-1, ОС-1а, ОС-14 (поступление)
  Накладная_дата                                : date   // для ОС-1, ОС-1а, ОС-14 (поступление)

  Доверенность_дата_выдачи                      : date   // для ОС-1, ОС-1а, ОС-14 (поступление)
  Доверенность_номер                                     // для ОС-1, ОС-1а, ОС-14 (поступление)
  Доверенное_лицо_ФИО                                    // для ОС-1, ОС-1а, ОС-14 (поступление)
  Доверенное_лицо_ФИО_дат_падеж                          // для ОС-1, ОС-1а, ОС-14 (поступление)
  Доверенное_лицо_должность                              // для ОС-1, ОС-1а, ОС-14 (поступление)

  Стоимость_приобретения_договорная             : double // для ОС - 1
  Стоимость_за_единицу                          : double // для ОС - 14
  Стоимость_за_общее_количество                 : double // для ОС - 14
  Полная_стоимость                              : double

  Новая_сумма_износа                            : double
  Новая_сумма_износа_за_еденицу                 : double

//------------- Информация о накладной передачи МЦ в ОС ------------------//
  Накладная_передачи_NRec                       : comp   // Для ОС-1 (поступление)
  Накладная_передачи_наименование_валюты        : string // Для ОС-1 (поступление)
  Накладная_передачи_курс_валюты                : double // Для ОС-1 (поступление)
  Накладная_передачи_сумма_в_валюте             : double // Для ОС-1 (поступление)

//------------- Информация о накладной на выбытие ------------------//
  Накладная_выбытие_NRec                        : comp   // Для ОС-1 (выбытие)
  Накладная_выбытие_Стоимость_без_НДС           : double // Для ОС-1 (выбытие)
  Накладная_выбытие_Ставка_НДС                  : double // Для ОС-1 (выбытие)
  Накладная_выбытие_Сумма_НДС                   : double // Для ОС-1 (выбытие)

  Амортизационная_группа_Наименование
  Амортизационная_группа_Код

  Организация_изготовитель
  МОЛ
  Табельный_номер

//------------- Информация об ОС ------------------//
  НаименованиеОС
  Фактический_срок_эксплуатации                 : double

  Срок_использования_до_поступления             : double
  Срок_полезного_использования                  : double
  Стоимость_при_поступлении                     : double

  Сумма_начисленной_амортизации                 : double
  Стоимость_поступления_первоначальная          : double
  Стоимость_поступления_первоначальная_НУ       : double
  Восстановительная_стоимость                   : double // Для ОС - 3
  Изменение_стоимости                           : double // Для ОС - 3
  Затраты_на_ремонт                             : double // Для ОС - 3

  Регистрационный_номер

  KatStroyDataReg                               : date
  KatStroyNoSvidReg                             : string
  KatStroyName                                  : string

  Фирма
  KodOrg
  Метод_Учета
  oc_nma
  Номер_документа
  Дата_документа                                : date
  Дата_приказа                                  : date
  Номер_приказа
  Тип_Операции                                  : word
  Цикл_по_листьям                               : boolean
  NastrOsNRec                                   : comp
  Учет_групповых_карточек                       : comp
  Разрядность_дробной_части                     : word
  kolFormat                                     : string   // формат вывода количества в ИК


  Таб_НомерПред
  Фамилия_МолПред

  Таб_Номер
  Фамилия_Мол

  Код_подрПред
  Departament
  Имя_подрПред

  Код_подрНов
  Departament_Out
  Имя_подрНов

  Стоимость_ИК                                  : double
  Износ_ИК
  ИнвНомер                                      : string
  СтарыйИнвНомер                                : string
  Заводской
  СчетАм
  СубсчетАм
  Код_Норма
  Норма                                         : double
  Норма_наименование

  nRec_алгоритма_начисления_амортизации         : comp
  Наименование_алгоритма_начисления_амортизации : string

  Кооф

  ИмяОс                                         : string
  Марка
  Кол_во                                        : double
  KatOSNRec                                     : comp
  KatOScMC                                      : comp
  KatOSBarKod                                   : string

  KatOsGrOsKodGr                                : string 
  KatOsGrOsNameGr                               : string

  ВЭксплуатацииОт
  УНН_Поставщика
  Объект_у_Получателя                           : word  // = 0
  ОбъектНаходитсяВ
  SumAmort
  Вид_ОКОФ
  Код_ОКОФ
  Вид_обор_fict
  Код_обор_fict
  Год_вып_fict                                  : date
  Date_ekcpl
  Единица_измерения_nRec                        : comp
  Единица_измерения

  SrokIsp                                       : double
  PsNum
  Характеристика

  стоимость_опер
  износ_опер                                    : double
  Новая_стоимость_опер                          : double
  Новый_износ_опер                              : double

  Год_вып                                       : date
  Дата_пост                                     : date
  Дата_платы                                    : date
  Дата_выбытия                                  : date

  Вид_обор
  Код_обор

  Основание_для_составления_акта
  Причина_списания

 #FeeSigners_Os_Fields

//------  цикл по оборотам
  СчетДеб
  КауДеб
  КауДебКод
  СубсчетДеб
  СчетКре
  КауКре
  КауКреКод
  СубсчетКре

//------ цикл по составляющим сложного объекта
  KatOs_nRec_Leaf                               : comp
  KatOs_cMc_Leaf
  Инв_Номер_Лист
  НаименованиеОС_Лист
  Количество_Лист
  Износ_Лист
  Стоимость_Лист
  ЗавНомер_Лист
  Код_Нормы_Амортизации_Лист
  Kodof_nRec_Leaf                               : comp
  Вид_ОКОФ_Лист
  Код_ОКОФ_Лист
  SpMoveOs_nRec_Leaf                            : comp
  Новый_Износ_Лист
  Новая_Стоимость_Лист
  Старый_Износ_Лист
  Старая_Стоимость_Лист

//------  цикл по МЦ объекта
  OsMcNRec
  Наименование_Составляющей
  Кол_во_Составляющих                           : double

//------  цикл по драгметаллам
  NameDrag
  NomenclaturN
  N_Edin
  MassaDrag                                     : double
  СтрМемо                                       : string

//------  цикл по услугам
  nRec_OsMcUsl                                  : comp
  nRec_KatUsl                                   : comp
  nRec_SpSopr                                   : comp
  nRec_KatSopr                                  : comp
  Наименование_услуги
  Номер_и_дата_документа
  Распределенная_сумма_услуги                   : double

.endfields

!
.var
  iExcelFormat : ExcelFormat;
.endvar
! --------------------------------------------------------------------------
.{ // Начало формы
 { *** Начало формы ***

  SpMoveOsNRec                                  - ^
  MoveOsNRec                                    - ^
  SpMoveNRec                                    - ^
  isBudjetOrg                                   - ^
  isPrintOrgSdat                                - ^

  Печатать_аналитику_по_счету                   - ^
  Не_заполнять_раздел_2_в_ОС1                   - ^

  Поставщик                                     - ^
  Поставщик_ОКПО                                - ^
  Поставщик_УНН                                 - ^
  Поставщик_Адрес                               - ^
  Поставщик_Тел                                 - ^
  Поставщик_ОКОНХ                               - ^
  Поставщик_КПП                                 - ^
  Поставщик_БАНК_Имя                            - ^
  Поставщик_БАНК_Адрес                          - ^
  Поставщик_БАНК_Счет                           - ^
  Поставщик_БАНК_Счет_в_РКЦ                     - ^
  Поставщик_БАНК_Счет_ПДокументов               - ^
  Поставщик_БАНК_МФО                            - ^
  Поставщик_БАНК_РКЦ                            - ^

  Получатель                                    - ^
  Получатель_ОКПО                               - ^
  Получатель_УНН                                - ^
  Получатель_Адрес                              - ^
  Получатель_Тел                                - ^
  Получатель_ОКОНХ                              - ^
  Получатель_КПП                                - ^
  Получатель_БАНК_Имя                           - ^
  Получатель_БАНК_Адрес                         - ^
  Получатель_БАНК_Счет                          - ^
  Получатель_БАНК_Счет_в_РКЦ                    - ^
  Получатель_БАНК_Счет_ПДокументов              - ^
  Получатель_БАНК_МФО                           - ^
  Получатель_БАНК_РКЦ                           - ^

  Руководитель_Поставщика_nRec                  - ^
  Руководитель_Поставщика                       - ^
  Руководитель_Поставщика_Должность             - ^

  Главный_бухгалтер_Поставщика_nRec             - ^
  Главный_бухгалтер_Поставщика                  - ^
  Главный_бухгалтер_Поставщика_Должность        - ^

  Руководитель_Получателя_nRec                  - ^
  Руководитель_Получателя                       - ^
  Руководитель_Получателя_Должность             - ^

  Главный_бухгалтер_Получателя_nRec             - ^
  Главный_бухгалтер_Получателя                  - ^
  Главный_бухгалтер_Получателя_Должность        - ^

  Структурное_подразделение_Поставщика          - ^
  Вид_деятельности_Поставщика                   - ^

  Структурное_подразделение_Получателя          - ^
  Вид_деятельности_Получателя                   - ^

  МОЛ_Поставщика_nRec                           - ^
  МОЛ_Поставщика                                - ^
  Табельный_номер_Поставщика                    - ^
  МОЛ_Должность_Поставщика                      - ^

  МОЛ_Получателя_nRec                           - ^
  МОЛ_Получателя                                - ^
  Табельный_номер_Получателя                    - ^
  МОЛ_Должность_Получателя                      - ^

  Накладная_NRec                                - ^
  Накладная_дата                                - ^

  Доверенность_дата_выдачи                      - ^
  Доверенность_номер                            - ^
  Доверенное_лицо_ФИО                           - ^
  Доверенное_лицо_ФИО_дат_падеж                 - ^
  Доверенное_лицо_должность                     - ^

  Стоимость_приобретения_договорная             - ^
  Стоимость_за_единицу                          - ^
  Стоимость_за_общее_количество                 - ^
  Полная_стоимость                              - ^

  Новая_сумма_износа                            - ^
  Новая_сумма_износа_за_еденицу                 - ^

//------------- Информация о накладной передачи МЦ в ОС ------------------//
  Накладная_передачи_NRec                       - ^
  Накладная_передачи_наименование_валюты        - ^
  Накладная_передачи_курс_валюты                - ^
  Накладная_передачи_сумма_в_валюте             - ^

//------------- Информация о накладной на выбытие ------------------//
  Накладная_выбытие_NRec                        - ^
  Накладная_выбытие_Стоимость_без_НДС           - ^
  Накладная_выбытие_Ставка_НДС                  - ^
  Накладная_выбытие_Сумма_НДС                   - ^

  Амортизационная_группа_Наименование           - ^
  Амортизационная_группа_Код                    - ^

  Организация_изготовитель                      - ^
  МОЛ                                           - ^
  Табельный_номер                               - ^

//------------- Информация об ОС ------------------//
  НаименованиеОС                                - ^
  Фактический_срок_эксплуатации                 - ^

  Срок_использования_до_поступления             - ^
  Срок_полезного_использования                  - ^
  Стоимость_при_поступлении                     - ^

  Сумма_начисленной_амортизации                 - ^
  Стоимость_поступления_первоначальная          - ^
  Стоимость_поступления_первоначальная_НУ       - ^
  Восстановительная_стоимость                   - ^
  Изменение_стоимости                           - ^
  Затраты_на_ремонт                             - ^

  Регистрационный_номер                         - ^

  KatStroyDataReg                               - ^
  KatStroyNoSvidReg                             - ^
  KatStroyName                                  - ^

  Фирма                                         - ^
  KodOrg                                        - ^
  Метод_Учета                                   - ^
  oc_nma                                        - ^
  Номер_документа                               - ^
  Дата_документа                                - ^
  Дата_приказа                                  - ^
  Номер_приказа                                 - ^
  Тип_Операции                                  - ^
  Цикл_по_листьям                               - ^
  NastrOsNRec                                   - ^
  Учет_групповых_карточек                       - ^
  Разрядность_дробной_части                     - ^
  kolFormat                                     - ^

  Таб_НомерПред                                 - ^
  Фамилия_МолПред                               - ^

  Таб_Номер                                     - ^
  Фамилия_Мол                                   - ^

  Код_подрПред                                  - ^
  Departament                                   - ^
  Имя_подрПред                                  - ^

  Код_подрНов                                   - ^
  Departament_Out                               - ^
  Имя_подрНов                                   - ^

  Стоимость_ИК                                  - ^
  Износ_ИК                                      - ^
  ИнвНомер                                      - ^
  СтарыйИнвНомер                                - ^
  Заводской                                     - ^
  СчетАм                                        - ^
  СубсчетАм                                     - ^
  Код_Норма                                     - ^
  Норма                                         - ^
  Норма_наименование                            - ^

  nRec_алгоритма_начисления_амортизации         - ^
  Наименование_алгоритма_начисления_амортизации - ^

  Кооф                                          - ^

  ИмяОс                                         - ^
  Марка                                         - ^
  Кол_во                                        - ^
  KatOSNRec                                     - ^
  KatOScMC                                      - ^
  KatOSBarKod                                   - ^
  KatOsGrOsKodGr                                - ^ 
  KatOsGrOsNameGr                               - ^
  ВЭксплуатацииОт                               - ^
  УНН_Поставщика                                - ^
  Объект_у_Получателя                           - ^
  ОбъектНаходитсяВ                              - ^
  SumAmort                                      - ^
  Вид_ОКОФ                                      - ^
  Код_ОКОФ                                      - ^
  Вид_обор_fict                                 - ^
  Код_обор_fict                                 - ^
  Год_вып_fict                                  - ^
  Date_ekcpl                                    - ^
  Единица_измерения_nRec                        - ^
  Единица_измерения                             - ^

  SrokIsp                                       - ^
  PsNum                                         - ^
  Характеристика                                - ^

  стоимость_опер                                - ^
  износ_опер                                    - ^
  Новая_стоимость_опер                          - ^
  Новый_износ_опер                              - ^

  Год_вып                                       - ^
  Дата_пост                                     - ^
  Дата_платы                                    - ^
  Дата_выбытия                                  - ^

  Вид_обор                                      - ^
  Код_обор                                      - ^

  Основание_для_составления_акта                - ^
  Причина_списания                              - ^

#FeeSigners_Os_Body(osOne)

! цикл по оборотам
   { ***** цикл по оборотам *****
.{ CheckEnter Os_Oborot
     { -------------------
       СчетДеб                                  - ^
       КауДеб                                   - ^
       КауДебКод                                - ^
       СубсчетДеб                               - ^
       СчетКре                                  - ^
       КауКре                                   - ^
       КауКреКод                                - ^
       СубсчетКре                               - ^
     } -------------------
.}
   }

! цикл по составляющим сложного объекта
   { ***** цикл по составляющим сложного объекта *****
.{ CheckEnter Os_Leafs
     { -------------------
       KatOs_nRec_Leaf                          - ^
       KatOs_cMc_Leaf                           - ^
       Инв_Номер_Лист                           - ^
       НаименованиеОС_Лист                      - ^
       Количество_Лист                          - ^
       Износ_Лист                               - ^
       Стоимость_Лист                           - ^
       ЗавНомер_Лист                            - ^
       Код_Нормы_Амортизации_Лист               - ^
       Kodof_nRec_Leaf                          - ^
       Вид_ОКОФ_Лист                            - ^
       Код_ОКОФ_Лист                            - ^
       SpMoveOs_nRec_Leaf                       - ^
       Новый_Износ_Лист                         - ^
       Новая_Стоимость_Лист                     - ^
       Старый_Износ_Лист                        - ^
       Старая_Стоимость_Лист                    - ^
     } -------------------
.}
   }

! цикл по составляющим объекта
   { ***** цикл по составляющим объекта *****
.{ CheckEnter Os_Sostav
     { -------------------
       OsMcNRec                                 - ^
       Наименование_Составляющей                - ^
       Кол_во_Составляющих                      - ^
     } -------------------
.}
   }

! цикл по драгметаллам
   { ***** цикл по драгметаллам *****
.{ CheckEnter Os_NalDrag
     { -------------------
       NameDrag                                 - ^
       NomenclaturN                             - ^
       N_Edin                                   - ^
       MassaDrag                                - ^
       СтрМемо                                  - ^
     } -------------------
.}
   }

! цикл по услугам
   { ***** цикл по услугам *****
.{ CheckEnter Os_AktUsl
     { -------------------
       nRec_OsMcUsl                             - ^
       nRec_KatUsl                              - ^
       nRec_SpSopr                              - ^
       nRec_KatSopr                             - ^
       Наименование_услуги                      - ^
       Номер_и_дата_документа                   - ^
       Распределенная_сумма_услуги              - ^
     } -------------------
.}
   }

 } *** Конец формы ***
.} // Конец формы
.endform
