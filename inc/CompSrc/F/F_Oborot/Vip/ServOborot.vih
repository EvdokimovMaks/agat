//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 8.1 - Бухгалтерский контур
// Общие функции работы с таблицей Oborot
//------------------------------------------------------------------------------

#ifdef ComponentVersion
#Component "F_Oborot"
#end

#ifndef _ServObor_Included_
#define _ServObor_Included_

#include Fp_decl.Mac

#doc
Общие функции работы с таблицей Oborot
#end
ObjInterface iServOborot;

!===========================================================================
!                                 MODIFY
!---------------------------------------------------------------------------
#mDeclModifyFun(type$p_Oborot)

#undef mDeclModifyFun

!===========================================================================
!                                  COMMON
!---------------------------------------------------------------------------

#doc
Проверка существования проводки
#end
function ExistOborot(_cOborot : comp) : boolean;
#doc
Проверка существования проводок, привязанных к хозоперации _SoprHoz
#end
function ExistOborotsInSoprHoz(_cSoprHoz : comp) : boolean;
#doc
Проверка существования проводок, привязанных к хозоперации _SoprHoz в плане счетов _cPlanSch
#end
function ExistOborotsInSoprHozPlan(_cSoprHoz : comp; _cPlanSch : comp) : boolean;
#doc
Проверка существования проводок, привязанных к документу
#end
function ExistOborotsInDoc(_cSoprDoc : comp; _TiDk : word) : boolean;
#doc
Проверка существования проводок, привязанных к документу в плане счетов _cPlanSch
#end
function ExistOborotsInDocPlan(_cSoprDoc : comp; _TiDk : word; _cPlanSch : comp) : boolean;
!---------------------------------------------------------------------------
#doc
Сумма проводки
#end
function SummaOborot(_cOborot : comp) : double;
#doc
Сумма проводок, привязанных к хозоперации _SoprHoz
#end
function SummaOborotsInSoprHoz(_cSoprHoz : comp) : double;
#doc
Сумма проводок, привязанных к хозоперации _SoprHoz в плане счетов _cPlanSch
#end
function SummaOborotsInSoprHozPlan(_cSoprHoz : comp; _cPlanSch : comp) : double;
#doc
Сумма проводок, привязанных к хозоперации _SoprHoz в плане счетов _cPlanSch с входимостью "+"
#end
function SummaVhodOborotsInSoprHozPlan(_cSoprHoz : comp; _cPlanSch : comp) : double;
#doc
Сумма проводок, привязанных к документу
#end
function SummaOborotsInDoc(_cSoprDoc : comp; _TiDk : word) : double;
#doc
Сумма проводок, привязанных к документу в плане счетов _cPlanSch
#end
function SummaOborotsInDocPlan(_cSoprDoc : comp; _TiDk : word; _cPlanSch : comp) : double;
!---------------------------------------------------------------------------
#doc
Удаление проводки с Nrec-ом _cOborot
#end
Function DelOborot(_cOborot : comp) : boolean;
#doc
Удаление проводок, привязанных к хозоперации _SoprHoz
#end
function DelOborotsInSoprHoz(_cSoprHoz : comp) : boolean;
#doc
Удаление проводок, привязанных к хозоперации _SoprHoz в плане счетов _cPlanSch
#end
function DelOborotsInSoprHozPlan(_cSoprHoz : comp; _cPlanSch : comp) : boolean;
#doc
Удаление проводок, привязанных к документу
#end
function DelOborotsInDoc(_cSoprDoc : comp; _TiDk : word) : boolean;
#doc
Удаление проводок, привязанных к документу в плане счетов _cPlanSch
#end
function DelOborotsInDocPlan(_cSoprDoc : comp; _TiDk : word; _cPlanSch : comp) : boolean;

End;

ObjInterface iServOborotExt;
#doc
Удаление проводок, привязанных к документу в плане счетов _cPlanSch
#end
function ExistKauInOborot(_wTbl:word; _cKau:comp) : boolean;

End;

ObjInterface iServOborotExt2;
#doc
Валютной сумма проводки
#end
function SumValOborot(_cOborot : comp) : double;

End;

ObjInterface iServOborotExt3;
#doc
Получить номер документа по ссылке на документ и его тип
#end
function GetLongDocNum(_cSoprDoc : comp; _TiDkGal : word; _NoDoc : string) : string;

End;

VipInterface ServOborot implements iServOborot,iServOborotExt,iServOborotExt2,iServOborotExt3 #Licensed_Free;
#endif // _ServObor_Included_
