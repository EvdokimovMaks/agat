//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 8.1 - Бухгалтерский контур
// Редактирование и просмотр проводок - объект
//------------------------------------------------------------------------------

#ifndef __ObjOborot__vih__
#define __ObjOborot__vih__

#ifdef ComponentVersion
#Component "F_Oborot"
#end

#include OborotAbstract.vih
#include TDocument.vih // Свойства документов и их спецификаций
#include PSManager.vih // Работа с регистрами учета и планами счетов
#include TOborot.vih

#doc
Просмотр и редактирование бухгалтерских проводок
#end
ObjInterface iObjOborot
  #ifdef Gal8_1
  (ObjOborotAbstract)
  #end
  ;

!---------------------------------------------------------------------------
#doc
Инициализация интерфейса через сервис документа
#end
Function InitByObjDoc(
       _wIntMode     : word;     // режим редактирования, Ex. cgiNo, cgiNotEdit
       _wRunMode     : word;     // режим отбора, Ex. cgiOborot_SoprHozOborot
       _cPlanSch     : comp;     // план счетов
       _cOborot      : comp;     // NRec бухпроводки
       _pObjDocument : TDocument // ссылка на сервис документа
) : boolean;

!---------------------------------------------------------------------------
#doc
Инициализация ссылки на разделяемую копию PSManager'а
#end
Procedure SetPSManager(_PS: PSManager; abChangePS: boolean);

!---------------------------------------------------------------------------
#doc
Инициализация активизированного окна
#end
Function InitWindow (
             _wMode : word       // режим отображения, Ex. cgiOborot_BrowseShort
) : boolean;

!---------------------------------------------------------------------------
! Event
!---------------------------------------------------------------------------

!---------------------------------------------------------------------------
#doc
Событие для дополнения или переопределения полей буфера бухпроводки
#end
Event procedure EventSetDefault(var bOborot : #TOborot);

!---------------------------------------------------------------------------
#doc
Произошло событие _Command. 
Если нужно заменить стандартную обработку события собственной, то вернуть _Command = cmCancel
#end
Event procedure EventPutCommand(var _Command : integer);

!---------------------------------------------------------------------------
#doc
Событие для перерисовки дополнительно окрытых экземпляров
#end
Event procedure EventSetPosition(var _nRec : tNRec);

#ifNdef Gal8_1
!---------------------------------------------------------------------------
#doc
Событие проверки прав доступа на редактирование документа
#end
Event function EventCanEditDoc(awShowMessage: word; var awDocProtect: word): boolean;
#end
!---------------------------------------------------------------------------
#doc
Событие, генерируемое при передаче фокуса ввода контейнеру, если проводки редактировались
#end
Event Procedure EventAfterEdit;

!---------------------------------------------------------------------------
! Common
!---------------------------------------------------------------------------

!---------------------------------------------------------------------------
#doc
Установить резервную дату для функции GetDatObDoc 
(если в результате выполнения GetDatObDoc дата проводки все еще пустая)
#end
procedure SetReserveDatObDoc(_Date : date);

!---------------------------------------------------------------------------
#doc
Добавить меню _IHotKey в меню текущего окна
#end
procedure AddIHotKey(_IHotKey : string);

!---------------------------------------------------------------------------
#doc
Изменить меню текущего окна на меню _IHotKey
#end
procedure SetIHotKey(_IHotKey : string);

!---------------------------------------------------------------------------
#doc
Освободить обратные ссылки
#end
procedure FreeLinks;

End;

#doc
Встроенные бухгалтерские проводки
#end
ObjInterface iEmbObjOborot;
!---------------------------------------------------------------------------
#doc
Получить имя текущего фильтра окна
#end
Function GetNameFilter : string;

end;

#doc
Редактирование бухгалтерских проводок с признаком модификации
#end
ObjInterface iObjOborotEx;
!---------------------------------------------------------------------------
#doc
Редактирование бухгалтерской проводки
#end
Function RunEditOborotEx(
    _wIntMode     : word;     // режим cgiNo, cgiNotEdit, cgiSingleEdit, ...
    _wRunMode     : word;     // режим работы:
                              //  cgiOborot_AllOborot         - все
                              //  cgiOborot_DocOborot         - только по документу
                              //  cgiOborot_SoprHozOborot     - только по SoprHoz
    _cPlanSch     : comp;     // план счетов
    _cOborot      : comp;     // NRec бухпроводки
    _pObjDocument : TDocument // ссылка на сервис документа
) : integer;                  // 0 - не было модификации; 1 - была

end;


#doc
Синхронизация проводок
#end
ObjInterface iObjOborotEx_v1;
!---------------------------------------------------------------------------
#doc
Сброс маркера пометки проводок
#end
Procedure ResetMarker;
end;

VipInterface ViewOborot
  #ifdef Gal8_1
  (OborotAbstract)
  #end
  implements iObjOborot, iObjOborotEx_v1 #Licensed_Free
  #ifdef Atl51
  Parameters (wIntMode, wOpMode : word; myPlansNo, cGetRec : comp; iObjDocument : TDocument)
  #end
;

VipInterface EditOborot
  #ifdef Gal8_1
  (OborotAbstract)
  #end
  implements iObjOborot , iEmbObjOborot, iObjOborotEx, iObjOborotEx_v1 #Licensed_Free
  #ifdef Atl51
  Parameters (wIntMode, wOpMode : word; myPlansNo, cGetRec : comp; iObjDocument : TDocument)
  #end
;

#end // __ObjOborot__vih__
