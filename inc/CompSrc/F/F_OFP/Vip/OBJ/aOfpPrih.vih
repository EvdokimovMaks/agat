//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
// Неразнесенный приход
//------------------------------------------------------------------------------

#ifndef __aOfpPrih_VIH__
#define __aOfpPrih_VIH__

//------------------------------------------------------------------------------
#ifdef ComponentVersion
#component "F_OFP"
#end
//------------------------------------------------------------------------------

#doc
Неразнесенный приход.<br>
#end
Private ObjInterface objOfpPrih;

  #doc
  Освобождение ссылок на объекты, провоцирующие циклические зависимости объектов.<br>
  #end
  Function FreeCrossVipRef : boolean;

  //////////////////////// УДАЛЕНИЕ ЗАПИСИ ////////////////////////////
  #doc
  Удаление связки OfpPrihod с SoprHoz при удалении SoprHoz (или прив.к ДО).<br>
  #end
  Function HozPrihod_DeleteBySoprHoz(_cSoprHoz: comp): boolean;
  #doc
  Удаление OfpPrihod по позиции.<br>
  #end
  Function OfpPrihod_Delete(_pOfpPrihod: TPOfpPrihod): boolean;

  ///////////////////// ИЗМЕНЕНИЕ АТРИБУТОВ ///////////////////////////
  #doc
  Перенос неразнесенного прихода на остатки архивного периода.<br>
  #end
  Function OfpPrihod_ToArchive(_day: date): boolean;
  #doc
  Обновление сальдо для прихода (после update и insert OfpPrihod).<br>
  #end
  Procedure OfpPrihod_RecountSaldo(bufOfpPrihod: TOfpPrihod);

  //////////////////////// СОЗДАНИЕ ЗАПИСИ ////////////////////////////
  #doc
  Уже существует запись.<br>
  #end
  Function OfpPrihod_Exists(bufOfpPrihod: TOfpPrihod): boolean;
  #doc
  Заполнение буфера OfpPrihod.<br>
  #end
  Procedure OfpPrihod_Fill(var bufOfpPrihod: TOfpPrihod);
  #doc
  Заполнение буфера по ПС.<br>
  #end
  Function OfpPrihod_FillByPs(bufOfpSaldo: TOfpSaldo;_BegDate: date; _EndDate: date; var bufOfpPrihod: TOfpPrihod): boolean;
  #doc
  Привязка OfpPrihod к SoprHoz (аналог AktPerf).<br>
  #end
  Function HozPrihod_AddBySoprHoz(bufSoprHoz: TSoprHoz): boolean;
  #doc
  Сумма по привязанным ХО.<br>
  #end
  Function OfpPrihod_GetSummaSH(_cOfpPrihod: comp; _tip: word): double;

End;

VipInterface iOfpPrih implements objOfpPrih
  Licensed(Free);
//------------------------------------------------------------------------------
#end // __aOfpPrih_VIH__
