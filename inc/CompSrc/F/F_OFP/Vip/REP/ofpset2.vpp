//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Платежный календарь"
// общая часть для интерфейсов настройки интерактивных отчетов
//------------------------------------------------------------------------------

// в интерфейсе
// объявить savUserDeskRep
// подключить ituneier
// требует наличия winSetTree

Procedure OnEdit;
{
  RunWindow(winSetTree);
  ReScanPanel(#UserDeskRep); //???
}

// -----------------------------------------------------------------------------
// сохранить настройку
Procedure OnSaveDoc;
{
  if (isModified)
    if (not UpdateTable)
    {
      abort;
      exit;
    }

  savUserDeskRep := piTuneIer.SaveUserDeskRep(UserDeskRep.nRec);
}

// -----------------------------------------------------------------------------
// восстановить настройку
Procedure OnRestoreDoc;
{
  if (isModified)
    if (not UpdateTable)
    {
      abort;
      exit;
    }

  // создаем запись и открываем на редактирование
  var rec: comp;
  rec    := piTuneIer.RestoreUserDeskRep(savUserDeskRep);

  if getfirst UserDeskRep where ((rec == UserDeskRep.nRec)) <> tsOk {};

  ReScanPanel(#UserDeskRep);
  PutCommand( cmEdit);
  SelectField(#UserDeskRep.RepName);
}

// -----------------------------------------------------------------------------
// добавление настройки
Procedure OnAddNewRec;
{
  PutCommand(cmInsert);
}

// -----------------------------------------------------------------------------
Procedure OnValue1;
{
  RunWindow(winSetTree);
  SelectField(#UserDeskRep.RepName);
}
