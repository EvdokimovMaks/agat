//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
// Табличный объект взаимодействия: "Настройки алгоритмов"
//------------------------------------------------------------------------------

#ifndef __ExtTablAlgNastr_Vih__
#define __ExtTablAlgNastr_Vih__

#ifdef  ComponentVersion
#component "F_OFP"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include IModify.Vih            // Абстрактный табличный интерфейс
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Табличный объект взаимодействия: "Настройки алгоритмов"
#end
ObjInterface oExtTablAlgNastr;
  Property NRec      : comp   read write; // Номер записи
  Property wDocType  : word   read write; // Тип документа системы
  Property wBaseType : word   read write; // Тип основания
  Property cUserID   : comp   read write; // UserID
  Property wFieldAlg : word   read write; // поле
  Property wAlg      : word   read write; // алгоритм

  Index TablUserAlgNastr01 = wDocType, wBaseType, cUserID, wFieldAlg;

  //----------------------------------------------------------------------------
  #doc
     Описание последней ошибки
  #end
  Function GetStLastError: string;
  //----------------------------------------------------------------------------
  #doc
     Сообщение последней ошибки
  #end
  Function RunShowError: boolean;
  //----------------------------------------------------------------------------
  #doc
    Наименование поля
  #end
  Function GetFieldName(_wFielfAlg: word): string;
  //----------------------------------------------------------------------------
  #doc
     Алгоритмы по умолчанию
  #end
  Function GetDefValue(_wBaseType, _wFielfAlg: word): word;
  //----------------------------------------------------------------------------
  #doc
     Наименование алгоритма
  #end
  Function GetAlgName(_cUser: comp; _wDocType, _wBaseType, _wFieldAlg: word): string;
  //----------------------------------------------------------------------------
  #doc
    Пользовательский алгоритм
  #end
  Function isUserAlg(_cUser: comp; _wDocType, _wBaseType, _wFieldAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
    Алгоритм "выбор из каталога"
  #end
  Function isAlgGet(wAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
     Проверка значений настроек
  #end
  Function CheckAllNastr(_isMess: boolean): boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить общие настройки пользователю
  #end
  Function CopyAllUserNastr(_cUserFrom, _cUserTo: comp; _isMess: boolean): boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить общие настройки пользователю по документу
  #end
  Function CopyDocUserNastr(_cUserFrom, _cUserTo: comp; _wDocType: word; _isMess: boolean): boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить общие настройки пользователю по основанию
  #end
  Function CopyBaseUserNastr(_cUserFrom, _cUserTo: comp; _wDocType, _wBaseType: word; _isMess: boolean): boolean;
  //----------------------------------------------------------------------------
  #doc
     Удалить все настройки пользователя
  #end
  Function DeleteAllUserNastr(_cUser: comp; _isMess: boolean): boolean;
  //----------------------------------------------------------------------------
  #doc
     Удалить все настройки пользователя для документа
  #end
  Function DeleteDocUserNastr(_cUser: comp; _wDocType: word; _isMess: boolean): boolean;
  //----------------------------------------------------------------------------
  #doc
     Удалить все настройки пользователя для основания
  #end
  Function DeleteBaseUserNastr(_cUser: comp; _wDocType, _wBaseType: word; _isMess: boolean): boolean;
End; // ObjInterface

//------------------------------------------------------------------------------
VipInterface ExtTablAlgNastr implements oExtTablAlgNastr, IModify
  Licensed(Free);
Public:
  Constructor Init;
  Destructor  Done;
End;

#endif//__ExtTablAlgNastr_Vih__
