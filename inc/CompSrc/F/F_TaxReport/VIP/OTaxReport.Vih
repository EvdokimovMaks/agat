//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.1 - модуль "Электронная отчетность"
// Базовый объект : "Работа с налоговыми отчетами"
//------------------------------------------------------------------------------

#ifndef _OTaxReport_Vih__
#define _OTaxReport_Vih__

#ifdef  ComponentVersion
#component "F_TaxReport"
#endif //ComponentVersion

#include ExListTaxDoc.Tbl

//------------------------------------------------------------------------------
#doc
Базовый объект : "Настройка представлений и алгоритмов"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface iObjTaxReport;

//==============================================================================
//                                  GET
//------------------------------------------------------------------------------
#doc
  Возвращает актуальную версию отчета
#end
function GetActualVersion(_IDTaxReport : word
                         ) : word;
#doc
  Возвращает актуальное наименование отчета
#end
function GetActualName(_IDTaxReport : word
                       ) : string;

#doc
  Возвращает количество типов отчетов
#end
function GetCountRecord : longint;


#doc
  Возвращает версию отчета по заданной дате из периода формирования
#end
function GetVersionByDate(_IDTaxReport : word;
                          _dBeg        : date
                         ): word;

//==============================================================================
//                                  GETFIELD
//------------------------------------------------------------------------------
#doc
  Возвращает наименование отчета
#end
function GetName(_IDTaxReport : word;
                 _Version     : word
                   ) : string;

#doc
  Возвращает наименование интерфейса
#end
function GetInterfaceName(_IDTaxReport : word;
                          _Version     : word
                          ) : string;

//==============================================================================
//                                  GETFIELD
//------------------------------------------------------------------------------
#doc
  Возвращает наименование отчета
#end
function GetNameByDate(_IDTaxReport : word;
                       _dBeg     : date
                      ) : string;

#doc
  Возвращает наименование интерфейса
#end
function GetInterfaceNameByDate(_IDTaxReport : word;
                                _dBeg        : date
                               ) : string;

#doc
  Возвращает тип налогового отчета
#end
function GetTypeRep(_IDTaxReport : word;
                    _vwVersion   : word
                   ) : word;
#doc
  Возвращает наименование интерфейса редактирования налогового отчета
#end
function GetEditorName(_IDTaxReport : word;
                       _vwVersion   : word
                      ) : string;

//==============================================================================
//                                  ISVALID
//------------------------------------------------------------------------------
#doc
  Возможно ли формирование отчета в заданном типе периода
#end
function IsCreateTPer(_IDTaxReport : word;
                      _Version     : word;
                      _TPerEd      : byte
                     ) : boolean;
#doc
  Возможно ли формирование отчета в заданном периоде
#end
function IsCreatePeriod(_IDTaxReport : word;
                        _Version     : word;
                        _cPeriod     : comp;
                        _isMessage   : boolean
                        ) : boolean;
#doc
  Возможно ли формирование актуального отчета в заданном типе периода
#end
function IsActualCreatePeriod(_IDTaxReport : word;
                              _TPerEd      : byte
                              ) : boolean;


//==============================================================================
//                                  MODIFY
//------------------------------------------------------------------------------
#doc
   Заполнение таблицы налоговыми отчетами
     _isCheck - осуществлять проверку настройки обновления данных в БД
#end
function AddAllReportInTable(_isCheck : boolean) : longint;

//------------------------------------------------------------------------------
#doc
   Заполнение таблицы типами налоговых отчетов
#end
function AddAllTypeInTable : longint;

//------------------------------------------------------------------------------
#doc
   Выбор налоговых отчетов
#end
function RunViewTaxReport(
    _wIntMode : word;
    _title    : string;
var _RepID    : word;
var _RepVer   : word;
    _MID      : TPtr  // список выбранных записей
) : boolean;

End;

VipInterface ObjTaxReport implements iObjTaxReport
#Licensed_Free;
Public:
  constructor Init;
  destructor  Done;
End;
//******************************************************************************

#endif // _OTaxReport_Vih__
