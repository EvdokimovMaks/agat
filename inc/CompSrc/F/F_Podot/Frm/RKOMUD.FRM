//-----------------------------------------------------------------------------------
//                                                           (c) корпорация ГАЛАКТИКА
// Галактика 5.5 - Касса
// Печать реестра командировок
//-----------------------------------------------------------------------------------

#doc
Печать реестра командировок.
#end
.set name='RKomUd'
.nameinlist 'Базовая форма'
.hide
.fields
! фильтры
  strFilters
  FilterName
! информация о сотруднике
  Podr
  FIO
  TabNmb
! информация о приказе
  D_doc      : date
  N_Doc
  NomKU
  StateEtap
  CityEtap
  ADREtap
  SrokEtap
  OsnovEtap
  SodergEtap
  dStartEtap : date
  dEndEtap   : date
.endfields

strFilters ^ 
.{ CheckEnter FilterKomud
 FilterName ^
.}
.{ CheckEnter PrKomud
^ ^ ^
.{ CheckEnter PrEtapKomud
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.}
.endform
!
!
!
.linkform 'Реестр' prototype is 'RKomUd'
.group 'Реестр'
.fields
  CommonFormHeader
  strFilters
  FilterName
  FIO
  Podr
  D_doc
  N_Doc
  NomKU
  StateEtap
  CityEtap
  ADREtap
  SrokEtap
.endfields
^
 Й                            Реестр командировочных удостоверений Й
 И^
.{ CheckEnter FilterKomud
  ^
.}
─────────────────────────────────────────────────────┬─────────────────────────────────────────
            ФИО командированного сотрудника          │          Подразделение
──────────┬──────────┬──────────┬────────────────────┼───────────────────────────────────┬─────
   Дата   │  Номер   │   Номер  │    Страна/Город    │               Куда                │Срок
  приказа │ приказа  │    КУ    │                    │                                   │(дн.)
──────────┴──────────┴──────────┴────────────────────┴───────────────────────────────────┴─────
.{ CheckEnter PrKomud
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ CheckEnter PrEtapKomud
@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@
.}
  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .
.}
.endform



.linkform 'Пересечение командировок' prototype is 'RKomUd'
.group 'Пересечение командировок'
.fields
  CommonFormHeader
! фильтры
  strFilters
  FilterName
! информация о сотруднике
  TabNmb
  FIO
  Podr
! информация о приказе
  D_doc
  N_Doc
  StateEtap
  CityEtap
  ADREtap
  dStartEtap
  dEndEtap
.endfields
^
 Й                            Отчет о пересечении командировок Й
 И^
.{ CheckEnter FilterKomud
  ^
.}
 И──────────┬──────────────────────────────────────┬────────────────────────────────────────────
Таб.номер │    ФИО командированного сотрудника   │               Подразделение
──────────┼──────────┬───────────────────────────┼─────────────────────┬───────────┬──────────
   Дата   │  Номер   │       Страна/Город        │       Куда          │Дата начала│Дата конца
  приказа │ приказа  │                           │                     │           │
──────────┴──────────┴───────────────────────────┴─────────────────────┴───────────┴────────── И
.{ CheckEnter PrKomud
 И @@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
.{ CheckEnter PrEtapKomud
 И@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ И
.}
 И .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . И
.}
.endform
