//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - Спецоснастка
// Отчет об итоговых суммах проводок по документу
//------------------------------------------------------------------------------

#doc
Формирование отчета об итоговых суммах проводок по документу;
печатается из документов следующих типов: ввод в эксплуатацию,
внутреннее перемещение, акт переоценки, возврат из эксплуатации,
акт на списание, ведомость начисления износа, акт о списании
недостачи, акт об излишке.<br>
#end
.set name = 'MBP_SUMS'
.NameInList 'Базовая форма'
.hide
.fields
  DocNRec  : comp
  DocType  : string
  DocNom   : string
  DocDate  : date
.endfields
 Ссылка на документ - ^
 Тип документа - ^
 Номер документа - ^
 Дата документа - ^
----------------------------
.{ mbpObSums CheckEnter
.fields
  DateSum  : date
  Debet    : string
  Kredit   : string
  Summa    : double
.endfields
  Дата проводок - ^
  Счет/субсчет дебета - ^
  Счет/субсчет кредита - ^
  Сумма проводок - ^
.}
.endform

//------------------------------------------------------------------------------

.LinkForm 'MBP_SUMS_01' prototype is MBP_SUMS
.NameInList 'Итоговые суммы проводок по документу'
.fields
  CommonFormHeader
  DocType
  '№ ' + DocNom + ' от ' + DateToStr(DocDate,'DD/MM/YYYY')
.endfields
 ^

  @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ mbpObSums CheckEnter
.[h
┌──────────┬──────────────────────┬──────────────────────┬─────────────────┐
│   Дата   │         Дебет        │        Кредит        │      Сумма      │
│          │                      │                      │                 │
├──────────┼──────────────────────┼──────────────────────┼─────────────────┤
.]h
.fields
  DateSum
  Debet
  Kredit
  Summa
.endfields
│@~@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@│&#'&&&&&&&&&&&.&&│
.[f
└──────────┴──────────────────────┴──────────────────────┴─────────────────┘
.]f
.}
.endform
