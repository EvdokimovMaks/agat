//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецоснастка
// Акт об излишке спецоснастки
//------------------------------------------------------------------------------

#doc
Печать свободной формы Акта об излишке.<br>
#end
.Form 'Prih_MBP'
.Fields
  MoveRec : Comp
  dNom    : String
  dDate   : Date
  Podr    : String
  MOL     : String
  InRec    : Comp
  MBPName  : String
  MBPKod   : String
  MBPEd    : String
  MBPKol   : Double
  MBPPrice : Double
  MBPIznP  : Double
  MBPStoim : Double
.endFields
  ^  ^ ^ ^ ^
.{
  ^  ^ ^ ^ ^ ^ ^ ^
.}
.endForm

//-------------------------------------------------------------------------

.LinkForm 'Izl_MBP' prototype is 'Prih_MBP'
.NameInList 'Акт инвентаризации об излишке'
.Group 'Излишек'
.var
  totSum : Double
.endVar
.Fields
  CommonFormHeader
  dNom  DateToStr(dDate, 'DD/MM/YYYY')  Podr  MOL
  MBPName  MBPKod  MBPEd  MBPKol  MBPPrice
.endFields
 И ^

                            АКТ ИНВЕНТАРИЗАЦИИ ОБ ИЗЛИШКЕ
                             № ^ от ^

Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
МОЛ          : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.begin
  totSum := 0
end.
──────────────────────────────┬────────────┬───────────────┬──────────┬───────────────
           Название           │ Ном.номер  │Единица измерен│Количество│      Цена
──────────────────────────────┴────────────┴───────────────┴──────────┴───────────────
.{
.begin
  totSum := totSum + MBPKol * MBPPrice
end.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@ &&&&&&&.&& &'&&&&&&&&&&.&&
.}
──────────────────────────────────────────────────────────────────────────────────────

.Fields
  totSum
  DoubleToStr(totSum, '\2p\m4')+
    if (Pos('ноль', DoubleToStr(totSum, '\2p5')) <> 0, '',
      DoubleToStr(totSum, 'целых \2p5'))
.endFields
Сумма по акту: &'&&&&&&&&&&.&& руб.
     Прописью: ^
 И
.endForm

//-------------------------------------------------------------------------

.LinkForm 'Post_MBP' prototype is 'Prih_MBP'
.NameInList 'Документ на приход, поступление'
.Group 'Приход, поступление'
.var
  totSum : Double
.endVar
.Fields
  CommonFormHeader
  dNom  DateToStr(dDate, 'DD/MM/YYYY')  Podr  MOL
  MBPName  MBPKod  MBPEd  MBPKol  MBPPrice  MBPIznP  MBPStoim
  totSum
.endFields
 Р ^

                                      ДОКУМЕНТ НА ПРИХОД, ПОСТУПЛЕНИЕ
                                          № ^ от ^

Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
МОЛ          : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.begin
  totSum := 0;
end.

──────────────────────────────┬────────────┬─────────────┬──────────┬───────────────┬───────┬───────────────
         Наименование         │ Ном. номер │Ед. измерения│Количество│      Цена     │ Износ │  Стоимость
──────────────────────────────┴────────────┴─────────────┴──────────┴───────────────┴───────┴───────────────
.{
.begin
  totSum := totSum + MBPStoim
end.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@ &&&&&&.&&& &'&&&&&&&&&&.&& &&&&.&& &'&&&&&&&&&&.&&
.}
────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                     Итого:  &'&&&&&&&&&&.&& Р
.endForm

//-------------------------------------------------------------------------
