//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецоснастка
// Печать карточки учета спецоснастки
//------------------------------------------------------------------------------

#doc
Формирование разнообразных печатных форм по операциям в номенклатурной
карточке учета спецоснастки.<br>
#end
.set name = 'Cart_MBP'
.NameInList 'Базовая форма'
.hide
.fields
  NameOrg: string
  ОКПО: string
  PanelNum:word         // 01
  d1:date               // 02
  d2:date               // 03
  EksplMask:word        // 04
  HeadPrih:word         // 05
.endfields
  12345
^^^^^^^
.{fKatMbp CheckEnter
.fields
  MBPNRec:Comp          //
  MbpName:string        // 01
  MbpNum:string         // 02
  MbpEd:string          // 03
  MbpEdKod:string
  MbpGrKod:string       // 04
  MbpGrName:string      // 05
  MbpDopInf:string      // 06
  MbpDgr:string         // 07
.endfields
 123 45 67
^^^^^^^ ^^
.{fMbpIn CheckEnter
.fields
  InNRec:Comp           //
  InDate:date           // 01
  InState:word          // 02
  InPrice:double        // 03
  InPodr:string         // 04
  InMol:string          // 05
  InMolShort: String
  InPers:String
  InOrgFrom:string      // 06
  InPodrFrom:string     // 07
  InMolFrom:string      // 08
  InNumDoc:string       // 09
  InKolDoc:double       // 10
  InSumDoc:double       // 11
  InPrIsnNach:double    // 12
  InPrIsnPer:double     // 13
  InSumIsnNach:double   // 14
  InSumIsnPer:double    // 15
  InKolD1:double        // 16
  InSumD1:double        // 17
  InPrIsnD1:double      // 18
  InSumIsnD1:double     // 19
  InDopInf:string       // 20
  SklNum : String
  InvNum : String
  PasNum : String
  InEkspl:word          // 21
  InDateEksp:Date       // ??
  InKolD2:double        // 22
  InSumD2:double        // 23
  InPrIsnD2:double      // 24
  InSumIsnD2:double     // 25
  InOperTxt             // 26
.endfields
12345678901234567890123456
^^^^^^^^^ ^^^^^^^^^^^^^^^^ ^^^ ^^^ ^^
.{fMbpOut CheckEnter
.fields
  OutNRec:Comp          //
  OutDate:date          // 01
  OutState:word         // 02
  OutNumDoc:string      // 03
  OutKol:double         // 04
  OutSum:double         // 05
  OutPrIsn:double       // 06
  OutSumIsn:double      // 07
  OutKolTek:double      // 08
  OutSumTek:double      // 09
  OutPrIsnTek:double    // 10
  OutSumIsnTek:double   // 11
!  OutDopInf:string      // 12
!  OutWhy:string         // 13
  OutPodrTo:string      // 14
  OutMolTo:string       // 15
  OutPersTo:String
  OutOperTxt            // 16
  OutPrichKod
  OutPrichName
! Перевод в утиль
  USNRec   : Comp
  UDPodrF  : String
  UDEdName : String
  UDEdKod  : String
  USNormW  : Double
  USWeight : Double
  USNormP  : Double
  USStoim  : Double
.endfields

1234567890123456
^^^^^^^^^^^  ^^^  ^^^^ ^^^^^^^^
.}
.}
.}
.endform

!======================================================================================================================

.linkform 'Cart_MBP_01' prototype is Cart_MBP
.Group 'Карточки'
.NameInList 'КАРТОЧКА УЧЕТА'
.var
  MBPKolTek : double
  MBPSumTek : double
  MBPSumIsn : double
.endvar
.{fKatMbp CheckEnter
.begin
  MBPKolTek := 0.0;
  MBPSumTek := 0.0;
  MBPSumIsn := 0.0;
end.
.fields
  CommonFormHeader
  DateToStr(d1, 'DD/MM/YYYY')
  DateToStr(d2, 'DD/MM/YYYY')
  MbpName
  MbpNum
  MbpEd
  MbpDgr
.endfields
.{?Internal;(HeadPrih = 0)
 Б ^

                                   КАРТОЧКА УЧЕТА
                             c @@@@@@@@@@ по @@@@@@@@@@

Наименование:         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Номенклатурный номер: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Уч.единица измерения: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Наличие драгметаллов: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}
.{fMbpIn CheckEnter
.fields
  CommonFormHeader
  DateToStr(d1, 'DD/MM/YYYY')
  DateToStr(d2, 'DD/MM/YYYY')
  MbpName
  MbpNum
  MbpEd
  MbpDgr
.endfields
.{?Internal;(HeadPrih = 1)
 Б ^

                                  КАРТОЧКА ПРИХОДА
                             c @@@@@@@@@@ по @@@@@@@@@@

Наименование:         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Номенклатурный номер: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Уч.единица измерения: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Наличие драгметаллов: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}

.fields
  if (InEkspl = 1, 'в эксплуатации', 'на складе')
  InPrice
  InMol
  InPodr
.endfields
 БСостояние:@@@@@@@@@@@@@@@@@@@@@@@ Цена:&'&&&&&&&&.&&
МОЛ:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Подразделение:@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р──────────┬──────────┬────────────────────────────────────────────────────────────┬───────────┬────────────────┬────────────────
  Дата    │ Номер    │Наименование операции                                       │ Количество│ Первоначальная │ Сумма износа
 операции │ документа│                                                            │           │  стоимость     │
──────────┴──────────┴────────────────────────────────────────────────────────────┴───────────┴────────────────┴──────────────── Р
.fields
  DateToStr(InDate, 'DD/MM/YYYY')
  InNumDoc
  InOperTxt
  InKolDoc
  InSumDoc
  InSumIsnNach + InSumIsnPer
.endfields
 С@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'#&&&&&.&& &'#&&&&&&&&&&.&& &'#&&&&&&&&&&.&& С
.fields
  DateToStr(d1, 'DD/MM/YYYY')
  InKolD1
  InSumD1
  InSumIsnD1
.endfields
.{?Internal;(InDate < d1)
 С           Остаток на начало периода (@@@@@@@@@@):                                 &'#&&&&&.&& &'#&&&&&&&&&&.&& &'#&&&&&&&&&&.&& С
.}
 Р──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.{fMbpOut CheckEnter
.fields
  DateToStr(OutDate,'DD/MM/YYYY')
  OutNumDoc
  OutOperTxt
  OutKol
  OutSum
  if (OutState < 2, OutSumIsn, 0.0 - OutSumIsn)
.endfields
 Р@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'#&&&&&.&& &'#&&&&&&&&&&.&& &'#&&&&&&&&&&.&& Р
.}
.fields
  DateToStr(d2, 'DD/MM/YYYY')
  InKolD2
  InSumD2
  InSumIsnD2
.endfields
 Р────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б           Остаток на конец периода (@@@@@@@@@@):                                  &'&&&&&&.&& &'&&&&&&&&&&&.&& &'#&&&&&&&&&&.&& С

.begin
  MBPKolTek := MBPKolTek + InKolD2;
  MBPSumTek := MBPSumTek + InSumD2;
  MBPSumIsn := MBPSumIsn + InSumIsnD2;
end.
.{?Internal;(HeadPrih = 1)

.}
.}
.fields
  MBPKolTek
  MBPSumTek
  MBPSumIsn
.endfields
.{?Internal;(HeadPrih = 0)
 С
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
           Итого по карточке на конец периода:                                     &'&&&&&&.&& &'&&&&&&&&&&&.&& &'#&&&&&&&&&&.&&
════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ С

.}
.}
.endform

!======================================================================================================================

.linkform 'Cart_MBP_02' prototype is Cart_MBP
.Group 'Карточки'
.NameInList 'КАРТОЧКА УЧЕТА (С ТЕКУЩИМИ ОСТАТКАМИ)'
.var
  MBPKolTek : double
  MBPSumTek : double
  MBPSumIsn : double
.endvar
.{fKatMbp CheckEnter
.begin
  MBPKolTek := 0.0;
  MBPSumTek := 0.0;
  MBPSumIsn := 0.0;
end.
.fields
  CommonFormHeader
  DateToStr(d1, 'DD/MM/YYYY')
  DateToStr(d2, 'DD/MM/YYYY')
  MbpName
  MbpNum
  MbpEd
  MbpDgr
.endfields
.{?Internal;(HeadPrih = 0)
 Б ^
                                   КАРТОЧКА УЧЕТА
                             c @@@@@@@@@@ по @@@@@@@@@@

Наименование:         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Номенклатурный номер: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Уч.единица измерения: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Наличие драгметаллов: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}
.{fMbpIn CheckEnter
.fields
  CommonFormHeader
  DateToStr(d1, 'DD/MM/YYYY')
  DateToStr(d2, 'DD/MM/YYYY')
  MbpName
  MbpNum
  MbpEd
  MbpDgr
.endfields
.{?Internal;(HeadPrih = 1)
 Б ^
                                  КАРТОЧКА ПРИХОДА
                             c @@@@@@@@@@ по @@@@@@@@@@

Наименование:         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Номенклатурный номер: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Уч.единица измерения: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Наличие драгметаллов: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}


.fields
  if (InEkspl = 1, 'в эксплуатации', 'на складе')
  InPrice
  InMol
  InPodr
.endfields
 БСостояние:@@@@@@@@@@@@@@@@@@@@@@@ Цена:&'&&&&&&&&.&&
МОЛ:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Подразделение:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р──────────┬──────────┬────────────────────────────────────────────────────────────┬────────────────────────────────────────┬───────────────────────────────────────────────
          │          │                                                            │              По операции               │                 Текущие остатки
   Дата   │ Номер    │ Наименование операции                                      ├──────────┬──────────────┬──────────────┼──────────┬──────────────┬──────┬──────────────
 операции │ документа│                                                            │Количество│Перв.стоимость│ Сумма износа │Количество│Перв.стоимость│% изн.│ Сумма износа
──────────┴──────────┴────────────────────────────────────────────────────────────┴──────────┴──────────────┴──────────────┴──────────┴──────────────┴──────┴────────────── Р
.fields
  DateToStr(InDate, 'DD/MM/YYYY')
  InNumDoc
  InOperTxt
  InKolDoc
  InSumDoc
  InSumIsnNach
  InKolDoc
  InSumDoc
  InPrIsnNach + InPrIsnPer
  InSumIsnNach + InSumIsnPer
.endfields
 С@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'#&&&&.&& &'#&&&&&&&&.&& &'#&&&&&&&&.&& &'#&&&&.&& &'#&&&&&&&&.&& &#&.&& &'#&&&&&&&&.&& С
.fields
  DateToStr(d1, 'DD/MM/YYYY')
  InKolD1
  InSumD1
  InPrIsnD1
  InSumIsnD1
.endfields
.{?Internal;(InDate < d1)
 С           Остаток на начало периода (@@@@@@@@@@):                                                                          &'#&&&&.&& &'#&&&&&&&&.&& &#&.&& &'#&&&&&&&&.&& С
.}
 Р─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.{fMbpOut CheckEnter
.fields
  DateToStr(OutDate, 'DD/MM/YYYY')
  OutNumDoc
  OutOperTxt
  OutKol
  OutSum
  if (OutState < 2, OutSumIsn, 0.0 - OutSumIsn)
  OutKolTek - OutKol
  OutSumTek - OutSum
  OutPrIsn + OutPrIsnTek
  if (OutState < 2, OutSumIsnTek + OutSumIsn, OutSumIsnTek - OutSumIsn)
.endfields
 Р@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'#&&&&.&& &'#&&&&&&&&.&& &'#&&&&&&&&.&& &'#&&&&.&& &'#&&&&&&&&.&& &#&.&& &'#&&&&&&&&.&& Р
.}
.begin
  MBPKolTek := MBPKolTek + InKolD2;
  MBPSumTek := MBPSumTek + InSumD2;
  MBPSumIsn := MBPSumIsn + InSumIsnD2;
end.
.{?Internal;(HeadPrih = 1)

.}
.}
.fields
  DateToStr(d2, 'DD/MM/YYYY')
  MBPKolTek
  MBPSumTek
  if (Abs(MBPSumTek) < 0.001, 0.0, 100.0*MBPSumIsn/MBPSumTek)
  MBPSumIsn
.endfields
.{?Internal;(HeadPrih = 0)
 С

───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
            Итого по карточке на конец периода (@@@@@@@@@@):                                                                &'&&&&&.&& &'&&&&&&&&&.&& &#&.&& &'#&&&&&&&&.&&
═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ С

.}
.}
.endform

!======================================================================================================================

.linkform 'Cart_MBP_03' prototype is Cart_MBP
.Group 'Документы по приходам'
.Group 'Документы по приходам. Россия.'
.NameInList 'ПРИХОДНЫЙ ОРДЕР (БЕЗ ИЗНОСА)'
.fields
  CommonFormHeader
  InNumDoc
  InDate
  MbpName
  MbpNum
  InPodr
  InMOL
  InOperTxt
.endfields
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
^

   ПРИХОДНЫЙ ОРДЕР №  ^
                   от ^

Наименование:  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Номенклатурный номер: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
МОЛ          : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{?Internal;(InState <> 1)
Примечание: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.fields
  InPrice   InKolDoc   MBPEd
  if (wGetTune('Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc - (InSumIsnPer + InSumIsnNach))
.endfields

            Цена    Количество  Единица            Стоимость
&'&&&&&&&&&&&&&.&& &'&&&&&&&.&& @@@@@@@@@@@ &'&&&&&&&&&&&&&.&&


                                   ____________________




.{fMbpOut CheckEnter
.}
.}
.}
.endform

!======================================================================================================================

.linkform 'Cart_MBP_04' prototype is Cart_MBP
.Group 'Документы по приходам'
.Group 'Документы по приходам. Россия.'
.NameInList 'ПРИХОДНЫЙ ОРДЕР (C ИЗНОСОМ)'
.fields
  CommonFormHeader
  InNumDoc
  InDate
  MbpName
  MbpNum
  InPodr
  InMOL
  InOperTxt
.endfields
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
^

   ПРИХОДНЫЙ ОРДЕР №  ^
                   от ^

Наименование:  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Номенклатурный номер: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
МОЛ          : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{?Internal;(InState <> 1)
Примечание: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.fields
  InPrice  InKolDoc   MbpEd
  if (wGetTune('Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc - (InSumIsnPer + InSumIsnNach))
.endfields

           Цена     Количество  Единица             Стоимость
&'&&&&&&&&&&&&&.&& &'&&&&&&&.&& @@@@@@@@@@@ &'&&&&&&&&&&&&&.&&
.fields
                                InPrIsnPer       InSumIsnPer
                                InPrIsnNach      InSumIsnNach
                     InPrIsnNach+InPrIsnPer InSumIsnNach+InSumIsnPer
.endfields

                                 % износа     Сумма износа
                     Передано:     &#&.&& &'#&&&&&&&&&&&&.&&
                     Начислено:    &#&.&& &'#&&&&&&&&&&&&.&&
                    ────────────────────────────────────────
                     Итого износ:  &&&.&& &'&&&&&&&&&&&&&.&&


                                   ____________________




.{fMbpOut CheckEnter
.}
.}
.}
.endform

!======================================================================================================================

.linkform 'Cart_MBP_06' prototype is Cart_MBP
.NameInList 'РАСХОДНЫЙ ОРДЕР (БЕЗ ИЗНОСА)'
.Group 'Документы по расходам'
.Group 'Документы по расходам. Россия.'
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
.{fMbpOut CheckEnter
.fields
  CommonFormHeader
  OutNumDoc
  OutDate
  MbpName
  MbpNum
  InPodr
  InMOL
  OutOperTxt
.endfields
.{?Internal;(OutState >= 2)
^

   РАСХОДНЫЙ ОРДЕР №  ^
                   от ^

Наименование:  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Номенклатурный номер: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
МОЛ: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.{?Internal;(OutState = 2)
Примечание: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.{?Internal;(OutState >= 2) // Вызывается только для операций количественного расхода
.fields
  InPrice   OutKol   MbpEd
  if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn)
.endfields

            Цена     Количество Единица            Стоимость
&'&&&&&&&&&&&&&.&& &'&&&&&&&.&& @@@@@@@@@@@ &'&&&&&&&&&&&&&.&&


                                   ____________________




.}
.}
.}
.}
.endform

!======================================================================================================================

.linkform 'Cart_MBP_07' prototype is Cart_MBP
.NameInList 'РАСХОДНЫЙ ОРДЕР (С ИЗНОСОМ), СПРАВКА О НАЧИСЛЕНИИ ИЗНОСА'
.Group 'Документы по расходам'
.Group 'Документы по расходам. Россия.'
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
.{fMbpOut CheckEnter
.fields
  CommonFormHeader
  OutNumDoc
  OutDate
  MbpName
  MbpNum
  InPodr
  InMOL
  OutOperTxt
.endfields
.{?Internal;(OutState>=2)
^

   РАСХОДНЫЙ ОРДЕР №  ^
                   от ^

Наименование:  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Номенклатурный номер: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
МОЛ: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.{?Internal;(OutState = 2)
Примечание: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.{?Internal;(OutState >= 2)

.fields
  InPrice   OutKol   MbpEd
  if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn)
.endfields

            Цена    Количество  Единица            Стоимость
&'&&&&&&&&&&&&&.&& &'&&&&&&&.&& @@@@@@@@@@@ &'&&&&&&&&&&&&&.&&
.fields
                                OutPrIsnTek  OutSumIsn
.endfields

Ранее начисленный износ,                %       Сумма износа
приходящийся на уходящий:            &&&.&& &'&&&&&&&&&&&&&.&&


                                   ____________________




.}
.{?Internal;(OutState < 2)
.fields
  CommonFormHeader
  OutNumDoc
  OutDate
  MbpName
  MbpNum
  InPodr
  InMOL
.endfields
^

   СПРАВКА О НАЧИСЛЕНИИ ИЗНОСА №  ^
                               от ^

Наименование:  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Номенклатурный номер: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
МОЛ: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.fields
  InPrice   OutKolTek   MbpEd
  if (wGetTune('Fin.MBP.OstStoim') = 0, OutSumTek, OutSumTek - OutSumIsnTek)
.endfields

           Цена    Количество Единица           Стоимость
&'&&&&&&&&&&&&&.&& &'&&&&&.&& @@@@@@@@@@@ &'&&&&&&&&&&&&&.&&

.fields
                              OutPrIsnTek  OutSumIsnTek
                                 OutPrIsn     OutSumIsn
                      OutPrIsnTek+OutPrIsn  OutSumIsnTek+OutSumIsn
.endfields
                                  % износа   Сумма износа
                     Было:         &#&.&& &'#&&&&&&&&&&&&.&&
                     Начислено:    &#&.&& &'#&&&&&&&&&&&&.&&
                    ────────────────────────────────────────
                     Итого износ:  &#&.&& &'#&&&&&&&&&&&&.&&


                                   ____________________




.}
.}
.}
.}
.endform

!======================================================================================================================

.linkform 'Cart_MBP_08' prototype is Cart_MBP
.Group 'Документы по расходам'
.NameInList 'Акт на списание (форма № МБ-8)'
.var
  Cnt : LongInt
  TotCnt : Double
  TotSum : Double
  TotIsn : Double
.endvar
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
.{fMbpOut CheckEnter
.fields
 CommonFormHeader
 OutNumDoc
 DateToStr(OutDate,'DD')
 DateToStr(OutDate,'Mon')
 DateToStr(OutDate,'YYYY')
 InPodr
.endfields
.begin
 Cnt := 0;
 TotCnt := 0;
 TotSum := 0;
 TotIsn := 0;
end.
 ^
                                                     УТВЕРЖДАЮ:
                                         ______________________________
                                                   должность
                                         ____________   _______________
                                            подпись      И.,О.,фамилия

                                            "___"______________20___г.


                            А К Т   №  Б@@@@@@@@@@@@@@@ Б

        АКТ НА СПИСАНИЕ МАЛОЦЕННЫХ И БЫСТРОИЗНАШИВАЮЩИХСЯ ПРЕДМЕТОВ
                               " Б^ Б"  Б^ Б  Б^ Бг.
 Р  Комиссия, назначенная приказом от "____"_______________20___г.  №________, осмотрела принятые
  за ________________20___г. находившиеся в эксплуатации  малоценные и быстроизнашивающиеся пред-
  меты и признала их пришедшими в негодность и подлежащими сдаче в утиль.
               ┌──────────────────┬────────────────────────────┬────────────────────┬─────────────────────────────────┐
               │                  │                            │                    │       Корреспондирующий счет    │
               │   Вид операции   │    Цех (отдел), участок    │      Кладовая      ├────────────────┬────────────────┤
               │                  │                            │                    │ счет, субсчет  │код аналит.учета│
               ├──────────────────┼────────────────────────────┼────────────────────┼────────────────┼────────────────┤
               │                  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                    │                │                │
┌─────────────────────────────────────┬──────┬──────────┬───────┬───────────┬──────────────┬──────────────────────────┐
│              Предмет                │      │   Дата   │       │           │              │      Причина списания    │
├───┬──────────────────────┬──────────┤Един. │ поступл. │ Коли- │           │              ├───────┬──────────────────┤
│ № │     Наименование     │Номенклат.│измер.│ в эксп-  │ чест- │    Цена   │    Сумма     │  Код  │   Наименование   │
│п/п│                      │  номер   │      │ луатацию │  во   │           │              │       │                  │
├───┼──────────────────────┼──────────┼──────┼──────────┼───────┼───────────┼──────────────┼───────┼──────────────────┤
.begin
 Cnt := Cnt + 1;
 TotCnt := TotCnt + OutKol;
 TotSum := TotSum + OutSum;
 TotIsn := TotIsn + OutSumIsn;
end.
.fields
  Cnt
  MBPName
  MBPNum
  MBPEd
  DateToStr(InDateEksp, 'DD/MM/YYYY')
  OutKol
  InPrice
  if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn)
  OutPrichKod
  OutPrichName
.endfields
│&&.│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@│@@@@@@@@@@│&&&&.&&│&&&&&&&&.&&│&&&&&&&&&&&.&&│@@@@@@@│@@@@@@@@@@@@@@@@@@│
└───┴──────────────────────┴──────────┴──────┴──────────┴───────┴───────────┴──────────────┴───────┴──────────────────┘
.fields
  TotCnt
  if (wGetTune('Fin.MBP.OstStoim') = 0, TotSum, TotSum - TotIsn)
  DoubleToStr(TotCnt, '\2p\m4')+
    if (Pos('ноль', DoubleToStr(TotCnt, '\2p5')) <> 0, '', DoubleToStr(TotCnt, 'целых \2p5'))
.endfields

 Б  Итого :                                                &&&&.&&   на сумму  &&&&&&&&&&&.&&

    @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ С
 Р  ───────────────────────────────────────────────────────────────────────────────────────────────────
                                 общее количество предметов прописью

  Номера и даты актов выбытия________________________________________________________________________
  ___________________________________________________________________________________________________
  Перечисленные в настоящем акте предметы в присутствии комиссии превращены в утиль, который подлежит
  оприходованию:
.{?Internal;(USNRec = 0);
  ┌────────────────────────────────┬──────────────┬───────┬────────────┬─────────────┬──────────────┐
  │            Утиль               │Един.измерения│ Коли- │            │             │  Порядковый  │
  ├───────────────────┬────────────┼────────┬─────┤ чест- │    Цена    │    Сумма    │ номер записи │
  │   Наименование    │код (номенк-│наимено-│ код │  во   │            │             │ по складской │
  │                   │лат. номер) │ вание  │     │       │            │             │  картотеке   │
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  │         1         │     2      │   3    │  3  │   4   │     5      │      6      │      7       │
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  └───────────────────┴────────────┴────────┴─────┴───────┴────────────┴─────────────┴──────────────┘
.}
.{?Internal;(USNRec <> 0);
.fields
  MBPName
  MBPNum
  UDEdName
  UDEdKod
  USWeight
  USNormP
  USStoim
.endfields
  ┌────────────────────────────────┬──────────────┬───────┬────────────┬─────────────┬──────────────┐
  │            Утиль               │Един.измерения│ Коли- │            │             │  Порядковый  │
  ├───────────────────┬────────────┼────────┬─────┤ чест- │    Цена    │    Сумма    │ номер записи │
  │   Наименование    │код (номенк-│наимено-│ код │  во   │            │             │ по складской │
  │                   │лат. номер) │ вание  │     │       │            │             │  картотеке   │
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  │         1         │     2      │   3    │  3  │   4   │     5      │      6      │      7       │
  ├───────────────────┼────────────┼────────┼─────┼───────┼────────────┼─────────────┼──────────────┤
  │@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│@@@@@@@@│@@@@@│&&&&.&&│&&&&&&&&&.&&│&&&&&&&&&&.&&│              │
  └───────────────────┴────────────┴────────┴─────┴───────┴────────────┴─────────────┴──────────────┘
.}
   Утиль, не подлежащий учету, уничтожен.
   Председатель комиссии ________________________  ________________________  ________________________
                                 должность                  подпись               и., о., фамилия
         Члены комиссии: ________________________  ________________________  ________________________
                                 должность                  подпись               и., о., фамилия
                         ________________________  ________________________  ________________________
                                 должность                  подпись               и., о., фамилия
                         ________________________  ________________________  ________________________
                                 должность                  подпись               и., о., фамилия
 Р
   Утиль по накладной №  ___________________сдан.

   "_____"_______________20___г.
.}
.}
.}
.endform

!======================================================================================================================

.linkform 'Cart_MBP_09' prototype is 'Cart_MBP'
.Group 'Документы по расходам. Россия.'
.NameInList 'Акт на списание (форма № МБ-8)'
.f "MBPSPAKT.OUT"
.defo Landscape
.p 50
.var
  TotCnt : Double
  TotSum : Double
  TotIzn : Double
.endvar
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
.{fMbpOut CheckEnter
.fields
 CommonFormHeader
 OutNumDoc  NameOrg  ОКПО
 InPodr
 DateToStr(OutDate, 'DD/MM/YYYY')
 InPodr
.endfields
.begin
 TotCnt := 0;
 TotSum := 0;
 TotIzn := 0;
end.
 Р ^
                                                                                                                                       Типовая межотраслевая форма № МБ-8
                                                                                                                                       Утверждена постановлением Госкомстата России
                                                                                                                                       от 30.10.97 № 71а

                                                                                                                                                   УТВЕРЖДАЮ:
                                                                                                                                                ________________
                                               БАКТ №  Д@@@@@@@@@@ Е                                                                                     должность
                               Бна списание малоценных и быстроизнашивающихся Б                                                                ____________   ___________________
                                                  Бпредметов Б                                                                                    подпись     расшифровка подписи

                                                                                                                                     "___"______________20___г.
                                                                                                                                                                      ┌────────────┐
                                                                                                                                                                      │    Коды    │
                                                                                                                                                                      ├────────────┤
                                                                                                                                                        Форма по ОКУД │  0320004   │
                                                                                                                                                                      ├────────────┤
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                     по ОКПО │@~@@@@@@@@@@│
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                             └────────────┘
                                                                                   ┌──────────┬──────────┬─────────────────────────────┬────────────────┬──────────────────────────┐
                                                                                   │   Дата   │   Код    │          Cтруктурное        │      Вид       │  Корреспондирующий счет  │
                                                                                   │  состав- │   вида   │         подразделение       │  деятельности  ├─────────┬────────────────┤
                                                                                   │   ления  │ операции │                             │                │  счет,  │  код аналити-  │
                                                                                   │          │          │                             │                │ субсчет │ ческого учета  │
                                                                                   ├──────────┼──────────┼─────────────────────────────┼────────────────┼─────────┼────────────────┤
                                                                                    Б│@@@@@@@@@@│          │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                │         │                │
                                                                                   └──────────┴──────────┴─────────────────────────────┴────────────────┴─────────┴────────────────┘ Б
 Комиссия, назначенная приказом от "  "__________20   г. №______ осмотрела принятые за _______________ 20   г., находившиеся в
 эксплуатации малоценные и быстроизнашивающиеся предметы и признала их пришедшими в негодность и подлежащими сдаче в утиль (лом)
┌────────────────────────────────────────────┬───────────────────┬────────┬──────────┬──────────────┬───────────────────────────┬──────┬──────────────────────────┬────────────────┐
│                    Предмет                 │ Единица измерения │        │          │              │      Сумма, руб. коп.     │      │      Причина списания    │                │
├───────────────────┬────────────┬───────────┼─────┬─────────────┤        │   Дата   │              ├─────────────┬─────────────┤      ├────────────────┬─────────┤                │
│   Наименование    │Номенклатур-│ Инвентар- │ Код │ Наименование│  Коли- │ поступле-│     Цена     │  Без учета  │   Аморти-   │ Срок │                │         │ Номер паспорта │
│                   │ ный номер  │ ный номер │     │             │ чество │   ния    │   руб.коп.   │     НДС     │   зации     │службы│  Наименование  │   Код   │                │
├───────────────────┼────────────┼───────────┼─────┼─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼────────────────┼─────────┼────────────────┤
│         1         │     2      │     3     │  4  │      5      │   6    │    7     │      8       │      9      │     10      │  11  │       12       │   13    │       14       │
├───────────────────┼────────────┼───────────┼─────┼─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼────────────────┼─────────┼────────────────┤
.begin
 TotCnt := TotCnt + OutKol;
 TotSum := TotSum + OutSum;
 TotIzn := TotIzn + OutSumIsn;
end.
.fields
 MBPName  MBPNum  InvNum
 MBPEdKod  MBPEd  OutKol  if (LongInt(InDateEksp) > 0, DateToStr(InDateEksp, 'DD/MM/YYYY'), '')
 InPrice  if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn)
 OutSumIsn  OutPrichName  OutPrichKod  PasNum
.endfields
│@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@│@@@@@@@@@@@@@│&&&&&.&&│&&&&&&&&&&│&'&&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│      │@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@@│
.fields
  TotCnt  if ( wGetTune( 'Fin.MBP.OstStoim') = 0, TotSum, TotSum- TotIzn)  TotIzn
  DoubleToStr( TotCnt, '\2p\m4')+
    if ( Pos( 'ноль', DoubleToStr( TotCnt, '\2p5')) <> 0, '', DoubleToStr( TotCnt, 'целых \2p5'))
.endfields
└───────────────────┴────────────┴───────────┴─────┴─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┴────────────────┴─────────┴────────────────┘
                                                           БИтого  │&#&&&.&&│    X     │      X       │&'#&&&&&&&.&&│&'#&&&&&&&.&&│
                                                                 └────────┴──────────┴──────────────┴─────────────┴─────────────┘ Б
 Общее количество предметов   Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                               прописью
.fields
  'true' : 's'
.endFields
^                                                                                                                                                    Оборотная сторона формы № МБ-8
┌────────────────────────────────────────────┬───────────────────┬────────┬──────────┬──────────────┬───────────────────────────┬──────┬──────────────────────────┬────────────────┐
│                    Предмет                 │ Единица измерения │        │          │              │      Сумма, руб. коп.     │      │      Причина списания    │                │
├───────────────────┬────────────┬───────────┼─────┬─────────────┤        │   Дата   │              ├─────────────┬─────────────┤      ├────────────────┬─────────┤                │
│   Наименование    │Номенклатур-│ Инвентар- │ Код │ Наименование│  Коли- │ поступле-│     Цена     │  Без учета  │   Аморти-   │ Срок │                │         │ Номер паспорта │
│                   │ ный номер  │ ный номер │     │             │ чество │   ния    │   руб.коп.   │     НДС     │   зации     │службы│  Наименование  │   Код   │                │
├───────────────────┼────────────┼───────────┼─────┼─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼────────────────┼─────────┼────────────────┤
│         1         │     2      │     3     │  4  │      5      │   6    │    7     │      8       │      9      │     10      │  11  │       12       │   13    │       14       │
├───────────────────┼────────────┼───────────┼─────┼─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼────────────────┼─────────┼────────────────┤
├───────────────────┼────────────┼───────────┼─────┼─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼────────────────┼─────────┼────────────────┤
├───────────────────┼────────────┼───────────┼─────┼─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼────────────────┼─────────┼────────────────┤
└───────────────────┴────────────┴───────────┴─────┴─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┴────────────────┴─────────┴────────────────┘
                                                           БИтого  │        │    X     │      X       │             │             │
                                                                 └────────┴──────────┴──────────────┴─────────────┴─────────────┘ Б
 Общее количество предметов  ________________________________________________________________________________________________________________________
                                                                               прописью
 Номера и даты актов выбытия_______________________________________________________________________________________________________________________________________________________

 Перечисленные в настоящем акте в присутствии комиссии превращены в утиль (лом), который подлежит оприходованию:
.{?Internal;(USNRec = 0);
┌──────────┬──────────────┬────────────────────────┬─────────────────────────────────────┬───────────────────┬────────────┬───────────────────┬───────────────────┬────────────────┐
│          │              │                        │              Утиль (лом)            │ Единица измерения │            │                   │                   │   Порядковый   │
│ Код вида │     Вид      │      Структурное       ├──────────────────────┬──────────────┼─────────────┬─────┤ Количество │       Цена,       │      Сумма,       │  номер записи  │
│ операции │ деятельности │     подразделение      │     Наименование     │ Номенклатур- │ Наименование│ Код │            │     руб. коп.     │     руб. коп.     │  по складской  │
│          │              │                        │                      │  ный номер   │             │     │            │                   │                   │   картотеке    │
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
│    1     │      2       │           3            │           4          │       5      │      6      │  7  │      8     │         9         │        10         │       11       │
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
└──────────┴──────────────┴────────────────────────┴──────────────────────┴──────────────┴─────────────┴─────┼────────────┼───────────────────┼───────────────────┼────────────────┘
 Утиль, не подлежащий учету, уничтожен.                                                                 БИтого │            │                   │                   │
                                                                                                             └────────────┴───────────────────┴───────────────────┘ Б
.}
.{?Internal;(USNRec <> 0);
.fields
  UDPodrF
  MBPName
  MBPNum
  UDEdName
  UDEdKod
  USWeight
  USNormP
  USStoim
  USNormP
  USStoim
.endfields
┌──────────┬──────────────┬────────────────────────┬─────────────────────────────────────┬───────────────────┬────────────┬───────────────────┬───────────────────┬────────────────┐
│          │              │                        │              Утиль (лом)            │ Единица измерения │            │                   │                   │   Порядковый   │
│ Код вида │     Вид      │      Структурное       ├──────────────────────┬──────────────┼─────────────┬─────┤ Количество │       Цена,       │      Сумма,       │  номер записи  │
│ операции │ деятельности │     подразделение      │     Наименование     │ Номенклатур- │ Наименование│ Код │            │     руб. коп.     │     руб. коп.     │  по складской  │
│          │              │                        │                      │  ный номер   │             │     │            │                   │                   │   картотеке    │
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
│    1     │      2       │           3            │           4          │       5      │      6      │  7  │      8     │         9         │        10         │       11       │
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
│          │              │@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@@@@@@@@@@@│@@@@@│&&&&&&&&&.&&│&&&&&&&&&&&&&&&&.&&│&&&&&&&&&&&&&&&&.&&│                │
└──────────┴──────────────┴────────────────────────┴──────────────────────┴──────────────┴─────────────┴─────┼────────────┼───────────────────┼───────────────────┼────────────────┘
 Утиль, не подлежащий учету, уничтожен.                                                                 БИтого │&&&&&&&&&.&&│                   │&&&&&&&&&&&&&&&&.&&│
                                                                                                             └────────────┴───────────────────┴───────────────────┘ Б
.}
  Председатель комиссии        ___________________     ___________________     _________________________
                                    должность                подпись              расшифровка подписи
  Члены комиссии:              ___________________     ___________________     _________________________
                                    должность                подпись              расшифровка подписи
                               ___________________     ___________________     _________________________
                                    должность                подпись              расшифровка подписи
                               ___________________     ___________________     _________________________
                                    должность                подпись              расшифровка подписи

  Утиль (лом) по накладной №  ____________________ сдан
    "  " ____________ 20   г.
.}
.}
.}
 Р А
.endform


#include cart_mbp.frn
