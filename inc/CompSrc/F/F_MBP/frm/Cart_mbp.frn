
.linkform 'Cart_MBP_031' prototype is Cart_MBP
.Group 'Документы по приходам. Россия.'
.NameInList 'Форма № M-11'
.f "MBPInM_11.OUT"
.DEFP PA4
.PAPER PA4
.P 38
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  Затребовал_ФИО, Разрешил_ФИО : string;
.endvar
.begin
  Затребовал_ФИО := '';
  Разрешил_ФИО := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(2, 'Requested'))
      Затребовал_ФИО := iFeeSigners.GetSignerFIO(1);

    if (iFeeSigners.RestrictFeeByRole(2, 'Allowed'))
      Разрешил_ФИО := iFeeSigners.GetSignerFIO(1);

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
 CommonFormHeader
 InNumDoc
 NameOrg
 ОКПО
 DateToStr(InDate,'DD/MM/YYYY')
 InPodrFrom
 InPodr
 InMOLFrom
 if (Trim(Затребовал_ФИО) <> '', Затребовал_ФИО, if (Trim(InPers) <> '', InPers, InMol))
 if (Trim(Разрешил_ФИО) <> '', Разрешил_ФИО, InMOLFrom)

 MbpName  MbpNum  MbpEdKod  MbpEd  Double(0)  InKolDoc  InPrice
 if (wGetTune('Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc - (InSumIsnPer + InSumIsnNach))
 SklNum

 InMolFrom  if (Trim(InPers) <> '', InPers, InMolShort)
.endFields
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
#include MBP_M11CR.frn
.{fMbpOut CheckEnter
.}
.}
.}
.endform

! =======================================================================================================

.linkform 'Cart_MBP_032' prototype is Cart_MBP
.Group 'Документы по приходам'
.NameInList 'Форма № M-11'
.f "MBPInM11.OUT"
.Defo Landscape
.p 54
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  Разрешил_ФИО : string;
.endvar
.begin
  Разрешил_ФИО := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(2, 'Allowed'))
      Разрешил_ФИО := iFeeSigners.GetSignerFIO(1);

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
 CommonFormHeader
 NameOrg
 InNumDoc
 DateToStr(InDate, 'DD/MM/YYYY')

 if (Trim(InPers) <> '', InPers, if (InMOL = '', InPodr, InMOL))
 if (InMOLFrom = '', InPodrFrom, InMolFrom)

 MbpName  MbpNum  MbpEdKod  MbpEd  Double(0) InKolDoc  InPrice
 if (wGetTune('Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc - (InSumIsnPer + InSumIsnNach))
 InvNum  PasNum  SklNum

 if (wGetTune('Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc - (InSumIsnPer + InSumIsnNach))
 DoubleToStr(1,'\m4')
 DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc - (InSumIsnPer + InSumIsnNach)), '\2p\m4')

 if (Pos('ноль', DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc - (InSumIsnPer + InSumIsnNach)), '\2p5')) <> 0,
 '=', DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc - (InSumIsnPer + InSumIsnNach)), '\2p88'))

 '/' + Разрешил_ФИО + '/'
 '/' + InMolFrom + '/'
 '/' + InMolShort + '/'
.endFields
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
#include MBP_M11CP.frn
.{fMbpOut CheckEnter
.}
.}
.}
.endform

! =======================================================================================================

.linkform 'Cart_MBP_033' prototype is Cart_MBP
.Group 'Документы по приходам'
.NameInList 'Форма № M-13'
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  Разрешил_ФИО : string;
.endvar
.begin
  Разрешил_ФИО := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(2, 'Allowed'))
      Разрешил_ФИО := iFeeSigners.GetSignerFIO(1);

    iFeeSigners.ClearRestriction;
  }
end.
.fields
 CommonFormHeader
 NameOrg
 InNumDoc
 DateToStr(InDate,'"DD" mon YYYYг.')
 InPodr
.endfields
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
 Р ^
                                                                                            Типовая межведомственная форма № М-13
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д                                       Утверждена приказом ЦСУ СССР от 14.12.72 № 816
                предприятие, организация                                                                             ┌───────────┐
                                                                                                         Код по ОКУД │ 0303010 2 │
                                                                                                                     └───────────┘
 Р
 И                               НАКЛАДНАЯ №  Б^ Б
                   на внутреннее перемещение материалов
                               Б^ Б
 И
 Р                                                    ┌──────────────┬────────────────────────────────┬───────────────────────────────┐
                                                    │ Вид операции │ Цех, объект, склад-отправитель │ Цех, объект, склад-получатель │
                                                    ├──────────────┼────────────────────────────────┼───────────────────────────────┤
 Б                                                    │              │                                │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ Б
                                                    └──────────────┴────────────────────────────────┴───────────────────────────────┘
┌────────────────┬───────────────────────────────────────┬─────────────┬───────────────────┬──────────────┬───────────────┬─────────┐
│  Корреспонди-  │               Материалы               │   Единицы   │    Количество     │     Цена     │     Сумма     │Порядко- │
│  рующий счет   │                                       │  измерения  │                   │              │               │вый номер│
├─────┬──────────┼───────────────────────────┬───────────┼─────┬───────┼─────────┬─────────┼──────────────┼───────────────┤записи по│
│счет,│ код ана- │    наименование, сорт,    │код(номен- │ код │ наиме-│ отправ- │ принято │              │               │складской│
│суб- │ литичес- │       размер, марка       │клатурный  │     │нование│  лено   │         │              │               │картотеке│
│счет │кого учета│                           │  номер)   │     │       │         │         │              │               │         │
├─────┼──────────┼───────────────────────────┼───────────┼─────┼───────┼─────────┼─────────┼──────────────┼───────────────┼─────────┤
│  1  │    2     │             3             │     4     │  5  │   6   │    7    │    8    │       9      │      10       │   11    │
├─────┼──────────┼───────────────────────────┼───────────┼─────┼───────┼─────────┼─────────┼──────────────┼───────────────┼─────────┤
.fields
 MbpName
 MbpNum
 MbpEdKod
 MbpEd: 'D:R'
 InKolDoc
 InPrice
 if ( wGetTune( 'Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc- (InSumIsnPer+ InSumIsnNach))
 SklNum
.endfields
│     │          │@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@│@@@@@@@│&&&&&&.&&│         │&&&&&&&&&&&.&&│&&&&&&&&&&&&.&&│@@@@@@@@@│
└─────┴──────────┴───────────────────────────┴───────────┴─────┴───────┴─────────┴─────────┴──────────────┴───────────────┴─────────┘
.fields
 if (wGetTune('Fin.MBP.OstStoim') = 0, InSumDoc, InSumDoc - (InSumIsnPer + InSumIsnNach))
 '/' + Разрешил_ФИО + '/'
 '/' + InMol + '/'
.endfields
 Б                                                                                                   Итого:  &&&&&&&&&&&&.&& Б

 Разрешил __________________________________ Сдал __________________________________ Принял __________________________________
 Б          @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б Р

.{fMbpOut CheckEnter
.}
.}
.}
.endform

! =======================================================================================================

.linkform 'Cart_MBP_061' prototype is Cart_MBP
.Group 'Документы по расходам. Россия.'
.NameInList 'Форма № M-11'
.f "MBPOutM_11.OUT"
.DEFP PA4
.PAPER PA4
.P 38
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  Затребовал_ФИО, Разрешил_ФИО : string;
.endvar
.begin
  Затребовал_ФИО := '';
  Разрешил_ФИО := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(2, 'Requested'))
      Затребовал_ФИО := iFeeSigners.GetSignerFIO(1);

    if (iFeeSigners.RestrictFeeByRole(2, 'Allowed'))
      Разрешил_ФИО := iFeeSigners.GetSignerFIO(1);

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
 CommonFormHeader
 OutNumDoc
 NameOrg
 ОКПО
 DateToStr(OutDate,'DD/MM/YYYY')
 InPodr
 OutPodrTo
 InMol
 if (Trim(Затребовал_ФИО) <> '', Затребовал_ФИО, if (Trim(OutPersTo) <> '', OutPersTo, OutMolTo))
 if (Trim(Разрешил_ФИО) <> '', Разрешил_ФИО, InMol)

 MbpName  MbpNum  MbpEdKod  MbpEd  Double(0)  OutKol  InPrice
 if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn)
 SklNum

 InMolShort  if (Trim(OutPersTo) <> '', OutPersTo, OutMolTo)
.endfields
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
.{fMbpOut CheckEnter
#include MBP_M11CR.frn
.}
.}
.}
.endform

! =======================================================================================================

.linkform 'Cart_MBP_062' prototype is Cart_MBP
.Group 'Документы по расходам'
.NameInList 'Форма № M-11'
.f "MBPOtM11.OUT"
.defo Landscape
.p 54
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  Разрешил_ФИО : string;
.endvar
.begin
  Разрешил_ФИО := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(2, 'Allowed'))
      Разрешил_ФИО := iFeeSigners.GetSignerFIO(1);

    iFeeSigners.ClearRestriction;
  }
end.
.fields
 CommonFormHeader
 NameOrg
 OutNumDoc
 DateToStr(OutDate,'DD/MM/YYYY')

 if (Trim(OutPersTo) <> '', OutPersTo, if (OutMolTo = '', OutPodrTo, OutMolTo))
 if (InMol = '', InPodr, InMol)

 MbpName  MbpNum  MbpEdKod  MbpEd  Double(0)  OutKol  InPrice
 if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn)
 InvNum  PasNum  SklNum

 if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn)  DoubleToStr(1, '\m4')
 DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn), '\2p\m4')

 if (Pos('ноль', DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn), '\2p5')) <> 0,
   '=', DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn), '\2p88'))

 '/' + Разрешил_ФИО + '/'
 '/' + InMolShort + '/'
 '/' + if (Trim(OutPersTo) <> '', OutPersTo, OutMolTo) + '/'
.endfields
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
.{fMbpOut CheckEnter
#include MBP_M11CP.frn
.}
.}
.}
.endform

! =======================================================================================================

.linkform 'Cart_MBP_063' prototype is Cart_MBP
.Group 'Документы по расходам'
.NameInList 'Форма № M-13'
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  Разрешил_ФИО : string;
.endvar
.begin
  Разрешил_ФИО := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(2, 'Allowed'))
      Разрешил_ФИО := iFeeSigners.GetSignerFIO(1);

    iFeeSigners.ClearRestriction;
  }
end.
.fields
 CommonFormHeader
 NameOrg
 OutNumDoc
 DateToStr(OutDate,'"DD" mon YYYYг.')
 InPodr
.endfields
.{fKatMbp CheckEnter
.{fMbpIn CheckEnter
 Р ^
                                                                                            Типовая межведомственная форма № М-13
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д                                       Утверждена приказом ЦСУ СССР от 14.12.72 № 816
             предприятие, организация                                                                                ┌───────────┐
                                                                                                         Код по ОКУД │ 0303010 2 │
                                                                                                                     └───────────┘
 Р
 И                               НАКЛАДНАЯ №  Б^ Б
                       на внутреннее перемещение материалов
                               Б^ Б
 И
 Р                                                    ┌──────────────┬────────────────────────────────┬───────────────────────────────┐
                                                    │ Вид операции │ Цех, объект, склад-отправитель │ Цех, объект, склад-получатель │
                                                    ├──────────────┼────────────────────────────────┼───────────────────────────────┤
 Б                                                    │              │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                               │ Б
                                                    └──────────────┴────────────────────────────────┴───────────────────────────────┘
┌────────────────┬───────────────────────────────────────┬─────────────┬───────────────────┬──────────────┬───────────────┬─────────┐
│  Корреспонди-  │               Материалы               │   Единицы   │    Количество     │     Цена     │     Сумма     │Порядко- │
│  рующий счет   │                                       │  измерения  │                   │              │               │вый номер│
├─────┬──────────┼───────────────────────────┬───────────┼─────┬───────┼─────────┬─────────┼──────────────┼───────────────┤записи по│
│счет,│ код ана- │    наименование, сорт,    │код(номен- │ код │ наиме-│ отправ- │ принято │              │               │складской│
│суб- │ литичес- │       размер, марка       │клатурный  │     │нование│  лено   │         │              │               │картотеке│
│счет │кого учета│                           │  номер)   │     │       │         │         │              │               │         │
├─────┼──────────┼───────────────────────────┼───────────┼─────┼───────┼─────────┼─────────┼──────────────┼───────────────┼─────────┤
│  1  │    2     │             3             │     4     │  5  │   6   │    7    │    8    │       9      │      10       │   11    │
├─────┼──────────┼───────────────────────────┼───────────┼─────┼───────┼─────────┼─────────┼──────────────┼───────────────┼─────────┤
.fields
 MbpName
 MbpNum
 MbpEdKod
 MbpEd: 'D:R'
 OutKol
 InPrice
 if ( wGetTune( 'Fin.MBP.OstStoim') = 0, OutSum, OutSum- OutSumIsn)
 SklNum
.endfields
│     │          │@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@│@@@@@@@│&&&&&&.&&│         │&&&&&&&&&&&.&&│&&&&&&&&&&&&.&&│@@@@@@@@@│
└─────┴──────────┴───────────────────────────┴───────────┴─────┴───────┴─────────┴─────────┴──────────────┴───────────────┴─────────┘
.fields
 if (wGetTune('Fin.MBP.OstStoim') = 0, OutSum, OutSum - OutSumIsn)
 '/' + Разрешил_ФИО + '/'
 '/' + InMol + '/'
.endfields
 Б                                                                                                   Итого:  &&&&&&&&&&&&.&& Б

 Разрешил __________________________________ Сдал __________________________________ Принял __________________________________
 Б          @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б Р

.{fMbpOut CheckEnter
.}
.}
.}
.endform

! =======================================================================================================
