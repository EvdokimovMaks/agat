//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Бухгалтерский контур
// Бухгалтерский калькулятор - реквизиты организации
//------------------------------------------------------------------------------

#ifndef __eTaxOrgInfo__vih__
#define __eTaxOrgInfo__vih__

#include IdentApi.vih

#doc
реквизиты организации - налоговая информация о руководстве
#end
type TeTaxPersonInfo = record
   Nrec           : comp;
   FIO            : string;   //Фамилия,Имя,Отчество
   LastName       : string;   //Фамилия
   FistName       : string;   //Имя
   MidName        : string;   //Отчество
   Phone          : string;   //Номер контактного телефона
   PhoneDom       : string;   //Номер домашнего телефона
   INN            : string;   //ИНН (если нет ИНН то надо указывать нижеследующее)
   BornDate       : string;   //   \ Дата рождения
   BornPlase      : string;   //   | Место рождения
   cBornPlase     : comp;     //   | Место рождения
   Sex            : string;   //   | Пол руководителя 1-М 2-Ж
   PasspCountyCode: string;   //   | Код гражданства из паспорта (Россия 643)
   PasspCounty    : string;   //   | Гражданство из паспорта
   PasspViDocCode : string;   //   | Данные удостоверения личности (код вида документа)
   PasspViDocName : string;   //   | Данные удостоверения личности (название вида документа)
   PasspNumber    : string;   //   | Данные удостоверения личности (серия и номер)
   PasspTypeNumber: string;   //   | Данные удостоверения личности (код вида документа, серия и номер)
   PasspGivenBy   : string;   //   | Данные удостоверения личности (Кем выдано)
   PasspDate      : string;   //   | Дата выдачи удостоверения личности руководителя
   Country        : string;   //   | Код страны
   AddresOfLive   : string;   //   | Адрес места жительства руководителя в Российской Федерации
   cAddresOfLive  : comp;     //   | Адрес места жительства руководителя в Российской Федерации
   AddresOfPassp  : string;   //   | Адрес места жительства руководителя в дугой стране (не 643)
   cAddresOfPassp : comp;     //   | Адрес места жительства руководителя в дугой стране (не 643)
end;

#doc
реквизиты организации - налоговая информация самой организации и ее подразделении
#end
type TeTaxOrgInfo = record
   Nrec      : comp;
   IdOtpr    : string;     // Идентификатор отправителя (хитрый КОД для ИМНС)
   IdFile    : string;     // Идентификатор для имени файла МММММ 5-9 цифры ИНН ЮЛ или 6-10 цифры ИНН ИП (хитрый КОД для ИМНС)
   Name      : string;     // Наименование организации
   AltName   : string;     // Альтернативное наименование организации
   Phone     : string;     // Контактный телефон организации
   Email     : string;     // Email
   INN       : string;     // ИНН организации
   KPP       : string;     // КПП организации
   Addr      : string;     // Адрес указанный в учредительных документах
   cAddr     : comp;       // Адрес указанный в учредительных документах
   RealAddr  : string;     // Реальный адрес где действует фирма
   cRealAddr : comp;       // Реальный адрес где действует фирма

   // Подразделение организации
   DepartName  : string;  // наименование обособленного подразделения
   DepartKPP   : string;  // КПП обособленного подразделения
   DepartAddr  : string;  // Адрес обособленного подразделения
   cDepartAddr : comp;    // Адрес обособленного подразделения
   DepartPhone : string;  // Контактный телефон обособленного подразделения

   // Свидетельство о постановке на учет
   InsCode      : string; // Код инспекции
   InsName      : string; // Наименование инспекции
   UchetSerNum  : string; // Серия и номер свидетельства о постановке на учет
   UchetDate    : date;   // Дата выдачи свидетельства
   UchetKPP     : string; // to do еще один левый КПП из настройки

   // Реквизиты для поддержки формата 2.01
   CodeOIV : string; // НаимОИВ - Наименование органа исполнительной власти
   OKVED   : string; // ОКВЭД - Код  ОКВЭД
   OKATO   : string; // ОКАТО - Код ОКАТО
   KBK     : string; // КБК Код классификации доходов бюджетов Российской Федерации
   OGRN    : string; // ОГРН - Основной государственный регистрационный номер (ОГРН)
   OKPO    : string; // ОКПО
   OKFS    : string; // ОКФС
   OKOPF   : string; //  ОКОПФ организации

   // Данные иностранных организаций
   ForeinKPP         : string; //Код налогоплательщика в стране регистрации или его аналог
   ForeinName        : string; //Наименование иностранной организации
   ForeinCountry     : string; //Страна регистрации (инкорпорации)
   ForeinCountryCode : string; //Код страны регистрации (инкорпорации)
   ForeinAddr        : string; //Адрес, указанный в учредительных документах иностранной организации
   cForeinAddr       : comp;   //Адрес, указанный в учредительных документах иностранной организации

   // прочие параметры
   DocPerdst : word;    // 1 2 3 4 5 6 7
   KatNP     : word;    // Категория налогоплательщика 1 2 3 4 5 6 7
   KppInom   : string;  // КПП по иному месту нахождения
   KolDaysRF : word;    // Количество дней пребывания физического лица на территории Российской Федерации

   OType   : string; //Тип организации
   VidD   : string; //Вид Деятельности
   FormS  : string; //Форма Собственности
   OKTMO  : string; // ОКТМО
end;

#doc
Налоговая отчетность - реквизиты организации
#end
ObjInterface ObjETaxOrgInfo;

   #doc
   Окно редактирования реквизитов организации
   #end
   procedure EditOrgInfo;

   #doc
   Прочитать информацию по организации из БД
   <pre>
   _MyOrg   : TeTaxOrgInfo;     // Информация о собственной организации
   _Boss    : TeTaxPersonInfo;  // Директор организации
   _MainBuh : TeTaxPersonInfo;  // Главный бухгалтер
   _WorkBuh : TeTaxPersonInfo); // Ответственный исполнитель
   </pre>
   #end
   procedure GetOrgInfo(var _MyOrg   : TeTaxOrgInfo;     // Информация о собственной организации
                        var _Boss    : TeTaxPersonInfo;  // Директор организации
                        var _MainBuh : TeTaxPersonInfo;  // Главный бухгалтер
                        var _WorkBuh : TeTaxPersonInfo); // Ответственный исполнитель
end;

VipInterface IdApiReg_ETaxOrgInfo
  Implements ObjIdentApiPluginRegistrator
  #ifdef Atl51
  Licensed (Free)
  #end
;

VipInterface IdApi_ETaxOrgInfo
  Implements ObjETaxOrgInfo, ObjIdentApiPlugin
  #ifdef Atl51
  Licensed (Free)
  #end
;

#end // __eTaxOrgInfo__vih__
