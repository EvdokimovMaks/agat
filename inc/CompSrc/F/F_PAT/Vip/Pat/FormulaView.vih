//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.82 - Бухгалтерский контур
// Расшифровка расчета ПАТ-форм
//------------------------------------------------------------------------------

#ifndef __FormulaView__vih__
#define __FormulaView__vih__

#Component "F_PAT"

#doc
Расшифровка расчета ПАТ-форм (объектный интерфейс)
#end
ObjInterface ObjFormulaView;
  #doc
  Задать путь к PAT-файлу
  #end
  procedure SetPropFileName(FileName : string);

  #doc
  Получить путь к PAT-файлу
  #end
  function GetPropFileName : string;

  #doc
  Получить путь к папке хранения PAT-файлов.
  Исходя из которой рассчитываются относительные пути.
  #end
  function GetPropPatPathNoPat : string;

  #doc
  Разобрать файл и произвести расчет расчет PAT-формул.
  Параметр CheckLevel - уровень вычислений
    cgPatCheckLevel_FullCount = 0; - Полный расчет
    cgPatCheckLevel_CheckOnly = 1; - Только разбор и проверка синтаксиса
  #end
  function PreparePreview(CheckLevel : word) : boolean;

  #doc
  Разобрать файл и произвести расчет мета-операторов но не проводить расчет расчет PAT-формул.
  Параметр CheckLevel - уровень вычислений
    cgPatCheckLevel_FullCount = 0; - Полный расчет
    cgPatCheckLevel_CheckOnly = 1; - Только разбор и проверка синтаксиса
  #end
  function PrepareForCount(CheckLevel : word) : boolean;

  #doc
  Открыть окно расшифровки расчета.
  Параметр aViewMode - режим отображения информации
    cgPatViewMode_TreeNumeric = 0 - Нормализованный иерархический
    вид формулы представлены номерами

    cgPatViewMode_TreeFormula = 1 - Обычный иерархический вид,
    отображаются исходные формулы как есть

    cgPatViewMode_ListFormula = 2 - Обычный линейный вид,
    отображаются исходные формулы как есть
  #end
  procedure ShowWindow(aViewMode : longint);

  #doc
  Открыть расшифровку расчета в FastRport.
  #end
  procedure ShowCalcDetailReport;

  #doc
  Получить не отформатированное строковое значение ключа.
  Пригодное для преобразования к числовому виду.
  #end
  function ValueNdeBin(IdentKey : string) : string; deprecated;

  #doc
  Открыть окно выбора файла ПАТ-отчета.
  #end
  function PickFileName : boolean;

  #doc
  Открыть окно выбора ПАТ-ключа.
  #end
  function PickIdent(var Ident : string) : boolean;

  function GetPatRep : longint;
  function GetSiServ : longint;
  function GetFServ  : longint;
End;

ObjInterface ObjFormulaView2;
  procedure ShowWindow2(aViewMode : longint; aKey : String);
End;


#doc
Расшифровка расчета ПАТ-форм (реализация)
#end
VipInterface FormulaView Implements ObjFormulaView, ObjFormulaView2 Licensed (Free);
public:
  constructor Init;
  destructor Done;
end;

#doc
Подсчет ссылок для окна расшифровки расчета ПАТ-форм
#end
ObjInterface ObjFormulaViewCounter;
  procedure IncCounter;
  procedure DecCounter;
  function  GetCounter : longint;
End;

#doc
Подсчет ссылок для окна расшифровки расчета ПАТ-форм (реализация)
#end
VipInterface FormulaViewCounter Implements ObjFormulaViewCounter Licensed (Free);

#endif
