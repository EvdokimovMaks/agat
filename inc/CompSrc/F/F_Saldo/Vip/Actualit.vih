//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 7.12 - Бухгалтерский контур
// Поддержка актуальности сальдо
//------------------------------------------------------------------------------

#ifndef _Actualit_vih_Included
#define _Actualit_vih_Included

#ifdef ComponentVersion
#Component "F_Saldo"
#end

!-------------------------------------------------------------------------------
#doc
Объект поддержки акутальности сальдо
#end
ObjInterface ObjSaldoActuality;
!-------------------------------------------------------------------------------
  #doc
  Установить актуальность для счета/субсчета.
  Если SubSch = cgDefSub то отработает для счета и всех субсчетов.
  Если SubSch = cgNotSch то отработает только для Schet + cgDefSub.
  #end
  function SetActuality  (Schet  : tSchet3;
                          SubSch : tSubSch;
                          SetDate : date;
                          SetTime : time) : boolean;
!-------------------------------------------------------------------------------
  #doc
  Сброс актуальность для счета/субсчета.
  Если SubSch <> cgDefSub то отработает для субсчета и для cgDefSub.
  #end
  function DropActuality (Schet  : tSchet3;
                          SubSch : tSubSch) : boolean;
!-------------------------------------------------------------------------------
  #doc
  Установить актуальность для всех счетов/субсчетов плана счетов.
  Если cPlansSch = 0 то отработает для __всех__ планов счетов.
  #end
  function SetActualityForPlansSch (cPlansSch : comp;
                                    SetDate : date;
                                    SetTime : time) : boolean;
!-------------------------------------------------------------------------------
  #doc
  Сбросить актуальность для всех счетов/субсчетов плана счетов.
  Если cPlansSch = 0 то отработает для __всех__ планов счетов.
  #end
  function DropActualityForPlansSch (cPlansSch : comp) : boolean;
!-------------------------------------------------------------------------------
  #doc
  Начать сессию актуализации.
  При работе сессии значения накапливаются в таблице.
  При окончании работы производятся Drop или Set для всех накопленных значений
  (то есть надо использовать для пакетной обработки)
  #end
  function StartActualitySession : boolean;
!-------------------------------------------------------------------------------
  #doc
  Положить в сессию счет и субсчет.
  Накапливаются уникальные значения Schet + SubSch.
  #end
  function AddSessionElement (Schet  : tSchet3;
                              SubSch : tSubSch) : boolean;
!-------------------------------------------------------------------------------
  #doc
  Закончить сессию и установить актуальность
  #end
  function StopSessionAndSet (SetDate : date;
                              SetTime : time) : boolean;
!-------------------------------------------------------------------------------
  #doc
  Закончить сессию и сбросить актуальность
  #end
  function StopSessionAndDrop : boolean;
!-------------------------------------------------------------------------------
end; // ObjInterface
!-------------------------------------------------------------------------------
VipInterface SaldoActuality implements ObjSaldoActuality #Licensed_Free;
!-------------------------------------------------------------------------------
#end // _Actualit_vih_Included

