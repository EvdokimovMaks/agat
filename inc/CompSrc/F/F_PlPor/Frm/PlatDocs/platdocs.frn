//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.70-7.12 - Бухгалтерский контур
// Печать платежных документов
//------------------------------------------------------------------------------

.linkform PlatDocs1 prototype is 'PlatDocs'
.group 'АВАНСОВЫЙ ОТЧЕТ'
#include ao.frl

.linkform PlatDocs2 prototype is 'PlatDocs'
.group 'БУХГАЛТЕРСКАЯ СПРАВКА'
.var
l : word;
first, last, max, i, j, k: word;
Str: string;
Arr: array[1..605] of char;
.endvar
.fields
OurTuneName
NoDok DatOb2
sumplatdoc
dbSchetO SubOsSch
KodSPO dbKAU
krSchetK SubSchK
KodSPK krKAU
AvSumU NoAODoc
VhProp
SumObInVal+ObValut
if(l=1,'Итого','') SumObValut+ItsValut
SumObNDETotal+ndesimv
Str Str Str
if(Подписант_Роль = '',Подписант_Должность, Подписант_Роль)
Подписант_ФИО
MainAccountantAbbrev
PerformerNameAbbrev
page_symb
.endfields
.{
 Щ
 Б  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                       организация Ш
 Щ
                                            БУХГАЛТЕРСКАЯ СПРАВКА № @@@@@@@@@
                                                за  @@@@@@@@@@@@@@@@@@@
                                         Б сумма по документу Б &~&&&&&&&&&&&&.&&
 Щ
 Ш ───────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────┬─────────┬─────────┬──────────────
                        БДебет       Б                  │                      БКредит      Б                  │          │         │         │
 ────┬─────┬─────────────┬──────────────────────────┼────┬─────┬─────────────┬─────────────────────────┤          │         │         │
  БСчет Б│ БСуб-  Б│ БКод структур- Б│          БОбъект Б           │ БСчет Б│ БСуб- Б │ БКод структур- Б│          БОбъект Б          │ БКоличество Б│  БЕдиницы Б │ БВходит в Б │     БСумма Б
     │ Бсчет Б │ Бного подразд. Б│      Баналитического Б       │    │ Бсчет Б │ Бного подразд. Б│      Баналитического Б      │          │ Бизмерения Б│   Бсумму Б  │
     │     │             │          Бучета Б            │    │     │             │          Бучета Б           │          │         │ Бдокумента Б│
 ────┴─────┴─────────────┴──────────────────────────┴────┴─────┴─────────────┴─────────────────────────┴──────────┴─────────┴─────────┴──────────────

 Ш#BeforeAccEntriesCycles
.{
 Ш  @@@ @@@@@ @#@@@@@@@@@@@ @~@@@@@@@@@@@@@@@@@@@@@@@@ @@@@ @@@@@ @#@@@@@@@@@@@ @~@@@@@@@@@@@@@@@@@@@@@@@ &#&&&&&&&& @~@@@@@@@@    @  &#&&&&&&&&&&&&&&
 Ш.}
.begin
 l:= 0;
end.
.{
.{?internal;(ObValut <> ndesimv);
.begin
 l:= l + 1;
end.
 Ш  @@@@@                                                                                                                             &#&&&&&&&&&&&&&&
 Ш.}
.}
.{?internal;(ObValut = ndesimv);
 Ш  Итого                                                                                                                             &#&&&&&&&&&&&&&&
 Ш.} Ш
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 Б Содержание операции Б

 Ш.begin
 j := 1;

 for (i:=1; i <= length(NamePl1); i:=i+1)
 {
   Arr[j] := Chr(Substr(NamePl1, i, 1));
   Inc(j);
 }
 if length(NamePl1) <> 0
 {
   Arr[j] := ' ';
   Inc(j);
 }
 for (i:=1; i <= length(NamePl2); i:=i+1)
 {
   Arr[j] := Chr(Substr(NamePl2, i, 1));
   Inc(j);
 }
 if length(NamePl2) <> 0
 {
   Arr[j] := ' ';
   Inc(j);
 }
 for (i:=1; i <= length(NamePl3); i:=i+1)
 {
   Arr[j] := Chr(Substr(NamePl3, i, 1));
   Inc(j);
 }
 if length(NamePl3) <> 0
 {
   Arr[j] := ' ';
   Inc(j);
 }
 for (i:=1; i <= length(NamePl4); i:=i+1)
 {
   Arr[j] := Chr(Substr(NamePl4, i, 1));
   Inc(j);
 }
 if length(NamePl4) <> 0
 {
   Arr[j] := ' ';
   Inc(j);
 }
 for (i:=1; i <= length(NamePl5); i:=i+1)
 {
   Arr[j] := Chr(Substr(NamePl5, i, 1));
   Inc(j);
 }
 if length(NamePl5) <> 0
 {
   Arr[j] := ' ';
   Inc(j);
 }
 for (i:=1; i <= length(DetaliPl); i:=i+1)
 {
   Arr[j] := Chr(Substr(DetaliPl, i, 1));
   Inc(j);
 }

 max := j - 1;
 first := 1;

 if (max > 252)
   last := 252;
 else
   last := max;

 k := 0;
end.
 Ш
 Ш.{?internal;(max DIV 252) >= k;
.begin
 Str := '';
 k := k + 1;

 for (i := first; i <= last; i := i + 1)
   str := str + Arr[i];

 first := last + 1;

 if (max - last) > 252
   last := first + 252;
 else
   last := first + max - last;
end.
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Ш.}
.{?internal;(max DIV 252) >= k;
.begin
 Str := '';
 k := k + 1;

 for (i := first; i <= last; i := i + 1)
   str := str + Arr[i];

 first := last + 1;

 if (max - last) > 252
   last := first + 252;
 else
   last := first + max - last;
end.
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Ш.}
.{?internal;(max DIV 252) >= k;
.begin
 Str := '';
 k := k + 1;

 for (i := first; i <= last; i := i + 1)
   str := str + Arr[i];

 first := last + 1;

 if (max - last) > 252
   last := first + 252;
 else
   last := first + max - last;
end.
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Ш.} Ш



 Ш.{
.{
.{
.}
.}
.}
.{checkenter PlatDocsCycleVKassu
.{checkenter PlatDocsCycleMemo1
.}
.}
.{checkenter PlatDocsCycleIzKassy
.{checkenter PlatDocsCycleMemo2
.}
.}
.if ExistFeeSigners_PlatDocs
.{checkenter FeeSignersCycle_PlatDocs
 Щ@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.}
.else
 Щ Главный бухгалтер  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б Исполнитель  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.end
.if DelimiterPlat
 Ш----------------------------------------------------------------------------------------------------------- Ш
.end
.if PageSymbol
^
.end
.}
.endform

.linkform PlatDocs8 prototype is 'PlatDocs'
.group 'Приходный кассовый ордер'
.group 'Приходный кассовый ордер - РК'
.nameinlist 'Приходный кассовый ордер'
.var
KassCheck: string
.endvar
.fields
sumplat1docstr  sumplat1docstr
OurTuneName
NoDok unnsimv OurOrgUNN
DatOB2 NoDok
unnsimv OurOrgUNN
PodotchetGenitive
NameAll+KassCheck
krSchetK SubSchK krKAU sumPlatOb
                  SumNDS
PodotchetGenitive
NameAll+KassCheck
                  GroupWrap(sumPlatDocStr,1,27)
                  GroupWrap(sumPlatDocStr,2,27)
NDS SumNDS        GroupWrapStr(sumPlatDocStr,3,27)
SumPlatDocStr     SumPlatDoc DollarPlat
DatOb2 NamePl4
page_symb
.endfields
.begin
KassCheck := if((NoChek1 <> '') and (StrToDate(DeNoSch1, 'DD/MM/YYYY') <> date(0,0,0)),
                  ' Кассовый чек N ' + NoChek1 +
                  ' от ' + DateToStr(StrToDate(DeNoSch1, 'DD/MM/YYYY'), 'DD.MM.YYYY') + ' г.', '');
end.
.{
 И @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│|│@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 И -----------------------------------------------------------│|│--------------------------- И
 И Б Организация : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│|│ И
 И                                          ┌──────────────┐  │|│           БКВИТАНЦИЯ Б
 Б ПРИХОДНЫЙ КАССОВЫЙ ОРДЕР N Б @@@@@@@@@@ @@@│@~@@@@@@@@@@@@│  │|│ Б   к приходному кассовому Б
    @~@@@@@@@@@@@@@@@@@@@@                └──────────────┘  │|│ Б       ордеру N Б @@@@@@@@@@@@@
                                                            │|│      ┌──────────────┐ И
 И                                                            │|│   @@@│@~@@@@@@@@@@@@│ И
 И                                                            │|│      └──────────────┘ И
 И ──┬────────────┬────────────────────┬──────────────┬───────┤|│ БПринято от Б
   │            │                    │              │       │|│@@@@@@@@@@@@@@@@@@@@@@@@@@@
   │ БКорреспонди- Б│      БКод анали- Б     │     БСумма Б     │ БКод це- Б│|│
   │ Брующий счет, Б│      Бтического Б      │              │ Блевого Б │|│
   │ Бсубсчет Б     │        Бучета Б        │              │ Бназн-ия Б│|│ БОснование: Б
   │            │                    │              │       │|│@@@@@@@@@@@@@@@@@@@@@@@@@@@
 ──┼────────────┼────────────────────┼──────────────┼───────┤|│
 И#BeforeAccEntriesCycles И
.{
   │  @@@   @@  │@@@@@@@@@@@@@@@@@@@@│&#&&&&&&&&&&&&│       │|│
.}
 ──┴────────────┴────────────────────┴──────────────┴───────┤|│
.{
.}
 Б Принято от Б                                                 │|│ БСумма НДС Б &#&&&&&&&&&&& руб
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│|│ Б
 Основание: Б                                                 │|│ БСумма с НДС:
 Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│|│@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Б                                                            │|│@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Ставка НДС Б &&&&&&  Б% Б  Б    Сумма НДС  Б&#&&&&&&&&&&&&&& руб     │|│@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Cумма с НДС: Б                                               │|│ Б
 Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│|│&#&&&&&&&&&&&&& @@@@@@@@@ Б
 Б                                                            │|│ Б
 Б                                                            │|│@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Приложение: Б                                                │|│     БМ. П.
 Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│|│ Б
 Б                                                            │|│ Б
 Б              БГлавный бухгалтер Б                              │|│ БГлавный бухгалтер
 Б                                                            │|│ Б
 Б              БПолучил кассир Б                                 │|│ БКассир Б Б
 Й
#AfterAccEntriesCycles
.if DelimiterPlat
 И---------------------------------------------------------------------------------------- И
.end
.if PageSymbol
^
.end
.}
.endform

.linkform PlatDocs9 prototype is 'PlatDocs'
.group 'Расходный кассовый ордер'
.group 'Расходный кассовый ордер - РК'
.nameinlist 'РАСХОДНЫЙ КАССОВЫЙ ОРДЕР: форма КО-2, утвержденная 12.X.73'
.p 80
.fields
OurTuneName
NoDok
SubStr(DatOB1,1,2) SubStr(DatOB1,4,2) SubStr(DatOB1,9,2)
!{
dbSchetO SubOsSch
if (DopParam = 0, dbKAU, '')
sumplatob
!}
PodotchetDative
NameAll
sumplatdocstr
NamePl4
PassportInfo
page_symb
.endfields
.{
.begin
#include platwrap.frv
end.
 И                                                                      ДФорма N КО-2 Д
                                                    Утверждена  ЦСУ СССР по согла
 Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д     сованию с Госбанком СССР  и  Мини
         Бпредприятие, организация Б                стерством финансов СССР 12.X.1973
                                                N 668.
                                                                   ┌────────────┐
                                                         БКод по ОКУД Б│  0308002   │
                                                                   └────────────┘
                   БРАСХОДНЫЙ КАССОВЫЙ ОРДЕР N  Б @@@@@@
                    ┌────────────┬─────────────┐
                    │    БЧисло    │    Месяц  Б   │
                    ├────────────┼─────────────┤
                    │@~@@@@@@@@@ │@~@@@@@@@@@@@│     Б20 Б@@  Бг. Б
                    └────────────┴─────────────┘
┌────────┬──────────────────┬──────────────────┬──────────────────┬─────────────┐
│        │    БКорреспонди-   │  Код аналитиче-  │                  │ Код    Б      │
│        │    Брующий счет,   │   ского учета    │     Сумма        │ целевого Б    │
│        │    Бсубсчет        │                  │                  │ назначения Б  │
├────────┼──────────────────┼──────────────────┼──────────────────┼─────────────┤
 И#BeforeAccEntriesCycles И
.{
│        │     @@@   @@     │@@@@@@@@@@@@@@@@@@│&#&&&&&&&&&&&&&&&&│             │
.}
└────────┴──────────────────┴──────────────────┴──────────────────┴─────────────┘
.{
.}
  БВыдать Б
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БОснование: Б
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                     Б(прописью) Б
  БПриложение: Б
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@


  БРуководитель Б                                БГлавный бухгалтер Б

  БПолучил Б ________________________________________________________________________
                                      Бпрописью Б

  Б"___" __________________20___г.              Подпись Б

  БПо Б  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
     _____________________________________________________________________________
         Бнаименование,номер,дата и место выдачи док-та, удост. личность получателя Б

             БВыдал  кассир Й
#AfterAccEntriesCycles
.if DelimiterPlat
 И--------------------------------------------------------------------------------- И
.end
.if PageSymbol
^
.end
.}
.endform

.linkform PlatDocs9_1 prototype is 'PlatDocs'
.group 'Валютный расходный кассовый ордер'
.group 'Валютный расходный кассовый ордер - РК'
.nameinlist 'Валютный расходный кассовый ордер'
.fields
sumplat1docstr OurTuneName
NoDok
DatOB2
dbSchetO SubOsSch dbKAU sumplatob
PodotchetDative
NameAll
sumplatdocstr
NamePl4
PassportInfo
page_symb
.endfields
.{
.begin
#include platwrap.frv
end.
 И @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Б Организация : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                                                   ┌────────────┐ И
 И    БРАСХОДНЫЙ КАССОВЫЙ ОРДЕР N Б  @@@@@@                   Код по ОКУД│  0308002   │
                   @@@@@@@@@@@@@@@@@@@                             └────────────┘
┌────────┬──────────────────┬──────────────────┬──────────────────┬─────────────┐
│        │ Б   Корреспонди- Б   │   БКод аналитиче- Б  │                  │ Б Код Б         │
│        │ Б   рующий счет, Б   │    Бского учета Б    │      БСумма Б        │ Б целевого Б    │
│        │ Б   субсчет Б        │                  │                  │ Б назначения Б  │
├────────┼──────────────────┼──────────────────┼──────────────────┼─────────────┤
 И#BeforeAccEntriesCycles И
.{
│        │     @@@   @@     │@@@@@@@@@@@@@@@@@@│&#&&&&&&&&&&&&&&&&│             │
.}
└────────┴──────────────────┴──────────────────┴──────────────────┴─────────────┘
.{
.}
 Б Выдать Б
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Б Основание: Б
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                     Б(прописью) Б
 Б Приложение: Б
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Б

 Руководитель Б                                БГлавный бухгалтер Б

 Б Получил Б ________________________________________________________________________
                                      Бпрописью Б

 "___" __________________ Б20 Б___ Бг. Б               БПодпись Б
 Б
 По Б  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
     _____________________________________________________________________________
         Бнаименование,номер,дата и место выдачи док-та, удост. личность получателя Б

             БВыдал  кассир Й
#AfterAccEntriesCycles
.if DelimiterPlat
 И--------------------------------------------------------------------------------- И
.end
.if PageSymbol
^
.end
.}
.endform

.linkform PlatDocs9_2 prototype is 'PlatDocs'
.group 'Расходный кассовый ордер'
.group 'Расходный кассовый ордер - РК'
.nameinlist 'РАСХОДНЫЙ КАССОВЫЙ ОРДЕР: форма КО-2, утвержденная 28.12.89'
.p 80
.fields
OurTuneName
!{
NoDok DatOB1 dbSchetO SubOsSch
if (DopParam = 0, dbKAU, '')
sumplatob
!}
PodotchetDative
NameAll
sumplatdocstr
NamePl4
PassportInfo
page_symb
.endfields
.{
.begin
#include platwrap.frv
end.
 И                                                                                  ДФорма N КО-2 Д
                                                           Утверждена  постановлением Госком-
                                                                 стата СССР от 28.12.89 N 241
 Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
               Бпредприятие, организация Б                                       ┌────────────┐
                                                                   БКод по ОКУД Б│  0308002   │
                                                                             └────────────┘

                              ЙРАСХОДНЫЙ КАССОВЫЙ ОРДЕР Й
┌───────┬─────────────┬──────┬───────────────┬───────────────┬──────────────┬─────────┬─────┐
 Б│ Номер │     Дата    │      │   Корреспон-  │    Код ана-   │              │Код целе-│     │
│ доку- │ составления │      │ дирующий счет,│  литического  │    Сумма     │вого на- │     │
│ мента │             │      │    субсчет    │     учета     │              │значения │     │ Й
 И├───────┼─────────────┼──────┼───────────────┼───────────────┼──────────────┼─────────┼─────┤
 И#BeforeAccEntriesCycles И
.{
│@~@@@@@│@~@@@@@@@@@@@│      │   @@@   @@    │@@@@@@@@@@@@@@@│&#&&&&&&&&&&&&│         │     │
.}
└───────┴─────────────┴──────┴───────────────┴───────────────┴──────────────┴─────────┴─────┘
.{
.}
  БВыдать Б
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БОснование: Б
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                           Бпрописью Б
  БПриложение: Б
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@


      БРуководитель Б                                БГлавный бухгалтер Б

  БПолучил Б ____________________________________________________________________________________
                                           Бпрописью Б

  Б"____" __________________________________20____г.                   Подпись Б

  БПо Б  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
     ________________________________________________________________________________________
             Бнаименование,номер,дата и место выдачи док-та, удост. личность получателя Б

        БВыдал  кассир Й
#AfterAccEntriesCycles
.if DelimiterPlat
 И--------------------------------------------------------------------------------- И
.end
.if PageSymbol
^
.end
.}
.endform
