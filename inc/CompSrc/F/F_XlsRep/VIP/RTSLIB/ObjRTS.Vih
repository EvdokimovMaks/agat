//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - компонента "Excel-отчеты"
// Базовый объект : "Resource Transformation Server"
//------------------------------------------------------------------------------

#ifndef __ObjRTS_Vih__
#define __ObjRTS_Vih__

#ifdef  ComponentVersion
#component "F_XlsRep"
#endif//ComponentVersion


//------------------------------------------------------------------------------
#doc
Базовый объект : "Resource Transformation Server"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iObjRTS;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;
//------------------------------------------------------------------------------
#doc
   Сообщение последней ошибки
#end
Function RunShowError : boolean;

//==============================================================================
//                                  FIELDS
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Загружен ли объект RTS
#end
Function GetIsRTSValid : boolean;
//------------------------------------------------------------------------------
#doc
   Является ли текущая архитектура 3-х уровневой
#end
Function GetIsCur3X : boolean;
//------------------------------------------------------------------------------
#doc
   Получить путь на ресурсы сервера
#end
Function GetSrvExePath : string;
//------------------------------------------------------------------------------
#doc
   Получить путь на ресурсы клиента
#end
Function GetCliExePath : string;

//==============================================================================
//                                  METHOD
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Сформировать стандартный путь на файл репозитария шаблонов
#end
Function MakeDistribFileName(
  _RepID    : string;
  _FileName : string
) : string;
//------------------------------------------------------------------------------
#doc
   Сформировать стандартный путь на базовый шаблон сервера
#end
Function MakeBaseSrvFileName(
  _RepID    : string;
  _FileName : string
) : string;
//------------------------------------------------------------------------------
#doc
   Сформировать стандартный путь на базовый шаблон клиента
#end
Function MakeBaseCliFileName(
  _RepID    : string;
  _FileName : string
) : string;

//------------------------------------------------------------------------------
#doc
   Сформировать стандартный путь на базовый шаблон
#end
Function MakeBaseFileName(
  _RepID    : string;
  _FileName : string
) : string;
//------------------------------------------------------------------------------
#doc
   Сформировать стандартный путь на шаблон по умолчанию
#end
Function MakeDefaFileName(
  _RepID    : string;
  _FileName : string
) : string;

#doc
   Сформировать стандартный путь на файл репозитария надстроек
#end
Function MakeDistribXLAFileName(
  _RepID    : string;
  _XLAFileName : string
) : string;
//------------------------------------------------------------------------------
#doc
   Сформировать стандартный путь на базовая надстройка сервера
#end
Function MakeBaseSrvXLAFileName(
  _RepID    : string;
  _XLAFileName : string
) : string;
//------------------------------------------------------------------------------
#doc
   Сформировать стандартный путь на базовая надстройка клиента
#end
Function MakeBaseCliXLAFileName(
  _RepID    : string;
  _XLAFileName : string
) : string;

//------------------------------------------------------------------------------
#doc
   Сформировать стандартный путь на базовую надстройку
#end
Function MakeBaseXLAFileName(
  _RepID    : string;
  _XLAFileName : string
) : string;
//------------------------------------------------------------------------------
#doc
   Сформировать стандартный путь на надстройку по умолчанию
#end
Function MakeDefaXLAFileName(
  _RepID    : string;
  _XLAFileName : string
) : string;

//------------------------------------------------------------------------------
#doc
   Получить путь на каталог по пути на файл
#end
Function GetDirPathFromFile(
  _sFilePath : string
) : string;
//------------------------------------------------------------------------------
#doc
   Проверить существование каталога на клиенте
#end
Function CheckCliDirectory(
  _sDir      : string
) : boolean;

//------------------------------------------------------------------------------
#doc
   Существует ли файл на сервере
#end
Function GetSrvFileExists(
    _sFilePath : string
) : boolean;
//------------------------------------------------------------------------------
#doc
   Существует ли файл на клиенте
#end
Function GetCliFileExists(
    _sFilePath : string
) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить свойство ReadOlny файлу на клиенте
#end
Function SetCliFileReadOnly(
  _sFilePath  : string;
  _isReadOnly : boolean
) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить версию файла на сервере
#end
Function GetSrvFileAge(
  _sFilePath : string
) : LongInt;

//------------------------------------------------------------------------------
#doc
   Установить версию файла на сервере
#end
Function SetCliFileAge(
  _sFilePath : string;
  _FAge      : LongInt
) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить версию файла на клиенте
#end
Function GetCliFileAge(
  _sFilePath : string
) : LongInt;

//------------------------------------------------------------------------------
#doc
   Нужно ли обновление файла на клиенте
#end
Function GetIsNeedRefreshCliFile(
  _sSrvFilePath : string;
  _sCliFilePath : string
) : boolean;

//------------------------------------------------------------------------------
#doc
   Копирование файла на клиент
#end
Function CopySrvFileToCli(
  _sSrvFilePath : string;
  _sCliFilePath : string
) : boolean;

//------------------------------------------------------------------------------
#doc
   Обновление файла на клиенте
#end
Function RefreshCliFile(
  _sSrvFilePath : string;
  _sCliFilePath : string
) : boolean;

//------------------------------------------------------------------------------
#doc
   Копирование файла на клиенте
#end
Function CopyCliFileToCli(
  _sCliFilePathFrom : string;
  _sCliFilePathTo : string
) : boolean;


//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface ObjRTS implements iObjRTS
#Licensed_Free
;

#endif//__ObjRTS_Vih__
