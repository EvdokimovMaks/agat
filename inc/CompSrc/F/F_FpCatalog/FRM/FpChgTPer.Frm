//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Визуальный интерфейс: "Изменение текущего типа периода"
//------------------------------------------------------------------------------

//==============================================================================
#doc
Базовая форма: "Изменение текущего типа периода"
#end
//------------------------------------------------------------------------------
.set name='FpChgTPer'
.hide
.fields

  // CycleOfTune - Цикл по настройкам
  sTuneType         // Тип настройки (системная/пользовательская)
  sTuneKey          // Ключ идентификатора настройки
  sTunePath         // Путь на настройку
  
  // CycleOfUser - Цикл по пользователям
  cUserID           // Идентификаотр пользователя
  UserOffice        // Номер офиса пользователя
  LoginName         // Имя, под которым пользователь подключен к Галактике
  FullName          // Полное имя пользователя
  cOldValue         // Прежнее значение настройки (comp)
  cNewValue         // Новое значение настройки   (comp)
  sOldValue         // Прежнее значение настройки (string)
  sNewValue         // Новое значение настройки   (string)
  sChangeError      // Описание ошибки изменения настройки

.endfields

.{  CycleOfTune CheckEnter  // Цикл по настройкам
 sTuneKey         ^ 
 sTunePath        ^ 
 sTuneType        ^ 

.IF    IsSysTune
.ELSE//IsSysTune
.END //IsSysTune
.{  CycleOfUser CheckEnter  // Цикл по пользователям
 cUserID          ^
 UserOffice       ^
 LoginName        ^
 FullName         ^
 cOldValue        ^
 cNewValue        ^
 sOldValue        ^
 sNewValue        ^
.IF   IsChangeError
 sUserIsChangeError ^
.END//IsChangeError
.}//CycleOfUser

.}//CycleOfTune

.endform
//******************************************************************************


//==============================================================================
#doc
Присоединенная форма: "Изменение текущего типа периода"
#end
//------------------------------------------------------------------------------
.linkform 'FpChgTPer1' prototype is 'FpChgTPer'
.Nameinlist 'Протокол изменения настроек'
!.P 55
.fields
  CommonFormHeader

  // CycleOfTune - Цикл по настройкам
  sTuneType         // Тип настройки (системная/пользовательская)
  sTunePath         // Путь на настройку
  
  // CycleOfUser - Цикл по пользователям
  UserOffice        // Номер офиса пользователя
  LoginName         // Имя, под которым пользователь подключен к Галактике
  FullName          // Полное имя пользователя
  sOldValue         // Прежнее значение настройки (string)
  sNewValue         // Новое значение настройки   (string)
  sChangeError      // Описание ошибки изменения настройки
.endfields
^
                        Протокол изменения настроек
.{  CycleOfTune CheckEnter  // Цикл по настройкам
═════════════════╤══════════════════════════════════════════════════════════════
@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF    IsSysTune
─────────────────┴─────────────────────────┬──────────────────┬─────────────────
                                           │ Прежнее значение │ Новое значение           
───────────────────────────────────────────┴──────────────────┴─────────────────
.ELSE//IsSysTune
────┬────────────┼─────────────────────────┬──────────────────┬─────────────────
Офис│Пользователь│ Полное имя пользователя │ Прежнее значение │ Новое значение           
────┴────────────┴─────────────────────────┴──────────────────┴─────────────────
.END //IsSysTune
.{  CycleOfUser CheckEnter  // Цикл по пользователям
@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@
.IF   IsChangeError
                                                               @@@@@@@@@@@@@@@@@
.END//IsChangeError
.}//CycleOfUser

.}//CycleOfTune

.endform
//******************************************************************************
