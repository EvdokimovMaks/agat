//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Объект быстрого доступа : "Периоды планирования"
//------------------------------------------------------------------------------

#ifndef __fpQPer_Vih__
#define __fpQPer_Vih__

#ifdef  ComponentVersion
#component "F_FpCatalog"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include FpPeriod.Inc  // все типы "Периоды планирования"
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Объект быстрого доступа : "Периоды планирования"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface IQuickFpPeriod;

  //============================================================================
  //                                  ERROR
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает описание последней ошибки
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывод сообщения последней ошибки
  #end
  Function RunShowError : boolean;
  //****************************************************************************


  //============================================================================
  //                                  INIT
  //----------------------------------------------------------------------------
  #doc
     Обновить таблицы в памяти
  #end
  Function RetrieveTbl : boolean;
  //****************************************************************************


  //============================================================================
  //                                 FIELDS
  //----------------------------------------------------------------------------
  #doc
     Получить название периода
  #end
  Function GetMemName(
    _cRec     : comp        // ссылка на период
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить дату начала периода
  #end
  Function GetMemDBeg(
    _cRec     : comp        // ссылка на период
  ) : date;
  //----------------------------------------------------------------------------
  #doc
     Получить дату конца периода
  #end
  Function GetMemDEnd(
    _cRec     : comp        // ссылка на период
  ) : date;
  //----------------------------------------------------------------------------
  #doc
     Получить главный тип периода
  #end
  Function GetMemMainTPer(
    _cRec     : comp        // ссылка на период
  ) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить спецификацию типа периода
  #end
  Function GetMemSpTPer(
    _cRec     : comp        // ссылка на период
  ) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на вышестоящий период
  #end
  Function GetMemNode(
    _cRec     : comp        // ссылка на период
  ) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить признак "листовой период"
  #end
  Function GetMemIsLeaf(
    _cRec     : comp        // ссылка на период
  ) : boolean;
  //****************************************************************************


  //============================================================================
  //                                 COMMON
  //----------------------------------------------------------------------------
  #doc
     Является ли заданный период, подчиненным указанному
  #end
  Function GetIsSubPeriod(
    _cUpp     : comp;       // вышестоящий период
    _cRec     : comp        // ссылка на период
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить период по спецификации типа и дате
  #end
  Function GetPeriodBySpTPerDate(
    _cSpTPer  : comp;       // спецификация типа периода
    _dtDate   : date        // дата
  ) : comp;                 // ссылка на период
  //****************************************************************************


  //============================================================================
  //                               MAKEMARKER
  //----------------------------------------------------------------------------
  #doc
     Построить список всех подчиненных периодов
  #end
  Function MakeMarkerPeriod(
    _MID      : TPtr; // ID маркера
    _cRec     : comp        // ссылка на период
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Построить список листовых подчиненных периодов
  #end
  Function MakeMarkerLeafPeriod(
    _MID      : TPtr; // ID маркера
    _cRec     : comp        // ссылка на период
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Построить список листовых подчиненных периодов для "входящих" остатков
  #end
  Function MakeMarkerLeafInpSaldPeriod(
    _MID      : TPtr; // ID маркера
    _cRec     : comp        // ссылка на период
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Построить список листовых подчиненных периодов для "исходящих" остатков
  #end
  Function MakeMarkerLeafOutSaldPeriod(
    _MID      : TPtr; // ID маркера
    _cRec     : comp        // ссылка на период
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Построить список вышестоящих периодов
  #end
  Function MakeMarkerUpperPeriod(
    _MID      : TPtr; // ID маркера
    _cRec     : comp        // ссылка на период
  ) : boolean;
  //****************************************************************************

End; // ObjInterface


//==============================================================================
VipInterface QuickFpPeriod implements IQuickFpPeriod
#Licensed_Free;
Public:
  Constructor Init;
  Destructor  Done;
End;


#endif//__fpQPer_Vih__
