//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Интерфейс взаимодействия с типами периодов
//------------------------------------------------------------------------------

#ifndef __ExtFpTPer_VIH
#define __ExtFpTPer_VIH

#ifdef  ComponentVersion
#component "F_FpCatalog"
#endif //ComponentVersion

#doc
Интерфейс взаимодействия с типами периодов
#end
ObjInterface IExtFpTPer;

//==============================================================================
//                                  INIT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция перегрузки таблицы типов периодов в памяти
#end
Function RetrieveTbl : boolean;

//==============================================================================
//                               FIELDS (Get)
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает код сортировки типа периода во всей иерархии
#end
Function GetCode    (_cRec : comp) : string;
//------------------------------------------------------------------------------
#doc
   Функция возвращает наименование типа периода
#end
Function GetName    (_cRec : comp) : string;
//------------------------------------------------------------------------------
#doc
   Функция возвращает ссылку на вышестоящий тип периода
#end
Function GetNode    (_cRec : comp) : comp;
//------------------------------------------------------------------------------
#doc
   Функция возвращает единицу измерения заданного типа периода
#end
Function GetEdIzm   (_cRec : comp) : word;
//------------------------------------------------------------------------------
#doc
   Функция возвращает длину периода заданного типа периода
#end
Function GetLenPer  (_cRec : comp) : word;
//------------------------------------------------------------------------------
#doc
   Функция возвращает главный тип периода для заданного типа периода
#end
Function GetMainTPer(_cRec : comp) : comp;
//------------------------------------------------------------------------------
#doc
   Функция возвращает листовой тип периода для заданного типа периода
#end
Function GetLeafTPer(_cRec : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Функция проверяет относится ли заданный тип периода к текущему типу периода планирования
#end
Function IsCurTPer  (_cRec : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Функция проверяет является ли один тип периода подпериодом другого типа периода
#end
Function IsSubTPer(cMasterTPer : comp; cSlaveTPer : comp) : boolean;

//==============================================================================
//                                  COMMON
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить текущий тип периода планирования бюджета
#end
Function GetCurrentFpTPer : comp;
//------------------------------------------------------------------------------
#doc
   Запуск диалога изменения текущего типа периода планирования бюджета
#end
Function RunSetCurrentFpTPer(
    _cMainTPer : comp  // новый тип периода
) : boolean;

//==============================================================================
//                                  DIALOG
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает имя маркера типа периодов планирования
#end
Function GetMarkerName : string;
//------------------------------------------------------------------------------
#doc
   Функция запуска окна выбора/редактирования типов периодов планирования
#end
Function RunViewTPer(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOCONST.INC
    _cNodeTop : comp;  // вывод только ветки с вершиной cNodeTop, чтобы все дерево cNodeTop=comp(0)
var _cGetRec  : comp   // выбранный тип периода
) : integer;
//------------------------------------------------------------------------------
#doc
   Функция запуска окна выбора/редактирования типов периодов планирования с возможностью выбора только главных типов периодов (вершин)
#end
Function RunViewMainTPer(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOCONST.INC
    _cNodeTop : comp;  // вывод только ветки с вершиной cNodeTop, чтобы все дерево cNodeTop=comp(0)
var _cGetRec  : comp   // выбранный тип периода
) : integer;
//------------------------------------------------------------------------------
#doc
   Функция запуска окна выбора/редактирования спецификации типа периода
#end
Function RunViewSpTPer(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOCONST.INC
    _cTopRec  : comp;  // тип периода
    _cNodeTop : comp;  // вывод только ветки с вершиной cNodeTop, чтобы все дерево cNodeTop=comp(0)
var _cGetRec  : comp   // выбранная спецификация типа периода
) : integer;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
end; // IExtFpTPer

VipInterface vExtFpTPer implements IExtFpTPer
#Licensed_Free
; // VipInterface vExtFpTPer

#endif  // __ExtFpTPer_VIH
