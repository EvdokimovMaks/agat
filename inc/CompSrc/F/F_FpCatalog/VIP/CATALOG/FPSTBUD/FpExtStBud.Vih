//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Интерфейс взаимодействия : "Статьи бюджетов"
//------------------------------------------------------------------------------

#ifndef __FpExtStBud_Vih__
#define __FpExtStBud_Vih__

#ifdef  ComponentVersion
#component "F_FpCatalog"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include FpStBud.Inc  // все типы "Статьи бюджета"
//------------------------------------------------------------------------------

//==============================================================================
#doc
Интерфейс взаимодействия : "Статьи бюджетов"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface IExtFpStBud;  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает описание последней ошибки
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывод сообщения последней ошибки
  #end
  Function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region INIT
  //----------------------------------------------------------------------------
  #doc
     Перечитать таблицы в памяти
  #end
  Function RetrieveTbl : boolean;
  //#endregion INIT
  //****************************************************************************


  //============================================================================
  //#region FIELDS
  //----------------------------------------------------------------------------
  #doc
     Проверка существования заданной статьи
  #end
  Function IsExist(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить наименование статьи бюджета
  #end
  Function GetName(
      _cRec : comp     // ссылка на статью бюджта
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на вышестоящую статью бюджета
  #end
  Function GetNode(
      _cRec : comp     // ссылка на статью бюджта
  ) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить аббревиатуру статьи бюджета
  #end
  Function GetAbbr(
      _cRec : comp     // ссылка на статью бюджта
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить группу аналитик заданной статьи
  #end
  Function GetGrAn(
      _cRec : comp     // ссылка на статью бюджта
  ) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить валюту заданной статьи
  #end
  Function GetVal(
      _cRec : comp     // ссылка на статью бюджта
  ) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить единицу измерения заданной статьи
  #end
  Function GetEd(
      _cRec : comp     // ссылка на статью бюджта
  ) : comp;

  //----------------------------------------------------------------------------
  #doc
     Получить код сортировки статьи бюджета во всей иерархии
  #end
  Function GetCode(
      _cRec : comp     // ссылка на статью бюджта
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить код сортировки статьи бюджета на соответствующем уровне иерархии
  #end
  Function GetLevelCode(
      _cRec : comp     // ссылка на статью бюджта
  ) : string;

  //----------------------------------------------------------------------------
  #doc
     Является ли данная статья бюджета расчетной "по формуле"
  #end
  Function GetIsCalc(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на вышестоящий агрегат статьи бюджета
  #end
  Function GetAgr(
      _cRec : comp     // ссылка на статью бюджта
  ) : comp;
  //----------------------------------------------------------------------------
  #doc
     Является ли статья "агрегатом"
  #end
  Function GetIsAgr(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить аттрибуты статьи
  #end
  Function GetAttr(
      _cRec : comp     // ссылка на статью бюджта
  ) : word;
  //----------------------------------------------------------------------------
  #doc
     Установлен ли атрибут "в т.ч."
  #end
  Function GetIsVTCh(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установлен ли атрибут "внутренний оборот"
  #end
  Function GetIsVnOb(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установлен ли атрибут "спец расчет" 
  #end
  Function GetIsSpecR(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Установлен ли атрибут "сальдируемая"
  #end
  Function GetIsSaldo(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установлен ли атрибут "входящий остаток"
  #end
  Function GetIsInpSaldo(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установлен ли атрибут "исходящий остаток"
  #end
  Function GetIsOutSaldo(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установлен ли атрибут "среднее арифметическое по периоду"
  #end
  Function GetIsAVG_PP(
      _cRec : comp     // ссылка на статью бюджта
  ) : boolean;
  //#endregion FIELDS
  //****************************************************************************


  //============================================================================
  //#region АЛГОРИТМ РАСЧЕТА СТАТЬИ
  //----------------------------------------------------------------------------
  #doc
     Получить формулу вычисления в заданном варианте использования
  #end
  Function GetUsedExpr(
    _cRec    : comp;   // ссылка на статью бюджета
    _cAlgVar : comp;   // вариант расчета
    _cBudCO  : comp    // ЦО бюджета
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Является ли статья "агрегатом" в заданном варианте использования
  #end
  Function GetUsedIsAgr(
    _cRec    : comp;   // ссылка на статью бюджета
    _cAlgVar : comp;   // вариант расчета
    _cBudCO  : comp    // ЦО бюджета
  ) : boolean;
  //#endregion АЛГОРИТМ РАСЧЕТА СТАТЬИ
  //****************************************************************************


  //============================================================================
  //#region АНАЛИТИКА СТАТЬИ
  //----------------------------------------------------------------------------
  #doc
     Используется ли заданная аналитика по статье
  #end
  Function GetIsAnUsed(
    _cRec    : comp;   // ссылка на статью бюджета
    _wAn     : word    // код аналитики
  ) : boolean;
  //#endregion АНАЛИТИКА СТАТЬИ
  //****************************************************************************


  //============================================================================
  //#region MAKEMARKER
  //----------------------------------------------------------------------------
  #doc
     Построить список подчиненных статей
  #end
  Function MakeMarkerStBud(
    _MID  : LongInt;  // ID маркера
    _cRec : comp      // ссылка на статью бюджета
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Построить список листовых подчиненных статей
  #end
  Function MakeMarkerLeafStBud(
    _MID  : LongInt;  // ID маркера
    _cRec : comp      // ссылка на статью бюджета
  ) : boolean;
  //#endregion MAKEMARKER
  //****************************************************************************


  //============================================================================
  //#region DIALOG
  //----------------------------------------------------------------------------
  #doc
     Получить имя маркера для каталога статей бюджетов
  #end
  Function GetMarkerName : string;
  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса статей бюджета
  #end
  Function RunViewFpStBud(
      _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOCONST.INC
      _cNodeTop : comp;  // вывод только ветки с вершиной cNodeTop, чтобы все дерево cNodeTop=comp(0)
  var _cGetRec  : comp   // выбранная статья бюджета
  ) : integer;
  //#endregion DIALOG
  //****************************************************************************


End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface vExtFpStBud implements iExtFpStBud
#Licensed_Free;
Public:
  Constructor Init;
  Destructor  Done;
End;
//******************************************************************************


#endif//__FpExtStBud_Vih__

