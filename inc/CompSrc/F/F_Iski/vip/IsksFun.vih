/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Оперативный контур                                        ║
 ║ Версия        : 5.8+                                                      ║
 ║ Назначение    : процедура заполнения расчетных таблиц по оплате по факту  ║
 ║ Ответственный : Станевич Ю.О.                                             ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

//-----------------------------------------------------------------------------

#ifNdef __IsksFun_vih__
#define __IsksFun_vih__

//-----------------------------------------------------------------------------

#ifdef ComponentVersion
#component "F_ISKI"
#end

//-----------------------------------------------------------------------------

ObjInterface ObjIskFun;

  procedure PrintCalculation( pIsk : Comp; pMode : Word); // печать расчета по иску
  function  MakeCalculation ( pIsk : Comp) : Boolean;     // функция пересчета спецификации иска
  procedure PubDeleteSpIsk( pIsk : Comp);                 // Удаление спецификации иска

  Procedure FillTables_mtMcUsl(tcIsk : comp);

  // функция возвращает сумму оплаченного основного долга
  Function GetOplSumByIsk(tcIsk : comp; tCalcDate : date; _wOkSpIsk : word) : double;

  // функция возвращает сумму оплаченной пени
  Function GetOplPenyByIsk(tcIsk : comp; tCalcDate : date) : double;

  // процедура получения сумм отгрузок и оплат по договору
  // tSumOtgr, tSumOpl - отгружено-оплачено всего; tSumOtgrNeedPlat - отгрузки которые нужно было оплатить на дату tCalcDate
  // tSumOplByProsr - платежи по отгрузкам, которые нужно было оплатить на дату tCalcDate
  // ВНИМАНИЕ! В связи с последними изменениями в суммы по договорным условиям мы не будем включать отгрузки,
  // по которым проводилась реструктуризация долга и платежи по этим отгрузкам. Просроченный реструктуризированный долг
  // будем прибавлять на внешнем уровне.
  Procedure GetOtgrOplByDogovor(tcDogovor : comp; tCalcDate : date; var tSumOtgr : double; var tSumOtgrNeedPlat : double; var tSumOpl : double; var tSumOplByProsr : double);

  // процедура получения сумм отгрузок и оплат по ДО
  Procedure GetOtgrOplByDO(tcBaseDoc : comp; tCalcDate : date; var tSumOtgr : double; var tSumOpl : double);
  // Расчет суммы конкретного штрафа
  procedure CalcPenyIsk (pIsk : Comp; pIskOtgr : comp);

  // Полный расчет санкций по всем штрафам иска
  procedure CalcAllPenyIsk (pIsk : Comp);
end;

//-----------------------------------------------------------------------------

VipInterface IIsksFun implements ObjIskFun licensed (Dogovor);

//-----------------------------------------------------------------------------

#end
