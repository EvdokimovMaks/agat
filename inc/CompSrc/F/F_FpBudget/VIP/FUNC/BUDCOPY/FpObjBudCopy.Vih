//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Базовый объект : "Копирования бюджетов"
//------------------------------------------------------------------------------

#ifndef __FpObjBudCopy_Vih__
#define __FpObjBudCopy_Vih__

#include FpObjBudCopy.Inc    // Типы данных и константы объекта копирования бюджетов
#include FpObjBudCopy.Tbl    // Таблицы объекта копирования бюджетов

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Базовый объект : "Копирования бюджетов"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface iObjFpBudCopy;

  //============================================================================
  //                                  ERROR
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает описание последней ошибки
  #end
  Function GetStLastError : string;

  //============================================================================
  //                                INIT DONE
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Инициализация сессии
  #end
  Function InitSession(
    _rcCopyInit : TFpBudCopyInit
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Закрытие сессии
  #end
  Function DoneSession : boolean;

  //============================================================================
  //                                   RUN
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Запуск функции проверки корректности
  #end
  Function CheckForCopy(
    _rcCopyStruct : TFpBudCopyStruct
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запуск функции копирования
  #end
  Function BudgetCopy(
    _rcCopyStruct : TFpBudCopyStruct
  )   : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить количество обработанных записей
  #end
  Function GetKolRecount : LongInt;

  //============================================================================
  //                                   DSQL
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Установить режим работы через DSQL
  #end
  Procedure SetDSQLMode(_isDSQL : boolean);
  //----------------------------------------------------------------------------
  #doc
     Включен ли режим работы через DSQL
  #end
  Function GetIsDSQLMode : boolean;

End; // ObjInterface


//------------------------------------------------------------------------------
VipInterface ObjFpBudCopy implements iObjFpBudCopy
#Licensed_Free;
Public:
  Constructor Init;
  Destructor  Done;
End;


#endif//__FpObjBudCopy_Vih__

