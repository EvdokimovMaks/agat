//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Визуальный интерфейс : "Копирование бюджетов"
//------------------------------------------------------------------------------

#ifndef __FpBudCopy_Vih__
#define __FpBudCopy_Vih__

//==============================================================================
#component "F_FpBudget"

//------------------------------------------------------------------------------
#include FpObjBudCopy.Inc    // Типы данных и константы объекта копирования бюджетов
#include FpObjDefModel.Vih
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Визуальный интерфейс : "Копирование бюджетов"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface iFpBudgetCopy;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;

//==============================================================================
//                                  INIT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Инициализация параметров интерфейса
#end
Function InitParam : boolean;

//------------------------------------------------------------------------------
#doc
   Инициализация параметров интерфейса по заданным параметрам
#end
Function InitByStru(
  _rcBudCopyAll : TFpBudCopyAll
) : boolean;


//==============================================================================
//                                 COMMON
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Проверка корректности задания
#end
Function CheckAllSet : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск интерфейса на выполнение
#end
Function RunOperation : boolean;

//------------------------------------------------------------------------------
#doc
   Установить имя лог файла
#end
Function SetLogFile(_sLogFileName : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Провести смещение периодов
#end
Function DoShiftPer(
  _cTPer  : comp;     // тип периода
  _iShift : integer   // смещение   
) : boolean;

//==============================================================================
//                                 FPITUNE
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Загрузить настройки интерфейса
#end
Function Read_ITune(_cTune : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Сохранить настройки интерфейса
#end
Function Save_ITune(_cTune : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить настройки интерфейса
#end
Function Del_ITune (_cTune : comp) : boolean;


//==============================================================================
//                        FPITUNE КОПИРОВАНИЕ БЮДЖЕТОВ
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Загрузка из менеджера бюджетов источников
#end
Function Read_ITuneNMainBudSrc(_cTune : comp; _wEntity : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Загрузка из менеджера бюджетов приемников
#end
Function Read_ITuneNSlaveBudSrc(_cTune : comp; _wEntity : word) : boolean;

End; // ObjInterface


//------------------------------------------------------------------------------
VipInterface FpBudgetCopy implements iFpBudgetCopy, iObjFpDefModel
#Licensed_Free;


#endif//__FpBudCopy_Vih__

