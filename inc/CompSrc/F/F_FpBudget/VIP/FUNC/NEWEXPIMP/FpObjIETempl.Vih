//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Базовый объект : "Шаблон Экспорт/Импорта"
//------------------------------------------------------------------------------

#ifndef __FpObjIETempl_Vih__
#define __FpObjIETempl_Vih__

//------------------------------------------------------------------------------
#include FpIETempl.Inc  // типы/константы сущности : "Шаблон Экспорт/Импорта"
#include FpIETempl.Tbl  // таблицы сущности : "Шаблон Экспорт/Импорта"
//------------------------------------------------------------------------------
#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Базовый объект : "Шаблон Экспорт/Импорта"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iObjFpIETemplater;
//==============================================================================
//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
//------------------------------------------------------------------------------
Function BufGetHeadAnType  (_Buff : TPFpIEHeadFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetHeadKodGrKau(_Buff : TPFpIEHeadFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetHeadAnMean  (_Buff : TPFpIEHeadFld) : comp;
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetBodyAnType  (_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetBodyKodGrKau(_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetBodyFldName (_Buff : TPFpIEBodyFld) : string;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetBodyFldNumber(_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetBodyFldType (_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetBodyStartPos(_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetBodyStopPos (_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
Function BufGetBodyFldLenght(_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона вариант<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetHeadVariant (_cFixTempl : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона стадию<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _FileName  - файл по которому уже были проимпортированы финоперации<br>
   </ul> 
#end
Function GetHeadStage (_cFixTempl : comp; _FileName : string) : string;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона код регистра<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetHeadKodReg (_cFixTempl : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона тип периода<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetHeadTPer (_cFixTempl : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона режим загрузки<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetLoadMode(_cFixTempl : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона делать ли резервную копию<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end

//------------------------------------------------------------------------------
Function GetIsRezerwCopy(_cFixTempl : comp) : boolean;

#ifndef __FpSpecPostRuNewDict__
//------------------------------------------------------------------------------
// Получить шаблон по деревянной таблице
// _cTmpKat - Nrec дерева
//------------------------------------------------------------------------------
#doc
  nction GetTemplate(_cTmpKat : comp) : comp;<br>
   Получить дерево по шаблону<br>
   _cFixKat - шаблон<br>
   wMode    - режим<br>
#end
//------------------------------------------------------------------------------
Function GetTreeTemplate(_cFixKat : comp; _wMode : word ) : comp;
#endif // _FpSpecPostRuNewDict__

//==============================================================================
//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
//------------------------------------------------------------------------------
Function BufSetHeadAnType  (var _Buff : TPFpIEHeadFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
Function BufSetHeadKodGrKau(var _Buff : TPFpIEHeadFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
Function BufSetBodyAnType  (var _Buff : TPFpIEBodyFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
Function BufSetBodyKodGrKau(var _Buff : TPFpIEBodyFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
Function BufSetBodyStartPos(var _Buff : TPFpIEBodyFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
Function BufSetBodyStopPos (var _Buff : TPFpIEBodyFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить фильтр по теме письма<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _sSubj - тема письма<br>
   </ul> 
#end
Function SetFltSubj(_cFixTempl : comp; _sSubj : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить фильтр по адресу отправителя<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _sAddr - адрес отправителя<br>
   </ul> 
#end
Function SetFltAddr(_cFixTempl : comp; _sAddr : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить фильтр по телу письма<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _sBody - тело письма<br>
   </ul> 
#end
Function SetFltBody(_cFixTempl : comp; _sBody : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить в фильтр начальную дату<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _Dt - начальная дата<br>
   </ul> 
#end
Function SetFltStartDt(_cFixTempl : comp; _Dt : Date) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить в фильтр конечную дату<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _Dt - конечная дата<br>
   </ul> 
#end
Function SetFltStopDt(_cFixTempl : comp; _Dt : Date) : boolean;

//==============================================================================

//------------------------------------------------------------------------------
#doc
   Получить фильтр по теме письма<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetFltSubj(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить фильтр по адресу отправителя<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetFltAddr(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить фильтр по телу письма<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetFltBody(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить из фильтра начальную дату с которой будет начинаться обработка писем<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetFltStartDt(_cFixTempl : comp) : Date;

//------------------------------------------------------------------------------
#doc
   Получить из фильтра конечную дату до которой будет вестись обработка писем<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetFltStopDt(_cFixTempl : comp) : Date;

//------------------------------------------------------------------------------
#doc
   Проверить является ли аналитика таблицы  Аналитика+Сумма<br>
   <ul> 
   <li> _wType - тип аналитики<br>
   </ul> 
#end
Function GetIsAnSumFldType (_wType : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить тип шаблона (DBF,TXT и т.п)<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetTemplType(_cFixTempl : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить кодировку файла<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetPageCode(_cFixTempl : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить символ-разделитель для TXT с разделителями<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetCharDelim(_cFixTempl : comp) : char;

//------------------------------------------------------------------------------
#doc
   Получить получить имя таблицы в XML файле<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
Function GetXMLTableName(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Построить список файлов пакета удовлетворяющих маске<br>
#end
Function FindPackadgeFile(_cTempl : comp): boolean;

//------------------------------------------------------------------------------
#doc
   Получить первый файл пакета удовлетворяющий маске<br>
#end
Function FirstPackadgeFile(var _sFile : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить следующий файл пакета удовлетворяющий маске<br>
#end
Function NextPackadgeFile(var _sFile : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Каталог пакета<br>
#end
Function GetPackadgeKatName(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить маску поиска<br>
#end
Function GetPackadgeFileMask(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Загрузить во временные таблицы аналитику по умолчанию и аналитику таблицы<br>
   для шаблона _cRec<br>
#end
Function LoadMetaTbl(_cRec : comp) : boolean;

//==============================================================================
//==============================================================================
end;

VipInterface ObjFpIETemplater implements iObjFpIETemplater
#Licensed_Free
;

#endif//__FpObjIETempl_Vih__

