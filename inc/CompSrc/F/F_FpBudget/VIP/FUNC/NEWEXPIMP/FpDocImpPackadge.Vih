//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Базовый обьект: "Протокол Импорта/Экспорта"
//------------------------------------------------------------------------------

#ifndef __FpDocImpPackadge_Vih__
#define __FpDocImpPackadge_Vih__

//------------------------------------------------------------------------------
#include FpObjEMailSender.Rec   // описание типов объекта "Формирование EMail сообщений"
//------------------------------------------------------------------------------

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

#ifdef  GAL8_1
#define __FpSpecPostRuNewDict__
#endif//GAL8_1

//------------------------------------------------------------------------------
#doc
Базовый обьект: "Протокол Импорта/Экспорта"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iObjFpDocImpPackadge;

//==============================================================================
//                                INIT-DONE
//------------------------------------------------------------------------------
#doc
   Освобождение ссылок на объекты, провоцирующие циклические зависимости объектов<br>
#end
Function FreeCrossVipRef : boolean;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки<br>
#end
Function GetStLastError : string;

//------------------------------------------------------------------------------
#doc
   Вывод сообщения последней ошибки
#end
Function RunShowError : boolean;

//==============================================================================
//                                 SERVICE
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetWKatalogByCGIFpImpExp(_cgiFpImpExp : word) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetCGIFpImpExpByWKatalog(_wKatalog    : word) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetTiDkByWKatalog       (_wKatalog : word) : word;

//==============================================================================
//                                  FIELDS
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetIsExist(_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить примечание протокола
#end
Function GetName   (_cRec : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить статус протокола
#end
Function GetProtokolStatus(_cRec : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить дату протокола
#end
Function GetProtokolDate  (_cRec : comp) : date;

//------------------------------------------------------------------------------
#doc
   Получить номер протокола
#end
Function GetProtokolNoDoc (_cRec : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить сумму протокола
#end
Function GetProtokolSumma (_cRec : comp) : double;

//------------------------------------------------------------------------------
#doc
   Вставка протокола импорта
#end
Function InsertDocImpProtokol(
  _cgiFpImpExp : word;    // cgiFpImpExp_XXX-константа
  _cTempl      : comp;    // шаблон
  _sFileName   : string;  // файл
  _Status      : word;    // статус импорта
  _wMessage    : word     // режим вывода сообщений
) : comp;

//------------------------------------------------------------------------------
#doc
   Проводился ли раньше импорт файла _sFileName по шаблону _cTempl. Возвращает NRec протокола
#end
Function FindImpInProtokol(_cgiFpImpExp : word; _cTempl : comp; _sFileName : string) : comp;

//------------------------------------------------------------------------------
#doc
   Вставка протокола Email-извещения
#end
Function InsertEmailProtokol(
  _cTempl      : comp;    // шаблон
  _sNote       : string;  // примечание
  _Priority    : word;    // приоритет EMail
  _Status      : word;    // статус импорта
  _Summa       : double;  // сумма 
  _wMessage    : word     // режим вывода сообщений
) : comp;

//------------------------------------------------------------------------------
#doc
   Обновление протокола EMail-извещения
#end
Function UpdateEMailProtokol(
  _cRec        : comp;    // NRec-протокола
  _cTempl      : comp;    // шаблон
  _sNote       : string;  // примечание
  _Priority    : word;    // приоритет EMail
  _Status      : word;    // статус импорта
  _Summa       : double;  // сумма 
  _wMessage    : word     // режим вывода сообщений
): boolean;

//------------------------------------------------------------------------------
#doc
   Удаление протокола
#end
Function DeleteProtokol(
  _cRec        : comp;    // NRec-протокола
  _wMessage    : word     // режим вывода сообщений
) : boolean;


//==============================================================================
// EMAIL FieldS
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetEMailProtPriority(_cRec : comp) : word;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
Function SetEMailProtPriority(_cRec : comp; _Value : word) : boolean;

//==============================================================================
// ФОРМИРОВАНИЕ MEMO ПОЛЯ EMAIL
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Очистить все содержание в MemoEMail
#end
Function MemoEMailClearAll        (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить получателя в MemoEMail
#end
Function MemoEMailSetRecipient    (_cRec : comp; _sValue : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить получателя копии в MemoEMail
#end
Function MemoEMailSetCopyRecipient(_cRec : comp; _sValue : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить тему в MemoEMail
#end
Function MemoEMailSetSubject      (_cRec : comp; _sValue : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Добавить содержимое в MemoEMail
#end
Function MemoEMailAddBody         (_cRec : comp; _sValue : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить вложение в MemoEMail
#end
Function MemoEMailSetAttach       (_cRec : comp; _sValue : string) : boolean;

//==============================================================================
// ФОРМИРОВАНИЕ САМОГО EMAIL
//------------------------------------------------------------------------------
#doc
   Инициализация сессии работы с объектом "Формирование EMail сообщений"
#end
Function EMailInitSession(
  _rcEMailSenderInit : TFpEMailSenderInit
) : boolean;

//------------------------------------------------------------------------------
#doc
   Закрытие сессии работы с объектом "Формирование EMail сообщений"
#end
Function EMailDoneSession : boolean;

//------------------------------------------------------------------------------
#doc
   Публикация EMail сообщения, на соответствующем клиенте
#end
Function EMailMessageSend(_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск диалога настройки режимов формирования EMail
#end
Function Run_IfNeed_EMailCliSendSetting(
var _rcEMailSenderInit : TFpEMailSenderInit
) : boolean;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface ObjFpDocImpPackadge implements iObjFpDocImpPackadge
#Licensed_Free
;

#endif // __FpDocImpPackadge_Vih__
