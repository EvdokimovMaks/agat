//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Cервис работы с FpValues
//------------------------------------------------------------------------------

#include FpTypes.inc

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

//------------------------------------------------------------------------------
#doc
<brief>Cервис работы с FpValues</brief>
ВНИМАНИЕ!!! Грузить всегда через LoadVipRef<br>
Сервис работы с FpValues, позволяет определить изменялась ли данная запись
FpValues в конкретном программном блоке, поиск ведется по полям:<br>
cBudVar + KodReg + cStBud + cPeriod  + cHashAn
#end
ObjInterface iObjLibAdvHistModifFpValues;

//------------------------------------------------------------------------------
#doc
   Очистить временную таблицу хранения уже измененных записей<br>
#end
Procedure ClearFirstValuesTbl;

//------------------------------------------------------------------------------
#doc
   Поиск записи во временной таблице, если не найдена возвращается False и запись
   добавляется во временную таблицу
#end
Function FindInFirstValuesTbl(tFpValuesBuf : TFpValues) : boolean;

//------------------------------------------------------------------------------
#doc
   Обнуляет суммы всех записей FpValues с данными cBudVar + KodReg + cStBud + cPeriod  + cHashAn<br>
#end
Procedure SetFpValuesToNul(tFpValuesBuf : TFpValues);

//------------------------------------------------------------------------------
#doc
   Получить сумму записи FpValues с данными cBudVar + KodReg + cStBud + cPeriod + cHashAn<br>
#end
Function GetFpValuesSumm(tFpValuesBuf : TFpValues) : double;

//------------------------------------------------------------------------------
#doc
   Поиск записи в FpValues, если не найдена возвращается False и запись<br>
#end
Function FindFpValuesByBuff(tFpValuesBuf : TFpValues) : boolean;


//==== ИСПОЛЬЗОВАНИЕ : =========================================================
// если модифицируем FpValues (импорт, копирование, агрегация и т.д.), и надо
// удалять старые значения, то перед тем как сделать AddSum
// делаем if not(FindInFirstValuesTbl(FpValues.Buffer))
//          SetFpValuesToNul(FpValues.Buffer)
//==============================================================================

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface LibAdvHistModifFpValues implements iObjLibAdvHistModifFpValues
#Licensed_Free
;
