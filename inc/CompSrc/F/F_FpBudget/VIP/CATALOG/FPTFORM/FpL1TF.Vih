//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Библиотека сервисных функций синхронизации типовых форм
//------------------------------------------------------------------------------

#ifndef _LibSynchFpTForm_Included_
#define _LibSynchFpTForm_Included_

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

//------------------------------------------------------------------------------
#doc
Библиотека сервисных функций синхронизации типовых форм<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iLibSynchFpTForm;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;


//==============================================================================
//                                SYNCHTFORM
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Перестроить типовую форму
#end
Function ReCalcTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
<brief>Синхронизация типовой формы _cTForm</brief><br>
     Синхронизация типовой формы _cTForm
     _wObVal   = 0 - по книге<br>
     _wObVal   = 1 - по бюджету<br>
     _wRunMode = 0 - не удалять прежнее описание осей<br>
     _wRunMode = 1 - удалять прежнее описание осей!!!<br>
     _wKodReg      - регистр учета<br>
     _cFilter      - фильтр (по книге)<br>
     _cBudVar      - копия варианта (по бюджету)<br>
#end
Function SynchTForm(
    _cTForm   : comp;
    _wObVal   : word;
    _wRunMode : word;
    _wKodReg  : word;
    _cFilter  : comp;
    _cBudVar  : comp
) : boolean;

//------------------------------------------------------------------------------
#doc
<brief>Запуск интерфейса синхронизации типовой формы _cTForm</brief><br>
     Запуск интерфейса синхронизации типовой формы _cTForm
     _wObVal = 0   - по книге<br>
     _wObVal = 1   - по бюджету<br>
#end
Function RunSynchTForm(
    _cTForm  : comp;
    _wObVal  : word;
    _wKodReg : word;
    _cBudVar : comp
) : boolean;

//------------------------------------------------------------------------------
#doc
   Синхронизация иерархии
#end
Function SynchHier(_cTForm : comp; _wMode : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Синхронизация типовых форм после изменения режима "фиртуальные агрегаты"
#end
Function RunReBuildAllOnChangeVirtualAgrMode(
  _wKodGrKau : word;
  _wMode     : word
) : boolean;


//==============================================================================
//                                  STBUD
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Удаление статьи из типовой формы
#end
Function DelStBudInAxis   (_cTForm : comp; _cStBud : comp; _IsReCalcTForm : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Удаление статьи из типовой формы
#end
Function DelAllStBudInAxis(_cTForm : comp; _MID : LongInt; _IsReCalcTForm : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
<brief>Входит ли статья _cStBud в типовую форму _cTForm</brief><br>
     Входит ли статья _cStBud в типовую форму _cTForm
     Просматривать:<br>
     _wMode = 0 - все используемые статьи<br>
     _wMode = 1 - видимые статьи<br>
#end
Function StBudInTForm(
    _cTForm : comp;
    _cStBud : comp;
    _wMode  : word
) : boolean;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface LibSynchFpTForm implements iLibSynchFpTForm
#Licensed_Free
;

#endif // _LibSynchFpTForm_Included_

