//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Библиотека сервисных функций: "Синхронизация типовой формы"
//------------------------------------------------------------------------------

#ifndef _LibSynchFpTForm_Included_
#define _LibSynchFpTForm_Included_

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

//------------------------------------------------------------------------------
#doc
Библиотека сервисных функций: "Синхронизация типовой формы"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface iLibSynchFpTForm;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;


//==============================================================================
//                                SYNCHTFORM
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Перестроить типовую форму
#end
Function ReCalcTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Выполнить синхронизацию значений аналитик типовой формы
#end
Function SynchTForm(
  _cTForm   : comp;      // ссылка на типовую форму
  _wSynSRC  : word;      // источник данных (см. FpSynTF.Inc)
  _wDelMode : word;      // режим удаления прежних данных (см. FpSynTF.Inc)
  _wKodReg  : word;      // код регистра
  _cFilter  : comp;      // ссылка на фильтр
  _cBudVar  : comp;      // копия бюджета
  _FltSBMID : TPtr = 0   // список статей фильтра
) : boolean;

//------------------------------------------------------------------------------
#doc
   Запустить интерфейс синхронизации значений аналитик типовой формы
#end
Function RunSynchTForm(
  _cTForm   : comp;      // ссылка на типовую форму
  _wSynSRC  : word;      // источник данных (см. FpSynTF.Inc)
  _wKodReg  : word;      // код регистра
  _cBudVar  : comp;      // копия бюджета
  _FltSBMID : TPtr = 0   // список статей фильтра
) : boolean;

//------------------------------------------------------------------------------
#doc
   Синхронизация иерархии
#end
Function SynchHier(_cTForm : comp; _wMode : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Синхронизация типовых форм после изменения режима "фиртуальные агрегаты"
#end
Function RunReBuildAllOnChangeVirtualAgrMode(
  _wKodGrKau : word;
  _wMode     : word
) : boolean;


//==============================================================================
//                                  STBUD
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Удаление статьи из типовой формы
#end
Function DelStBudInAxis   (_cTForm : comp; _cStBud : comp; _IsReCalcTForm : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Удаление статьи из типовой формы
#end
Function DelAllStBudInAxis(_cTForm : comp; _MID : TPtr; _IsReCalcTForm : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
<brief>Входит ли статья _cStBud в типовую форму _cTForm</brief><br>
     Входит ли статья _cStBud в типовую форму _cTForm
     Просматривать:<br>
     _wMode = 0 - все используемые статьи<br>
     _wMode = 1 - видимые статьи<br>
#end
Function StBudInTForm(
    _cTForm : comp;
    _cStBud : comp;
    _wMode  : word
) : boolean;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface LibSynchFpTForm implements iLibSynchFpTForm
#Licensed_Free
;

#endif // _LibSynchFpTForm_Included_
