//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Интерфейс взаимодействия : "Типовые формы бюджетов"
//------------------------------------------------------------------------------

#ifndef _ExtFpTForm_Included_
#define _ExtFpTForm_Included_

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

//------------------------------------------------------------------------------
#doc
Интерфейс взаимодействия : "Типовые формы бюджетов"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface iExtFpTForm;

//==============================================================================
//                               FIELDS (Get)
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "Наименование"
#end
Function GetName            (_cTForm : comp) : string;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "последний номер аналитики 1-й оси"
#end
Function GetLastNpp1        (_cTForm : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "есть аналитика"
#end
Function GetHaveAnMean      (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "типовая форма корректна"
#end
Function GetCorrect         (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "автосинхронизация"
#end
Function GetAutoSynch       (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "ускоренная загрузка аналитик"
#end
Function GetLocalLoadAnMean (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "XXL-метаданные"
#end
Function GetXXLMetaData     (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "XXL-данные"
#end
Function GetXXLData         (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "Не привязывать аналитику к агрегатам"
#end
Function GetAgrAnalitLoad   (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "Удалять прежнюю информацию"
#end
Function GetIsDelAxis       (_cTForm : comp) : boolean;


//==============================================================================
//                               FIELDS (Set)
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "типовая форма корректна"
#end
Function SetCorrect         (_cTForm : comp; _Value : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "автосинхронизация"
#end
Function SetAutoSynch       (_cTForm : comp; _Value : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "ускоренная загрузка аналитик"
#end
Function SetLocalLoadAnMean (_cTForm : comp; _Value : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "Не привязывать аналитику к агрегатам"
#end
Function SetAgrAnalitLoad   (_cTForm : comp; _Value : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "Удалять прежнюю информацию"
#end
Function SetIsDelAxis       (_cTForm : comp; _Value : boolean) : boolean;


//==============================================================================
//                                  LOCK
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Проверка заблокирована ли типовая форма для использования при редактировании бюджета
#end
Function IsLockUseTForm(_cTForm : comp; _isMessage : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Проверка заблокирована ли типовая форма для редактирования
#end
Function IsLockEditTForm(_cTForm : comp; _isMessage : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Проверка заблокирована ли типовая форма
#end
Function IsLockTForm(_cTForm : comp; _isMessage : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Блокировка типовой формы для использования при редактировании бюджета
#end
Function LockUseTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Блокировка типовой формы для редактирования
#end
Function LockEditTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Разблокировка типовой формы для использования при редактировании бюджета
#end
Function UnLockUseTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Разблокировка типовой формы для редактирования
#end
Function UnLockEditTForm(_cTForm : comp) : boolean;

//==============================================================================
//                                AUTORASP
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
Function IsStBudRasp             (_cTForm : comp) : boolean;
Function IsPeriodRasp            (_cTForm : comp) : boolean;
Function IsAnalitRasp            (_cTForm : comp) : boolean;
Function IsAnalitRaspTFormAgr    (_cTForm : comp) : boolean;
Function IsAnalitRaspTFormLeaf   (_cTForm : comp) : boolean;
Function IsAnalitAutoRasp        (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetAutoAlgEditAgrMode   (_cTForm : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetHandleAlgEditAgrMode (_cTForm : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function IsMessageEditAgr        (_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Копирование настроек типовой формы
#end
Function CopyAutoRaspFields(_cDTForm : comp; _cSTForm : comp) : boolean;

//==============================================================================
//                                FORMAT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить количество знаков после запятой
#end
Function GetCellDecimal(_cTForm : comp) : word;

//==============================================================================
//                                TPerView
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Загрузить из БД список видимых типов периодов
#end
Function LoadTFormTPTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Загрузить из БД список аналитик синхронизации
#end
Function LoadTFormKAUTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Сохранить в БД список видимых типов периодов
#end
Function SaveTFormTPTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Сохранить в БД список аналитик синхронизации
#end
Function SaveTFormKAUTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Удалить из БД список видимых типов периодов
#end
Function DelTFormTPTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Удалить из БД список аналитик синхронизации
#end
Function DelTFormKAUTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Скопировать список видимых типов периодов из одной типовой формы в другую
#end
Function CopyTFormTPTune(_cDTForm : comp; _cSTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Скопировать список аналитик синхронизации из одной типовой формы в другую
#end
Function CopyTFormKAUTune(_cDTForm : comp; _cSTForm : comp) : boolean;


//==============================================================================
//                                SYNCHTFORM
//------------------------------------------------------------------------------
#doc
   Выполнить синхронизацию значений аналитик типовой формы
#end
Function SynchTForm(
  _cTForm   : comp;      // ссылка на типовую форму
  _wSynSRC  : word;      // источник данных (см. FpSynTF.Inc)
  _wDelMode : word;      // режим удаления прежних данных (см. FpSynTF.Inc)
  _wKodReg  : word;      // код регистра
  _cFilter  : comp;      // ссылка на фильтр
  _cBudVar  : comp;      // копия бюджета
  _FltSBMID : TPtr = 0   // список статей фильтра
) : boolean;

//------------------------------------------------------------------------------
#doc
   Запустить интерфейс синхронизации значений аналитик типовой формы
#end
Function RunSynchTForm(
  _cTForm   : comp;      // ссылка на типовую форму
  _wSynSRC  : word;      // источник данных (см. FpSynTF.Inc)
  _wKodReg  : word;      // код регистра
  _cBudVar  : comp;      // копия бюджета
  _FltSBMID : TPtr = 0   // список статей фильтра
) : boolean;

//------------------------------------------------------------------------------
#doc
   Синхронизация иерархии
#end
Function SynchHier(_cTForm : comp; _wMode : word) : boolean;

//==============================================================================
//                                  STBUD
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Удаление статьи из типовой формы
#end
Function DelStBudInAxis   (_cTForm : comp; _cStBud : comp; _IsReCalcTForm : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Удаление статьи из типовой формы
#end
Function DelAllStBudInAxis(_cTForm : comp; _MID : TPtr; _IsReCalcTForm : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Входит ли статья _cStBud в типовую форму _cTForm<br>
     Просматривать:<br>
     _wMode = 0 - все используемые статьи<br>
     _wMode = 1 - видимые статьи<br>
#end
Function StBudInTForm(
    _cTForm : comp;
    _cStBud : comp;
    _wMode  : word
) : boolean;

//==============================================================================
//                                  COMMON
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetAllAxis(
    _cTForm : comp;
var _cAxis1 : comp;
var _cAxis2 : comp
) : boolean;

//------------------------------------------------------------------------------
#doc
   Пересчитать типовую форму
#end
Function ReCalcTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить аналитику типовой формы
#end
Function GetAnTForm(_cTForm : comp; _CAn : TPtr) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить типовую форму
#end
Function DelTForm(_cTForm : comp; _isMessage : boolean) : boolean;

//==============================================================================
//                                  DIALOG
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает наименование маркера
#end
Function GetMarkerName : string;

//------------------------------------------------------------------------------
#doc
   Запуск интерфейса редактирования
#end
Function RunAllTForm(
    _wIntMode : word;    // режим
    _cNodeTop : comp;    // вершина
var _cGetRec  : comp     // типовая форма
) : LongInt;

//------------------------------------------------------------------------------
#doc
   Запуск интерфейса доступных типовых форм
#end
Function RunAvTForm(
    _wIntMode : word;    // режим
var _cCO      : comp;    // ЦО
var _cTForm   : comp     // типовая форма
) : LongInt;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface vExtFpTForm implements iExtFpTForm
#Licensed_Free
;

#endif //_ExtFpTForm_Included_
