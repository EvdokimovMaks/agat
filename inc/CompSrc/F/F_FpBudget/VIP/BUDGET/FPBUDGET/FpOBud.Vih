//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Базовый объект : "Бюджеты"
//------------------------------------------------------------------------------

#ifndef __FpOBud_Vih__
#define __FpOBud_Vih__

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Базовый объект : "Бюджеты"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iObjFpBudget;

//==============================================================================
//                                INIT-DONE
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Освобождение ссылок на объекты, провоцирующие циклические зависимости объектов
#end
Function FreeCrossVipRef : boolean;

//==============================================================================
//                                   MODIFY
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получение буфера таблицы по NRec
#end
Function GetBuff(_cRec : comp; var _Buff : type$p_FpBudget) : boolean;

//------------------------------------------------------------------------------
#doc
   Вставка записи по буферу таблицы
#end
Function InsP(var _Buff : type$p_FpBudget) : integer;
//------------------------------------------------------------------------------
#doc
   Изменение записи по буферу таблицы
#end
Function UpdP(var _Buff : type$p_FpBudget) : integer;
//------------------------------------------------------------------------------
#doc
   Удаление записи по буферу таблицы
#end
Function DelP(_Buff : type$p_FpBudget) : integer;

//==============================================================================
//                               FIELDS (Get)
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#declare mDeclGetFun(_Fun,_Type)
Function Buf#_Fun(_Buff : type$p_FpBudget) : #_Type;
Function #_Fun(_cRec : comp) : #_Type;
#end // mDeclGetFun
//------------------------------------------------------------------------------
#mDeclGetFun(GetName       ,string)
#mDeclGetFun(GetCO         ,comp  )
#mDeclGetFun(GetPeriod     ,comp  )
#mDeclGetFun(GetBudStatus  ,word  )
//------------------------------------------------------------------------------
#mDeclGetFun(GetMainTPer   ,comp)
#mDeclGetFun(GetSpTPer     ,comp)

//==============================================================================
//                               FIELDS (Set)
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#declare mDeclSetFun(_Fun,_Type)
Function Buf#_Fun(var _Buff : type$p_FpBudget; _Value : #_Type) : boolean;
Function #_Fun(var _cRec : comp; _Value : #_Type) : boolean;
#end // mDeclSetFun
//------------------------------------------------------------------------------
#mDeclSetFun(SetCO         ,comp)
#mDeclSetFun(SetPeriod     ,comp)
#mDeclSetFun(SetBudStatus  ,word)

//------------------------------------------------------------------------------
#undef mDeclGetFun
#undef mDeclSetFun

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;

//==============================================================================
//                                  RIGHT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Разрешено ли редактирование таблицы бюджетов
#end
Function CanEditTbl(
  _wMessage : word      // режим выдачи сообщений
) : boolean;

//------------------------------------------------------------------------------
#doc
   Разрешено ли редактирование бюджета согласно статусу
#end
Function CanEditByStatus(
  _cBudget  : comp;     // бюджет
  _wMessage : word      // режим выдачи сообщений
) : boolean;
//------------------------------------------------------------------------------
#doc
   Разрешено ли редактирование бюджета
#end
Function CanEditRec(
  _cBudget  : comp;     // бюджет
  _wMessage : word      // режим выдачи сообщений
) : boolean;

//------------------------------------------------------------------------------
#doc
   Разрешен ли просмотр бюджета
#end
Function CanViewValues(
  _cBudget  : comp;     // бюджет
  _wMessage : word      // режим выдачи сообщений
) : boolean;
//------------------------------------------------------------------------------
#doc
   Разрешено ли использование данных бюджета
#end
Function CanUseValues(
  _cBudget  : comp;     // бюджет
  _wMessage : word      // режим выдачи сообщений
) : boolean;
//------------------------------------------------------------------------------
#doc
   Разрешено ли редактировать данные бюджета текущему пользователю
#end
Function CanEditValues(
  _cBudget  : comp;     // бюджет
  _wMessage : word      // режим выдачи сообщений
) : boolean;
//------------------------------------------------------------------------------
#doc
   Разрешено ли редактировать данные бюджета (расширенная версия)
#end
Function CanEditValues_Adv(
  _cBudget  : comp;     // бюджет
  _isByUser : boolean;  // учитывать права текущего пользователя
  _wMessage : word      // режим выдачи сообщений
) : boolean;


//==============================================================================
//                                  COMMON
//------------------------------------------------------------------------------
#doc
   Установить примечание к бюджету
#end
Function SetInfo(_cBudget : comp; sPrim : string) : boolean;

//------------------------------------------------------------------------------
Function FindBudget(
    _cCO       : comp;
    _cPeriod   : comp;
    _wMessage  : word
) : comp;

//------------------------------------------------------------------------------
Function FindAnyAvBudVar(
    _cBudget   : comp;
    _wMessage  : word
) : comp;

//------------------------------------------------------------------------------
Function InsBudget(
    _cCO       : comp;
    _cPeriod   : comp;
    _wMessage  : word
) : comp;

//------------------------------------------------------------------------------
Function InsBudgetAndBudVar(
    _cCO       : comp;
    _cPeriod   : comp;
var _cBudVar   : comp;
var _cVariant  : comp;
var _sStage    : string;
    _wMessage  : word
) : comp;

//------------------------------------------------------------------------------
Function DelBudget(
    _cBudget   : comp;
    _wMessage  : word
) : boolean;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface ObjFpBudget implements iObjFpBudget
#Licensed_Free
;

#endif//__FpOBud_Vih__

