//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Работа с валютой по прогнозному курсу
//------------------------------------------------------------------------------

#ifndef _ObjFpVal_Included_
#define _ObjFpVal_Included_

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Работа с валютой по прогнозному курсу<br>
#end
ObjInterface tFpValObjInterface;

//------------------------------------------------------------------------------
#doc
   Обновление таблиц в памяти и прочее<br>
#end
Procedure Refresh;

//------------------------------------------------------------------------------
#doc
   Получить ссылку на главную валюту, по прогнозному курсу<br>
#end
Function GetRealVal(_cVal : comp) : comp;

//------------------------------------------------------------------------------
#doc
<brief>Получить ссылку на валюту</brief>
   Получить ссылку на валюту, по главной валюте и варианту<br>
   если вариант = 0, то возвратит переданную валюту<br>
   если не найдена валюта по варианту, то возвратит переданную валюту<br>
#end
Function GetVal(_cMainVal : comp; _cVariant : comp) : comp;

//------------------------------------------------------------------------------
#doc
<brief>Получить прогнозный курс на дату</brief>
   Получить прогнозный курс на дату, по главной валюте и варианту,<br>
   если вариант = 0, то возвратит курс по переданной валюте<br>
   если не найдена валюта по варианту, то возвратит курс по переданной валюте<br>
#end
Function Rate(_cMainVal : comp; _cVariant : comp; _dtDat : date) : double;

//------------------------------------------------------------------------------
#doc
<brief>Преобразовать сумму из одной валюты в другую</brief>
   Преобразовать сумму из одной валюты в другую, по прогновному курсу
   на заданную дату<br>
   если вариант = 0, то берется курс по переданной валюте<br>
   если не найдена валюта по варианту, то берется курс по переданной валюте<br>
#end
Function CurrencyExchange(_cMainValFrom : comp;
                          _cVariantFrom : comp;
                          _Sum : Double;
                          _cMainValTo   : comp;
                          _cVariantTo   : comp;
                          _dtDat : date) : double;

//------------------------------------------------------------------------------
#doc
<brief>Преобразовать сумму из одной валюты в другую</brief>
   Преобразовать сумму из одной валюты в другую, по прогновному курсу
   по заданному периоду<br>
   если вариант = 0, то берется курс по переданной валюте<br>
   если не найдена валюта по варианту, то берется курс по переданной валюте<br>
#end
Function CurrencyExchangeByPeriod(_cMainValFrom : comp;
                          _cVariantFrom : comp;
                          _Sum : Double;
                          _cMainValTo   : comp;
                          _cVariantTo   : comp;
                          _cPeriod      : comp) : double;

//------------------------------------------------------------------------------
#doc
   Преобразовать сумму из одной валюты в валюту статьи на заданную дату
#end
Function GetStBudValSum(
  _cValFrom : comp;
  _Sum      : Double;
  _cStBud   : comp;
  _dtDat    : date
) : double;

//------------------------------------------------------------------------------
#doc
   Преобразовать сумму из одной валюты в валюту статьи по заданному периоду
#end
Function GetStBudValSumByPeriod(
  _cValFrom : comp;
  _Sum      : Double;
  _cStBud   : comp;
  _cPeriod  : comp
) : double;

//------------------------------------------------------------------------------
#doc
   Преобразовать сумму из одной валюты в другую по заданному периоду
#end
Function ExchangeByPeriod(
                          _cValFrom : comp;
                          _Sum      : Double;
                          _cValTo   : comp;
                          _cPeriod  : comp
                          ) : double;

//------------------------------------------------------------------------------
#doc
   Удалить соответствие для матрицы
#end
Procedure DeleteForecastForMatrix (MatrixID : LongInt);

//------------------------------------------------------------------------------
#doc
   Удалить соответствие по варианту
#end
Procedure DeleteForecastForVarian (cVariant : comp);

//------------------------------------------------------------------------------
#doc
   Удалить все соответствия
#end
Procedure DeleteAllForecast;

//------------------------------------------------------------------------------
#doc
   Построить соответствие всех "реальных" валют для матрицы по варианту
#end
Function BuildForecastForMatrix (MatrixID : LongInt; cVariant : comp) : boolean;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface ObjFpVal implements tFpValObjInterface
#Licensed_Free
;

#endif
