//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Базовый объект : "Значения показателей бюджетирования"
//------------------------------------------------------------------------------

// в 712 поменяли словарь
#ifdef  GAL7_12
#define __NewDictFpValues__
#endif//GAL7_12

#ifndef __FpOVal_Vih__
#define __FpOVal_Vih__

//------------------------------------------------------------------------------
#include FpTypes.Inc   // Все типы данных FP
#include Fp_Decl.Mac   // макросы функций ObjInterface
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#undef mDeclGetFun
#declare mDeclGetFun(_Fun,_Type)
Function Buf#_Fun(_Buff : type$p_FpValues) : #_Type;
Function #_Fun(_BuffValues : TFpValues) : #_Type;
#end // mDeclGetFun
//------------------------------------------------------------------------------
#undef mDeclSetFun
#declare mDeclSetFun(_Fun,_Type)
Function Buf#_Fun(var _Buff : type$p_FpValues; _Value : #_Type) : boolean;
Function #_Fun(var _BuffValues : TFpValues; _Value : #_Type) : boolean;
#end // mDeclSetFun
//------------------------------------------------------------------------------

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//==============================================================================
#doc
Базовый объект : "Значения показателей бюджетирования"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface iObjFpValues;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Описание последней ошибки
#end
Function GetStLastError : string;
//------------------------------------------------------------------------------
#doc
   Сообщение последней ошибки
#end
Function RunShowError : boolean;

//==============================================================================
//                                 MODIFY
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получение буфера таблицы по NRec
#end
Function GetBuff(_cRec : comp; var _Buff : type$p_FpValues) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetPos03(_BuffDef : TFpValues; var _BuffRes : type$p_FpValues) : boolean;

//------------------------------------------------------------------------------
#mDeclModifyFun(type$p_FpValues)

//==============================================================================
//                               FIELDS (Get)
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#mDeclGetFun(GetIsFix   ,boolean )
#mDeclGetFun(GetIsLimit ,boolean )
#mDeclGetFun(GetSum     ,double  )
#mDeclGetFun(GetAttr    ,word    )

//==============================================================================
//                               FIELDS (Set)
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#mDeclSetFun(SetIsFix   ,boolean )
#mDeclSetFun(SetIsLimit ,boolean )
#mDeclSetFun(SetSum     ,double  )
#mDeclSetFun(AddSum     ,double  )
#mDeclSetFun(SetAttr    ,word    )

#undef mDeclModifyFun
#undef mDeclGetFun
#undef mDeclSetFun

//==============================================================================
//                                 COMMON
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Приводит контейнер CAnForCheck, по слою cSloj
#end
Function OrderContAn(
                      CAnForCheck : TPtr;
                      cSloj       : comp;
                      cDefault    : comp
                    )  : boolean;

//------------------------------------------------------------------------------
#doc
   Приводит хэш cHashForCheck, по слою cSloj
#end
Function OrderHashAn(
                  var cHashForCheck : comp;
                      cSloj         : comp;
                      cDefault      : comp
                    )  : boolean;

//------------------------------------------------------------------------------
Function IsSubContAn(_CAnMain : TPtr; _CAnSlave : TPtr) : boolean;

//------------------------------------------------------------------------------
#doc
   Построить список FpValues-ов, "подчиненных" заданному
   по аналитикам в контейнере
#end
Function MakeValuesSubList_ContAn(
                      _BuffValues      : TFpValues;
                      _ContAnID        : TPtr;
                      _SubListID       : TPtr
                      ) : boolean;

//------------------------------------------------------------------------------
#doc
   Формируем Hash для заданной статьи по переданному контейнеру аналитик
#end
Function GetHashByStBud(_cStBud : comp; _CAn : TPtr) : comp;

//------------------------------------------------------------------------------
#doc
   Добавить ко всем слоям, для заданного BuffValues, сумму Summa
#end
Function AddSumByOtherSlojs(
                      _BuffValues      : TFpValues;
                      _DeltaSumma      : double) : boolean;

//------------------------------------------------------------------------------
#doc
   Добавить ко всем слоям, для заданного BuffValues, сумму Summa
#end
Function AddSumByAllSlojs(
                      _BuffValues      : TFpValues;
                      _DeltaSumma      : double) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить все суммы по всем слоям по заданному BuffValues
#end
Function DelAllSumByAllSlojs(
                      _BuffValues      : TFpValues) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить все суммы по всем слоям по заданному BuffValues
   и аналитикам "подчиненным", аналитикам в контейнере
#end
Function DelAllSumByAllSlojs_ContAn(
                      _BuffValues      : TFpValues;
                      _ContAnID        : TPtr
                      ) : boolean;


//==============================================================================
//                                 GROUP DELETE
//------------------------------------------------------------------------------
#doc
   Удалить данные по сегментам
#end
Function DeleteValuesBy1Seg(
  _cBudVar : comp     // копия бюджета
) : boolean;
//------------------------------------------------------------------------------
#doc
   Очистить данные по сегментам
#end
Function ClearValuesBy1Seg(
  _cBudVar : comp     // копия бюджета
) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить данные по сегментам
#end
Function DeleteValuesBy2Seg(
  _cBudVar : comp;    // копия бюджета
  _wKodReg : word     // регистр учета
) : boolean;
//------------------------------------------------------------------------------
#doc
   Очистить данные по сегментам
#end
Function ClearValuesBy2Seg(
  _cBudVar : comp;    // копия бюджета
  _wKodReg : word     // регистр учета
) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить данные по сегментам
#end
Function DeleteValuesBy3Seg(
  _cBudVar : comp;    // копия бюджета
  _wKodReg : word;    // регистр учета
  _cStBud  : comp     // статья
) : boolean;
//------------------------------------------------------------------------------
#doc
   Очистить данные по сегментам
#end
Function ClearValuesBy3Seg(
  _cBudVar : comp;    // копия бюджета
  _wKodReg : word;    // регистр учета
  _cStBud  : comp     // статья
) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить данные по сегментам
#end
Function DeleteValuesBy4Seg(
  _cBudVar : comp;    // копия бюджета
  _wKodReg : word;    // регистр учета
  _cStBud  : comp;    // статья
  _cPeriod : comp     // период
) : boolean;
//------------------------------------------------------------------------------
#doc
   Очистить данные по сегментам
#end
Function ClearValuesBy4Seg(
  _cBudVar : comp;    // копия бюджета
  _wKodReg : word;    // регистр учета
  _cStBud  : comp;    // статья
  _cPeriod : comp     // период
) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить все данные по копии бюджета
#end
Function DelByBudVar(
  _cBudVar : comp     // копия бюджета
) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить все данные по копии бюджета и регистру
#end
Function DelByKodRegBudVar(
  _cBudVar : comp;    // копия бюджета
  _wKodReg : word     // регистр учета
) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить данные по копии бюджета и регистру в "открытом периоде"
#end
Function DelByKodRegBudVarInOpenPeriod(
  _cBudVar : comp;
  _wKodReg : word
) : boolean;
//------------------------------------------------------------------------------
#doc
   Очистить данные по копии бюджета и регистру в "открытом периоде"
#end
Function ClrByKodRegBudVarInOpenPeriod(
  _cBudVar : comp;
  _wKodReg : word
) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить показатель бюджета
#end
Function DelValues(
  _wKodReg : word;    // регистр учета
  _cBudVar : comp;    // копия бюджета
  _cStBud  : comp;    // статья
  _cPeriod : comp     // период
) : boolean;
//------------------------------------------------------------------------------
#doc
   Очистить показатель бюджета
#end
Function ClearValuesSum(
  _wKodReg : word;    // регистр учета
  _cBudVar : comp;    // копия бюджета
  _cStBud  : comp;    // статья
  _cPeriod : comp     // период
) : boolean;

//==============================================================================
//                                   PRINT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Печать атрибутов значения
#end
Function PrintValues(_BuffValues : TFpValues)  : string;

//------------------------------------------------------------------------------
#doc
   Печать атрибутов значения
#end
Function PrintValuesByNRec(_cRec : comp) : string;

End; // ObjInterface

//==============================================================================
VipInterface ObjFpValues implements iObjFpValues
#Licensed_Free;
Public:
  Constructor Init;
  Destructor  Done;
End;


#endif//__FpOVal_Vih__
