//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Базовый интерфейс : "Атрибуты значения показателя"
//------------------------------------------------------------------------------

#ifndef __FpViewCellAttr_Vih__
#define __FpViewCellAttr_Vih__

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Базовый интерфейс : "Атрибуты значения показателя"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface iFpViewCellAttr;
  //----------------------------------------------------------------------------
  #doc
     Описание последней ошибки
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Сообщение последней ошибки
  #end
  Function RunShowError : boolean;

  //----------------------------------------------------------------------------
  #doc
     Инициализация параметров интерфейса
  #end
  Function InitParam(
    _wIntMode    : word;
    _cCellBudVar : comp;
    _cCellVal    : comp;
    _wCellReg    : word;
    _MatID       : LongInt;
    _cCellNRec1  : comp;
    _cCellNRec2  : comp 
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Открыть Memo-поле примечания и получить на него ID
  #end
  Function Info_OpenMemo(
  var _MemoID  : LongInt
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Закрыть Memo-поле примечания по ID
  #end
  Function Info_CloseMemo(
      _MemoID  : LongInt
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запуск окна аттрибутов ячейки
  #end
  Function RunViewCellAttr : boolean;

End;

//------------------------------------------------------------------------------
VipInterface FpViewCellAttr implements iFpViewCellAttr
#Licensed_Free
Parameters (
  wIntMode    : word;     // режим запуска (cgiNo, cgiPick, ...) см.GLOCONST.INC
  cCellBudVar : comp;     // ссылка на копию бюджета
  cCellVal    : comp;     // ссылка на иалюту
  wCellReg    : word;     // код регистра
  MatID       : LongInt;  // ID матрицы куба
  cCellNRec1  : comp;     // ссылка на элемент оси1
  cCellNRec2  : comp      // ссылка на элемент оси2
);
Public:
  Constructor Init;
  Destructor  Done;
End;

#endif//__FpViewCellAttr_Vih__
