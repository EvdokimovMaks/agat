//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Интерфейс взаимодействия : "Блокировка данных бюджета"
//------------------------------------------------------------------------------

#ifndef __FpExtLockBudValues_Vih__
#define __FpExtLockBudValues_Vih__

//------------------------------------------------------------------------------
#include FpLockVal.Inc       // типы данных объекта "Блокировка данных бюджета"
//------------------------------------------------------------------------------

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Интерфейс взаимодействия : "Блокировка данных бюджета"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface IFpExtLockBudValues;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;
//------------------------------------------------------------------------------
#doc
   Вывод сообщения последней ошибки
#end
Function RunShowError : boolean;
//------------------------------------------------------------------------------
#doc
   Функция возвращает имя пользователя заблокировавшего данные
#end
Function GetLastLockUserName : string;
//******************************************************************************


//==============================================================================
//                                 COMMON
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Копирование параметров блокировки
#end
Function CopyLockParam(
    _SLockParam  : TFpLockLaluesParam;
var _DLockParam  : TFpLockLaluesParam
) : boolean;
//******************************************************************************


//==============================================================================
//                                SINGLE WORK
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Заблокировать данные
#end
Function LockValues(
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Снять блокировкиу данных
#end
Function UnLockValues(
  _LockParam : TFpLockLaluesParam
) : boolean;
//******************************************************************************


//==============================================================================
//                               SESSION WORK
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Добавить в список блокировку
#end
Function Session_AddLock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Добавить в список активную блокировку
#end
Function Session_AddALock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Добавить в список пассивную блокировку
#end
Function Session_AddPLock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;

//------------------------------------------------------------------------------
#doc
   Добавить в список блокировку
#end
Function Session_AddLeafLock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Добавить в список листовую активную блокировку
#end
Function Session_AddLeafALock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Добавить в список листовую пассивную блокировку
#end
Function Session_AddLeafPLock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;

//------------------------------------------------------------------------------
#doc
   Возможно ли использовать данные
#end
Function Session_IsMayUse(
  _SessionID  : LongInt;
  _TimeOut    : comp;
  _wMessage   : word
) : boolean;

//------------------------------------------------------------------------------
#doc
   Заблокировать данные
#end
Function Session_TryLock(
  _SessionID : LongInt
) : boolean;
//------------------------------------------------------------------------------
#doc
   Заблокировать данные
#end
Function Session_GuidedTryLock(
  _SessionID : LongInt;
  _TimeOut   : comp;
  _wMessage  : word
) : boolean;
//------------------------------------------------------------------------------
#doc
   Снять блокировкиу данных
#end
Function Session_TryUnLock(
  _SessionID : LongInt
) : boolean;

//------------------------------------------------------------------------------
#doc
   Начало сессии блокировки данных
#end
Function Session_Begin : LongInt;
//------------------------------------------------------------------------------
#doc
   Завершение сессии блокировки данных
#end
Function Session_End(
  _SessionID : LongInt
) : boolean;
//******************************************************************************


//==============================================================================
//                                  DIALOG
//------------------------------------------------------------------------------
#doc
   Запуск интерфейса просмотра блокировок
#end
Function RunViewSemaphor : boolean;
//******************************************************************************


//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End; // ObjInterface

VipInterface FpExtLockBudValues implements IFpExtLockBudValues
#Licensed_Free;
Public:
  Constructor Init;
  Destructor  Done;
End;

#endif//__FpExtLockBudValues_Vih__
