//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Функции синхронизации данных по слоям
//------------------------------------------------------------------------------

#ifndef _ObjSynchSloj_Included_
#define _ObjSynchSloj_Included_

//------------------------------------------------------------------------------
#include FpTypes.Inc     // Все типы данных FP (TFiltValues)
#include LBadRec.Tbl     // Сервисная таблица: "Список некорректный записей"
//------------------------------------------------------------------------------

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

//------------------------------------------------------------------------------
#doc
Функции синхронизации данных по слоям<br>
#end
ObjInterface tSynchSlojObjInterface;
//------------------------------------------------------------------------------
#doc
   Пересчитать все таблицы в памяти<br>
#end
//------------------------------------------------------------------------------
Function MyRetrieveAll : boolean;

//------------------------------------------------------------------------------
#doc
   Приводит контейнер CAnForCheck, по слою cSloj<br>
#end
//------------------------------------------------------------------------------
Function MyOrderContAn(
                      CAnForCheck : TPtr;
                      cSloj       : comp;
                      cDefault    : comp
                    )  : boolean;

//------------------------------------------------------------------------------
#doc
   Приводит хэш cHashForCheck, по слою cSloj<br>
#end
//------------------------------------------------------------------------------
Function MyOrderHashAn(
                  var cHashForCheck : comp;
                      cSloj         : comp;
                      cDefault      : comp
                    )  : boolean;

//------------------------------------------------------------------------------
#doc
   Печать атрибутов значения<br>
#end
//------------------------------------------------------------------------------
Function PrintValues(
                      BuffValues      : TFpValues
                      )  : string;

//------------------------------------------------------------------------------
#doc
   Печать атрибутов значения<br>
#end
//------------------------------------------------------------------------------
Function PrintValuesByNRec(cRec : comp) : string;

//------------------------------------------------------------------------------
#doc
   Проверка некорректных значений<br>
   Некорректные значения:<br>
    - удалять      ((wMode and cgFpKatH_Check_IsDel) = cgFpKatH_Check_IsDel);<br>
    - исправлять   ((wMode and cgFpKatH_Check_IsCorrect) = cgFpKatH_Check_IsCorrect);<br>
#end
//------------------------------------------------------------------------------
Function GetChValuesFilter(var wFltBit : word; var Flt : TFiltValues) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства по Nrec-у таблицы<br>
#end
Function SetChValuesFilter(wFltBit : word; Flt : TFiltValues) : boolean;
Function CheakAllValues(wMode : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Взять сумму для заданного BuffValues<br>
#end
//------------------------------------------------------------------------------
Function GetSum(
                      BuffValues      : TFpValues
                      )  : double;

//------------------------------------------------------------------------------
#doc
   Установить для заданного BuffValues, сумму NewSumma<br>
#end
//------------------------------------------------------------------------------
Procedure SetSum(
                      BuffValues      : TFpValues;
                      NewSumma        : double);

//------------------------------------------------------------------------------
#doc
   Установить для заданного BuffValues, атрибут NewAttr<br>
#end
//------------------------------------------------------------------------------
Procedure SetAttr(
                      BuffValues      : TFpValues;
                      NewAttr         : word);

//------------------------------------------------------------------------------
#doc
   Добавить для заданного BuffValues, сумму DeltaSumma<br>
#end
//------------------------------------------------------------------------------
Procedure AddSum(
                      BuffValues      : TFpValues;
                      DeltaSumma      : double);

//------------------------------------------------------------------------------
#doc
   Удалить FpValues  для заданных параметров<br>
   <ul>
   <li> _KodReg  - код регистра<br>
   <li> _cBudVar - копия варианта<br>
   <li> _cStBud  - статья бюджета<br>
   <li> _cPeriod - период бюджета<br>
   </ul>
#end
//------------------------------------------------------------------------------
Procedure DelAllValue(
                      _KodReg  : word;
                      _cBudVar : comp;
                      _cStBud  : comp;
                      _cPeriod : comp);

//------------------------------------------------------------------------------
#doc
   Удалить суммы по всем слоям, в контейнере, для заданного<br>
   BuffValues<br>
#end
//------------------------------------------------------------------------------
Procedure DelSumBySlojs(
                      BuffValues          : TFpValues;
                      ContAnListSynchHash : TPtr);

//------------------------------------------------------------------------------
#doc
   Удалить суммы по всем слоям, для заданного BuffValues<br>
#end
//------------------------------------------------------------------------------
Procedure DelSumByAllSynchSlojs(
                      BuffValues      : TFpValues);

//------------------------------------------------------------------------------
#doc
   Добавить ко всем слоям, в контейнере, для заданного<br>
   BuffValues, сумму Summa<br>
#end
//------------------------------------------------------------------------------
Procedure AddSumBySlojs(
                      BuffValues          : TFpValues;
                      ContAnListSynchHash : TPtr;
                      ContAnListSynchSloj : TPtr;
                      DeltaSumma          : double);

//------------------------------------------------------------------------------
#doc
   Установить во всех слоям, в контейнере, для заданного<br>
   BuffValues, сумму Summa<br>
#end
//------------------------------------------------------------------------------
Procedure SetSumBySlojs(
                      BuffValues          : TFpValues;
                      ContAnListSynchHash : TPtr;
                      ContAnListSynchSloj : TPtr;
                      DeltaSumma          : double);

//------------------------------------------------------------------------------
#doc
   Добавить ко всем слоям, для заданного BuffValues, сумму Summa<br>
#end
//------------------------------------------------------------------------------
Procedure AddSumByAllSynchSlojs(
                      BuffValues      : TFpValues;
                      DeltaSumma      : double);

//------------------------------------------------------------------------------
#doc
   Установить фильтр по копии варианта<br>
#end
//------------------------------------------------------------------------------
Function SetBudVarFilter(_cBudVar : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Проверить удовлетворяет ли текущая копия условиям фильтрации<br>
#end
//------------------------------------------------------------------------------
Function CheckBudVarFilter(_cBudVar : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Очистить слой, по статье<br>
#end
//------------------------------------------------------------------------------
Function ClearSlojByStBud(cDelSloj : comp; cDelStBud : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Очистить все слои, синхронизированные с переданным<br>
#end
//------------------------------------------------------------------------------
Function ClearAllSlojs(cBaseSloj : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Пересчитать все слои, синхронизированные с переданным<br>
   и на основе переданного<br>
#end
//------------------------------------------------------------------------------
Function ReCalcAllSlojs(cBaseSloj : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Переносит информацию по значению аналитики в значение по прочим<br>
     _wKodAn - код аналитики<br>
     _cMean  - значение аналитики<br>
#end
//------------------------------------------------------------------------------
Function ReMoveKauMeanToOther(_wDelKod : word; _cDelAn : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Для заданной статьи, переносит информацию с одной гр/ан в другую<br>
   с сохранением разноски по аналитикам<br>
   Информация по прежней гр/ан удаляется (в FpValues)!!!<br>
   <ul>
   <li> _cStBud   - статья бюджета<br>
   <li> _cOldGrAn - прежняя гр/ан<br>
   <li> _cNewGrAn - новая гр/ан<br>
   </ul>
#end
//------------------------------------------------------------------------------
Function ReMoveDataOnChangeStBudGrAn(
                      _cStBud   : comp;
                      _cOldGrAn : comp;
                      _cNewGrAn : comp) : boolean;

End;

VipInterface ObjSynchSloj implements tSynchSlojObjInterface
#Licensed_Free
;

#endif

