//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Библиотека функций : "Значения показателей бюджетирования"
//------------------------------------------------------------------------------

#ifndef __FpL3Val_Vih__
#define __FpL3Val_Vih__

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//==============================================================================
#doc
Библиотека функций : "Значения показателей бюджетирования"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
ObjInterface iLibFpValuesBudget;  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает описание последней ошибки
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывод сообщения последней ошибки
  #end
  Function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region MODIFY
  //----------------------------------------------------------------------------
  #doc
     Добавить сумму в бюджет
  #end
  Function AddSumToBudget(
      _cBudVar : comp;     // копия бюджета
      _wKodReg : word;     // код регистра учета
      _cStBud  : comp;     // статья бюджета
      _cPeriod : comp;     // период
      _cHashAn : comp;     // Hash аналитик
      _cVal    : comp;     // валюта суммы
      _Summa   : double    // сумма
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить сумму из бюджета
  #end
  Function GetSumFromBudget(
      _cBudVar : comp;     // копия бюджета
      _wKodReg : word;     // код регистра учета
      _cStBud  : comp;     // статья бюджета
      _cPeriod : comp;     // период
      _cHashAn : comp;     // Hash аналитик
  var _cVal    : comp      // валюта суммы
  ) : double;

  //----------------------------------------------------------------------------
  #doc
     Получить агрегированную (по периоду и аналитике) сумму из бюджета
  #end
  Function GetAgrSumFromBudget(
      _cBudVar : comp;     // копия бюджета
      _wKodReg : word;     // код регистра учета
      _cStBud  : comp;     // статья бюджета
      _cPeriod : comp;     // период
      _CAn     : TPtr;  // ID контейнера аналитик
  var _cVal    : comp;     // валюта суммы
  var _Summa   : double    // сумма
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить агрегированную (по периоду и аналитике) сумму из бюджета в заданной валюте
  #end
  Function GetAgrSumFromBudgetInThisVal(
      _cBudVar : comp;     // копия бюджета
      _wKodReg : word;     // код регистра учета
      _cStBud  : comp;     // статья бюджета
      _cPeriod : comp;     // период
      _CAn     : TPtr;  // ID контейнера аналитик
      _cVal    : comp;     // валюта суммы
  var _Summa   : double    // сумма
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Удалить сумму из бюджета
  #end
  Function DelSumFromBudget(
      _cBudVar : comp;     // копия бюджета
      _wKodReg : word;     // код регистра учета
      _cStBud  : comp;     // статья бюджета
      _cPeriod : comp      // период
  ) : boolean;
  //#endregion MODIFY
  //****************************************************************************


End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface LibFpValuesBudget implements iLibFpValuesBudget
#Licensed_Free;
Public:
  Constructor Init;
  Destructor  Done;
End;
//******************************************************************************


#endif//__FpL3Val_Vih__
