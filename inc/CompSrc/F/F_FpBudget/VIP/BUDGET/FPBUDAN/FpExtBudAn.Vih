//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - модуль "Управление бюджетом"
// Интерфейс взаимодействия : "Аналитика бюджетирования"
//------------------------------------------------------------------------------

#ifndef __ExtFpBudAn_Vih__
#define __ExtFpBudAn_Vih__

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

//------------------------------------------------------------------------------
#include FpBudAn.Def    // define "Аналитика бюджетирования"
#include FpMeanTF.Inc   // все типы "Аналитика бюджетирования"
//------------------------------------------------------------------------------

//==============================================================================
#doc
Интерфейс взаимодействия : "Аналитика бюджетирования"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface IExtFpBudAn;  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает описание последней ошибки
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывод сообщения последней ошибки
  #end
  Function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************

  //============================================================================
  //#region CASH
  //----------------------------------------------------------------------------
  #doc
  <brief>Получить режим кэширования</brief>
     Получить режим кэширования
     <ul>
     <li> FpNo_Cash     - кэширование отключено<br>
     <li> FpNormal_Cash - обычный режим кэширования<br>
     </ul>
  #end
  Function GetCashMode : word;

  //----------------------------------------------------------------------------
  #doc
  <brief>Установить режим кэширования</brief>
     Установить режим кэширования
     <ul>
     <li> _wMode - режим кэширования
       <ul>
       <li> FpNo_Cash     - кэширование отключено<br>
       <li> FpNormal_Cash - обычный режим кэширования<br>
       </ul>
     </ul>
  #end
  Function SetCashMode(_wMode : word) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Перегрузить кэш
  #end
  Function ReInitCash : boolean;
  //#endregion CASH
  //****************************************************************************


  //============================================================================
  //#region АТРИБУТЫ АНАЛИТИКИ
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика иерархической
  #end
  Function IsAnHier         (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Включен ли режим "Виртуальные агрегаты"
  #end
  Function IsVirtualAgrMode (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Включен ли режим "Автосинхронизация"
  #end
  Function IsAnAutoSynch    (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика бюджетируемой
  #end
  Function IsAnBud          (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика пользовательской
  #end
  Function IsAnUser         (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика синонимом
  #end
  Function IsAnSyn          (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить аналитику родителя синонима
  #end
  Function GetAnSynBase     (_wAn : word) : word;

  //----------------------------------------------------------------------------
  #doc
     Получить наименование
  #end
  Function GetAnName        (_wAn : word) : string;
  //#endregion АТРИБУТЫ АНАЛИТИКИ
  //****************************************************************************


  //============================================================================
  //#region АТРИБУТЫ ЗНАЧЕНИЙ АНАЛИТИКИ БЮДЖЕТИРОВАНИЯ
  //----------------------------------------------------------------------------
  #doc
     Получить значения аналитики
  #end
  Function GetMeanName         (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить вышестоящее значения аналитики
  #end
  Function GetMeanNode         (_wAn: word; _cAn: comp) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить код значения аналитики
  #end
  Function GetMeanCode         (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить аббревиятуру значения аналитики
  #end
  Function GetMeanAbbr         (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить унарный оператор значения аналитики
  #end
  Function GetMeanUO           (_wAn: word; _cAn: comp) : word;
  //----------------------------------------------------------------------------
  #doc
     Получить агрегат значения аналитики
  #end
  Function GetMeanAgr          (_wAn: word; _cAn: comp) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить свойство "лист" значения аналитики
  #end
  Function GetMeanIsLeaf       (_wAn: word; _cAn: comp) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить свойство "виртуальный агрегат" значения аналитики
  #end
  Function GetMeanIsVirtualAgr (_wAn: word; _cAn: comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить свойство "базовый агрегат" значения аналитики
  #end
  Function GetMeanBaseAgrMean  (_wAn: word; _cAn: comp) : comp;

  //----------------------------------------------------------------------------
  #doc
     Получить свойство "собственные данные агрегата" значения аналитики
  #end
  Function GetMeanIsAgrOwnData (_wAn: word; _cAn: comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить свойство "владелец" значения аналитики
  #end
  Function GetMeanOwnerAgrMean (_wAn: word; _cAn: comp) : comp;
  //#endregion АТРИБУТЫ ЗНАЧЕНИЙ АНАЛИТИКИ БЮДЖЕТИРОВАНИЯ
  //****************************************************************************


  //============================================================================
  //#region FPAGREGAT
  //----------------------------------------------------------------------------
  #doc
     Есть ли агрегат в контейнере
  #end
  Function IsMeanAgrInContAn(_CAn : TPtr) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Есть ли агрегат в HasAn
  #end
  Function IsMeanAgrInHashAn(_cHasAn : comp) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запуск функции проверки корректности
  #end
  Function CheckAgrKauMeanHash(_cHashAn : comp) : comp;
  //#endregion FPAGREGAT
  //****************************************************************************


  //============================================================================
  //#region АТРИБУТЫ ЗНАЧЕНИЙ АНАЛИТИКИ ГАЛАКТИКИ
  //----------------------------------------------------------------------------
  #doc
     Получить наименование значения аналитики
  #end
  Function GetGalMeanName   (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить вышестоящего значения аналитики
  #end
  Function GetGalMeanNode   (_wAn: word; _cAn: comp) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить код значения аналитики
  #end
  Function GetGalMeanCode   (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить аббревиатуру значения аналитики
  #end
  Function GetGalMeanAbbr   (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить свойство "лист" значения аналитики
  #end
  Function GetGalMeanIsLeaf (_wAn: word; _cAn: comp) : boolean;
  //#endregion АТРИБУТЫ ЗНАЧЕНИЙ АНАЛИТИКИ ГАЛАКТИКИ
  //****************************************************************************

  //============================================================================
  //#region GALAGREGAT
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика иерархической
  #end
  Function IsGalAnHier(_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Есть ли агрегат в контейнере
  #end
  Function IsGalMeanAgrInContAn(_CAn : TPtr) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Есть ли агрегат в HasAn
  #end
  Function IsGalMeanAgrInHashAn(_cHasAn : comp) : boolean;
  //#endregion GALAGREGAT
  //****************************************************************************


  //============================================================================
  //#region MODIFY
  //----------------------------------------------------------------------------
  #doc
     Вставка значения аналитики бюджетирования
  #end
  Function InsAnMean (
      _cMain : comp;
      _wAn   : word;
      _cAn   : comp;
  var _cRec  : comp
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Поиск значения аналитики бюджетирования
  #end
  Function FindAnMean(
      _cMain : comp;
      _wAn   : word;
      _cAn   : comp;
  var _cRec  : comp
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Вставка значения аналитики бюджетирования
  #end
  Function InsAnBud (_wAn : word; _cAn : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Найти для заданного значения аналитики, соответствующее значение в аналитике бюджетирования
  #end
  Function FindAnBud(_wAn : word; _cAn : comp) : comp;

  //----------------------------------------------------------------------------
  #doc
     Существуют ли в бюджетировании значения по заданной аналитике
  #end
  Function IsAnyAnBudExists (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Существуют ли заданное значение аналитики
  #end
  Function IsAnMeanExist    (_cMain : comp; _wAn : word; _cAn : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Реальное ли заданное значение аналитики
  #end
  Function IsRealAnMeanExist(_cMain : comp; _wAn : word; _cAn : comp) : boolean;
  //#endregion MODIFY
  //****************************************************************************


  //============================================================================
  //#region COMMON
  //----------------------------------------------------------------------------
  #doc
     Запуск функции проверки корректности ссылок на вышестоящие
  #end
  Function CheckNode(_cRec : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запуск функции синхронизации иерархии
  #end
  Function ReSetGalNode(_cRec : comp) : boolean;
  //#endregion COMMON
  //****************************************************************************


  //============================================================================
  //#region MAKEMARKER
  //----------------------------------------------------------------------------
  #doc
     Построить список подчиненных значений
  #end
  Function MakeMarkerAnBud(
    _MID   : TPtr;  // ID маркера
    _wAn   : word;     // код аналитики
    _cAn   : comp      // значение аналитики
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Построить список листовых подчиненных значений
  #end
  Function MakeMarkerLeafAnBud(
    _MID   : TPtr;  // ID маркера
    _wAn   : word;     // код аналитики
    _cAn   : comp      // значение аналитики
  ) : boolean;
  //#endregion MAKEMARKER
  //****************************************************************************


  //============================================================================
  //#region DIALOG
  //----------------------------------------------------------------------------
  #doc
     Возвращает имя маркера интерфейса каталога бюджетов
  #end
  Function GetMarkerName : string;
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает наименование маркера значений аналитики Бюджетирования
  #end
  Function GetBudAnMarkerName(_wAn : word) : string;
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает наименование маркера значений аналитики Галактики
  #end
  Function GetGalAnMarkerName(_wAn : word) : string;

  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса выбора значений аналитики Галактики
  #end
  Function RunViewGalAnMean(
      _wIntMode : word;    // режим (выбор/просмотр: cgiNo, cgiPick,...)
      _wAn      : word;    // КАУ
  var _cAn      : comp     // значение выбранной аналитики
  ) : LongInt;
  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса просмотра
  #end
  Function RunViewSimpleGalAnMean(
      _wIntMode : word;    // режим (выбор/просмотр: cgiNo, cgiPick,...)
      _wAn      : word;    // КАУ
  var _cAn      : comp     // значение выбранной аналитики
  ) : LongInt;

  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса выбора значение аналитики бюджетирования
  #end
  Function RunViewBudAnMean(
      _wIntMode : word;    // режим (выбор/просмотр: cgiNo, cgiPick,...)
      _wAn      : word;    // КАУ
  var _cAn      : comp     // значение выбранной аналитики
  ) : LongInt;

  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса выбора КАУ
  #end
  Function RunViewBudAn(
      _wIntMode : word;    // Режим запуска (выбор/просмотр: cgiNo, cgiPick,...)
  var _wAn      : word     // Код аналитики
  ) : LongInt;
  //#endregion DIALOG
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface vExtFpBudAn implements IExtFpBudAn
#Licensed_Free;
Public:
  Constructor Init;
  Destructor  Done;
End;
//******************************************************************************


#endif  // __ExtFpBudAn_Vih__
