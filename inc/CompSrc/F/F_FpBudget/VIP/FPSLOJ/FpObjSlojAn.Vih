//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Базовый объект : "Слои аналитик в FP"
//------------------------------------------------------------------------------

#ifndef __FpObjSlojAn_Vih__
#define __FpObjSlojAn_Vih__

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

//------------------------------------------------------------------------------
#doc
Базовый объект : "Слои аналитик в FP"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iObjFpSlojAn;

//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;

//------------------------------------------------------------------------------
// FIELDS
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#undef mDeclGetFun
#declare mDeclGetFun(_Fun,_Type)
Function Buf#_Fun(_Buff : type$p_Sloj) : #_Type;
Function #_Fun(_cRec : comp) : #_Type;
#end // mDeclGetFun
//------------------------------------------------------------------------------
#mDeclGetFun(GetName            ,String  )
#mDeclGetFun(GetGrAn            ,Comp    )
#mDeclGetFun(GetIsGrAn          ,Boolean )
#mDeclGetFun(GetIsSubSlojExist  ,Boolean )
#mDeclGetFun(GetIsUsed          ,Boolean )
#mDeclGetFun(GetIsUsedGrAn      ,Boolean )
#mDeclGetFun(GetIsUsedSloj      ,Boolean )
#mDeclGetFun(GetSlojKolAn       ,Integer )

//------------------------------------------------------------------------------
// RIGHT
//------------------------------------------------------------------------------
#doc
   Проверка прав доступа
#end
Function CanEditTbl : boolean;
//------------------------------------------------------------------------------
#mDeclGetFun(CanInsUpdSpGrAn    ,Boolean )
#mDeclGetFun(CanInsUpdSpSloj    ,Boolean )
#mDeclGetFun(CanDelSpGrAn       ,Boolean )
#mDeclGetFun(CanDelSpSloj       ,Boolean )


//------------------------------------------------------------------------------
// MODIFY
//------------------------------------------------------------------------------
#doc
   Вставка спецификации слоя аналитик
#end
Function ReInsSpSloj (_cRec : comp; _CAnID : TPtr) : boolean;

//------------------------------------------------------------------------------
#doc
   Удаление слоя аналитик
#end
Function DeleteSloj  (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Удаление группы аналитик
#end
Function DeleteGrAn  (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Удаление
#end
Function DeleteAny   (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
<brief>Запуск функции проверки корректности</brief>
   Проверяет может ли существовать слой/группа слоев построенная по
   аналитикам из переданного контейнера, если нет - возвращает comp(0).<br>
   Если может, смотрит подходит ли группа аналитик как слой для
   переданного контейнера аналитик, если да - возвращает GrAn.NRec
   если нет ищет слой в группе аналитик, соответствующий аналитикам переданным
   в контейнере аналитик, если находит - возвращает Sloj.NRec.
   Если не находит, то если IsInsert = False - возвращает comp(0).<br>
   Если IsInsert = True,  создает такой слой - возвращает Sloj.NRec.<br>
   Параметры:<br>
   ContAnToFindSloj - идентификатор контейнера<br>
   IsInsert         - создавать или нет слой если не найден<br>
   wError           - код ошибки<br>
      wError  = 1   - Не найдена группа аналитик<br>
      wError  = 2   - Количество переданных аналитик больше чем в группе аналитик<br>
      wError  = 3   - В группе аналитик не найдена аналитика, аналитики из<br>
                      контейнера не совместимы с заданной группой аналитик<br>
      wError  = 4   - Слой не найден, но построен<br>
#end
Function GetSlojByContAn(
    _cGrAn  : comp;
    _CAnID  : TPtr;
    _IsIns  : boolean;
var _wError : word
) : comp;

//------------------------------------------------------------------------------
// CHECK
//------------------------------------------------------------------------------
#doc
   Запуск функции проверки корректности
#end
Function CheckSloj          (_cSloj : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск функции проверки корректности<br>
#end
Function CheckAllSlojsByGrAn(_cGrAn : comp) : boolean;


//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface ObjFpSlojAn implements iObjFpSlojAn
#Licensed_Free
;

#endif//__FpObjSlojAn_Vih__
