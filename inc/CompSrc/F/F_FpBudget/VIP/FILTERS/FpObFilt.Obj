//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Универсальный интерфейс : "Фильтры пользователя"
//------------------------------------------------------------------------------

#ifndef __FpObFilt_Obj__
#define __FpObFilt_Obj__

#include FpTypes.inc

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
type ArrayOfWord = array [0..0] of word;

//------------------------------------------------------------------------------
#doc
Универсальный интерфейс : "Фильтры пользователя"
#end
ObjInterface iObjFpUserFilt;
  //----------------------------------------------------------------------------
  #doc
     Определить возможность установки Bounds-ов на FpOborot
  #end
  Function PossibleBounds(
    var Bnd       : LongInt;       // Bounds-ы которые можно установить
    var BndValues : tFiltValues;   // Режимы фильтрации
        NotSetBnd : LongInt        // Bounds-ы запрещенные к установке
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Определить возможность установки Bounds-ов на FpValues
  #end
  Function PossibleValuesBounds(
    var Bnd : LongInt;             // Bounds-ы которые можно установить
    var BndValues : tFiltValues    // Режимы фильтрации                
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Проверить запись на удовлетворение фильтру
  #end
  Function CheckOborotStateFilter(
        Buf : tFpOborot;
        wState : word;
        Bnd : LongInt
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Проверить запись на удовлетворение фильтру
  #end
  Function CheckFilter(
        Buf : tFpOborot;
        Bnd : LongInt
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Проверить запись на удовлетворение фильтру
  #end
  Function CheckValuesFilter(
        Buf : tFpValues;
        Bnd : LongInt
  ) : boolean;

  //------------------------------------------------------------------------------
  #doc
     Проверяет на соответсвие фильтру, заданных полей
  #end
  Function CheckThisSimpleAnalitika(
    _cCO : comp;     // ЦО
    _cPP : comp;     // Период
    _cSB : comp;     // Статья бюджета
    _Bnd : LongInt   // Ограничения которые проверять не надо
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Установка фильтра
  #end
  Function SetFilter(
    tcFilter : comp;
    DopParam : LongInt // 0-аналитика документа, 1-аналитика статьи
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Снятие фильтра
  #end
  Procedure ReSetFilter;

  //----------------------------------------------------------------------------
  #doc
     Снятие фильтра
  #end
  Procedure ClearTmpFilter;

  //----------------------------------------------------------------------------
  #doc
     Добавить спецификацию фильтра
  #end
  Function AddFilter(
      wType     : word;    // Тип спецификации фильтра (константа cgFpGroup_XX)
      wKod      : word;    // KodGrKau (только для cgFpGroup_Kau)
      wFilter   : word;    // Отношения для фильтрации:
                           //   0 - 'нет'
                           //   1 - '='
                           //   2 - '<>'
                           //   3 - '<='
                           //   4 - '=>'
      CurMark   : LongInt; // кол-во эл-ов в tChoice
      ResComp_1 : comp     // ссылка tChoice или само значение поля (wType = 6)
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства
  #end
  Function GetSpFilter(
      wType   : word;      // Тип спецификации фильтра (константа cgFpGroup_XX) 
      wKod    : word;      // KodGrKau (только для cgFpGroup_Kau)               
  var wFilter : word;      // Отношения для фильтрации:
                           //   0 - 'нет'
                           //   1 - '='
                           //   2 - '<>'
                           //   3 - '<='
                           //   4 - '=>'
  var Value   : comp;      // значение элемента в фильтре (в случае одиночного фильтра)
      FltMID  : LongInt    // маркер со значениями элементов фильтра
  ) : integer;             // количество элементов в фильтре

  //----------------------------------------------------------------------------
  #doc
     Получить значения типов и кодов установленных значений фильтра
  #end
  Procedure GetAllFilterKeys(var wTypesArray: ArrayOfWord; var wKodArray: ArrayOfWord);

  //----------------------------------------------------------------------------
  #doc
     Удалить спецификацию фильтра
  #end
  Function DelSpFilter(
      wType   : word;
      wKod    : word
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Добавить спецификацию фильтра из другого
  #end
  Function AddFiltersFrom(
    _cFilter : comp
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запуск печати сущности
  #end
  Function Debug_PrintFilter : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запускать ли фильтр по датам
  #end
  Function IsRunDateFlt(_cFilter : comp) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса фильтра по датам
  #end
  Function RunDateFlt(var _dtBeg, _dtEnd : Date) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Предварительная обработка параметров фильтра
  #end
  Function PreProcessFilter : boolean;

End;

#endif//__FpObFilt_Obj__
