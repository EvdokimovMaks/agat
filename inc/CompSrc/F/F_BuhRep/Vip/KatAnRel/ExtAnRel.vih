//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - - Бухгалтерский контур
// Внешний объект для работы с расширенными соответствиями аналитик
//------------------------------------------------------------------------------
#ifndef __ExtAnRel_Included__
#define __ExtAnRel_Included__

#ifdef  ComponentVersion
#component "F_BuhRep"
#endif//ComponentVersion

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
  Внешний объект для работы с расширенными соответствиями аналитик<br>
#end
ObjInterface oExtAnRel;
//------------------------------------------------------------------------------
// Функции для работы с каталогом соответствий
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
  #doc
    Запуск окна выбора из каталога выбора соответствия
  #end
  Function GetKatAnRel(wMode: word; cPlanSch : comp; var cRec:comp) : word;
//------------------------------------------------------------------------------
  #doc
    Получить наименование соответствия
  #end
  Function GetKatName(cRec : comp) : string;
//------------------------------------------------------------------------------
  #doc
    Получить код аналитики приемника
  #end
  Function GetDestKau(cRec: comp) : word;
//------------------------------------------------------------------------------
  #doc
    Вывести сообщение о последней ошибке возникшей при работе с каталогом соответствий
  #end
  Function RunShowKatError : boolean;

//------------------------------------------------------------------------------
// Функции для работы с шаблоном соответствия
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
  #doc
    Вывести сообщение о последней ошибке возникшей при работе с расширенным соответствием
  #end
  Function RunShowAnRelError : boolean;
//------------------------------------------------------------------------------
  #doc
     Запуск окна настройки соответствия аналитик
  #end
  Function RunAnRel(
    _wIntMode   : word;
    _wRunMode   : word;
    _cKatAnRel  : comp;
    _title      : string;
    _ID         : LongInt
  ) : boolean;
//------------------------------------------------------------------------------
  #doc
     Запуск окна просмотра кэша соответствия аналитик
  #end
  Function RunViewCacheAn(
    _ID: LongInt;
    _cKatAnRel: comp;
    _bMode : boolean;  //режим просмотра True - кэш найденных аналитик; False - кэш не определенных аналитик
    _title: string
  ) : boolean;
//------------------------------------------------------------------------------
  #doc
     Был ли настроен кэш и сохранен в шаблон соответствия
  #end
  Function isSaveFromCacheAn : boolean;
//------------------------------------------------------------------------------
  #doc
    Чистка кэша соответствий аналитик
  #end
  Function DelCacheAnRel(_ID: LongInt; _cKatAnRel: comp) : boolean;

//------------------------------------------------------------------------------
  #doc
     Удаление шаблона и спецификации соответствия из хранилища данных
  #end
  Function Del_Table( _cKatAnRel : comp) : boolean;

//------------------------------------------------------------------------------
  #doc
     Копирование спецификации соответствия из _cSrc в _cDst
  #end
  Function CopyAnRel(_cSrc, _cDst : comp): boolean;
//------------------------------------------------------------------------------
  #doc
     Изменение одного из источников спецификации соответствия
  #end
  Function ChangeSrc(_cKatAnRel: comp; _NumRow, _wNewKau : word) : boolean;
//------------------------------------------------------------------------------
  #doc
     Изменение приемника спецификации соответствия
  #end
  Function ChangeDst(_cKatAnRel: comp; _wNewKau : word) : boolean;
//------------------------------------------------------------------------------
  #doc
     Установить значения ID
  #end
  Procedure SetNewID;
//------------------------------------------------------------------------------
  #doc
     Получить значения ID
  #end
  Function GetCurID : LongInt;
//------------------------------------------------------------------------------
  #doc
     Убить ID
  #end
  Procedure KillID;
//------------------------------------------------------------------------------
  #doc
     Сбросить кол-во записей не найденных в соответствиях
  #end
  Procedure ResetAddCount;
//------------------------------------------------------------------------------
  #doc
     Увеличить кол-во записей не найденных в соответствиях
  #end
  Procedure IncAddCount;
//------------------------------------------------------------------------------
  #doc
     Получить кол-во записей не найденных в соответствиях
  #end
  Function GetAddCount: integer;
//------------------------------------------------------------------------------
  #doc
     Инициализация сессии работы с соответствием
  #end
  Function InitSession(_cKatAnRel : comp) : boolean;
//------------------------------------------------------------------------------
  #doc
      Получить код аналитики источника _Num = 1..4
  #end
  Function GetSrcKau(_Num : word) : word;

//------------------------------------------------------------------------------
  #doc
      Получить код аналитики приемника
  #end
  Function GetDstKau : word;

//------------------------------------------------------------------------------
  #doc
     Получить соответствующую аналитику по NRec
  #end
  Function GetJointAnKau(
        _Schet     : tSchet3;  // счет
        _SubSch    : tSubSch;  // субсчет
        _cSrcKau1  : comp;     // NRec значения аналитики источника 1
        _cSrcKau2  : comp;     // NRec значения аналитики источника 2
        _cSrcKau3  : comp;     // NRec значения аналитики источника 3
    var _cDstKau   : comp;     // NRec значения аналитики приемника
    var _isProc    : boolean   // возвращает значение обрабатывать или нет
      ) : boolean;

//------------------------------------------------------------------------------
  #doc
     Вставить новую запись в кэш аналитик
  #end
  Function InsertAnKauInCache(
        _Schet     : tSchet3;  // счет
        _SubSch    : tSubSch;  // субсчет
        _cSrcKau1  : comp;     // NRec значения аналитики источника 1
        _cSrcKau2  : comp;     // NRec значения аналитики источника 2
        _cSrcKau3  : comp      // NRec значения аналитики источника 3
      ) : boolean;

//------------------------------------------------------------------------------
  #doc
      Проверка настроек на предмет наличия не заданных значений аналитик в кортежах записей
  #end
  Function LiteCheckCorrect(bShowMess : boolean) : boolean; // bShowMess - признак вывода сообщений об ошибках
//------------------------------------------------------------------------------
  #doc
      Проверка настроек на предмет наличия пересечений в заданных значениях аналитик
  #end
  Function HardCheckCorrect(bShowMess    : boolean; // bShowMess - признак вывода сообщений об ошибках
                            var bBadTune : boolean  // bBadTune  - если True, то в соответствие незаполненные поля и оно не проверялось
                            ) : boolean;


end; //ObjInterface oExtAnRel

VipInterface vExtAnRel implements oExtAnRel
#Licensed_Free
;

#endif //__ExtAnRel_Included__
