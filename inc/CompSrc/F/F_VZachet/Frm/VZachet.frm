//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.0 - Бухгалтерский контур
// Акт взаимозачетов контрагентов
//------------------------------------------------------------------------------

#doc
Акт взаимозачетов контрагентов
#end
.set name = 'VZachet'
.HIDE
.Fields
 a

 cFil0
 cFil1
 AktNRec
 AktNo
 k1
 kontr1
 kunn1
 kkpp1
 k2
 kontr2
 kunn2
 kkpp2
 we
 wer
 weunn          
 wekpp
 d
 dobr

 SumDoDeb
 SumNalDeb

 SumDoDebV
 SumNalDebV
 SumDV

 SumDoCred
 SumNalCred

 SumDoCredV
 SumNalCredV
 SumCV

 sum
 sumV
 begd
 endd
 namepl1
 namepl2
 namepl3

 pNum1
 num1
 d1
 s1
 s1Val
 cVal1
 Val1Name
 pNum2
 num2
 schet
 d2
 s2
 s2Val
 cVal2
 Val2Name
 namenal1
 nalog1
 nalog1Val
 namenal2
 nalog2
 nalog2Val
.Endfields
.{
 A - ^
.{ ReePlPorFl CheckEnter
cFil0 ^
cFil1 ^
.}
!.end

.{ PlPorLoop CheckEnter
 AktNRec        - ^
 AktNo          - ^
 k1             - ^
 kontr1         - ^
 kunn1          - ^
 kkpp1          - ^
 k2             - ^
 kontr2         - ^
 kunn2          - ^
 kkpp2          - ^
 we             - ^
 wer 	        - ^
 weunn          - ^
 wekpp          - ^
 d              - ^
 dobr           - ^

 SumDoDeb       - ^
 SumNalDeb      - ^

 SumDoDebV      - ^
 SumNalDebV     - ^
 SumDV          - ^

 SumDoCred - ^
 SumNalCred - ^

 SumDoCredV     - ^
 SumNalCredV    - ^
 SumCV          - ^




 sum        - ^
 sumV       - ^
 begd       - ^
 endd    - ^
 namepl1 - ^
 namepl2 - ^
 namepl3 - ^

.{ BaseDocLoop CheckEnter
 pNum1 - ^
 num1  - ^
 d1    - ^
 s1    - ^
 s1Val - ^
 cVal1 - ^
 Val1Name - ^
 pNum2 - ^
 num2  - ^
 schet - ^
 d2    - ^
 s2    - ^
 s2Val - ^
 cVal2 - ^
 Val2Name - ^

.{ NalogLoop CheckEnter
 namenal1 - ^
 nalog1   - ^
 nalog1Val   - ^
 namenal2 - ^
 nalog2   - ^
 nalog2Val   - ^
.}
.}
.}
.}
.endform
!==================================================================
.linkform 'vzachet1' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Отчет для собственной организации'
.Fields
 CommonFormHeader
 AktNo kontr1 kontr2 wer namepl1 namepl2 namepl3 d kontr1 kontr2
!.{
 pNum1
 num1
 if (d1 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d1, '')
 s1
 pNum2
 num2
 schet
 if (d2 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d2, '')
 s2
!.{
 namenal1 nalog1 namenal2 nalog2
!.}
!.}
 SumDoDeb SumDoCred SumNalDeb SumNalCred
 sum
.Endfields
^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
 Р                              Акт № @@@@@@@@
                     взаимозачета между предприятиями:
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Содержание:
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

          По состоянию на @@@@@@@@@@@@ погашается задолженность:
──────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────────
По счетам, предъявленным предприятию                      │         По счетам, предъявленным предприятием
          @@@@@@@@@@@@@@@@@@@@@@@@@@                      │                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
──────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────
№ Предопл. ДО       № ДО         Дата          Сумма      │№ Предопл. ДО    № ДО       № счета        Дата          Сумма
──────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@@@@      @@@@@@@@@@@  @@@@@@@@@@@ &#&'&&&&&&&&&.&&│@@@@@@@@@@   @@@@@@@@@@@  @@@@@@@@@@@@@ @@@@@@@@@@@ &#&'&&&&&&&&&.&&
.{ NalogLoop CheckEnter
                              @@@@@@@@@@  &#&'&&&&&&&&&.&&│                                        @@@@@@@@@@@ &#&'&&&&&&&&&.&&
.}
.}
──────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────
   Итого по ДО:       &#&'&&&&&&&&&.&&                      Итого по ДО:       &#&'&&&&&&&&&.&&
   Итого налогов:     &#&'&&&&&&&&&.&&                      Итого налогов:     &#&'&&&&&&&&&.&&
   Зачет на сумму:  &#&'&&&&&&&&&.&&


   Начальник финансового отдела

   Главный бухгалтер Р
.}
.}
.endform

!==================================================================
.linkform 'vzachet7' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Отчет для собственной организации в НДЕ и валюте'
.Fields
 CommonFormHeader
 AktNo kontr1 kontr2 wer namepl1 namepl2 namepl3 d kontr1 kontr2
!.{
 pNum1
 num1
 if (d1 <> DateToStr(date(0,0,0), 'DD/MM/YYYY'), d1, '')
 s1
 s1Val
 Val1Name
 pNum2
 num2
 schet
 if (d2 <> DateToStr(date(0,0,0), 'DD/MM/YYYY'), d2, '')
 s2
 s2Val
 Val2Name
!.{
 namenal1 nalog1 nalog1Val namenal2 nalog2 nalog2Val
!.}
!.}
 SumDoDeb SumDoDebV SumDoCred SumDoCredV SumNalDeb SumNalDebV SumNalCred SumNalCredV
 sum sumV
.Endfields
 Ш^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
                              Акт № @@@@@@@@
                     взаимозачета между предприятиями:
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Содержание:
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

          По состоянию на @@@@@@@@@@@@ погашается задолженность:
──────────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────────────────────────
По счетам, предъявленным предприятию                                      │     По счетам, предъявленным предприятием
          @@@@@@@@@@@@@@@@@@@@@@@@@@                                      │               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
──────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────
№ Предопл. ДО       № ДО        Дата     Сумма в НДЕ Сумма в валюте Валюта│№ Предопл. ДО   № ДО       № счета     Дата       Сумма в НДЕ  Сумма в валюте Валюта
──────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@@@@      @@@@@@@@@@ @@@@@@@@@@ &#&'&&&&&&&.&& &#&'&&&&&&.&& @@@@@@│@@@@@@@@@@  @@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@ &#&'&&&&&&&&&.&& &#&'&&&&&&.&& @@@@@@
.{ NalogLoop CheckEnter
                            @@@@@@@@@@ &#&'&&&&&&&.&& &#&'&&&&&&.&&       │                                    @@@@@@@@@@ &#&'&&&&&&&&&.&& &#&'&&&&&&.&&
.}
.}
──────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────────────
   Итого по ДО в НДЕ:   &#&'&&&&&&&&&.&& в валюте:&#&'&&&&&&&&&.&&               Итого по ДО в НДЕ:  &#&'&&&&&&&&&.&&  в валюте:&#&'&&&&&&&&.&&
   Итого налогов в НДЕ: &#&'&&&&&&&&&.&& в валюте:&#&'&&&&&&&&&.&&               Итого налогов в НДЕ:&#&'&&&&&&&&&.&&  в валюте:&#&'&&&&&&&&.&&
   Зачет на сумму в НДЕ:&#&'&&&&&&&&&.&& в валюте:&#&'&&&&&&&&&.&&


   Начальник финансового отдела

   Главный бухгалтер Ш
.}
.}
.endform
!==================================================================
.linkform 'vzachet2' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Извещение для дебитора'
.Fields
CommonFormHeader
wer kontr1 AktNo namepl1 namepl2 namepl3 d wer
!.{
num1
if (d1 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d1, '')
s1
s1Val
Val1Name
!.{
 namenal1 nalog1 nalog1Val
!.}
!.}
sum
SumDV
.Endfields
 Р^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
@@@@@@@@@@@@@@@@@@@@                       Главному бухгалтеру
                                           предприятия
                                           ^


            ИЗВЕЩЕНИЕ О ПРОВЕДЕНИИ ВЗАИМОЗАЧЕТА № @@@@@@@@@@@@@

Содержание:
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

По состоянию на @@@@@@@@@@@ погашается задолженность:
──────────────────────────────────────────────────────────────────────────────
    По  счетам,  предъявленным  предприятием
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
──────────────────────────────────────────────────────────────────────────────
№ ДО            Дата                 Сумма в НДЕ   Сумма в валюте     Валюта
──────────────────────────────────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@@@@   @@@@@@@@@@@         &#&'&&&&&&&&&.&&  &#&'&&&&&&&.&& @@@@@@@@@@@
.{ NalogLoop CheckEnter
                    @@@@@@@@@@@   &#&'&&&&&&&&&.&&  &#&'&&&&&&&.&&
.}
.}
──────────────────────────────────────────────────────────────────────────────
   Зачет на сумму в НДЕ:&#&'&&&&&&&&&.&& в валюте:  &#&'&&&&&&&.&&


   Начальник финансового отдела

   Главный бухгалтер Р
.}
.}
.endform

!==================================================================
.linkform 'vzachet3' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Акт для дебитора'
.Fields
CommonFormHeader
AktNo wer kontr1 namepl1 namepl2 namepl3 d wer
!.{
num1
if (d1 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d1, '')
s1
s1Val
Val1Name
!.{
 namenal1 nalog1 nalog1Val
!.}
!.}
sum
SumDV
.Endfields
 Р^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
                                Акт № @@@@@@@@
                        взаимозачета между предприятиями
                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

Содержание:
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

По состоянию на @@@@@@@@@@@ погашается задолженность:
──────────────────────────────────────────────────────────────────────────────
    По  счетам,  предъявленным  предприятием
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
──────────────────────────────────────────────────────────────────────────────
№ ДО            Дата                Сумма в НДЕ    Сумма в валюте     Валюта
──────────────────────────────────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@@@@    @@@@@@@@@@@        &#&'&&&&&&&&&.&& &#&'&&&&&&&.&&  @@@@@@@@@@@
.{ NalogLoop CheckEnter
                    @@@@@@@@@@@   &#&'&&&&&&&&&.&& &#&'&&&&&&&.&&
.}
.}
──────────────────────────────────────────────────────────────────────────────
   Зачет на сумму в НДЕ:&#&'&&&&&&&&&.&& в валюте: &#&'&&&&&&&.&&



   Начальник финансового отдела

   Главный бухгалтер Р
.}
.}
.endform

!==================================================================
.linkform 'vzachet4' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Извещение для кредитора'
.Fields
CommonFormHeader
wer kontr2 AktNo namepl1 namepl2 namepl3 d wer
!.{
num2
schet
if (d2 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d2, '')
s2
s2Val
Val2Name
!.{
namenal2 nalog2 nalog2Val
!.}
!.}
sum
SumCV
.Endfields
 Р^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
@@@@@@@@@@@@@@@@@@@@                       Главному бухгалтеру
                                           предприятия
                                           ^


            ИЗВЕЩЕНИЕ О ПРОВЕДЕНИИ ВЗАИМОЗАЧЕТА № @@@@@@@@@@@@@

Содержание:
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

По состоянию на @@@@@@@@@@@ погашается задолженность:
────────────────────────────────────────────────────────────────────────────────────
       По счетам, предъявленным предприятию
                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────────────────────────────────────────────────
  № ДО       № счета         Дата          Сумма в НДЕ   Сумма в валюте    Валюта
────────────────────────────────────────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@   @@@@@@@@@@@@@  @@@@@@@@@@@   &#&'&&&&&&&&&.&& &#&'&&&&&&&&.&& @@@@@@@@@@@
.{ NalogLoop CheckEnter
                          @@@@@@@@@@@   &#&'&&&&&&&&&.&& &#&'&&&&&&&&.&&
.}
.}
────────────────────────────────────────────────────────────────────────────────────
   Зачет на сумму в НДЕ:&#&'&&&&&&&&&.&&  в валюте:      &#&'&&&&&&&&.&&


   Начальник финансового отдела

   Главный бухгалтер Р
.}
.}
.endform

!==================================================================
.linkform 'vzachet5' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Акт для кредитора'
.Fields
CommonFormHeader
AktNo wer kontr2 namepl1 namepl2 namepl3 d wer
!.{
num2
schet
if (d2 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d2, '')
s2
s2Val
Val2Name
!.{
namenal2 nalog2 nalog2Val
!.}
!.}
sum
SumCV
.Endfields
 Р^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
                                Акт № @@@@@@@@
                        взаимозачета между предприятиями
                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

Содержание
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

По состоянию на @@@@@@@@@@@ погашается задолженность:
─────────────────────────────────────────────────────────────────────────────────────
       По счетам, предъявленным предприятию
                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
─────────────────────────────────────────────────────────────────────────────────────
  № ДО       № счета         Дата           Сумма в НДЕ  Сумма в валюте      Валюта
─────────────────────────────────────────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@   @@@@@@@@@@@@@   @@@@@@@@@@@  &#&'&&&&&&&&&.&& &#&'&&&&&&&&.&&  @@@@@@@@@@@
.{ NalogLoop CheckEnter
                          @@@@@@@@@@@   &#&'&&&&&&&&&.&& &#&'&&&&&&&&.&&
.}
.}
─────────────────────────────────────────────────────────────────────────────────────
   Зачет на сумму в НДЕ:&#&'&&&&&&&&&.&&  в валюте:      &#&'&&&&&&&&.&&


   Начальник финансового отдела

   Главный бухгалтер Ш
.}
.} И
.endform

!==========================================================================================
.linkform 'vzachet6' prototype is 'vzachet'
!==========================================================================================
.Group 'Реестр'
.nameinlist 'Реестр актов взаимозачета'
.var
aa : boolean
AllSum: double
.endvar
.{
.begin
 aa := false;
 AllSum := 0;
end.
.Fields
CommonFormHeader
.Endfields
^
 И
                              Реестр актов взаимозачета

.{ ReePlPorFl CheckEnter
.{?INTERNAL; (not aa)
.Fields
cFil0 cFil1
.Endfields
.begin
 aa := true;
end.
 БПрименен фильтр... Б
.}
  ^ ^
.}
───────┬──────────┬──────────┬─────────────────────┬────────────────────┬──────────────────
 Номер │   Дата   │   Дата   │       Дебитор       │      Кредитор      │   Сумма зачета
 акта  │ выписки  │ обработки│                     │                    │
───────┼──────────┼──────────┼─────────────────────┼────────────────────┼──────────────────
.{ PlPorLoop CheckEnter
.begin
 AllSum :=  double(sum) + AllSum;
end.
.fields
 AktNo
 if (d <> DateToStr(date(0,0,0), 'DD/MM/YY'), d, '')
 if (dobr <> DateToStr(date(0,0,0), 'DD/MM/YY'), dobr, '')
 kontr1
 kontr2
 sum
.endfields
@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│&#&'&&&&&&&&.&&
.{ BaseDocLoop CheckEnter
.{ NalogLoop CheckEnter
.}
.}
.}
───────┴──────────┴──────────┴─────────────────────┴────────────────────┴────────────────── И
.fields
  AllSum
.endfields
 Б ИТОГО:                                                    &#&'&&&&&&&&.&& Б
.}
.endform
