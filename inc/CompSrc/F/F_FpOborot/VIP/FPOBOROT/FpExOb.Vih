//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Интерфейс взаимодействия : "Книга финансовых операций"
//------------------------------------------------------------------------------

#include FpOborot.Inc

#ifndef _ExtFpOborot_Included_
#define _ExtFpOborot_Included_

#ifdef  ComponentVersion
#component "F_FpOborot"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Интерфейс взаимодействия : "Книга финансовых операций"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface iExtFpOborot;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;

//==============================================================================
//                                  FIELDS
//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы
#end
Function BufGetSumInVal(_Buff : TPFpOborot; _cVal : comp) : double;

//------------------------------------------------------------------------------
#doc
   Получить режим "существования" первичного документа
#end
Function GetHDExistMode (_TiDkGal : word; _cSoprDoc : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить режим "состояние" первичного документа
#end
Function GetDocStateMode(_TiDkGal : word; _cSoprDoc : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить информацию о первичном документе
#end
Function GetDocInfo(_cOborot : comp) : string;

//==============================================================================
//                                  MODIFY
//------------------------------------------------------------------------------
#doc
   Вставка записи по буферу таблицы
#end
Function InsBufferP(
var _Buff     : TPFpOborot;
    _wMessage : word
) : boolean;
//------------------------------------------------------------------------------
#doc
   Изменение записи по буферу таблицы
#end
Function UpdBufferP(
var _Buff     : TPFpOborot;
    _wMessage : word
) : boolean;
//------------------------------------------------------------------------------
#doc
   Удаление записи по буферу таблицы
#end
Function DelBufferP(
    _Buff     : TPFpOborot;
    _wMessage : word
) : boolean;

//------------------------------------------------------------------------------
#doc
   Вставка записи по буферу таблицы
#end
Function InsAnBufferP(
var _Buff     : TPFpOborot;
    _CAn      : TPtr;
    _wMessage : word
) : boolean;

//------------------------------------------------------------------------------
#doc
   Создание финоперации по SoprHoz-у.<br>
   Аналитика документа и аналитика бюджета, формируется из переданного контейнера.<br>
#end
Function InsBySoprHoz(
    _cSoprHoz : comp;    // cSoprHoz
    _wKodReg  : word;    // код регистра учета
    _cCO      : comp;    // ЦО
    _cStBud   : comp;    // статья бюджета
    _dDate    : date;    // дата совершения операции
    _CAn      : TPtr; // контейнер аналитик
    _cVal     : comp;    // валюта операции
    _Summa    : double;  // сумма
    _wMessage : word     // режим вывода сообщений
) : boolean;

//------------------------------------------------------------------------------
#doc
   Создание финоперации по SoprHoz-у.<br>
   Аналитика документа формируется из SoprHoz-а.<br>
   Аналитика бюджета формируется из переданного контейнера.<br>
#end
Function InsBySoprHoz_01(
  _cSoprHoz : comp;    // cSoprHoz
  _wKodReg  : word;    // код регистра учета
  _cCO      : comp;    // ЦО
  _cStBud   : comp;    // статья бюджета
  _dDate    : date;    // дата совершения операции
  _CAn      : TPtr; // контейнер аналитик
  _cVal     : comp;    // валюта операции
  _Summa    : double;  // сумма
  _wMessage : word     // режим вывода сообщений
) : boolean;

//------------------------------------------------------------------------------
#doc
   Создание финоперации по SoprHoz-у.<br>
   Аналитика документа формируется из переданного контейнера.<br>
   Аналитика бюджета формируется из переданного контейнера.<br>
#end
Function InsBySoprHoz_02(
  _cSoprHoz : comp;    // cSoprHoz
  _wKodReg  : word;    // код регистра учета
  _cCO      : comp;    // ЦО
  _cStBud   : comp;    // статья бюджета
  _dDate    : date;    // дата совершения операции
  _CAnDoc   : TPtr; // контейнер аналитик документа
  _CAnBud   : TPtr; // контейнер аналитик бюджета
  _cVal     : comp;    // валюта операции
  _Summa    : double;  // сумма
  _wMessage : word     // режим вывода сообщений
) : boolean;

//------------------------------------------------------------------------------
#doc
   Удаление по cSoprHoz
#end
Function DelBySoprHoz(
  _cSoprHoz  : comp;
  _wKodReg   : word;
  _wMessage  : word
) : boolean;

//------------------------------------------------------------------------------
#doc
   Удаление по cSoprDoc
#end
Function DelBySoprDoc(
  _TiDk      : word;
  _cDoc      : comp;
  _wKodReg   : word;
  _wMessage  : word
) : boolean;

//------------------------------------------------------------------------------
#doc
   Копирование аналитики документа в аналитику статьи
#end
Function BufCopyAnDocToAnBud (var _Buff : TPFpOborot) : boolean;
//------------------------------------------------------------------------------
#doc
   Синхронизация аналитики статьи по аналитике документа
#end
Function BufSynchAnBudByAnDoc(var _Buff : TPFpOborot) : boolean;


//==============================================================================
//                                  RIGHT
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
Function GetAskedContinue : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
Function SetAskedContinue(_Value : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Разрешено ли редактирование таблицы
#end
Function CanEditTbl(
  _wMessage  : word
) : boolean;
//------------------------------------------------------------------------------
#doc
   Разрешено ли редактирование записи
#end
Function CanEditRec(
  _cFpOborot : comp;
  _wMessage  : word
) : boolean;
//------------------------------------------------------------------------------
#doc
   Разрешен ли просмотр записи
#end
Function CanViewRec(
  _cFpOborot : comp;
  _wMessage  : word
) : boolean;
//------------------------------------------------------------------------------
#doc
   Разрешено ли редактирование поля дескриптор
#end
Function CanEditDescr(
  _cFpOborot : comp;
  _wMessage  : word
) : boolean;


//==============================================================================
//                                 CONVERTER
//------------------------------------------------------------------------------
#doc
   Запуск функции проверки корректности
#end
Function CheckAllOborot(
  _wCheck     : word;
  _wMessage : word
) : boolean;


//==============================================================================
//                                 DIALOG
//------------------------------------------------------------------------------
#doc
   Переход в первичный документ
#end
Function RunEditParentDoc(_cFpOborot : comp) : boolean;


//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface vExtFpOborot implements iExtFpOborot
#Licensed_Free
;

#endif //_ExtFpOborot_Included_
