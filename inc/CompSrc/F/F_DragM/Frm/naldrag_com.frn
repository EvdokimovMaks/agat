!=============================================================================
.LinkForm 'NalDrag_01' Prototype is 'NalDrag'
!=============================================================================
.NameInList 'Ведомость наличия драгметаллов'
.p 55
.Group '<<Общие>>'
.defo portrait
#FeeSigners_Os_LinkVar
.Fields
CommonFormHeader
if (boGetTune('Rep.IsHeader'), sGetTune('MyOrg'), '')
if (longint(Дата)<>0,DateToStr(Дата, 'DD/MM/YYYY'),'')
Метод
Ф_делитель
Делитель_прописью
Группировка
Сортировка
!---------------- FilterOS
Фильтр
!---------------- GruppaOS
Ветка
if ( NeedSum1, DoubleToStr(Итого_верх_вес, Формат), '')
!---------------- NameOS5
ДрагМет_наим
ДрагМет_код
DoubleToStr(Вес, Формат)
Trim(SubStr( if ((СпособОпред AND 1) = 1, ', Паспорт', '')
           + if ((СпособОпред AND 2) = 2, ', Комиссионно','')
           + if ((СпособОпред AND 4) = 4, ', Справочник', ''), 3, 35))
!---------------- ItogOS
Итого
DoubleToStr(Итого_вес, Формат)
.EndFields
.Begin
 SaveMyDsk(True, 'StdForm');
End.
 Р.[h skip
                                                                                                                Лист @Np@
.]h
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

                                   ВЕДОМОСТЬ НАЛИЧИЯ ДРАГМЕТАЛЛОВ
                                           на @@@@@@@@@@@

Метод:                ^
Весовая единица:      ^ (^) грамм
Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter FilterOS5
 ^
.}
.{ CheckEnter HeadCreator
.}
.{
.[h
────────────────────────────────────────────────────────────────────────────────┬────────────────────────┬───────────────
                                  Наименование                                  │ Масса драгметалла      │  Способ
────────────────────────────────────────────────────────────────────────────────┴────────────────────────┴───────────────
.]h
.{ CheckEnter GruppaOS5
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&&
.{ CheckEnter DM_Data
.}
.}
.{ CheckEnter NameOS5
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@                              &&&&&&&&&&&&&&&&&&&&       @@@@@@@@@@@@
.}
.{ CheckEnter ItogOS5
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&&
.{ CheckEnter DM_Itog
.}
.}
.}
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

 Р
 Ш#FeeSIgners_Os_LinkInit(NalDrag)
.fields
  Председатель_Должность
  Председатель_ФИО
.endfields
 Председатель комиссии: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                              должность                          подпись                   расшифровка подписи

.{While (Номер_подписанта < Количество_Членов_комиссии)
.begin
  Номер_подписанта++;
end.
.fields
  if (Номер_подписанта = 1, 'Члены комиссии:', '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_Должность [Номер_подписанта], '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_ФИО   [Номер_подписанта], '')
.endfields
 @@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                              должность                          подпись                   расшифровка подписи
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 Члены комиссии:        _______________________________  __________________________ _____________________________________________________
                               должность                         подпись                   расшифровка подписи

                        _______________________________  __________________________ _____________________________________________________
                               должность                         подпись                   расшифровка подписи

                        _______________________________  _________________________ ______________________________________________________
                               должность                         подпись                   расшифровка подписи

.} Ш
.EndForm

!=============================================================================
.LinkForm 'NalDrag_02' Prototype is 'NalDrag'
!=============================================================================
.NameInList 'Инвентаризационная опись'
.defo landscape
.p 55
.Group '<<Общие>>'
.Var
  cRec : Comp
  TotNpp : LongInt
  VarHeader      : Array[1..15] of String;  // строки заголовка
  КолонкаИмя     : Array[1..15] of String;  // КолонкаИмя
  КолонкаМассаГруппИтог
  , КолонкаМассаВсего
  , КолонкаМасса : Array[1..30] of Double;  // данные по карточке (пасспорт + коммисионно)
  КолонкаНомер
  , Кол_воКол
  , i, j, k  : byte;
  Empty_3_12 : string;
.EndVar
#FeeSigners_Os_LinkVar
.Fields
  CommonFormHeader
  Наименование_организации
  DateToStr(Дата,'MONTH YYYY')
.EndFields
.Begin
 Var ObjectIsLastLevel : Boolean;
 ObjectIsLastLevel := False;
 ReadMyDsk(ObjectIsLastLevel, 'ObjectIsLastLevel', False);
 if (Not ObjectIsLastLevel)
 {
  Message(''#3'Для получения выбранного отчета в настройке необходимо '#13#3+
          'задать последний уровень группировки данных "Карточки ОС"'#13#3+  '                     или "Инвентарный объект"'
         );
  NalDrag_02.fBreak;
  Exit;
 }
 else
 {
  SaveMyDsk(True, 'Inv8aForm');
  cRec := Comp(0);
  TotNpp  := 0;
 }
  Empty_3_12 := PadCh('',' ', 16);
End.
 Ш ^
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   ───────────────────────────────────────────────────────────────────────────────────────
                      (предприятие, организация, учреждение)
 Ш


                                     Инвентаризационная опись
               драгоценных металлов и драгоценных камней, содержащихся в полуфабрикатах,
                         узлах и деталях оборудования, приборах и иных изделиях,
                а также находящихся в составе любых материальных ценностей, в ломе и отходах
                                    по состоянию на ^

 Ш
.{ CheckEnter FilterOS5
.}
.{ CheckEnter HeadCreator
.Begin
  Inc(j);
  КолонкаИмя[j] := Наим_колонка;
  End.
.}
.Begin
  Кол_воКол := j;
          j := 1;
  for ( i := 1; i <= (2*Кол_воКол + 1); i++)
    КолонкаМассаВсего[i] := 0;
End.
!.[h
.Begin j := 1 End.
┌──────┬───────────────────────────────────┬──────────┬──────┬────────────────────────┬
.{Horizontal margin while j <= Кол_воКол
.Fields
  '─────────────────────────────────'+ If(j = Кол_воКол, '┬', '─')
.EndFields
^
.Begin Inc(j) End.
.}
────────┐
.Begin j := 1 End.
│Поряд-│Оборудование, сырье, материалы,    │ Единица  │ Год  │          Номер         │
.{Horizontal margin while j <= Кол_воКол
.Fields
  If( Round( Кол_воКол/2 ) =  Trunc( Кол_воКол/2 ),   // четное кол-во колонок
    If( j = Round( Кол_воКол/2 ), PadCh('',' ', 17)+'Масса драгметалл',
      If( j = Round( Кол_воКол/2 )+1, 'ов в объекте, гр.'+PadCh('',' ', 17)+If(j = Кол_воКол,'│',' '),
        Empty_3_12 + ' '  + Empty_3_12 + If( j = Кол_воКол, '│', ' ' ))),
    If( j = Round( Кол_воКол/2 ), 'Масса драгметаллов в объекте, гр.'+If(j = Кол_воКол,'│',' '),
        Empty_3_12 + ' '  + Empty_3_12 + If( j = Кол_воКол, '│', ' ' )))
.EndFields
^
.Begin Inc(j) End.
.}
Предпо- │
.Begin j := 1 End.
│ковый │продукция и изделия, лом и отходы  │измерения │ вы-  ├───────────────┬────────┼
.{Horizontal margin while j <= Кол_воКол
.Fields
  '─────────────────────────────────' + If( j = Кол_воКол, '┤', '┬')
.EndFields
^
.Begin Inc(j) End.
.}
лагаемый│
.Begin j := 1 End.
│номер ├─────────────────────────┬─────────┼─────┬────┤пуска │  Инвентарный  │ Завод- │
.{Horizontal margin while j <= Кол_воКол
.Fields
  КолонкаИмя[j]
.EndFields
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
.Begin Inc(j) End.
.}
  срок  │
.Begin j := 1 End.
│записи│      Наименование       │   Код   │наи- │Код │(изго-│               │  ской  ├
.{Horizontal margin while j <= Кол_воКол
.Fields
  '────────────────┬' + '────────────────' + If( j = Кол_воКол, '┤', '┼')
.EndFields
^
.Begin Inc(j) End.
.}
списания│
.Begin j := 1 End.
│      │                         │         │мено-│    │товле-│               │        │
.{Horizontal margin while j <= Кол_воКол
.Fields
  '    по учету    │' + '  определено    │'
.EndFields
^
.Begin Inc(j) End.
.}
        │
.Begin j := 1 End.
│      │                         │         │вание│    │ ния) │               │        │
.{Horizontal margin while j <= Кол_воКол
.Fields
  '   (паспорту)   │' + ' "комиссионно"  │'
.EndFields
^
.Begin Inc(j) End.
.}
        │
.Begin j := 1 End.
├──────┼─────────────────────────┼─────────┼─────┼────┼──────┼───────────────┼────────┼
.{Horizontal margin while j <= Кол_воКол
.Fields
  '────────────────┼────────────────┼'
.EndFields
^
.Begin Inc(j) End.
.}
────────┤
.Begin j := 1; End.
│  1   │            2            │    3    │  4  │ 5  │   6  │       7       │    8   │
.{Horizontal margin while  j <= Кол_воКол
.Fields
  LPad( 2*( j-1 ) + 9, 2)
  LPad( 2*( j-1 ) +10, 2)
.EndFields
       @@       │       @@       │
.Begin Inc(j) End.
.}
.Fields
  LPad( 2*( j-1 ) + 9, 2)
.EndFields
   @@   │
.Begin j := 1 End.
├──────┼─────────────────────────┼─────────┼─────┼────┼──────┼───────────────┼────────┼
.{Horizontal margin while j <= Кол_воКол
.Fields
  '────────────────┼────────────────┼'
.EndFields
^
.Begin Inc(j) End.
.}
────────┤
.Begin
End.
.{
.{ CheckEnter GruppaOS5
.Begin j := 1 End.
.{ CheckEnter DM_Data
.Begin
  КолонкаМасса[2*j  ]      := Итого_верх_вес_i;
  КолонкаМасса[2*j+1]      := Итого_верх_вес_i_Комиссионно;
  Inc( j );
End.
.}
.{?INTERNAL;(Not NeedPrintAsLeaf);
.Fields
  Ветка
.EndFields
.Begin j := 1 End.
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.{Horizontal margin while j <= Кол_воКол
.Fields
  if (NeedSum2 and КолонкаМасса[2*j  ] <> 0, Trim(DoubleToStr(Round(КолонкаМасса[2*j  ], 8), Формат)), '')
  if (NeedSum2 and КолонкаМасса[2*j+1] <> 0, Trim(DoubleToStr(Round(КолонкаМасса[2*j+1], 8), Формат)), '')
.EndFields
 &&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&
.Begin Inc(j) End.
.}

.Begin
 cRec := Comp(0);
End.
.}
.{?INTERNAL;NeedPrintAsLeaf;
.Begin
 cRec := Head_TempDescr_NRec;

 for ( i := 1; i <= (2*Кол_воКол + 1); Inc(i))
   КолонкаМассаВсего[i] := КолонкаМассаВсего[i] + КолонкаМасса[i  ];

 TotNpp := TotNpp + 1;
End.
.Fields
  TotNpp
  Верх_Наименование
  Верх_Номенклатурный_номер
  Верх_ЕдИзм_Сокр_Наим
  Верх_ЕдИзм_Код
  if (NeedDopInf=1, if (longint(Верх_дата_выпуска) > 0, String(Year(Верх_дата_выпуска), 4), ''), '')
  Верх_ИнвНомер
  Верх_заводской_номер
.EndFields
.Begin j := 1 End.
 @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@ @~@@@@@@@ @~@@@ @~@@ @~@@@@ @~@@@@@@@@@@@@@ @~@@@@@@
.{Horizontal margin while j <= Кол_воКол
.Fields
  if (КолонкаМасса[2*j  ] = 0, '', Trim(DoubleToStr(Round(КолонкаМасса[2*j  ], 8), Формат)))
  if (КолонкаМасса[2*j+1] = 0, '', Trim(DoubleToStr(Round(КолонкаМасса[2*j+1], 8), Формат)))
.EndFields
 &&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&
.Begin Inc(j) End.
.}
.Fields
  if ( Верх_предп_срок_списания = ZeroDate, '',
   String(Month(Верх_предп_срок_списания),2) + '.' + String(Year(Верх_предп_срок_списания),4) )
 .EndFields
  @~@@@@@@
.}
.}
.{ CheckEnter NameOS5
.}
.{ CheckEnter ItogOS5
.Begin j := 1 End.
.{ CheckEnter DM_Itog
.Begin
  КолонкаМассаГруппИтог[2*j  ] := Итого_вес_i;
  КолонкаМассаГруппИтог[2*j+1] := Итого_вес_i_Комиссионно;
  Inc( j );
End.
.}
.{?INTERNAL;Tail_TempDescr_NRec<>cRec;
.Fields
  Итого
.EndFields
.Begin j := 1 End.
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.{Horizontal margin while j <= Кол_воКол
.Fields
  if (КолонкаМассаГруппИтог[2*j  ] = 0, '', Trim(DoubleToStr(Round(КолонкаМассаГруппИтог[2*j  ], 8), Формат)))
  if (КолонкаМассаГруппИтог[2*j+1] = 0, '', Trim(DoubleToStr(Round(КолонкаМассаГруппИтог[2*j+1], 8), Формат)))
.EndFields
 &&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&
.Begin Inc(j) End.
.}

.}
.}
.}
.Begin j := 1 End.
└─────────────────────────────────────────────────────────────────────────────────────┼
.{Horizontal margin while j <= Кол_воКол

────────────────┼────────────────┼
.Begin Inc(j) End.
.}
────────┤
.Begin j := 1 End.
                                                                      Итого по описи  │
.{Horizontal margin while j <= Кол_воКол
.Fields
  if (КолонкаМассаВсего[2*j  ] = 0, '', Trim(DoubleToStr(Round(КолонкаМассаВсего[2*j  ], 8), Формат)))
  if (КолонкаМассаВсего[2*j+1] = 0, '', Trim(DoubleToStr(Round(КолонкаМассаВсего[2*j+1], 8), Формат)))
.EndFields
&&&&&&&&&&&&&&&&│&&&&&&&&&&&&&&&&│
.Begin Inc(j) End.
.}
    X   │
.Begin j := 1 End.
                                                                                      └
.{Horizontal margin while j <= Кол_воКол
────────────────┴────────────────┴
.Begin Inc(j) End.
.}
────────┘



 И#FeeSIgners_Os_LinkInit(NalDrag)
.fields
  Председатель_Должность
  Председатель_ФИО
.endfields
 Председатель комиссии: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                              должность                          подпись                   расшифровка подписи

.{While (Номер_подписанта < Количество_Членов_комиссии)
.begin
  Номер_подписанта++;
end.
.fields
  if (Номер_подписанта = 1, 'Члены комиссии:', '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_Должность [Номер_подписанта], '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_ФИО   [Номер_подписанта], '')
.endfields
 @@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                              должность                          подпись                   расшифровка подписи
.} И
.{?INTERNAL;(Количество_членов_комиссии = 0)
    Члены комиссии:        __________________________________        __________________________________        ______________________________________________________________________________________________________
                                       должность                                   подпись                                                                  расшифровка подписи

                           __________________________________        __________________________________        ______________________________________________________________________________________________________
                                       должность                                   подпись                                                                  расшифровка подписи

                           __________________________________        __________________________________        ______________________________________________________________________________________________________
                                       должность                                   подпись                                                                  расшифровка подписи

.}
 Ш.EndForm

