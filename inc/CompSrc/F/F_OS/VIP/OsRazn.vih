/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║ Система       : Основные средства                                         ║
 ║ Назначение    : Разность данных по методам учета                          ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#ifdef ComponentVersion
#Component "F_OS"
#end
#doc
  Разность данных по методам учета
#end
ObjInterface ObjOsRazn;
//------------------------------------------------------------------------------
#doc
  Инициализация параметров
#end
  procedure SetOsRaznParams(In_wTiDk  : word;   //Тип (15-ОС, 16-НМА)
                            In_cKatOs : comp;   //ссылка на ИК
                            In_dData  : date    //дата периода
                           );
//------------------------------------------------------------------------------
#doc
  Инициализация параметров для редактирования
#end
  procedure SetOsRaznParamsEdit(In_wTiDk  : word;   //Тип (15-ОС, 16-НМА)
                                In_cKatOs : comp;   //ссылка на ИК
                                In_dData  : date;   //дата периода
                                In_Edit   : boolean
                               );
//------------------------------------------------------------------------------
#doc
  Закрывает немодальное окно редактирования
#end
  procedure CloseEditWindow;
//------------------------------------------------------------------------------
#doc
  Засчёт или отмена разницы данных</brief><br>
  ( True - операция выполнена, False - операция не выполнена)
#end
  function CalcRazn(In_dDate : date //дата операции
                   ) : boolean;
//------------------------------------------------------------------------------
#doc
  Копирование разниц данных из одной ИК в другую за текущий период
#end
  procedure CopyOsRaznFromOneIkToAnother(In_cOldKatOs : comp;   //ссылка на ИК, из которой берём данные для копирования
                                         In_cNewKatOs : comp    //ссылка на ИК, в которую копируем
                                        );
//------------------------------------------------------------------------------
#doc
  Пересчет сумм
#end
  procedure RecalcSums(In_cKatOs    : comp;   //ссылка на ИК
                       In_dNewKoef  : double; //коэффициент пересчета
                       In_dKoefKind : double  //при проведении операции: 0 - для нового объекта, 1 - для старого; при отмене операции - 0
                      );
//------------------------------------------------------------------------------
#doc
  Возвращает True, если данные храним за общее количество</brief><br>
  (это в случае, если хотя бы в одном из методов стоит настройка "общая стоимость")
#end
  function IsBothCommonStoim(In_wGetTiDk : word  //Тип (15-ОС, 16-НМА)
                            ) : boolean;
//------------------------------------------------------------------------------
#doc
  Расчёт разниц для одной ИК
#end
  procedure CalcOneOsRazn(In_dCalcDate : date;    //дата расчета
                          In_cKatOs    : comp;    //ссылка на ИК
                          In_bNeedCalc : boolean  //признак необходимости рассчета разниц
                         );
//------------------------------------------------------------------------------
#doc
  Расчёт разниц данных по помеченным карточкам (если их нет, по текущей) </brief><br>
#end
  procedure DoCalcOsRazn(In_dDate : date // дата операции
                      );

//------------------------------------------------------------------------------
#doc
  Удаление разниц для одной ИК по типу
#end
  procedure DeleteOneOsRaznEd(In_TiDk     : word;
                              In_dDelDate : date; //дата разницы
                              In_cKatOs   : comp  //ссылка на ИК
                             );

//------------------------------------------------------------------------------
#doc
  Удаление разниц для одной ИК за дату
#end
  procedure DeleteOneOsRazn(In_dDelDate : date; //дата разницы
                            In_cKatOs   : comp  //ссылка на ИК
                           );
//------------------------------------------------------------------------------
#doc
  Удаление разниц для одной ИК
#end
  procedure DeleteOsRazn(In_cKatOs   : comp  //ссылка на ИК
                        );
//------------------------------------------------------------------------------
#doc
  Удаление разниц данных по помеченным карточкам </brief><br>
#end
  procedure DoDeleteOsRazn(In_dDate : date // дата операции
                        );
//------------------------------------------------------------------------------
#doc
  Проверка параметров перед расчётом или отменой
#end
  function CheckOsRaznParams(In_bFromOsRazn : boolean; //True - вызывается из данного интерфейса
                             In_bOperKind   : word     //1-расчёт, 2-отмена
                            ) : boolean; //True - если всё хорошо, иначе - False
//------------------------------------------------------------------------------
#doc
  Считывание настроек
#end
  procedure GetOsRaznTunes(In_wTuneTiDk : word);
//------------------------------------------------------------------------------
#doc
  Расчёт разниц за период по одной ИК (без учета отчетного периода карточки)
#end
procedure CalcPeriodOneOsRazn(In_dCalcDateBeg : date; //дата начала расчета
			      In_dCalcDateEnd : date; //дата конца расчета
                              In_cKatOs       : comp  //ссылка на ИК
                             );
//------------------------------------------------------------------------------
#doc
  Абстрактный (виртуальный) расчет разниц для одной ИК
#end
  Function CalcOneOsRaznAbstract(In_dCalcDate : date;
                                 In_cKatOs
                               , In_cMoveOS
                               , In_cAlg1
                               , In_cAlg2
                               , In_cAlg3
                               , In_cAlg4
                               , In_cAlg5     : comp;
                                 pwParam      : word;
                              var _doVVRNachM
                                , _doVVRPogM
                                , _doNVRNachM
                                , _doNVRPogM
                                , _doPRM : double) : word;
//------------------------------------------------------------------------------
#doc
  Дополнительные параметры при расчете разниц
#end
  Procedure SetOthersParam(pwParam : word);
//------------------------------------------------------------------------------
#doc
  Создание временной таблицы с данными для абстрактного расчете разниц для одной ИК
#end
  Function Init_MTOsRaznTbl(pwTiDk: word; pcKatOs: comp; pdDate: date): boolean;
//------------------------------------------------------------------------------
#doc
  Обновление данных во временной таблице при абстрактном расчете разниц для одной ИК
#end
  Function UpdateAndGetNext_MTOsRaznTbl(pwTiDk: word;
                                        pcKatOs: comp;
                                        pdCurrDate
                                      , pdNextDate: date;
                                        doVVRNachM
                                      , doVVRPogM
                                      , doNVRNachM
                                      , doNVRPogM
                                      , doPRM : double): boolean;
//------------------------------------------------------------------------------
#doc
  Копирование разниц данных до начала учёта из одной ИК в другую за текущий период
#end
  Procedure CopyStartingOsRaznFromOneIkToAnother(In_cOldKatOs : comp;   //ссылка на ИК, из которой берем данные для копирования
                                                 In_cNewKatOs : comp );    //ссылка на ИК, в которую копируем

//------------------------------------------------------------------------------
// Погасить разницы при проведение операции выбытия ОС 103.6506
Function PogasRazn (_cKatOs: comp) : boolean;


end;    //  ObjInterface


VipInterface OsRazn Implements ObjOsRazn  Licensed   (Free);
