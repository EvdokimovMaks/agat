//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.1 - ОС и НМА
// Функции для серийных номеров МЦ в ОС/НМА
//------------------------------------------------------------------------------
#ifndef __OSSERIALN_VIH__
#define __OSSERIALN_VIH__

#ifdef ComponentVersion
#Component "F_OS"
#end
#doc
Функции для серийных номеров МЦ в ОС/НМА
#end
ObjInterface objOsSerialN;
//------------------------------------------------------------------------------
  #doc
  Инициализация
  #end
  Procedure Init;
//------------------------------------------------------------------------------
  #doc
  Снятие всех установленных ранее ограничений с "Серийных номеров"
  #end
  Procedure DestroyAllSerialNBounds;
//------------------------------------------------------------------------------
  #doc
  Перевод карточек серийных номеров в ОС/НМА на основании позиции сопроводительного документа
  #end
  // Параметры:
  // pwStatus    - статус, в который переводятся серийные номера
  // pwTypeSeek  - тип сопроводительного документа: 1 - ордер, 2 - накладная
  // pcObject    - объект, в который переводятся серийные номера
  // pcSpDoc     - позиция спецификациии сопроводительного документа
  Function MoveSerialNbySpDoc(pwStatus, pwTypeSeek: word; pcObject, pcSpDoc: comp): word;
//------------------------------------------------------------------------------
  #doc
  Перевод выбранной/выбранных карточек серийных номеров в ОС/НМА...
  #end
  // Параметры:
  // pwStatus    - статус, в который переводятся серийные номера
  // pcObject    - объект, в который переводятся серийные номера
  // pcRecCardSN - ссылка серийный номер
  // psMrkName   - маркер серийных номеров
  Function MoveSerialNbyMarker(pwStatus: word; pcObject, pcRecCardSN : comp; psMrkName: string): word;
//------------------------------------------------------------------------------
  #doc
  Резервирование(снятие резерва) выбранного/выбранных серийных номеров для проведения операции ОС/НМА
  #end
  // Параметры:
  // pwStatus    - текущий статус серийного номера
  // pwSysOper   - тип объекта резервирования
  // pcSpOper    - объект резервирования
  // pcRecCardSN - ссылка на серийный номер
  // psMrkName   - маркер серийных номеров
  // pboIsReserv - True - резервирование / False - снятие резерва
  Function ReservedSerialNbyMarker(pwStatus
                                 , pwSysOper   : word;
                                   pcSpOper
                                 , pcRecCardSN : comp;
                                   psMrkName   : string;
                                   pboIsReserv : boolean): word;
//------------------------------------------------------------------------------
  #doc
  Получить ссылку объекта, для которого зарезервирован серийный номер
  #end
  Function GetReservedSerialNForObject(pcCardSN: comp; var pwTiDk: word): comp;
//------------------------------------------------------------------------------
  #doc
  Поиск свободного серийного номера связанного с позицией спецификации ордера/накладной при переводе в ОС
  #end
  // Поиск свободного серийного номера (количество номеров в маркере серийных номеров)
  // связанного с позицией спецификации ордера/накладной при переводе в ОС
  // Возвращает ссылку на первый найденный свободный серийный номер
  // Параметры:
  // pwStatus   - не используется
  // pwTypeSeek - поиск для : 1 - ордера, 2 - накладной
  // pwMode     - режим поиска: 0 - первый свободный, AND 1 - все, с формированием маркера
  // pcSpDoc    - ссылка на позицию спецификации сопроводительного документа
  // iMrkCount  - количество элементов (серийных номеров) в МАРКЕРЕ
  Function GetFreeRecCardSN(pwStatus, pwTypeSeek, pwMode: word; pcSpDoc: comp; var iMrkCount: longint): comp;
//------------------------------------------------------------------------------
  #doc
  Серийный номер (количество номеров в маркере серийных номеров) привязанный к объекту учета
  #end
  // Возвращает ссылку на первый найденный серийный номер для объекта учета
  // Параметры:
  // pwTiDk     - тип объекта
  // pcObject   - ссылка на объект
  // pwMode     - режим поиска: 0 - первый, AND 1 - все, с формированием маркера
  // iMrkCount  - количество элементов (серийных номеров) в МАРКЕРЕ
  Function GetCardSNForObject(pwTiDk: word; pcObject: comp; pwMode: word; var iMrkCount: longint): comp;
//------------------------------------------------------------------------------
  #doc
  Отмена перевода серийных номеров в карточку ОС/НМА
  #end
  Function UnMoveSerialN(pwTiDk: word; pcObject, pcMC: comp): word;
//------------------------------------------------------------------------------
  #doc
  Перечень серийных номеров для объекта учета ОС/...
  #end
  // Параметры:
  // pwTiDk   - тип объекта
  // pcObject - ссылка на объект
  // pcMC     - ссылка на МЦ
  // pwMode   - режим запуска окна просмотра серийных номеров:
  // pwMode AND 1  - разрешен ручной выбор (внесене исправлений)
  //        AND 2  - отображать количество "ИЗ" (из сопроводительного документа, если не 0)
  //        AND 4  - запрещено ручное удаление
  // для интерфейса выбора
  //        and 8  - без конроля привязанности к другим объектам
  //        and 16 - без конроля зарезервированности
  Function SetSerialNForObject(pwTiDk: word; pcObject, pcMC: comp; pwMode: word): word;
//------------------------------------------------------------------------------
  #doc
  Перечень выбранных серийных номеров МЦ для объекта
  #end
  // pcCardN  - ссылка на серийный номер
  // mrkNameSN- маркер просматриваемых серийнызх номер
  // pwTiDk   - тип объекта
  // pcObject - ссылка на объект
  // pcMC     - ссылка на МЦ
  // pwMode   - режим запуска окна просмотра серийных номеров:
  // pwMode AND 1  - разрешен ручной выбор
  //        AND 2  - отображать количество ИЗ (из сопроводительного документа, если не 0)
  //        AND 4  - запрещено ручное удаление
  // для интерфейса выбора
  //        and 8  - без конроля привязанности к другим объектам
  //        and 16 - без конроля зарезервированности
  Function ViewPickedSerialN(pcCardN: comp; mrkNameSN: string; pwTiDk: word; pcObject: comp; pwMode: word): word;
//------------------------------------------------------------------------------
  #doc
  Автоформирование режима просмотра серийных номеров для объекта учета
  #end
  Function GetModeView(pwTiDk: word; pcObject, pcMC: comp) : word;
//------------------------------------------------------------------------------
  #doc
  Сохранить маркер серийных номеров в  UserDeskRep, PickRep для дальнейшей обработки
  #end
  Function SetSerialNInUserDeskRep(pcUserDeskRep: comp; psNameMarker: string) : comp;
//------------------------------------------------------------------------------
  #doc
  Восстановить маркер серийных номеров из UserDeskRep
  #end
  Function GetSerialNFromUserDeskRep(pcUserDeskRep: comp; psNameMarker: string) : boolean;
//------------------------------------------------------------------------------
  #doc
  Удаление данных о серийных номерах для UserDeskRep
  #end
  Function DelSerialNFromUserDeskRep(pcUserDeskRep: comp) : boolean;
//------------------------------------------------------------------------------
  #doc
  Удаление всех (собственных) данных о серийных номерах из UserDeskRep
  #end
  Function DelAllSerialNFromUserDeskRep : boolean;
//------------------------------------------------------------------------------
end;

VipInterface OsSerialN Implements objOsSerialN
#ifdef ATL51
  Licensed   (Free)
#end
;
#end
