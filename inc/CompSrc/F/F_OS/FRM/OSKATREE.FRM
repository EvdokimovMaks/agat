//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
// Галактика 8.1 - Бухгалтерский контур
//  Реестр инвентарных карточек
// (: 'T:-' ) - такой формат  позволяет печатать в форме со сдвигом, не убирая лидирующие пробелы 
// Используется для печати номера и названия в Иерархиии карточки
//------------------------------------------------------------------------------

#include FeeSigners.frn

#doc
  Форма для печати реестра инвентарных карточек
#end
.set name = 'Oskatree'
.hide
.fields
  ОС_НМ
  Метод_Учета
  ДАТА

! FiltersKatOs
  Наименование_фильтра

! Для приложения к ОС-6
  Вышестоящий_Инвентарный_номер

! CycleOfKart
  KatosNrec
  KatoscMc
  Инвентарный_номер : string  : 'T:-'
  Наименование      : string  : 'T:-'
  Количество_однотипных_объектов
  Единица_измерения_nRec : comp
  Единица_измерения
!
  Заводской_номер
  Наименование_завода_изготовителя
  Номер_паспорта_объекта
  Модель_тип_марка_объекта
  Номенклатурный_номер
  Код_партии
  Регистрационный_номер_транспортного_средства
!
  Группа_основных_средств
  Вид_основных_средств
  Код_нормы_амортизации
  Норма_амортизации
  Использование_ОС
  Подразделение
  Материально_ответственное_лицо
!
  Балансовая_стоимость           : double
  Сумма_износа                   : double
  Износ_за_месяц                 : double
  Стоимость_при_поступлении      : double
  Износ_при_поступлении            : double
  Фиксированная_сумма_амортизации  : double
  Срок_полезного_использования     : double
!
  Дата_выпуска                : date
  Дата_ввода_в_эксплуатацию   : date
  Дата_поступления            : date
  Дата_выбытия                : date
  Дата_гарантии               : date
!
  Валюта
  Метод_начисления_амортизации
  Типовая_хозяйственная_операция_по_начислению_амортизации
  Тип_объекта
  Код_группировки_по_ОКОФ
  Наименование_кода_группировки_по_ОКОФ
  Поправочный_коэффициент
!
  Краткая_индивидуальная_характеристика
!
  Итого_Сумма_Балансовой_стоимости      : double
  Итого_Сумма_Износа                    : double
!

#FeeSigners_Os_Fields

.endfields
.var iExcelFormat : ExcelFormat;
.endvar

^ ^ ^
.{ FiltersKatOs CheckEnter
  Наименование_фильтра - ^
.}

Вышестоящий_Инвентарный_номер ^

.{ CycleOfKart   CheckEnter
 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.}
^^

#FeeSigners_Os_Body(Oskatree)

.endform


!------------------------------------------------------------------------------------------------------------------------------------------------------
.linkform 'OsKatree_01Ex' prototype is 'Oskatree'
.NameInList 'Реестр инвентарных карточек'
.group 'ReestrEx'
.p 50
#FeeSigners_Os_LinkVar
.fields
  CommonFormHeader
  if (boGetTune('Rep.IsHeader'), sGetTune('MyOrg'), '')
!
  ОС_НМ
  '(Метод учета: ' + Метод_Учета + ')'
  ДАТА
  Наименование_фильтра
!
  Инвентарный_номер   : 'T:-'
  Наименование        : 'T:-'
!
  iExcelFormat.DateToStrRep(Дата_поступления)
  iExcelFormat.DateToStrRep(Дата_выбытия)
!
  iExcelFormat.DoubleToStrRep( Балансовая_стоимость )
  iExcelFormat.DoubleToStrRep( Сумма_Износа )
  Количество_однотипных_объектов
!
  iExcelFormat.DoubleToStrRep( Итого_Сумма_Балансовой_стоимости )
  iExcelFormat.DoubleToStrRep( Итого_Сумма_Износа )
!
.endfields
.[H Skip
 Р                                                                                                                             лист @np@
────────────────────────────────┬────────────────────────────────┬──────────┬──────────┬─────────────────┬──────────────────┬────────────
        Инвентарный номер       │         Наименование           │   Дата   │   Дата   │ Первоначальная  │      Сумма       │ Количество
                                │                                │поступлен.│  выбытия │    стоимость    │      износа      │
────────────────────────────────┴────────────────────────────────┴──────────┴──────────┴─────────────────┴──────────────────┴──────────── Р
.]H
 Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                  &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Р

 Б        РЕЕСТР ИНВЕНТАРНЫХ КАРТОЧЕК УЧЕТА ^
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                        @~@@@@@@@@@@@@@@@@@ Б

.{ FiltersKatOs CheckEnter
   ^
.}
 Р                                                                                                                             лист @np@
────────────────────────────────┬────────────────────────────────┬──────────┬──────────┬─────────────────┬──────────────────┬────────────
        Инвентарный номер       │         Наименование           │   Дата   │   Дата   │ Первоначальная  │      Сумма       │ Количество
                                │                                │поступлен.│  выбытия │    стоимость    │      износа      │
────────────────────────────────┴────────────────────────────────┴──────────┴──────────┴─────────────────┴──────────────────┴──────────── Р
.{ CycleOfKart   CheckEnter
 Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&&&&.&&│&&&&&&&&&&&&&&&.&&│&&&&&&&&&&&& Р
.}
 С─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                      Итого:                            &&&&&&&&&&&&&&.&& &&&&&&&&&&&&&&&.&& С


#FeeSIgners_Os_LinkInit(Oskatree)
 Р.fields
  Председатель_Должность
  Председатель_ФИО
.endfields
 Председатель комиссии: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи

.{While (Номер_подписанта < Количество_Членов_комиссии) OR (Номер_подписанта < 1)
.begin
  Номер_подписанта++;
end.
.fields
  if (Номер_подписанта = 1, 'Члены комиссии:', '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_Должность [Номер_подписанта], '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_ФИО   [Номер_подписанта], '')
.endfields
 @@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи

.} Р
.endform


!------------------------------------------------------------------------------------------------------------------------------------------------------
.linkform 'OsKatree_02' prototype is 'Oskatree'
.NameInList 'Приложение к форме ОС - 6'
.group 'Pril'
.p 50
#FeeSigners_Os_LinkVar
.fields
  Вышестоящий_Инвентарный_номер

  Инвентарный_номер : 'T:-'
  Код_группировки_по_ОКОФ
  Наименование      : 'T:-'
  Единица_измерения

  Количество_однотипных_объектов
  iExcelFormat.DoubleToStrRep( Сумма_Износа )
  iExcelFormat.DoubleToStrRep( Балансовая_стоимость )

  iExcelFormat.DoubleToStrRep( Итого_Сумма_Износа )
  iExcelFormat.DoubleToStrRep( Итого_Сумма_Балансовой_стоимости )
.endfields
.[H Skip
 Р                                                                                                                 лист @np@
────────────────┬─────────┬────────────────────────────────────┬─────┬──────────┬─────────────────────┬─────────────────────
 Дополнительный │   Код   │    Наименование оборудования       │ЕдИзм│  Кол-во  │     Сумма износа    │      Стоимость
  инвентарный   │ оборуд. │                                    │     │          │                     │
     номер      │         │                                    │     │          │                     │
────────────────┼─────────┼────────────────────────────────────┼─────┼──────────┼─────────────────────┼───────────────────── Р
.]H
 Б
.{ FiltersKatOs CheckEnter
.}
                              Приложение
                  к инвентарной карточке N @@@@@@@@@@@@@
                         учета основных средств
 Б
 Р                                                                                                                 лист @np@
────────────────┬─────────┬────────────────────────────────────┬─────┬──────────┬─────────────────────┬─────────────────────
 Дополнительный │   Код   │    Наименование оборудования       │ЕдИзм│  Кол-во  │  Общая сумма износа │    Общая стоимость
  инвентарный   │ оборуд. │                                    │     │          │                     │
     номер      │         │                                    │     │          │                     │
────────────────┼─────────┼────────────────────────────────────┼─────┼──────────┼─────────────────────┼───────────────────── Р
.{ CycleOfKart   CheckEnter
 Р@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@│&&&&&&&&&&│&&&&&&&&&&&&&&&&&&.&&│&&&&&&&&&&&&&&&&&&.&& Р
.}
 Р────────────────┴─────────┴────────────────────────────────────┴─────┴──────────┴─────────────────────┴─────────────────────
                                                            Итого:               &&&&&&&&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&&.&& Р
#FeeSIgners_Os_LinkInit(Oskatree)
.endform
