//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 6.00 - Векселя и кредиты
// Печать результатов распределения платежного документа
//------------------------------------------------------------------------------

#doc
Печать результатов распределения платежного документа
#end

.set name='OplVeksl'
.hide

.fields
  MyNr       : comp     /* Nrec из AppVeks или GrefKred */
  TipDk      : word     /* 81..88,185,186               */
  TipKred    : word     /* TiDk из GrefKred             */
  DocName    : string   /* Вид документа                */
  NoAppKred  : string   /* Номер акта или графика       */
  DatAppKred : date     /* Дата акта или графика        */
  NoDoc      : string   /* Номер спецификации           */
  DatVip     : date     /* Дата документа               */
  StageTip   : string   /* Тип этапа погашения кредита  */
  Sum_Veksl  : double   /* Сумма документа              */
  SumCommon  : double   /* Сумма платежа                */
  Val2       : string   /* Валюта документа             */
!-----------
  NoDoc2     : string   /* Номер платежного документа   */
  Dat_Op     : date     /* Дата платежного документа    */
  Sum        : double   /* Сумма платежного документа   */
  Val        : string   /* Валюта платежного документа  */
  SumNDE     : double   /* Сумма платежного док. в НДЕ  */
.endfields

^ ^ ^
^ ^ ^
.{
^ ^ ^ ^ ^ ^
.{ VekslOpLoop CheckEnter
^ ^ ^ ^ ^
.}
.}

.endform

!------------------------------------------------------
!------------------------------------------------------
!------------------------------------------------------
.linkform 'OplVeksl01' prototype is 'OplVeksl'
.group 'Распределение по спецификациям'
.nameinlist 'Результаты распределения'
.defo Landscape
.p 45
.fields
  CommonFormHeader
  DocName
  NoAppKred
  if (Longint(DatAppKred) > 0, DateToStr(DatAppKred, 'DD/MM/YYYY'), '')
  NoDoc
  if (Longint(DatVip) > 0, DateToStr(DatVip, 'DD/MM/YYYY'), '')
  Sum_Veksl
  SumCommon
  Val2
!-----------
  NoDoc2
  if (Longint(Dat_Op) > 0, DateToStr(Dat_Op, 'DD/MM/YYYY'), '')
  Sum
  Val
.endfields
 С^ С
              Б  ^ ^ от ^ Б
.{
.[h
 С                                                                                                                  лист @Np@
─────────────┬──────────┬─────────────────────┬─────────────────────┬──────┬─────────────┬──────────┬─────────────────────┬──────
  № док-та   │   Дата   │  Сумма по операции  │    Сумма платежа    │Валюта│№ плат.док-та│   Дата   │    Сумма оплаты     │Валюта
─────────────┴──────────┴─────────────────────┴─────────────────────┴──────┴─────────────┴──────────┴─────────────────────┴──────
.]h
@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&& @@@@@@
.{ VekslOpLoop CheckEnter
                                                                            @@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& @@@@@@
.}
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── С
.}
.endform

!------------------------------------------------------
!------------------------------------------------------
!------------------------------------------------------
.linkform 'OplVeksl02' prototype is 'OplVeksl'
.group 'Распределение по план-графикам кредитов'
.nameinlist 'Результаты распределения'
.defo Landscape
.p 45
.fields
  CommonFormHeader
  DocName
  NoAppKred
  if (Longint(DatAppKred) > 0, DateToStr(DatAppKred, 'DD/MM/YYYY'), '')
!-----------
  if (Longint(DatVip) > 0, DateToStr(DatVip, 'DD/MM/YYYY'), '')
  Sum_Veksl
  SumCommon
  Val2
!-----------
  NoDoc2
  if (Longint(Dat_Op) > 0, DateToStr(Dat_Op, 'DD/MM/YYYY'), '')
  Sum
!-----------
  NoDoc2
  if (Longint(Dat_Op) > 0, DateToStr(Dat_Op, 'DD/MM/YYYY'), '')
  Sum
  SumNDE
.endfields
 Р^
                         Б  ^ ^ от ^ Б
.{
.[h
.{?Internal; (Val2 = '');
                                                                                                  лист @Np@
 Б──────────┬─────────────────────┬─────────────────────┬──────┬─────────────┬──────────┬─────────────────────
   Дата   │     Сумма этапа     │ Сумма по документам │Валюта│№ плат.док-та│   Дата   │        Сумма
──────────┴─────────────────────┴─────────────────────┴──────┴─────────────┴──────────┴───────────────────── Б
.}
.{?Internal; (Val2 <> '');
                                                                                                                        лист @Np@
 Б──────────┬─────────────────────┬─────────────────────┬──────┬─────────────┬──────────┬─────────────────────┬─────────────────────
   Дата   │     Сумма этапа     │ Сумма по документам │Валюта│№ плат.док-та│   Дата   │   Сумма в валюте    │     Сумма в НДЕ
──────────┴─────────────────────┴─────────────────────┴──────┴─────────────┴──────────┴─────────────────────┴───────────────────── Б
.}
.]h
@@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&& @@@@@@
.{ VekslOpLoop CheckEnter
.{?Internal; (Val2 = '');
                                                              @@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&&
.}
.{?Internal; (Val2 <> '');
                                                              @@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&&
.}
.}
.{?Internal; (Val2 = '');
────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.{?Internal; (Val2 <> '');
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.} Р
.endform

!------------------------------------------------------
!------------------------------------------------------
!------------------------------------------------------
.linkform 'OplVeksl03' prototype is 'OplVeksl'
.group 'Распределение по план-графикам погашения кредитов'
.nameinlist 'Результаты распределения'
.defo Landscape
.p 45
.fields
  CommonFormHeader
  DocName
  NoAppKred
  if (Longint(DatAppKred) > 0, DateToStr(DatAppKred, 'DD/MM/YYYY'), '')
!-----------
  if (Longint(DatVip) > 0, DateToStr(DatVip, 'DD/MM/YYYY'), '')
  StageTip
  Sum_Veksl
  SumCommon
  Val2
!-----------
  NoDoc2
  if (Longint(Dat_Op) > 0, DateToStr(Dat_Op, 'DD/MM/YYYY'), '')
  Sum
!-----------
  NoDoc2
  if (Longint(Dat_Op) > 0, DateToStr(Dat_Op, 'DD/MM/YYYY'), '')
  Sum
  SumNDE
.endfields
 Р^
                                      Б  ^ ^ от ^ Б
.{
.[h
.{?Internal; (Val2 = '');
                                                                                                                      лист @Np@
 Б──────────┬───────────────────┬─────────────────────┬─────────────────────┬──────┬─────────────┬──────────┬─────────────────────
   Дата   │     Тип этапа     │     Сумма этапа     │  Погашенная сумма   │Валюта│№ плат.док-та│   Дата   │       Сумма
──────────┴───────────────────┴─────────────────────┴─────────────────────┴──────┴─────────────┴──────────┴───────────────────── Б
.}
.{?Internal; (Val2 <> '');
                                                                                                                                            лист @Np@
 Б──────────┬───────────────────┬─────────────────────┬─────────────────────┬──────┬─────────────┬──────────┬─────────────────────┬─────────────────────
   Дата   │     Тип этапа     │     Сумма этапа     │  Погашенная сумма   │Валюта│№ плат.док-та│   Дата   │   Сумма в валюте    │     Сумма в НДЕ
──────────┴───────────────────┴─────────────────────┴─────────────────────┴──────┴─────────────┴──────────┴─────────────────────┴───────────────────── Б
.}
.]h
@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&& @@@@@@
.{ VekslOpLoop CheckEnter
.{?Internal; (Val2 = '');
                                                                                  @@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&&
.}
.{?Internal; (Val2 <> '');
                                                                                  @@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&&
.}
.}
.{?Internal; (Val2 = '');
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.{?Internal; (Val2 <> '');
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.} Р
.endform
