//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 6.00 - Векселя и кредиты
// Печать реестра векселей, ценных бумаг, кредитов
//------------------------------------------------------------------------------

#doc
Печать реестра векселей, ценных бумаг, кредитов
#end

.set name='VekslR'
.nameinlist 'Базовая форма'
.hide
.fields

  bMarkedDocs : boolean  // выводятся только помеченные документы

  Name_Doc

  OrgPlat : string
  OrgPl   : string
  OrgDerg : string
  OrgPol  : string
  OrgPlh  : string

  fSrDoc
  fNoBlnk

  fDatVipSt
  fDatVipEnd
  fDatOplSt
  fDatOplEnd
  fDatOBSt
  fDatOBEnd

  fVidVeksName
  fUslPogName

  fPlatName
  fPlName
  fPolName
  fPlhName

!.{
  fStatName
!.}

!.{
 StatName
 NameVid1
 NameVid2

 SrDoc
 NoDoc
 NoDocEnd
 NoBlnk
 kol    : longint

 DatVip
 DatOpl
 DatOb

 Sum    : double
 SumV   : dOuble
 SumPl  : double
 SumPlV : double
 Curr1
 Curr2

 PrGod  : double
 PrSimv

 PlatName
 PlName
 PolName
 PlhName
 DergName

 UslPog
 MestVip
 MestGah

 IsLeaf : word
 DocNRec : comp
!.}

 Itogo_Sum_Doc     : double
 Itogo_Sum_Opl     : double

 Itogo_Sum_Doc_Val : double
 Itogo_Sum_Opl_Val : double
 Itogo_Curr
.endfields

^ ^ ^ ^ ^ ^ ^

.if VekslFiltr
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.if VekslFiltrStat
.{
^
.}
.end
.end

.{
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}

^ ^
.if VekslSingleCurrency
^ ^ ^
.end

.endform



.linkform 'VekslR01' prototype is 'VekslR'
.NameInList 'Реестр документов'
.group 'Реестр'
.p 80
.defo portrait
.fields
  CommonFormHeader
  Name_Doc
  if(bMarkedDocs,'(по помеченным документам)','')
.endfields
.[h
 Ш                                                                                                                                                   Лист @Np@ Ш
.]h
^
 Ш
                                      РЕЕСТР ^
                                     ^
.if VekslFiltr
.fields
                  fSrDoc                                         fNoBlnk                   OrgPlat         fPlatName
                  fVidVeksName                                   fDatVipSt     fDatVipEnd  OrgPl           fPlName
                  fUslPogName                                    fDatOplSt     fDatOplEnd  OrgPol          fPolName
                                                                 fDatOBSt      fDatOBEnd   OrgPlh          fPlhName
  fStatName
.endfields
Применен фильтр...
Серия документа   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  Бланк документа @@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Вид документа     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  Дата выписки с @@@@@@@@@@ по @@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Условие погашения @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  Дата гашения с @@@@@@@@@@ по @@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                                  Факт.погашен с @@@@@@@@@@ по @@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.if VekslFiltrStat
Статус документа
.{
  ^
.}
.end
.end
.fields
                                                                                                                                  OrgPlat
                                                                                                                                  OrgPl
                                                                                                                                  OrgDerg
 StatName     SrDoc     DatVip     DatOb      NameVid1             Sum                   SumPl              PrGod        Curr1 PlatName
              NoDoc     DatOpl                NameVid2             SumV                  SumPlV                          Curr2 PlName
                                                                                                                               DergName
 StatName     SrDoc     DatVip     DatOb      NameVid1             Sum                   SumPl              PrGod        Curr1 PlatName
              NoDoc     DatOpl                NameVid2             SumV                  SumPlV                          Curr2 PlName
                                                                                                                               DergName
.endfields
.{
.[h
───────────┬─────────┬──────────┬──────────┬────────────────────┬─────────────────────┬─────────────────────┬─────────┬──────┬──────────────────────────────
   Статус  │  Серия/ │   Дата   │ Фактичес.│                    │        Сумма        │        Сумма        │ Процент │Валюта│      ^
 документа │  номер  │ выписки/ │ погашен  │   Вид документа    │     по документу    │       к оплате      │ годовых │      │      ^
           │документа│ гашения  │          │                    │                     │                     │         │      │      ^
───────────┴─────────┴──────────┴──────────┴────────────────────┴─────────────────────┴─────────────────────┴─────────┴──────┴──────────────────────────────
.]h
.{?Internal;(IsLeaf = 0); Б
@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&& &&&.&&&&& @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
            @@@@@@@@@ @@@@@@@@@@            @@@@@@@@@@@@@@@@@@@@ &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&&           @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                                                                                                              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}
.{?Internal;(IsLeaf = 1);
@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&& &&&.&&&&& @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
            @@@@@@@@@ @@@@@@@@@@            @@@@@@@@@@@@@@@@@@@@ &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&&           @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                                                                                                              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
  Itogo_Sum_Doc
  Itogo_Sum_Opl
  Curr1
  Itogo_Sum_Doc_Val
  Itogo_Sum_Opl_Val
  Itogo_Curr
.endfields
                                            Итого:               &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&&           @@@@@
.if VekslSingleCurrency
                                                                 &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&&           @@@@@
.end
 Ш
.endform




.linkform 'VekslR83' prototype is 'VekslR'
.NameInList 'Реестр ценных бумаг'
.group 'Реестр ЦБ'
.p 80
.defo portrait
.fields
  CommonFormHeader
  Name_Doc
  if(bMarkedDocs,'(по помеченным документам)','')
.endfields
.[h
 Ш                                                                                                                                                   Лист @Np@ Ш
.]h
^
 Ш
                                      РЕЕСТР ^
                                     ^
.if VekslFiltr
.fields
                  fSrDoc                                         fNoBlnk                   OrgPlat         fPlatName
                  fVidVeksName                                   fDatVipSt     fDatVipEnd  OrgPl           fPlName
                  fUslPogName                                    fDatOplSt     fDatOplEnd  OrgPol          fPolName
                                                                 fDatOBSt      fDatOBEnd   OrgPlh          fPlhName
  fStatName
.endfields
Применен фильтр...
Серия документа   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  Бланк документа @@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Вид документа     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  Дата выписки с @@@@@@@@@@ по @@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Условие погашения @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  Дата гашения с @@@@@@@@@@ по @@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                                  Факт.погашен с @@@@@@@@@@ по @@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.if VekslFiltrStat
Статус документа
.{
  ^
.}
.end
.end
.fields
                                                                                                                                  OrgPlat
                                                                                                                                  OrgDerg
 StatName     SrDoc     DatVip     DatOb      NameVid1             Sum                   SumPl              PrGod PrSimv Curr1 PlatName
              NoDoc     DatOpl                NameVid2             SumV                  SumPlV                          Curr2 DergName
.endfields
.{
.[h
─────────────┬─────────┬──────────┬──────────┬────────────────────┬─────────────────────┬─────────────────────┬───────┬──────┬──────────────────────────────
    Статус   │  Серия/ │   Дата   │ Фактичес.│                    │        Сумма        │        Сумма        │Процент│Валюта│      ^
  документа  │  номер  │ выписки/ │ погашен  │   Вид документа    │     по документу    │       к оплате      │годовых│      │      ^
             │документа│ гашения  │          │                    │                     │                     │       │      │
─────────────┴─────────┴──────────┴──────────┴────────────────────┴─────────────────────┴─────────────────────┴───────┴──────┴──────────────────────────────
.]h
@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&& &&&.&&@ @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
              @@@@@@@@@ @@@@@@@@@@            @@@@@@@@@@@@@@@@@@@@ &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&&         @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
  Itogo_Sum_Doc
  Itogo_Sum_Opl
  Curr1
  Itogo_Sum_Doc_Val
  Itogo_Sum_Opl_Val
  Itogo_Curr
.endfields
                                              Итого:               &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&&         @@@@@
.if VekslSingleCurrency
                                                                   &'#&&&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&&&.&&         @@@@@
.end
 Ш
.endform



.linkform 'VekslR02' prototype is 'VekslR'
.NameInList 'Реестр источников кредитования'
.group 'Реестр ИК'
.p 80
.defo portrait
.fields
  CommonFormHeader
  Name_Doc
  if (bMarkedDocs, '(по помеченным документам)', '')
.endfields
.[h
 Ш                                                                                                                                                   Лист @Np@ Ш
.]h
 Ш^

                                      РЕЕСТР ^
                                     ^
.if VekslFiltr
.fields
  fVidVeksName
  fDatVipSt     fDatVipEnd
  fDatOplSt     fDatOplEnd
  fDatOBSt      fDatOBEnd
  fStatName
.endfields
Применен фильтр...
  Вид документа    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Дата открытия    с @@@@@@@@@@ по @@@@@@@@@@
  Дата закрытия    с @@@@@@@@@@ по @@@@@@@@@@
  Факт. закрыт     с @@@@@@@@@@ по @@@@@@@@@@
.if VekslFiltrStat
Статус документа
.{
  ^
.}
.end
.end
.fields
 StatName    NoDoc     MestVip           DatVip     DatOb      NameVid1          Sum                 SumPl               Sum - SumPl       PrGod     Curr1
                                         DatOpl                NameVid2          SumV                SumPlV              SumV - SumPlV               Curr2
.endfields
.{
.[h
───────────┬─────────┬─────────────────┬──────────┬──────────┬─────────────────┬───────────────────┬───────────────────┬───────────────────┬─────────┬──────
  Статус   │  Номер  │  Наименование   │ Открытие/│  Факт.   │       Вид       │       Сумма       │       Сумма       │       Сумма       │ Процент │Валюта
 документа │документа│источника кредит.│ закрытие │  закрыт  │    документа    │    по документу   │вовлеченных средств│ свободных средств │ годовых │
───────────┴─────────┴─────────────────┴──────────┴──────────┴─────────────────┴───────────────────┴───────────────────┴───────────────────┴─────────┴──────
.]h
@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@ &'#&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&.&& &&&.&&&&& @@@@@@
                                        @@@@@@@@@@            @@@@@@@@@@@@@@@@@ &'#&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&.&&           @@@@@@
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
  Itogo_Sum_Doc
  Itogo_Sum_Opl
  Itogo_Sum_Doc - Itogo_Sum_Opl
  Curr1
  Itogo_Sum_Doc_Val
  Itogo_Sum_Opl_Val
  Itogo_Sum_Doc_Val - Itogo_Sum_Opl_Val
  Itogo_Curr
.endfields
                                            Итого:                              &'#&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&.&&           @@@@@@
.if VekslSingleCurrency
                                                                                &'#&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&&.&&           @@@@@@
.end
 Ш
.endform
