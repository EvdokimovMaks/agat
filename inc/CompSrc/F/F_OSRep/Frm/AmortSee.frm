//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.85 - Основные средства
// Разность данных по амортизации по методам учета
// Внимание! Существует slk-отчет в формате Excel
//------------------------------------------------------------------------------

#include FeeSigners.frn

#doc
Разность данных по амортизации по методам учета
#end


//*******************************************************************
.linkform 'AmortSee01' prototype is 'AmortSee'
.nameinlist 'Разность данных по амортизации по методам учета'
.group 'Разность данных по амортизации'
.p 60
.defo landscape
#FeeSigners_Os_LinkVar
.fields
  CommonFormHeader
  if (boGetTune('Rep.IsHeader'), sGetTune('MyOrg'), '')

  DateToStr(BegDate,'Mon YYYY')
  DateToStr(EndDate,'Month YYYY')

  Фильтр

  fMetodName1
  fMetodName2

  //---------------------------------------------
  // узел
  Node_Name

  DoubleToStr(double(Node_SIznM1), Формат_Сумм)
  DoubleToStr(double(Node_SIznM2), Формат_Сумм)

  DoubleToStr(double(Node_Raznost), Формат_Сумм)

  Node_ValName
  //---------------------------------------------
  // лист
  Leaf_Name

  Leaf_InvNumber // +
  Leaf_Period    // +

  DoubleToStr(double(Leaf_SIznM1), Формат_Сумм)
  Leaf_Algoritm1
  DoubleToStr(double(Leaf_SIznM2), Формат_Сумм)
  Leaf_Algoritm2

  DoubleToStr(double(Leaf_Raznost), Формат_Сумм)

  Leaf_ValName
  //---------------------------------------------

.endfields
 Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                                      &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& И
 И
 Б                                                                  Разность данных по амортизации по методам учета С Р
.{
                                                                      Бза период с ^ по ^ Б
Фильтры:
.{ AmortSee_Filter CheckEnter
 ^
.}
.{
.[H
                                                                                                                                                                                    лист @np@

─────────────────────────────────────────────┬───────────┬──────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┬───────────────────┬────────
                 Наименование                │Инвентарный│  Период  │@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│      Разность     │ Валюта
                                             │   номер   │          ├───────────────────┬─────────────────────────┼───────────────────┬─────────────────────────┤                   │
                                             │           │          │       Износ       │   Алгоритм начисления   │       Износ       │   Алгоритм начисления   │                   │
                                             │           │          │                   │       амортизации       │                   │       амортизации       │                   │
─────────────────────────────────────────────┴───────────┴──────────┴───────────────────┴─────────────────────────┴───────────────────┴─────────────────────────┴───────────────────┴────────
.]H
.{ AmortSee_Header CheckEnter
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                        &'&&&&&&&&&&&&&&&&&                           &'&&&&&&&&&&&&&&&&&                           &'&&&&&&&&&&&&&&&&& @@@@@@@ Б
.}
.{ AmortSee_Body CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ @~@@@@@@@@ &'&&&&&&&&&&&&&&&&& @@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&& @@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&& @@@@@@@
.}
.{ AmortSee_Footer CheckEnter

.}
.{ AmortSee_Line CheckEnter
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.}
.[F
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]F
.}

#FeeSIgners_Os_LinkInit(AmortSee)
.fields
  Председатель_Должность
  Председатель_ФИО
.endfields
 Председатель комиссии: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи

.{While (Номер_подписанта < Количество_Членов_комиссии) OR (Номер_подписанта < 1)
.begin
  Номер_подписанта++;
end.
.fields
  if (Номер_подписанта = 1, 'Члены комиссии:', '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_Должность [Номер_подписанта], '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_ФИО   [Номер_подписанта], '')
.endfields
 @@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи
.}

.endform

 Р//*******************************************************************
.linkform 'AmortSee02' prototype is 'AmortSee'
.nameinlist 'Постоянная и временная разница данных по амортизации'
.group 'Разность данных по амортизации <<Россия>>'
.p 60
.defo landscape
.var
  Node_VVRNachItog : double;
  Node_VVRPogItog  : double;
  Node_NVRNachItog : double;
  Node_NVRPogItog  : double;
.endvar
#FeeSigners_Os_LinkVar
.fields
  CommonFormHeader
  if (boGetTune('Rep.IsHeader'), sGetTune('MyOrg'), '')

  DateToStr(BegDate,'Mon YYYY')
  DateToStr(EndDate,'Month YYYY')

  Фильтр

  SubStr(fMetodName1,1,19)
  SubStr(fMetodName2,1,19)

  //---------------------------------------------
  // узел
  Node_Name

  DoubleToStr(double(Node_SIznM1), Формат_Сумм)
  DoubleToStr(double(Node_SIznM2), Формат_Сумм)

  DoubleToStr(double(Node_Raznost), Формат_Сумм)
  DoubleToStr(double(Node_PR     ), Формат_Сумм)
  DoubleToStr(double(Node_VVRNach), Формат_Сумм)
  DoubleToStr(double(Node_VVRPog ), Формат_Сумм)
  DoubleToStr(double(Node_NVRNach), Формат_Сумм)
  DoubleToStr(double(Node_NVRPog ), Формат_Сумм)
  Node_ValName
  if(Node_VVRNachItog = 0,'',DoubleToStr(Node_VVRNachItog, Формат_Сумм))
  if(Node_VVRPogItog  = 0,'',DoubleToStr(Node_VVRPogItog,  Формат_Сумм))
  if(Node_NVRNachItog = 0,'',DoubleToStr(Node_NVRNachItog, Формат_Сумм))
  if(Node_NVRPogItog  = 0,'',DoubleToStr(Node_NVRPogItog,  Формат_Сумм))
  //---------------------------------------------
  // лист
  Leaf_Name

  Leaf_InvNumber
  DateToStr(Leaf_Period,'MM.YYYY')

  DoubleToStr(double(Leaf_SIznM1), Формат_Сумм)
  DoubleToStr(double(Leaf_SIznM2), Формат_Сумм)

  DoubleToStr(double(Leaf_Raznost), Формат_Сумм)
  DoubleToStr(double(Leaf_PR     ), Формат_Сумм)
  DoubleToStr(double(Leaf_VVRNach), Формат_Сумм)
  DoubleToStr(double(Leaf_VVRPog ), Формат_Сумм)
  DoubleToStr(double(Leaf_NVRNach), Формат_Сумм)
  DoubleToStr(double(Leaf_NVRPog ), Формат_Сумм)

  Leaf_ValName
  //---------------------------------------------

.endfields
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                                                                         &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Р

                                  БРазность и разницы данных по амортизации по методам учета Б
.{
                                                Бза период с ^ по ^ Й
 ШФильтры:
.{ AmortSee_Filter CheckEnter
^
.}
.{
.[H
                                                                                                                                                                                                                       лист @np@
───────────────────────────────────────────┬───────────┬───────┬───────────────────┬───────────────────┬──────────────────┬──────────────────┬─────────────────────────────────────┬─────────────────────────────────────┬──────
              Наименование                 │Инвентарный│Период │@~@@@@@@@@@@@@@@@@@│@~@@@@@@@@@@@@@@@@@│     Разность     │    Постоянная    │        Вычитаемая временная         │     Налогооблагаемая временная      │Валюта
                                           │   номер   │       │                   │                   │                  │     разница      │               разница               │               разница               │
                                           │           │       │       Износ       │       Износ       │                  │                  ├──────────────────┬──────────────────┼──────────────────┬──────────────────┤
                                           │           │       │                   │                   │                  │                  │    Начисление    │    Погашение     │    Начисление    │    Погашение     │
───────────────────────────────────────────┴───────────┴───────┴───────────────────┴───────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────
.]H
.{ AmortSee_Header CheckEnter
.begin
  if ((AdditionalParam AND 1) = 0)
  {
    var Znak: double;  Znak := 1;

    //  Так было т.е. всегда получалось Znak:=1
    // Znak := 1.0;
    // if (Abs(Node_VVRNach) > 0.0)
    //  Znak := Round(Double(Node_VVRNach) / Double(Node_VVRNach));
    //  Так было исправлено, но неправильно
    // Znak := if(Abs(Node_VVRNach) > 0.0, Sign(Node_VVRNach), 1.0);

    if (Double(Node_VVRNach) - Znak * Double(Node_VVRPog)) >= 0
    {
      Node_VVRNachItog := Double(Node_VVRNach) - Znak * Double(Node_VVRPog);
      Node_VVRPogItog  := 0;
    }
    else
    {
      Node_VVRNachItog := 0;
      Node_VVRPogItog  := Double(Node_VVRPog) - Znak * Double(Node_VVRNach);
    }

    // Znak := if(Abs(Node_NVRNach) > 0.0, Sign(Node_NVRNach), 1.0);

    if (Double(Node_NVRNach) - Znak * Double(Node_NVRPog)) >= 0
    {
      Node_NVRNachItog := Double(Node_NVRNach) - Znak * Double(Node_NVRPog);
      Node_NVRPogItog  := 0;
    }
    else
    {
      Node_NVRNachItog := 0;
      Node_NVRPogItog  := Double(Node_NVRPog) - Znak * Double(Node_NVRNach);
    }
  }
end.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& @@@@@@
.{?Internal;(AdditionalParam AND 1) = 0);
                                                                                                                                        сумма &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
.}
.}
.{ AmortSee_Body CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ @~@@@@@ &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& @@@@@@
.}
.{ AmortSee_Footer CheckEnter

.}
.{ AmortSee_Line CheckEnter
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.}
.[F
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]F
.} Ш
 Р
#FeeSIgners_Os_LinkInit(AmortSee)
.fields
  Председатель_Должность
  Председатель_ФИО
.endfields
 Председатель комиссии: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи

.{While (Номер_подписанта < Количество_Членов_комиссии) OR (Номер_подписанта < 1)
.begin
  Номер_подписанта++;
end.
.fields
  if (Номер_подписанта = 1, 'Члены комиссии:', '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_Должность [Номер_подписанта], '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_ФИО   [Номер_подписанта], '')
.endfields
 @@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи
.}
 Р
.endform

//*******************************************************************

//*******************************************************************
.linkform 'AmortSee03' prototype is 'AmortSee'
.nameinlist 'Реестр разниц данных по амортизации по методам учета'
.group 'Реестр разниц данных по амортизации'
.p 60
.defo landscape
.var
  MrkKatOS : longint;
  IndNo    : longint;
.endvar
#FeeSigners_Os_LinkVar
.fields
  CommonFormHeader
  if (boGetTune('Rep.IsHeader'), sGetTune('MyOrg'), '')

  DateToStr(BegDate,'Mon YYYY')
  DateToStr(EndDate,'Month YYYY')

  Фильтр

  fMetodName1
  fMetodName2
.endfields
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                                                                                          &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

                                                                        БРеестр разниц данных по амортизации по методам учета Б
.{
.begin
  MrkKatOS := InitMarker('PrnReestr_ByRazn', 8, 100, 100, True);
  ClearMarker(MrkKatOS);
end.
                                                                                     Бза период с ^ по ^ Б
Фильтры:
.{ AmortSee_Filter CheckEnter
 ^
.}
БУ - бухгалтерский учет, метод - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
НУ - налоговый учет    , метод - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────┬──────┬─────────────────────────┬─────────────────────────────────┬────────────────────────────┬──────────────────┬───────────────────────────┬─────────────────────────┬──────────────────────────────────────┬─────────────────────────
        │      │                         │    Первоначальная  стоимость    │Разница между первоначальной│  Срок полезного  │   Амортизация за период   │    На начало периода    │               За период              │    На конец периода
        │      │                         │                                 │    стоимостью за период    │использования(мес)│                           │                         │                                      │
  Дата  │ Инв. │      Наименование       ├────────────────┬────────────────┼──────────────┬─────────────┼─────────┬────────┼─────────────┬─────────────┼────────────┬────────────┼────────────┬────────────┬────────────┼────────────┬────────────
  ввода │  №   │                         │                │                │              │             │         │        │             │             │ вычитаемые │ налогообла │ вычитаемые │ налогообла │ постоянные │ вычитаемые │ налогообла
        │      │                         │       БУ       │       НУ       │      ВВР     │     НВР     │    БУ   │   НУ   │      БУ     │      НУ     │  временные │ гаемые вре │  временные │ гаемые вре │  разницы   │  временные │ гаемые вре
        │      │                         │                │                │              │             │         │        │             │             │  разницы   │ менные раз │  разницы   │ менные раз │            │  разницы   │ менные раз
        │      │                         │                │                │              │             │         │        │             │             │   (ВВР)    │ ницы (НВР) │   (ВВР)    │ ницы (НВР) │            │   (ВВР)    │ ницы (НВР)
────────┼──────┼─────────────────────────┼────────────────┼────────────────┼──────────────┼─────────────┼─────────┼────────┼─────────────┼─────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────
    1   │   2  │            3            │        4       │        5       │       6      │       7     │    8    │    9   │      10     │      11     │      12    │     13     │      14    │     15     │     16     │     17     │     18
────────┴──────┴─────────────────────────┴────────────────┴────────────────┴──────────────┴─────────────┴─────────┴────────┴─────────────┴─────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────
.{
.[H skip
.fields
  DateToStr(BegDate,'Mon YYYY')
  DateToStr(EndDate,'Month YYYY')
.endfields
                                                                  Реестр разниц данных по амортизации по методам учета
                                                                         за период с ^ по ^
                                                                                                                                                                                                           лист @np@
────────┬──────┬─────────────────────────┬────────────────┬────────────────┬──────────────┬─────────────┬─────────┬────────┬─────────────┬─────────────┬────────────┬────────────┬────────────┬────────────┬────────────┬────────────┬────────────
    1   │   2  │            3            │        4       │        5       │       6      │       7     │    8    │    9   │      10     │      11     │      12    │     13     │      14    │     15     │     16     │     17     │     18
────────┴──────┴─────────────────────────┴────────────────┴────────────────┴──────────────┴─────────────┴─────────┴────────┴─────────────┴─────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────
.]H
.{ AmortSee_Header CheckEnter
.}
.{ AmortSee_Body CheckEnter
.{?Internal;(Leaf_cKatOS <> comp(0) AND not SearchMarker(MrkKatOS, Leaf_cKatOS, IndNo));
.begin
  InsertMarker(MrkKatOS, Leaf_cKatOS);
end.
.fields
  if ( longint(Leaf_DateK) > 0, DateToStr(Leaf_DateK,'DD/MM/YY'), '' )
  Leaf_InvNumber
  Leaf_Name
  DoubleToStr(if (Param_wStoimInReestr = 1,Leaf_STOIM_CUR_1, Leaf_Stoim_1), Формат_Сумм)
  DoubleToStr(if (Param_wStoimInReestr = 1,Leaf_STOIM_CUR_2, Leaf_Stoim_2), Формат_Сумм)
  DoubleToStr(Leaf_VVR_Stoim, Формат_Сумм)
  DoubleToStr(Leaf_NVR_Stoim, Формат_Сумм)
  DoubleToStr(Leaf_SrokIsp1 , Формат_Сумм)
  DoubleToStr(Leaf_SrokIsp2 , Формат_Сумм)
  DoubleToStr(Leaf_SumIzn_1 , Формат_Сумм)
  DoubleToStr(Leaf_SumIzn_2 , Формат_Сумм)
  DoubleToStr(Leaf_VVR_Inp  , Формат_Сумм)
  DoubleToStr(Leaf_NVR_Inp  , Формат_Сумм)
  DoubleToStr(Leaf_VVR_Period, Формат_Сумм)
  DoubleToStr(Leaf_NVR_Period, Формат_Сумм)
  DoubleToStr(Leaf_PR_Period , Формат_Сумм)
  DoubleToStr((Leaf_VVR_Inp + Leaf_VVR_Period), Формат_Сумм)
  DoubleToStr((Leaf_NVR_Inp + Leaf_NVR_Period), Формат_Сумм)
.endfields
@@@@@@@@│@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&&&&│&&&&&&&&&&&&&&&&│&&&&&&&&&&&&&&│&&&&&&&&&&&&&│&&&&&&&&&│&&&&&&&&│&&&&&&&&&&&&&│&&&&&&&&&&&&&│&&&&&&&&&&&&│&&&&&&&&&&&&│&&&&&&&&&&&&│&&&&&&&&&&&&│&&&&&&&&&&&&│&&&&&&&&&&&&│&&&&&&&&&&&&
.}
.}
.{ AmortSee_Footer CheckEnter
.}
.{ AmortSee_Line CheckEnter
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.}
.begin
  DoneMarker(MrkKatOS, '');
end.
.[F
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]F
.} Ш
#FeeSIgners_Os_LinkInit(AmortSee)
.fields
  Председатель_Должность
  Председатель_ФИО
.endfields

 Р Председатель комиссии: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи

.{While (Номер_подписанта < Количество_Членов_комиссии) OR (Номер_подписанта < 1)
.begin
  Номер_подписанта++;
end.
.fields
  if (Номер_подписанта = 1, 'Члены комиссии:', '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_Должность [Номер_подписанта], '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_ФИО   [Номер_подписанта], '')
.endfields
 @@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи
.}
 Р
.endform

//*******************************************************************
.linkform 'AmortSee04' prototype is 'AmortSee'
.nameinlist 'Реестр разниц данных по амортизации (сокращенный)'
.group 'Реестр разниц данных по амортизации'
.p 60
.defo landscape
.var
  MrkKatOS : longint;
  IndNo    : longint;
.endvar
#FeeSigners_Os_LinkVar
.fields
  CommonFormHeader
  if (boGetTune('Rep.IsHeader'), sGetTune('MyOrg'), '')

  DateToStr(BegDate,'Mon YYYY')
  DateToStr(EndDate,'Month YYYY')

  Фильтр

  fMetodName1
  fMetodName2
.endfields
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                          &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

                                                  БРеестр разниц данных по амортизации по методам учета Б
.{
.begin
  MrkKatOS := InitMarker('PrnReestr_ByRazn', 8, 100, 100, True);
  ClearMarker(MrkKatOS);
end.
                                                         Бза период с ^ по ^ Б
Фильтры:
.{ AmortSee_Filter CheckEnter
 ^
.}
БУ - бухгалтерский учет, метод - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
НУ - налоговый учет    , метод - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────┬─────────────┬─────────────────────────┬───────────────────────┬────────────────────┬────────────────┬────────────────┬─────────────────────────────────
        │             │                         │                       │                    │                │                │      Остаточная стоимость
  Дата  │ Инвентарный │      Наименование       │    Первоначальная     │ Постоянные разницы │   Вычитаемые   │Налогооблагаемые├────────────────┬────────────────
  ввода │    номер    │                         │    стоимость (БУ)     │                    │    временные   │   временные    │       БУ       │        НУ
        │             │                         │                       │                    │     разницы    │    разницы     │                │
        │             │                         │                       │                    │                │                │                │
        │             │                         │                       │                    │                │                │                │
────────┼─────────────┼─────────────────────────┼───────────────────────┼────────────────────┼────────────────┼────────────────┼────────────────┼────────────────
    1   │      2      │            3            │           4           │          5         │        6       │        7       │        8       │        9
────────┴─────────────┴─────────────────────────┴───────────────────────┴────────────────────┴────────────────┴────────────────┴────────────────┴────────────────
.{
.[H skip
.fields
  DateToStr(BegDate,'Mon YYYY')
  DateToStr(EndDate,'Month YYYY')
.endfields
                                                 Реестр разниц данных по амортизации по методам учета
                                                        за период с ^ по ^
                                                                                                                                                                                                      лист @np@
────────┬─────────────┬─────────────────────────┬───────────────────────┬────────────────────┬────────────────┬────────────────┬────────────────┬────────────────
    1   │      2      │            3            │           4           │          5         │        6       │        7       │        8       │        9
────────┴─────────────┴─────────────────────────┴───────────────────────┴────────────────────┴────────────────┴────────────────┴────────────────┴────────────────
.]H
.{ AmortSee_Header CheckEnter
.}
.{ AmortSee_Body CheckEnter
.{?Internal;(Leaf_cKatOS <> comp(0) AND not SearchMarker(MrkKatOS, Leaf_cKatOS, IndNo));
.begin
  InsertMarker(MrkKatOS, Leaf_cKatOS);
end.
.fields
  if ( longint(Leaf_DateK) > 0, DateToStr(Leaf_DateK,'DD/MM/YY'), '' )
  Leaf_InvNumber
  Leaf_Name
  DoubleToStr(if (Param_wStoimInReestr = 1,Leaf_STOIM_CUR_1, Leaf_Stoim_1), Формат_Сумм)
  DoubleToStr(Leaf_PR_Period , Формат_Сумм)
  DoubleToStr(Leaf_VVR_Period, Формат_Сумм)
  DoubleToStr(Leaf_NVR_Period, Формат_Сумм)

  DoubleToStr(Leaf_OstSTOIM_1, Формат_Сумм)
  DoubleToStr(Leaf_OstSTOIM_2, Формат_Сумм)
.endfields
@@@@@@@@│@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&&&&&&&&&&&│&&&&&&&&&&&&&&&&&&&&│&&&&&&&&&&&&&&&&│&&&&&&&&&&&&&&&&│&&&&&&&&&&&&&&&&│&&&&&&&&&&&&&&&&
.}
.}
.{ AmortSee_Footer CheckEnter
.}
.{ AmortSee_Line CheckEnter
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.}
.begin
  DoneMarker(MrkKatOS, '');
end.
.[F
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]F
.}
 Ш
 Р#FeeSIgners_Os_LinkInit(AmortSee)
.fields
  Председатель_Должность
  Председатель_ФИО
.endfields
 Председатель комиссии: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи

.{While (Номер_подписанта < Количество_Членов_комиссии) OR (Номер_подписанта < 1)
.begin
  Номер_подписанта++;
end.
.fields
  if (Номер_подписанта = 1, 'Члены комиссии:', '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_Должность [Номер_подписанта], '')
  if (Номер_подписанта <= Количество_Членов_комиссии, Массив_Член_комиссии_ФИО   [Номер_подписанта], '')
.endfields
 @@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ __________________________ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                           должность                          подпись                   расшифровка подписи
.}
 Р
.endform
