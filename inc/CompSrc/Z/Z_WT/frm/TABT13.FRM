/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,2000 корпорация ГАЛАКТИКА                    ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Заработная плата                                          ║
 ║ Версия        : 5.70                                                      ║
 ║ Назначение    : Табель учета использования рабочего времени               ║
 ║                 (Типовая форма N Т-13)                                    ║
 ║ Ответственный : Маслакова Татьяна Владимировна                            ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#doc
Табель учета использования рабочего времени
(Типовая форма N Т-13)
#end
.form TabT13
.p 80
.hide
.fields
  Pred
  Podr
  PeriodBeginning PeriodEnding

  Day_1 Day_2 Day_3 Day_4 Day_5 Day_6 Day_7 Day_8 Day_9 Day_10 Day_11 Day_12 Day_13 Day_14 Day_15
  Day_16 Day_17 Day_18 Day_19 Day_20 Day_21 Day_22 Day_23 Day_24 Day_25 Day_26 Day_27 Day_28 Day_29 Day_30 Day_31

  AnalitikName

  LayerCount
  D1  D2  D3  D4  D5  D6  D7  D8  D9  D10 D11 D12 D13 D14 D15
  перв_пол_дни
  VidOpl1 Коррсчет1 Day1 Chas1 VidOpl2 Коррсчет2 Day2 Chas2 KodNejavki1 DayNejavok1 ChasNejavok1 KodNejavki2 DayNejavok2 ChasNejavok2
  Npp LSTABNREC PEREXODNREC FIO месяц_дни lschnum TabN WageCategory
  Ch1 Ch2 Ch3 Ch4
  Ch5 Ch6 Ch7 Ch8
  Ch9 Ch10 Ch11 Ch12
  Ch13 Ch14 Ch15
  перв_пол_часы
  VidOpl3 Коррсчет3 Day3 Chas3 VidOpl4 Коррсчет4 Day4 Chas4 KodNejavki3 DayNejavok3 ChasNejavok3 KodNejavki4 DayNejavok4 ChasNejavok4
  Dolg
  D16  D17  D18  D19  D20  D21  D22  D23  D24  D25  D26  D27  D28  D29  D30  D31
  втор_пол_дни
  VidOpl5 Коррсчет5 Day5 Chas5 VidOpl6 Коррсчет6 Day6 Chas6 KodNejavki5 DayNejavok5 ChasNejavok5 KodNejavki6 DayNejavok6 ChasNejavok6
  месяц_часы
  Ch16 Ch17 Ch18 Ch19
  Ch20 Ch21 Ch22 Ch23
  Ch24 Ch25 Ch26 Ch27
  Ch28 Ch29 Ch30 Ch31
  втор_пол_часы
  VidOpl7 Коррсчет7 Day7 Chas7 VidOpl8 Коррсчет8 Day8 Chas8 KodNejavki7 DayNejavok7 ChasNejavok7 KodNejavki8 DayNejavok8 ChasNejavok8

  // дни/часы второго слоя:
  L2D1 L2D2 L2D3 L2D4 L2D5 L2D6 L2D7 L2D8 L2D9 L2D10 L2D11 L2D12 L2D13 L2D14 L2D15
  L2перв_пол_дни L2месяц_дни
  L2Ch1 L2Ch2 L2Ch3 L2Ch4 L2Ch5 L2Ch6 L2Ch7 L2Ch8 L2Ch9 L2Ch10 L2Ch11 L2Ch12 L2Ch13 L2Ch14 L2Ch15
  L2перв_пол_часы
  L2D16 L2D17 L2D18 L2D19 L2D20 L2D21 L2D22 L2D23 L2D24 L2D25 L2D26 L2D27 L2D28 L2D29 L2D30 L2D31
  L2втор_пол_дни L2месяц_часы
  L2Ch16 L2Ch17 L2Ch18 L2Ch19 L2Ch20 L2Ch21 L2Ch22 L2Ch23 L2Ch24 L2Ch25 L2Ch26 L2Ch27 L2Ch28 L2Ch29 L2Ch30 L2Ch31
  L2втор_пол_часы
.endfields
.if Show_Analitik
.else
.end
.{ checkenter
 ^
 ^
 ^^
 ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.{
 ^
.{
 ^
 ^^^^^^^^^^^^^^^  ^ ^^^^^^^^ ^^^^^^
 ^^ ^^ ^^^^^^^^^^^^^^^^^  ^ ^^^^^^^^ ^^^^^^
 ^ ^
 ^^^^^^^^^^^^^^^^ ^ ^^^^^^^^ ^^^^^^
 ^ ^
 ^^^^^^^^^^^^^^^^ ^ ^^^^^^^^ ^^^^^^
 ^^^^^^^^^^^^^^^ ^^
 ^^^^^^^^^^^^^^^ ^
 ^^^^^^^^^^^^^^^^ ^^
 ^^^^^^^^^^^^^^^^ ^
.}
.}
.{ checkenter FirstPage
.}
.}
.endform
!
!
!
.linkform 'TabT13_01' prototype is 'TabT13'
.nameinlist 'Унифицированная форма №Т-13'
.group 'Т-13'
.p 56
.var
  FirstLine: boolean;
  AnFirstLine: boolean;
  LineCount: integer; // Актуальное количество фактически напечатанных строк
  FutureLineCount: integer; // переменная для прогноза кол-ва строк, чтобы не гадить прямо в LineCount, как тут раньше было
  LinesPerPage: integer;
  lShow_Analitik: boolean;
.endvar
.fields
! CommonFormHeader
  Pred
  Podr
  PeriodBeginning PeriodEnding

  Day_1 Day_2 Day_3 Day_4 Day_5 Day_6 Day_7 Day_8 Day_9 Day_10 Day_11 Day_12 Day_13 Day_14 Day_15
  Day_16 Day_17 Day_18 Day_19 Day_20 Day_21 Day_22 Day_23 Day_24 Day_25 Day_26 Day_27 Day_28 Day_29 Day_30 Day_31

  AnalitikName

  // ----- Табличка пошла:
  // УО 1/2
  D1  D2  D3  D4  D5  D6  D7  D8  D9  D10 D11 D12 D13 D14 D15
  перв_пол_дни
  VidOpl1 Коррсчет1 Day1 Time2StrDef(Double(Chas1)) VidOpl2 Коррсчет2 Day2 Time2StrDef(Double(Chas2)) KodNejavki1 DayNejavok1 KodNejavki2 DayNejavok2
  Npp
  LogicSubStr(GetSurnameWithInitials(FIO), 22, false, false)
  TabN
  месяц_дни

  // Часы 1/2
  Time2StrDef(Double(Ch1)) Time2StrDef(Double(Ch2)) Time2StrDef(Double(Ch3)) Time2StrDef(Double(Ch4))
  Time2StrDef(Double(Ch5)) Time2StrDef(Double(Ch6)) Time2StrDef(Double(Ch7)) Time2StrDef(Double(Ch8))
  Time2StrDef(Double(Ch9)) Time2StrDef(Double(Ch10)) Time2StrDef(Double(Ch11)) Time2StrDef(Double(Ch12))
  Time2StrDef(Double(Ch13)) Time2StrDef(Double(Ch14)) Time2StrDef(Double(Ch15))

  Time2StrDef(Double(перв_пол_часы))

  VidOpl3 Коррсчет3 Day3 Time2StrDef(Double(Chas3)) VidOpl4 Коррсчет4 Day4 Time2StrDef(Double(Chas4)) KodNejavki3 DayNejavok3 KodNejavki4 DayNejavok4
  LogicSubStr(Dolg, 22, true, true)
  LogicSubStr(Dolg, 22, true, true)

  // УО 2/2
  D16  D17  D18  D19  D20  D21  D22  D23  D24  D25  D26  D27  D28  D29  D30  D31
  втор_пол_дни
  VidOpl5 Коррсчет5 Day5 Time2StrDef(Double(Chas5)) VidOpl6 Коррсчет6 Day6 Time2StrDef(Double(Chas6)) KodNejavki5 DayNejavok5 KodNejavki6 DayNejavok6
  LogicSubStr(Dolg, 22, true, true)

  Time2StrDef(Double(месяц_часы))
  // Часы 2/2
  Time2StrDef(Double(Ch16)) Time2StrDef(Double(Ch17)) Time2StrDef(Double(Ch18)) Time2StrDef(Double(Ch19))
  Time2StrDef(Double(Ch20)) Time2StrDef(Double(Ch21)) Time2StrDef(Double(Ch22)) Time2StrDef(Double(Ch23))
  Time2StrDef(Double(Ch24)) Time2StrDef(Double(Ch25)) Time2StrDef(Double(Ch26)) Time2StrDef(Double(Ch27))
  Time2StrDef(Double(Ch28)) Time2StrDef(Double(Ch29)) Time2StrDef(Double(Ch30)) Time2StrDef(Double(Ch31))

  Time2StrDef(Double(втор_пол_часы))

  vidOpl7 Коррсчет7 Day7 Time2StrDef(Double(Chas7)) VidOpl8 Коррсчет8 Day8 Time2StrDef(Double(Chas8)) KodNejavki7 DayNejavok7 KodNejavki8 DayNejavok8
  //-----
  // Табличка - всё. Теперь для двухслойного варианта отображения табличка пошла:
  // Сначала данные второго слоя, потом - первого.
  // УО 1/2
  L2D1 L2D2 L2D3 L2D4 L2D5 L2D6 L2D7 L2D8 L2D9 L2D10 L2D11 L2D12 L2D13 L2D14 L2D15
  L2перв_пол_дни
  VidOpl1 Коррсчет1 Day1 Time2StrDef(Double(Chas1)) VidOpl2 Коррсчет2 Day2 Time2StrDef(Double(Chas2)) KodNejavki1 DayNejavok1 KodNejavki2 DayNejavok2
  Npp
  LogicSubStr(GetSurnameWithInitials(FIO), 22, false, false)
  TabN

  // Часы 1/2
  Time2StrDef(Double(L2Ch1)) Time2StrDef(Double(L2Ch2)) Time2StrDef(Double(L2Ch3)) Time2StrDef(Double(L2Ch4))
  Time2StrDef(Double(L2Ch5)) Time2StrDef(Double(L2Ch6)) Time2StrDef(Double(L2Ch7)) Time2StrDef(Double(L2Ch8))
  Time2StrDef(Double(L2Ch9)) Time2StrDef(Double(L2Ch10)) Time2StrDef(Double(L2Ch11)) Time2StrDef(Double(L2Ch12))
  Time2StrDef(Double(L2Ch13)) Time2StrDef(Double(L2Ch14)) Time2StrDef(Double(L2Ch15))

  Time2StrDef(Double(L2перв_пол_часы))

  VidOpl3 Коррсчет3 Day3 Time2StrDef(Double(Chas3)) VidOpl4 Коррсчет4 Day4 Time2StrDef(Double(Chas4)) KodNejavki3 DayNejavok3 KodNejavki4 DayNejavok4
  LogicSubStr(Dolg, 22, true, true)
  LogicSubStr(Dolg, 22, true, true)

  // УО 2/2
  L2D16 L2D17 L2D18 L2D19 L2D20 L2D21 L2D22 L2D23 L2D24 L2D25 L2D26 L2D27 L2D28 L2D29 L2D30 L2D31
  L2втор_пол_дни
  VidOpl5 Коррсчет5 Day5 Time2StrDef(Double(Chas5)) VidOpl6 Коррсчет6 Day6 Time2StrDef(Double(Chas6)) KodNejavki5 DayNejavok5 KodNejavki6 DayNejavok6
  LogicSubStr(Dolg, 22, true, true)
  месяц_дни

  // Часы 2/2
  Time2StrDef(Double(L2Ch16)) Time2StrDef(Double(L2Ch17)) Time2StrDef(Double(L2Ch18)) Time2StrDef(Double(L2Ch19))
  Time2StrDef(Double(L2Ch20)) Time2StrDef(Double(L2Ch21)) Time2StrDef(Double(L2Ch22)) Time2StrDef(Double(L2Ch23))
  Time2StrDef(Double(L2Ch24)) Time2StrDef(Double(L2Ch25)) Time2StrDef(Double(L2Ch26)) Time2StrDef(Double(L2Ch27))
  Time2StrDef(Double(L2Ch28)) Time2StrDef(Double(L2Ch29)) Time2StrDef(Double(L2Ch30)) Time2StrDef(Double(L2Ch31))

  Time2StrDef(Double(L2втор_пол_часы))

  vidOpl7 Коррсчет7 Day7 Time2StrDef(Double(Chas7)) VidOpl8 Коррсчет8 Day8 Time2StrDef(Double(Chas8)) KodNejavki7 DayNejavok7 KodNejavki8 DayNejavok8

  // Данные первого слоя. На этот раз будет почище, потому что не нужно вставлять разноску и прочую ерунду
  // УО 1/2
  D1  D2  D3  D4  D5  D6  D7  D8  D9  D10  D11  D12  D13  D14  D15
  перв_пол_дни
  Time2StrDef(Double(месяц_часы))

  // Часы 1/2
  Time2StrDef(Double(Ch1)) Time2StrDef(Double(Ch2)) Time2StrDef(Double(Ch3)) Time2StrDef(Double(Ch4))
  Time2StrDef(Double(Ch5)) Time2StrDef(Double(Ch6)) Time2StrDef(Double(Ch7)) Time2StrDef(Double(Ch8))
  Time2StrDef(Double(Ch9)) Time2StrDef(Double(Ch10)) Time2StrDef(Double(Ch11)) Time2StrDef(Double(Ch12))
  Time2StrDef(Double(Ch13)) Time2StrDef(Double(Ch14)) Time2StrDef(Double(Ch15))

  Time2StrDef(Double(перв_пол_часы))

  // УО 2/2
  D16  D17  D18  D19  D20  D21  D22  D23  D24  D25  D26  D27  D28  D29  D30  D31
  втор_пол_дни

  // Часы 2/2
  Time2StrDef(Double(Ch16)) Time2StrDef(Double(Ch17)) Time2StrDef(Double(Ch18)) Time2StrDef(Double(Ch19))
  Time2StrDef(Double(Ch20)) Time2StrDef(Double(Ch21)) Time2StrDef(Double(Ch22)) Time2StrDef(Double(Ch23))
  Time2StrDef(Double(Ch24)) Time2StrDef(Double(Ch25)) Time2StrDef(Double(Ch26)) Time2StrDef(Double(Ch27))
  Time2StrDef(Double(Ch28)) Time2StrDef(Double(Ch29)) Time2StrDef(Double(Ch30)) Time2StrDef(Double(Ch31))

  Time2StrDef(Double(втор_пол_часы))
.endfields
.if Show_Analitik
.begin
  lShow_Analitik := true;
end.
.else
.begin
  lShow_Analitik := false;
end.
.end
.{ checkenter
 Ш                                                                                                                                                                                                     Унифицированная форма № Т-13
                                                                                                                                                                                                     Утверждена постановлением Госкомстата
                                                                                                                                                                                                     России от 05.01.2004 № 1

                                                                                                                                                                                                                                  ┌───────┐
                                                                                                                                                                                                                                  │  Код  │
                                                                                                                                                                                                                                  ├───────┤
                                                                                                                                                                                                                    Форма по ОКУД │0301008│
                                                                                                                                                                                                                                  ├───────┤
  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е        по ОКПО │       │
                                                                                              наименование организации                                                                                                            ├───────┤
                                                                                                                                                                                                                                  │       │
  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                └───────┘
                                                                                      наименование структурного подразделения

                                                                                                                                                                                            ┌─────────┬───────────┐ ┌─────────────────────┐
                                                                                                                                                                                            │  Номер  │   Дата    │ │   Отчетный период   │
                                                                                                                                                                                            │документа│составления│ ├──────────┬──────────┤
                                                                                                                                                                                            │         │           │ │    с     │    по    │
                                                                                                                                                                                            ├─────────┼───────────┤ ├──────────┼──────────┤
                                                                                                                                                                                            │         │           │ │@@@@@@@@@@│@@@@@@@@@@│
                                                                                                       ТАБЕЛЬ                                                                               └─────────┴───────────┘ └──────────┴──────────┘
                                                                                                УЧЕТА РАБОЧЕГО ВРЕМЕНИ
╔═════╦══════════════════════╦══════════╦═══════════════════════════════════════════════════════════════════════════════════════════════╦═════════════╦═════════════════════════════════════════════════════════╦═════════════════════════╗
║Номер║Фамилия, инициалы,    ║ Табельный║                   Отметки о явках и неявках на работу по числам месяца                        ║Отработано за║        Данные для начисления заработной платы           ║   Неявки по причинам    ║
║по   ║должность             ║    номер ║                                                                                               ║             ║            по видам и направлениям затрат               ║                         ║
║по-  ║(специальность,       ║          ╟─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────╫──────┬──────╫─────────────────────────────────────────────────────────╫─────┬──────┬─────┬──────╢
║рядку║профессия)            ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║поло- │месяц ║                   код вида оплаты                       ║код  │дни   │код  │дни   ║
║     ║                      ║          ║  && │  && │  && │  && │  && │  && │  && │  && │  && │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ Х   ║вину  │      ╟────────────────────────────┬────────────────────────────╢     │(часы)│     │(часы)║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║месяца│      ╟────────────────────────────┴────────────────────────────╢     │      │     │      ║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║(I,II)│      ║                 корреспондирующий счет                  ║     │      │     │      ║
║     ║                      ║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┴──────╫────────────────────────────┬────────────────────────────╢     │      │     │      ║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║     дни     ╟──────┬─────────┬───────────┼──────┬─────────┬───────────╢     │      │     │      ║
║     ║                      ║          ║ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  ╟─────────────║код   │коррес-  │дни        │код   │коррес-  │дни        ║     │      │     │      ║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║    часы     ║вида  │пондирую-│(часы)     │вида  │пондирую-│(часы)     ║     │      │     │      ║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║             ║оплаты│щий счет │           │оплаты│щий счет │           ║     │      │     │      ║
╟─────╫──────────────────────╫──────────╫─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────╫──────┬──────╫──────┼─────────┼───────────┼──────┼─────────┼───────────╫─────┼──────┼─────┼──────╢
║  1  ║             2        ║     3    ║                                            4                                                  ║   5  │   6  ║  7   │     8   │     9     │  7   │    8    │    9      ║  10 │   11 │  10 │  11  ║
 Ш.{?internal; lShow_Analitik;
 Ш╠═════╩══════════════════════╩══════════╩═══════════════════════════════════════════════════════════════════════════════════════════════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╣ Ш
.}
.{?internal; not lShow_Analitik;
 Ш╠═════╬══════════════════════╬══════════╬═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╬══════╪══════╬══════╪═════════╪═══════════╪══════╪═════════╪═══════════╬═════╪══════╪═════╪══════╣
 Ш.}
 Ш.begin
  FirstLine := true;
  LineCount := 39;
  LinesPerPage := 56;
end.
.{
 Ш.{?internal; lShow_Analitik;
.begin
  // Должны уместиться имя аналитики и хотя бы один табельный человек
  FutureLineCount := LineCount + (if (LayerCount = 2, 15, 7) + if (FirstLine, 2, 3));
end.
.{?internal;(FutureLineCount > LinesPerPage - 1);
! Если не вмещаемся, по-разному печатать нижнюю границу надобно
.{?internal; FirstLine; // сразу же не вместились: ну бывает так.
 Ш╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝ Ш
.}
.{?internal; not FirstLine;
 Ш╚═════╩══════════════════════╩══════════╩═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╝ Ш
.}
.begin
  LineCount++; // это за счёт только что напечатанной нижней границы
end.
.{ while (LineCount < LinesPerPage)
!забиваем пустыми строками до конца страницы

.begin
  LineCount++;
end.
.}
 Ш╔═════╦══════════════════════╦══════════╦═══════════════════════════════════════════════════════════════════════════════════════════════╦══════╤══════╦══════╤═════════╤═══════════╤══════╤═════════╤═══════════╦═════╤══════╤═════╤══════╗
║  1  ║             2        ║     3    ║                                            4                                                  ║   5  │   6  ║  7   │     8   │     9     │  7   │    8    │    9      ║  10 │   11 │  10 │  11  ║
╠═════╩══════════════════════╩══════════╩═══════════════════════════════════════════════════════════════════════════════════════════════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╣
 Ш.begin
  FirstLine := true;
  LineCount := 3; // ну шапочку то уже по любому напечатали
end.
.}
.{?internal; not FirstLine;
 Ш╠═════╩══════════════════════╩══════════╩═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╣
 Ш.}
 Ш║ Аналитика: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ║ Ш
 Ш╠═════╦══════════════════════╦══════════╦═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╦══════╤══════╦══════╤═════════╤═══════════╤══════╤═════════╤═══════════╦═════╤══════╤═════╤══════╣ Ш
.begin
  AnFirstLine := True;
  LineCount += if (FirstLine, 2, 3);
end.
.} Ш  //?internal lShow_Analitik
.{ // обычный этот самый, в т.ч. без аналитики
.begin
  // Сколько будет строк, когда напечатаем всё по данному человеку.
  FutureLineCount := LineCount + if (LayerCount = 2, 15, 7)
                     + if ((not FirstLine) and (not AnFirstLine), 1, 0);
end.
.{?internal;(FutureLineCount > LinesPerPage - 1);
╚═════╩══════════════════════╩══════════╩═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╝
.begin
  LineCount++; // +1 за счёт только что напечатанной.
end.
.{ while (LineCount < LinesPerPage)
!забиваем пустыми строками до конца страницы

.begin
  LineCount++;
end.
.}
╔═════╦══════════════════════╦══════════╦═══════════════════════════════════════════════════════════════════════════════════════════════╦══════╤══════╦══════╤═════════╤═══════════╤══════╤═════════╤═══════════╦═════╤══════╤═════╤══════╗
║  1  ║             2        ║     3    ║                                            4                                                  ║   5  │   6  ║  7   │     8   │     9     │  7   │    8    │    9      ║  10 │   11 │  10 │  11  ║
╠═════╬══════════════════════╬══════════╬═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╬══════╪══════╬══════╪═════════╪═══════════╪══════╪═════════╪═══════════╬═════╪══════╪═════╪══════╣
.begin
  FirstLine := true;
  LineCount := 3;
end.
.}
.{?internal;(not FirstLine)  Шand (not AnFirstLine) Ш; // что здесь "Ш" делает?!
╠═════╬══════════════════════╬══════════╬═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╬══════╪══════╬══════╪═════════╪═══════════╪══════╪═════════╪═══════════╬═════╪══════╪═════╪══════╣
.begin
  LineCount++; // счётчик, очивидно, Пушкин наращивает
end.
.}
.{?internal; (LayerCount <> 2);
║     ║                      ║          ║@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│  Х  ║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&& &&&&&&&│@@@@@@│@@@@@@@@@│&&& &&&&&&&║@~@@@│ &&&& │@~@@@│ &&&& ║
║&&&&&║@@@@@@@@@@@@@@@@@@@@@@║&&&&&&&&&&╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┤&&&&&&╟──────┼─────────┤           ├──────┼─────────┤           ║─────┼──────┼─────┼──────╢
║     ║                      ║          ║&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│  Х  ║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&& &&&&&&&│@@@@@@│@@@@@@@@@│&&& &&&&&&&║@~@@@│ &&&& │@~@@@│ &&&& ║
║     ║@@@@@@@@@@@@@@@@@@@@@@║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┼──────╟──────┼─────────┼───────────┼──────┼─────────┼───────────╢─────┼──────┼─────┼──────╢
║     ║@@@@@@@@@@@@@@@@@@@@@@║          ║@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&& &&&&&&&│@@@@@@│@@@@@@@@@│&&& &&&&&&&║@~@@@│ &&&& │@~@@@│ &&&& ║
║     ║@@@@@@@@@@@@@@@@@@@@@@║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┤&&&&&&╟──────┼─────────┤           ├──────┼─────────┤           ║─────┼──────┼─────┼──────╢
║     ║                      ║          ║&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&& &&&&&&&│@@@@@@│@@@@@@@@@│&&& &&&&&&&║@~@@@│ &&&& │@~@@@│ &&&& ║
.begin
  LineCount += 7; // Это - высота. Её невозбранно искать по исходнику.
end.
.}
.{?internal; (LayerCount = 2);
║     ║                      ║          ║@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│  Х  ║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&& &&&&&&&│@@@@@@│@@@@@@@@@│&&& &&&&&&&║@~@@@│ &&&& │@~@@@│ &&&& ║
║&&&&&║@@@@@@@@@@@@@@@@@@@@@@║&&&&&&&&&&╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┤      ╟──────┼─────────┤           ├──────┼─────────┤           ║─────┼──────┼─────┼──────╢
║     ║                      ║          ║&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│  Х  ║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&& &&&&&&&│@@@@@@│@@@@@@@@@│&&& &&&&&&&║@~@@@│ &&&& │@~@@@│ &&&& ║
║     ║@@@@@@@@@@@@@@@@@@@@@@║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┼──────╟──────┼─────────┼───────────┼──────┼─────────┼───────────╢─────┼──────┼─────┼──────╢
║     ║@@@@@@@@@@@@@@@@@@@@@@║          ║@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&& &&&&&&&│@@@@@@│@@@@@@@@@│&&& &&&&&&&║@~@@@│ &&&& │@~@@@│ &&&& ║
║     ║@@@@@@@@@@@@@@@@@@@@@@║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┤&&&&&&╟──────┼─────────┤           ├──────┼─────────┤           ║─────┼──────┼─────┼──────╢
║     ║                      ║          ║&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&& &&&&&&&│@@@@@@│@@@@@@@@@│&&& &&&&&&&║@~@@@│ &&&& │@~@@@│ &&&& ║
║     ║                      ║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┼──────╟──────┼─────────┼───────────┼──────┼─────────┼───────────╢─────┼──────┼─────┼──────╢
║     ║                      ║          ║@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│  Х  ║&&&&&&│      ║      │         │           │      │         │           ║     │      │     │      ║
║     ║                      ║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┤&&&&&&╟──────┼─────────┤           ├──────┼─────────┤           ║─────┼──────┼─────┼──────╢
║     ║                      ║          ║&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│  Х  ║&&&&&&│      ║      │         │           │      │         │           ║     │      │     │      ║
║     ║                      ║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┼──────╟──────┼─────────┼───────────┼──────┼─────────┼───────────╢─────┼──────┼─────┼──────╢
║     ║                      ║          ║@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@║&&&&&&│      ║      │         │           │      │         │           ║     │      │     │      ║
║     ║                      ║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┤      ╟──────┼─────────┤           ├──────┼─────────┤           ║─────┼──────┼─────┼──────╢
║     ║                      ║          ║&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&║&&&&&&│      ║      │         │           │      │         │           ║     │      │     │      ║
.begin
  LineCount += 15; // Это - высота. Её невозбранно искать по исходнику.
end.
.}
.begin
  FirstLine := false;
   ШAnFirstLine := false; Ш // что здесь "Ш" делает?!
end.
.}
.}
╚═════╩══════════════════════╩══════════╩═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╝

Ответственное                                         Руководитель
лицо ___________ _________ _____________________      структурного подразделения ___________ _________ _____________________  "__" __________ 20__ года
      должность   подпись   расшифровка подписи                                   должность   подпись   расшифровка подписи
                                                      Работник
                                                      кадровой службы            ___________ _________ _____________________  "__" __________ 20__ года
                                                                                  должность   подпись   расшифровка подписи Ш
.begin
  LineCount := if((LineCount + 8) > LinesPerPage, LineCount + 8 - LinesPerPage, LineCount + 8);
  // Автор хотел сказать, что в случае разрыва страницы во время печатания этой хрени
  // LineCount станет содержать вменяемое кол-во строк, вылезших на следующую страницу.
  // (Блин, для кого придумали операцию остатка от деления? 7/| Мы погроммисты или кто?)
end.
.{ while (LineCount < LinesPerPage)
!забиваем пустыми строками до конца страницы

.begin
  LineCount++;
end.
.}
.{ checkenter FirstPage
.}
.}
 а
.endform
