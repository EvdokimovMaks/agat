//------------------------------------------------------------------------------
//                                                      (с) корпорация Галактика
// Галактика 7.12 - Заработная плата
// Описание obj-интерфейса расчета среднесписочной численности
//------------------------------------------------------------------------------

#ifndef _IAPNCALCULATOR_OBJ_INCLUDED_
#define _IAPNCALCULATOR_OBJ_INCLUDED_

#ifdef ComponentVersion
  #component "Z_WT"
#end

#doc
  Объектный интерфейс калькулятора среднесписочной численности
#end
objinterface IAveragePayrollNumberCalculator;
  #doc
    Возвращает среднюю продолжительность рабочего дня OnDay.
  #end
  function GetWorkingDayAverageTime(OnDay: byte): double;

  #doc
    Возвращает среднесписочную для лицевого счета с nrec = PersonalAccountRef
    за период с PeriodBeginning по PeriodEnding.
  #end
  function GetNumber(PersonalAccountRef: comp; PeriodBeginning, PeriodEnding: date): double;
end;

#doc
  Расширение № 1 объектного интерфейса IAveragePayrollNumberCalculator
#end
objinterface IAveragePayrollNumberCalculator1;
  #doc
    Инициализация печати протокола расчета среднесписочной численности
  #end
  property SetProtocol : boolean write;

  #doc
    Вычисление средней продолжительности рабочего дня.
  #end
  function GetAvgHoursPerDay : double;

  #doc
    Расчет среднесписочной численности за несколько месяцев
  #end
  function CalcSRCHbyAccount( Account: comp; dBegin, dEnd : date ) : double;

  #doc
    Расчет среднесписочной численности по периодам табеля
  #end
  function fGetSRCHTable( cLsch : comp; bMonth : byte; wYear : word ) : double;

  #doc
    Расчет дней/часов по неявкам.
  #end
  procedure ProcessMonthlyAbsence(AbsenceIndex: integer; ByHours: boolean;
                                var AbsenceDays: word; var AbsenceHours: double);
end;

#end
