//------------------------------------------------------------------------------
//                                                      (с) корпорация Галактика
// Галактика 7.12 - Заработная плата
// объектные интерфейсы для поддержки перечня табелей
//------------------------------------------------------------------------------

#ifndef _WTLFUNCS_VIH_INCLUDED_
#define _WTLFUNCS_VIH_INCLUDED_

#include Marks.vih

#ifdef ComponentVersion
  #component "z_wt"
#end

#doc
  Объектный интерфейс построителя списка табелей учета рабочего времени.
#end
objinterface IWorkingTableListFunctions;

  #doc
    <brief>Устанавливает, учитывать ли иерархию подразделений</brief>
    Устанавливает признак того, будет ли список строиться с учетом иерархии
    подразделений (Value = true) или без (Value = false). Только для одиночного
    фильтра по подразделению. <br />
    <font color="red">Одиночный фильтр по подразделению не используется начиная с 9.1</font>
  #end
  procedure SetDepartmentHierarchy(Value: boolean);

  #doc
    Подавляет (Value = true) визуализацию. Если Value = false, во время
    построения списка на экран выдаётся стандартная визуализация.
  #end
  procedure SetSilent(Value: boolean);

  #doc
    Устанавливает (Value = true) или сбрасывает (Value = false) признак
    объединения частей табеля, относящихся ко времени нахождения работника в
    одном и том же подразделении.
  #end
  procedure SetTableJunction(Value: boolean);

  #doc
    <brief>Выполняет выгрузку списка табелей.</brief>

    <p>Выборка табелей с одиночным фильтром по подразделению.</p>
    <p>Выгружаются табели лицевого счета APersonalAccount, соответствующие времени
    работы в подразделении ADepartment, за месяц, описанный датой
    AMonthBeginning. Нулевые значения параметров означают "любой".  Возвращает
    true в случае успешного завершения, false - в противном случае.  По мере
    обхода списка табелей вызывается event-метод <link function Z_WT::IWorkingTableListFunctions.CollectTable>CollectTable</link>.</p>
    <br /> <font color="red">Одиночный фильтр по подразделению не используется начиная с 9.1</font>
  #end
  function RefreshTableList(APersonalAccount: comp; ADepartment: comp; AMonthBeginning: date): boolean;

  #doc
    Возвращает true, если включено раздельное ведение табелей. Иначе возвращает
    false.
  #end
  function SeparateTableKeeping: boolean;

  #doc
    Событие генерируется для каждого табеля в списке, получаемом в процессе
    выполнения метода
    <link function Z_WT::IWorkingTableListFunctions.RefreshTableList>RefreshTableList</link>.</brief>

    <p>В WorkingTable передаётся содержимое буфера табеля, в Subject - nrec
    подразделения (при включенном объединении табелей по подразделению), nrec
    перехода в межпериод (в противном случае) или 0, если передаются данные о
    части табеля, приходящейся на период работы на основном месте. В
    PeriodBeginning передаётся дата начала месяца или дата начала перехода,
    период которого описывается табелем.</p>

    <p>Результат, возвращаемый подписчиком на событие, не анализируется.</p>
  #end
  event function CollectTable(var WorkingTable: type$LSTAB; Subject: comp; PeriodBeginning: date): integer;
end;

//------------------------------------------------------------------------------
#doc
  Объектный интерфейс с расширенной версией метода выгрузки списка табелей
  учета рабочего времени.
#end
objinterface IWorkingTableListFunctions1;

  #doc
    <brief>Расширенная версия метода выгрузки списка табелей
    <link function Z_WT::IWorkingTableListFunctions.RefreshTableList>Z_WT::IWorkingTableListFunctions.RefreshTableList</link>.</brief>

    <p>Выборка табелей с одиночным фильтром по подразделению.</p>
    <p> Расширенная версия метода выгрузки списка табелей
    <link function Z_WT::IWorkingTableListFunctions.RefreshTableList>Z_WT::IWorkingTableListFunctions.RefreshTableList</link>.
    Отличается от оригинальной версии наличием в параметрах ссылки на валидатор
    лицевого счета, позволяющего выгружать табели только тех работников, чьи
    лицевые счета проходят реализуемые валидатором PersonalAccountValidator
    проверки.</p>
    <font color="red">Одиночный фильтр по подразделению не используется начиная с 9.1</font>
  #end
  function RefreshTableListExt(
    APersonalAccount: comp;
    ADepartment: comp;
    AMonthBeginning: date;
    PersonalAccountValidator: IPersonalAccountValidator): boolean;
end;

//------------------------------------------------------------------------------
#doc
  Объектный интерфейс с возможностью выгрузки табелей по нескольким подразделениям.
#end
objinterface IWorkingTableListFunctions2;
  #doc
    <brief>Выполняет выгрузку списка табелей.</brief>

    <p>Выборка табелей с множественным фильтром по подразделению.</p>
    <p>Выгружаются табели лицевого счета APersonalAccount, соответствующие времени
    работы в подразделениях из маркера AMarkedDepartments, за месяц, описанный датой
    AMonthBeginning, и только для тех работников, которые проходят чрез валидатор PersonalAccountValidator.
    Нулевые значения параметров означают "любой".  Возвращает
    true в случае успешного завершения, false - в противном случае.  По мере
    обхода списка табелей вызывается event-метод <link function Z_WT::IWorkingTableListFunctions.CollectTable>CollectTable</link>.</p>
  #end
  function RefreshTableListMultipleDepFilter(
    APersonalAccount: comp;
    AMarkedDepartments: longint;
    AMonthBeginning: date;
    PersonalAccountValidator: IPersonalAccountValidator
  ): boolean;
end;

vipinterface WorkingTableListFunctions
  implements
    IWorkingTableListFunctions,
    IWorkingTableListFunctions1,
    IWorkingTableListFunctions2
#ifdef ATL51
Licensed(Free)
#end
;
#end