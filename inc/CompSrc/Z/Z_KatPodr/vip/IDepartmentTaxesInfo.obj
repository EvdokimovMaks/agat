//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика ERP 8.1 - Заработная плата
// Налоговые атрибуты подразделений
//------------------------------------------------------------------------------

#ifndef _IDEPARTMENTTAXESINFO_OBJ_INCLUDED_
#define _IDEPARTMENTTAXESINFO_OBJ_INCLUDED_

#component "Z_KatPodr"

//------------------------------------------------------------------------------
#doc
Переключатель кэширования
#end
ObjInterface ISwitchCached;

  #doc
  Включение/выключение кэширования
  #end
  procedure SetCached(Value: boolean);

  #doc
  Текущее состояние кэширования
  #end
  function IsCached: boolean;
end;
//------------------------------------------------------------------------------
#doc
Данные по атрибуту ОКАТО
#end
ObjInterface IInfoTaxOKATO;

  #doc
  Кодовое слово для источника информации о полученном ОКАТО
  #end
  function GetInfo(RefDep: comp; Ext: word): string;
end;
//------------------------------------------------------------------------------
#doc
Налоговые атрибуты подразделения
#end
ObjInterface IDepartmentTaxesInfo;

  #doc
  Удаление всех ранее выгруженных налоговых атрибутов
  #end
  procedure Clear;

  #doc
  Подразделение, с которым связан филиал
  #end
  function GetFilialDep(RefOrg: comp): comp;

  #doc
  Организация, с которой у подразделения есть прямая связь
  #end
  function GetBindFilialOrg(RefDep: comp): comp;

  #doc
  Организация, с которой у подразделения есть связь по иерархии
  #end
  function GetHierFilialOrg(RefDep: comp): comp;

  #doc
  Ссылка на собственное обособленное подразделение или филиал
  #end
  function GetDistinctDep(RefDep: comp): comp;

  #doc
  Ссылка на ГНИ (ссылку на запись в KATKOD с данными ГНИ)
  #end
  function GetTaxAgency(RefDep: comp): comp;

  #doc
  Тип плательщика налога на доходы
  #end
  function GetIncomeTaxCursor(RefDep: comp; var TaxPayer: word): boolean;

  #doc
  Плательщик налога, связанного с подразделением
  #end
  function GetTaxPayer(RefDep: comp; var RefOrg, RefBnk: comp): boolean;

  #doc
  Ссылка на код причины постановки на учет для переданного подразделения
  #end
  function GetDepKpp(RefDep: comp; var RefKpp: comp): boolean;

  #doc
  Ссылка и строковое ОКАТО подразделения RefDep
  #end
  function GetDepOKATO(RefDep: comp; var OKATO: string): comp;

  #doc
  Получатель налога, связанного с подразделением
  #end
  function GetTaxPayee(RefDep: comp; var RefOrg, RefBnk: comp): boolean;
end;

#doc
Муниципальный код территории (ОКТМО), обслуживаемой налоговой инспекцией
#end
ObjInterface IDepartmentTaxesOktmo;

  #doc
  Ссылка и строковое ОКТМО для подразделения RefDep
  #end
  function GetDepOKTMO(RefDep: comp; var OKTMO: string): comp;

end;

#doc
Код вида экономической деятельности (ОКВЭД)
#end
ObjInterface IDepartmentOKVED;

  #doc
  Ссылка на подразделение и ОКВЭД
  #end
  function GetRefDeptOKVED( RefDep: comp ) : comp;

end;

#end
