/*
  ╔═════════════════════════════════════════════════════════════════════╗
  ║      Н Т О  "T O P   S O F T",  А О   "Н О В Ы Й   А Т Л А Н Т"     ║
  ║      Проект    : ГАЛАКТИКА  (с) 2000                                ║
  ║      Система   : Управление персоналом                              ║
  ║      Версия    : 5.8, 7.1, 8.0                                      ║
  ║      Разработал: Антонович А.К.     04/12/2003                      ║
  ║      Назначение: Функции работы с уровнями образования              ║
  ║      Изменения :                                                    ║
  ╚═════════════════════════════════════════════════════════════════════╝
*/

#ifndef _EducFunc_vih_Included
#define _EducFunc_vih_Included

#ifdef ComponentVersion
#component "z_Staff"
#end

#doc
Функции работы с уровнями образования
#end
ObjInterface ObjEducFunc;

#doc
Функция возвращает NRec максимального образования по сотруднику
если образований несколько, берется последнее
#end
Public function GetNrecMaxEduc(psnNrec : comp) : comp;

#doc
Функция возвращает NRec профилирующего образования по сотруднику
если образований несколько, берется последнее
#end
Public function GetNrecProfEduc(psnNrec : comp) : comp;

#doc
Функция проверяет есть ли у персоны psnNrec образование с заданным уровнем cSysCode
#end
Public function isPsnLevelEduc(psnNrec : comp; cSysCode: integer) : boolean;

#doc
Возвращает тип образования на основании каталога </brief>
1 - Базовое образование, Послевузовское профессиональное
2 - Повышение квалификации
3 - Профессиональная переподготовка
4 - Прочие
#end
function GetEducType(EdLevel : comp): word ;

end;

#doc
Расширение функций работы с уровнями образования
#end
ObjInterface ObjEducFunc1;

#doc
Функция проверяет есть ли у персоны psnNrec образование с заданным уровнем cSysCode на дату
#end
Public function isPsnLevelEducOnDate(psnNrec : comp; cSysCode: integer; RunDate : date) : boolean;

#doc
Функция проверяет есть ли у персоны psnNrec профилирующее образование с заданным уровнем cSysCode
#end
Public function isPsnProfLevelEduc(psnNrec : comp; cSysCode: integer) : boolean;

#doc
Функция проверяет есть ли у персоны psnNrec профилирующее образование с заданным уровнем cSysCode на дату
#end
Public function isPsnProfLevelEducOnDate(psnNrec : comp; cSysCode: integer; RunDate : date) : boolean;

#doc
Получить наименование ученой степени
#end
function GetNameDegree(NrecPerson : comp; Code : integer) : string;

#doc
Получить NRec ученой степени
#end
function GetNRecDegree(NrecPerson : comp; Code : integer) : comp;

#doc
Получить наименование темы диссертации
#end
function GetNameTopic(NrecPerson : comp; Code : integer) : string;

#doc
Получить дату присвоения ученой степени
#end
function GetDateDegree(NrecPerson : comp; Code : integer) : date;

#doc
Получить наименование ученого совета
#end
function GetNameOrg(NrecPerson : comp; Code : integer) : string;

#doc
Получить NRec ученого совета
#end
function GetNRecOrg(NrecPerson : comp; Code : integer) : comp;

#doc
Получить наименование области науки
#end
function GetNameArea(NrecPerson : comp) : string;

#doc
Получить NRec области науки
#end
function GetNRecArea(NrecPerson : comp) : comp;

#doc
Получить наименование ученого звания
#end
function GetNameAcademRank(NrecPerson : comp) : string;

#doc
Получить NRec ученого звания
#end
function GetNRecAcademRank(NrecPerson : comp) : comp;

#doc
Получить наименование ученой специальности
#end
function GetNameProfees(NrecPerson : comp) : string;

#doc
Получить NRec ученой специальности
#end
function GetNRecProfess(NrecPerson : comp) : comp;

#doc
Получить дату присвоения ученого звания
#end
function GetDateAcademRank(NrecPerson : comp) : date;

#doc
Получить наименование организации, присвоившей звание
#end
function GetNameOrgAcademRank(NrecPerson : comp) : string;

#doc
Получить NRec организации, присвоившей звание
#end
function GetNRecOrgAcademRank(NrecPerson : comp) : comp;

#doc
Звание доктора наук
#end
Public function isPsnScDoc(psnNrec : comp) : boolean;

#doc
Звание кандидата в доктора наук
#end
Public function isPsnScCand(psnNrec : comp) : boolean;

#doc
Звание академика
#end
Public function isPsnAcad(psnNrec : comp) : boolean;

#doc
Звание доктора наук на дату
#end
Public function isPsnScDocOnDate(psnNrec : comp; RunDate : date) : boolean;

#doc
Звание кандидата в доктора наук на дату
#end
Public function isPsnScCandOnDate(psnNrec : comp; RunDate : date) : boolean;

#doc
Звание академика на дату
#end
Public function isPsnAcadOnDate(psnNrec : comp; RunDate : date) : boolean;

#doc
Функция возвращает максимальное образования сотрудника
#end
Public function GetPsnMaxEduc(psnNrec : comp) : word;

#doc
Функция возвращает максимальное профилирующее образования сотрудника
#end
Public function GetPsnProfEduc(psnNrec : comp) : word;

#doc
Функция возвращает максимальное образования сотрудника на дату
#end
Public function GetPsnMaxEducOnDate(psnNrec : comp; RunDate : date) : word;

#doc
Функция возвращает максимальное профилирующее образования сотрудника на дату
#end
Public function GetPsnProfEducOnDate(psnNrec : comp; RunDate : date) : word;

end;

#doc
Расширение функций работы с уровнями образования
#end
ObjInterface ObjEducFunc2;

#doc
Поиск наивысшего из образований по сотруднику (ссылка на Catalogs)
#end
Public function GetBestEducation(psnNrec : comp) : comp;

end;

#doc
Расширение функций работы с уровнями образования
#end
ObjInterface ObjEducFunc3;

#doc
Получить название ученой степени сотрудника на дату
#end
Public function GetNameDegreeOnDate(psnNrec : comp; RunDate : date) : string;

end;

VipInterface EducFunctions implements ObjEducFunc, ObjEducFunc1, ObjEducFunc2, ObjEducFunc3
#ifdef ATL51
Licensed (free)
#end
;

#endif
