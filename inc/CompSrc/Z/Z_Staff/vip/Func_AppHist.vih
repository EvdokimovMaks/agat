//******************************************************************************
//                                                      (с) корпорация Галактика
// Галактика 7.12 - Управление персоналом
// Декларация методов для работы с историей назначения
//******************************************************************************

#ifdef ComponentVersion
  #component "z_Staff"
#end

#ifdef ComponentVersionInDict
  #include iAppHist.vih
  public type TAppHist = record as table AppHist;
  #define TAppHist TAppHist
#else
  #define TAppHist type$AppHist
#end

objinterface IFunc_AppHist;

// *****************************************************************************
#doc
Функция получения буфера записи истории назначения на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_ViewStateOnDate(cCurAppoint: comp; dViewDate: Date): #TAppHist;
// *****************************************************************************
#doc
Получение NRec -а записи из которой взято значение. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetAppHistNrecOnDate(cCurAppoint: comp; dViewDate: Date): comp;
// *****************************************************************************
#doc
Получение "даты начала" записи на которую спозиционировались на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetAppHistDRecOnDate(cCurAppoint: comp; dViewDate: Date): date;
// *****************************************************************************
#doc
Получение "даты окончания" записи на которую спозиционировались на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetAppHistDEndOnDate(cCurAppoint: comp; dViewDate: Date): date;
// *****************************************************************************
#doc
Функция получения ссылки на режим работы. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetRegimOnDate(cCurAppoint: comp; dViewDate: Date): comp;
// *****************************************************************************
#doc
Получение ссылки на режим работы на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetNRecRegimOnDate(cCurAppoint: comp; dViewDate: Date): word;
// *****************************************************************************
#doc
Получение режима работы (строкой) на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetStrRegimOnDate(cCurAppoint: comp; dViewDate: Date): string;
// *****************************************************************************
#doc
Получение значения оклада на указанную дату. Возвращается double. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetTaxRateOnDate(cCurAppoint: comp; dViewDate: Date): double;
// *****************************************************************************
#doc
Получение значения оклада (строкой) на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetStrTaxRateOnDate(cCurAppoint: comp; dViewDate: Date): string;
// *****************************************************************************
#doc
Функция получения ссылки на тарифную сетку на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetTariffOnDate(cCurAppoint: comp; dViewDate: Date): comp;
// *****************************************************************************
#doc
Функция получения наименования тарифа на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetStrTariffOnDate(cCurAppoint: comp; dViewDate: Date): string;
// *****************************************************************************
#doc
Получение "системы оплаты" на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetPayModelOnDate(cCurAppoint: comp; dViewDate: Date): word;
// *****************************************************************************
#doc
Функция получения формы оплаты труда на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetStrSisOplOnDate(cCurAppoint: comp; dViewDate: Date): string;
// *****************************************************************************
#doc
Получение "разряда" на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetCategoryOnDate(cCurAppoint: comp; dViewDate: Date): word;
// *****************************************************************************
#doc
Получение "сетки" на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetCodTarOnDate(cCurAppoint: comp; dViewDate: Date): word;
// *****************************************************************************
#doc
Получение "даты тарифной сетки". </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetDateTariffOnDate(cCurAppoint: comp; dViewDate: Date): date;
// *****************************************************************************
#doc
Функция получения значения корректирующего коэффициента на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetKorKoeffOnDate(cCurAppoint: comp; dViewDate: Date): double;
// *****************************************************************************
#doc
Функция получения значения корректирующего коэффициента(строкой) на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetStrKorKoeffOnDate(cCurAppoint: comp; dViewDate: Date): string;
// *****************************************************************************
#doc
Функция получения ссылки на валюту оплаты. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetNrecCurrencyOnDate(cCurAppoint: comp; dViewDate: Date): comp;
// *****************************************************************************
#doc
Функция получения валюты оплаты. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetStrCurrencyOnDate(cCurAppoint: comp; dViewDate: Date): string;
// *****************************************************************************
#doc
Функция получения сслыки на условия работы труда на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetWorkCondOnDate(cCurAppoint: comp; dViewDate: Date): comp;
// *****************************************************************************
#doc
Функция получения условия труда (строкой) на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetStrWorkCondOnDate(cCurAppoint: comp; dViewDate: Date): string;
// *****************************************************************************
#doc
Функция получения ссылки на характер работы на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetJobOnDate(cCurAppoint: comp; dViewDate: Date): comp;
// *****************************************************************************
#doc
Функция получения характера работы на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetStrJobOnDate(cCurAppoint: comp; dViewDate: Date): string;
// *****************************************************************************
#doc
Получение даты приказа записи на которую спозиционировались на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetDocDateOnDate(cCurAppoint: comp; dViewDate: Date): date;
// *****************************************************************************
#doc
Получение номера приказа записи на которую спозиционировались на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetDocNumberOnDate(cCurAppoint: comp; dViewDate: Date): tNoDok;
// *****************************************************************************
#doc
Получить дату контракта на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetContractDateOnDate(cCurAppoint: comp; dViewDate: Date): date;
// *****************************************************************************
#doc
Получить дату контракта на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetContractNumberOnDate(cCurAppoint: comp; dViewDate: Date): s100;
// *****************************************************************************
#doc
Функция получения персонального разряда на указанную дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetPersCategoryOnDate(cCurAppoint: comp; dViewDate: Date): longInt;
// *****************************************************************************

end;

objinterface IFunc_AppHist_1;
// *****************************************************************************
#doc
Функция создания записи истории назначения по данным </br>
Параметры: </br>
  cAppoint - NRec назначения </br>
  dBegDate - дата начала записи </br>
  dEndDate - дата начала записи </br>
#end
function AH_InsertRecord( cAppoint: comp; wCodOper: word; dOperDate: date ): comp;
// *****************************************************************************
#doc
Функция получения ссылки на условия труда из истории назначения на дату. </br>
Параметры: </br>
  cCurAppoint - NRec назначения </br>
  dViewDate   - дата, на которую необходимо получить данные </br>
#end
function AH_GetKPSOnDate(cCurAppoint: comp; dViewDate: Date): comp;
end;

vipinterface Func_AppHist implements IFunc_AppHist, IFunc_AppHist_1
#ifdef ATL51
Licensed (free)
#end
;