//******************************************************************************
//                                                      (с) корпорация Галактика
//  Галактика 8.1 - Управление персоналом
//  Объектный интерфейс обработки контракта
//******************************************************************************
#ifndef _WorkWithContract_INCLUDED_
#define _WorkWithContract_INCLUDED_

#ifdef ComponentVersion
#component "Z_StaffOrders"
#end

const
  CONTRACT_NONE  = 0;
  CONTRACT_NEW   = 1;
  CONTRACT_LONG  = 2;
end;

#doc
  Объектный интерфейс работы с контрактом, привязанным к записи истории назначения
#end
objinterface IWorkWithContract;

#doc
Создание очередной записи о контракте на основании полученных параметров.
Возвращает нРек созданной записи таблицы CatArch
#end
Function NewContract(dateF: date; st: string[100]): comp;

#doc
Копирование контракта из одной записи истории в другую
#end
Function CopyContract(cAppHistOld: comp; cAppHistNew: comp): boolean;

#doc
Получить параметры контракта по ссылке на запись истории
#end
Procedure GetContractInfo(cAppHist: comp; var dateFr: date; var st: string[100]);

#doc
Получить нРек ближайшего контракта на дату WorkDate. Т.е. поиск до первой
записи истории для назначения cApp, к которой существует запись в таблице CatArch
#end
Function GetNearestNRecCatArch(WorkDate: date; cApp: comp): comp;

#doc
Получить параметры ближайшего контракта на дату WorkDate. Т.е. поиск до первой
записи истории по назначению cApp
#end
Procedure GetContractInfoFromNearestHistory(WorkDate: date; cApp: comp; var dateFr: date; var st: string[100]);

#doc
Получить нРек ближайшего контракта из РПД 1, 4, 5, 65 на дату WorkDate.
Т.е. поиск до первой записи истории с такими РПД, к которой существует запись в таблице CatArch
#end
Function GetNearestSpecNRec(WorkDate: date; cApp: comp): comp;

#doc
Получить параметры ближайшего контракта из РПД 1, 4, 5, 65 на дату WorkDate.
Т.е. поиск до первой записи истории по назначению cApp
#end
Procedure GetContractInfoFromSpecHistory(WorkDate: date; cApp: comp; var dateFr: date; var st: string[100]);

end;

#doc
  Объектный интерфейс работы с контрактом, привязанным к записи истории назначения
#end
objinterface IWorkWithContract1;

#doc
Создание очередной записи о контракте на основании полученных параметров.
Возвращает нРек созданной записи таблицы CatArch с автоматической привязкой к
полученной записи истории назначения
#end
Procedure NewContractNRec(dateF: date; st: string[100]; cAppHist: comp);

end;

#doc
  Объектный интерфейс работы с контрактом
#end
objinterface IWorkWithContract2;

#doc
Проверка продолжительности контракта
#end
function CheckDateEnd(cPers: comp; ContractNum: s100; ContractDate: date; DateBegin: date; DateEnd: date): boolean;

end;

private objinterface IWorkWithContract3;

#doc
Получить код последней записи истории назначения (<code>AppHist.NRec</code>) о заключении/продлении контракта.</brief>
<p>Функция возвращает код последней по сочетанию полей "изменить с" и "дата и время создания записи"
записи истории с кодом <b>65</b> назначения <code>AppHist.NRec</code>.</p>
<p>Поиск выполняется только для основых назначений и совмещений.</p>
<p>В том случае, если искомая запись в истории назначения не найдена, поиск производится по предыдущим
назначениям того же типа.</p>
#end
function GetLast65ByApp(_cApp: comp): comp;

end;

objinterface IWorkWithContractByNum;

#doc
Получение сведений о трудовых договорах сотрудника <code>_cPsn</code> на дату <code>_dCheck</code></brief>
<p>Функция инициализирует работу с трудовыми договорами сотрудника и возвращает их количество.</p>
<h3>См. также</h3>
<link function Z_StaffOrders::IWorkWithContractByNum.InitByApp>InitByApp</link>,
<link function Z_StaffOrders::IWorkWithContractByNum.GetNmbByNum>GetNmbByNum</link>
<link function Z_StaffOrders::IWorkWithContractByNum.GetTypeByNum>GetTypeByNum</link>,
<link function Z_StaffOrders::IWorkWithContractByNum.GetContractDateByNum>GetContractDateByNum</link>,
<link function Z_StaffOrders::IWorkWithContractByNum.GetContractBeginByNum>GetContractBeginByNum</link>,
<link function Z_StaffOrders::IWorkWithContractByNum.GetContractEndByNum>GetContractEndByNum</link>
#end
function InitByPerson(_cPerson: comp; _dCheck: date): word;

#doc
Получение сведений о трудовых договорах по назначению <code>_cApp</code> на дату <code>_dCheck</code></brief>
<p>Функция инициализирует работу с трудовыми договорами сотрудника и возвращает их количество.</p>
<h3>См. также</h3>
<link function Z_StaffOrders::IWorkWithContractByNum.InitByPerson>InitByPerson</link>,
<link function Z_StaffOrders::IWorkWithContractByNum.GetNmbByNum>GetNmbByNum</link>
<link function Z_StaffOrders::IWorkWithContractByNum.GetTypeByNum>GetTypeByNum</link>,
<link function Z_StaffOrders::IWorkWithContractByNum.GetContractDateByNum>GetContractDateByNum</link>,
<link function Z_StaffOrders::IWorkWithContractByNum.GetContractBeginByNum>GetContractBeginByNum</link>,
<link function Z_StaffOrders::IWorkWithContractByNum.GetContractEndByNum>GetContractEndByNum</link>
#end
function InitByApp(_cApp: comp; _dCheck: date): word;

#doc
Получение номера трудового договора</brief>
<p>Перед использованием необходимо вызвать
<link function Z_StaffOrders::IWorkWithContractByNum.InitByPerson>InitByPerson</link> или
<link function Z_StaffOrders::IWorkWithContractByNum.InitByApp>InitByApp</link>.</p>
#end
function GetNmbByNum(_wNum: word): string;

#doc
Получение ссылки на каталог с видами трудовых договоров</brief>
<p>Перед использованием необходимо вызвать
<link function Z_StaffOrders::IWorkWithContractByNum.InitByPerson>InitByPerson</link> или
<link function Z_StaffOrders::IWorkWithContractByNum.InitByApp>InitByApp</link>.</p>
#end
function GetTypeByNum(_wNum: word): comp;

#doc
Получение даты заключения трудового договора</brief>
<p>Перед использованием необходимо вызвать
<link function Z_StaffOrders::IWorkWithContractByNum.InitByPerson>InitByPerson</link> или
<link function Z_StaffOrders::IWorkWithContractByNum.InitByApp>InitByApp</link>.</p>
#end
function GetContractDateByNum(_wNum: word): date;

#doc
Получение даты начала срока действия трудового договора</brief>
<p>Перед использованием необходимо вызвать
<link function Z_StaffOrders::IWorkWithContractByNum.InitByPerson>InitByPerson</link> или
<link function Z_StaffOrders::IWorkWithContractByNum.InitByApp>InitByApp</link>.</p>
#end
function GetContractBeginByNum(_wNum: word): date;

#doc
Получение даты окончания срока действия трудового договора</brief>
<p>Перед использованием необходимо вызвать
<link function Z_StaffOrders::IWorkWithContractByNum.InitByPerson>InitByPerson</link> или
<link function Z_StaffOrders::IWorkWithContractByNum.InitByApp>InitByApp</link>.</p>
#end
function GetContractEndByNum(_wNum: word): date;

end;

vipinterface WorkWithContract implements IWorkWithContract, IWorkWithContract1, IWorkWithContract2, IWorkWithContract3
                                        , IWorkWithContractByNum
  Licensed (free);

#end
