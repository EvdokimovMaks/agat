//******************************************************************************
//                                                      (с) корпорация Галактика
//  Галактика 8.1 - Управление персоналом
//  Объектный интерфейс обработки контракта
//******************************************************************************
#ifndef _WorkWithContract_INCLUDED_
#define _WorkWithContract_INCLUDED_

#ifdef ComponentVersion
#component "Z_StaffOrders"
#end

#doc
  Объектный интерфейс работы с контрактом, привязанным к записи истории назначения
#end
objinterface IWorkWithContract;

#doc
Создание очередной записи о контракте на основании полученных параметров.
Возвращает нРек созданной записи таблицы CatArch
#end
Function NewContract(dateF: date; st: string[100]): comp;

#doc
Копирование контракта из одной записи истории в другую
#end
Function CopyContract(cAppHistOld: comp; cAppHistNew: comp): boolean;

#doc
Получить параметры контракта по ссылке на запись истории
#end
Procedure GetContractInfo(cAppHist: comp; var dateFr: date; var st: string[100]);

#doc
Получить нРек ближайшего контракта на дату WorkDate. Т.е. поиск до первой
записи истории для назначения cApp, к которой существует запись в таблице CatArch
#end
Function GetNearestNRecCatArch(WorkDate: date; cApp: comp): comp;

#doc
Получить параметры ближайшего контракта на дату WorkDate. Т.е. поиск до первой
записи истории по назначению cApp
#end
Procedure GetContractInfoFromNearestHistory(WorkDate: date; cApp: comp; var dateFr: date; var st: string[100]);

#doc
Получить нРек ближайшего контракта из РПД 1, 4, 5, 65 на дату WorkDate.
Т.е. поиск до первой записи истории с такими РПД, к которой существует запись в таблице CatArch
#end
Function GetNearestSpecNRec(WorkDate: date; cApp: comp): comp;

#doc
Получить параметры ближайшего контракта из РПД 1, 4, 5, 65 на дату WorkDate.
Т.е. поиск до первой записи истории по назначению cApp
#end
Procedure GetContractInfoFromSpecHistory(WorkDate: date; cApp: comp; var dateFr: date; var st: string[100]);

end;

#doc
  Объектный интерфейс работы с контрактом, привязанным к записи истории назначения
#end
objinterface IWorkWithContract1;

#doc
Создание очередной записи о контракте на основании полученных параметров.
Возвращает нРек созданной записи таблицы CatArch с автоматической привязкой к
полученной записи истории назначения
#end
Procedure NewContractNRec(dateF: date; st: string[100]; cAppHist: comp);

end;

#doc
  Объектный интерфейс работы с контрактом
#end
objinterface IWorkWithContract2;

#doc
Проверка продолжительности контракта
#end
function CheckDateEnd(cPers: comp; ContractNum: s100; ContractDate: date; DateBegin: date; DateEnd: date): boolean;

end;

vipinterface WorkWithContract implements IWorkWithContract, IWorkWithContract1, IWorkWithContract2
  Licensed (free);

#end
