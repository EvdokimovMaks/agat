.set name = 'SZV-63'
.hide
.var
 ShortOrLongNameOrg : word;
.endvar
.fields
 КодОКПО
 КПППред
 ИНН
 РегНомер
 НаимПред
 НаимПредКраткое
 Год
 ВидФормы
 ФИОРук
 ДолжРук
 ФИОИсп
 ДатаСост
 wRound
 PachNumBegin: LongInt 
 КолвоДок
 Категория
 ВидДог
 СуммаПачИтого1: double
 СуммаПачИтого2: double
 ФИО
 Фамилия
 Имя
 Отчество
 ЛицевойСчет
 ТабНомер
 Подразделение
 СтраховойНомер  
 Пол
 ДатаРождения
 Сумма1:      double    Сумма1_B:    double
 Сумма2:      double    Сумма2_B:    double
 Сумма3:      double    Сумма3_B:    double
 Сумма4:      double    Сумма4_B:    double
 Сумма5:      double    Сумма5_B:    double
 Сумма6:      double    Сумма6_B:    double
 Сумма7:      double    Сумма7_B:    double
 Сумма8:      double    Сумма8_B:    double
 Сумма9:      double    Сумма9_B:    double
 Сумма10:     double    Сумма10_B:   double
 Сумма11:     double    Сумма11_B:   double
 Сумма12:     double    Сумма12_B:   double
 СуммаИтого1: double    СуммаИтого2: double
.endfields
.begin
  if ( not ReadMyDsk(ShortOrLongNameOrg, 'SFOND_ShortOrLongNameOrg', false) )
    ShortOrLongNameOrg := 0;
end.
 КодОКПО            ^ 
 КПППред            ^
 ИНН                ^ 
 РегНомер           ^ 
 НаимПред           ^ 
 НаимПредКраткое    ^ 
 Год                ^
 ВидФормы           ^
 ФИОРук             ^
 ДолжРук            ^
 ФИОИсп             ^
 ДатаСост           ^
 Округление         ^
 Номер первой пачки ^
.{ CheckEnter AllParts_SZV63
 КолвоДок           ^
 Категория          ^
 ВидДог             ^
 СуммаПачИтого1 ^ СуммаПачИтого2 ^
.{ CheckEnter SZV6_3
----------SZV6_3--------- 
 ФИО                ^
 Фамилия            ^ 
 Имя                ^
 Отчество           ^
 ЛицевойСчет        ^ 
 ТабНомер           ^
 Подразделение      ^
 СтраховойНомер     ^  
 Пол                ^
 ДатаРождения       ^
 Суммы по месяцам
 ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
 ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
 СуммаИтого1 ^ СуммаИтого2 ^
.}
.{ CheckEnter ADV64
----------ADV64----------
----------ADV64----------
.}
.if DeadLineSzv63
.end
.}
.endform

.linkform 'SZV-6-3_MAGNITlink' prototype is 'SZV-63'
.F 'IS_SZV_6-3.XML'
.nameinlist'Файл для ПФ на МН (в.7.00)'
.var
 Num_v_P, pach_nmb: longint;
 sTipSved, sNmPred, sNmPredShort, rrr: string;
.endvar
.begin
 pach_nmb := PachNumBegin;
end.
.begin
  sNmPred      := Replace( Upcase( Trim( НаимПред ) ), '"', '&quot;' )
  sNmPredShort := Replace( Upcase( Trim( НаимПредКраткое ) ), '"', '&quot;' )
  case ВидФормы of
  0: sTipSved := 'ИСХОДНАЯ';
  1: sTipSved := 'КОРРЕКТИРУЮЩАЯ';
  else
    sTipSved := 'ОТМЕНЯЮЩАЯ';
  end;
  if wRound = 2  
    rrr   := '[|-]3666666666666667.88'
  else
    rrr   :='[|-]3666666666666667'
end.
.{ CheckEnter AllParts_SZV63
.begin
 Num_v_P := 1; 
end.
.fields
 Num_v_P
 ИНН
 КПППред
 If (ShortOrLongNameOrg <> 0, sNmPred, sNmPredShort)
 РегНомер
 pach_nmb
 КолвоДок
 ДатаСост
 sTipSved
 Категория
 if (ВидДог = 0, 'ТРУДОВОЙ', 'ГРАЖДАНСКО-ПРАВОВОЙ')
 Год
 DoubleToStr(СуммаПачИтого1, rrr)
 DoubleToStr(СуммаПачИтого2, rrr)
.endfields
<?xml version="1.0" encoding="cp866"?>
<ФайлПФР>
  <ИмяФайла></ИмяФайла>
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
       <Версия>8.10</Версия>
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
  <ПачкаВходящихДокументов Окружение = "В составе файла" Стадия = "До обработки">
    <ВХОДЯЩАЯ_ОПИСЬ_ПО_СУММАМ_ВЫПЛАТ>
      <НомерВпачке>^</НомерВпачке> 
      <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
      <СоставительПачки>
        <НалоговыйНомер>
          <ИНН>^</ИНН> 
          <КПП>^</КПП>
        </НалоговыйНомер>
        <НаименованиеКраткое>^</НаименованиеКраткое>
        <РегистрационныйНомер>^</РегистрационныйНомер>
      </СоставительПачки>
      <НомерПачки>
        <Основной>^</Основной>
      </НомерПачки>
      <СоставДокументов>
        <Количество>1</Количество>
        <НаличиеДокументов>
          <ТипДокумента>СВЕДЕНИЯ_О_СУММЕ_ВЫПЛАТ_И_ВОЗНАГРАЖДЕНИЙ</ТипДокумента>
          <Количество>^</Количество>
        </НаличиеДокументов>
      </СоставДокументов>
      <ДатаСоставления>^</ДатаСоставления>
      <ТипСведений>^</ТипСведений>
      <КодКатегории>^</КодКатегории>
      <ТипДоговора>^</ТипДоговора> 
      <ОтчетныйГод>^</ОтчетныйГод>
      <СуммаВыплатИвознаграждений>
      <ТипСтроки>ИТОГО ПО ПАЧКЕ</ТипСтроки> 
      <СуммаВыплатВсего>^</СуммаВыплатВсего> 
      <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
    </ВХОДЯЩАЯ_ОПИСЬ_ПО_СУММАМ_ВЫПЛАТ>
.fields
 Num_v_P
 sTipSved
 trim(СтраховойНомер)
 trim(UpCase(Фамилия))
 trim(UpCase(Имя))
 trim(UpCase(Отчество))
 РегНомер
 If (ShortOrLongNameOrg <> 0, sNmPred, sNmPredShort)
 ИНН
 КПППред
 Категория
 if (ВидДог = 0, 'ТРУДОВОЙ', 'ГРАЖДАНСКО-ПРАВОВОЙ')
 Год
 ДатаСост
 DoubleToStr(Сумма1,      rrr)  DoubleToStr(Сумма1_B,    rrr)
 DoubleToStr(Сумма2,      rrr)  DoubleToStr(Сумма2_B,    rrr)
 DoubleToStr(Сумма3,      rrr)  DoubleToStr(Сумма3_B,    rrr)
 DoubleToStr(Сумма4,      rrr)  DoubleToStr(Сумма4_B,    rrr)
 DoubleToStr(Сумма5,      rrr)  DoubleToStr(Сумма5_B,    rrr)
 DoubleToStr(Сумма6,      rrr)  DoubleToStr(Сумма6_B,    rrr)
 DoubleToStr(Сумма7,      rrr)  DoubleToStr(Сумма7_B,    rrr)
 DoubleToStr(Сумма8,      rrr)  DoubleToStr(Сумма8_B,    rrr)
 DoubleToStr(Сумма9,      rrr)  DoubleToStr(Сумма9_B,    rrr)
 DoubleToStr(Сумма10,     rrr)  DoubleToStr(Сумма10_B,   rrr)
 DoubleToStr(Сумма11,     rrr)  DoubleToStr(Сумма11_B,   rrr)
 DoubleToStr(Сумма12,     rrr)  DoubleToStr(Сумма12_B,   rrr)
 DoubleToStr(СуммаИтого1, rrr)  DoubleToStr(СуммаИтого2, rrr)
.endfields
.{ CheckEnter SZV6_3
.begin
 Num_v_P := Num_v_P + 1; 
end.
    <СВЕДЕНИЯ_О_СУММЕ_ВЫПЛАТ_И_ВОЗНАГРАЖДЕНИЙ>
      <НомерВпачке>^</НомерВпачке>
      <ТипСведений>^</ТипСведений>
      <СтраховойНомер>^</СтраховойНомер>
      <ФИО>
        <Фамилия>^</Фамилия> 
        <Имя>^</Имя> 
        <Отчество>^</Отчество> 
      </ФИО>
      <РегистрационныйНомер>^</РегистрационныйНомер> 
      <НаименованиеКраткое>^</НаименованиеКраткое> 
      <НалоговыйНомер>
        <ИНН>^</ИНН> 
        <КПП>^</КПП> 
      </НалоговыйНомер>
      <КодКатегории>^</КодКатегории> 
      <ТипДоговора>^</ТипДоговора> 
      <ОтчетныйГод>^</ОтчетныйГод> 
      <ДатаЗаполнения>^</ДатаЗаполнения> 
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>1</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>2</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>3</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>4</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>5</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>6</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>7</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>8</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>9</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>10</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>11</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>МЕСЯЦ</ТипСтроки> 
        <Месяц>12</Месяц> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
      <СуммаВыплатИвознаграждений>
        <ТипСтроки>ИТОГО</ТипСтроки> 
        <СуммаВыплатВсего>^</СуммаВыплатВсего> 
        <СуммаВыплатНачисленыСтраховыеВзносы>^</СуммаВыплатНачисленыСтраховыеВзносы> 
      </СуммаВыплатИвознаграждений>
    </СВЕДЕНИЯ_О_СУММЕ_ВЫПЛАТ_И_ВОЗНАГРАЖДЕНИЙ>
.}
.{ CheckEnter ADV64
.}
</ПачкаВходящихДокументов>
</ФайлПФР>
.begin
 pach_nmb := pach_nmb + 1;
end.
.if DeadLineSzv63
___КОНЕЦ ПАЧКИ!!!_Разрежьте_здесь!
.end
.}
.endform
