//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 9.1 - Логистика
//
//******************************************************************************

#ifdef ComponentVersion
#Component "L_COMMON"
#end

#ifndef __Protector_Base_vih__
#define __Protector_Base_vih__

//****************************************************************************
// Переменные
//  _wTiDK       - тип ДО
//  _cRec        - ссылка на документ
//  _cSpRec      - ссылка на позицию спецификации документа
//  _wCurCommand - текущее событие (*.inc)
//  _wCurTable   - текущая таблица (*.inc)
//  _wCurFormat  - текущая область (*.inc)
//  _wCurField   - текущее поле (*.inc)
//  _wMode       - режим отображения сообщений
//  _wFunc       - функция (*.inc)
//  _sDopText1   - начальная часть сообщения
//  _sMes        - сообщение
//  _sDopText2   - конечная часть сообщения
//  _wReason     - причина запрета
//****************************************************************************

ObjInterface IProtector_Base;

//*****************************************************************************

#doc
  Инициализация объекта

  Результат: TRUE - инициализация прошла успешно
#end
Function Initialize(_wTiDK : word) : boolean;

//*****************************************************************************

#doc
  Проверка указанного события на возможность выполнения

  Результат: TRUE - выполнение разрешено
#end
Function CheckCommand(_cRec, _cSpRec : comp; _wCurCommand : word; _wCurTable : integer; _wCurFormat, _wCurField, _wMode : word) : boolean;

//*****************************************************************************

#doc
  Выполнение отдельной функции по проверке возможности модификации

  Результат: TRUE - результат выполнения функции
#end
Function RunFunc(_cRec, _cSpRec : comp; _wFunc,  _wMode : word) : boolean;

//*****************************************************************************

#doc
  Можно ли влиять на события в указанных областях

  Результат: TRUE - да
#end
Function CanManageInput(_wCurTable : integer; _wCurFormat, _wCurField : word) : boolean;

//*****************************************************************************

#doc
  Проверка возможности модификации документа

  Результат: TRUE - модификация разрешена
#end
Function CanEditDoc(_cRec : comp; _wMode : word) : boolean;

//*****************************************************************************

#doc
  Получить текст сообщения последнего запрета модификации
#end
Function GetMessage : string;

//*****************************************************************************

#doc
  Получить код последнего запрета модификации
#end
Function GetReason : word;

//*****************************************************************************

#doc
  Установить текст последнего запрета модификации
#end
Procedure SetMessage(_sMes : string);

//*****************************************************************************

#doc
  Событие. Отобразить запрос на модификацию. Строка сообщения = _sDopText1 + _sMes + _sDopText2

  Результат: TRUE - пользователь разрешил модификацию
#end
Event Function  EventShowRequest(_sDopText1, _sMes, _sDopText2 : string; _wMode, _wReason : word) : boolean;

//*****************************************************************************

#doc
  Событие. Отобразить сообщение о запрете модификации. Строка сообщения = _sDopText1 + _sMes + _sDopText2
#end
Event Procedure EventShowMessage(_sDopText1, _sMes, _sDopText2 : string; _wMode : word);

//*****************************************************************************
end;

#end
