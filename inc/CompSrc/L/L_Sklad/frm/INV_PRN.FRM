! ╔═════════════════════════════════════════════════════════════════════════╗
! ║  Разработал:  Александр Крахотко                                        ║
! ║  Назначение:  печать акта инвентаризации                                ║
! ║  Дополнения:  Голец Дмитрий Иванович для розничной торговли             ║
! ║                                                                         ║
! ║              Используется на Складе и в Розничной Торговле !!!          ║
! ╚═════════════════════════════════════════════════════════════════════════╝

#include Commission.frn
#doc
Печать акта инвентаризации
#end
.Set Name = 'inventar'
.hide
.fields
!.{
Вид_акта // 611 - излишек 612 - недостаток; 904 - излишек 914 - недостаток (розница) 910 - недостаток (розница)
nRec_Doc : comp
MyOrg
номер_акта
дескриптор
дата_акта:date:'m:"DD" mon YYYY г.'
примечание
дата_оприходования:date:'m:"DD" mon YYYY г.'
склад
мол
назначение
сумма_нац:double
сумма_вал:double
валюта_1_код:comp
валюта_2_код:comp
наименование_валюты
типовая_хозяйственная_операция
символ_валюты
символ_баз_валюты
кол_знак_сумм     : integer
кол_знак_сумм_вал : integer
шаблон
шаблон_вал
Kol_pr : string
#CommissionFields
!.{
  nRec_SpDoc
  название
  номенклатурный_номер
  количество:double
  цена:double
  цена_в_валюте:double
  стоимость_МЦ:double
  единица_изм
  nRecParty : comp
  название_партии
!.}
сумма_баз_округл : double // Сумма в валюте документа, округленная до 2 знаков после запятой
!.{
.endfields
.{
вид_акта // 611 - излишек 612 - недостаток  ^
nRec_Doc                                    ^
Организация                                 ^
номер_акта                                  ^
Дескриптор                                  ^
дата_акта                                   ^
Примечание                                  ^
дата_оприходования                          ^
склад                                       ^
мол                                         ^
назначение                                  ^
сумма_нац                                   ^
сумма_вал                                   ^
валюта_1_код                                ^
валюта_2_код                                ^
наименование_валюты                         ^
Типовая_хозяйственная_операция              ^
символ_валюты                               ^
символ_баз_валюты                           ^
кол_знак_сумм                               ^
кол_знак_сумм_вал                           ^
шаблон                                      ^
шаблон_вал                                  ^
кол_знак_дроб_кол                           ^
#CommissionBody(inventar)
.{
  nRec_SpDoc                                ^
  Название                                  ^
  Номенклатурный номер                      ^
  Количество                                ^
  Цена                                      ^
  Цена в валюта                             ^
  стоимость_МЦ                              ^
  ед изм                                    ^
  nRecParty                                 ^
  Название партии                           ^
.}
сумма_баз_округл                            ^
.}
.endform

#doc
Акт инвентаризации о недостаче МЦ
#end
.linkform 'inventar_01' prototype is 'inventar'
.nameInList 'Акт инвентаризации о недостаче МЦ'
.group '612'
#CommissionLinkVar
.fields
  CommonFormHeader
  MyOrg
.endfields
^
^
.fields
PrintNumber(дескриптор,номер_акта)
дата_акта
примечание
дата_оприходования
склад
мол
назначение
типовая_хозяйственная_операция
наименование_валюты : 'd:r'
символ_валюты : 'd:r'
символ_баз_валюты : 'd:r'
!.{
  название
  номенклатурный_номер
  единица_изм
  DoubleToStr(количество, Kol_pr)
  цена
  цена_в_валюте
  стоимость_МЦ
  название_партии
!.}
сумма_баз_округл
сумма_нац
DoubleToString(0, Round(сумма_нац, 2))
.endfields
.{
#CommissionLinkInit(Inventar)
 Б               АКТ ИНВЕНТАРИЗАЦИИ О НЕДОСТАЧЕ МЦ НА СКЛАДЕ
                              №  ^   от  ^ Б
 Р  БПримечание : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БДата списания со склада : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БСклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БМОЛ   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БНазначение : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БТиповая хозяйственная операция : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.{
.[h OverWrite
 Р──────────────────────────┬─────────────┬───────┬──────────────┬──────────────┬─────────────┬──────────────────┬────────────────────────
      Наименование        │Номенкл.номер│Уч.ед. │  Количество  │  Цена,  @@@@ │  Цена,  @@@@│ Стоимость,  @@@@@│        Партия
──────────────────────────┴─────────────┴───────┴──────────────┴──────────────┴─────────────┴──────────────────┴──────────────────────── Р
.]h
 Р @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@  @@@@@@ &'&&&&&&&&&&&& &'&&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&&&&&&.&& @@@@@@@@@@@@@@@@@@@@@@@ Р
.}
 Р────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б                                                                                      Итого: &'&&&&&&&&&&&&&.&&

 Сумма по акту &'&&&&&&&&&&&&&.&& С
 Р Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
 Р.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
 Р
 Р Председатель комиссии            Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                             должность                     подпись                      расшифровка подписи
.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
 @@@@@@@@@@@@@@@                  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                             должность                     подпись                      расшифровка подписи
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 Члены комиссии:                 _________________________________  _____________________  __________________________________________
                                             должность                     подпись                      расшифровка подписи
                                 _________________________________  _____________________  __________________________________________
                                             должность                     подпись                      расшифровка подписи
                                 _________________________________  _____________________  __________________________________________
                                             должность                     подпись                      расшифровка подписи


 Р.}

.}
.endform

#doc
Акт инвентаризации об излишке МЦ
#end
.linkform 'inventar_02' prototype is 'inventar'
.nameInList 'Акт инвентаризации об излишке МЦ'
.group '611'
#CommissionLinkVar
.fields
  CommonFormHeader
  MyOrg
.endfields
^
 Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.fields
PrintNumber(дескриптор,номер_акта)
дата_акта
примечание
дата_оприходования
склад
мол
назначение
типовая_хозяйственная_операция
наименование_валюты : 'd:r'
символ_валюты : 'd:r'
символ_баз_валюты : 'd:r'
!.{
  название
  номенклатурный_номер
  единица_изм
  DoubleToStr(количество, Kol_pr)
  DoubleToStr(цена, шаблон)
  DoubleToStr(цена_в_валюте, шаблон_вал)
  if(валюта_1_код = 0,DoubleToStr(стоимость_МЦ, шаблон), DoubleToStr(стоимость_МЦ, шаблон_вал))
  название_партии
!.}
if(валюта_1_код = 0,DoubleToStr(сумма_баз_округл, шаблон),DoubleToStr(сумма_баз_округл, шаблон_вал))
DoubleToStr(сумма_нац, шаблон)
!наименование_валюты
DoubleToString(0, Round(сумма_нац, кол_знак_сумм))
.endfields
.{
#CommissionLinkInit(Inventar)
 Б                  АКТ ИНВЕНТАРИЗАЦИИ ОБ ИЗЛИШКАХ МЦ НА СКЛАДЕ
                                №  ^ от ^ Б
 Р  БПримечание : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БДата оприходования на склад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БСклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БМОЛ   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БНазначение : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БТиповая хозяйственная операция : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.{
.[h OverWrite
 Р──────────────────────────┬─────────────┬───────┬──────────────┬──────────────┬─────────────┬──────────────────┬────────────────────────
      Наименование        │Номенкл.номер│Уч.ед. │  Количество  │  Цена,  @@@@ │  Цена,  @@@@│ Стоимость,  @@@@@│        Партия
──────────────────────────┴─────────────┴───────┴──────────────┴──────────────┴─────────────┴──────────────────┴──────────────────────── Р
.]h
 Р @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@  @@@@@@ &'&&&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&& &'&&&&&&&&&&&&&&&& @@@@@@@@@@@@@@@@@@@@@@@ Р
.}
 Р──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б                                                                                      Итого: &'&&&&&&&&&&&&&&&&

 Сумма по акту &'&&&&&&&&&&&&&&&& С
 Р Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
 Р.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
 Р
 Р Председатель комиссии            Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                             должность                     подпись                      расшифровка подписи
.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
 @@@@@@@@@@@@@@@                  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                             должность                     подпись                      расшифровка подписи
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 Члены комиссии:                 _________________________________  _____________________  __________________________________________
                                             должность                     подпись                      расшифровка подписи
                                 _________________________________  _____________________  __________________________________________
                                             должность                     подпись                      расшифровка подписи
                                 _________________________________  _____________________  __________________________________________
                                             должность                     подпись                      расшифровка подписи Р


.}

.}
.endform




!****************************************************************************************
!***   Розничная торговля
!****************************************************************************************

#doc
Акт инвентаризации о недостаче МЦ (Розничная торговля)
#end
.linkform 'inventar_03' prototype is 'inventar'
.nameInList 'Акт инвентаризации о недостаче МЦ (Розничная торговля)'
.group '914'
#CommissionLinkVar
.fields
  CommonFormHeader
.endfields
^
.fields
!.{
НОМЕР_АКТА
дата_акта
дата_оприходования
склад
мол

!.{
  название
  номенклатурный_номер
  единица_изм
  DoubleToStr(количество, Kol_pr)
  цена
  цена * количество
  название_партии
!.}
сумма_нац
DoubleToString(0, Round(сумма_нац, 2))
!.}
.endfields

.{
#CommissionLinkInit(Inventar)
 Б  АКТ ИНВЕНТАРИЗАЦИИ О НЕДОСТАЧЕ МЦ В ПОДРАЗДЕЛЕНИЯХ РОЗНИЧНОЙ ТОРГОВЛИ Б
                         №  ^ от ^

 СДата списания со склада : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БСклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БМол   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р

 Ш──────────────────────────┬─────────────┬───────┬──────────────┬───────────────┬─────────────────┬───────────────────────────────────────────────── Ш
 Ш  Название                │Ном.номер    │ ЕдИзм │Количество    │Цена           │Сумма            │Партия                                            Ш
 Ш──────────────────────────┴─────────────┴───────┴──────────────┴───────────────┴─────────────────┴───────────────────────────────────────────────── Ш
.{
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@ &'&&&&&&&&&&&& &&&&&&&&&&&&.&& &&&&&&&&&&&&&&.&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.}

 ИСумма по акту &&&&&&&&&&&&.&& руб. И
 Р  Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.endform

#doc
Акт инвентаризации об излишках МЦ (Розничная торговля)
#end
.linkform 'inventar_04' prototype is 'inventar'
.nameInList 'Акт инвентаризации об излишках МЦ (Розничная торговля)'
.group '904'
#CommissionLinkVar
.fields
  CommonFormHeader
.endfields
^
.fields
!.{
номер_акта
дата_акта
дата_оприходования
склад
мол
!.{
  название
  номенклатурный_номер
  единица_изм
  DoubleToStr(количество, Kol_pr)
  DoubleToStr(Round(цена, кол_знак_сумм), шаблон)
  DoubleToStr(Round(цена * количество, кол_знак_сумм), шаблон)
  название_партии
!.}
DoubleToStr(Round(сумма_нац, кол_знак_сумм), шаблон)
DoubleToString(0, Round(сумма_нац, кол_знак_сумм))
!.}
.endfields

.{
#CommissionLinkInit(Inventar)
 Б       АКТ ИНВЕНТАРИЗАЦИИ ОБ ИЗЛИШКАХ МЦ
      В ПОДРАЗДЕЛЕНИЯХ РОЗНИЧНОЙ ТОРГОВЛИ Б
               №  ^ от ^

 СДата оприходования на склад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БСклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БМол   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р

 Ш──────────────────────────┬─────────────┬───────┬──────────────┬───────────────┬─────────────────┬───────────────────────────────────────────────── Ш
 Ш  Название                │Ном.номер    │ ЕдИзм │Количество    │Цена           │Сумма            │Партия                                            Ш
 Ш──────────────────────────┴─────────────┴───────┴──────────────┴───────────────┴─────────────────┴───────────────────────────────────────────────── Ш
.{
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@ &'&&&&&&&&&&&& &&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.}

 ИСумма по акту &&&&&&&&&&&&&&& руб. И
 Р  Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.endform



!*** Для стоимостной инвентаризации
#doc
Документ по результатам стоимостной инвентаризации о недостаче МЦ (Розничная торговля)
#end
.linkform 'inventar_05' prototype is 'inventar'
.nameInList 'Документ по результатам стоимостной инвентаризации о недостаче МЦ (Розничная торговля)'
.group '910'
#CommissionLinkVar
.create view rzDoc_view
        as select rzDoc.SumSale, rzDoc.SumEU,rzDoc.SumLack, rzDoc.LastInv, rzDoc.Price
        from rzDoc(readonly) ,rzspdoc
        where ((
        comp(nRec_Doc)   == rzDoc.nRec
        ))
;
.create view rzSpDoc_view
        as select rzSpDoc.kol, rzSpDoc.ostatok, rzSpDoc.PercentEU
        from rzSpDoc(readonly)
        where ((
        comp(nRec_SpDoc) == rzSpDoc.nRec
        ))
;
.fields
!.{
  CommonFormHeader
.endfields
^
.fields
НОМЕР_АКТА
if (rzDoc_view.getfirst rzSpDoc = 0, if (rzDoc_view.rzDoc.LastInv = date(0,0,0), '', 'с '+ datetostr(rzDoc_view.rzDoc.LastInv,'DD/MM/YYYY')), '')
дата_акта
дата_оприходования
склад
мол

!.{
  название
  номенклатурный_номер
  единица_изм
  DoubleToStr(количество, Kol_pr)
  if (rzSpDoc_view.getfirst rzSpDoc = 0, rzSpDoc_view.rzSpDoc.ostatok, 0)
  цена
!.}
if (rzDoc_view.getfirst rzDoc = 0, rzDoc_view.rzDoc.Price, 0)
rzDoc_view.rzDoc.SumSale
rzDoc_view.rzDoc.SumEU
rzDoc_view.rzDoc.SumLack
!.}
.endfields

.{
#CommissionLinkInit(Inventar)
 Б  ДОКУМЕНТ ПО ИТОГАМ ИНВЕНТАРИЗАЦИИ О НЕДОСТАЧЕ МЦ
  В ПОДРАЗДЕЛЕНИЯХ РОЗНИЧНОЙ ТОРГОВЛИ С СТОИМОСТНОЙ
                     СХЕМОЙ УЧЕТА Б

            №  ^ за период ^ по ^

 СДата списания со склада : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
 ССклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
 СМол   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р

 И──────────────────────────┬─────────────┬───────┬──────────────┬──────────┬───────────────
  Название                │Ном.номер    │ ЕдИзм │Количество    │Колво факт│Сумма недостачи
──────────────────────────┴─────────────┴───────┴──────────────┴──────────┴─────────────── И
 И.{ И
 И@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@ &'&&&&&&&&&&&& &&&&&&&.&& &&&&&&&&&&&&.&& И
 И.} И

 ИСумма недостачи по спецификации             &&&&&&&&&&&&.&& руб. И
 ИСумма по кассовым лентам                    &&&&&&&&&&&&.&& руб. И
 ИСумма естественной убыли                    &&&&&&&&&&&&.&& руб.
Сумма недостачи                             &&&&&&&&&&&&.&& руб.
 И

 Р!  Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
 И.endform И
!****************************************************************************************
!***   Розничная торговля
!****************************************************************************************

#doc
Акт инвентаризации о недостаче МЦ (Розничная торговля)
#end
.linkform 'inventar_06' prototype is 'inventar'
.nameInList 'Акт инвентаризации о недостаче МЦ стоимостной (Исх. НДС, торговая надбавка)'
.group '914'
#CommissionLinkVar
.DEFO LANDSCAPE
.var
  SummaTN :Double;
  SummaNDS :Double;
.endvar
.create view Nalog_view
  as select
    SpDocNalPrint.SumNal

  from
   rzspdoc
 , rzKUTPrih rzKUTPrihPrint
 , SpDocNal  SpDocNalPrint
  where ((
              comp(nRec_SpDoc)             == rzSpDoc.nRec
          AND rzSpDoc.cKutPrih             == rzKUTPrihPrint.nRec
          AND coGetTune('Nalog.cNalogNDS') == SpDocNalPrint.cNalog
          AND rzKUTPrihPrint.NRec          == SpDocNalPrint.cSpDoc
          AND word(920)                    == SpDocNalPrint.TipDoc
        ))
;
.fields
  CommonFormHeader
.endfields
^
.fields
!.{
НОМЕР_АКТА
дата_акта
дата_оприходования
склад
мол

!.{
  название
  номенклатурный_номер
  единица_изм
  DoubleToStr(количество, Kol_pr)
  цена
  if (Nalog_view.getfirst rzSpDoc = 0, ((Nalog_view.rzKUTPrihPrint.fPrice * Nalog_view.rzSpDoc.pNacen) / 100) * количество, 0)
  if (Nalog_view.getfirst rzSpDoc = 0, (Nalog_view.SpDocNalPrint.SumNal/Nalog_view.rzKUTPrihPrint.Kol) * количество, 0)
  цена * количество
  название_партии
!.}

SummaTN
SummaNDS
сумма_нац
DoubleToString(0, Round(сумма_нац, 2))
!.}
.endfields

.{
#CommissionLinkInit(Inventar)
 Б  АКТ ИНВЕНТАРИЗАЦИИ О НЕДОСТАЧЕ МЦ В ПОДРАЗДЕЛЕНИЯХ РОЗНИЧНОЙ ТОРГОВЛИ Б
                         №  ^ от ^

 СДата списания со склада : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БСклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БМол   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р

 Ш──────────────────────────┬─────────────┬───────┬──────────────┬───────────────┬───────────────┬───────────────┬─────────────────┬───────────────────────────────────────────────── Ш
 Ш  Название                │Ном.номер    │ ЕдИзм │Количество    │Цена           │ Торг.надбавка │  Исх.НДС      │Сумма            │Партия                                            Ш
 Ш──────────────────────────┴─────────────┴───────┴──────────────┴───────────────┴───────────────┴───────────────┴─────────────────┴───────────────────────────────────────────────── Ш
.{
.begin
SummaTN  := SummaTN  + if (Nalog_view.getfirst rzSpDoc = 0, ((Nalog_view.rzKUTPrihPrint.fPrice * Nalog_view.rzSpDoc.pNacen) / 100) * количество, 0);
SummaNDS := SummaNDS + if (Nalog_view.getfirst rzSpDoc = 0, (Nalog_view.SpDocNalPrint.SumNal/Nalog_view.rzKUTPrihPrint.Kol)* количество, 0);
end.
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@ &'&&&&&&&&&&&& &&&&&&&&&&&&.&& &&&&&&&&&&&&.&& &&&&&&&&&&&&.&& &&&&&&&&&&&&&&.&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.}
 ШСумма по акту                                                                   &&&&&&&&&&&&.&& &&&&&&&&&&&&.&& &&&&&&&&&&&&&&.&& Ш
 Р  Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.endform
