#ifndef _KATPARTY_VIH
#define _KATPARTY_VIH

#ifdef ComponentVersion
#component "L_KatParty"
#end

// структура для формирования новой партии
#include MkParty.inc

#doc
структура для передачи параметров фильтрации
#end

Type
  TFilterKatParty = Record
    Filter   : Word;
    Kons     : Word;
    Arch     : Word;
    cMC      : Comp;
    cOrg     : Comp;
    cGroup   : Comp;
    bCrDate  : DateTime;
    eCrDate  : DateTime;
    Pick     : Boolean; // вызов из интерфейса выбора
  end;

ObjInterface objKatParty;

//------------------------------------------------------------------------------
#doc
Назначение:
  Формирование кода партии
#end
Function GetNextPartyKod: string;
Function GetNextPartyKod2(NewPartyRec : tNewPartyRec) : string;
Function GetNextPartyKod3(bufParty    : type$KatParty): string;

Function CheckLinksInTables(_cParty : comp; var msg : string) : boolean;
end;

ObjInterface objKatParty2;
//------------------------------------------------------------------------------
#doc
Назначение:
// проверка кода и наименования партии. Возвращает текст с ошибкой
#end
Function CheckKodAndNameParty(bufParty: type$KatParty): string;

end;

VipInterface KatPartyFlt
  licensed (FREE)
  Parameters (pFlt: TFilterKatParty)
;

VipInterface KatParty_Release
  implements objKatParty, objKatParty2
  SourceFile = "KatParty_release.vip"
  licensed (FREE)
  Parameters (c1 : comp)
;

VipInterface KatParty(KatParty_Release)
;

#end
