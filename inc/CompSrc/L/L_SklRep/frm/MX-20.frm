!╔═══════════════════════════════════════════════════════════════════════════╗
!║                  (c) 1994,2003 корпорация ГАЛАКТИКА                       ║
!║ Проект     : ГАЛАКТИКА                                                    ║
!║ Система    : Складской учет / Производство                                ║
!║ Версия     : 5.85                                                         ║
!║ Назначение : MX-20 (Отчет о движении товарно-материальных ценностей       ║
!║                     в местах хранения)                                    ║
!║ Разработал : Макс Голдин                                                  ║
!║ Параметры  : SkPr (0 - Склад, 1 - Производство                            ║
!╚═══════════════════════════════════════════════════════════════════════════╝



#doc
MX-20 (Отчет о движении товарно-материальных ценностей
в местах хранения)
#end
.form 'MX20'
.hide
#include format2.frn
.var
  God :String[4];
.endvar
.begin
  God :=DateToStr(Cur_Date, 'YYYY');
end.
.fields
  Номер_накладной

  Дата_начала :Date
  Дата_окончания :Date

  Организация
  Организация_УНН
  Организация_ОКПО
  Организация_ОКДП
  Организация_Банк

  Подразделение

  МОЛ_ФИО
  МОЛ_табельный_номер
  МОЛ_должность

  Валюта
  СимВалюты
  Цена_Округл :integer
  Цена_Округл_Стр :string

!.{
   Наименование_МЦ
   Бар_код_МЦ
   Учетная_ед_измер

   Средняя_цена_на_начало_в_валюте :Double
   Количество_на_начало :Double
   Сумма_на_начало_в_валюте :Double

   Количество_прихода :Double
   Сумма_прихода_в_валюте :Double

   Количество_расхода :Double
   Сумма_расхода_в_валюте :Double
!.}
.endfields
  Номер_накладной  ^

  Дата_начала      ^
  Дата_окончания   ^

  Организация       ^
  Организация_УНН   ^
  Организация_ОКПО  ^
  Организация_ОКДП  ^
  Организация_Банк  ^

  Подразделение     ^

  МОЛ_ФИО              ^
  МОЛ_табельный_номер  ^
  МОЛ_должность        ^

  Валюта               ^
  СимВалюты            ^
  Цена_Округл          ^
  Цена_Округл_Стр      ^
.{
   ============================================================================
   Наименование_МЦ   ^
   Бар_код_МЦ        ^
   Учетная_ед_измер  ^

   Средняя_цена_на_начало_в_валюте  ^
   Количество_на_начало             ^
   Сумма_на_начало_в_валюте         ^

   Количество_прихода               ^
   Сумма_прихода_в_валюте           ^

   Количество_расхода               ^
   Сумма_расхода_в_валюте           ^
.}
.endform




!******************************************************************************
!******************************************************************************
!******************************************************************************
#doc
Типовая форма
#end
.LinkForm 'MX20_01' prototype is MX20
.NameInList '1. Типовая форма'
.DEFO LANDSCAPE
.p 55
.Set Filler ='-'
.fields
  CommonFormHeader
.endfields
^
.var
  NomPp, NomList :Word;
  ItogOstBeg1, ItogPrih1, ItogRash1 :Double;
  ItogOstBeg2, ItogPrih2, ItogRash2 :Double;
.endvar
.begin
  NomPp       := 0;
  NomList     := 1;
  ItogOstBeg1 := 0.0;
  ItogPrih1   := 0.0;
  ItogRash1   := 0.0;
  ItogOstBeg2 := 0.0;
  ItogPrih2   := 0.0;
  ItogRash2   := 0.0;
end.
.fields
  Организация
  Организация_ОКПО
  Подразделение
  Организация_ОКДП

  Номер_накладной
  DateToStr(Cur_date,       'DD/MM/YYYY')
  DateToStr(Дата_начала,    'DD/MM/YYYY')
  DateToStr(Дата_окончания, 'DD/MM/YYYY')

  МОЛ_должность + if(МОЛ_должность <> '', ', ', '') + МОЛ_ФИО
.endfields
 Р                                                                                                                                                               ┌───────────────────┐ Р
 РОрганизация    Г@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Г  по ОКПО │@~@@@@@@@@@@@@@@@@@│ Р
 Р              ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤ Р
 РПодразделение  Г@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Г │                   │ Р
 Р              ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤ Р
 Р                                                                                                                                      Вид деятельности по ОКДП │@~@@@@@@@@@@@@@@@@@│ Р
 Р                                                                                                                                                               └───────────────────┘ Р
                      ┌───────────────┬───────────┬─────────────────────┐
                      │     Номер     │   Дата     Д│   Отчетный период   │ Д
                      │   документа   │составления│     c    │    по    │
                      ├───────────────┼───────────┼──────────┼──────────┤
                ОТЧЕТ │@~@@@@@@@@@@@@@│ @@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│
                      └───────────────┴───────────┴──────────┴──────────┘
                О ДВИЖЕНИИ ТОВАРНО - МАТЕРИАЛЬНЫХ ЦЕННОСТЕЙ
                             В МЕСТАХ ХРАНЕНИЯ

 РМатериально ответственное лицо:  З @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З Р
.fields
  DateToStr(Дата_начала,    'DD/MM/YYYY')
  DateToStr(Дата_окончания, 'DD/MM/YYYY')

  СимВалюты
  СимВалюты
  СимВалюты
  СимВалюты
  СимВалюты
.endfields
 Ш┌─────┬─────────────────────────────────────────────────┬───────────────────┬──────────────┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┐ Ш
 Ш│     │          Товарно-материальные ценности          │ Единица измерения │              │    Остаток на @@@@@@@@@@    │           Приход            │           Расход            │    Остаток на @@@@@@@@@@    │ Ш
 Ш│  №  ├───────────────────────────────────┬─────────────┼───────────┬───────┤ Учетная цена,├────────────┬────────────────┼────────────┬────────────────┼────────────┬────────────────┼────────────┬────────────────┤ Ш
 Ш│ п/п │   наименование, характеристика    │     код     │   наиме-  │ код по│@~@@@@@@@@@@@@│ количество │     сумма,     │ количество │     сумма,     │ количество │     сумма,     │ количество │     сумма,     │ Ш
 Ш│     │                                   │             │  нование  │  ОКЕИ │              │            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│ Ш
 Ш├─────┼───────────────────────────────────┼─────────────┼───────────┼───────┼──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
 Ш│  1  │               2                   │      3      │     4     │   5   │      6       │     7      │       8        │     9      │       10       │     11     │       12       │     13     │       14       │ Ш
 Ш├─────┼───────────────────────────────────┼─────────────┼───────────┼───────┼──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
.{
.[h Skip
.begin
  NomList     := NomList + 1;

  ItogOstBeg1 := 0.0;
  ItogPrih1   := 0.0;
  ItogRash1   := 0.0;
end.
.fields
  DateToStr(Дата_начала,    'DD/MM/YYYY')
  DateToStr(Дата_окончания, 'DD/MM/YYYY')

  СимВалюты
  СимВалюты
  СимВалюты
  СимВалюты
  СимВалюты
.endfields
  БЛист@NP@ Б
 Ш┌─────┬─────────────────────────────────────────────────┬───────────────────┬──────────────┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┐ Ш
 Ш│     │          Товарно-материальные ценности          │ Единица измерения │              │    Остаток на @@@@@@@@@@    │           Приход            │           Расход            │    Остаток на @@@@@@@@@@    │ Ш
 Ш│  №  ├───────────────────────────────────┬─────────────┼───────────┬───────┤ Учетная цена,├────────────┬────────────────┼────────────┬────────────────┼────────────┬────────────────┼────────────┬────────────────┤ Ш
 Ш│ п/п │   наименование, характеристика    │     код     │   наиме-  │ код по│@~@@@@@@@@@@@@│ количество │     сумма,     │ количество │     сумма,     │ количество │     сумма,     │ количество │     сумма,     │ Ш
 Ш│     │                                   │             │  нование  │  ОКЕИ │              │            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│ Ш
 Ш├─────┼───────────────────────────────────┼─────────────┼───────────┼───────┼──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
 Ш│  1  │               2                   │      3      │     4     │   5   │      6       │     7      │       8        │     9      │       10       │     11     │       12       │     13     │       14       │ Ш
 Ш├─────┼───────────────────────────────────┼─────────────┼───────────┼───────┼──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
.]h
.begin
  NomPp       := NomPp + 1;
  ItogOstBeg1 := ItogOstBeg1 + Round(Сумма_на_начало_в_валюте, Цена_Округл);
  ItogPrih1   := ItogPrih1   + Round(Сумма_прихода_в_валюте,   Цена_Округл);
  ItogRash1   := ItogRash1   + Round(Сумма_расхода_в_валюте,   Цена_Округл);
  ItogOstBeg2 := ItogOstBeg2 + Round(Сумма_на_начало_в_валюте, Цена_Округл);
  ItogPrih2   := ItogPrih2   + Round(Сумма_прихода_в_валюте,   Цена_Округл);
  ItogRash2   := ItogRash2   + Round(Сумма_расхода_в_валюте,   Цена_Округл);
end.
.fields
   NomPp

   Наименование_МЦ
   Бар_код_МЦ
   Учетная_ед_измер

   //Остаток на начало периода
   DoubleToStr(Средняя_цена_на_начало_в_валюте, Цена_Округл_Стр)
   DoubleToStr(Количество_на_начало, Kol_Pr)
   DoubleToStr(Сумма_на_начало_в_валюте, Цена_Округл_Стр)

   //Приход
   DoubleToStr(Количество_прихода, Kol_Pr)
   DoubleToStr(Сумма_прихода_в_валюте, Цена_Округл_Стр)

   //Расход
   DoubleToStr(Количество_расхода, Kol_Pr)
   DoubleToStr(Сумма_расхода_в_валюте, Цена_Округл_Стр)

   //Остаток на конец периода
   DoubleToStr(Round(Количество_на_начало, wKol_Pr) +
               Round(Количество_прихода,   wKol_Pr) -
               Round(Количество_расхода,   wKol_Pr), Kol_Pr)
   DoubleToStr(Round(Сумма_на_начало_в_валюте, Цена_Округл) +
               Round(Сумма_прихода_в_валюте,   Цена_Округл) -
               Round(Сумма_расхода_в_валюте,   Цена_Округл), Цена_Округл_Стр)
.endfields
 Ш│&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&│@~@@@@@@@@@│       │&#'&&&&&&&&&&&│&#'&&&&&&&&&│&#'&&&&&&&&&&&&&│&#'&&&&&&&&&│&#'&&&&&&&&&&&&&│&#'&&&&&&&&&│&#'&&&&&&&&&&&&&│&#'&&&&&&&&&│&#'&&&&&&&&&&&&&│ Ш
.[f
.fields
  DoubleToStr(ItogOstBeg1, Цена_Округл_Стр)
  DoubleToStr(ItogPrih1,   Цена_Округл_Стр)
  DoubleToStr(ItogRash1,   Цена_Округл_Стр)
  DoubleToStr(Round(ItogOstBeg1, Цена_Округл) +
              Round(ItogPrih1,   Цена_Округл) -
              Round(ItogRash1,   Цена_Округл), Цена_Округл_Стр)
.endfields
 Ш└─────┴───────────────────────────────────┴─────────────┴───────────┴───────┴──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
 Ш                                                                                     Итого │            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│ Ш
 Ш                                                                                           └────────────┴────────────────┴────────────┴────────────────┴────────────┴────────────────┴────────────┴────────────────┘ Ш
.]f
.}
.fields
  DoubleToStr(ItogOstBeg2, Цена_Округл_Стр)
  DoubleToStr(ItogPrih2,   Цена_Округл_Стр)
  DoubleToStr(ItogRash2,   Цена_Округл_Стр)
  DoubleToStr(Round(ItogOstBeg2, Цена_Округл) +
              Round(ItogPrih2,   Цена_Округл) -
              Round(ItogRash2,   Цена_Округл), Цена_Округл_Стр)
.endfields
 Ш                                                                                           ┌────────────┬────────────────┬────────────┬────────────────┬────────────┬────────────────┬────────────┬────────────────┐ Ш
 Ш                                                                           Всего по отчету │            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│ Ш
 Ш                                                                                           └────────────┴────────────────┴────────────┴────────────────┴────────────┴────────────────┴────────────┴────────────────┘ Ш


.fields
  DoubleToStr(NomPp, '4\m')
  DoubleToStr(NomList, '4\m')
.endfields
 ИПриложение  З @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З документа(ов) на  З @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З листе(ах) И
 И                         количество прописью                                            количество прописью И


.fields
  МОЛ_должность
  МОЛ_ФИО
.endfields
 ИМатериально ответственное(ые) лицо(лица) И
 И                          З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@ З  _____________________   З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З И
 И                                   должность                  подпись                       расшифровка подписи И
 И                         _____________________________  _____________________  ________________________________________________ И
 И                                   должность                  подпись                       расшифровка подписи И

 И                      Отчет проверил и принял бухгалтер _____________________  ________________________________________________ И
 И                                                              подпись                       расшифровка подписи И

.fields
  God
.endfields
"___" ____________________ @@@@ года
.endform
!******************************************************************************
!******************************************************************************



!******************************************************************************
!******************************************************************************
!******************************************************************************
#doc
MX-20 (Россия)
#end
.LinkForm 'MX20_02' prototype is MX20
.NameInList '2. MX-20 (Россия)'
.DEFO LANDSCAPE
.p 55
.Set Filler ='-'
.fields
  CommonFormHeader
.endfields
^
.var
  NomPp, NomList :Word;
  ItogOstBeg1, ItogPrih1, ItogRash1 :Double;
  ItogOstBeg2, ItogPrih2, ItogRash2 :Double;
.endvar
.begin
  NomPp       := 0;
  NomList     := 1;
  ItogOstBeg1 := 0.0;
  ItogPrih1   := 0.0;
  ItogRash1   := 0.0;
  ItogOstBeg2 := 0.0;
  ItogPrih2   := 0.0;
  ItogRash2   := 0.0;
end.
.fields
  Организация
  Организация_ОКПО
  Подразделение
  Организация_ОКДП

  Номер_накладной
  DateToStr(Cur_date,       'DD/MM/YYYY')
  DateToStr(Дата_начала,    'DD/MM/YYYY')
  DateToStr(Дата_окончания, 'DD/MM/YYYY')

  МОЛ_должность + if(МОЛ_должность <> '', ', ', '') + МОЛ_ФИО
.endfields
 Р                                                                                                                                               Унифицированная форма №  MX-20 Р
 Р                                                                                                                                               Утверждена постановлением Госкомстата Р
 Р                                                                                                                                               России от 09.08.1999 г. № 66 Р
 Р                                                                                                                                                               ┌───────────────────┐ Р
 Р                                                                                                                                                               │        Код        │ Р
 Р                                                                                                                                                               ├───────────────────┤ Р
 Р                                                                                                                                                 Форма по ОКУД │      0335020      │ Р
 Р                                                                                                                                                               ├───────────────────┤ Р
 РОрганизация    Г@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Г  по ОКПО │@~@@@@@@@@@@@@@@@@@│ Р
 Р              ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤ Р
 РПодразделение  Г@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Г │                   │ Р
 Р              ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤ Р
 Р                                                                                                                                      Вид деятельности по ОКДП │@~@@@@@@@@@@@@@@@@@│ Р
 Р                                                                                                                                                      ┌────────┼───────────────────┤ Р
 Р                                                                                                                                                      │ склад  │                   │ Р
 Р                                                                                                                                                      ├────────┼───────────────────┤ Р
 Р                                                                                                                                                      │ камера │                   │ Р
 Р                                                                                                                                                      ├────────┼───────────────────┤ Р
 Р                                                                                                                                                      │ секция │                   │ Р
 Р                                                                                                                                                      └────────┼───────────────────┤ Р
 Р                                                                                                                                                  Вид операции │                   │ Р
 Р                                                                                                                                                               └───────────────────┘ Р
                      ┌───────────────┬───────────┬─────────────────────┐
                      │     Номер     │   Дата     Д│   Отчетный период   │ Д
                      │   документа   │составления│     c    │    по    │
                      ├───────────────┼───────────┼──────────┼──────────┤
                ОТЧЕТ │@~@@@@@@@@@@@@@│ @@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│
                      └───────────────┴───────────┴──────────┴──────────┘
                О ДВИЖЕНИИ ТОВАРНО - МАТЕРИАЛЬНЫХ ЦЕННОСТЕЙ
                             В МЕСТАХ ХРАНЕНИЯ

 РМатериально ответственное лицо:  З @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З Р
.fields
  DateToStr(Дата_начала,    'DD/MM/YYYY')
  DateToStr(Дата_окончания, 'DD/MM/YYYY')

  СимВалюты
  СимВалюты
  СимВалюты
  СимВалюты
  СимВалюты
.endfields
 Ш┌─────┬─────────────────────────────────────────────────┬───────────────────┬──────────────┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┐ Ш
 Ш│     │          Товарно-материальные ценности          │ Единица измерения │              │    Остаток на @@@@@@@@@@    │           Приход            │           Расход            │    Остаток на @@@@@@@@@@    │ Ш
 Ш│  №  ├───────────────────────────────────┬─────────────┼───────────┬───────┤ Учетная цена,├────────────┬────────────────┼────────────┬────────────────┼────────────┬────────────────┼────────────┬────────────────┤ Ш
 Ш│ п/п │   наименование, характеристика    │     код     │   наиме-  │ код по│@~@@@@@@@@@@@@│ количество │     сумма,     │ количество │     сумма,     │ количество │     сумма,     │ количество │     сумма,     │ Ш
 Ш│     │                                   │             │  нование  │  ОКЕИ │              │            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│ Ш
 Ш├─────┼───────────────────────────────────┼─────────────┼───────────┼───────┼──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
 Ш│  1  │               2                   │      3      │     4     │   5   │      6       │     7      │       8        │     9      │       10       │     11     │       12       │     13     │       14       │ Ш
 Ш├─────┼───────────────────────────────────┼─────────────┼───────────┼───────┼──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
.{
.[h Skip
.begin
  NomList     := NomList + 1;

  ItogOstBeg1 := 0.0;
  ItogPrih1   := 0.0;
  ItogRash1   := 0.0;
end.
.fields
  DateToStr(Дата_начала,    'DD/MM/YYYY')
  DateToStr(Дата_окончания, 'DD/MM/YYYY')

  СимВалюты
  СимВалюты
  СимВалюты
  СимВалюты
  СимВалюты
.endfields
  БЛист@NP@ Б
 Ш┌─────┬─────────────────────────────────────────────────┬───────────────────┬──────────────┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┐ Ш
 Ш│     │          Товарно-материальные ценности          │ Единица измерения │              │    Остаток на @@@@@@@@@@    │           Приход            │           Расход            │    Остаток на @@@@@@@@@@    │ Ш
 Ш│  №  ├───────────────────────────────────┬─────────────┼───────────┬───────┤ Учетная цена,├────────────┬────────────────┼────────────┬────────────────┼────────────┬────────────────┼────────────┬────────────────┤ Ш
 Ш│ п/п │   наименование, характеристика    │     код     │   наиме-  │ код по│@~@@@@@@@@@@@@│ количество │     сумма,     │ количество │     сумма,     │ количество │     сумма,     │ количество │     сумма,     │ Ш
 Ш│     │                                   │             │  нование  │  ОКЕИ │              │            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│            │@~@@@@@@@@@@@@@@│ Ш
 Ш├─────┼───────────────────────────────────┼─────────────┼───────────┼───────┼──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
 Ш│  1  │               2                   │      3      │     4     │   5   │      6       │     7      │       8        │     9      │       10       │     11     │       12       │     13     │       14       │ Ш
 Ш├─────┼───────────────────────────────────┼─────────────┼───────────┼───────┼──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
.]h
.begin
  NomPp       := NomPp + 1;
  ItogOstBeg1 := ItogOstBeg1 + Round(Сумма_на_начало_в_валюте, Цена_Округл);
  ItogPrih1   := ItogPrih1   + Round(Сумма_прихода_в_валюте,   Цена_Округл);
  ItogRash1   := ItogRash1   + Round(Сумма_расхода_в_валюте,   Цена_Округл);
  ItogOstBeg2 := ItogOstBeg2 + Round(Сумма_на_начало_в_валюте, Цена_Округл);
  ItogPrih2   := ItogPrih2   + Round(Сумма_прихода_в_валюте,   Цена_Округл);
  ItogRash2   := ItogRash2   + Round(Сумма_расхода_в_валюте,   Цена_Округл);
end.
.fields
   NomPp

   Наименование_МЦ
   Бар_код_МЦ
   Учетная_ед_измер

   //Остаток на начало периода
   DoubleToStr(Средняя_цена_на_начало_в_валюте, Цена_Округл_Стр)
   DoubleToStr(Количество_на_начало, Kol_Pr)
   DoubleToStr(Сумма_на_начало_в_валюте, Цена_Округл_Стр)

   //Приход
   DoubleToStr(Количество_прихода, Kol_Pr)
   DoubleToStr(Сумма_прихода_в_валюте, Цена_Округл_Стр)

   //Расход
   DoubleToStr(Количество_расхода, Kol_Pr)
   DoubleToStr(Сумма_расхода_в_валюте, Цена_Округл_Стр)

   //Остаток на конец периода
   DoubleToStr(Round(Количество_на_начало, wKol_Pr) +
               Round(Количество_прихода,   wKol_Pr) -
               Round(Количество_расхода,   wKol_Pr), Kol_Pr)
   DoubleToStr(Round(Сумма_на_начало_в_валюте, Цена_Округл) +
               Round(Сумма_прихода_в_валюте,   Цена_Округл) -
               Round(Сумма_расхода_в_валюте,   Цена_Округл), Цена_Округл_Стр)
.endfields
 Ш│&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&│@~@@@@@@@@@│       │&#'&&&&&&&&&&&│&#'&&&&&&&&&│&#'&&&&&&&&&&&&&│&#'&&&&&&&&&│&#'&&&&&&&&&&&&&│&#'&&&&&&&&&│&#'&&&&&&&&&&&&&│&#'&&&&&&&&&│&#'&&&&&&&&&&&&&│ Ш
.[f
.fields
  DoubleToStr(ItogOstBeg1, Цена_Округл_Стр)
  DoubleToStr(ItogPrih1,   Цена_Округл_Стр)
  DoubleToStr(ItogRash1,   Цена_Округл_Стр)
  DoubleToStr(Round(ItogOstBeg1, Цена_Округл) +
              Round(ItogPrih1,   Цена_Округл) -
              Round(ItogRash1,   Цена_Округл), Цена_Округл_Стр)
.endfields
 Ш└─────┴───────────────────────────────────┴─────────────┴───────────┴───────┴──────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┼────────────┼────────────────┤ Ш
 Ш                                                                                     Итого │            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│ Ш
 Ш                                                                                           └────────────┴────────────────┴────────────┴────────────────┴────────────┴────────────────┴────────────┴────────────────┘ Ш
.]f
.}
.fields
  DoubleToStr(ItogOstBeg2, Цена_Округл_Стр)
  DoubleToStr(ItogPrih2,   Цена_Округл_Стр)
  DoubleToStr(ItogRash2,   Цена_Округл_Стр)
  DoubleToStr(Round(ItogOstBeg2, Цена_Округл) +
              Round(ItogPrih2,   Цена_Округл) -
              Round(ItogRash2,   Цена_Округл), Цена_Округл_Стр)
.endfields
 Ш                                                                                           ┌────────────┬────────────────┬────────────┬────────────────┬────────────┬────────────────┬────────────┬────────────────┐ Ш
 Ш                                                                           Всего по отчету │            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│            │&#'&&&&&&&&&&&&&│ Ш
 Ш                                                                                           └────────────┴────────────────┴────────────┴────────────────┴────────────┴────────────────┴────────────┴────────────────┘ Ш


.fields
  DoubleToStr(NomPp, '4\m')
  DoubleToStr(NomList, '4\m')
.endfields
 ИПриложение  З @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З документа(ов) на  З @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З листе(ах) И
 И                         количество прописью                                            количество прописью И


.fields
  МОЛ_должность
  МОЛ_ФИО
.endfields
 ИМатериально ответственное(ые) лицо(лица) И
 И                          З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@ З  _____________________   З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З И
 И                                   должность                  подпись                       расшифровка подписи И
 И                         _____________________________  _____________________  ________________________________________________ И
 И                                   должность                  подпись                       расшифровка подписи И

 И                      Отчет проверил и принял бухгалтер _____________________  ________________________________________________ И
 И                                                              подпись                       расшифровка подписи И

.fields
  God
.endfields
"___" ____________________ @@@@ года
.endform
!******************************************************************************
!******************************************************************************
