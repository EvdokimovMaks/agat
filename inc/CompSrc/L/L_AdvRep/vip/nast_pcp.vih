//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 5.85 - логистика
// Объектный интерфейс настройки отчетов по исполнению календарных планов
//********************************************************************************

#ifdef ComponentVersion
#component "L_ADVREP"
#end

#doc
Информация о текущем договоре и ПКП
#end
type TExcel_TblFldValue = Record
  Num_Date_Dog   : String;  // Номер и дата договора
  Kontr_Dog      : String;  // Контрагент_договора
  Num_Date_Sogl  : String;  // Номер_дата_соглашения
  Kontr_Sogl     : String;  // Контрагент_соглашения
  Up_Sogl        : String;  // Вышестоящее_соглашение
  Srok_Work_Beg  : Date;    // Срок_действия_с
  Srok_Work_End  : Date;    // Срок_действия_по
  Vid            : String;  // Вид
  Type_By_Valute : String;  // Тип_по_валюте
  Valuta_Doc     : String;  // Валюта_документа
  N_P_P          : String;  // Номер и дата календарного плана
  Status         : String;  // Статус
  Direct         : String;  // Направление
  Naznach        : String;  // Назначение
  Work_Beg       : Date;    // Выполнить_с
  Work_End       : Date;    // Выполнить_по
  Otv_Podrazd    : String;  // Отв_подразделение
  Plan           : Double;  // План
  Fact           : Double;  // Факт
  Otkl           : Double;  // Откл
  Proc_Work      : Double;  // Проц_вып
  Vid_Plat       : String;  // Вид_платежа
  Budget_Podrazd : String;  // Бюджет_подразд
  GrOtp          : String;  // Грузоотправитель
  GrPol          : String;  // Грузополучатель
  GrPol_State    : String;  // Страна грузополучателя
  Punkt_Otp      : String;  // Пункт отправления
  Punkt_Nazn     : String;  // Пункт назначения
  Basic          : String;  // Базис поставки
end;

#doc
Информация о фильтрах
#end
type TExcel_VarValue = Record
  // Договор
  _fDogovor, _fKontr, _fGroupDescrDG, _fDescrDG, _fCODG, _fLicoDG,
  _fVidDG, _fStatusDG, _fCross_in, _fGroupDG, _fTXODG, _fDopClassDG,
  _fKuratPodr                                                       : String;
  _fPeriod_isp_DOG_S, _fPeriod_isp_DOG_PO                           : Date;
  // Календарный план
  _fGroupDescrCP, _fDescrCP, _fCOCP, _fMoveCOCP, _fStatusCP,
  _fCross_inCP, _fNaznCP, _fTXOCP, _fIsp, _fPlat, _fPol,
  _fDiapazon_Val, _fPlatCP, _fExClassCP, _fExAttr                       : String;
  _fPeriod_isp_PCP_S, _fPeriod_isp_PCP_PO, _fDate_PCP_S, _fDate_PCP_PO  : Date;
  _fDiapazon_stoim_PCP_S, _fDiapazon_stoim_PCP_PO                       : Double;
  // Для товарных отчетов
  _fCountryGrOtp, _fGrOtp, _fPunktOtp, _fExClassOtp, _fCountryGrPol, _fGrPol,
  _fPunktPol, _fExClassPol, _fBasic, _fGrMC, _fMC, _fGrUsl, _fUsl, _fBarCode  : String;
end;

#doc
Содержит методы интерфефса выбора настройки отчета по исполнению ПКП
#end
ObjInterface Nastr_IspPCPObj;
  #doc
  Возвращает информацию о фильтрах отчета
  #end
  procedure GetNastr(__cUserDeskRep : Comp; var Excel_VarValue : TExcel_VarValue);
end;

VipInterface Nastr_IspPCP implements Nastr_IspPCPObj licensed (FREE) Parameters (NReport : Word; pNRec : Comp);
