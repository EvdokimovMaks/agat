//******************************************************************************
//                                                      (с) корпорация Галактика
// Галактика 7.12 - базовая функциональность
// Объявление объектного интерфейса для выборки информации об организиции
//******************************************************************************

#ifndef _TOTALORGANIZATIONATTRIBUTES_OBJ_INCLUDED_
#define _TOTALORGANIZATIONATTRIBUTES_OBJ_INCLUDED_

#ifdef ComponentVersion
  #component "L_KATORG"
#end

// выборка информации (юридической, нологовой и т.п.) об организации
#include OrganizationInfo.obj

// Для использовния интерфейса необходимо после описания логической таблицы
// подключить TotalOrganizationAttributes.var (объявление ссылки и создание
// нового экземпляра интерфейса).

#doc
набор методов для выборки атрибутов организации
#end
objinterface ITotalOrganizationAttributes;

  #doc
  нахождения головной организации по списку подразделений
  #end
  function Calc(Departments: longint): comp;

  #doc
  привязка к организации OrganizationRef
  #end
  procedure Bind(OrganizationRef: comp);

  #doc
  ссылка на текущую организацию
  #end
  function GetOrganizationRef: comp;

  #doc
  ссылка на юридические атрибуты организации (см. методы IOrganizationJuridicalInfo)
  #end
  function GetJuridicalInfo: IOrganizationJuridicalInfo;

#ifndef Gal9_1
  #doc
  ссылка на дополнительные юридические атрибуты организации (см. методы IOrganizationJuridicalInfo1)
  #end
  function GetJuridicalInfo1: IOrganizationJuridicalInfo1;
#end

  #doc
  ссылка на налоговые атрибуты организации (см. методы IOrganizationTaxationInfo)
  #end
  function GetTaxationInfo: IOrganizationTaxationInfo;

  #doc
  ссылка на банковские счета организации (см. методы IOrganizationAccountsInfo)
  #end
  function GetAccountsInfo: IOrganizationAccountsInfo;

  #doc
  ссылка на список банков, в которых организация имеет расчетные счета
  #end
  function GetBanksList: IOrganizationBanksList;

  #doc
  ссылка на банк по умолчанию
  #end
  function GetDefaultBank(var Value: IBankInfo): boolean;
end;

#doc
Дополнительный метод для извлечения полного имени организации
#end
objinterface ITotalOrganizationAttributesV2(ITotalOrganizationAttributes);

  #doc
  ссылка на юридические атрибуты организации (см. методы IOrganizationJuridicalInfoV2)
  #end
  function GetJuridicalInfoV2: IOrganizationJuridicalInfoV2;
end;

#doc
Дополнительный метод для извлечения полного имени организации
#end
objinterface ITotalOrganizationAttributes1;

  #doc
  Ссылка на vip-интрефейс с методом, который возвращает имя организации в зависимости от системных настроек
  #end
  function GetNaming: IOrganizationNaming;
end;

#end
