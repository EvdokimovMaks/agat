#ifndef __KATORG_VIH__
#define __KATORG_VIH__

#ifdef ComponentVersion
#component "L_KATORG"
#end

#doc
Содержит методы интерфейса каталога организаций
#end
ObjInterface KatOrgObj;
//******************************************************************************
  #doc
  удаление организации
  #end
  function DeleteKatOrgNrec(cRec_For_Delete: comp): boolean;
  /*
  GetKatOrgName
  cOrgRec - ссылка на организацию (KatOrg.nRec)
  wParam - koShortName       - возвращает наименование организации (KatOrg.Name)
         - koFullName        - возвращает тип организации (KatOrg.TipOrg) + наименование(KatOrg.Name).
             Если тип организации не задан, то результат аналогичен параметру koShortName
         - koFullNameReverse - возвращает наименование организации (KatOrg.Name) + тип (KatOrg.TipOrg).
             Если тип организации не задан, то результат аналогичен параметру koShortName
         - koTipOrg          - возвращает тип организации (KatOrg.TipOrg)
         - koOnTune          - возвращает наименование организации
                               в зависимости от значения настройки 'Rep.KatOrgName'
                               "=Настройка=\Настройка\Отчеты, расчеты\Представление наименования организаций при печати документов"
         - koOnBank          - возвращает наименование организации из внешнего атрибута 'Наименование организации' по банку
         - koOnKauStruct     - возвращает наименование организации по настройке структуры КАУ для организации
  */
//******************************************************************************
  #doc
  получение наименования организации

  cOrgRec - ссылка на организацию (KatOrg.nRec)
  wParam - koShortName       - возвращает наименование организации (KatOrg.Name)
         - koFullName        - возвращает тип организации (KatOrg.TipOrg) + наименование(KatOrg.Name).
             Если тип организации не задан, то результат аналогичен параметру koShortName
         - koFullNameReverse - возвращает наименование организации (KatOrg.Name) + тип (KatOrg.TipOrg).
             Если тип организации не задан, то результат аналогичен параметру koShortName
         - koTipOrg          - возвращает тип организации (KatOrg.TipOrg)
         - koOnTune          - возвращает наименование организации
                               в зависимости от значения настройки 'Rep.KatOrgName'
                               "=Настройка=\Настройка\Отчеты, расчеты\Представление наименования организаций при печати документов"
         - koOnBank          - возвращает наименование организации из внешнего атрибута 'Наименование организации' по банку
         - koOnKauStruct     - возвращает наименование организации по настройке структуры КАУ для организации
  #end
  function GetKatOrgName(cOrgRec: comp; wParam :word): string;
//******************************************************************************
  #doc
  получение полного адреса организации
  #end
  //полный адрес организации
  function FullOrgAddr(cOrgRec: comp): string;
//******************************************************************************
  #doc
  проверка корректности контрольного ключа
  #end
  function CalcKey(Schet : string) : byte;
//******************************************************************************
  #doc
  проверка корректности р/с по контрольному ключу
  #end
  function CheckSchet(IsKredOrg : boolean; BIK, Schet : string; var TrueKey : char) : boolean;
//******************************************************************************
end;

#doc
Содержит методы интерфейса каталога организаций
#end
ObjInterface KatOrgObjV2(KatOrgObj);
//******************************************************************************
  #doc
  получение доп. информации по организации

  cOrg      - ссылка на организацию (KatOrg.nRec)
  sTypeInfo - возвращаемая информация:
              UNN         - ИНН
              KodPlatNDS  - КПП
              Code        - Код организации
  #end

  Function GetOrgInfo(pOrg : comp; sTypeInfo : String): String;
//******************************************************************************
end;

#define _CheckKon_VIH_

#doc
Содержит метод проверки задолженности контрагента на максимально допустимую
#end
ObjInterface CheckKonObj;
//******************************************************************************
  #doc
  проверка задолженности контрагента на максимально допустимую
  #end
  Function CheckDolgKon (var c1 : comp;      // код контрагента
                         var d1 : date;      // дата проверки
                         var sDoc : double;  // итоговая сумма по ДО
                         var vDoc : comp     // валюта ДО
                         ) : boolean;
end;

#doc
Содержит новый метод проверки задолженности контрагента на максимально допустимую
#end
ObjInterface CheckKonObj_Ex;
//******************************************************************************
  #doc
  проверка задолженности контрагента на максимально допустимую
  #end
/*
  bNeedMes  - отображать или нет сообщения
  pKatOrg   - ссылка на контрагента
  dCheck    - дата проверки
  SumDoc    - сумма документа
  pValDoc   - валюта документа
  MaxSumNDE - максимальная сумма для контрагента
  MaxSumValBase - максимальная сумма в базавой валюте

  Результат - TRUE  - контрагенту разрешено формировать документ на сумму SumDoc в валюте pValDoc на дату dCheck
*/
Function CheckKon_GetDolg(bNeedMes : boolean; pKatOrg : comp; dCheck : date; SumDoc : double; pValDoc : comp; var MaxSumNDE, MaxSumValBase : double) : boolean;

end;

#define _CheckLinks_VIH_

#doc
Содержит метод проверки на входимость организации в группу нулевого уровня
#end
ObjInterface CheckLinksObj;
//******************************************************************************
  #doc
  проверка на входимость организации в группу нулевого уровня
  #end
  function CheckLinks(cotbl:word):boolean;
end;

//------------------------------------------------------------------------------
// набор вспомогательных методов
//------------------------------------------------------------------------------
#doc
Содержит методы проверки корректности ввода атрибутов организации
#end
objinterface IKatOrgHelpers;
//******************************************************************************
  #doc
  проверка корректности ввода ОКПО
  #end
  function CheckKatOrgOKPO(sOKPO: s20; pOrg: comp): boolean;
//******************************************************************************
  #doc
  проверка корректности ввода кода плательщика НДС
  #end
  function CheckKatOrgKodPlatNDS(sKodPlatNDS: s20; pOrg: comp): boolean;
//******************************************************************************
  #doc
  проверка корректности ввода УНН с учетом страны и кода плательщика НДС
  #end
  function CheckKatOrgNameUNNInState(sName: tNameOrg; sUNN, sKodPlatNDS: s20; pState, pOrg: comp) : boolean;
//******************************************************************************
  #doc
  проверка корректности ввода ОКПО по количеству знаков
  #end
  function CheckKolSign(sUNN: s20): boolean;
//******************************************************************************
  #doc
  проверка корректности ввода УНН
  #end
  Function CheckKatOrgUNN(sUNN: s20; pOrg: comp): boolean;
//******************************************************************************
  #doc
  проверка корректности ввода кода плательщика НДС с учетом УНН и наименования
  #end
  Function CheckKatOrgKIN(sName : tNameOrg; sUNN, sKodPlatNDS : s20; pOrg : comp) : boolean;
//******************************************************************************
  #doc
  проверка корректности ввода кода плательщика НДС с учетом УНН
  #end
  Function CheckKatOrgUNNKodPlatNDS(sUNN, sKodPlatNDS : s20; pOrg : comp) : boolean;
//******************************************************************************
end;

VipInterface KatOrg implements KatOrgObjV2
                             , CheckLinksObj
                             , CheckKonObj
                             , CheckKonObj_Ex
                             , IKatOrgHelpers
licensed (FREE) Parameters (c1, c2 : comp; param : word);
Static:
  #doc
  получение наименования организации в зависимости от значения настройки 'Rep.KatOrgName'
  "=Настройка=\Настройка\Отчеты, расчеты\Представление наименования организаций при печати документов"
  #end
  function GetKatOrgName4Rep(cOrgRec: comp): string;
end;

ExtensionPoint epDeleteKatOrg(cKatOrg : comp);

#end // __KATORG_VIH__
