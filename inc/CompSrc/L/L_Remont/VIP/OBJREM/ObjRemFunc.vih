//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 8.1 - функции.
// Функция для ОР
//******************************************************************************


#ifdef ComponentVersion
#component "L_Remont"
#endif

//******************************************************************************

#doc
Функция для норм ремонтов

для использования необходимо
запускать методы объектного интерфейса через переменную:
vo_ObjRemFunc.
#end

ObjInterface objObjRemFuncV1;
//------------------------------------------------------------------------------

#doc
автоформирование кода ОР
#end

Function fncFormKodOr(_ObjRem_NRec: comp; _vwParam: word; _vwParam2: word): string;
//------------------------------------------------------------------------------
#doc
удаление последего номера автоинкрементируемой части
#end

Function fncDelLastNum(_ObjRem_NRec: comp; _vwParam: word): boolean;
//------------------------------------------------------------------------------

#doc
взять значение атрибута
#end

Function fncGetKlass(_ObjRem_NRec: comp; _vwKlass: word): comp;

//------------------------------------------------------------------------------

#doc
установить значение атрибута
#end

Procedure prcSetKlass(_ObjRem_NRec: comp; _vwKlass: word; _vcKlass: comp);

//------------------------------------------------------------------------------

#doc
взять значение атрибута для картинки
#end

Function fncGetKlassIcon(_ObjRem_NRec: comp; _vwKlass: word): string;


//------------------------------------------------------------------------------

#doc
установить значение атрибута для картинки
#end

Procedure prcSetKlassIcon(_ObjRem_NRec: comp; _vwKlass: word; _vsKlass: string);

//------------------------------------------------------------------------------

#doc
Сохранение истории ОР
#end

Procedure SetHistory(_vwNRec: comp; _vwTable, _vwTip: word; _vcOld, _vcNew: comp);

//------------------------------------------------------------------------------


#doc
взять значение ДРК
#end

Function fncGetObjRem_DRK(_ObjRem_NRec: comp): double;

//------------------------------------------------------------------------------

#doc
установить значение ДРК
#end

Procedure prcSetObjRem_DRK(_ObjRem_NRec: comp; _vfObjRem_DRK: double);

//------------------------------------------------------------------------------

#doc
взять значение ремонтная сложность
#end

Function fncGetObjRem_RS(_ObjRem_NRec: comp): double;

//------------------------------------------------------------------------------

#doc
установить значение ремонтная сложность
#end

Procedure prcSetObjRem_RS(_ObjRem_NRec: comp; _vfObjRem_RS: double);

//------------------------------------------------------------------------------

#doc
взять значение ДРК из заявки
#end

Function fncGetZRem_DRK(_BaseDoc_NRec: comp): double;

//------------------------------------------------------------------------------

#doc
установить значение ДРК для заявки
#end

Procedure prcSetZRem_DRK(_BaseDoc_NRec: comp; _vfZRem_DRK: double);

//------------------------------------------------------------------------------

#doc
взять значение ремонтная сложность из заявки
#end

Function fncGetZRem_RS(_BaseDoc_NRec: comp): double;

//------------------------------------------------------------------------------

#doc
установить значение ремонтная сложность для заявки
#end

Procedure prcSetZRem_RS(_BaseDoc_NRec: comp; _vfZRem_RS: double);

//------------------------------------------------------------------------------

#doc
взять значение ссылки на шаблон 
#end

Function fncGetObjRem_Sh(_ObjRem_NRec: comp): comp;

//------------------------------------------------------------------------------

#doc
установить значение ссылки на шаблон 
#end

Procedure prcSetObjRem_Sh(_ObjRem_NRec: comp; _vcObjRem_Sh: comp);

//------------------------------------------------------------------------------

#doc
поиск шаблона по параметрам
#end

Function fncSeekObjRem_Sh(vwParam: word; vcParam1, vcParam2, vcParam3: comp): comp;

//------------------------------------------------------------------------------

#doc
взять значение атрибута
#end

Function fncGetObjRemShAttr(_ObjRem_NRec: comp; _vwObjRemShAttr: word): longint;

//------------------------------------------------------------------------------

#doc
установить значение атрибута
#end

Procedure prcSetObjRemShAttr(_ObjRem_NRec: comp; _vwObjRemShAttr: word; _vcObjRemShAttr: longint);

//------------------------------------------------------------------------------


#doc
Формирование ОР, шаблона через друг друга
#end

Procedure prcFormObjRemSh(vwParam: word; _ObjRem_NRec_In, _ObjRem_NRec_From: comp);

//------------------------------------------------------------------------------

#doc
обновление данных в ОР из шаблона
#end

Procedure prcUpdateORFromORSH(vwParam: word; _ObjRem_NRec_From: comp);


//------------------------------------------------------------------------------

#doc
можно ли редактировать группу ОР в шаблоне
#end

Function fncCanEditObjRemShByGr(_ObjRem_NRec_From: comp): boolean;

//------------------------------------------------------------------------------

#doc
проверка является ли первый вышестоящим для второго
#end

Function fncORSub(_ObjRem_NRec, _ObjRem_NRec_Sub: comp): boolean;

//------------------------------------------------------------------------------

#doc
выведет наименование цеха
#end
    
Function fncGetCeh(_ObjRem_NRec: comp): string;

//------------------------------------------------------------------------------

#doc
выведет наименование цеха по подразделению
#end
    
Function fncGetCehP(_KatPodr_NRec: comp): string;
//------------------------------------------------------------------------------
#doc
выведет NRec цеха
#end

Function fncGetCehNRec(_ObjRem_NRec: comp): comp;
//------------------------------------------------------------------------------
#doc
выведет NRec цеха по подразделению
#end

Function fncGetCehNRecP(_KatPodr_NRec: comp): comp;
//------------------------------------------------------------------------------

#doc
выведет инвентарный номер или из ОС (KatOS) или из ObRemOS
#end

Function fncInvNumOR(_ObjRem_NRec: comp): string;

//------------------------------------------------------------------------------
#doc
выведет NREC исполнителя в иерархии по текущему исполнителю _IspRem_NRec определенного уровня _vwLevel,
где _vwLevel = 1 - самый верхний уровень
#end

Function fncGetIspNRecLevel(_IspRem_NRec: comp; _vwLevel: word): comp;
//------------------------------------------------------------------------------

#doc
вернет количество ОР для документов
#end

Function fncGetORKol(_ObjRem_NRec: comp): double;

//------------------------------------------------------------------------------

#doc
выведет код цеха по подразделению
#end

Function fncGetKodCehP(_KatPodr_NRec: comp): string;

//------------------------------------------------------------------------------

#doc
коррекnировка позиции ОР в иерархии на ObjRemDescr
_ObjRem_NRec - ОР.Nrec
#end

Function fncCheckObjRemIerPosition(_vwParamIer: word; _ObjRem_NRec: comp): boolean;


#doc
Возвращает допустимое рабочее время в часах для указанной машины
#end

Function fncGetAvailableWorkHours(
                                   _vcTransp: comp; // ссылка на машину/механизм в таблице Transp (Transp.nRec)
                                   _vdFromDate,     // дата, с которой (включительно) необходимо задействовать машину/механизм
                                   _vdToDate: date  // дата, по которую (включительно) необходимо задействовать машину/механизм
                                 ): double; // Возвращает допустимое рабочее время в часах для указанной машины/механизма.

//------------------------------------------------------------------------------

end;

//******************************************************************************

#doc
Функция для ОР

для использования необходимо
запускать методы объектного интерфейса через переменную:
vo_ObjRemFunc.
#end

VipInterface ObjRemFuncV1 implements objObjRemFuncV1
#ifdef ATL51
  licensed (FREE)
#endif
;

//******************************************************************************
