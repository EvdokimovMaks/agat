//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 8.1 - функции.
// Функция для графиков ремонтов
//******************************************************************************


//******************************************************************************

#ifdef ComponentVersion
#component "L_Remont"
#end

//******************************************************************************

#doc
Функция для графиков ремонтов

для использования необходимо
запускать методы объектного интерфейса через переменную:
vo_GrafRemFunc.
#end

ObjInterface objGrafRemFuncV1;

//------------------------------------------------------------------------------

#doc
расчет продолжительности
в часах между двумя датами
#end

Function fncCalcRemontDuration(dStart, dEnd: date; startTime, endTime: time; dblHourRem: double): double;

//------------------------------------------------------------------------------

#doc
установка фактической даты и времени в графике
первый параметр (_wvParam):
0 - обнуление
1 - установка с выдачей сообщений
2 - установка без сообщений
#end

Procedure prcGrafRemSynhronDate(_wvParam       : word;
                                _vcGrafRemNrec : comp;
                                _GrafRemDateNF
                              , _GrafRemDateKF : date;
                                _GrafRemTimeNF
                              , _GrafRemTimeKF : time);


//------------------------------------------------------------------------------

#doc
установка плановых дат в связанных графиках
первый параметр (_wvParam):
1 - дата начала
2 - дата окончания
#end

Procedure prcGrafRemSynhronDateByKur(_wvParam       : word;
                                     _vcGrafRemNrec : comp;
                                     _GrafRemDateOld
                                   , _GrafRemDateNew: date;
                                     _GrafRemTimeOld
                                   , _GrafRemTimeNew: time);


//------------------------------------------------------------------------------

#doc
Перепробег
получение
#end
Function fncGetPereprobeg(_vcGrafRemNrec: comp): integer;


//------------------------------------------------------------------------------

#doc
Перепробег
Установка
#end

Procedure prcSetPereprobeg(_vcGrafRemNrec: comp; _viPereprobeg: integer);

//------------------------------------------------------------------------------
#doc
// Установка содержания мемо поля по актам вып. ремонтов
#end

Procedure prcSetMemoInfoFromAkts(_vcGrafRemNrec: comp; _vwParam: word);

//------------------------------------------------------------------------------

end;

//******************************************************************************

#doc
Функция для графиков ремонтов

для использования необходимо
запускать методы объектного интерфейса через переменную:
vo_GrafRemFunc.
#end

VipInterface GrafRemFuncV1 implements objGrafRemFuncV1
#ifdef ATL51
  licensed (FREE)
#end
;

//******************************************************************************
