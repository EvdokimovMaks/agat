//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Логистика
// Дополнительные единицы измерения
//******************************************************************************

#define __DEI_NEW__

#ifndef __oDEI_VIH
#define __oDEI_VIH

#ifdef ComponentVersion
#component "L_MCU"
#end

#doc
Объектный интерфейс описывает методы доступа к дополнительным единицам измерения
#end
ObjInterface iKatDopEdFunctions;
  #doc
  Функция расчета количества в ДЕИ
  #end
  function CalcValue(_wTable : word;          // код таблицы спецификации
                     _cRec   : comp;          // ссылка на запись спецификации
                     _Formula: comp;          // ссылка на SHBUSL
                     _flag   : word;          // word(3)-прямая формула word(4)-обратная
                 var _Kol    : double         // количество в отпускных
                    ): double;
  //******************************************************************************
  #doc
  Функция получения количества МЦ/услуги в активной ДЕИ
  #end
  function GetActiveDopEd(_wTable : word;     // код таблицы спецификации
                          _cRec   : comp;     // ссылка на запись спецификации
                          _wTipKol: word;     // тип количества
                          _wTiDK  : word      // Тип документа системный
                         ): string;
  //******************************************************************************
  #doc
  Функция формирования ДЕИ в спецификации документов по количеству
  в отпускных единицах. Если записи существуют, то проводится пересчет
  с новым количеством. Возвращает 0, если операция прошла успешно, не 0 - иначе
  #end
  function SetDefaultDopEd(_wTable : word;    // код таблицы спецификации
                           _cRec   : comp;    // ссылка на запись спецификации
                           _wTipKol: word;    // тип количества
                           _cMCUsl : comp;    // ссылка на МЦ/Услугу
                           _PrMC   : word;    // признак МЦ/Услуга
                           _OldKol : double;  // старое количество в отпускных единицах
                       var _Kol    : double;  // новое количество в отпускных единицах
                           lParam  :longint;  // параметры
                                              // +1 - не проверять AutoDEI
                           _wTiDK  : word     // Тип документа системный
                          ): word;
  //******************************************************************************
  #doc
  Функция копирования значений ДЕИ из одного номенклатурного документа в другой.
  Проверка на совпадение МЦ не проводится. Копирование проводится без пересчета значений ДЕИ.
  #end
  function CopyDopEd(_wTableSrc  : word;      // код таблицы спецификации источника
                     _cRecSrc    : comp;      // ссылка на запись спецификации источника
                     _wTipKolSrc : word;      // тип количества источника
                     _KolSrc     : double;    // количество источника в отпускных единицах
                     _wTableDest : word;      // код таблицы спецификации приемника
                     _cRecDest   : comp;      // ссылка на запись спецификации приемника
                     _wTipKolDest: word;      // тип количества приемника
                     _KolDest    : double;    // количество приемника в отпускных единицах
                     _wTiDK      : word       // Тип документа системный
                    ): word;
  //******************************************************************************
  #doc
  Удаление
  #end
  function SpDopEd_Delete (_wTable : word;    // код таблицы спецификации
                           _cRec   : comp;    // ссылка на запись спецификации
                           _wTiDK  : word     // Тип документа системный
                          ): word;

end;

VipInterface iKatDEI implements iKatDopEdFunctions licensed (FREE);

#end //__oDEI_VIH
