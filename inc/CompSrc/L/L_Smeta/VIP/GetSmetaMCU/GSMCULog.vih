//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1
// Протокол сообщений интерфейса выбора МЦ/Услуг из смет
//------------------------------------------------------------------------------

#ifndef _GSMCULog_vih_
#define _GSMCULog_vih_

#include IModify.vih

objinterface IGSMCULog;
  property cSmSp:    comp    read write; // ссылка на позицию спецификации сметы
  property MsgType:  longint read write; // тип сообщения. константы Error, Warning, Information
  property Tag:      string  read write; // строковый идентификатор сообщения. не отображается. используется для идентификации сообщений при манипулировании (обновлении, удалении)
  property Msg:      string  read write; // текст сообщения
  property LTime:    time    read;       // время добавления в протокол. исп. для сортировки
  property TypeName: string  read;       // строковое представление типа сообщения (ОШИБКА, ПРЕДУПРЕЖДЕНИЕ, ИНФОРМАЦИЯ)

  index GSMCULog01 = cSmSp, LTime;


  function AddMessage(_cSmSp: comp; _msgType: longint; _tag: string; _msg: string): word;
  function AddErrorMessage(_cSmSp: comp; _tag: string; _msg: string): word;
  function AddWarningMessage(_cSmSp: comp; _tag: string; _msg: string): word;
  function AddInfoMessage(_cSmSp: comp; _tag: string; _msg: string): word;
  function DeleteMessages(_cSmSp: comp; _tag: string): word;
  function UpdateMessage(_cSmSp: comp; _msgType: longint; _tag: string; _msg: string): word;
  function HaveErrors(_cSmSp: comp): boolean;
end;

vipinterface GSMCULog implements IGSMCULog, IModify licensed(free);

#endif
