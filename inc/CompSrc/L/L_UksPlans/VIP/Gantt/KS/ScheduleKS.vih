//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - УКС - Управление капитальным строительством
// Менеджер проекта для плана капитального строительства
//------------------------------------------------------------------------------
#ifndef _ScheduleKS_vih_
#define _ScheduleKS_vih_

#component "L_UksPlans"

#include UksSchedule.vih // Менеджер проекта (плана работ)
#include CacheValues.vih // Кэширование показателей плана

#doc
Менеджер проекта для плана капитального строительства
#end
ObjInterface IScheduleKS(IUksSchedule);

  property pCache: CacheValues read; //#docl ссылка на экземпляр объекта кэширования показателей плана

  #doc
  Тип показателей, используемый для расчета процента завершенности
  #end
  Property iComplTip: integer read;

//------------------------------------------------------------------------------
  #doc
  Инициализация параметров проекта
  #end
  Function InitProjectKS(acProject, acPeriod: comp): boolean;

  #doc
  Инициализация дополнительных параметров
  #end
  Procedure InitParam;

  #doc
  Позиционирование (создание при необходимости) на запись сведений о задаче
  #end
  Function PosTaskKS(awTable: word; acTable, acNode: comp; abPos: boolean; adBeg, adEnd: date): boolean;

  #doc
  Редактирование диаграммы Ганта
  #end
  Procedure GanttKS(acTaskInfo: comp);

End;

//------------------------------------------------------------------------------
VipInterface ScheduleKS(UksSchedule)
  implements IScheduleKS
  licensed(free);

  public:

    #doc
    Загрузка указанного набора задач
    #end  // [override]
    Function IUksSchedule.Load(awMode: word; acTaskInfo: comp): boolean;

    #doc
    Состав проекта изменился
    #end  // [override]
    Procedure IUksSchedule.Changed;

    #doc
    Расчет процента завершенности задачи
    #end  // [override]
    Function IUksSchedule.CountComplete(awTable: word; acTable: comp): word;

    #doc
    Сохранить проект в БД
    #end  // [override]
    Function IUksSchedule.SaveProject: boolean;

End;

#endif
