//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Логистика
// Формирование M ДО для N накладных
//******************************************************************************

#ifNdef __BaseDocImpExp_VIH__
#define __BaseDocImpExp_VIH__

#ifdef ComponentVersion
#component "L_MAKEDO"
#end

#doc
Объектный интерфейс описывает методы для автоматизированного экспорта\импорта ДО в\из xml
#end
ObjInterface BaseDocImpExpObj;
//******************************************************************************
  #doc
  экспорт ДО в xml
  #end
  procedure RunExport;
//******************************************************************************
  #doc
  импорт ДО из xml
  #end
  procedure RunImport;
//******************************************************************************
  #doc
  Обобщённая процедура обемена данными с Галактикой
  #end
  procedure RunArrange;
//******************************************************************************
  #doc
  #end
  procedure RunExchange;
//******************************************************************************
  #doc
  Обобщённая процедура обмена данными с Галактикой
  #end
  function NextNRecBaseDoc: string;
//******************************************************************************
  #doc
  Функция возвращает новый NRec для SpStep
  #end
  function NextNRecSpStep: string;
//******************************************************************************
  #doc
  Функция получения дексриптора пользователя по идентификатору пользователя
  #end
  function GetDescrByLogin(sLogin : string): string;
//******************************************************************************
  #doc
  Функция получения группы дексриптора пользователя по идентификатору пользователя
  #end
  function GetDesGrByLogin(sLogin : string): string;
//******************************************************************************
  #doc
  Сумма отгрузок по ДО
  #end
  function DOSum_Nakl       (sBaseDocNRec : string): string;
//******************************************************************************
  #doc
  Сумма рекламаций по ДО
  #end
  function DOSum_NaklRek    (sBaseDocNRec : string): string;
//******************************************************************************
  #doc
  Сумма задолженности отгрузок по ДО
  #end
  function DOSum_NaklDolg   (sBaseDocNRec : string): string;
//******************************************************************************
  #doc
  Сумма задолженности отгрузок с учетом рекламаций
  #end
  function DOSum_NaklDolgRek(sBaseDocNRec : string): string;
//******************************************************************************
  #doc
  Сумма всех платежей по ДО
  #end
  function DOSum_Plat       (sBaseDocNRec : string): string;
//******************************************************************************
  #doc
  Сумма входящих платежей по ДО
  #end
  function DOSum_PlatPrih   (sBaseDocNRec : string): string;
//******************************************************************************
  #doc
  Сумма исходящих платежей по ДО
  #end
  function DOSum_PlatRash   (sBaseDocNRec : string): string;
//******************************************************************************
  #doc
  Сумма задолженности по платежам по ДО
  #end
  function DOSum_PlatDolg(sBaseDocNRec : string): string;
//******************************************************************************
  #doc
  Возвращает количество в ЕИ из SpStep (SpStep.cOtpEd)
  #end
  function Get_OtgrKol   (sSpStepnRec : string):string;
//******************************************************************************
  #doc
  Возвращает количество в ЕИ из SpStep (SpStep.cOtpEd)
  #end
  function Get_OplKol    (sSpStepnRec : string):string;
//******************************************************************************
  #doc
  Возвращает сумму в НДЕ
  #end
  function Get_OplSummNDE(sSpStepnRec : string):string;
//******************************************************************************
  #doc
  Возвращает сумму в валюте из SpStep (SpStep.cVal)
  #end
  function Get_OplSummVal(sSpStepnRec : string):string;
//******************************************************************************
  #doc
  Возвращает номер накладной
  #end
  function Get_nSopr(sSpStepnRec : string):string;
//******************************************************************************
  #doc
  Возвращает дату накладной
  #end
  function Get_dSopr(sSpStepnRec : string):string;
//******************************************************************************
  #doc
  Возвращает датe формирования складских ордеров
  #end
  function Get_dOpr(sSpStepnRec : string):string;
//******************************************************************************
  #doc
  Возвращает наименование партий из связанных накладных
  #end
  function Get_SpSoprPartyName(sSpStepnRec : string):string;
//******************************************************************************
end;

VipInterface BaseDocImpExp implements BaseDocImpExpObj licensed(FREE);
#endif