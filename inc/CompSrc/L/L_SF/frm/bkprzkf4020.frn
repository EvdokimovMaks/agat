/*
╔═══════════════════════════════════════════════════════════════════════════╗
║                     (c) 1994,2000 корпорация ГАЛАКТИКА                    ║
║ Проект        : ГАЛАКТИКА                                                 ║
║ Система       : Оперативный контур                                        ║
║ Версия        : 5.8                                                       ║
║ Назначение    : Книга продаж/покупок (переходные формы, с 01.01.2004)     ║
║ Ответственный : Полежай Алексей Геннадьевич                               ║
╚═══════════════════════════════════════════════════════════════════════════╝
*/
!//\\//\//\\//\\//\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
!#doc
!Книга продаж сводная по всем валютам (c 01.01.2004)
!#end
.linkform 'BkPrZkF_4020_20' prototype is 'BkPrZkF'
.NameInList 'Книга продаж (для МВК)'
.Group 'Продажи (МВК)'
.set filler '-'
.var
  npp: longint;
.endvar
.P 60
.defo landscape
.begin
  npp := 0;
end.
.{CheckEnter FiltKontr
.}
.{CheckEnter FiltTip
.}
.{CheckEnter FiltPodr
.}
.{
.{CheckEnter BkPrZkVal
.{CheckEnter BkPrZkMain
.if TipUsersGroup
.end
.if PodrGroup
.end
.if GroupBKObjectStroi
.end
.if KatOrgGroup
.end
.if DesGrGroup
.end
.{CheckEnter BookZk
.}
.begin
  npp++;
end.
.fields
 Oem2Ansi(string(npp))
 Oem2Ansi(DateToStr(DatFact,'DD/MM/YYYY'))
 Oem2Ansi(NomSF)
 Oem2Ansi(KontrNameNazn)
 Oem2Ansi(KontrINN)
 Oem2Ansi(KontrKPP)
 Oem2Ansi(if (longint(DatOpl) = 0, '', DateToStr(DatOpl,'DD/MM/YYYY')))
 Oem2Ansi(string(SummA))
 Oem2Ansi(string(if(not isNDS20, Summ1, 0))) Oem2Ansi(string(if(not isNDS20, Summ2, 0)))
 Oem2Ansi(string(Summ4)) Oem2Ansi(string(Summ5)) Oem2Ansi(string(Summ9))
 Oem2Ansi(string(if(isNDS20, Summ1, 0))) Oem2Ansi(string(if(isNDS20, Summ2, 0)))
 Oem2Ansi(string(Summ7))
 Oem2Ansi(PeriodUpl)
 Oem2Ansi(string(PeriodUplDop))
 Oem2Ansi(string(NumUpl))
.endfields
^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^
.}
.}
.{CheckEnter BkPrZkAllVal
.}
.}
.endform

!#doc
!Книга покупок сводная по всем валютам (с 11.05.2006)
!#end
.linkform 'BkPrZkF_4020_10' prototype is 'BkPrZkF'
.NameInList 'Книга покупок (для МВК)'
.Group 'Закупки (МВК)'
!-------------------------------------------------------------------
.set filler '-'
!-------------------------------------------------------------------
.var
  npp: longint;
.endvar
.P 60
.defo landscape
.begin
 npp := lNumFirst - 1;
end.
.{CheckEnter FiltKontr
.}
.{CheckEnter FiltTip
.}
.{CheckEnter FiltPodr
.}
.{
.{CheckEnter BkPrZkVal
.{CheckEnter BkPrZkMain
.begin
  npp++;
end.
.if TipUsersGroup
.end //if
.if PodrGroup
.end
.if GroupBKObjectStroi
.end
.if KatOrgGroup
.end
.if DesGrGroup
.end
.{CheckEnter BookZk
.}
.fields
 Oem2Ansi(string(if(pNumParam = 0, NumPP, npp)))
 Oem2Ansi(DateToStr(DatFact, 'DD/MM/YYYY'))
 Oem2Ansi(NomSF)
 Oem2Ansi(sSomeDateOplata)
 Oem2Ansi(if (longInt(DatOpr) = 0, '-', DateToStr(DatOpr, 'DD/MM/YYYY')))
 Oem2Ansi(KontrNameNazn)
 Oem2Ansi(KontrINN)
 Oem2Ansi(KontrKPP)
 Oem2Ansi(GtDCountry + if((GtDCountry = '-' or GtDCountry = ''), '', ', ') + GTDNomer)
 Oem2Ansi(string(SummA))
 Oem2Ansi(string(if(not isNDS20, Summ1, 0))) Oem2Ansi(string(if(not isNDS20, Summ2, 0)))
 Oem2Ansi(string(Summ4)) Oem2Ansi(string(Summ5)) Oem2Ansi(string(Summ9))
 Oem2Ansi(string(if(isNDS20, Summ1, 0))) Oem2Ansi(string(if(isNDS20, Summ2, 0)))
 Oem2Ansi(string(Summ7))
 Oem2Ansi(PeriodUpl)
 Oem2Ansi(string(PeriodUplDop))
 Oem2Ansi(string(NumUpl))
.endfields
^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^	^
.}
.}
.{CheckEnter BkPrZkAllVal
.}
.}
.endform
