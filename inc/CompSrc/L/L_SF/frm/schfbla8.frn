//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 8.1
// Печатные формы счетов-фактур (бланки СФ, с 01.01.2012)
//********************************************************************************

#doc
Счет-фактура (формат A4)
#end
.linkform 'Schfrees_81' prototype is 'Schfrees'
.NameInList 'Счет-фактура (формат A4), с 2012г.'
.Group 'Бланки счетов-фактур (с 24.01.2012)'
.set filler '-'
!-------------------------------------------------------------------
.create view vSchf
From
  SchFact
where
((
  nSchFact == SchFact.nRec
));
!-------------------------------------------------------------------
.var
  StrPrim1, StrPrim2 : String;
  EmptyField : string;

  NumSigner  : word;
  KolSigners : word;
  arrFIO_Dir      : array[1..10] of string;
  arrPosition_Dir : array[1..10] of string;
  arrDover_Dir    : array[1..10] of string;
  arrFIO_Buh      : array[1..10] of string;
  arrPosition_Buh : array[1..10] of string;
  arrDover_Buh    : array[1..10] of string;
  isDirector      : boolean;
  isBuh           : boolean;
  wTipUser        : word;
  sDirector       : string;
  sMainBuh        : string;
  isPostAddr      : boolean;
.endvar
.begin
  isPostAddr := (ppPrintField and 1) <> 0;
  EmptyField := if(wCountry=0,'-','');
end.
!-------------------------------------------------------------------
.if SetDateRange
.end
.{CheckEnter Schf
.if HeaderGroup
.end
.begin
  if (vSchf.GetFirst SchFact = 0)
    wTipUser := SchFact.TipUser;

  for (NumSigner := 1; NumSigner <= 10; NumSigner := NumSigner + 1)
  {
    arrFIO_Dir     [NumSigner] := '';
    arrPosition_Dir[NumSigner] := '';
    arrDover_Dir   [NumSigner] := '';
  }

  for (NumSigner := 1; NumSigner <= 10; NumSigner := NumSigner + 1)
  {
    arrFIO_Buh     [NumSigner] := '';
    arrPosition_Buh[NumSigner] := '';
    arrDover_Buh   [NumSigner] := '';
  }

  NumSigner := 0;
end.
.fields
  NSF
  if(longint(dFact)<>0, DateToStr(dFact, '"DD" Mon YYYY г.'), '')
  #f_(nRevision)
  if(longint(dRevision)<>0, DateToStr(dRevision, '"DD" Mon YYYY г.'),'-')

  if (Direct = 1,
      #f_(MyOrgName),
      #f_(OrgName))
.endfields
 Ш                                                                                                                                        Приложение № 1 Ш
 Ш                                                                                                                         к постановлению Правительства Ш
 Ш                                                                                                                                  Российской Федерации Ш
 Ш                                                                                                                          от 26 декабря 2011 г. № 1137 Ш


 Й               СЧЕТ-ФАКТУРА № @~@@@@@@@@@@@@@@@@@@@@@@ от @@@@@@@@@@@@@@@@@@@@@@@@@@@ (1) Й
 Й                ИСПРАВЛЕНИЕ № @~@@@@@@@@@@@@@@@@@@@@@@ от @@@@@@@@@@@@@@@@@@@@@@@@@@ (1а) Й

 Й Продавец   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  (2) Й
.{?internal; isPostAddr and (Trim(if (Direct = 1, MyPostAddr, PostAddr)) <> '')
.fields
  if (Direct = 1,
      #f_(MyOrgAddr),
      #f_(OrgAddr))

  if (Direct = 1,
      #f_(MyPostAddr),
      #f_(PostAddr))
.endfields
 Й Адрес юридический  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (2а) Й
 Й       почтовый  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б      Й
.}
.{?internal; (not isPostAddr) or (isPostAddr and (Trim(if (Direct = 1, MyPostAddr, PostAddr)) = ''))
.fields
  if (Direct = 1,
      #f_(MyOrgAddr),
      #f_(OrgAddr))
.endfields
 Й Адрес   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (2а) Й
.}
.fields
  if (Direct = 1,
      #f_(MyOrgINN + if ((trim(MyOrgKPP) <> ''), ' / ' + MyOrgKPP, '')),
      #f_(OrgINN   + if ((trim(OrgKPP)   <> ''), ' / ' + OrgKPP  , '')))

  #f_(GruzFrom)
  #f_(GruzTo)

  if(PlatNo_Date <> '', PlatNo_Date, '№  -  от  -')

  if (Direct <> 1,
      #f_(MyOrgName),
      #f_(OrgName))
.endfields
 Й ИНН/КПП продавца   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (2б) Й
 Й Грузоотправитель и его адрес   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  (3) Й
 Й Грузополучатель и его адрес   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  (4) Й
 Й К платежно-расчетному документу   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  (5) Й
 Й Покупатель   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  (6) Й
.{?internal; isPostAddr and (Trim(if (Direct <> 1, MyPostAddr, PostAddr)) <> '')
.fields
  if (Direct <> 1,
      #f_(MyOrgAddr),
      #f_(OrgAddr))

  if (Direct <> 1,
      #f_(MyPostAddr),
      #f_(PostAddr))
.endfields
 Й Адрес юридический  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (6а) Й
 Й       почтовый  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б      Й
.}
.{?internal; (not isPostAddr) or (isPostAddr and (Trim(if (Direct <> 1, MyPostAddr, PostAddr)) = ''))
.fields
  if (Direct <> 1,
      #f_(MyOrgAddr),
      #f_(OrgAddr))
.endfields
 Й Адрес   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (6а) Й
.}
.fields
  if (Direct <> 1,
      #f_(MyOrgINN + if ((trim(MyOrgKPP) <> ''), ' / ' + MyOrgKPP, '')),
      #f_(OrgINN   + if ((trim(OrgKPP)   <> ''), ' / ' + OrgKPP  , '')))

  Dollar + ', ' + ISO
.endfields
 Й ИНН/КПП покупателя   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (6б) Й
 Й Валюта: наименование, код   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  (7) Й
.if Dopol
.fields
  Nazn
.endfields
 Й Дополнение (условия оплаты по договору (контракту), способ отправления и т.п.) Й
 И @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
.end
.{ CheckEnter FeeSignersMember_Schfrees_Dir
.begin
  NumSigner := NumSigner + 1;
  arrFIO_Dir[NumSigner] := Signer_FIO_Director;
  arrPosition_Dir[NumSigner] := Signer_Position_Director;
  if (Signer_Dover_Director <> '')
    arrDover_Dir[NumSigner] := '(' + Signer_Dover_Director + ')';
end.
.}
.begin
  NumSigner := 0;
end.
.{ CheckEnter FeeSignersMember_Schfrees_Buh
.begin
  NumSigner := NumSigner + 1;
  arrFIO_Buh[NumSigner] := Signer_FIO_MainBuh;
  arrPosition_Buh[NumSigner] := Signer_Position_MainBuh;
  if (Signer_Dover_MainBuh <> '')
    arrDover_Buh[NumSigner] := '(' + Signer_Dover_MainBuh + ')';
end.
.}
.{CheckEnter SchfKatSopr
.{CheckEnter SchfSpSopr
.{CheckEnter SchfSpSoprNalog
.} // SchfSpSoprNalog
.} // SchfSpSopr
.} // SchfKatSopr

 Ш┌─────────────────────┬────────────────┬──────────┬────────────┬───────────────┬──────────┬──────┬─────────────┬───────────────┬──────────────┬─────────┐ Ш
 Ш│ Наименование товара │     Единица    │Количество│   Цена     │   Стоимость   │  В том   │Нало- │Сумма налога,│   Стоимость   │    Страна    │  Номер  │ Ш
 Ш│(описание выполненных│    измерения   │ (объем)  │ (тариф) за │ товаров (ра-  │  числе   │говая │предъявляемая│ товаров (ра-  │ происхождения│ таможен-│ Ш
 Ш│  работ, оказанных   ├─────┬──────────┤          │ единицу из-│ бот, услуг),  │  сумма   │ставка│ покупателю  │ бот, услуг),  │    товара    │ ной дек-│ Ш
 Ш│ услуг), имуществен- │ Код │ Условное │          │ мерения    │ имущественных │  акциза  │      │             │ имущественных ├──────┬───────┤ ларации │ Ш
 Ш│     ного права      │     │ обозначе-│          │            │     прав      │          │      │             │  прав с нало- │Цифро-│Краткое│         │ Ш
 Ш│                     │     │ние(нацио-│          │            │  без налога - │          │      │             │  гом - всего  │ вой  │ наиме-│         │ Ш
 Ш│                     │     │ нальное) │          │            │     всего     │          │      │             │               │ код  │нование│         │ Ш
 Ш├─────────────────────┼─────┼──────────┼──────────┼────────────┼───────────────┼──────────┼──────┼─────────────┼───────────────┼──────┼───────┼─────────┤ Ш
 Ш│          1          │  2  │    2а    │     3    │      4     │       5       │     6    │   7  │      8      │       9       │  10  │  10а  │    11   │ Ш
 Ш├─────────────────────┼─────┼──────────┼──────────┼────────────┼───────────────┼──────────┼──────┼─────────────┼───────────────┼──────┼───────┼─────────┤ Ш
.{CheckEnter SpSchf
.fields
  #f_(SpName + if (SpDopol <> '', ' ' + SpDopol, ''))
  #f_(if (SpPrMC = 3, '', SpKodEd))
  #f_(if (SpPrMC = 3, '', SpABBREd))
  if (SpPrMC = 101 or SpPrMC = 102, '-',
    if (SpPrMC = 3, '-', if (abs(SpKol) >= dMinKol, string(SpKol, 0, Kol_Pr), '-')))
#ifdef _RoundInDoc_
  if (SpPrMC = 3 or #isPrnPrice or #IsPeny, 0.0, if (#isRaschSt, SpPrice, SpPrNoNds))
#else
  if (SpPrMC = 3 or #isPrnPrice or #IsPeny, 0.0, if (#isRaschSt, SpSumma / SpKol, SpSumNoNDS / SpKol))
#end
  if (#IsPeny, 0.0, SpSumNoNDS)
  if (SpPrMC = 101 or SpPrMC = 102, '-', if (Abs(SpAkciz) >= 0.00001, DoubleToStr(SpAkciz, '\2p[|-]3666666666666666666.88'), 'без акциза'))
  if (SpPrMC = 101, '-',
    if (SpPrMC = 102 or #isRaschSt, if (SpPerc = -1, 'без НДС', String(SpPerc, 2, 0) + '/' + String(100 + SpPerc, 3, 0)),
      if (SpExistNDS or Abs(SpPerc) >= 0.01,
          String(SpPerc, if (SpPerc >= 10, 2, 1), 0) + ' %', 'без НДС')))
  if (SpPrMC = 101, '-',
    if (SpPrMC = 102, if (SpPerc = -1, 'без НДС', DoubleToStr(SpNDS, '\2p[|-]3666666666666666666.88')),
      if (SpExistNDS or Abs(SpPerc) >= 0.01,
          DoubleToStr(SpNDS, '\2p[|-]3666666666666666666.88'), 'без НДС')))
  SpSumma
  GTDKod
  GTDCountry
  GTDNomer
.endfields
 Ш│@@@@@@@@@@@@@@@@@@@@@│@~@@@│@~@@@@@@@@│&#&&&&&&&&│&#&&&&&&&.&&│&#&&&&&&&&&&.&&│&#&&&&&.&&│@~#@@@│&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│@~@@@@│@~@@@@@│@~@@@@@@@│ Ш
.} // SpSchf
.{CheckEnter KazSt
.}
.{CheckEnter NalogFinSchf
.} // NalogFinSchf
.if ItogoGroup       // итого по группе. Если true, то не печатать Итого
.end
.fields
  if (((SubTip=16) and wCountry=0) or #IsPeny, '',
    if (#isPrnValue,
      DoubleToStr(ItSumNoNDS, '\2p[|-]3666666666666666666.88') , ''))
   ItNDS
   ItSumma
.endfields
 Ш├─────────────────────┴─────┴──────────┴──────────┴────────────┼───────────────┼──────────┴──────┼─────────────┼───────────────┼──────┴───────┴─────────┘ Ш
 Ш│  Всего к оплате                                              │&#&&&&&&&&&&.&&│        X        │&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│ Ш
 Ш└──────────────────────────────────────────────────────────────┴───────────────┴─────────────────┴─────────────┴───────────────┘ Ш
.begin
  NumSigner  := 1;
  KolSigners := if(KolSigners_Director >= KolSigners_MainBuh, KolSigners_Director, KolSigners_MainBuh);

  sDirector := if (KolSigners_Director > 0, arrFIO_Dir[NumSigner], Director);
  sMainBuh  := if (KolSigners_MainBuh  > 0, arrFIO_Buh[NumSigner], Main_Buh);
end.
.fields
   sDirector
   sMainBuh
   arrDover_Dir[NumSigner]
   arrDover_Buh[NumSigner]
.endfields

 Ш
       Руководитель организации                                                  Главный бухгалтер
       или иное уполномоченное лицо  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@   или иное уполномоченное лицо  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@
                                       (подпись)           (Ф.И.О.)                                              (подпись)           (Ф.И.О.)
                               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.{While (NumSigner < KolSigners)
.begin
  NumSigner := NumSigner + 1;
  IsDirector := if(KolSigners_Director >= NumSigner, true, false);
  IsBuh := if(KolSigners_MainBuh >= NumSigner, true, false);
end.
.{?internal; (isDirector and isBuh)
.fields
  arrPosition_Dir[NumSigner]
  arrFIO_Dir     [NumSigner]
  arrPosition_Buh[NumSigner]
  arrFIO_Buh     [NumSigner]
  arrDover_Dir   [NumSigner]
  arrDover_Buh   [NumSigner]
.endfields
 Ш       @@@@@@@@@@@@@@@@@@@@@@@@@@@@  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@@  _____________   @@@@@@@@@@@@@@@@@@@@@@@@@@
                                       (подпись)           (Ф.И.О.)                                              (подпись)           (Ф.И.О.)
                               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш

.}
.{?internal; (isDirector and not isBuh)
.fields
  arrPosition_Dir[NumSigner]
  arrFIO_Dir     [NumSigner]
  arrDover_Dir   [NumSigner]
.endfields
 Ш       @@@@@@@@@@@@@@@@@@@@@@@@@@@@  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@
                                       (подпись)           (Ф.И.О.)
                               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш

.}
.{?internal; (not isDirector and isBuh)
.fields
  arrPosition_Buh[NumSigner]
  arrFIO_Buh     [NumSigner]
  arrDover_Buh   [NumSigner]
.endfields
 Ш                                                                                 @@@@@@@@@@@@@@@@@@@@@@@@@@@@  _____________   @@@@@@@@@@@@@@@@@@@@@@@@@@
                                                                                                                 (подпись)           (Ф.И.О.)
                                                                                                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш

.}
.}                                                                                 
.fields
  IP_FIO
  IP_Info
.endfields
 Ш     Индивидуальный предприниматель  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                       (подпись)           (Ф.И.О.)                      (реквизиты свидетельства о государственной регистрации
                                                                                                      индивидуального предпринимателя)



 Ш

.} // Schf
.endform
#doc
Корректировочный счет-фактура (с 24.01.2012)
#end
.linkform 'Schfrees_82' prototype is 'Schfrees'
.NameInList 'Корректировочный счет-фактура (c 24.01.2012)'
.Group 'Бланки корректировочных счетов-фактур'
.set filler '-'
!-------------------------------------------------------------------
.create view vSchf
From
  SchFact
where
((
  nSchFact == SchFact.nRec
));
!-------------------------------------------------------------------
.var
  StrPrim1, StrPrim2 : String;
  EmptyField : string;

  NumSigner  : word;
  KolSigners : word;
  arrFIO_Dir      : array[1..10] of string;
  arrPosition_Dir : array[1..10] of string;
  arrDover_Dir    : array[1..10] of string;
  arrFIO_Buh      : array[1..10] of string;
  arrPosition_Buh : array[1..10] of string;
  arrDover_Buh    : array[1..10] of string;
  isDirector      : boolean;
  isBuh           : boolean;
  wTipUser        : word;
  sDirector       : string;
  sMainBuh        : string;
  Sign            : double;
  isPostAddr      : boolean;
.endvar
.begin
  isPostAddr := (ppPrintField and 1) <> 0;
  EmptyField := if(wCountry=0,'-','');
end.
!-------------------------------------------------------------------
.if SetDateRange
.end
.{CheckEnter Schf
.if HeaderGroup
.end
.begin
  if (vSchf.GetFirst SchFact = 0)
    wTipUser := SchFact.TipUser;

  for (NumSigner := 1; NumSigner <= 10; NumSigner := NumSigner + 1)
  {
    arrFIO_Dir     [NumSigner] := '';
    arrPosition_Dir[NumSigner] := '';
    arrDover_Dir   [NumSigner] := '';
  }

  for (NumSigner := 1; NumSigner <= 10; NumSigner := NumSigner + 1)
  {
    arrFIO_Buh     [NumSigner] := '';
    arrPosition_Buh[NumSigner] := '';
    arrDover_Buh   [NumSigner] := '';
  }

  NumSigner := 0;
end.
.fields
  NSF_CorrV
  if (LongInt(dFact_CorrV) <> 0, DateToStr(dFact_CorrV, '"DD" Mon YYYY г.'), '-')
  #f_(nRevision_CorrV)
  if (LongInt(dRevision_CorrV) <> 0, DateToStr(dRevision_CorrV, '"DD" Mon YYYY г.'), '-')
    SF_Src_List
  #f_(nRevision)
  if (LongInt(dRevision) <> 0, DateToStr(dRevision, '"DD" Mon YYYY г.'), '-')

  if (Direct = 1,
      #f_(MyOrgName),
      #f_(OrgName))
.endfields
 Ш                                                                                                                                        Приложение № 2 Ш
 Ш                                                                                                                         к постановлению Правительства Ш
 Ш                                                                                                                                  Российской Федерации Ш
 Ш                                                                                                                          от 26 декабря 2011 г. № 1137 Ш
 Ш                                                                                           (в ред. Постановления Правительства РФ от 24.10.2013 № 952) Ш


 С КОРРЕКТИРОВОЧНЫЙ СЧЕТ-ФАКТУРА № @~@@@@@@@@@@@@@@@@@@@@@@@@ от @@@@@@@@@@@@@@@@@@@@@@@@@@                                     (1) С
 С ИСПРАВЛЕНИЕ КОРРЕКТИРОВОЧНОГО СЧЕТА-ФАКТУРЫ № @~@@@@@@@@@@@@@@@@@ от @@@@@@@@@@@@@@@@@@@@@@@@@@                             (1а) С
 С к СЧЕТУ-ФАКТУРЕ(СЧЕТАМ-ФАКТУРАМ) № @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      С
 С с учетом исправления № @~@@@@@@@@ от @@@@@@@@@@@@@@@@@@@@@@                                                                 (1б) С


 С Продавец   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (2) С
.{?internal; isPostAddr and (Trim(if (Direct = 1, MyPostAddr, PostAddr)) <> '')
.fields
  if (Direct = 1,
      #f_(MyOrgAddr),
      #f_(OrgAddr))

  if (Direct = 1,
      #f_(MyPostAddr),
      #f_(PostAddr))
.endfields
 С Адрес юридический  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (2а) С
 С       почтовый  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б      С
.}
.{?internal; (not isPostAddr) or (isPostAddr and (Trim(if (Direct = 1, MyPostAddr, PostAddr)) = ''))
.fields
  if (Direct = 1,
      #f_(MyOrgAddr),
      #f_(OrgAddr))
.endfields
 С Адрес   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (2а) С
.}
.fields
  if (Direct = 1,
      #f_(MyOrgINN + if ((trim(MyOrgKPP) <> ''), ' / ' + MyOrgKPP, '')),
      #f_(OrgINN   + if ((trim(OrgKPP)   <> ''), ' / ' + OrgKPP  , '')))

  if (Direct <> 1,
      #f_(MyOrgName),
      #f_(OrgName))
.endfields
 С ИНН/КПП продавца   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (2б) С
 С Покупатель   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (3) С
.{?internal; isPostAddr and (Trim(if (Direct <> 1, MyPostAddr, PostAddr)) <> '')
.fields
  if (Direct <> 1,
      #f_(MyOrgAddr),
      #f_(OrgAddr))

  if (Direct <> 1,
      #f_(MyPostAddr),
      #f_(PostAddr))
.endfields
 С Адрес юридический  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (3а) С
 С       почтовый  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б      С
.}
.{?internal; (not isPostAddr) or (isPostAddr and (Trim(if (Direct <> 1, MyPostAddr, PostAddr)) = ''))
.fields
  if (Direct <> 1,
      #f_(MyOrgAddr),
      #f_(OrgAddr))
.endfields
 С Адрес   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (3а) С
.}
.fields
  if (Direct <> 1,
      #f_(MyOrgINN + if ((trim(MyOrgKPP) <> ''), ' / ' + MyOrgKPP, '')),
      #f_(OrgINN   + if ((trim(OrgKPP)   <> ''), ' / ' + OrgKPP  , '')))

  Dollar + ', ' + ISO
.endfields
 С ИНН/КПП покупателя   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б (3б) С
 С Валюта: наименование, код   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  (4) С
.if Dopol
.fields
  Nazn
.endfields
 С Дополнение (условия оплаты по договору (контракту), способ отправления и т.п.) С
 Р @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.end
.{ CheckEnter FeeSignersMember_Schfrees_Dir
.begin
  NumSigner := NumSigner + 1;
  arrFIO_Dir[NumSigner] := Signer_FIO_Director;
  arrPosition_Dir[NumSigner] := Signer_Position_Director;
  if (Signer_Dover_Director <> '')
    arrDover_Dir[NumSigner] := '(' + Signer_Dover_Director + ')';
end.
.}
.begin
  NumSigner := 0;
end.
.{ CheckEnter FeeSignersMember_Schfrees_Buh
.begin
  NumSigner := NumSigner + 1;
  arrFIO_Buh[NumSigner] := Signer_FIO_MainBuh;
  arrPosition_Buh[NumSigner] := Signer_Position_MainBuh;
  if (Signer_Dover_MainBuh <> '')
    arrDover_Buh[NumSigner] := '(' + Signer_Dover_MainBuh + ')';
end.
.}
.{CheckEnter SchfKatSopr
.{CheckEnter SchfSpSopr
.{CheckEnter SchfSpSoprNalog
.} // SchfSpSoprNalog
.} // SchfSpSopr
.} // SchfKatSopr

 Ш┌──────────────────────┬──────────────────────┬────────────────┬──────────┬─────────────┬───────────────┬──────────┬──────┬─────────────┬───────────────┐ Ш
 Ш│  Наименование товара │ Показатели в связи с │     Единица    │Количество│    Цена     │   Стоимость   │  В том   │Нало- │Сумма налога │   Стоимость   │ Ш
 Ш│(описание выполненных │ изменением стоимости │    измерения   │ (объем)  │  (тариф) за │ товаров (ра-  │  числе   │говая │             │ товаров (ра-  │ Ш
 Ш│   работ, оказанных   │ отгруженных товаров  ├─────┬──────────┤          │ единицу из- │ бот, услуг),  │  сумма   │ставка│             │ бот, услуг),  │ Ш
 Ш│услуг), имущественного│ (выполненных работ,  │ Код │ Условное │          │   мерения   │ имущественных │  акциза  │      │             │ имущественных │ Ш
 Ш│        права         │   оказанных услуг),  │     │ обозначе-│          │             │     прав      │          │      │             │  прав с нало- │ Ш
 Ш│                      │      переданных      │     │ние(нацио-│          │             │  без налога - │          │      │             │  гом - всего  │ Ш
 Ш│                      │  имущественных прав  │     │ нальное) │          │             │     всего     │          │      │             │               │ Ш
 Ш├──────────────────────┼──────────────────────┼─────┼──────────┼──────────┼─────────────┼───────────────┼──────────┼──────┼─────────────┼───────────────┤ Ш
 Ш│           1          │          1а          │  2  │    2а    │     3    │      4      │       5       │     6    │   7  │      8      │       9       │ Ш
 Ш├──────────────────────┼──────────────────────┼─────┼──────────┼──────────┼─────────────┼───────────────┼──────────┼──────┼─────────────┼───────────────┤ Ш
.{CheckEnter SpSchf
.begin
  Sign := if (SpSumma < 0, -1.0, 1.0);
end.
.fields
  #f_(SpName + if (SpDopol <> '', ' ' + SpDopol, ''))
  #f_(if (SpPrMC = 3, '', SpKodEd))
  #f_(if (SpPrMC = 3, '', SpABBREd))

  if (SpPrMC = 3, '-', if (abs(SpKol_Src) >= dMinKol, string(SpKol_Src, 0, Kol_Pr), '-'))
#ifdef _RoundInDoc_
  if (SpPrMC = 3 or #isPrnPrice, 0.0, if (#isRaschSt, SpPrice_Src, SpPrNoNds_Src))
#else
  if (SpPrMC = 3 or #isPrnPrice, 0.0, if (#isRaschSt, SpSumma_Src / SpKol_Src, SpSumNoNds_Src / SpKol_Src))
#end
  SpSumNoNds_Src
  if (abs(SpAkciz_Src) >= 0.00001, DoubleToStr(SpAkciz_Src, '\2p[|-]3666666666666666666.88'), 'без акциза')
  if (SpPrMC = 101, '-',
    if (SpPrMC = 102 or #isRaschSt, if (SpPerc = -1, 'без НДС', String(SpPerc, 2, 0) + '/' + String(100 + SpPerc, 3, 0)),
      if (SpExistNDS or Abs(SpPerc) >= 0.01,
          String(SpPerc, if (SpPerc >= 10, 2, 1), 0) + ' %', 'без НДС')))
  if (SpExistNDS or Abs(SpPerc) >= 0.01, DoubleToStr(SpNDS_Src, '\2p[|-]3666666666666666666.88'), 'без НДС')
  SpSumma_Src

  #f_(if (SpPrMC = 3, '', SpKodEd))
  #f_(if (SpPrMC = 3, '', SpABBREd))

  if (SpPrMC = 3, '0.0', if (abs(SpKol_Src + SpKol) >= dMinKol, string(SpKol_Src + SpKol, 0, Kol_Pr), '-'))
#ifdef _RoundInDoc_
  if (SpPrMC = 3 or #isPrnPrice, 0.0,
      if (#isRaschSt,
          if (abs(SpKol) >= dMinKol, (SpPrice_Src * SpKol_Src + SpPrice * SpKol) / (SpKol_Src + SpKol), (SpPrice_Src + SpPrice)),
          if (abs(SpKol) >= dMinKol, (SpPrNoNds_Src * SpKol_Src + SpPrNoNds * SpKol) / (SpKol_Src + SpKol), (SpPrNoNds_Src + SpPrNoNds))))
#else
  if (SpPrMC = 3 or #isPrnPrice, 0.0, if (#isRaschSt, (SpSumma_Src + SpSumma) / (SpKol_Src + SpKol), (SpSumNoNds_Src + SpSumNoNds) / (SpKol_Src + SpKol)))
#end
  (SpSumNoNds_Src + SpSumNoNDS)
  if (abs(SpAkciz_Src + SpAkciz) >= 0.00001, DoubleToStr(SpAkciz_Src + SpAkciz, '\2p[|-]3666666666666666666.88'), 'без акциза')
  if (SpPrMC = 101, '-',
    if (SpPrMC = 102 or #isRaschSt, if (SpPerc = -1, 'без НДС', String(SpPerc, 2, 0) + '/' + String(100 + SpPerc, 3, 0)),
      if (SpExistNDS or Abs(SpPerc) >= 0.01,
          String(SpPerc, if (SpPerc >= 10, 2, 1), 0) + ' %', 'без НДС')))
  if ((SpExistNDS or Abs(SpPerc) >= 0.01), DoubleToStr(SpNDS_Src + SpNDS, '\2p[|-]3666666666666666666.88'), 'без НДС')
  (SpSumma_Src + SpSumma)

  if (Sign > 0, Sign * SpSumNoNDS, 0.0)
  if (Sign > 0, Sign * SpAkciz, 0.0)
  if (Sign > 0, if (SpExistNDS or Abs(SpPerc) >= 0.01, DoubleToStr(Sign * SpNDS, '\2p[|-]3666666666666666666.88'), '-'), '-')
  if (Sign > 0, Sign * SpSumma, 0.0)

  if (Sign < 0, Sign * SpSumNoNDS, 0.0)
  if (Sign < 0, Sign * SpAkciz, 0.0)
  if (Sign < 0, if (SpExistNDS or Abs(SpPerc) >= 0.01, DoubleToStr(Sign * SpNDS, '\2p[|-]3666666666666666666.88'), '-'), '-')
  if (Sign < 0, Sign * SpSumma, 0.0)
.endfields
 Ш│@@@@@@@@@@@@@@@@@@@@@@│А (до изменения)      │@~@@@│@~@@@@@@@@│&#&&&&&&&&│&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│&#&&&&&.&&│@~#@@@│&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│ Ш
 Ш│                      │Б (после изменения)   │@~@@@│@~@@@@@@@@│&#&&&&&&&&│&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│&#&&&&&.&&│@~#@@@│&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│ Ш
 Ш│                      │В (увеличение)        │  X  │     X    │     X    │      X      │&#&&&&&&&&&&.&&│&#&&&&&.&&│   X  │&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│ Ш
 Ш│                      │Г (уменьшение)        │  X  │     X    │     X    │      X      │&#&&&&&&&&&&.&&│&#&&&&&.&&│   X  │&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│ Ш
.} // SpSchf
.{CheckEnter KazSt
.}
.{CheckEnter NalogFinSchf
.} // NalogFinSchf
.if ItogoGroup       // итого по группе. Если true, то не печатать Итого
.end
.fields
   if (#isPrnValue, ItSumNoNDS_Dop, 0.0)
   ItNDS_Dop
   ItSumma_Dop

   if (#isPrnValue, ItSumNoNDS, 0.0)
   ItNDS
   ItSumma
.endfields
 Ш├──────────────────────┴──────────────────────┴─────┴──────────┴──────────┴─────────────┼───────────────┼──────────┼──────┼─────────────┼───────────────┤ Ш
 Ш│  Всего увеличение (сумма строк В)                                                     │&#&&&&&&&&&&.&&│     X    │   X  │&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│ Ш
 Ш├───────────────────────────────────────────────────────────────────────────────────────┼───────────────┼──────────┼──────┼─────────────┼───────────────┤ Ш
 Ш│  Всего уменьшение (сумма строк Г)                                                     │&#&&&&&&&&&&.&&│     X    │   X  │&#&&&&&&&&.&&│&#&&&&&&&&&&.&&│ Ш
 Ш└───────────────────────────────────────────────────────────────────────────────────────┴───────────────┴──────────┴──────┴─────────────┴───────────────┘ Ш
.begin
  NumSigner  := 1;
  KolSigners := if(KolSigners_Director >= KolSigners_MainBuh, KolSigners_Director, KolSigners_MainBuh);

  sDirector := if (KolSigners_Director > 0, arrFIO_Dir[NumSigner], Director);
  sMainBuh  := if (KolSigners_MainBuh  > 0, arrFIO_Buh[NumSigner], Main_Buh);
end.
.fields
   sDirector
   sMainBuh
   arrDover_Dir[NumSigner]
   arrDover_Buh[NumSigner]
.endfields

 Ш
       Руководитель организации                                                  Главный бухгалтер
       или иное уполномоченное лицо  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@   или иное уполномоченное лицо  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@@
                                       (подпись)           (Ф.И.О.)                                              (подпись)           (Ф.И.О.)
                               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.{While (NumSigner < KolSigners)
.begin
  NumSigner := NumSigner + 1;
  IsDirector := if(KolSigners_Director >= NumSigner, true, false);
  IsBuh := if(KolSigners_MainBuh >= NumSigner, true, false);
end.
.{?internal; (isDirector and isBuh)
.fields
  arrPosition_Dir[NumSigner]
  arrFIO_Dir     [NumSigner]
  arrPosition_Buh[NumSigner]
  arrFIO_Buh     [NumSigner]
  arrDover_Dir   [NumSigner]
  arrDover_Buh   [NumSigner]
.endfields
 Ш       @@@@@@@@@@@@@@@@@@@@@@@@@@@@  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@@  _____________   @@@@@@@@@@@@@@@@@@@@@@@@@@
                                       (подпись)           (Ф.И.О.)                                              (подпись)           (Ф.И.О.)
                               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш

.}
.{?internal; (isDirector and not isBuh)
.fields
  arrPosition_Dir[NumSigner]
  arrFIO_Dir     [NumSigner]
  arrDover_Dir   [NumSigner]
.endfields
 Ш       @@@@@@@@@@@@@@@@@@@@@@@@@@@@  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@
                                       (подпись)           (Ф.И.О.)
                               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш

.}
.{?internal; (not isDirector and isBuh)
.fields
  arrPosition_Buh[NumSigner]
  arrFIO_Buh     [NumSigner]
  arrDover_Buh   [NumSigner]
.endfields
 Ш                                                                                 @@@@@@@@@@@@@@@@@@@@@@@@@@@@  _____________   @@@@@@@@@@@@@@@@@@@@@@@@@@
                                                                                                                 (подпись)           (Ф.И.О.)
                                                                                                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш

.}
.}
.fields
  IP_FIO
  IP_Info
.endfields
 Ш     Индивидуальный предприниматель  _____________  @@@@@@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                       (подпись)           (Ф.И.О.)                      (реквизиты свидетельства о государственной регистрации
                                                                                                      индивидуального предпринимателя)


 Ш

.} // Schf
.endform