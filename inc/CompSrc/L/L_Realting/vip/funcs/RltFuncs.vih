//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 8.0 - логистика
// Управление недвижимостью
// Vih-файл интерфейса RltFuncs
//********************************************************************************

#ifndef __RltFuncs_vih__
#define __RltFuncs_vih__

#ifdef ComponentVersion
#component "L_REALTING"
#end

#doc
Информация об объекте недвижимости
#end
Type
  TRltInfo = record
//********************************************************************************
//  InfoLbl01 - метка поля в screen договора/ПКП
//  InfoTxt01 - значение поля в screen договора/ПКП
//********************************************************************************
    InfoLbl01, InfoTxt01
   ,InfoLbl02, InfoTxt02
   ,InfoLbl03, InfoTxt03
   ,InfoLbl04, InfoTxt04
   ,InfoLbl05, InfoTxt05
   ,InfoLbl06, InfoTxt06
   ,InfoLbl07, InfoTxt07
   ,InfoLbl08, InfoTxt08
   ,InfoLbl09, InfoTxt09
   ,InfoLbl10, InfoTxt10
   ,InfoLbl11, InfoTxt11
   ,InfoLbl12, InfoTxt12
   ,InfoLbl13, InfoTxt13
   ,InfoLbl14, InfoTxt14
   ,InfoLbl15, InfoTxt15 : string;
  end;

#doc
Содержит общие методы для работы с объектами недвижимости
#end
ObjInterface tRltFuncs;
//********************************************************************************
  #doc
  Процедура модификации статуса комнаты/места на б/т  в соответствии с последней записью истории аренды/закреплений
  #end
  Procedure ModifyObjStatus(wVidObj : word; pObj : comp);
//********************************************************************************
  #doc
  Функция получения ссылки на ЦО по организации. Если ЦО нет, то создается новая запись ЦО по организации
  #end
  Function  FindFpCoRefOnOrg(pOrg : comp) : comp;
//********************************************************************************
  #doc
  Функция получения следующего порядкового номера операции по аренде/закреплению
  #end
  Function  GetNextNPP(wVidObj : word; pObj : comp) : word;
//********************************************************************************
  #doc
  Функция добавления операции по сдаче объекта в аренду
  #end
  Function  AddRentRec(dD, dF, dT : date; ND : string[20]; pDog, pOrg : comp; wVidObj : word; pObj : comp) : comp;
//********************************************************************************
  #doc
  Функция добавления операции по закреплению объекта
  #end
  Function  AddZakrRec(pPodr : comp; dF : date; wVidObj : word; pObj : comp) : comp;
//********************************************************************************
  #doc
  Функция добавления операции об окончании аренды/закрепления объекта
  #end
  Function  AddEndRentRec(pDogovor : comp; wVidObj : word; pObj : comp; IsBat : boolean) : comp;
//********************************************************************************
  #doc
  Функция получения информации по объекту недвижимости
  #end
  Procedure GetObjInfoOnSpDocs(pSpDocs : comp; dInfo : date; var RltInfo : TRltInfo);
//********************************************************************************
  #doc
  По спецификации договора/ПКП показывает объект недвижимости.
  Если связи с объектом недвижимости нет, то предлагается привязать
  #end
  Function  GetObjOnSpDocs(pSpDocs : comp; var wVidObj : word; var pObj : comp; boView : boolean) : boolean;
//********************************************************************************
  #doc
  Функция связывания спецификации договора/ПКП с объектом недвижимости
  #end
  Function  DoLinkRltObj2SpDocs(pDogovor, pCalPlan, pSpDocs : comp; dF : date; var wVidObj : word; var pObj : comp) : boolean;
//******************************************************************************
  #doc
  Функция удаление записей по аренде по договору
  #end
  procedure DeleteRentOnDogovor(wVidObj: word; pObj, pDogovor: comp);
//********************************************************************************
  #doc
  Процедура добавления операции об окончании аренды/закрепления по объектам спецификации договора
  #end
  Procedure AddEndRent(pDogovor : comp);
//******************************************************************************
  #doc
  Событие после удаления позиции спецификации договора/ПКП
  #end
  procedure AfterDeleteSpDocs(pDog, pSpDocs, pMCUsl, pOtvPodr : comp);
//********************************************************************************
  #doc
  Получение наименования объекта недвижимости
  #end
  Function rltGetObjName(wVidObj : word; pObj : comp): string;
//********************************************************************************
  #doc
  Изменение статуса договора
  #end
  Function DogovorStatusChanged(pDogovor: comp): boolean;
//********************************************************************************
  #doc
  При создании уточняющего соглашения изменение ссылок
  #end
  Procedure ChangeLinksOnDogovor(pDogovor, pAppDog: comp);
//********************************************************************************
  #doc
  Обработка событий в модуле
  #end
  Function EventToRealting(sCommand: string; wTable: word; pRec: comp): boolean;
//********************************************************************************
end;

VipInterface RltFuncs implements tRltFuncs licensed (FREE);
  static:
    Function rltGetStringFieldFromTable(sTable, sField: string; pRec: comp): string;
    Function rltGetCompFieldFromTable  (sTable, sField: string; pRec: comp): comp;
    Function rltGetWordFieldFromTable  (sTable, sField: string; pRec: comp): word;
    Function rltGetAnyFieldFromTable   (sTable, sField: string; pRec: comp): string;
end;

#end //__RltFuncs_vih__