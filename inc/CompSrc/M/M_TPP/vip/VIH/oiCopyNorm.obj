//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.xx Производственный контур/Спецификации продуктов
// объектный интерфейс копирования материальных норм из маршрутов в спецификации  
//******************************************************************************


#ifndef __OICOPYNORM_VIH
#define __OICOPYNORM_VIH

#ifdef ComponentVersion
#component "M_TPP"
#end

ObjInterface oiCopyNorm; forward;
#ifndef __OIPOTRGT_VIH
#include oiPotrGt.vih
#endif //__OIPOTRGT_VIH
#ifndef __OINASTSRV_VIH
#include oiNastSrv.vih
#endif //__OINASTRSRV_VIH
#ifndef __OIDOCSRV_VIH
#include oiDocSrv.vih
#endif //__OIDOCSRV_VIH

#doc
объектный интерфейс копирования материальных норм из маршрутов в спецификации</brief>
#end

ObjInterface oiCopyNorm;

#doc
копирование документа</brief>:<br>
 <I>cGKatMarsh</I> - N-Rec маршрутной карты - источника
 <I>wGHdrPS</I> - тип мпецификации (cgKau_Hdr_PS - производственнная
                             cgKau_Hdr_KS - конструкторская)
 <I>cGHdrPS</I> - N-Rec спецификации - куда копируем
 <I>wChange</I> - Как будут копироваться данные (0 -добавить к имеющимся или 1 -заменить)
#end
Function CopyDocuments(cGKatMarsh : comp; wGHdrPS: word; cGHdrPS : comp; wChange : word): integer;

#doc
установка параметров копирования</brief>:<br>
<I>wTypePos</I>  - 0 -Все, 1- только Нормы, 2 - только Выход
<I>wTypeRes</I>  - 0 -Все, 1 -МЦ, 2- Услуги
<I>wCategory</I> - 1 -покупные, 2 - собственного пр-ва, 4 - субподрядные
<I>wCharacter</I>- 0 -Все, 1 - материал, 2 - ДСЕ
<I>wSpecCopy</I> - 1 -суммировать одинаковые позиции, не учитывать документ
<I>bGroup</I> - true - групповое копирование, false - единичное
#end
Procedure SetCopyParam(wTypePos : word; wTypeRes: word; wCategory: word; wCharacter: word; wSpecCopy: word; bGroup :boolean);

#doc
формирование протокола</brief>
#end
Function RunProtocol : boolean;
end; // oiCopyNorm
#endif // __OICOPYNORM_VIH