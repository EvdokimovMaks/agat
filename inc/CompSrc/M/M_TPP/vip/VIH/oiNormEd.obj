//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.1 Производственный контур/Спецификации продуктов
// объектный интерфейс редактирования норм ресурсов операций МК/техопераций
//******************************************************************************


#ifndef __OINORMED_VIH
#define __OINORMED_VIH

#ifdef ComponentVersion
#component "M_TPP"
#end

#ifndef __GTSMC_0_VIH__
#include GtSMC_0.vih
#end // __GTSMC_0_VIH__

ObjInterface oiNormEd; forward;
#ifndef __OIPARED_VIH
#include oiParEd.vih
#endif //__OIPARED_VIH
#ifndef __OIKAUWRK_VIH
#include oiKAUWrk.vih
#endif //__OIKAUWRK_VIH
#ifndef GAL7_11
#ifndef __TNORMVIP_REC
#include TNormVIP.rec
#endif //__TNORMVIP_REC
#end

 // Операционные нормы
#doc
объектный редактирования норм ресурсов операций маршрутов/техопераций</brief>
#end
ObjInterface oiNormEd;

#doc
установка владельца нормы</brief>
#end
  function SetNormObj(wObject: word; cObject: comp): integer;

#doc
установка значений норм по умолчанию</brief>
#end
  function SetDefNormEd(dNormEd: double; cNormEd: comp): integer;

#doc
обновить рабочую расценку</brief>
#end
  function UpdateJobTarif: boolean;

#doc
установка мастер-записи и владельца норм</brief>:<br>
cParamGr - группа параметров норм
<I>wMaster, cMaster</I> - тип и ключ мастер-записи
<I>wObject, cObject</I> - тип и ключ владельца
#end
   function SetObjectEx(cParamGr: comp; wMaster: word; cMaster: comp; wObject: word; cObject: comp): integer;

#doc
установка владельца норм</brief>:<br>
<I>cParamGr</I> - группа параметров норм
<I>wObject, cObject</I> - тип и ключ владельца
#end
   function SetObject(cParamGr: comp; wObject: word; cObject: comp): integer;

#doc
удаление норм владельца</brief>:<br>
<I>wObject, cObject</I> - тип и ключ владельца
#end
   function xDelObject(wObject: word; cObject: comp): integer;

#doc
установка мастер-записи норм</brief>:<br>
<I>wMaster, cMaster</I> - тип и ключ мастер-записи
#end
   function SetMaster(wMaster: word; cMaster: comp): integer;

#doc
привязка норм текущего владельца к мастер-записи</brief>:<br>
<I>wMaster, cMaster</I> - тип и ключ мастер-записи
<I>UpdateOn</I> - не используется
#end 
  function xObjToMaster(wMaster: word; cMaster: comp; FromMaster: boolean; wCopyMode: word; wNormSort: word): integer;

#doc
освобождение норм текущего владельца от мастер-записи</brief>:<br>
wMaster, cMaster - тип и ключ мастер-записи 
#end
  function xDelMaster(wMaster: word; cMaster: comp): integer;

#doc
установить режим работы</brief>
#end
  procedure SetMode(wMode: word; wValue: word);

#doc
очистить ссылки на объекты</brief>
#end
  procedure FreeLinks;

//  property State: integer;
#doc
получить состояние</brief>
#end
  function GetState: integer;

//  property ParEd: oiParEd;
#doc
получить ссылку на текущий объект редактирования параметров</brief>
#end
  function GetParEd: oiParEd;

//  property KAUSrv: oiKAUWrk;
#doc
получить ссылку на текущий объект КАУ</brief>
#end
  function GetKAUSrv: oiKAUWrk;

#ifndef GAL7_11
//  property FnAnal: oiFnAnal;
  function GetFnAnal: oiFnAnal;
//  property FnExec: oiFnExec;
  procedure SetFnExec(Value: oiFnExec);
  function GetFnExec: oiFnExec;
#end

#doc
установить новый объект редактирования параметров</brief>
#end
  procedure SetxParEd(NewValue: oiParEd);
//  procedure FreexParEd;

#doc                                     // 1.05.08 <
установка дат действия норм</brief>:<br>
<I>dtTmpDtBeg, dtTmpDtEnd</I> - даты начала и окончания действия норм
#end
public function SetNormasDate(dtTmpDtBeg: date; dtTmpDtEnd: date): boolean;
                                         // 1.05.08 >
end; // oiNormEd

#endif  // __OINORMED_VIH