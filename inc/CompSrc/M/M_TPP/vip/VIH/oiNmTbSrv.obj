//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.12 Производственный контур/Спецификации продуктов
//                Сервис работы с нормативными таблицами
//******************************************************************************

#ifndef __OINMTBSRV_VIH
#define __OINMTBSRV_VIH

#ifdef ComponentVersion
#component "M_TPP"
#end

#include rAnParam.vpp  // структура для работы с аналитиками

type
  rNmTbCell = record
                wRow,           // индекс строки
                wCol    : word; // индекс столбца
                cRowHash,       // MnAnal.nRec строки
                cColHash: comp; // MnAnal.nRec столбца
              end;

#doc
объектный интерфейс работы с нормативными таблицами</brief>
#end
ObjInterface oiNmTbSrv;

#doc
установить рабочую таблицу</brief>
#end
function SetNormTable(cValue: comp): boolean; // true, если нашли
//***

#doc
получить индексы строки и столбца для значения ячейки</brief>
#end
function GetValueIndex(dValue: double): rNmTbCell;

#doc
получить индекс строки по значениям заголовков строк</brief><br>
значения заголовков строк в маркерах:<br>
 <I>sMarkHead + 'AnRole'</I> - nRec ролей аналитик
 <I>sMarkHead + 'AnCode'</I> - коды аналитик
 <I>sMarkHead + 'AnVal'</I>  - nRec значений аналитик
#end
function GetRowIndex(sMarkHead: string): rNmTbCell;

#doc
получить индекс столбца по значению заголовка столбца</brief>
#end
function GetColIndex(aAnCol: rAnParam): rNmTbCell;

//***
#doc
получение значения ячейки по индексам строки и столбца</brief>
#end
function GetIndexValue(aCell: rNmTbCell): double;

#doc
по значениям заголовков строк и индексу столбца</brief>
#end
function GetRowCIndexValue(sMarkHead: string; aCell: rNmTbCell): double;

#doc
по индексу строки и значению заголовка столбца</brief>
#end
function GetRIndexColValue(aCell: rNmTbCell; aAnCol: rAnParam): double;

#doc
по значениям заголовков строк и значению заголовка столбца</brief>
#end
function GetRowColValue(sMarkHead: string; aAnCol: rAnParam): double;
end; // oiNmTbSrv

#endif  // __OINMTBSRV_VIH