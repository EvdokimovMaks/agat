//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.11 Производственный контур/Спецификации продуктов
//                объект - документ нормирования
//******************************************************************************


#ifndef __OITPPDOC_VIH
#define __OITPPDOC_VIH

#ifdef ComponentVersion
#component "M_TPP"
#end

#ifdef GAL7_12
#ifndef __GTSMC_0_VIH__
#include GtSMC_0.vih
#end // __GTSMC_0_VIH__
#ifndef __GTSUS_0_VIH__
#include GtSUs_0.vih
#end // __GTSUS_0_VIH__
#end // ifdef GAL7_12

#ifndef __OIDOCSRV_VIH
#include oiDocSrv.vih
#endif //__OIDOCSRV_VIH
#ifndef __OIPIKSRV_VIH
#include oiPikSrv.vih
#endif //__OIPIKSRV_VIH
#ifndef __OIDOCSP_VIH
#include oiDocSp.vih
#endif //__OIDOCSP_VIH
#ifndef __OINORMED_VIH
#include oiNormEd.vih
#endif //__OINORMED_VIH
#ifndef __OIPARED_VIH
#include oiParEd.vih
#endif //__OIPARED_VIH
#ifndef __OINASTSRV_VIH
#include oiNastSrv.vih
#endif //__OINASTSRV_VIH
#ifndef __OISRVMK_VIH
#include oiSrvMK.vih
#endif //__OISRVMK_VIH

#doc
объектный интерфейс документа нормирования</brief>
#end

ObjInterface oiTPPDoc;

#doc
установить режим работы</brief>
#end
  function SetMode(cCode: comp; wMode: integer): integer;

#doc
установить фильтр в зависимости от перданных параметров</brief>
#end
  function SetGroup(wGroup: integer; wObjType: integer; cObject: comp; wKind: integer; wType: integer): integer;

#doc
получить ключ текущего документа</brief>
#end
  function GetCode: comp;

#doc
смена режима</brief>
#end
  procedure SwitchMode(wMode: word);

#doc
редактирование заголовка текущего документа</brief>
#end
  function RunEditHd: integer;

#doc
редактирование спецификации текущего документа</brief>
#end
  function RunEditSp: integer;

#doc
удаление текущего документа</brief>
#end
  function xDeleteAll: integer;

#doc
получить состояние документа</brief>
#end
//  property State: integer;
  function GetState: integer;

#doc
получить объект норм</brief>
#end
//  property Norms: oiNormEd;
  function GetNorms: oiNormEd;

#doc
получить объект параметров</brief>
#end
//  property Params: oiParEd;
  function GetParams: oiParEd;

#doc
получить объект документа</brief>
#end
//  property DocSrv: oiDocSrv;
  function GetDocSrv: oiDocSrv;

#doc
получить объект  отмеченных позиций</brief>
#end
//  property PickSrv: oiPikSrv;
  function GetPickSrv: oiPikSrv;

#doc
получить объект позиций документа</brief>
#end
//  property DocSp: oiDocSp;
  function GetDocSp: oiDocSp;
end; // oiTPPDoc

#ifdef __Proizv_AltayVagon__

ObjInterface oiTPPDoc_V2(oiTPPDoc);

#doc
редактирование заголовка документа с ключом cCode</brief>
#end
  function RunEditHdEx(cCode: comp): integer;

#doc
редактирование спецификации документа с ключом cCode</brief>
#end
  function RunEditSpEx(cCode: comp): integer;

#doc
Событие установки пользовательского фильтра</brief>
#end
event procedure UserFilterWasSet;

#doc
Событие снятия пользовательского фильтра</brief>
#end
event procedure UserFilterWasRemoved;

#doc
Событие для пометки позиций, которые не удовлетворяют условиям пользовательского фильтра</brief>
#end
event procedure MarkInValidPositions;

#doc
Событие для перерисовки позиций, при смене обходной или основной МК/ПС </brief>
#end
event procedure onRefreshPositions;



function IsUserFilterSet : Boolean;
function IsPositionsMarked : Boolean;
function GetUserFilterName : string;

end; // oiTPPDoc_V2

#endif  // __OITPPDOC_VIH

#endif  // __OITPPDOC_VIH
