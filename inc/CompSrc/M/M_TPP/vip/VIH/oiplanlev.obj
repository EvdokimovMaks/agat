//------------------------------------------------------------------------------
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.12 - Производственное планирование
// объектный интерфейс расчёта уровней планирования для МЦ/услуг (SVF)
//------------------------------------------------------------------------------

#ifndef __OIPLANLEV_VIH
#define __OIPLANLEV_VIH

#include oiGPSrv03.obj // работа с протоколом

ObjInterface oiPlanLev; forward;

#doc
объектный интерфейс расчёта уровней планирования для МЦ/услуг</brief>
#end

ObjInterface oiPlanLev;

#doc
  функция расчёта уровня планирования для конкретной МЦ/услуг с присвоением
  уровней планирования и другим МЦ/услугам, участвующим в расчёте уровня
  планирования для данной МЦ/услуг</brief><br>
  <I>wPrMc</I>  - cgKau_KatMC/cgKau_KatUsl
  <I>cMcUsl</I> - ссылка на МЦ/услугу
#end
  Function RaschetObjPlanLevel(wPrMc: word; cMcUsl: comp): LongInt;

#doc
  функция расчёта уровней планирования для МЦ/услуг</brief><br>
  Результат: в случае успеха <I>true</I> иначе <I>false</I>
#end
  Function RaschetPlanLevel: LongInt;

#doc
  функция настройки расчёта уровней планирования для МЦ/услуг</brief><br>
  Результат: в случае успеха <I>true</I> иначе <I>false</I><br>
  <I>dDate</I>  - даты начала периода расчета
  <I>wDocs</I>  - документы, рассматриваемые в качестве норм
  <I>wSetup</I> - битовое поле настройки:
    бит <I>0</I>: формировать отчет об ошибках(имеет значение только если интерфейс
           вызывается через  RunInterface, во  всех  остальных  случаях  для
           формирования отчёта использовать функции журнала)
    бит <I>1</I>: <I>1/0</I> - on/off visualisation
#end
  Function NastrRPlLev(dDate: date; wDocs: word; wSetup: word): boolean;

end;    // oiPlanLev

#endif  // __OIPlanLev_VIH
