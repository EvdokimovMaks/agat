//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Контроллинг"
// Интерфейс взаимодействия : "Работа с ТХО"
//------------------------------------------------------------------------------

#ifndef __MCExtTXOService_Vih__
#define __MCExtTXOService_Vih__

#component "M_Control"

//------------------------------------------------------------------------------
#include TxoBind.vih     // Сложная привязка ТХО, и запуск сложной разноски
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Интерфейс взаимодействия : "Работа с ТХО"
#end
ObjInterface oMCExtTXOService;

//==============================================================================
// ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить описание последней ошибки
#end
Function GetStLastError : string;

//==============================================================================
// АТТРИБУТЫ ТХО
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Наименование ТХО 
#end
Function GetTXOName(_cHozOper : comp) : string;

//------------------------------------------------------------------------------
#doc
   Наименование ТХО 
#end
Function GetSHTXOName     (_SHBuff : #TSoprHozX                   ) : string;

//------------------------------------------------------------------------------
#doc
   Наименование ТХО в заданном регистре учета
#end
Function GetSHTXONameInReg(_SHBuff : #TSoprHozX; _cPlansSch : comp) : string;

//------------------------------------------------------------------------------
#doc
   Настроена ли сквозная привязка
#end
Function GetIsSimpleBinding(_wTiDk : word) : boolean;

//==============================================================================
// ПРИВЯЗКА ТХО
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Инициализация сессии привязки ТХО
#end
Function InitBindSession : boolean;

//------------------------------------------------------------------------------
#doc
   Заполнение списка планов счетов
#end
Function AddPlansSch(_cPlansSch : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Привязка ТХО (без формирования проводок)
#end
Function BindTXO (_cSoprHoz : comp; _cHozOper : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Переформировать проводки, по заданной разноске ТХО
#end
Function ApplyTXO(_cSoprHoz : comp; _cHozOper : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Переформировать проводки, по существующей разноске ТХО
#end
Function ReApplyTXO(_cSoprHoz : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Закрытие сессии привязки ТХО
#end
Function DoneBindSession : boolean;


//==============================================================================
// DIALOG
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Запуск интерфейса выбора ТХО
#end
Function RunViewHozOper(
    _wIntMode : word;    // Режим запуска (выбор/просмотр: cgiNo, cgiPick,...)
    _TiDk     : word;    // тип документа
var _cRec     : comp     // значение выбранной записи
) : integer;

//------------------------------------------------------------------------------
#doc
   Запуск интерфейса привязки ТХО
#end
Function RunViewSoprHoz(
    _TiDk     : word;    // тип документа
    _cRec     : comp     // значение выбранной записи
) : integer;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
end; // oMCExtTXOService

VipInterface iMCExtTXOService implements oMCExtTXOService
#Licensed_Free
;

#endif  // __MCExtTXOService_Vih__
