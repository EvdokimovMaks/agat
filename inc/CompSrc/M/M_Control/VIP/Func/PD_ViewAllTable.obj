//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Контроллинг"
// Объект чтения таблиц: "Производственный баланс"
//------------------------------------------------------------------------------

#ifndef __MCReadPBTable_Vih__
#define __MCReadPBTable_Vih__

//------------------------------------------------------------------------------
#include PD_tableMemory.vpp  // Таблицы сущности : "Множественный выбор аналитики"
//------------------------------------------------------------------------------

#component "M_Control"

//------------------------------------------------------------------------------
Type TMCReadPBTable = record
  cRepHead   : comp;
  wFld1Mode  : word;
  wFld2Mode  : word;
  wCodeOper  : word;
  cTune      : comp;
  wSRCPodr   : word;
  wDSTPodr   : word;
end;
//------------------------------------------------------------------------------
Type TMCReadPBValues = record
  wPBTable   : word;
  cPBTable   : comp;
  cRepMove   : comp;
  wOperate   : word;
  cSRCPodr   : comp;
  cDSTPodr   : comp;
  cOprPodr   : comp;
  cSRCMnAnal : comp;
  cDSTMnAnal : comp;
  cTblMnAnal : comp;
  cOprMnAnal : comp;
  SRCCAnID   : LongInt;
  DSTCAnID   : LongInt;
  BuffRepObj : type$RepObj;
  wDirect    : word;
  wRes       : word;
  cRes       : comp;
  cValut     : comp;
  cParty     : comp;
  cEd1       : comp;
  cEd2       : comp;
  Kol1       : double;
  Kol2       : double;
  Summa      : double;
  Price      : double;
end;
//------------------------------------------------------------------------------


//------------------------------------------------------------------------------
#doc
Объект чтения таблиц: "Производственный баланс"
#end
ObjInterface oMCReadPBTable;

//==============================================================================
// ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить описание последней ошибки
#end
Function GetStLastError : string;

//==============================================================================
// READTBL
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Инициализация таблиц
#end
Function InitTbl(
  _rcPBTable : TMCReadPBTable
) : boolean;
//------------------------------------------------------------------------------
#doc
   Цикл по таблицам
#end
Function LoopTbl : boolean;
//------------------------------------------------------------------------------
#doc
   Получение данных по текущей позиции
#end
Function GetValues(
var _rcPBValues  : TMCReadPBValues
) : boolean;

//==============================================================================
//                                 EVENT
//******************************************************************************
//------------------------------------------------------------------------------
#doc
   Событие получения позиции в цикле по таблицам
#end
Event Procedure Event_GetRec(var _isBreak : boolean);

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
end; // oMCReadPBTable

#endif  // __MCReadPBTable_Vih__
