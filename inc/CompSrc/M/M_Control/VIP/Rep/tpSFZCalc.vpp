//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - Контроллинг
// Структура данных для калькуляционных отчетов СФЗ
//------------------------------------------------------------------------------

// таблица СЗ по которым необходимо считать суммы и признаков расчета расходов
Table struct tpInputSZ
(
  wNumStr    : word,
  VidStrCalc : word,
  cStZatr    : comp,
  cMcAnalit  : array [1..10] of comp,
  wNatur     : word,
  wVidVolume : word
)
With Index
(
 tpInputSZ01 = cStZatr + VidStrCalc + wNatur,
 tpInputSZ02 = wNumStr + cStZatr,
 tpInputSZ03 = VidStrCalc + wNatur,
 tpInputSZ04 = wNatur
);

// таблица, содержащая пока одну запись объемов
Table struct tpVolume
(
  cEI           : comp,    // ссылка на ЕИ зависит от поля wEI
  wEI           : word,    // 0 - учетная 1 - отпускная
  dAmountAll    : double,
  dAmountTov    : double,
  dAmountRasx   : double,
  dAmountAllPB  : double,
  dAmountTovPB  : double,
  dAmountRasxPB : double
)
;

// таблица, содержащая одну запись объемов планового варианта для ФА
Table struct tpVolume_Plan
(
  cEI         : comp,    // ссылка на ЕИ зависит от поля wEI
  wEI         : word,    // 0 - учетная 1 - отпускная
  dAmountAll  : double,
  dAmountTov  : double,
  dAmountRasx : double
)
;

// таблица, содержащая суммы по СЗ и натуральные расходы
Table struct tpOutputSZ
(
  wNumStr    : word,
  cStZatr    : comp,
  wNatur     : word,
  wFC        : word,
  dSum       : double,
  dAmount    : double,
  cUchEd     : comp,    // для сводимости ЕИ разных ресурсов
  cKatEd     : comp
)
With Index
(
 tpOutputSZ01 = wNumStr + cStZatr,
 tpOutputSZ02 = wNatur
);


// таблица, содержащая суммы по СЗ и натуральные расходы для сводной ФА
Table struct tpOutputSZ_FA
(
  wNumStr    : word,
  cStZatr    : comp,
  dCol_J     : double,
  dCol_M     : double,
  dCol_N     : double
)
With Index
(
 tpOutputSZ_FA01 = wNumStr + cStZatr
);


// таблица для хранения по продуктно сумм по СЗ и натуральных расходов
Table struct tpOutputSZ_Detal
(
  wNumStr    : word,
  cStZatr    : comp,
  cProd      : comp,
  dSum       : double,
  dAmount    : double,
  dVolAll    : double,
  dVolTov    : double
)
With Index
(
 tpOutputSZ_Detal01 = wNumStr + cProd + cStZatr,
 tpOutputSZ_Detal02 = cProd,
 tpOutputSZ_Detal03 = cStZatr
);

// таблица, содержащая суммы по СЗ и натуральные расходы планового варианта для ФА
Table struct tpOutputSZ_Plan
(
  wNumStr    : word,
  cStZatr    : comp,
  wNatur     : word,
  wFC        : word,
  dSum       : double,
  dAmount    : double,
  cKatEd     : comp
)
With Index
(
 tpOutputSZ_Plan01 = wNumStr + cStZatr,
 tpOutputSZ_Plan02 = wNatur
);

// таблица для хранения по продуктно сумм по СЗ и натуральных расходов планового варианта для ФА
Table struct tpOutSZ_DetalPlan
(
  wNumStr    : word,
  cStZatr    : comp,
  cProd      : comp,
  dSum       : double,
  dAmount    : double,
  dVolAll    : double,
  dVolTov    : double
)
With Index
(
 tpOutSZ_DetalPlan01 = wNumStr + cStZatr + cProd
);

// таблица, содержащая на текущий ПФ исходные суммы по СЗ и натуральные расходы
Table struct tpNoPF
(
  wNumStr    : word,
  wNatur     : word,
  cStZatr    : comp,
  dSum       : double,
  dAmount    : double,
  dSumPK     : double,
  cUchEd     : comp,    // для сводимости ЕИ разных ресурсов
  cKatEd     : comp
)
With Index
(
 tpNoPF01 = wNumStr + cStZatr,
 tpNoPF02 = wNatur
);

// таблица, содержащая результирующие суммы по СЗ и расходы переработки текущего ПФ на ПВ
Table struct tpRezultPF
(
  wPodr      : word,
  cPodr      : comp,
  wProduct   : word,
  cProduct   : comp,
  wPF        : word,
  cPF        : comp,
  wNumStr    : word,
  wNatur     : word,
  cStZatr    : comp,
  dSum       : double,
  dAmount    : double,
  cKatEd     : comp
)
With Index
(
 tpRezultPF01 = wPodr + cPodr + wProduct + cProduct + wPF + cPF + wNumStr + cStZatr,
 tpRezultPF02 = wPodr + cPodr + wProduct + cProduct + wNumStr + cStZatr
);

// таблица, содержащая движения ПФ по МВЗ
Table struct tpDvigCurPF
(
  nRec      : comp,
  nNum      : word,
  wPodr     : word,
  cPodr     : comp,
  dNZP      : double,
  dNZPSum   : double,
  dInComNZP : double,
  dInSumNZP : double,
  dInComCur : double,
  dProd     : double,
  dPotrNZP  : double,
  dPotrCur  : double,
  dSentNZP  : double,
  dSentCur  : double
)
With Index
(
 tpDvigCurPF01 = Nrec(Unique, Surrogate),
 tpDvigCurPF02 = nNum,
 tpDvigCurPF03 = wPodr + cPodr
);

// таблица Спецификация (tpDvigCurPF) переработок
Table struct tpSpDvigCurPF
(
  ctpDvigCurPF  : comp,
  wProduct      : word,
  cProduct      : comp,
  dAmountNZP    : double,
  dAmountSumNZP : double,
  dAmountCur    : double
)
With Index
(
 tpSpDvigCurPF01 = ctpDvigCurPF
)
;
