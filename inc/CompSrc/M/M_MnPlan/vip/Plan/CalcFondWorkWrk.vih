//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.1 - Производственный контур
// Объект для расчета трудоемкости
//------------------------------------------------------------------------------

#ifdef ComponentVersion
  #component "M_MnPlan"
#endif

#doc
  Описание интерфейса "Объект для расчета трудоемкости"</brief>
#end

ObjInterface oCalcFondWorkWrk;

//------------------------------------------------------------------------------
// Возвращает трудоемкость по цеху, профессии, варианту планирования
// wMode and 1 - в случае отсутствия данных по трудоемкости, рассчитывать
// wMode and 2 - пересчитывать в любом случае
// wMode and 4 - в случае отсутствия разреза cPodr + cKau - создавать
Function GetFondWorkWrk(cPodr: Comp; wKau: Word; cKau: Comp; cVaria: Comp;
                        wMode: Word; DatePer: Date;
                        Var dTime: Double; Var wKolEd: Word; Var dOtpTime: Double): LongInt;
//------------------------------------------------------------------------------
// Расчет трудоемкости по разрезу за период
// wRazrez = 0 Цех + профессия
//         = 1 Цех + оборудование
//         = 2 Цех + группа оборудование
//         = 3 Цех + сотрудник
Function CalcTimeForWrkOnePeriod(wRazrez: Word; cWrkRazrez: Comp; cVarPlan: Comp;
                                 cPodr: Comp; cVal1: Comp; dDatePer: Date): LongInt;

end;

ObjInterface oCalcFondWorkWrk2(oCalcFondWorkWrk);

//Вместо КОНКРЕТНОЙ даты передается сразу ПЕРИОД
//------------------------------------------------------------------------------
// Возвращает трудоемкость по цеху, профессии, варианту планирования
// wMode and 1 - в случае отсутствия данных по трудоемкости, рассчитывать
// wMode and 2 - пересчитывать в любом случае
// wMode and 4 - в случае отсутствия разреза cPodr + cKau - создавать
Function GetFondWorkWrkExp(cPodr: Comp; wKau: Word; cKau: Comp; cVaria: Comp;
                        wMode: Word; dDateBeg: Date; dDateEnd: Date;
                        Var dTime: Double; Var wKolEd: Word; Var dOtpTime: Double): LongInt;
//------------------------------------------------------------------------------
// Расчет трудоемкости по разрезу за период
// wRazrez = 0 Цех + профессия
//         = 1 Цех + оборудование
//         = 2 Цех + группа оборудование
//         = 3 Цех + сотрудник
Function CalcTimeForWrkOnePeriodExp(wRazrez: Word; cWrkRazrez: Comp; cVarPlan: Comp;
                                 cPodr: Comp; cVal1: Comp; dDateBeg: Date; dDateEnd: Date): LongInt;

End;

VipInterface CalcFondWorkWrk Implements oCalcFondWorkWrk2 Licensed(FREE);


