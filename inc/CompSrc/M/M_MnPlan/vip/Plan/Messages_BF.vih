// =============================================================================
//                                                     (c)  корпорация Галактика
// Галактика 7.11 - Производственный контур
// Описание интерфейса-объекта "Буфер значений типа "Сообщение""
// =============================================================================

#component "M_MnPlan"

//------------------------------------------------------------------------------
// Структура для хранения сообщения
#ifndef __Def_TMsgInfo__
#define __Def_TMsgInfo__
#doc
 Структура для хранения сообщения</brief><br>
 Поля:<br>
   dttTime        - Дата-время генерации сообщения <br>
   wMsgType       - Тип сообщения: Error, Warning, Information, Confirmation <br>
   sMsgText       - Текст сообщения <br>
   sParForAnyView - Значение первого параметра функции RunAnyView для отображения дополнительной информации к сообщению
   wMsgButtons    - Группа флагов отображения кнопок: OkButton, YesButton, NoButton, CancelButton
#end
Type TMsgInfo = record
  dttTime: _DateTime;     // Дата-время генерации сообщения
  wMsgType: word;         // Тип сообщения: Error, Warning, Information, Confirmation
  wMsgButtons: word;      // Группа флагов отображения кнопок: OkButton, YesButton, NoButton, CancelButton
  sParForAnyView: string; // Значение первого параметра функции RunAnyView для отображения дополнительной информации к сообщению
  sMsgText: string;       // Текст сообщения
end;
#End // Type TMsgInfo = record

//******************************************************************************
// ObjInterface oMessages_BF
#ifndef __Def_oMessages_BF__
#define __Def_oMessages_BF__
#doc
 Описание интерфейса-объекта "Буфер значений типа "Аналитика""</brief>
#end
ObjInterface oMessages_BF;

//------------------------------------------------------------------------------
#doc
 Очистка буфера значений</brief> <br>
#end
Procedure Clear;

//------------------------------------------------------------------------------
#doc
 Чтение количества значений в буфере</brief> <br>
 Результат: <br>
   Количество значений в буфере <br>
#end
Function _Count: longint;

//------------------------------------------------------------------------------
#doc
 Добавление значения в буфер</brief> <br>
 Параметры: <br>
   ardValue - Структура значения аналитики <br>
 Результат: <br>
   True, если успешно, иначе - False <br>
#end
Function Add(ardValue: TMsgInfo): boolean;

//------------------------------------------------------------------------------
#doc
 Удаление значения из буфера</brief> <br>
 Результат: <br>
   True, если успешно, иначе - False <br>
#end
Function DelCurrentValue: boolean;

//------------------------------------------------------------------------------
#doc
 Чтение текущего значения в буфере</brief> <br>
 Параметры: <br>
   ardValue - Структура значения аналитики (возвращается) <br>
 Результат: <br>
   True, если успешно, иначе - False <br>
#end
Function GetCurrentValue(var ardValue: TMsgInfo): boolean;

//------------------------------------------------------------------------------
#doc
 Чтение первого значения в буфере</brief> <br>
 Параметры: <br>
   ardValue - Структура значения аналитики (возвращается) <br>
 Результат: <br>
   True, если успешно, иначе - False <br>
#end
Function GetFirstValue(var ardValue: TMsgInfo): boolean;

//------------------------------------------------------------------------------
#doc
 Чтение последнего значения в буфере</brief> <br>
 Параметры: <br>
   ardValue - Структура значения аналитики (возвращается) <br>
 Результат: <br>
   True, если успешно, иначе - False <br>
#end
Function GetLastValue(var ardValue: TMsgInfo): boolean;

//------------------------------------------------------------------------------
#doc
 Чтение следующего значения в буфере относительно текущей позиции</brief> <br>
 Параметры: <br>
   ardValue - Структура значения аналитики (возвращается) <br>
 Результат: <br>
   True, если успешно, иначе - False <br>
#end
Function GetNextValue(var ardValue: TMsgInfo): boolean;

//------------------------------------------------------------------------------
#doc
 Чтение предыдущего значения в буфере относительно текущей позиции</brief> <br>
 Параметры: <br>
   ardValue - Структура значения аналитики (возвращается) <br>
 Результат: <br>
   True, если успешно, иначе - False <br>
#end
Function GetPrevValue(var ardValue: TMsgInfo): boolean;

End; // ObjInterface oMessages_BF

VipInterface iMessages_BF implements oMessages_BF Licensed(Free);

#endif
