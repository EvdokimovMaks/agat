#ifdef ComponentVersion
#component "M_MnPlan"
#end
 // Общие функции для работы с данными документов
objinterface oFuncForDoc;
   // Начальная инициализация ( запусти после загрузки объекта ).
   Function InitInter : boolean;
   // Убиваем все ( запусти перед выгрузкой объекта ).
   Function DoneInter : boolean;
   // Накачка таблиц TmpDoc,TmpSpDoc из данных документа(ов) Корпоративного планирования
   //  возвращает: 0 - без ошибок,
   //              1 - все другие ошибки,
   //              2 - не найден заданный вариант планирования,
   //              4 - не найдено ни одного документа по данным условиям
Function CreateTmpDoc_TmpSpDoc (
                cVariaPl    : comp; // ссылка на вариант планирования
                TypeDoc     : word; // тип документа toCorpoManuf и т.д.
                ConstRole   : word; // константа роли для поиска из CnstRole.vpp
                FieldNum1   : word; // номер поля (1..14) из представления для TmpSpDoc.Kol
                FieldNum2   : word; // номер поля (1..14) из представления для TmpSpDoc.Kol2
                FieldNum3   : word; // номер поля (1..14) из представления для TmpSpDoc.Kol3
                cKatNotes   : comp; // ссылка на статус позиций SpMnPl.cStatus
                NRecOrg     : comp; // KatOrg.NRec, если нет, то по всем
                NRecMC      : comp; // KatMC.NRec, если нет, то по всем
                cFpTper     : comp; // тип периода планирования FpTper.NRec
                BegDate     : date; // дата привязки от
                EndDate     : date; // дата привязки до
                FlagRun     : word; // 1 - выдавать сообщения об ошибках
                DeleteTable : Boolean // True - удаляем TmpDoc,TmpSpDoc перед расчетом
                                  ) : word;
   //-----------------------------------------------------------------------------------------
end; // oFuncForDoc

VipInterface FuncForDoc implements oFuncForDoc
#ifdef ATL51
Licensed (FREE)
#endif
;
