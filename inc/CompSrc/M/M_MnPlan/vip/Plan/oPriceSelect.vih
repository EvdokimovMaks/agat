/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,01 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Планирование                                              ║
 ║ Версия        : 7.10                                                      ║
 ║ Назначение    : Объект для подбора цены в прайс-листах по значению        ║
 ║                 аналитики МЦ типа "Интервал". Прототип                    ║
 ║ Ответственный : Барановский Алексей Леонидович (Aleksis)                  ║
 ║ Параметры     : Нет                                                       ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#ifndef __OPRICESELECTION_VIH
#define __OPRICESELECTION_VIH

ObjInterface oPriceSelection;

//=======================================================================
//'Задать режим работы объекта
//'p_wFlag - битовый флаг, первый бит - самый младший
//
//'1 бит - Установлен: Выдать список цен для выбора
//         Не установлен: Берется наиболее приоритетная цена
//
//'2 бит - Установлен: При равной разнице в значении свойства
//'        предпочтение меньшей цене:
//         (100 кг по 100 руб.) < 250 кг < (400 кг по 120 руб.) -->  100 руб.
//         Не установлен: предпочтение большей:
//'                                                         ... -->  400 руб.
//'3 бит - Установлен. Цена выбирается из всех прайс-листов наиболее близкая
//'        по значению свойства
//         Не установлен: Цена выбирается по приоритетам прайс-листов
//
//'4 бит - Тип поиска значения.
//         Установлен: ближайшее большее значение
//         Не установлен: ближайшее значение
//
//'5 бит - Установлен: Цена получается как пропорция из двух значений и
//         цены в прайсе.
//         Не установлен: Цена берется из прайс-листа
//-----------------------------------------------------------------------
Procedure psSetMode( p_wFlag:Word );

//=======================================================================
//'Установить МЦ/Услугу
//'p_wPrMC = 1  -  МЦ
//'p_wPrMC = 2  -  Услуга
//'p_wSearchFlag = 1 - поиск по шаблону
//'p_wSearchFlag = 2 - поиск по группе МЦ/услуг
//'p_wSearchFlag = 3 - поиск по аналитике роли
//'Возвращает True в случае успеха
//-----------------------------------------------------------------------
Function psSetObject( p_wPrMC:Word; p_cMCUsl:Comp; p_wSearchFlag:Word ) : Boolean;

//=======================================================================
//Установить роль аналитики МЦ типа "Интервал"
//'Возвращает True в случае успеха
//-----------------------------------------------------------------------
Function psSetRole( p_cKatRole:Comp ) : Boolean;

//=======================================================================
//'Добавить прайс-лист
//'p_wPrior - приоритет прайс-листа, 0-самый высокий
//'Возвращает True в случае успеха
//-----------------------------------------------------------------------
Function psAddPriceList( p_cKlPrice:Comp; p_wPrior:Word ) : Boolean;

//=======================================================================
//'УДАЛИТЬ ВСЕ ПРАЙС-ЛИСТЫ ИЗ СПИСКА
//'Возвращает True в случае успеха
//-----------------------------------------------------------------------
Function psDelAllPriceLists : Boolean;

//=======================================================================
//'Получить цену
//'Возвращает цену для МЦ/Услуги в параметрах и код возврата:
//'0 - Все Ok
//'1 - фатальная ошибка
//'2 - у объекта не существует заданного свойства либо свойство равно 0
//-----------------------------------------------------------------------
Function psGetPrice( Var p_dblPrice:Double; Var p_cVal:Comp ) : Word;
End;
#endif  // __OPRICESELECTION_VIH