//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.1 - Производственный контур
// Объединение записей журнала
//------------------------------------------------------------------------------

#ifdef ComponentVersion
#component "M_MnPlan"
#end

Type stUnion_RSV = Record
  wPar1    : Word;
  wPar2    : Word;
  wPar3    : Word;
  cRsv     : Comp;
  cRsvFirst: Comp; // NRec новой объединенной записи журнала (только для записей, переданных через AddRsvOperToUnion)
  cPodr    : Comp;
  cParty   : Comp;
End;

#doc
 Описание объекта "Объединение записей журнала"</brief>
#end

ObjInterface oRsvOperUnion;

//------------------------------------------------------------------------------
// stUnRsv.wPar1  - общие параметры объединения (битовая маска)
//             1  - учитывать пользовательское состояние (если используется регламент)
//             2  - учитывать системное состояние
//             4  - учитывать статус
//             8  - учитывать ПЦ (если не учитывать, то берется 1-ый попавшийся)
//             16 - учитывать партии
//             32 - объединять в рамках заданного подразделения (cPodr)
//             64 - объединять в рамках заданной партии (cParty)
// stUnRsv.wPar2  - параметры поиска записей журнала для объединения
//            and 1  - объединять все последующие в рамках текущего маршрута
//            and 2  - объединять все предыдущие в рамках текущего маршрута
//            and 4  - вызывать окно установки параметров
//            and 8  - показывать сообщения
//            and 16 - объединять до первой контрольной
Function UnionRsvOperExt(Var stUnRsv: stUnion_RSV): Boolean;

//------------------------------------------------------------------------------
Function AddRsvOperToUnion(cRsvOper: Comp): Boolean;

//------------------------------------------------------------------------------
Procedure DelAllRsvOperToUnion;

end;

VipInterface RsvOperUnion implements oRsvOperUnion #Licensed_Free;
