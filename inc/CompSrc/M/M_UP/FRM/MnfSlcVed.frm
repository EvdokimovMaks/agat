//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 7.12 - Управление производственной логистикой
// Сличительная ведомость ИНВ N 19
//********************************************************************************

#Doc
  Сличительная ведомость ИНВ N 19</Brief>
#End

.set name='MnfSlcVed'
.hide
.var
  количество_партии : double
  цена_партии : double
  sKolZnak : string[10]
.endvar
.fields
   NRec_инвентаризации:comp
   номер_приказа:string
   дата_приказа:date
   дата_инвентаризации:date
   дата_окончания_инвентаризации:date
   номер_инвентаризации
   подразделение:string
   мол:string
   Кол_число_знаков:word
      NRec_спецификации:comp
      мц_код:string
      мц_название:string
      ед_измерения:string
      дата_выявления:date // стоит SkipFormat
      количество:double   // стоит SkipFormat
      подразделение_1:string
      мол_1:string
      nRecParty : comp
      партия:string
      дата_партии
      кол_инвентаризации:double
      кол_программно:double
      цена_программно:double
      NameLong : String
.endfields
-------------------------------------------------------------------------------
   NRec_инвентаризации:comp        ^
   номер_приказа:string            ^
   дата_приказа:date               ^
   дата_инвентаризации:date        ^
   дата_окончания_инвентаризации:date ^
   номер_инвентаризации            ^
   подразделение:string                    ^
   мол:string                      ^
   Кол_число_знаков:word           ^
.begin
  Case Кол_число_знаков of
    0 : sKolZnak := '';
    2 : sKolZnak := '.88';
    3 : sKolZnak := '.888';
    4 : sKolZnak := '.8888';
    5 : sKolZnak := '.88888';
    6 : sKolZnak := '.888888';
    7 : sKolZnak := '.8888888';
    8 : sKolZnak := '.88888888';
    9 : sKolZnak := '.888888888';
  else
    sKolZnak := '.8';
  End;
end.
.{
.[h OverWrite
  ТЕСТ
.]h
      NRec_спецификации:comp       ^
      мц_код:string                ^
      мц_название:string           ^
      ед_измерения:string          ^
      дата_выявления:date          ^
      количество:double            ^
.if MnfFlagParty_slic
.{
      подразделение_1:string       ^
      мол_1:string                 ^
      nRecParty                    ^
      партия:string                ^
      дата_партии:date             ^
      кол_инвентаризации:double    ^
      кол_программно:double        ^
      цена_программно:double       ^
      NameLong : String            ^
.begin
  количество_партии := кол_программно;
  цена_партии := цена_программно;
end.
.}
.end
.}
.endform

.LinkForm 'MnfSlcVed1' ProtoType Is 'MnfSlcVed'
.NameInList 'ИНВ N 19'
.Group 'Бланки'
.Group 'Ведомости'
.Group 'Сличительные ведомости'
.var
  i, ipt, pkol, pkol2 : integer;
  pkoli, pkoln        : double;
  psumi, psumn        : double;
.endvar
.create view slic_log1
  as select
    KatOrg.Name, KatOrg.OKPO
  from
    KatOrg
  where
    ((
    coGetTune('MyOrg') == KatOrg.nRec
    ))
;
.fields
    CommonFormHeader
    if (SLIC_LOG1.GetFirst KatOrg = tsOk, SLIC_LOG1.KatOrg.Name, '')
    if (SLIC_LOG1.GetFirst KatOrg = tsOk, SLIC_LOG1.KatOrg.OKPO, '')
    подразделение
    номер_приказа
    if(дата_приказа = Date(0,0,0), '', DateToStr(дата_приказа, 'DD/MM/YYYY'))
    дата_инвентаризации
    if(дата_окончания_инвентаризации = Date(0,0,0), '', DateToStr(дата_окончания_инвентаризации, 'DD/MM/YYYY'))
    'true' : 's'
.endfields
.begin
  i    := 0;
  pkol := 0;
end.
.p 50
.defo landscape
^


 Ш                                                                                                                                                                        Унифицированная форма N ИНВ-19
                                                                                                                                                                        Утверждена постановлением Госкомстата
                                                                                                                                                                        России от 18.08.98 N 88
                                                                                                                                                                                       ┌─────────────────────┐
                                                                                                                                                                                       │         Код         │
                                                                                                                                                                                       ╠═════════════════════╣
                                                                                                                                                                        Форма по ОКУД  ║       0317017       ║
                                                                                                                                                                                       ╟─────────────────────╢
       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  по ОКПО  ║@~@@@@@@@@@@@@@@@@@@@║
       ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ╟─────────────────────╢
       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  ║                     ║
       ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╫─────────────────────╢
                                                                               структурное подразделение                                                             Вид деятельности  ║                     ║
                                                                                                                                                                             ┌─────────╫─────────────────────╢
                                                 Основание для проведения инвентаризации:                        приказ, постановление, распоряжение                         │  номер  ║&~&&&&&&&&&&&&&&&&&&&║
                                                                                          ───────────────────────────────────────────────────────────────────────────────────┼─────────╫─────────────────────╢
                                                                                                                         ненужное зачеркнуть                                 │   дата  ║@~@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                             └─────────╫─────────────────────╢
                                                                                                                                                           Дата начала инвентаризации  ║@~@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                                       ╟─────────────────────╢
                                                                                                                                                        Дата окончания инвентаризации  ║@~@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                                       ╟─────────────────────╢
                                                                                                                                                                         Вид операции  ║                     ║
                                                                                                                                                                                       ╚═════════════════════╝
                                                                                                                                              ┌────────────────────┬────────────────────┐
                                                                                                                                              │  Номер документа   │  Дата составления  │
                                                                                                                                              ╠════════════════════╪════════════════════╣
                                                                                 БС Л И Ч И Т Е Л Ь Н А Я   В Е Д О М О С Т Ь Б                   ║                    │                    ║
                                                                                                                                              ╚════════════════════╧════════════════════╝
                                                                          Брезультатов инвентаризации товарно-материальных ценностей Б

             Проведена инвентаризация фактического наличия ценностей, находящихся на ответственном хранении


                  ___________________________________________     _____________________________________________________________________________________________________________________________________
                                   должность                                                                             фамилия, имя, отчество
                  ___________________________________________     _____________________________________________________________________________________________________________________________________
                                   должность                                                                             фамилия, имя, отчество

             по состоянию на  "_____" ________________________  _________ г.

             При инвентаризации установлено следующее: Ш
^
.fields
      pkol
      if(мц_название='','',string(i))
      мц_название +' '+if(партия<>'', '(партия: ' +партия+ ')', '(без партии)')
      мц_код : 'p:r'
      ед_измерения
       // излишек
      if(кол_программно-кол_инвентаризации<0,
         DoubleToStr(кол_инвентаризации-кол_программно,
                     '[|-]3666`666`666`666`666'+sKolZnak),
         '' )
      if(кол_программно-кол_инвентаризации<0,
         (кол_инвентаризации-кол_программно)*цена_программно,
         double(0))

       // недостача
      if(кол_программно-кол_инвентаризации>0,
         DoubleToStr(кол_программно-кол_инвентаризации,
                     '[|-]3666`666`666`666`666'+sKolZnak),
         '' )
      if(кол_программно-кол_инвентаризации>0,
         (кол_программно-кол_инвентаризации)*цена_программно,
         double(0))
.endfields
.{
.[h OverWrite
.begin
  pkoli := 0
  pkoln := 0;
  psumi := 0;
  psumn := 0;
  pkol  := pkol+2;
end.
 Ш                                                                                                                                                                                      &&-я страница формы N ИНВ-19
┌───┬─────────────────────────────────────────────┬───────────────────┬───────────────────┬─────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────┐
│   │        Товарно-материальные ценности        │ Единица измерения │      Номер        │                Результаты инвентаризации                │       Отрегулировано за счет уточнения записей в учете      │
│   ├───────────────────────────────┬─────────────┼────────┬──────────┼────────┬──────────┼────────────────────────────┬────────────────────────────┼──────────────────────────────┬──────────────────────────────┤
│ N │         наименование,         │     код     │        │          │        │ паспорта │          излишек           │         недостача          │            излишек           │           недостача          │
│п/п│        характеристика         │   (номен-   │ код по │ наимено- │ инвен- │(документа├────────────┬───────────────┼────────────┬───────────────┼──────┬─────────┬─────────────┼──────┬─────────┬─────────────┤
│   │      (вид, сорт, группа)      │  клатурный  │  ОКЕИ  │  вание   │ тарный │  о ре-   │ количество │     сумма,    │ количество │     сумма,    │ коли-│  сумма, │номер счета, │ коли-│  сумма, │номер счета, │
│   │                               │    номер)   │        │          │        │гистрации)│            │   руб. коп.   │            │   руб. коп.   │чество│руб. коп.│статьи,заказа│чество│руб. коп.│статьи,заказа│
├───┼───────────────────────────────┼─────────────┼────────┼──────────┼────────┼──────────┼────────────┼───────────────┼────────────┼───────────────┼──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤
│ 1 │               2               │      3      │   4    │     5    │    6   │     7    │     8      │       9       │     10     │      11       │  12  │   13    │     14      │  15  │   16    │     17      │
├───┼───────────────────────────────╬═════════════╪════════╬──────────╬════════╪══════════╪════════════╪═══════════════╪════════════╪═══════════════╬──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤ Ш
.]h
.if MnfFlagParty_slic
.{
.begin
  i := i+1;

  pkoli := pkoli + if((кол_программно - кол_инвентаризации) < 0,
                      кол_инвентаризации - кол_программно, double(0));
  pkoln := pkoln + if((кол_программно - кол_инвентаризации) > 0,
                      кол_программно - кол_инвентаризации, double(0));
  psumi := psumi + if((кол_программно-кол_инвентаризации)<0,
                      (кол_инвентаризации-кол_программно)*цена_программно,
                      double(0)) ;
  psumn := psumn + if((кол_программно-кол_инвентаризации)>0,
                      (кол_программно-кол_инвентаризации)*цена_программно,
                      double(0)) ;
end.
 Ш│&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@│        ║@@@@@@@@@@║        │          │&#&&&&&&&&&&│&#&&&&&&&&&&.&&│&#&&&&&&&&&&│&#&&&&&&&&&&.&&║      │         │             │      │         │             │ Ш
.}
.end
.[f
.fields
  if(pkoli > 0,     DoubleToStr(pkoli, '[|-]3666`666`666`666`666' + sKolZnak), '')
  if(psumi >= 0.01, DoubleToStr(psumi,'[|-]3666`666`666`666`666.88'), '')
  if(pkoln > 0,     DoubleToStr(pkoln, '[|-]3666`666`666`666`666' + sKolZnak), '')
  if(psumn >= 0.01, DoubleToStr(psumn,'[|-]3666`666`666`666`666.88'), '')
.endfields
 Ш└───┴───────────────────────────────╩═════════════╧════════╩──────────╩════════╧══════════╪════════════╪═══════════════╪════════════╪═══════════════╬──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤
                                                                                    БИтого Б  │ Б&#&&&&&&&&&& Б│ Б&#&&&&&&&&&&&&& Б│ Б&#&&&&&&&&&& Б│ Б&#&&&&&&&&&&&&& Б│      │         │             │      │         │             │
                                                                                          └────────────┴───────────────┴────────────┴───────────────┴──────┴─────────┴─────────────┴──────┴─────────┴─────────────┘

                  Бухгалтер          _________________________________    _______________________________________________________________________________
                                                  подпись                                             расшифровка подписи Ш
.]f
.}
.begin
  ipt   := 0;
  pkol2 := 1;
end.
.fields
    'true' : 's'
.endfields
^
.{While(ipt<i)
.[h OverWrite
.begin
  pkol2 := pkol2+2;
end.
.fields
      pkol2
.endfields
 Ш                                                                                                                                                                                       &&-я страница формы N ИНВ-19
┌─────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────┐
│                                         Пересортица                                         │ Приходуются окончательные излишки    │                          Окончательные недостачи                            │
├──────────────────────────────────────────────┬──────────────────────────────────────────────┼────────────┬────────────┬────────────┼─────────────────────────┬─────────────────────────┬─────────────────────────┤
│    излишки, зачтенные в покрытие недостач    │         недостачи, покрытые излишками        │            │            │            │                         │                         │                         │
├────────────┬──────────────┬──────────────────┼────────────┬──────────────┬──────────────────┤ количество │   сумма,   │   номер    ├────────────┬────────────┼────────────┬────────────┼────────────┬────────────┤
│ количество │    сумма,    │ порядковый номер │ количество │    сумма,    │ порядковый номер │            │  руб. коп. │   счета    │ количество │   сумма,   │ количество │   сумма,   │ количество │   сумма,   │
│            │   руб. коп.  │зачтенных излишков│            │   руб. коп.  │зачтенных излишков│            │            │            │            │  руб. коп. │            │  руб. коп. │            │  руб. коп. │
├────────────┼──────────────┼──────────────────┼────────────┼──────────────┼──────────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┤
│     18     │      19      │        20        │     21     │      22      │        23        │     24     │     25     │     26     │     27     │     28     │     29     │     30     │     31     │     32     │
├────────────┼──────────────┼──────────────────┼────────────┼──────────────┼──────────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┤ Ш
.]h
.begin
  ipt := ipt+1;
end.
 Ш│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │ Ш
.[f
.fields
  мол
.endfields
 Ш└────────────┴──────────────┴──────────────────┴────────────┴──────────────┴──────────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┘
  С результатами сличения ознакомлен:
            Материально ответственное(ые) лицо(а)  _________________________________   ___________________________    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                               должность                         подпись                                            расшифровка подписи
                                                   _________________________________   ___________________________   _________________________________________________________________________________
                                                               должность                         подпись                                            расшифровка подписи Ш
.]f
.}
.endform


.LinkForm 'MnfSlcVed2' ProtoType is 'MnfSlcVed'
.NameInList 'ИНВ N 19 (c вариантами наименований)'
.Group 'Бланки'
.Group 'Ведомости'
.Group 'Сличительные ведомости'
.var
  i, ipt, pkol, pkol2 : integer;
  pkoli, pkoln        : double;
  psumi, psumn        : double;
.endvar
.create view slic_log1
  as select
    KatOrg.Name, KatOrg.OKPO
  from
    KatOrg
  where
    ((
    coGetTune('MyOrg') == KatOrg.nRec
    ))
;
.fields
    CommonFormHeader
    if (SLIC_LOG1.GetFirst KatOrg = tsOk, SLIC_LOG1.KatOrg.Name, '')
    if (SLIC_LOG1.GetFirst KatOrg = tsOk, SLIC_LOG1.KatOrg.OKPO, '')
    подразделение
    номер_приказа
    if(дата_приказа = Date(0,0,0), '', DateToStr(дата_приказа, 'DD/MM/YYYY'))
    дата_инвентаризации
    if(дата_окончания_инвентаризации = Date(0,0,0), '', DateToStr(дата_окончания_инвентаризации, 'DD/MM/YYYY'))
    'true' : 's'
.endfields
.begin
  i    := 0;
  pkol := 0;
end.
.p 50
.defo landscape
^


 Ш                                                                                                                                                                        Унифицированная форма N ИНВ-19
                                                                                                                                                                        Утверждена постановлением Госкомстата
                                                                                                                                                                        России от 18.08.98 N 88
                                                                                                                                                                                       ┌─────────────────────┐
                                                                                                                                                                                       │         Код         │
                                                                                                                                                                                       ╠═════════════════════╣
                                                                                                                                                                        Форма по ОКУД  ║       0317017       ║
                                                                                                                                                                                       ╟─────────────────────╢
       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  по ОКПО  ║@~@@@@@@@@@@@@@@@@@@@║
       ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ╟─────────────────────╢
       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  ║                     ║
       ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╫─────────────────────╢
                                                                               структурное подразделение                                                             Вид деятельности  ║                     ║
                                                                                                                                                                             ┌─────────╫─────────────────────╢
                                                 Основание для проведения инвентаризации:                        приказ, постановление, распоряжение                         │  номер  ║&~&&&&&&&&&&&&&&&&&&&║
                                                                                          ───────────────────────────────────────────────────────────────────────────────────┼─────────╫─────────────────────╢
                                                                                                                         ненужное зачеркнуть                                 │   дата  ║@~@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                             └─────────╫─────────────────────╢
                                                                                                                                                           Дата начала инвентаризации  ║@~@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                                       ╟─────────────────────╢
                                                                                                                                                        Дата окончания инвентаризации  ║@~@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                                       ╟─────────────────────╢
                                                                                                                                                                         Вид операции  ║                     ║
                                                                                                                                                                                       ╚═════════════════════╝
                                                                                                                                              ┌────────────────────┬────────────────────┐
                                                                                                                                              │  Номер документа   │  Дата составления  │
                                                                                                                                              ╠════════════════════╪════════════════════╣
                                                                                 БС Л И Ч И Т Е Л Ь Н А Я   В Е Д О М О С Т Ь Б                   ║                    │                    ║
                                                                                                                                              ╚════════════════════╧════════════════════╝
                                                                          Брезультатов инвентаризации товарно-материальных ценностей Б

             Проведена инвентаризация фактического наличия ценностей, находящихся на ответственном хранении


                  ___________________________________________     _____________________________________________________________________________________________________________________________________
                                   должность                                                                             фамилия, имя, отчество
                  ___________________________________________     _____________________________________________________________________________________________________________________________________
                                   должность                                                                             фамилия, имя, отчество

             по состоянию на  "_____" ________________________  _________ г.

             При инвентаризации установлено следующее: Ш
^
.fields
      pkol
      if(мц_название='','',string(i))
      мц_название +' '+if(партия<>'', '(партия: ' +партия+ ')', '(без партии)')
      мц_код : 'p:r'
      ед_измерения
       // излишек
      if(кол_программно-кол_инвентаризации<0,
         DoubleToStr(кол_инвентаризации-кол_программно,
                     '[|-]3666`666`666`666`666'+sKolZnak),
         '' )
      if(кол_программно-кол_инвентаризации<0,
         (кол_инвентаризации-кол_программно)*цена_программно,
         double(0))

       // недостача
      if(кол_программно-кол_инвентаризации>0,
         DoubleToStr(кол_программно-кол_инвентаризации,
                     '[|-]3666`666`666`666`666'+sKolZnak),
         '' )
      if(кол_программно-кол_инвентаризации>0,
         (кол_программно-кол_инвентаризации)*цена_программно,
         double(0))
      NameLong : 'd:r'
.endfields
.{
.[h OverWrite
.begin
  pkoli := 0
  pkoln := 0;
  psumi := 0;
  psumn := 0;
  pkol  := pkol+2;
end.
 Ш                                                                                                                                                                                      &&-я страница формы N ИНВ-19
┌───┬─────────────────────────────────────────────┬───────────────────┬───────────────────┬─────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────┐
│   │        Товарно-материальные ценности        │ Единица измерения │      Номер        │                Результаты инвентаризации                │       Отрегулировано за счет уточнения записей в учете      │
│   ├───────────────────────────────┬─────────────┼────────┬──────────┼────────┬──────────┼────────────────────────────┬────────────────────────────┼──────────────────────────────┬──────────────────────────────┤
│ N │         наименование,         │     код     │        │          │        │ паспорта │          излишек           │         недостача          │            излишек           │           недостача          │
│п/п│        характеристика         │   (номен-   │ код по │ наимено- │ инвен- │(документа├────────────┬───────────────┼────────────┬───────────────┼──────┬─────────┬─────────────┼──────┬─────────┬─────────────┤
│   │      (вид, сорт, группа)      │  клатурный  │  ОКЕИ  │  вание   │ тарный │  о ре-   │ количество │     сумма,    │ количество │     сумма,    │ коли-│  сумма, │номер счета, │ коли-│  сумма, │номер счета, │
│   │                               │    номер)   │        │          │        │гистрации)│            │   руб. коп.   │            │   руб. коп.   │чество│руб. коп.│статьи,заказа│чество│руб. коп.│статьи,заказа│
├───┼───────────────────────────────┼─────────────┼────────┼──────────┼────────┼──────────┼────────────┼───────────────┼────────────┼───────────────┼──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤
│ 1 │               2               │      3      │   4    │     5    │    6   │     7    │     8      │       9       │     10     │      11       │  12  │   13    │     14      │  15  │   16    │     17      │
├───┴───────────────────────────────╧═════════════╧════════╧══════════╧════════╧══════════╧════════════╧═══════════════╧════════════╧═══════════════╧──────┴─────────┴─────────────┴──────┴─────────┴─────────────┤ Ш
.]h
.if MnfFlagParty_slic
.{
.begin
  i := i+1;

  pkoli := pkoli + if((кол_программно - кол_инвентаризации) < 0,
                      кол_инвентаризации - кол_программно, double(0));
  pkoln := pkoln + if((кол_программно - кол_инвентаризации) > 0,
                      кол_программно - кол_инвентаризации, double(0));
  psumi := psumi + if((кол_программно-кол_инвентаризации)<0,
                      (кол_инвентаризации-кол_программно)*цена_программно,
                      double(0)) ;
  psumn := psumn + if((кол_программно-кол_инвентаризации)>0,
                      (кол_программно-кол_инвентаризации)*цена_программно,
                      double(0)) ;
end.
 Ш├───┬───────────────────────────────╥─────────────┬────────╥──────────╥────────┬──────────┬────────────┬───────────────┬────────────┬───────────────╥──────┬─────────┬─────────────┬──────┬─────────┬─────────────┤ Ш
 Ш│&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@│        ║@@@@@@@@@@║        │          │&#&&&&&&&&&&│&#&&&&&&&&&&.&&│&#&&&&&&&&&&│&#&&&&&&&&&&.&&║      │         │             │      │         │             │ Ш
 Ш│   └───────────────────────────────╨─────────────┴────────╨──────────╨────────┴──────────┴────────────┴───────────────┴────────────┴───────────────╨──────┴─────────┴─────────────┴──────┴─────────┴─────────────┤ Ш
 Ш│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ Ш
.}
.end
.[f
.fields
  if(pkoli > 0,     DoubleToStr(pkoli, '[|-]3666`666`666`666`666' + sKolZnak), '')
  if(psumi >= 0.01, DoubleToStr(psumi,'[|-]3666`666`666`666`666.88'), '')
  if(pkoln > 0,     DoubleToStr(pkoln, '[|-]3666`666`666`666`666' + sKolZnak), '')
  if(psumn >= 0.01, DoubleToStr(psumn,'[|-]3666`666`666`666`666.88'), '')
.endfields
 Ш└───────────────────────────────────══════════════════════════════════════════════════════╤════════════╤═══════════════╤════════════╤═══════════════╤──────┬─────────┬─────────────┬──────┬─────────┬─────────────┤
                                                                                    БИтого Б  │ Б&#&&&&&&&&&& Б│ Б&#&&&&&&&&&&&&& Б│ Б&#&&&&&&&&&& Б│ Б&#&&&&&&&&&&&&& Б│      │         │             │      │         │             │
                                                                                          └────────────┴───────────────┴────────────┴───────────────┴──────┴─────────┴─────────────┴──────┴─────────┴─────────────┘

                  Бухгалтер          _________________________________    _______________________________________________________________________________
                                                  подпись                                             расшифровка подписи Ш
.]f
.}
.begin
  ipt   := 0;
  pkol2 := 1;
end.
.fields
    'true' : 's'
.endfields
^
.{While(ipt<i)
.[h OverWrite
.begin
  pkol2 := pkol2+2;
end.
.fields
      pkol2
.endfields
 Ш                                                                                                                                                                                       &&-я страница формы N ИНВ-19
┌─────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────┐
│                                         Пересортица                                         │ Приходуются окончательные излишки    │                          Окончательные недостачи                            │
├──────────────────────────────────────────────┬──────────────────────────────────────────────┼────────────┬────────────┬────────────┼─────────────────────────┬─────────────────────────┬─────────────────────────┤
│    излишки, зачтенные в покрытие недостач    │         недостачи, покрытые излишками        │            │            │            │                         │                         │                         │
├────────────┬──────────────┬──────────────────┼────────────┬──────────────┬──────────────────┤ количество │   сумма,   │   номер    ├────────────┬────────────┼────────────┬────────────┼────────────┬────────────┤
│ количество │    сумма,    │ порядковый номер │ количество │    сумма,    │ порядковый номер │            │  руб. коп. │   счета    │ количество │   сумма,   │ количество │   сумма,   │ количество │   сумма,   │
│            │   руб. коп.  │зачтенных излишков│            │   руб. коп.  │зачтенных излишков│            │            │            │            │  руб. коп. │            │  руб. коп. │            │  руб. коп. │
├────────────┼──────────────┼──────────────────┼────────────┼──────────────┼──────────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┤
│     18     │      19      │        20        │     21     │      22      │        23        │     24     │     25     │     26     │     27     │     28     │     29     │     30     │     31     │     32     │
├────────────┼──────────────┼──────────────────┼────────────┼──────────────┼──────────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┤ Ш
.]h
.begin
  ipt := ipt+1;
end.
 Ш│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │ Ш
.[f
.fields
  мол
.endfields
 Ш└────────────┴──────────────┴──────────────────┴────────────┴──────────────┴──────────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┘
  С результатами сличения ознакомлен:
            Материально ответственное(ые) лицо(а)  _________________________________   ___________________________    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                               должность                         подпись                                            расшифровка подписи
                                                   _________________________________   ___________________________   _________________________________________________________________________________
                                                               должность                         подпись                                            расшифровка подписи Ш
.]f
.}
.endform
