//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 7.12 - Управление производственной логистикой
// Печать акта на списание МЦ из производства
//********************************************************************************
#include Commission.frn

#Doc
  Печать акта на списание МЦ из производства</Brief>
#End

.Set Name = 'aktspis'
.Hide

.Fields
 ТипОрг      :String   // Тип организации - ОАО, ЗАО, и т.д.
 MyOrg       :string   // Название собственной организации
 ОКПО        :string   // ОКПО собственной организации
 NRec_KatSopr
 Номер_акта
 Дата
 Наименование
 Назначение
 Подразделение
 Должность
 МОЛ
 Сумма
 Валюта

  NRec_SpSopr
  НазваниеМЦ
  НоменклНом
  ИнвНом
  КодЕдиницы
  Единицы
  Партия
  Количество :Double
  Цена       :Double
  NameLong

 #CommissionFields

.EndFields

.{
 ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.{
 ^
 ^ ^ ^ ^ ^ ^ ^ ^
.if ValidNameLong
^
.end
.}

.if PrintComission
#CommissionBody(aktspis)
.end

.}
.EndForm

.linkform 'aktspis_01' prototype is 'aktspis'
.NameInList ' Акт списания МЦ из производства'
#CommissionLinkVar
.var
  TotCnt : Double
  SumPr  : Double
  TotSum : Double
.endvar

.fields
CommonFormHeader

 MyOrg
 Номер_акта
 Дата
 Наименование  
 Подразделение
 Должность
 МОЛ
 Сумма
 Валюта
 Валюта
 Валюта
.endfields
.{
.begin
 TotSum:=0
end.
^
Организация: ^

                  Акт № @@@@@@@@@@@@@ от @@@@@@@@@@@
           на @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
           из подразделения @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
           МОЛ  Б Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  Б
                    должность                              фамилия, инициалы
           На сумму &'&&&&&&&&&&& @@@@@@

─────────────────────────┬─────────┬───────────────┬──────────┬─────────────┬─────────────────
         Название МЦ     │ Единица │    Партия     │Количество│  Цена за    │    Сумма, @@@@@@
                         │измерения│               │          │единицу, @@@@│
─────────────────────────┼─────────┼───────────────┼──────────┼─────────────┼─────────────────
.{
.begin
 TotCnt := TotCnt + Количество
 SumPr  := Количество*Цена
 TotSum := TotSum + SumPr

end.
.Fields
  НазваниеМЦ
  Единицы
  Партия
  Количество
  Цена
  SumPr
  NameLong
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@│&'&&&&&&&&│&'&&&&&&&&&&&│&'&&&&&&&&&&&&.&&
.if ValidNameLong
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.}
─────────────────────────┴─────────┴───────────────┴──────────┴─────────────┴─────────────────
.Fields
  TotSum
.endfields
                                                                Итого:       &'&&&&&&&&&&&&.&&

.if PrintComission
#CommissionLinkInit(aktspis)

.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
 ИПредседатель комиссии       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ___________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 Ш                                                               должность                                     подпись                                    расшифровка подписи Ш
.{ While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
 И@@@@@@@@@@@@@@@             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ___________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 Ш                                                               должность                                     подпись                                    расшифровка подписи Ш
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 ИЧлены комиссии:            _____________________________  ___________________  __________________________________ И
 Ш                                                               должность                                     подпись                                    расшифровка подписи Ш
 И                           _____________________________  ___________________  __________________________________ И
 Ш                                                               должность                                     подпись                                    расшифровка подписи Ш
.}
.end


.}
.endform

.LinkForm 'AKTSPIS_02' Prototype is 'aktspis'
.NameInList 'Акт списания МЦ из производства 2'
#CommissionLinkVar
.var
  TotCnt : Double
  SumPr  : Double
  TotSum : Double
.endvar
.fields
  CommonFormHeader
  MyOrg
  Номер_акта
  Дата
  Наименование
  Подразделение
  Должность
  МОЛ
  Сумма
  Валюта
  Валюта
  Валюта
.endfields
.{
.begin
 TotSum:=0
end.
^
Организация: ^

                  Акт № @@@@@@@@@@@@@ от @@@@@@@@@@@@@@
           на @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
           из подразделения @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
           МОЛ  Б Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  Б
                    должность                              фамилия, инициалы
           На сумму &'&&&&&&&&&&&&&&&&&& @@@@@@

─────────────────────────┬─────────┬───────────────┬──────────┬────────────────┬─────────────────
         Название        │ Единица │    Партия     │Количество│  Цена за       │    Сумма, @@@@@@
                         │измерения│               │          │ единицу, @@@@@@│
─────────────────────────┼─────────┼───────────────┼──────────┼────────────────┼─────────────────
.{
.begin
 TotCnt := TotCnt + Количество
 SumPr  := Количество*Цена
 TotSum := TotSum + SumPr

end.
.Fields
  НазваниеМЦ
  Единицы
  Партия
  Количество
  Цена
  SumPr
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@│&'&&&&&&&&│&'&&&&&&&&&&&&  │&'&&&&&&&&&&&&.&&
.if ValidNameLong
.end
.}
─────────────────────────┴─────────┴───────────────┴──────────┴────────────────┴─────────────────
.Fields
  TotSum
.endfields
                                                                   Итого:       &'&&&&&&&&&&&&.&&

.if PrintComission
#CommissionLinkInit(aktspis)

.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
 ИПредседатель комиссии       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 Ш                                                               должность                                      подпись                                    расшифровка подписи Ш
.{ While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
 И@@@@@@@@@@@@@@@             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 Ш                                                               должность                                      подпись                                    расшифровка подписи Ш
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 ИЧлены комиссии:            _____________________________  _____________________  __________________________________ И
 Ш                                                               должность                                      подпись                                    расшифровка подписи Ш
 И                           _____________________________  _____________________  __________________________________ И
 Ш                                                               должность                                      подпись                                    расшифровка подписи Ш
.}
.end


.}
.endform

!======================================================================================================================


.LinkForm 'AKTSPIS_03' prototype is 'aktspis'
.NameInList 'Акт на списание материальных ценностей из производства'
#CommissionLinkVar
.fields
  MyOrg
  Подразделение
  Номер_акта
  Дата
  Назначение
  Должность
  МОЛ
  Валюта
   НазваниеМЦ
   Единицы
   Партия
   Количество
   Цена
  Сумма
  Валюта
.endfields
.{
 Ш


    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                           наименование организации
    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                           структурное подразделение






                                                                                                                                        УТВЕРЖДАЮ:


                                                                                   Руководитель ______________________ _______________ _______________________
                                                                                                      должность           подпись       расшифровка подписи

                                                                                                                           "_____" _______________ 20___ г.



                                                                    АКТ
                                              НА СПИСАНИЕ МАТЕРИАЛЬНЫХ ЦЕННОСТЕЙ ИЗ ПРОИЗВОДСТВА
                                                                                                                     ┌─────────────────┬──────────────────┐
                                                                                                                     │ Номер документа │ Дата составления │
                                                                                                                     ├─────────────────┼──────────────────┤
                                                                                                                     │ @@@@@@@@@@@@@@@@│    @@@@@@@@@@    │
   Е                                                                                                                 Е   └─────────────────┴──────────────────┘


   ДНАЗНАЧЕНИЕ:^  Д


  Материально ответственное лицо  Б Д@@@@@@@@@@@@@@@@@@@@@@@@@ Д     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Б
                                       должность                                 фамилия, инициалы

  ═══════════════════════════════════════════════╤═════════════╤═══════════════════╤══════════════╤═══════════════════
           Название МЦ                           │   Единица   │      Партия       │  Количество  │  Цена за
                                                 │  измерения  │                   │              │  единицу, @@@@@@
  ═══════════════════════════════════════════════╪═════════════╪═══════════════════╪══════════════╪═══════════════════
.{
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&.&&│&'&&&&&&&&&.&&
.if ValidNameLong
.end
.}
  ═══════════════════════════════════════════════╧═════════════╧═══════════════════╧══════════════╧═══════════════════
  ИТОГО на сумму:  &'&&&&&&&&&&&&&&&&&&.&&  ^
 Ш
 Р
.if PrintComission
#CommissionLinkInit(aktspis)

.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
 И Председатель комиссии       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 И                                     должность                      подпись                 расшифровка подписи И
.{ While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
 И @@@@@@@@@@@@@@@             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 И                                     должность                      подпись                 расшифровка подписи И
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 И Члены комиссии:            _______________________________  _____________________  ____________________________________ И
 И                                     должность                      подпись                 расшифровка подписи         И
 И                            _______________________________  _____________________  ____________________________________ И
 И                                     должность                      подпись                 расшифровка подписи         И
.}
.else


 И   Председатель комиссии   _________________________________    __________________________     ________________________________________________________ И
 И                                         должность                        подпись                                 расшифровка подписи                   И


 И   Члены комиссии:         _________________________________    __________________________     ________________________________________________________ И
 И                                         должность                        подпись                                 расшифровка подписи                   И


 И                           _________________________________    __________________________     ________________________________________________________ И
 И                                         должность                        подпись                                 расшифровка подписи                   И

.end


 Р
.}
.endform


!======================================================================================================================

.LinkForm 'AKTSPIS_04' prototype is 'aktspis'
.NameInList 'Акт выбытия (Россия) (форма №  МБ-4)'
#CommissionLinkVar
.Var
  TotSum : Double
  SumPr  : Double
.EndVar

.Fields
 Номер_акта  MyOrg  ОКПО
 Подразделение
 Дата
 Подразделение
.EndFields
.{
.Begin
 SumPr  := 0
 TotSum := 0
End.
 Р                                                                                      Типовая межотраслевая форма №  MБ-4
                                                                                      Утверждена постановлением Госкомстата России
                                                                                      от 30.10.97 №  71а


                                       БАКТ №   Д@@@@@@@@@@ Е
                    Бвыбытия малоценных и быстроизнашивающихся предметов Б                                                   Коды
                                                                                                                     Б┌─────────────┐ Б
                                                                                                      Форма по ОКУД  Б│   0320002   │ Б
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е          по ОКПО  Б│@~@@@@@@@@@@@│ Б
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                   Б└─────────────┘ Б
                      ┌──────────┬──────────┬────────────────────────────┬──────────────┬──────────────────────────┬──────────────┐
                      │   Дата   │   Код    │       Cтруктурное          │     Вид      │  Корреспондирующий счет  │ Учетная еди- │
                      │  состав- │   вида   │      подразделение         │ деятельности ├─────────┬────────────────┤ ница выпуска │
                      │   ления  │ операции │                            │              │  счет,  │  код аналити-  │  продукции   │
                      │          │          │                            │              │ субсчет │ ческого учета  │(работ, услуг)│
                      ├──────────┼──────────┼────────────────────────────┼──────────────┼─────────┼────────────────┼──────────────┤
                      Б │@@@@@@@@@@│          │@@@@@@@@@@@@@@@@@@@@@@@@@@@@│              │         │                │              │
                      └──────────┴──────────┴────────────────────────────┴──────────────┴─────────┴────────────────┴──────────────┘ Б
┌───────────────────────────────┬───────────────────┬───────┬──────────────┬───────────────────────────┬──────────────────────────┐
│           Предмет             │ Единица измерения │       │              │      Сумма, руб. коп.     │      Причина выбытия     │
├───────────────────┬───────────┼─────┬─────────────┤ Коли- │     Цена     ├─────────────┬─────────────┼─────────┬────────────────┤
│   Наименование,   │Номенклатур│ Код │ Наименование│чество │   руб.коп.   │  Без учета  │   Аморти-   │         │                │
│ сорт,размер,марка │ ный номер │     │             │       │              │     НДС     │   зации     │   Код   │  Наименование  │
├───────────────────┼───────────┼─────┼─────────────┼───────┼──────────────┼─────────────┼─────────────┼─────────┼────────────────┤
│         1         │     2     │  3  │      4      │   5   │      6       │      7      │      8      │    9    │       10       │
├───────────────────┼───────────┼─────┼─────────────┼───────┼──────────────┼─────────────┼─────────────┼─────────┼────────────────┤
.{
.Begin
 SumPr  := Количество*Цена
 TotSum := TotSum + SumPr
End.
.Fields
 НазваниеМЦ  НоменклНом КодЕдиницы Единицы  Количество  Цена  SumPr
.EndFields
│@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@│@@@@@@@@@@@@@│&&&&.&&│&'&&&&&&&&&.&&│&'&&&&&&&&.&&│             │         │                │
.if ValidNameLong
.end
.}
.Fields
  TotSum
.EndFields
└───────────────────┴───────────┴─────┴─────────────┴───────┴──────────────┼─────────────┼─────────────┼─────────┴────────────────┘
                                                                     БИтого  │&'#&&&&&&&.&&│             │ Б
 Причина выбытия __________________________________________________         Б└─────────────┴─────────────┘ Б
                 __________________________________________________________________________________________________________________
                 __________________________________________________________________________________________________________________

  БМастер (исполнитель работ)  Б  _________________     _______________________
                                   подпись            расшифровка подписи
 Р

 Р
┌───────────────────────┬─────────┬──────────┬──────────────┬───────────────────────────────────────────────────────┬─────────────┐
│                       │         │          │              │               Расчет удержания с виновных             │             │
│                       │         │          │              │                 Вид и способ удержания                │             │
│     Фамилия И. О.     │Табельный│   Дата   │   Подпись    ├───────┬────────────┬──────────────────────┬───────────┤   Подпись   │
│                       │  номер  │  выдачи  │   сдавшего   │       │ стоимость  │  код вида удержания  │   сумма   │  виновного  │
│                       │         │          │  малоценные  │процент│ за вычетом ├──────────────────────┤  ежеме-   │  в поломке  │
│                       │         │          │  и быстроиз- │аморти-│амортизации,├─────────┬────────────┤  сячного  │   (утере)   │
│                       │         │          │ нашивающиеся │ зации │ руб. коп.  │ размер  │    cумма   │  взноса,  │             │
│                       │         │          │   предметы   │       │            │(процент)│  удержания │  руб.коп  │             │
│                       │         │          │              │       │            │удержания│  руб. коп. │           │             │
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
│           1           │    2    │    3     │       4      │   5   │     6      │    7    │      8     │     9     │     10      │
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
└───────────────────────┴─────────┴──────────┴──────────────┴───────┴────────────┴─────────┴────────────┴───────────┴─────────────┘
  БРуководитель подразделения Б _________________  _____________  ___________________    БКладовщик Б  _____________   ___________________
                                должность         подпись     расшифровка подписи                 подпись      расшифровка подписи
       "  " ___________20   г.                                                       ББухгалтер Б  _____________   ___________________
                                                                                                  подпись      расшифровка подписи
.if PrintComission
.begin
  // *** Обнуление переменной ***
  Номер_члена_комиссии := 0;

  // *** Обнуление массивов по таблице ***
  for (Номер_члена_комиссии := 1; Номер_члена_комиссии <= Count(Массив_Член_комиссии_nRec); Номер_члена_комиссии := Номер_члена_комиссии + 1)
  {
    Массив_Член_комиссии_nRec            [Номер_члена_комиссии] := comp(0);
    Массив_Член_комиссии_ФИО             [Номер_члена_комиссии] := '';
    Массив_Член_комиссии_Табельный_Номер [Номер_члена_комиссии] := ''; // LongInt(0)
    Массив_Член_комиссии_Должность       [Номер_члена_комиссии] := '';
  }

  Номер_члена_комиссии := 0;
end.
.{ CheckEnter CommissionMember_aktspis
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
  Массив_Член_комиссии_nRec            [Номер_члена_комиссии] := Член_комиссии_nRec;
  Массив_Член_комиссии_ФИО             [Номер_члена_комиссии] := Член_комиссии_ФИО;
  Массив_Член_комиссии_Табельный_Номер [Номер_члена_комиссии] := string(Член_комиссии_Табельный_Номер);
  Массив_Член_комиссии_Должность       [Номер_члена_комиссии] := Член_комиссии_Должность;
end.
.}
.begin
  Номер_члена_комиссии := 0;
end.

.end
 Р
 А
.}
.EndForm
