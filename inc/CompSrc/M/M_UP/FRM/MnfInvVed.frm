//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 7.12 - Управление производственной логистикой
// Инвентаризационная опись
//********************************************************************************
#include Commission.frn

#Doc
  Инвентаризационная опись</Brief>
#End

.set name='MnfInvVed'
.hide
.var
  количество_партии : double
  цена_партии : double
  sKolZnak : string[10]
.endvar
.fields
#CommissionFields

   NRec_инвентаризации:comp
   номер_приказа:string
   дата_приказа:date
   дата_инвентаризации:date
   дата_окончания_инвентаризации:date
   номер_инвентаризации
   подразделение:string
   мол:string
   Кол_число_знаков:word
      NRec_спецификации:comp
      мц_код:string
      мц_название:string
      ед_измерения:string
      дата_выявления:date // стоит SkipFormat
      количество:double   // стоит SkipFormat
      подразделение_1:string
      мол_1:string
      nRecParty : comp
      партия:string
      дата_партии
      кол_инвентаризации:double
      кол_программно:double
      цена_программно:double
      NameLong : String
.endfields
-------------------------------------------------------------------------------
#CommissionBody(MnfInvVed)

   NRec_инвентаризации:comp        ^
   номер_приказа:string            ^
   дата_приказа:date               ^
   дата_инвентаризации:date        ^
   дата_окончания_инвентаризации:date ^
   номер_инвентаризации            ^
   подразделение:string                    ^
   мол:string                      ^
   Кол_число_знаков:word           ^
.begin
  Case Кол_число_знаков of
    0 : sKolZnak := '';
    2 : sKolZnak := '.88';
    3 : sKolZnak := '.888';
    4 : sKolZnak := '.8888';
    5 : sKolZnak := '.88888';
    6 : sKolZnak := '.888888';
    7 : sKolZnak := '.8888888';
    8 : sKolZnak := '.88888888';
    9 : sKolZnak := '.888888888';
  else
    sKolZnak := '.8';
  End;
end.
.{
.[h OverWrite
  ТЕСТ
.]h
      NRec_спецификации:comp       ^
      мц_код:string                ^
      мц_название:string           ^
      ед_измерения:string          ^
      дата_выявления:date          ^
      количество:double            ^
.if MnfFlagParty
.{
      подразделение_1:string       ^
      мол_1:string                 ^
      nRecParty                    ^
      партия:string                ^
      дата_партии:date             ^
      кол_инвентаризации:double    ^
      кол_программно:double        ^
      цена_программно:double       ^
      NameLong : String            ^
.begin
  количество_партии := кол_программно;
  цена_партии := цена_программно;
end.
.}
.end
.}
.endform

.linkform 'MnfInvVed_Blank' prototype is 'MnfInvVed'
.group 'Бланки'
.group 'Ведомости'
.group 'Бланк инвентаризации'
.nameInList 'Форма N ИНВ-3 по ОКУД'
.create view invlog
  as select
    KatOrg.Name, KatOrg.OKPO
  from
    KatOrg
  where
    ((
        coGetTune('MyOrg')  ==   KatOrg.nRec
    ))
;
.var
   pnum  : word   // количество строк на старнице
   pkolF : double // 'количество' на странице фактическое
   pkolP : double // 'количество' на странице программно
   psumF : double // 'сумма' на странице фактическая
   psumP : double // 'сумма' на странице программно
   rnum  : word   // количество строк в отчете
   rkolF : double // 'количество' в отчете фактическое
   rkolP : double // 'количество' в отчете программно
   rsumF : double // 'сумма' в отчете фактическая
   rsumP : double // 'сумма' в отчете программно
.endvar
#CommissionLinkVar
#CommissionLinkInit(MnfInvVed)
.fields
    CommonFormHeader
    if (invlog.GetFirst KatOrg = tsOk, invlog.KatOrg.Name, '')
    if (invlog.GetFirst KatOrg = tsOk, invlog.KatOrg.OKPO, '')
    подразделение
    номер_приказа
    if(дата_приказа = Date(0,0,0), '', DateToStr(дата_приказа, 'DD mon YYYY г.'))
    дата_инвентаризации:'m:DD mon YYYY г.'
    if(дата_окончания_инвентаризации = Date(0,0,0), '', DateToStr(дата_окончания_инвентаризации, 'DD mon YYYY г.'))
    мол
    'true' : 's'
      rnum : 'p:c'
      мц_название +' '+if(партия<>'', '(партия: ' +партия+ ')', '(без партии)') //: 'd:r'
      мц_код       : /*'d:r',*/'p:r'
      ед_измерения //: 'd:r'
      цена_партии

      кол_инвентаризации
      цена_программно*кол_инвентаризации

      кол_программно
      цена_программно*кол_программно
.endfields
.p 50
.defo landscape
.begin
  rnum  := 0 ;
  rkolF := 0 ;
  rkolP := 0 ;
  rsumF := 0 ;
  rsumP := 0 ;
end.
^
 Р                                                                                                                                     Унифицированная форма N ИНВ-3
                                                                                                                                     Утверждена постановлением Госкомстата
                                                                                                                                     России от 18.08.98 N 88
                                                                                                                                                    ┌─────────────────────┐
                                                                                                                                                    │         Код         │
                                                                                                                                                    ╠═════════════════════╣
                                                                                                                                     Форма по ОКУД  ║       0317004       ║
                                                                                                                                                    ╟─────────────────────╢
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  по ОКПО  ║ Б@~@@@@@@@@@@@@@@@@@@@ Б║
 ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ╟─────────────────────╢
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  ║                     ║
 ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╫─────────────────────╢
                                                              структурное подразделение                                           Вид деятельности  ║                     ║
                                                                                                                                          ┌─────────╫─────────────────────╢
                        Основание для проведения инвентаризации:                  приказ, постановление, распоряжение                     │  номер  ║&~&&&&&&&&&&&&&&&&&&&║
                                                                 ─────────────────────────────────────────────────────────────────────────┼─────────╫─────────────────────╢
                                                                                          ненужное зачеркнуть                             │   дата  ║ Б@~@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                          └─────────╫─────────────────────╢
                                                                                                                        Дата начала инвентаризации  ║ Б@~@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                                    ╟─────────────────────╢
                                                                                                                     Дата окончания инвентаризации  ║ Б@~@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                                    ╟─────────────────────╢
                                                                                                                                      Вид операции  ║                     ║
                                                                                                                                                    ╚═════════════════════╝
                                                                                                                          ┌──────────────────┬──────────────────┐
                                                                                                                          │ Номер документа  │ Дата составления │
                                                                                                                          ╠══════════════════╪══════════════════╣
                                                             И Н В Е Н Т А Р И З А Ц И О Н Н А Я   О П И С Ь              ║                  │                  ║
                                                                                                                          ╚══════════════════╧══════════════════╝
                                                             товарно-материальных ценностей в производстве

 ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                   вид товарно-материальных ценностей
 находящиеся
             ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                         в собственности организации, полученные для переработки

                                                                             Р А С П И С К А

        К началу проведения инвентаризации все расходные и приходные документы на товарно-материальные ценности сданы в бухгалтерию и все товарно-материальные ценности,
 поступившие на мою (нашу) ответственность, оприходованы, а выбывшие списаны в расход.

 Материально ответственное(ые) лицо(а):  _________________________  ________________________   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                (должность)                 (подпись)                 (расшифровка подписи)
                                         _________________________  ________________________  __________________________________________________________________________
                                                (должность)                 (подпись)                 (расшифровка подписи)

 Произведено снятие фактических остатков ценностей по состоянию на  "_____" ________________________  _________ г. Р
^
.{
.[h OverWrite
.begin
  pnum  := 0 ;
  pkolF := 0 ;
  pkolP := 0 ;
  psumF := 0 ;
  psumP := 0 ;
end. //                                                                                                                                                                          сжатый!
 Р                                                                                                                                                         @np@-я страница формы N ИНВ-3
┌───────┬───────────┬──────────────────────────────────────┬─────────────────────┬──────────────┬────────────────────┬────────────────────────────────┬────────────────────────────────┐
│       │           │     Товарно-материальные ценности    │  Единица измерения  │              │       Номер        │       Фактическое наличие      │ По данным бухгалтерского учета │
│ Номер │   Счет,   ├───────────────────────┬──────────────┼──────────┬──────────┤    Цена,     ├─────────┬──────────┼──────────────┬─────────────────┼──────────────┬─────────────────┤
│  по   │  субсчет  │  наименование,харак-  │ код (номен-  │  код по  │ наимено- │  руб. коп.   │ инвен-  │          │              │     сумма,      │              │     сумма,      │
│порядку│           │    теристика (вид,    │  клатурный   │   ОКЕИ   │  вание   │              │ тарный  │ паспорта │  количество  │    руб. коп.    │  количество  │    руб. коп.    │
│       │           │     сорт, группа)     │    номер)    │          │          │              │         │          │              │                 │              │                 │
├───────┼───────────┼───────────────────────┼──────────────┼──────────┼──────────┼──────────────┼─────────┼──────────┼──────────────┼─────────────────┼──────────────┼─────────────────┤
│   1   │     2     │           3           │      4       │     5    │     6    │       7      │    8    │    9     │      10      │       11        │      12      │        13       │
├───────┼───────────┼───────────────────────╬══════════════╪══════════╬──────────╬══════════════╪═════════╪══════════╪══════════════╪═════════════════╬──────────────┼─────────────────┤ Р
.]h
!.{
.if MnfFlagParty
.{
.begin
  rnum  := rnum + 1 ;
  pnum  := pnum + 1 ;
  pkolF := pkolF + Round(кол_инвентаризации                ,Кол_число_знаков);
  pkolP := pkolP + Round(кол_программно                    ,Кол_число_знаков);
  psumF := psumF + Round(цена_программно*кол_инвентаризации,2);
  psumP := psumP + Round(цена_программно*кол_программно    ,2);

  rkolF := rkolF + Round(кол_инвентаризации                ,Кол_число_знаков);
  rkolP := rkolP + Round(кол_программно                    ,Кол_число_знаков);
  rsumF := rsumF + Round(цена_программно*кол_инвентаризации,2);
  rsumP := rsumP + Round(цена_программно*кол_программно    ,2);
end.
 Р│ @@@@@ │           │@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@@│          ║ @@@@@@@@@║&&&&&&&&&&&.&&│         │          │&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&&║&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&&│ Р
.}
.end
!.}
.[f
.fields
  // фактическое количество
  if (pkolF <> 0,
      DoubleToStr(pkolF,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // фактическая сумма
  if (psumF > 0.01,
      DoubleToStr(psumF,'[|-]3666`666`666`666`666.88'),
      '' )
  // программное количество
  if (pkolP <> 0,
      DoubleToStr(pkolP,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // программная сумма
  if (psumP > 0.01,
      DoubleToStr(psumP,'[|-]3666`666`666`666`666.88'),
      '' )
  // количество порядковых номеров прописью
  if (pnum <> 0,
      DoubleToStr(pnum,'\m 4'),
      '' )
  // общее количество единиц фактически прописью
  if (pkolF <> 0,
      DoubleToStr(pkolF,'\m 4 целых,\m 5'),
      '' )
  // на сумму фактически прописью
  if (psumF >= 0.01,
      DoubleToStr(psumF,'\m 4 руб')+
        if ((Trunc(psumF*100)-Trunc(psumF)*100)>0,
          DoubleToStr(Trunc(psumF*100)-Trunc(psumF)*100,',\f 4 коп.'),''),
      '' )
.endfields
 Р└───────┴───────────┴───────────────────────╩══════════════╧══════════╩──────────╩══════════════╧═════════╧══════════╪══════════════╪═════════════════╬──────────────╪─────────────────┤
                                                                                                              БИтого Б   │ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│
                                                                                                                     └──────────────┴─────────────────┴──────────────┴─────────────────┘
  Итого по странице :
                а) количество порядковых номеров:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                б) общее количество единиц фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                в) на сумму фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью Р
.]f
.}
.fields
  'true' : 's'
  // количество порядковых номеров (по отчету)
  if (rnum <> 0,
      DoubleToStr(rnum,'666`666`666`666`666'),
      '' )
  // фактическое количество (по отчету)
  if (rkolF <> 0,
      DoubleToStr(rkolF,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // фактическая сумма (по отчету)
  if (rsumF > 0.01,
      DoubleToStr(rsumF,'[|-]3666`666`666`666`666.88'),
      '' )
  // программное количество (по отчету)
  if (rkolP <> 0,
      DoubleToStr(rkolP,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // программная сумма (по отчету)
  if (rsumP > 0.01,
      DoubleToStr(rsumP,'[|-]3666`666`666`666`666.88'),
      '' )
  // количество порядковых номеров прописью (по отчету)
  if (rnum <> 0,
      DoubleToStr(rnum,'\m 4'),
      '' )
  // общее количество единиц фактически прописью (по отчету)
  if (rkolF <> 0,
      DoubleToStr(rkolF,'\m 4 целых,\m 5'),
      '' )
  // на сумму фактически прописью (по отчету)
  if (rsumF >= 0.01,
      DoubleToStr(rsumF,'\m 4 руб')+
        if ((Trunc(rsumF*100)-Trunc(rsumF)*100)>0,
          DoubleToStr(Trunc(rsumF*100)-Trunc(rsumF)*100,',\f 4 коп.'),''),
      '' )
.endfields
^
 Р                                                                                                                                                         @np@-я страница формы N ИНВ-3
┌───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────┬─────────────────┬──────────────┬─────────────────┐
│ Б&&&&&&  Б│                                                                                       Всего по описи       │ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│
└───────┘                                                                                                            └──────────────┴─────────────────┴──────────────┴─────────────────┘

 Итого по описи:
                а) количество порядковых номеров:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                б) общее количество единиц фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                в) на сумму, фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                ________________________________________________________________________________________________________________________________________________________________________
     Все цены, подсчеты итогов по строкам, страницам и в целом по инвентаризационной описи товарно-материальных ценностей проверены.

.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
  Председатель комиссии             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              должность                  подпись               расшифровка подписи
.{ While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
  @@@@@@@@@@@@@@@                   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              должность                  подпись               расшифровка подписи
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
  Члены комиссии:                  _____________________________    ________________  __________________________________
                                              должность                  подпись               расшифровка подписи
                                   _____________________________    ________________  __________________________________
                                              должность                  подпись               расшифровка подписи
.}
.fields
  мол
.endfields
     Все товарно-материальные ценности, поименованные в настоящей инвентаризационной описи с N _______________ по N _______________ комиссией проверены в натуре в моем (нашем) при-
 сутствии и внесены в опись, в связи с чем претензий к инвентаризационной комиссии не имею (не имеем). Товарно-материальные ценности, перечисленные в описи, находятся на моем
 (нашем) ответственном хранении.

     Лицо(а), ответственное(ые) за сохранность товарно-материальных ценностей:

                            _____________________________   ______________________    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                      должность                     подпись                                         расшифровка подписи

                            _____________________________   ______________________   _________________________________________________________________________________
                                      должность                     подпись                                         расшифровка подписи

                            _____________________________   ______________________   _________________________________________________________________________________
                                      должность                     подпись                                         расшифровка подписи

                            "_____" ________________________  _________ г.

Указаные в настоящей описи данные и расчеты проверил: _______________________   __________________   _________________________________________________________________
                                                             должность                подпись                                расшифровка подписи
                                                      "_____" ________________________  _________ г. Р
.endform

.linkform 'MnfInvVed_Blank1' prototype is 'MnfInvVed'
.group 'Бланки'
.group 'Ведомости'
.group 'Бланк инвентаризации'
.nameInList 'Форма N ИНВ-3 по ОКУД (с вариантами наименований)'
.create view invlog
  as select
    KatOrg.Name, KatOrg.OKPO
  from
    KatOrg
  where
    ((
        coGetTune('MyOrg')  ==   KatOrg.nRec
    ))
;
#CommissionLinkVar
#CommissionLinkInit(MnfInvVed)
.var
   pnum  : word   // количество строк на старнице
   pkolF : double // 'количество' на странице фактическое
   pkolP : double // 'количество' на странице программно
   psumF : double // 'сумма' на странице фактическая
   psumP : double // 'сумма' на странице программно
   rnum  : word   // количество строк в отчете
   rkolF : double // 'количество' в отчете фактическое
   rkolP : double // 'количество' в отчете программно
   rsumF : double // 'сумма' в отчете фактическая
   rsumP : double // 'сумма' в отчете программно
.endvar
.fields
    CommonFormHeader
    if (invlog.GetFirst KatOrg = tsOk, invlog.KatOrg.Name, '')
    if (invlog.GetFirst KatOrg = tsOk, invlog.KatOrg.OKPO, '')
    подразделение
    номер_приказа
    if(дата_приказа = Date(0,0,0), '', DateToStr(дата_приказа, 'DD mon YYYY г.'))
    дата_инвентаризации:'m:DD mon YYYY г.'
    if(дата_окончания_инвентаризации = Date(0,0,0), '', DateToStr(дата_окончания_инвентаризации, 'DD mon YYYY г.'))
    мол
    'true' : 's'
      rnum : 'p:c'
      мц_название +' '+if(партия<>'', '(партия: ' +партия+ ')', '(без партии)') //: 'd:r'
      мц_код       : /*'d:r',*/'p:r'
      ед_измерения //: 'd:r'
      цена_партии

      кол_инвентаризации
      цена_программно*кол_инвентаризации

      кол_программно
      цена_программно*кол_программно
      NameLong : 'd:r'
.endfields
.p 50
.defo landscape
.begin
  rnum  := 0 ;
  rkolF := 0 ;
  rkolP := 0 ;
  rsumF := 0 ;
  rsumP := 0 ;
end.
^
 Р                                                                                                                                     Унифицированная форма N ИНВ-3
                                                                                                                                     Утверждена постановлением Госкомстата
                                                                                                                                     России от 18.08.98 N 88
                                                                                                                                                    ┌─────────────────────┐
                                                                                                                                                    │         Код         │
                                                                                                                                                    ╠═════════════════════╣
                                                                                                                                     Форма по ОКУД  ║       0317004       ║
                                                                                                                                                    ╟─────────────────────╢
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  по ОКПО  ║ Б@~@@@@@@@@@@@@@@@@@@@ Б║
 ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ╟─────────────────────╢
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  ║                     ║
 ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╫─────────────────────╢
                                                              структурное подразделение                                           Вид деятельности  ║                     ║
                                                                                                                                          ┌─────────╫─────────────────────╢
                        Основание для проведения инвентаризации:                  приказ, постановление, распоряжение                     │  номер  ║&~&&&&&&&&&&&&&&&&&&&║
                                                                 ─────────────────────────────────────────────────────────────────────────┼─────────╫─────────────────────╢
                                                                                          ненужное зачеркнуть                             │   дата  ║ Б@~@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                          └─────────╫─────────────────────╢
                                                                                                                        Дата начала инвентаризации  ║ Б@~@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                                    ╟─────────────────────╢
                                                                                                                     Дата окончания инвентаризации  ║ Б@~@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                                    ╟─────────────────────╢
                                                                                                                                      Вид операции  ║                     ║
                                                                                                                                                    ╚═════════════════════╝
                                                                                                                          ┌──────────────────┬──────────────────┐
                                                                                                                          │ Номер документа  │ Дата составления │
                                                                                                                          ╠══════════════════╪══════════════════╣
                                                             И Н В Е Н Т А Р И З А Ц И О Н Н А Я   О П И С Ь              ║                  │                  ║
                                                                                                                          ╚══════════════════╧══════════════════╝
                                                             товарно-материальных ценностей в производстве

 ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                   вид товарно-материальных ценностей
 находящиеся
             ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                         в собственности организации, полученные для переработки

                                                                             Р А С П И С К А

        К началу проведения инвентаризации все расходные и приходные документы на товарно-материальные ценности сданы в бухгалтерию и все товарно-материальные ценности,
 поступившие на мою (нашу) ответственность, оприходованы, а выбывшие списаны в расход.

 Материально ответственное(ые) лицо(а):  _________________________  ________________________   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                (должность)                 (подпись)                 (расшифровка подписи)
                                         _________________________  ________________________  __________________________________________________________________________
                                                (должность)                 (подпись)                 (расшифровка подписи)

 Произведено снятие фактических остатков ценностей по состоянию на  "_____" ________________________  _________ г. Р
^
.{
.[h OverWrite
.begin
  pnum  := 0 ;
  pkolF := 0 ;
  pkolP := 0 ;
  psumF := 0 ;
  psumP := 0 ;
end. //                                                                                                                                                                          сжатый!
 Р                                                                                                                                                         @np@-я страница формы N ИНВ-3
┌───────┬───────────┬──────────────────────────────────────┬─────────────────────┬──────────────┬────────────────────┬────────────────────────────────┬────────────────────────────────┐
│       │           │     Товарно-материальные ценности    │  Единица измерения  │              │       Номер        │       Фактическое наличие      │ По данным бухгалтерского учета │
│ Номер │   Счет,   ├───────────────────────┬──────────────┼──────────┬──────────┤    Цена,     ├─────────┬──────────┼──────────────┬─────────────────┼──────────────┬─────────────────┤
│  по   │  субсчет  │  наименование,харак-  │ код (номен-  │  код по  │ наимено- │  руб. коп.   │ инвен-  │          │              │     сумма,      │              │     сумма,      │
│порядку│           │    теристика (вид,    │  клатурный   │   ОКЕИ   │  вание   │              │ тарный  │ паспорта │  количество  │    руб. коп.    │  количество  │    руб. коп.    │
│       │           │     сорт, группа)     │    номер)    │          │          │              │         │          │              │                 │              │                 │
├───────┼───────────┼───────────────────────┼──────────────┼──────────┼──────────┼──────────────┼─────────┼──────────┼──────────────┼─────────────────┼──────────────┼─────────────────┤
│   1   │     2     │           3           │      4       │     5    │     6    │       7      │    8    │    9     │      10      │       11        │      12      │        13       │
├───────┴───────────┴───────────────────────╧══════════════╧══════════╧══════════╧══════════════╧═════════╧══════════╧══════════════╧═════════════════╧──────────────┴─────────────────┤ Р
.]h
!.{
.if MnfFlagParty
.{
.begin
  rnum  := rnum + 1 ;
  pnum  := pnum + 1 ;
  pkolF := pkolF + Round(кол_инвентаризации                ,Кол_число_знаков);
  pkolP := pkolP + Round(кол_программно                    ,Кол_число_знаков);
  psumF := psumF + Round(цена_программно*кол_инвентаризации,2);
  psumP := psumP + Round(цена_программно*кол_программно    ,2);

  rkolF := rkolF + Round(кол_инвентаризации                ,Кол_число_знаков);
  rkolP := rkolP + Round(кол_программно                    ,Кол_число_знаков);
  rsumF := rsumF + Round(цена_программно*кол_инвентаризации,2);
  rsumP := rsumP + Round(цена_программно*кол_программно    ,2);
end.
 Р├───────┬───────────┬───────────────────────╥──────────────┬──────────╥──────────╥──────────────┬─────────┬──────────┬──────────────┬─────────────────╥──────────────┬─────────────────┤ Р
 Р│ @@@@@ │           │@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@@│          ║ @@@@@@@@@║&&&&&&&&&&&.&&│         │          │&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&&║&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&&│ Р
 Р│       └───────────┴───────────────────────╨──────────────┴──────────╨──────────╨──────────────┴─────────┴──────────┴──────────────┴─────────────────╨──────────────┴─────────────────┤ Р
 Р│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ Р
.}
.end
!.}
.[f
.fields
  // фактическое количество
  if (pkolF <> 0,
      DoubleToStr(pkolF,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // фактическая сумма
  if (psumF > 0.01,
      DoubleToStr(psumF,'[|-]3666`666`666`666`666.88'),
      '' )
  // программное количество
  if (pkolP <> 0,
      DoubleToStr(pkolP,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // программная сумма
  if (psumP > 0.01,
      DoubleToStr(psumP,'[|-]3666`666`666`666`666.88'),
      '' )
  // количество порядковых номеров прописью
  if (pnum <> 0,
      DoubleToStr(pnum,'\m 4'),
      '' )
  // общее количество единиц фактически прописью
  if (pkolF <> 0,
      DoubleToStr(pkolF,'\m 4 целых,\m 5'),
      '' )
  // на сумму фактически прописью
  if (psumF >= 0.01,
      DoubleToStr(psumF,'\m 4 руб')+
        if ((Trunc(psumF*100)-Trunc(psumF)*100)>0,
          DoubleToStr(Trunc(psumF*100)-Trunc(psumF)*100,',\f 4 коп.'),''),
      '' )
.endfields
 Р└───────────────────────────────────────────═════════════════════════════════════════════════════════════════════════╤══════════════╤═════════════════╤──────────────┬─────────────────┤
                                                                                                              БИтого Б   │ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│
                                                                                                                     └──────────────┴─────────────────┴──────────────┴─────────────────┘
  Итого по странице :
                а) количество порядковых номеров:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                б) общее количество единиц фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                в) на сумму фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью Р
.]f
.}
.fields
  'true' : 's'
  // количество порядковых номеров (по отчету)
  if (rnum <> 0,
      DoubleToStr(rnum,'666`666`666`666`666'),
      '' )
  // фактическое количество (по отчету)
  if (rkolF <> 0,
      DoubleToStr(rkolF,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // фактическая сумма (по отчету)
  if (rsumF > 0.01,
      DoubleToStr(rsumF,'[|-]3666`666`666`666`666.88'),
      '' )
  // программное количество (по отчету)
  if (rkolP <> 0,
      DoubleToStr(rkolP,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // программная сумма (по отчету)
  if (rsumP > 0.01,
      DoubleToStr(rsumP,'[|-]3666`666`666`666`666.88'),
      '' )
  // количество порядковых номеров прописью (по отчету)
  if (rnum <> 0,
      DoubleToStr(rnum,'\m 4'),
      '' )
  // общее количество единиц фактически прописью (по отчету)
  if (rkolF <> 0,
      DoubleToStr(rkolF,'\m 4 целых,\m 5'),
      '' )
  // на сумму фактически прописью (по отчету)
  if (rsumF >= 0.01,
      DoubleToStr(rsumF,'\m 4 руб')+
        if ((Trunc(rsumF*100)-Trunc(rsumF)*100)>0,
          DoubleToStr(Trunc(rsumF*100)-Trunc(rsumF)*100,',\f 4 коп.'),''),
      '' )
.endfields
^
 Р                                                                                                                                                         @np@-я страница формы N ИНВ-3
┌───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────┬─────────────────┬──────────────┬─────────────────┐
│ Б&&&&&&  Б│                                                                                       Всего по описи       │ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│
└───────┘                                                                                                            └──────────────┴─────────────────┴──────────────┴─────────────────┘

 Итого по описи:
                а) количество порядковых номеров:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                б) общее количество единиц фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                в) на сумму, фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                ________________________________________________________________________________________________________________________________________________________________________
     Все цены, подсчеты итогов по строкам, страницам и в целом по инвентаризационной описи товарно-материальных ценностей проверены.

.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
  Председатель комиссии             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              должность                  подпись               расшифровка подписи
.{ While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
  @@@@@@@@@@@@@@@                   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              должность                  подпись               расшифровка подписи
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
  Члены комиссии:                  _____________________________    ________________  __________________________________
                                              должность                  подпись               расшифровка подписи
                                   _____________________________    ________________  __________________________________
                                              должность                  подпись               расшифровка подписи
.}
.fields
  мол
.endfields
     Все товарно-материальные ценности, поименованные в настоящей инвентаризационной описи с N _______________ по N _______________ комиссией проверены в натуре в моем (нашем) при-
 сутствии и внесены в опись, в связи с чем претензий к инвентаризационной комиссии не имею (не имеем). Товарно-материальные ценности, перечисленные в описи, находятся на моем
 (нашем) ответственном хранении.

     Лицо(а), ответственное(ые) за сохранность товарно-материальных ценностей:

                            _____________________________   ______________________    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                      должность                     подпись                                         расшифровка подписи

                            _____________________________   ______________________   _________________________________________________________________________________
                                      должность                     подпись                                         расшифровка подписи

                            _____________________________   ______________________   _________________________________________________________________________________
                                      должность                     подпись                                         расшифровка подписи

                            "_____" ________________________  _________ г.

Указаные в настоящей описи данные и расчеты проверил: _______________________   __________________   _________________________________________________________________
                                                             должность                подпись                                расшифровка подписи
                                                      "_____" ________________________  _________ г. Р
.endform
