//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - модуль "Электронная отчетность"
// Библиотека функций : "Печать данных книги покупок/продаж"
//------------------------------------------------------------------------------

#ifndef __SFTR_BkPrint_Vih__
#define __SFTR_BkPrint_Vih__

#Component "L_SF"

//------------------------------------------------------------------------------
#include SchPrint.Vih  // Печать книги покупок/продаж
//------------------------------------------------------------------------------

//==============================================================================
#doc
Библиотека функций : "Печать данных книги покупок/продаж"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования в функционале "Электронная отчетность"
#end
Private ObjInterface ISFTR_BkPrint(ISchPrint);  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывести сообщения о последней ошибки выполнения
  #end
  function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region РАБОТА С ПОТОКОМ
  //----------------------------------------------------------------------------
  #doc
     Запустить сканирование данных
  #end
  function ScanData(
    _wReport : word   // вид отчета (см. lc_Bk_VidReport* в SFTR_BkPrint.Inc)
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на "Книгу продаж/покупок"
  #end
  function GetBookPrZk : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на СФ
  #end
  //
  function GetSF : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на исправление СФ
  #end
  function GetIsprSF : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на корректировочный СФ
  #end
  function GetKSF : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на исправление корректировочного СФ
  #end
  function GetKIsprSF : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на контрагента
  #end
  function GetKontr : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на посредника
  #end
  function GetMediator : comp;

  //----------------------------------------------------------------------------
  #doc
     Получить реквизиты первого "Документа оплаты"
  #end
  function GetFirstDocOplAttr : string;
  //----------------------------------------------------------------------------
  #doc
     Получить реквизиты следующего "Документа оплаты"
  #end
  function GetNextDocOplAttr : string;

  //----------------------------------------------------------------------------
  #doc
     Получить реквизиты первого "ГТД"
  #end
  function GetFirstDocGTDAttr : string;
  //----------------------------------------------------------------------------
  #doc
     Получить реквизиты следующего "ГТД"
  #end
  function GetNextDocGTDAttr : string;
  //#endregion РАБОТА С ПОТОКОМ
  //****************************************************************************


  //============================================================================
  //#region ПОЛУЧЕНИЕ ИТОГОВЫХ СУММ
  //----------------------------------------------------------------------------
  #doc
     Получить ИТОГО НДС по "Книге покупок"
  #end
  function GetBuyTotal_ItogoNDS : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ВСЕГО НДС по "Книге покупок" с учетом доп листа
  #end
  function GetBuyTotal_VsegoNDS : double;


  //----------------------------------------------------------------------------
  #doc
     Получить ИТОГО стоимость продаж (без НДС), по ставке 18 процентов
  #end
  function GetSelTotal_ItogoSUM18 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ИТОГО стоимость продаж (без НДС), по ставке 10 процентов
  #end
  function GetSelTotal_ItogoSUM10 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ИТОГО стоимость продаж (без НДС), по ставке  0 процентов
  #end
  function GetSelTotal_ItogoSUM00 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ИТОГО стоимость продаж, освобождаемых от налога
  #end
  function GetSelTotal_ItogoSUMNo : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ИТОГО НДС, по ставке 18 процентов
  #end
  function GetSelTotal_ItogoNDS18 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ИТОГО НДС, по ставке 10 процентов
  #end
  function GetSelTotal_ItogoNDS10 : double;

  //----------------------------------------------------------------------------
  #doc
     Получить ВСЕГО стоимость продаж (без НДС), по ставке 18 процентов
  #end
  function GetSelTotal_VsegoSUM18 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ВСЕГО стоимость продаж (без НДС), по ставке 10 процентов
  #end
  function GetSelTotal_VsegoSUM10 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ВСЕГО стоимость продаж (без НДС), по ставке  0 процентов
  #end
  function GetSelTotal_VsegoSUM00 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ВСЕГО стоимость продаж, освобождаемых от налога
  #end
  function GetSelTotal_VsegoSUMNo : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ВСЕГО НДС, по ставке 18 процентов
  #end
  function GetSelTotal_VsegoNDS18 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ВСЕГО НДС, по ставке 10 процентов
  #end
  function GetSelTotal_VsegoNDS10 : double;
  //#endregion ПОЛУЧЕНИЕ ИТОГОВЫХ СУММ
  //****************************************************************************
End; //#endregion ObjInterface
//******************************************************************************

//==============================================================================
#doc
Библиотека функций : "Печать данных книги покупок/продаж"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования в функционале "Электронная отчетность"
#end
Private ObjInterface ISFTR_BkPrint_v01(ISFTR_BkPrint);  //#region ObjInterface

  //============================================================================
  //#region РАБОТА С ПОТОКОМ
  //----------------------------------------------------------------------------
  #doc
     Получить реквизиты первого "Код вида товара"
  #end
  function GetFirstKodVidTovarAttr : string;
  //----------------------------------------------------------------------------
  #doc
     Получить реквизиты следующего "Код вида товара"
  #end
  function GetNextKodVidTovarAttr : string;
  //#endregion РАБОТА С ПОТОКОМ
  //****************************************************************************


  //============================================================================
  //#region ПОЛУЧЕНИЕ ИТОГОВЫХ СУММ
  //----------------------------------------------------------------------------
  #doc
     Получить ИТОГО стоимость продаж (без НДС), по ставке 20 процентов
  #end
  function GetSelTotal_ItogoSUM20 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ИТОГО НДС, по ставке 20 процентов
  #end
  function GetSelTotal_ItogoNDS20 : double;

  //----------------------------------------------------------------------------
  #doc
     Получить ВСЕГО стоимость продаж (без НДС), по ставке 20 процентов
  #end
  function GetSelTotal_VsegoSUM20 : double;
  //----------------------------------------------------------------------------
  #doc
     Получить ВСЕГО НДС, по ставке 20 процентов
  #end
  function GetSelTotal_VsegoNDS20 : double;
  //#endregion ПОЛУЧЕНИЕ ИТОГОВЫХ СУММ
  //****************************************************************************
End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface SFTR_BkPrint(BookPrZkPrint) implements
  ISFTR_BkPrint
, ISFTR_BkPrint_v01
#Licensed_Free;
Public:
  constructor InitDirect(wDirect: word; provider: ISchPrintProvider);
  destructor  Done;

  function  SetReportGroups : Boolean;
  procedure PrintCurrentBookPrZkFCom(iZnak : Integer);
  procedure PrintReportTotal;
End;
//******************************************************************************


#endif//__SFTR_BkPrint_Vih__
