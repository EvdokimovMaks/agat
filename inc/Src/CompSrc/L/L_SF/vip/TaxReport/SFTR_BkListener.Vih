//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Электронная отчетность"
// Библиотека функций : "Слушатель данных книги покупок/продаж"
//------------------------------------------------------------------------------

#ifndef __SFTR_BkListener_Vih__
#define __SFTR_BkListener_Vih__

#Component "L_SF"

//------------------------------------------------------------------------------
#include SFTR_BkListenerBuffer.Inc  // Описание данных: "Буфер прослушивателя данных книги покупок/продаж"
#include SFTR_BkBuffer.Inc          // Описание данных: "Буфер данных книги покупок/продаж"
//------------------------------------------------------------------------------


//==============================================================================
#doc
Библиотека функций : "Слушатель данных книги покупок/продаж"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования в функционале "Электронная отчетность"
#end
ObjInterface ISFTR_BkListener;  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывести сообщения о последней ошибки выполнения
  #end
  Function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region РАБОТА С ПОТОКОМ
  //----------------------------------------------------------------------------
  #doc
     Инициализировать сессию прослушивания
  #end
  Function SessionBeg : boolean;
  //----------------------------------------------------------------------------
  #doc
     Завершить сессию прослушивания
  #end
  Function SessionEnd : boolean;

  //----------------------------------------------------------------------------
  #doc
     Сообщить данные по записи потока "Книги покупок"
  #end
  Function ReportRecDataBkBuy(
    _Buff : TSFTR_BkBuySpyBuffer
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Сообщить данные по записи потока "Книги продаж"
  #end
  Function ReportRecDataBkSel(
    _Buff : TSFTR_BkSelSpyBuffer
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить первичное представление списка документов оплаты
  #end
  Function GetPrimeView_DocOplata : string;
  //#endregion РАБОТА С ПОТОКОМ
  //****************************************************************************


  //============================================================================
  //#region EVENT
  //----------------------------------------------------------------------------
  #doc
     Событие получения данных по записи потока "Книги покупок"
  #end
  Event Procedure Event_ReportRecDataBkBuy(
      _Buff    : TSFTR_BkBuyBuffer;
  var _sRunErr : string
  );
  //----------------------------------------------------------------------------
  #doc
     Событие получения данных по записи потока "Книги продаж"
  #end
  Event Procedure Event_ReportRecDataBkSel(
      _Buff    : TSFTR_BkSelBuffer;
  var _sRunErr : string
  );
  //#endregion EVENT
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface SFTR_BkListener implements ISFTR_BkListener
#Licensed_Free;
Public:
  constructor Init;
  Destructor  Done;
End;
//******************************************************************************


#endif//__SFTR_BkListener_Vih__
