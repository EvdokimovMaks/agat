//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - Логистика
// Взаимодействие с веб-сервисом АИС "Учет счетов-фактур"
//------------------------------------------------------------------------------
#ifndef __InvoiceService_vih__
#define __InvoiceService_vih__

#Component "L_SF"

#include InvoiceService.inc

#doc
Взаимодействие с веб-сервисом АИС "Учет счетов-фактур"
#end
ObjInterface ObjInvoiceService;

  #doc
  Инициализация протокола взаимодействия
  #end
  Procedure InitLog(sTitle: string);

  #doc
  Добавление строки в протокол
  #end
  Procedure AddMemInfo(wTable: word; sMess: string; wColor: word = 0; bBold: boolean = false);

  #doc
  Печать протокола взаимодействия
  #end
  Procedure PrintLog;

  #doc
  Установка соединения с веб-сервисом
  #end
  Function Connect: boolean;

  #doc
  Разрыв соединения с веб-сервисом
  #end
  Procedure Disconnect;

  #doc
  Загрузка ЭСЧф с портала или файла
  #end
  Function GetEDoc(var pDocument: TEDocument): boolean;

  #doc
  Получение статуса ЭСЧФ
  #end
  Function GetStatus(var pStatusInfo: TEStatusInfo): boolean;

  #doc
  Получение списка входящих ЭСЧФ
  #end
  Function ListDocuments(var pDocList: TEDocList): boolean;

  #doc
  Получение атрибута списка входящих ЭСЧФ
  #end
  Function GetItemAttribute(pRef: TPtr; indx: longint; sName: string): string;

  #doc
  Подписание ЭСЧФ
  #end
  Function Sign(var pDocument: TEDocument): boolean;

  #doc
  Отправка ЭСЧФ на портал
  #end
  Function SendEDoc(var pDocument: TEDocument): string;

  #doc
  Освободить ссылку на объект EDocument
  #end
  Procedure EDocumentFree(var delEDocument: TEDocument);

  #doc
  Освободить ссылку на объект ETicket
  #end
  Procedure ETicketFree(var delETicket: TETicket);

  #doc
  Освободить ссылку на объект EStatusInfo
  #end
  Procedure EStatusInfoFree(var delEStatusInfo: TEStatusInfo);

  #doc
  Освободить ссылку на объект EDocList
  #end
  Procedure EDocListFree(var delEDocList: TEDocList);

End;

VipInterface InvoiceService
  implements ObjInvoiceService
  licensed (FREE);

#end // __InvoiceService_vih__
