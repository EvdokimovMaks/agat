/*
иммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╩
╨                     (c) 1994,97 ╙╝Ю╞╝Ю═Ф╗О ┐─▀─┼▓┬┼─                      ╨
╨ ▐Ю╝╔╙Б        : ┐─▀─┼▓┬┼─                                                 ╨
╨ ▒╗АБ╔╛═       : ▌╞╔Ю═Б╗╒╜К╘ ╙╝╜БЦЮ                                        ╨
╨ ┌╔ЮА╗О        : 5.20                                                      ╨
╨ █═╖╜═Г╔╜╗╔    : ▐╔Г═БЛ ╕ЦЮ╜═╚═ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ (│╔╚═ЮЦАЛ)         ╨
╨ ▌Б╒╔БАБ╒╔╜╜К╘ : │╗╖═ ▓═БЛО╜═ (Tanni)                                      ╨
╨ ▐═Ю═╛╔БЮК     : ╜╔Б                                                       ╨
хммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪
*/


#doc
├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒
#end
.linkform 'Schfrees_31' prototype is 'Schfrees'
.NameInList '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒'
.Group '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒'
.create view vReeSchf
from SchFact
;
.create view vSchf
from
  SchFact
where
((
  nSchFact == SchFact.nRec
));
.var
 NPP:longint
 iS1:double
 iS2:double
 iS4:double
 iS5:double
 iS23:double
 iS8:double
 iS7:double
 iS10:double
 iAkciz:double
 iSS:double
 iSoplSt:double
 iSoplSt2:double
 iSReg:double
 IsKontrGroup:boolean
 //attr
// iAttr :iExAttr;
 bExAttrLoaded : boolean;
 cAttr    : comp;
 wTypAttr : word;
 wTipUser : word;
.endvar
.fields
  CFH
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')

  CFH
  If ( pDoc = (pDoc and 13) and pDoc <> 0
     , '▐▀─▓┘├┘┴'+
       If ( (pDoc = (pDoc and 1)) or (direct=2)
          , If ( direct=1
               , ', ┌⌡└─██⌡∙ ▐▌┼⌠▐─▓┘▀÷▄'
               , ', ▐▌▀⌠≈┘██⌡∙ ▌▓ ▐▌▒▓─┌≥┬┼▌┌'
               )
          , ' ▐▌ ▐░▌└─├─▄'
          )
     , '└▌┼⌠▄┘█▓▌┌ └▀÷ ⌠≈┘▓─ █└▒'+
        If ( direct=1
           , ' ▐▌ ▐░▌└─├─▄'
           , ' ▐▌ ▐▌┼⌠▐┼─▄'
           )
     )
.endfields
.p 55
.defo landscape
.[h SKIP
Ъ│^Ъ│
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ @NP@ ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбдддддддддбдддддддддбддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё     (4)      Ё              (5)              Ё   (6)   Ё   (6a)  Ё                     (7)                        Ё       (8)       Ё       (9)       Ё       (10)      ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддедддддддддедддддддддеддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.]h
.begin
  NPP := 0;
  
  iS1      := 0.0;
  iS2      := 0.0;
  iS4      := 0.0;
  iS5      := 0.0;
  iS23     := 0.0;
  iS8      := 0.0;
  iS7      := 0.0;
  iS10     := 0.0;
  iAkciz   := 0.0;
  iSS      := 0.0;
  iSoplSt  := 0.0;
  iSoplSt2 := 0.0;
  iSReg    := 0.0;
end.
Ъ│^Ъ│

Ъ│                                                 ├⌠░█─▀Ъ│
Ъ│ @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ│

.if SetDateRange
.fields
  if ( longint(dBeg)<>0 , DateToStr(dBeg,'DD/MM/YYYY'), '')
  if ( longint(dEnd)<>0 , DateToStr(dEnd,'DD/MM/YYYY'), '')
.endfields
Ъ│                                   ╖═ ╞╔Ю╗╝╓ А @@@@@@@@@@ ╞╝ @@@@@@@@@@Ъ│

.end
.fields
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')
.endfields
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ    1 ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддддддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбдддддддддбдддддддддбддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё Э  Ё        └═БК          Ё ▒Б═БЦА       Ё ▓╗╞ ╓╝╙Ц╛╔╜Б═                 Ё  █╝╛╔Ю  Ё  █╝╛╔Ю  Ё█═╗╛╔╜╝╒═╜╗╔ ╙╝╜БЮ═ё╔╜Б═                        Ё      ▒Ц╛╛═      Ё      ▒Ц╛╛═      Ё      ▒Ц╛╛═      ЁЪ≤
Ъ≤Ё╞/╞ цддддддддддбддддддддддд╢              Ё                               Ё         Ё  ║╚═╜╙═ Ё                                                Ё     ║╔╖ █└▒     Ё       █└▒       Ё      А █└▒      ЁЪ≤
Ъ≤Ё    Ё▌Д╝Ю╛╚╔╜╗ОЁ░╔ё╗АБЮ═Ф╗╗Ё              Ё                               Ё         Ё         Ё                                                Ё                 Ё                 Ё                 ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддедддддддддедддддддддеддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё     (4)      Ё             (5)               Ё   (6)   Ё   (6a)  Ё                     (7)                        Ё       (8)       Ё       (9)       Ё      (10)       ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддедддддддддедддддддддеддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.{CheckEnter Schf
.begin
  NPP++;

  iS1      += S1     ;
  iS2      += S2     ;
  iS4      += S4     ;
  iS5      += S5     ;
  iS23     += S23    ;
  iS8      += S8     ;
  iS7      += S7     ;
  iS10     += S10    ;
  iAkciz   += SAkciz ;
  iSS      += S      ;
  iSoplSt  += SoplSt ;
  iSoplSt2 += SoplSt2;
  iSReg    += SReg   ;

  if (vSchf.GetFirst SchFact = 0)
    wTipUser := vSchf.SchFact.TipUser;
end.
.if HeaderGroup
.fields
  Upcase(NameGroup)
.endfields
.begin
  IsKontrGroup := KontrGroup;
end.
Ъ≤цддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддадддддддддадддддддддаддддддддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддадддддддддддддддддаддддддддддддддддд╢Ъ≤
Ъ≤Ё    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ЁЪ≤
Ъ≤цддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбдддддддддбдддддддддбддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд╢Ъ≤
.end
.if Dopol
.end
.{ CheckEnter FeeSignersMember_Schfrees_Dir
.}
.{ CheckEnter FeeSignersMember_Schfrees_Buh
.}
.{CheckEnter SchfKatSopr
.{CheckEnter SchfSpSopr
.{CheckEnter SchfSpSoprNalog
.} // SchfSpSoprNalog
.} // SchfSpSopr
.} // SchfKatSopr
.{CheckEnter SpSchf
.} // SpSchf
.{CheckEnter KazSt
.}
.{CheckEnter NalogFinSchf
.} // NalogFinSchf
.fields
  NPP
  if (longint(dFact)<>0, DateToStr(dFact,'DD/MM/YYYY'), '')
  if (longint(dReg) <>0, DateToStr(dReg ,'DD/MM/YYYY'), '')
  StatusEDO
  UsersDoc_Name
  NSF
!  if (bExAttrLoaded,
!    iAttr.GetValue(coSchFact, cAttr, nSchFact, wTypAttr), '')
  NBlanka
  if (IsKontrGroup, if (Direct = 1, GruzTo+GruzToAddr, GruzFrom+GruzFromAddr), if (OrgINN = '', OrgName, OrgName+' ('+OrgUnnORInn+':'+OrgINN+')'))
  S1+S4+S23+S7  // ║╔╖ █└▒ 20% + ║╔╖ █└▒ 10%  + ║╔╖ █└▒ 0% + ║╔╖ █└▒
  S2+S5+S8     // █└▒ 20% + █└▒ 10% + █└▒ 0%
  S         // ┬Б╝ё╝
.endfields
Ъ≤Ё&~&&Ё@#@@@@@@@@Ё @#@@@@@@@@Ё@@@@@@@@@@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё@#~@@@@@@Ё@#~@@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&ЁЪ≤
.if ItogoGroup       // ╗Б╝ё╝ ╞╝ ёЮЦ╞╞╔. ┘А╚╗ true, Б╝ ╜╔ ╞╔Г═Б═БЛ ┬Б╝ё╝
.fields
   FooterGroup
   GrS1+GrS4+GrS7
   GrS2+GrS5
   GrS
.endfields
Ъ≤цддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддадддддддддадддддддддаддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
Ъ≤Ё    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&ЁЪ≤
Ъ≤цддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбдддддддддбдддддддддбддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.end
.[f
Ъ≤юддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддадддддддддадддддддддаддддддддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддыЪ≤
.]f
.} // Schf
.fields
  iS1+iS4+iS23+iS7
  iS2+iS5+iS8
  iSS
.endfields
Ъ≤здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё ┌▒┘┐▌:                                                                                                                                        Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&ЁЪ≤
Ъ≤юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддыЪ≤
!.begin
!  if (not NullVipRef(iAttr)) FreeVipInterface(iAttr);
!end.
.endform

!--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#doc
├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ (А ╓╝╞╝╚╜╗Б╔╚Л╜К╛ ╜═╚╝ё╝╛)
#end
.linkform 'Schfrees_32' prototype is 'Schfrees'
.NameInList '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ (А ╓╝╞╝╚╜╗Б╔╚Л╜К╛ ╜═╚╝ё╝╛)'
.Group '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒'
.create view vSchf
from
  SchFact
where
((
  nSchFact == SchFact.nRec
));
.var
 NPP:longint
 iS1:double
 iS2:double
 iS4:double
 iS5:double
 iS23:double
 iS8:double
 iS7:double
 iS10:double
 iAkciz:double
 iSS:double
 iSoplSt:double
 iSoplSt2:double
 iSReg:double
 IsKontrGroup:boolean
  Nalog2_1: string
  Nalog2_2: string
  Nalog2_Len: byte
 wTipUser: word
.endvar
.fields
  CFH
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')

  CFH
  If ( pDoc = (pDoc and 13) and pDoc <> 0
     , '▐▀─▓┘├┘┴'+
       If ( (pDoc = (pDoc and 1)) or (direct=2)
          , If ( direct=1
               , ', ┌⌡└─██⌡∙ ▐▌┼⌠▐─▓┘▀÷▄'
               , ', ▐▌▀⌠≈┘██⌡∙ ▌▓ ▐▌▒▓─┌≥┬┼▌┌'
               )
          , ' ▐▌ ▐░▌└─├─▄'
          )
     , '└▌┼⌠▄┘█▓▌┌ └▀÷ ⌠≈┘▓─ █└▒'+
        If ( direct=1
           , ' ▐▌ ▐░▌└─├─▄'
           , ' ▐▌ ▐▌┼⌠▐┼─▄'
           )
     )
.endfields
.p 55
.defo landscape
.[h skip
Ъ│^Ъ│
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ @NP@ ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё     (4)      Ё             (5)               Ё  (6)   Ё                       (7)                        Ё       (8)       Ё       (9)       Ё      (10)       Ё       (11)      ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.]h
.begin
  var i: byte;
  Nalog2_Len := 11;
  i := Pos(' ', trim(Nalog2));
  if (i>0 and i<=Nalog2_Len) then {
    Nalog2_1 := SubStr(trim(Nalog2), 1, i - 1);
    Nalog2_2 := SubStr(trim(Nalog2), i + 1, 255);
  } else {
    Nalog2_1 := SubStr(trim(Nalog2), 1, Nalog2_Len);
    Nalog2_2 := ltrim(SubStr(trim(Nalog2), Nalog2_Len + 1, 255));
  };
end.
.begin
   IsKontrGroup := false;

   NPP := 0;

   iS1      := 0.0;
   iS2      := 0.0;
   iS4      := 0.0;
   iS5      := 0.0;
   iS23     := 0.0;
   iS8      := 0.0;
   iS7      := 0.0;
   iS10     := 0.0;
   iAkciz   := 0.0;
   iSS      := 0.0;
   iSoplSt  := 0.0;
   iSoplSt2 := 0.0;
   iSReg    := 0.0;
end.
Ъ│^Ъ│

Ъ│                                                 ├⌠░█─▀Ъ│
Ъ│ @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ│

.if SetDateRange
.fields
  if ( longint(dBeg)<>0 , DateToStr(dBeg,'DD/MM/YYYY'), '')
  if ( longint(dEnd)<>0 , DateToStr(dEnd,'DD/MM/YYYY'), '')
.endfields
Ъ│                                    ╖═ ╞╔Ю╗╝╓ А @@@@@@@@@@ ╞╝ @@@@@@@@@@Ъ│

.end
.fields
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')

  If (Nalog2_1 <> '', '╗ ' + Nalog2_1, '')

  Nalog2_1
  Nalog2_2
  Nalog2_2
.endfields
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ    1 ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддддддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё Э  Ё        └═БК          Ё ▒Б═БЦА       Ё ▓╗╞ ╓╝╙Ц╛╔╜Б═                 Ё █╝╛╔Ю  Ё █═╗╛╔╜╝╒═╜╗╔ ╙╝╜БЮ═ё╔╜Б═                         Ё  ▒Ц╛╛═ ║╔╖ █└▒  Ё                 Ё      ▒Ц╛╛═      Ё      ▒Ц╛╛═      ЁЪ≤
Ъ≤Ё╞/╞ цддддддддддбддддддддддд╢              Ё                               Ё        Ё                                                  Ё@~@@@@@@@@@@@@@@@Ё@~@@@@@@@@@@@@@@@Ё       █└▒       Ё      А █└▒      ЁЪ≤
Ъ≤Ё    Ё▌Д╝Ю╛╚╔╜╗ОЁ░╔ё╗АБЮ═Ф╗╗Ё              Ё                               Ё        Ё                                                  Ё@~@@@@@@@@@@@@@@@Ё@~@@@@@@@@@@@@@@@Ё                 Ё                 ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё     (4)      Ё             (5)               Ё  (6)   Ё                       (7)                        Ё       (8)       Ё       (9)       Ё      (10)       Ё       (11)      ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.{CheckEnter Schf
.begin
  NPP++;
  
  iS1      += S1     ;
  iS2      += S2     ;
  iS4      += S4     ;
  iS5      += S5     ;
  iS23     += S23    ;
  iS8      += S8     ;
  iS7      += S7     ;
  iS10     += S10    ;
  iAkciz   += SAkciz ;
  iSS      += S      ;
  iSoplSt  += SoplSt ;
  iSoplSt2 += SoplSt2;
  iSReg    += SReg   ;

  if (vSchf.GetFirst SchFact = 0)
    wTipUser := vSchf.SchFact.TipUser;
end.
.if HeaderGroup
.fields
  Upcase(NameGroup)
.endfields
.begin
  IsKontrGroup := KontrGroup;
end.
Ъ≤цддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддаддддддддддддддддд╢Ъ≤
Ъ≤Ё    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ЁЪ≤
Ъ≤цддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд╢Ъ≤
.end
.if Dopol
.end
.{ CheckEnter FeeSignersMember_Schfrees_Dir
.}
.{ CheckEnter FeeSignersMember_Schfrees_Buh
.}
.{CheckEnter SchfKatSopr
.{CheckEnter SchfSpSopr
.{CheckEnter SchfSpSoprNalog
.} // SchfSpSoprNalog
.} // SchfSpSopr
.} // SchfKatSopr
.{CheckEnter SpSchf
.} // SpSchf
.{CheckEnter KazSt
.}
.{CheckEnter NalogFinSchf
.} // NalogFinSchf
.fields
  NPP
  if(longint(dFact)<>0, DateToStr(dFact,'DD/MM/YYYY'), '')
  if(longint(dReg) <>0, DateToStr(dReg ,'DD/MM/YYYY'), '')
  StatusEDO
  UsersDoc_Name
  NSF
  if (IsKontrGroup, if (Direct = 1, GruzTo+GruzToAddr, GruzFrom+GruzFromAddr), if (OrgINN = '', OrgName, OrgName+' ('+OrgUnnORInn+':'+OrgINN+')'))
  S1+S4+S23+S7  // ║╔╖ █└▒ 20% + ║╔╖ █└▒ 10% + ║╔╖ █└▒ 0% + ║╔╖ █└▒
  S10       // ╞Ю╝Г╗╔ ╜═╚╝ё╗
  S2+S5+S8     // █└▒ 20% + █└▒ 10% + █└▒ 0%
  S         // ┬Б╝ё╝
.endfields
Ъ≤Ё&~&&Ё@#@@@@@@@@Ё @#@@@@@@@@Ё@@@@@@@@@@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё@#~@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&ЁЪ≤
.if ItogoGroup       // ╗Б╝ё╝ ╞╝ ёЮЦ╞╞╔. ┘А╚╗ true, Б╝ ╜╔ ╞╔Г═Б═БЛ ┬Б╝ё╝
.fields
   FooterGroup
   GrS1+GrS4+GrS7
   GrS10
   GrS2+GrS5
   GrS
.endfields
Ъ≤цддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
Ъ≤Ё    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@       Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&ЁЪ≤
Ъ≤цддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.end
.[f
Ъ≤юддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддыЪ≤
.]f
.} // Schf
.fields
   iS1+iS4+iS23+iS7
   iS10
   iS2+iS5+iS8
   iSS
.endfields
Ъ≤зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё ┌▒┘┐▌:                                                                                                                               Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&ЁЪ≤
Ъ≤юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддыЪ≤
.endform

!--------------------------------------------------------------------------------------------------------------------
#doc
├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ А Ю═╖║╗╒╙╝╘ ╞╝ АБ═╒╙═╛
#end
.linkform 'Schfrees_35' prototype is 'Schfrees'
.NameInList '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ А Ю═╖║╗╒╙╝╘ ╞╝ АБ═╒╙═╛'
.Group '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒'
.create view vSchf
from
  SchFact
where
((
  nSchFact == SchFact.nRec
));
.var
 NPP:longint
 iS1:double
 iS2:double
 iS4:double
 iS5:double
 iS23:double
 iS8:double
 iS7:double
 iS10:double
 iAkciz:double
 iSS:double
 iSoplSt:double
 iSoplSt2:double
 iSReg:double
 IsKontrGroup:boolean
 wTipUser: word
.endvar
.fields
  CFH
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')+
  if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')+
  if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')+
  if (pDoc = 0 or  pBou = 0, '', ' ╗')+
  if (pDoc = 0             , '', ' Б╗╞Ц')+
  if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')

  CFH
  If ( pDoc = (pDoc and 13) and pDoc <> 0
     , '▐▀─▓┘├┘┴'+
       If ( (pDoc = (pDoc and 1)) or (direct=2)
          , If ( direct=1
               , ', ┌⌡└─██⌡∙ ▐▌┼⌠▐─▓┘▀÷▄'
               , ', ▐▌▀⌠≈┘██⌡∙ ▌▓ ▐▌▒▓─┌≥┬┼▌┌'
               )
          , ' ▐▌ ▐░▌└─├─▄'
          )
     , '└▌┼⌠▄┘█▓▌┌ └▀÷ ⌠≈┘▓─ █└▒'+
        If ( direct=1
           , ' ▐▌ ▐░▌└─├─▄'
           , ' ▐▌ ▐▌┼⌠▐┼─▄'
           )
     )
.endfields
.p 55
.defo landscape
.[h SKIP
Ъ│^Ъ│
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ @NP@ ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддбдддддддддддбддддддддддддддбддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддбддддддддддддддбддддддддддддддбддддддддддддддбддддддддддддддбдддддддддддддбдддддддддддддд©Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё      (4)     Ё           (5)              Ё  (6)   Ё                  (7)                   Ё      (8)     Ё     (9═)     Ё     (9║)     Ё    (10═)     Ё    (10║)    Ё     (11)     ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддеддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддедддддддддддддедддддддддддддд╢Ъ≤
.]h
.begin
  NPP := 0;

  iS1      := 0.0;
  iS2      := 0.0;
  iS4      := 0.0;
  iS5      := 0.0;
  iS23     := 0.0;
  iS8      := 0.0;
  iS7      := 0.0;
  iS10     := 0.0;
  iAkciz   := 0.0;
  iSS      := 0.0;
  iSoplSt  := 0.0;
  iSoplSt2 := 0.0;
  iSReg    := 0.0;
end.
Ъ│^Ъ│

Ъ│                                                 ├⌠░█─▀Ъ│
Ъ│ @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ│

.if SetDateRange
.fields
  if ( longint(dBeg)<>0 , DateToStr(dBeg,'DD/MM/YYYY'), '')
  if ( longint(dEnd)<>0 , DateToStr(dEnd,'DD/MM/YYYY'), '')
.endfields
Ъ│                                   ╖═ ╞╔Ю╗╝╓ А @@@@@@@@@@ ╞╝ @@@@@@@@@@Ъ│

.end
.fields
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')
.endfields
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ    1 ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддддддддддддддбддддддддддддддбддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддбддддддддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©Ъ≤
Ъ≤Ё Э  Ё        └═БК          Ё ▒Б═БЦА       Ё ▓╗╞ ╓╝╙Ц╛╔╜Б═              Ё █╝╛╔Ю  Ё █═╗╛╔╜╝╒═╜╗╔ ╙╝╜БЮ═ё╔╜Б═               Ё    ▒Ц╛╛═     Ё                                ┌ Б╝╛ Г╗А╚╔                              ЁЪ≤
Ъ≤Ё╞/╞ цддддддддддбддддддддддд╢              Ё                            Ё        Ё                                        Ё    А █└▒     цддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддд╢Ъ≤
Ъ≤Ё    Ё▌Д╝Ю╛╚╔╜╗ОЁ░╔ё╗АБЮ═Ф╗╗Ё              Ё                            Ё        Ё                                        Ё              Ё                          ▒Б═╒╙═                          Ё    │╔╖ █└▒   ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё              цдддддддддддддддддддддддддддддбдддддддддддддддддддддддддддд╢              ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё              Ё      20 ╞Ю╝Ф╔╜Б╝╒ (5)       Ё      10 ╞Ю╝Ф╔╜Б╝╒ (6)      Ё              ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё              цддддддддддддддбддддддддддддддеддддддддддддддбддддддддддддд╢              ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё              Ё     ▒Ц╛╛═    Ё    ▒Ц╛╛═     Ё     ▒Ц╛╛═    Ё    ▒Ц╛╛═    Ё              ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё              Ё    ║╔╖ █└▒   Ё     █└▒      Ё    ║╔╖ █└▒   Ё     █└▒     Ё              ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддеддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддедддддддддддддедддддддддддддд╢Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё      (4)     Ё            (5)             Ё  (6)   Ё                  (7)                   Ё      (8)     Ё     (9═)     Ё     (9║)     Ё    (10═)     Ё    (10║)    Ё     (11)     ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддеддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддедддддддддддддедддддддддддддд╢Ъ≤
.{CheckEnter Schf
.begin
  NPP++;

  iS1      += S1     ;
  iS2      += S2     ;
  iS4      += S4     ;
  iS5      += S5     ;
  iS23     += S23    ;
  iS8      += S8     ;
  iS7      += S7     ;
  iS10     += S10    ;
  iAkciz   += SAkciz ;
  iSS      += S      ;
  iSoplSt  += SoplSt ;
  iSoplSt2 += SoplSt2;
  iSReg    += SReg   ;

  if (vSchf.GetFirst SchFact = 0)
    wTipUser := vSchf.SchFact.TipUser;
end.
.if HeaderGroup
.fields
  Upcase(NameGroup)
.endfields
.begin
  IsKontrGroup := KontrGroup;
end.
Ъ≤цддддаддддддддддадддддддддддаддддддддддддддаддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддаддддддддддддддаддддддддддддддаддддддддддддддаддддддддддддддадддддддддддддадддддддддддддд╢Ъ≤
Ъ≤Ё    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ЁЪ≤
Ъ≤цддддбддддддддддбдддддддддддбддддддддддддддбддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддбддддддддддддддбддддддддддддддбддддддддддддддбддддддддддддддбдддддддддддддбдддддддддддддд╢Ъ≤
.end
.if Dopol
.end
.{ CheckEnter FeeSignersMember_Schfrees_Dir
.}
.{ CheckEnter FeeSignersMember_Schfrees_Buh
.}
.{CheckEnter SchfKatSopr
.{CheckEnter SchfSpSopr
.{CheckEnter SchfSpSoprNalog
.} // SchfSpSoprNalog
.} // SchfSpSopr
.} // SchfKatSopr
.{CheckEnter SpSchf
.} // SpSchf
.{CheckEnter KazSt
.}
.{CheckEnter NalogFinSchf
.} // NalogFinSchf
.fields
  NPP
  if (longint(dFact)<>0, DateToStr(dFact,'DD/MM/YYYY'), '')
  if (longint(dReg) <>0, DateToStr(dReg ,'DD/MM/YYYY'), '')
  StatusEDO
  UsersDoc_Name
  NSF
  if (IsKontrGroup, if (Direct = 1, GruzTo+GruzToAddr, GruzFrom+GruzFromAddr), if (OrgINN = '', OrgName, OrgName+' ('+OrgUnnORInn+':'+OrgINN+')'))
  S   // ┬Б╝ё╝
  S1  // ║╔╖ █└▒ 20%
  S2  // █└▒ 20%
  S4  // ║╔╖ █└▒ 10%
  S5  // █└▒ 10%
  S7  // ║╔╖ █└▒
.endfields
Ъ≤Ё&~&&Ё@#@@@@@@@@Ё @#@@@@@@@@Ё@@@@@@@@@@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё@#~@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&.&&Ё&'&&&&&&&&&.&&ЁЪ≤
.if ItogoGroup       // ╗Б╝ё╝ ╞╝ ёЮЦ╞╞╔. ┘А╚╗ true, Б╝ ╜╔ ╞╔Г═Б═БЛ ┬Б╝ё╝
.fields
   FooterGroup
   GrS   // ┬Б╝ё╝
   GrS1  // ║╔╖ █└▒ 20%
   GrS2  // █└▒ 20%
   GrS4  // ║╔╖ █└▒ 10%
   GrS5  // █└▒ 10%
   GrS7  // ║╔╖ █└▒
.endfields
Ъ≤цддддаддддддддддадддддддддддаддддддддддддддаддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддедддддддддддддедддддддддддддд╢Ъ≤
Ъ≤Ё    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&.&&Ё&'&&&&&&&&&.&&ЁЪ≤
Ъ≤цддддбддддддддддбдддддддддддбддддддддддддддбддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддедддддддддддддедддддддддддддд╢Ъ≤
.end
.[f
Ъ≤юддддаддддддддддадддддддддддаддддддддддддддаддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддаддддддддддддддаддддддддддддддаддддддддддддддаддддддддддддддадддддддддддддаддддддддддддддыЪ≤
.]f
.} // Schf
.fields
  iSS   // ┬Б╝ё╝
  iS1  // ║╔╖ █└▒ 20%
  iS2  // █└▒ 20%
  iS4  // ║╔╖ █└▒ 10%
  iS5  // █└▒ 10%
  iS7  // ║╔╖ █└▒
.endfields
Ъ≤здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбддддддддддддддбддддддддддддддбддддддддддддддбддддддддддддддбдддддддддддддбдддддддддддддд©Ъ≤
Ъ≤Ё ┌▒┘┐▌:                                                                                                                  Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&.&&Ё&'&&&&&&&&&.&&ЁЪ≤
Ъ≤юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддддддддаддддддддддддддаддддддддддддддаддддддддддддддадддддддддддддаддддддддддддддыЪ≤
.endform

!--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#doc
├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒
#end
.linkform 'Schfrees_33' prototype is 'Schfrees'
.NameInList '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒'
.Group '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ (╞╝ ╒А╔╛ ╒═╚НБ═╛)'
.create view vSchf
from
  SchFact
where
((
  nSchFact == SchFact.nRec
));
.var
 NPP:longint
 IsKontrGroup:boolean
 wTipUser: word
.endvar
.fields
  CFH
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')

  CFH
  If ( pDoc = (pDoc and 13) and pDoc <> 0
     , '▐▀─▓┘├┘┴'+
       If ( (pDoc = (pDoc and 1)) or (direct=2)
          , If ( direct=1
               , ', ┌⌡└─██⌡∙ ▐▌┼⌠▐─▓┘▀÷▄,'
               , ', ▐▌▀⌠≈┘██⌡∙ ▌▓ ▐▌▒▓─┌≥┬┼▌┌,'
               )
          , ' ▐▌ ▐░▌└─├─▄'
          )
     , '└▌┼⌠▄┘█▓▌┌ └▀÷ ⌠≈┘▓─ █└▒'+
        If ( direct=1
           , ' ▐▌ ▐░▌└─├─▄'
           , ' ▐▌ ▐▌┼⌠▐┼─▄'
           )
     )
.endfields
.p 55
.defo landscape
.[h SKIP
Ъ│^Ъ│
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ @NP@ ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддбддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё      (4)     Ё              (5)              Ё  (6)   Ё                       (7)                        Ё  (8)   Ё       (9)       Ё       (10)      Ё       (11)      ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.]h
.begin
   NPP:=0;
end.
Ъ│^Ъ│

Ъ│                                                 ├⌠░█─▀Ъ│
Ъ│ @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ│
Ъ│                                          ▐▌ ┌─▀·▓─▄ ┌▒┘∙ ┌┬└▌┌                              Ъ│

.if SetDateRange
.fields
  if (longint(dBeg)<>0, DateToStr(dBeg,'DD/MM/YYYY'), '')
  if (longint(dEnd)<>0, DateToStr(dEnd,'DD/MM/YYYY'), '')
.endfields
Ъ│                                   ╖═ ╞╔Ю╗╝╓ А @@@@@@@@@@ ╞╝ @@@@@@@@@@Ъ│

.end
.fields
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')
.endfields
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ    1 ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддддддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддбддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё Э  Ё        └═БК          Ё ▒Б═БЦА       Ё▓╗╞ ╓╝╙Ц╛╔╜Б═                  Ё █╝╛╔Ю  Ё █═╗╛╔╜╝╒═╜╗╔ ╙╝╜БЮ═ё╔╜Б═                         Ё ┌═╚НБ═ Ё      ▒Ц╛╛═      Ё      ▒Ц╛╛═      Ё      ▒Ц╛╛═      ЁЪ≤
Ъ≤Ё╞/╞ цддддддддддбддддддддддд╢              Ё                               Ё        Ё                                                  Ё        Ё     ║╔╖ █└▒     Ё       █└▒       Ё      А █└▒      ЁЪ≤
Ъ≤Ё    Ё▌Д╝Ю╛╚╔╜╗ОЁ░╔ё╗АБЮ═Ф╗╗Ё              Ё                               Ё        Ё                                                  Ё        Ё                 Ё                 Ё                 ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё     (4)      Ё              (5)              Ё  (6)   Ё                       (7)                        Ё  (8)   Ё       (9)       Ё       (10)      Ё       (11)      ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.{CheckEnter Schf
.begin
  NPP++;

  if (vSchf.GetFirst SchFact = 0)
    wTipUser := vSchf.SchFact.TipUser;
end.
.if HeaderGroup
.fields
  Upcase(NameGroup)
.endfields
.begin
  IsKontrGroup := KontrGroup;
end.
Ъ≤цддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддадддддддддддддддддадддддддддддддддддаддддддддддддддддд╢Ъ≤
Ъ≤Ё    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ЁЪ≤
Ъ≤цддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддбддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд╢Ъ≤
.end
.if Dopol
.end
.{ CheckEnter FeeSignersMember_Schfrees_Dir
.}
.{ CheckEnter FeeSignersMember_Schfrees_Buh
.}
.{CheckEnter SchfKatSopr
.{CheckEnter SchfSpSopr
.{CheckEnter SchfSpSoprNalog
.} // SchfSpSoprNalog
.} // SchfSpSopr
.} // SchfKatSopr
.{CheckEnter SpSchf
.} // SpSchf
.{CheckEnter KazSt
.}
.{CheckEnter NalogFinSchf
.} // NalogFinSchf
.fields
  NPP
  if(longint(dFact)<>0, DateToStr(dFact,'DD/MM/YYYY'), '')
  if(longint(dReg) <>0, DateToStr(dReg ,'DD/MM/YYYY'), '')
  StatusEDO
  UsersDoc_Name
  NSF
  if (IsKontrGroup, if (Direct = 1, GruzTo+GruzToAddr, GruzFrom+GruzFromAddr), if (OrgINN = '', OrgName, OrgName+' ('+OrgUnnORInn+':'+OrgINN+')'))
  SimvolV
  S1+S4+S23+S7  // ║╔╖ █└▒ 20% + ║╔╖ █└▒ 10%  + ║╔╖ █└▒ 0% + ║╔╖ █└▒
  S2+S5+S8     // █└▒ 20% + █└▒ 10% + █└▒ 0%
  S         // ┬Б╝ё╝
.endfields
Ъ≤Ё&~&&Ё@#@@@@@@@@Ё @#@@@@@@@@Ё@@@@@@@@@@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё@#~@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё@~@@@@@@Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&ЁЪ≤
.if ItogoGroup       // ╗Б╝ё╝ ╞╝ ёЮЦ╞╞╔. ┘А╚╗ true, Б╝ ╜╔ ╞╔Г═Б═БЛ ┬Б╝ё╝
.end
.[f
Ъ≤юддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддыЪ≤
.]f
.} // Schf
.endform

!--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#doc
├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ (А ╓╝╞╝╚╜╗Б╔╚Л╜К╛ ╜═╚╝ё╝╛)
#end
.linkform 'Schfrees_34' prototype is 'Schfrees'
.NameInList '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ (А ╓╝╞╝╚╜╗Б╔╚Л╜К╛ ╜═╚╝ё╝╛)'
.Group '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ (╞╝ ╒А╔╛ ╒═╚НБ═╛)'
.create view vSchf
from
  SchFact
where
((
  nSchFact == SchFact.nRec
));
.var
 NPP:longint
 iS1:double
 iS2:double
 iS4:double
 iS5:double
 iS23:double
 iS8:double
 iS7:double
 iS10:double
 iAkciz:double
 iSS:double
 iSoplSt:double
 iSoplSt2:double
 iSReg:double
 IsKontrGroup:boolean
  Nalog2_1: string
  Nalog2_2: string
  Nalog2_Len: byte
 wTipUser: word
.endvar
.fields
  CFH
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')

  CFH
  If ( pDoc = (pDoc and 13) and pDoc <> 0
     , '▐▀─▓┘├┘┴'+
       If ( (pDoc = (pDoc and 1)) or (direct=2)
          , If ( direct=1
               , ', ┌⌡└─██⌡∙ ▐▌┼⌠▐─▓┘▀÷▄,'
               , ', ▐▌▀⌠≈┘██⌡∙ ▌▓ ▐▌▒▓─┌≥┬┼▌┌,'
               )
          , ' ▐▌ ▐░▌└─├─▄'
          )
     , '└▌┼⌠▄┘█▓▌┌ └▀÷ ⌠≈┘▓─ █└▒'+
        If ( direct=1
           , ' ▐▌ ▐░▌└─├─▄'
           , ' ▐▌ ▐▌┼⌠▐┼─▄'
           )
     )
.endfields
.p 55
.defo landscape
.[h skip
Ъ│^Ъ│
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ @NP@ ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддбддддддддбдддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё     (4)      Ё              (5)              Ё  (6)   Ё                     (7)                      Ё  (8)   Ё       (9)       Ё       (10)      Ё       (11)      Ё       (12)      ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.]h
.begin
  var i: byte;
  Nalog2_Len := 11;
  i := Pos(' ', trim(Nalog2));
  if (i>0 and i<=Nalog2_Len) then {
    Nalog2_1 := SubStr(trim(Nalog2), 1, i - 1);
    Nalog2_2 := SubStr(trim(Nalog2), i + 1, 255);
  } else {
    Nalog2_1 := SubStr(trim(Nalog2), 1, Nalog2_Len);
    Nalog2_2 := ltrim(SubStr(trim(Nalog2), Nalog2_Len + 1, 255));
  };
end.
.begin
   IsKontrGroup := false;

   NPP := 0;

   iS1      := 0.0;
   iS2      := 0.0;
   iS4      := 0.0;
   iS5      := 0.0;
   iS23     := 0.0;
   iS8      := 0.0;
   iS7      := 0.0;
   iS10     := 0.0;
   iAkciz   := 0.0;
   iSS      := 0.0;
   iSoplSt  := 0.0;
   iSoplSt2 := 0.0;
   iSReg    := 0.0;
end.
Ъ│^Ъ│

Ъ│                                                   ├⌠░█─▀Ъ│
Ъ│ @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ│
Ъ│                                            ▐▌ ┌─▀·▓─▄ ┌▒┘∙ ┌┬└▌┌                              Ъ│

.if SetDateRange
.fields
  if (longint(dBeg)<>0, DateToStr(dBeg,'DD/MM/YYYY'), '')
  if (longint(dEnd)<>0, DateToStr(dEnd,'DD/MM/YYYY'), '')
.endfields
Ъ│                                    ╖═ ╞╔Ю╗╝╓ А @@@@@@@@@@ ╞╝ @@@@@@@@@@Ъ│

.end
.fields
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')

  If (Nalog2_1 <> '', '╗ ' + Nalog2_1, '')

  Nalog2_1
  Nalog2_2
  Nalog2_2
.endfields
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ    1 ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддддддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддбддддддддбдддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд©Ъ≤
Ъ≤Ё Э  Ё        └═БК          Ё ▒Б═БЦА       Ё ▓╗╞ ╓╝╙Ц╛╔╜Б═                 Ё █╝╛╔Ю  Ё █═╗╛╔╜╝╒═╜╗╔ ╙╝╜БЮ═ё╔╜Б═                     Ё ┌═╚НБ═ Ё  ▒Ц╛╛═ ║╔╖ █└▒  Ё                 Ё      ▒Ц╛╛═      Ё       ▒Ц╛╛═     ЁЪ≤
Ъ≤Ё╞/╞ цддддддддддбддддддддддд╢              Ё                               Ё        Ё                                              Ё        Ё@~@@@@@@@@@@@@@@@Ё@~@@@@@@@@@@@@@@@Ё       █└▒       Ё       А █└▒     ЁЪ≤
Ъ≤Ё    Ё▌Д╝Ю╛╚╔╜╗ОЁ░╔ё╗АБЮ═Ф╗╗Ё              Ё                               Ё        Ё                                              Ё        Ё@~@@@@@@@@@@@@@@@Ё@~@@@@@@@@@@@@@@@Ё                 Ё                 ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё     (4)      Ё              (5)              Ё  (6)   Ё                     (7)                      Ё  (8)   Ё       (9)       Ё       (10)      Ё       (11)      Ё       (12)      ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддедддддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддддд╢Ъ≤
.{CheckEnter Schf
.begin
  NPP++;
  
  iS1      += S1     ;
  iS2      += S2     ;
  iS4      += S4     ;
  iS5      += S5     ;
  iS23     += S23    ;
  iS8      += S8     ;
  iS7      += S7     ;
  iS10     += S10    ;
  iAkciz   += SAkciz ;
  iSS      += S      ;
  iSoplSt  += SoplSt ;
  iSoplSt2 += SoplSt2;
  iSReg    += SReg   ;

  if (vSchf.GetFirst SchFact = 0)
    wTipUser := vSchf.SchFact.TipUser;
end.
.if HeaderGroup
.fields
  Upcase(NameGroup)
.endfields
.begin
  IsKontrGroup := KontrGroup;
end.
Ъ≤цддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддддддддаддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддаддддддддддддддддд╢Ъ≤
Ъ≤Ё    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ЁЪ≤
Ъ≤цддддбддддддддддбдддддддддддбддддддддддддддбдддддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддддддддбддддддддбдддддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддддд╢Ъ≤
.end
.if Dopol
.end
.{ CheckEnter FeeSignersMember_Schfrees_Dir
.}
.{ CheckEnter FeeSignersMember_Schfrees_Buh
.}
.{CheckEnter SchfKatSopr
.{CheckEnter SchfSpSopr
.{CheckEnter SchfSpSoprNalog
.} // SchfSpSoprNalog
.} // SchfSpSopr
.} // SchfKatSopr
.{CheckEnter SpSchf
.} // SpSchf
.{CheckEnter KazSt
.}
.{CheckEnter NalogFinSchf
.} // NalogFinSchf
.fields
  NPP
  if(longint(dFact)<>0, DateToStr(dFact,'DD/MM/YYYY'), '')
  if(longint(dReg) <>0, DateToStr(dReg ,'DD/MM/YYYY'), '')
  StatusEDO
  UsersDoc_Name
  NSF
  if (IsKontrGroup, if (Direct = 1, GruzTo+GruzToAddr, GruzFrom+GruzFromAddr), if (OrgINN = '', OrgName, OrgName+' ('+OrgUnnORInn+':'+OrgINN+')'))
  SimvolV
  S1+S4+S23+S7  // ║╔╖ █└▒ 20% + ║╔╖ █└▒ 10%  + ║╔╖ █└▒ 0% + ║╔╖ █└▒
  S10       // ╞Ю╝Г╗╔ ╜═╚╝ё╗
  S2+S5+S8     // █└▒ 20% + █└▒ 10% + █└▒ 0%
  S         // ┬Б╝ё╝
.endfields
Ъ≤Ё&~&&Ё@#@@@@@@@@Ё @#@@@@@@@@Ё@@@@@@@@@@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё@#~@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё@~@@@@@@Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&Ё&'&&&&&&&&&&&&.&&ЁЪ≤
.if ItogoGroup       // ╗Б╝ё╝ ╞╝ ёЮЦ╞╞╔. ┘А╚╗ true, Б╝ ╜╔ ╞╔Г═Б═БЛ ┬Б╝ё╝
.end
.[f
Ъ≤юддддаддддддддддадддддддддддаддддддддддддддадддддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддддддддаддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддадддддддддддддддддыЪ≤
.]f
.} // Schf
.endform

!--------------------------------------------------------------------------------------------------------------------
#doc
├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒  А Ю═╖║╗╒╙╝╘ ╞╝ АБ═╒╙═╛
#end
.linkform 'Schfrees_36' prototype is 'Schfrees'
.NameInList '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒  А Ю═╖║╗╒╙╝╘ ╞╝ АБ═╒╙═╛'
.Group '├ЦЮ╜═╚ ╓╝╙Ц╛╔╜Б╝╒ ╞╝ ЦГ╔БЦ █└▒ (╞╝ ╒А╔╛ ╒═╚НБ═╛)'
.create view vSchf
from
  SchFact
where
((
  nSchFact == SchFact.nRec
));
.var
 NPP:longint
 IsKontrGroup:boolean
 wTipUser: word
.endvar
.fields
  CFH
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')

  CFH
  If ( pDoc = (pDoc and 13) and pDoc <> 0
     , '▐▀─▓┘├┘┴'+
       If ( (pDoc = (pDoc and 1)) or (direct=2)
          , If ( direct=1
               , ', ┌⌡└─██⌡∙ ▐▌┼⌠▐─▓┘▀÷▄,'
               , ', ▐▌▀⌠≈┘██⌡∙ ▌▓ ▐▌▒▓─┌≥┬┼▌┌,'
               )
          , ' ▐▌ ▐░▌└─├─▄'
          )
     , '└▌┼⌠▄┘█▓▌┌ └▀÷ ⌠≈┘▓─ █└▒'+
        If ( direct=1
           , ' ▐▌ ▐░▌└─├─▄'
           , ' ▐▌ ▐▌┼⌠▐┼─▄'
           )
     )
.endfields
.p 55
.defo landscape
.[h SKIP
Ъ│^Ъ│
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ @NP@ ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддбдддддддддддбддддддддддддддбддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддбддддддддбддддддддддддддбддддддддддддддбддддддддддддддбддддддддддддддбдддддддддддддбдддддддддддддд©Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё     (4)      Ё            (5)             Ё  (6)   Ё                  (7)                   Ё  (8)   Ё      (9)     Ё    (10═)     Ё    (10║)     Ё    (11═)     Ё    (11║)    Ё     (12)     ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддеддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддеддддддддеддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддедддддддддддддедддддддддддддд╢Ъ≤
.]h
.begin
   NPP:=0;
end.
Ъ│^Ъ│

Ъ│                                                 ├⌠░█─▀Ъ│
Ъ│ @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ│
Ъ│                                          ▐▌ ┌─▀·▓─▄ ┌▒┘∙ ┌┬└▌┌                              Ъ│

.if SetDateRange
.fields
  if (longint(dBeg)<>0, DateToStr(dBeg,'DD/MM/YYYY'), '')
  if (longint(dEnd)<>0, DateToStr(dEnd,'DD/MM/YYYY'), '')
.endfields
Ъ│                                   ╖═ ╞╔Ю╗╝╓ А @@@@@@@@@@ ╞╝ @@@@@@@@@@Ъ│

.end
.fields
  if (AllKontr = 0         , '', '╞╝ ╒К║Ю═╜╜К╛ ╙╝╜БЮ═ё╔╜Б═╛ ')
+ if (pBou = 0 and pDoc = 0, '', 'ЦАБ═╜╝╒╚╔╜ Д╗╚ЛБЮ ╞╝')
+ if (pBou = 0             , '', ' А╝АБ╝О╜╗Н')
+ if (pDoc = 0 or  pBou = 0, '', ' ╗')
+ if (pDoc = 0             , '', ' Б╗╞Ц')
+ if (pBou = 0 and pDoc = 0, '', ' ╓╝╙Ц╛╔╜Б╝╒')
.endfields
Ъ┴  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ъ┴Ъ│  ▀╗АБ    1 ┌А╔ё╝ ╚╗АБ╝╒______Ъ│
Ъ≤зддддбддддддддддддддддддддддбддддддддддддддбддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддбддддддддбддддддддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©Ъ≤
Ъ≤Ё Э  Ё        └═БК          Ё ▒Б═БЦА       Ё ▓╗╞ ╓╝╙Ц╛╔╜Б═              Ё █╝╛╔Ю  Ё █═╗╛╔╜╝╒═╜╗╔ ╙╝╜БЮ═ё╔╜Б═               Ё ┌═╚НБ═ Ё    ▒Ц╛╛═     Ё                                ┌ Б╝╛ Г╗А╚╔                              ЁЪ≤
Ъ≤Ё╞/╞ цддддддддддбддддддддддд╢              Ё                            Ё        Ё                                        Ё        Ё    А █└▒     цддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддд╢Ъ≤
Ъ≤Ё    Ё▌Д╝Ю╛╚╔╜╗ОЁ░╔ё╗АБЮ═Ф╗╗Ё              Ё                            Ё        Ё                                        Ё        Ё              Ё                        ▒Б═╒╙═                            Ё    │╔╖ █└▒   ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё        Ё              цдддддддддддддддддддддддддддддбдддддддддддддддддддддддддддд╢              ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё        Ё              Ё       20 ╞Ю╝Ф╔╜Б╝╒ (5)      Ё       10 ╞Ю╝Ф╔╜Б╝╒ (6)     Ё              ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё        Ё              цддддддддддддддбддддддддддддддеддддддддддддддбддддддддддддд╢              ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё        Ё              Ё    ▒Ц╛╛═     Ё    ▒Ц╛╛═     Ё    ▒Ц╛╛═     Ё   ▒Ц╛╛═     Ё              ЁЪ≤
Ъ≤Ё    Ё          Ё           Ё              Ё                            Ё        Ё                                        Ё        Ё              Ё   ║╔╖ █└▒    Ё     █└▒      Ё   ║╔╖ █└▒    Ё    █└▒      Ё              ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддеддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддеддддддддеддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддедддддддддддддедддддддддддддд╢Ъ≤
Ъ≤Ё(1) Ё   (2)    Ё    (3)    Ё     (4)      Ё            (5)             Ё  (6)   Ё                  (7)                   Ё  (8)   Ё      (9)     Ё    (10═)     Ё    (10║)     Ё    (11═)     Ё    (11║)    Ё     (12)     ЁЪ≤
Ъ≤цддддеддддддддддедддддддддддеддддддддддддддеддддддддддддддддддддддддддддеддддддддеддддддддддддддддддддддддддддддддддддддддеддддддддеддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддедддддддддддддедддддддддддддд╢Ъ≤
.{CheckEnter Schf
.begin
  NPP++;

  if (vSchf.GetFirst SchFact = 0)
    wTipUser := vSchf.SchFact.TipUser;
end.
.if HeaderGroup
.fields
  Upcase(NameGroup)
.endfields
.begin
  IsKontrGroup := KontrGroup;
end.
Ъ≤цддддаддддддддддадддддддддддаддддддддддддддаддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддаддддддддаддддддддддддддаддддддддддддддаддддддддддддддаддддддддддддддадддддддддддддадддддддддддддд╢Ъ≤
Ъ≤Ё    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ЁЪ≤
Ъ≤цддддбддддддддддбдддддддддддбддддддддддддддбддддддддддддддддддддддддддддбддддддддбддддддддддддддддддддддддддддддддддддддддбддддддддбддддддддддддддбддддддддддддддбддддддддддддддбддддддддддддддбдддддддддддддбдддддддддддддд╢Ъ≤
.end
.if Dopol
.end
.{ CheckEnter FeeSignersMember_Schfrees_Dir
.}
.{ CheckEnter FeeSignersMember_Schfrees_Buh
.}
.{CheckEnter SchfKatSopr
.{CheckEnter SchfSpSopr
.{CheckEnter SchfSpSoprNalog
.} // SchfSpSoprNalog
.} // SchfSpSopr
.} // SchfKatSopr
.{CheckEnter SpSchf
.} // SpSchf
.{CheckEnter KazSt
.}
.{CheckEnter NalogFinSchf
.} // NalogFinSchf
.fields
  NPP
  if(longint(dFact)<>0, DateToStr(dFact,'DD/MM/YYYY'), '')
  if(longint(dReg) <>0, DateToStr(dReg ,'DD/MM/YYYY'), '')
  StatusEDO
  UsersDoc_Name
  NSF
  if (IsKontrGroup, if (Direct = 1, GruzTo+GruzToAddr, GruzFrom+GruzFromAddr), if (OrgINN = '', OrgName, OrgName+' ('+OrgUnnORInn+':'+OrgINN+')'))
  SimvolV
  S   // ┬Б╝ё╝
  S1  // ║╔╖ █└▒ 20%
  S2  // █└▒ 20%
  S4  // ║╔╖ █└▒ 10%
  S5  // █└▒ 10%
  S7  // ║╔╖ █└▒
.endfields
Ъ≤Ё&~&&Ё@#@@@@@@@@Ё @#@@@@@@@@Ё@@@@@@@@@@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё@#~@@@@@Ё@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ё@~@@@@@@Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&&.&&Ё&'&&&&&&&&.&&Ё&'&&&&&&&&&.&&ЁЪ≤
.if ItogoGroup       // ╗Б╝ё╝ ╞╝ ёЮЦ╞╞╔. ┘А╚╗ true, Б╝ ╜╔ ╞╔Г═Б═БЛ ┬Б╝ё╝
.end
.[f
Ъ≤юддддаддддддддддадддддддддддаддддддддддддддаддддддддддддддддддддддддддддаддддддддаддддддддддддддддддддддддддддддддддддддддаддддддддаддддддддддддддаддддддддддддддаддддддддддддддаддддддддддддддадддддддддддддаддддддддддддддыЪ≤
.]f
.} // Schf
.endform

!--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
