//*******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 9.1
// Печатные формы книг покупок/продаж с 01.01.2019
//*******************************************************************************
#doc
Книга продаж (с 01.01.2019)
#end
.linkform 'BkPrZkF_45_19' prototype is 'BkPrZkF'
.NameInList 'Книга продаж (с 01.01.2019)'
.Group 'Продажи 2019'
.Group 'Country' subGroup 'Russia'
.set filler '-'
.P 60
.defo landscape
.var
 LS1:double
 LS2:double
 LS4:double
 LS5:double
 LS9:double
 LS7:double
 LS1_20, LS1_18:double
 LS2_20, LS2_18:double

 ISumm1_20, ISumm1_18:double;
 ISumm2_20, ISumm2_18:double;

 npp: longint
 nPage: longint;
.endvar
.begin
 nPage := firstPage;
end.
.fields
 CommonFormHeader
 if (RegTips = 0, 'КНИГА ПРОДАЖ', 'РЕЕСТР ЗАПИСЕЙ (ПРОДАЖИ)')
 MyOrg
 if (Trim(MyINN + MyKPP) = '', '', MyINN + '/' + MyKPP)
 DateToStr(BegDate, 'DD.MM.YYYY')
 DateToStr(EndDate, 'DD.MM.YYYY')
.endfields
.begin
 npp := 0;
 LS1:=0.0;
 LS2:=0.0;
 LS4:=0.0;
 LS5:=0.0;
 LS9:=0.0;
 LS7:=0.0;
 LS1_18:=0.0;
 LS2_18:=0.0;
 LS1_20:=0.0;
 LS2_20:=0.0;
end.
^
 Ш                                                                                                                                                                                                                     Приложение № 5 Ш
 Ш                                                                                                                                                                                                      к постановлению Правительства Ш
 Ш                                                                                                                                                                                                               Российской Федерации Ш
 Ш                                                                                                                                                                                                       от 26 декабря 2011 г. № 1137 Ш
 Ш                                                                                                                                                                         (в ред. Постановления Правительства РФ от 19.01.2019 № 15) Ш



 Б    @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б


 И                     Продавец      Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 И                     Идентификационный номер и код причины постановки на учет И
 И                     налогоплательщика-продавца  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 И                     Продажа за период с  Д@@@@@@@@@@ Д по  Д@@@@@@@@@@ М

.{CheckEnter FiltKontr
.fields
  if(wKolFilt  = 1, 'Наложен фильтр по', '')
  if(wKolKontr = 1, 'контрагентам:'    , '')
  FiltKontrVal
.endfields
 Р @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.{CheckEnter FiltTip
.fields
  if(wKolFilt = 1, 'Наложен фильтр по', '')
  if(wKolTip  = 1, 'типам записей:'   , '')
  FiltTipVal
.endfields
 Р @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.{CheckEnter FiltPodr
.fields
  if(wKolFilt = 1, 'Наложен фильтр по', '')
  if(wKolPodr = 1, 'подразделениям:'  , '')
  FiltPodrVal
.endfields
 Р @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.fields
  nPage
  GetKatOrgAttrName4Rep('UNN', 0, GetStateRef(ccRus)) + '/КПП'
  GetKatOrgAttrName4Rep('UNN', 0, GetStateRef(ccRus)) + '/КПП'
.endfields
 Р                                                                                                                                                                           Лист  Д @@@@@ Д из _____ Р
 Ш┌────┬───┬─────────┬───────┬────┬─────────┬─────────┬─────────┬─────────┬─────────┬───────────────────┬─────────┬───────┬─────────────────────────┬───────────────────────────────────────────────┬───────────────────────────────────┬──────────────┐ Ш
 Ш│  № │Код│ Номер и │ Реги- │ Код│ Номер и │ Номер и │ Номер и │  Наиме- │@~@@@@@@@│      Сведения о   │  Номер и│ Наиме-│   Стоимость продаж по   │          Стоимость продаж, облагаемых         │       Сумма НДС по счету-         │  Стоимость   │ Ш
 Ш│ п/п│ви-│  дата   │страци-│вида│  дата   │  дата   │  дата   │ нование │ покупа- │      посреднике   │   дата  │нование│ счету-фактуре, разница  │     налогом, по счету-фактуре, разница        │         фактуре, разница          │ продаж, осво-│ Ш
 Ш│    │да │  счета- │ онный │ то-│исправле-│корректи-│исправле-│покупате-│  теля   │    (комиссионере, │ докумен-│ и код │  стоимости по корректи- │       стоимости по   корректировочному        │           суммы налога по         │ бождаемых от │ Ш
 Ш│    │опе│ фактуры │ номер │ ва-│   ния   │ровочного│   ния   │   ля    │         │       агенте)     │    та,  │валюты │ ровочному счету-фактуре │        счету-фактуре (без НДС) в рублях       │          корректировочному        │  налога, по  │ Ш
 Ш│    │ра-│продавца │ тамо- │ ра │ счета-  │ счета-  │корректи-│         │         │                   │ подтвер-│       │    (включая НДС) в      │             и копейках, по ставке             │      счету-фактуре, в рублях      │счету-фактуре,│ Ш
 Ш│    │ции│         │женной │    │ фактуры │ фактуры │ровочного│         │         │                   │ ждающего│       │  валюте счета-фактуры   │                                               │        и копейках, по ставке      │   разница    │ Ш
 Ш│    │   │         │ декла-│    │продавца │продавца │ счета-  │         │         │                   │ оплату  │       │                         │                                               │                                   │ стоимости по │ Ш
 Ш│    │   │         │ рации │    │         │         │ фактуры │         │         ├─────────┬─────────┤         │       ├───────────┬─────────────┼───────────┬───────────┬───────────┬───────────┼───────────┬───────────┬───────────┤корректировоч-│ Ш
 Ш│    │   │         │       │    │         │         │продавца │         │         │ наимено-│@~@@@@@@@│         │       │ в валюте  │ в рублях и  │    20     │    18     │    10     │     0     │     20    │    18     │     10    │  ному счету- │ Ш
 Ш│    │   │         │       │    │         │         │         │         │         │вание по-│ посред- │         │       │  счета-   │  копейках   │ процентов │ процентов │ процентов │ процентов │ процентов │ процентов │ процентов │фактуре в руб-│ Ш
 Ш│    │   │         │       │    │         │         │         │         │         │ средника│  ника   │         │       │ фактуры   │             │           │           │           │           │           │           │           │лях и копейках│ Ш
 Ш├────┼───┼─────────┼───────┼────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼───────┼───────────┼─────────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────────┤ Ш
 Ш│  1 │ 2 │    3    │   3а  │ 3б │    4    │    5    │    6    │    7    │    8    │    9    │    10   │    11   │   12  │    13а    │     13б     │    14     │   14а     │    15     │    16     │    17     │   17а     │    18     │      19      │ Ш
 Ш├────┼───┼─────────┼───────┼────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼───────┼───────────┼─────────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────────┤ Ш
.{
.{CheckEnter BkPrZkVal
.begin
 ISumm1_18 := 0;
 ISumm2_18 := 0;
 ISumm1_20 := 0;
 ISumm2_20 := 0;
end.
.{CheckEnter BkPrZkMain
.fields
 if (RegTips = 0, 'Книга продаж', 'Реестр записей (продажи)')
 DateToStr(BegDate, 'DD.MM.YYYY')
 DateToStr(EndDate, 'DD.MM.YYYY')
 UnnORInn
 MyInn
 FiltTxt
 nPage
.endfields
.[h SKIP
.begin
 LS1:=0.0;
 LS2:=0.0;
 LS4:=0.0;
 LS5:=0.0;
 LS9:=0.0;
 LS7:=0.0;
 LS1_18:=0.0;
 LS2_18:=0.0;
 LS1_20:=0.0;
 LS2_20:=0.0;

 nPage++;
end.
 Р @@@@@@@@@@@@@@@@@@@@@@@@ за период с  Д@@@@@@@@@@ Д по  Д@@@@@@@@@@ Д  ^  Д@@@@@@@@@@@@@@@@@@@@ Д @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                       Лист  Д @@@@@  Д из _____ Р
 Ш┌────┬───┬─────────┬───────┬────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬───────┬───────────┬─────────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬────────────┬──────────────┐ Ш
 Ш│  1 │ 2 │    3    │   3а  │ 3б │    4    │    5    │    6    │    7    │    8    │    9    │    10   │    11   │   12  │    13а    │     13б     │   14      │   14a     │    15     │    16     │    17     │   17а     │     18     │      19      │ Ш
 Ш├────┼───┼─────────┼───────┼────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼───────┼───────────┼─────────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼────────────┼──────────────┤ Ш
.]h
.begin
 npp++;
end.
.if TipUsersGroup
.end //if
.if PodrGroup
.end
.if GroupBKObjectStroi
.end
.if KatOrgGroup
.end
.if DesGrGroup
.end
.{CheckEnter BookZk
.}
.begin
  ISumm1_20 += Summ1_20;
  ISumm2_20 += Summ2_20;

  LS1_20 += Summ1_20;
  LS2_20 += Summ2_20;

  ISumm1_18 += Summ1;
  ISumm2_18 += Summ2;

  LS1_18 += Summ1;
  LS2_18 += Summ2;
end.
.begin
 if (IsIncItog)
 {
   LS1+=Summ1;
   LS2+=Summ2;
   LS4+=Summ4;
   LS5+=Summ5;
   LS9+=Summ9;
   LS7+=Summ7;
 }
end.
.fields
 #DashPrint_(string(npp))
 #DashPrint_(KodOp)
 #DashPrint_(DatNomSF)
 GTDCountry
 KodTNVED
 #DashPrint_(if(longint(DatRevSF)    = 0 and NomRevSF    = '', '', if (ZeroPrint, NomRevSF   , LTrim(NomRevSF   , '0')) + ' ' + DateToStr(DatRevSF   , 'DD.MM.YYYY')))
 #DashPrint_(if(longint(DatCorrV)    = 0 and NomCorrV    = '', '', if (ZeroPrint, NomCorrV   , LTrim(NomCorrV   , '0')) + ' ' + DateToStr(DatCorrV   , 'DD.MM.YYYY')))
 #DashPrint_(if(longint(DatRevCorrV) = 0 and NomRevCorrV = '', '', if (ZeroPrint, NomRevCorrV, LTrim(NomRevCorrV, '0')) + ' ' + DateToStr(DatRevCorrV, 'DD.MM.YYYY')))
 #DashPrint_(KontrNameNazn)
 #DashPrint_(if ((ltrim(trim(KontrINN), '-') = '') and (ltrim(trim(KontrKPP), '-') = ''), '-', KontrINN + '/' + KontrKPP))
 #DashPrint_(MediatorName)
 #DashPrint_(MediatorINN_KPP)
 #DashPrint_(sSomeDateOplata)
 #DashPrint_(KodNameVal)
 SumVal
 SummA
 Summ1_20
 Summ1
 Summ4
 Summ9
 Summ2_20
 Summ2
 Summ5
 Summ7

 nPage
 LS1_20
 LS1_18
 LS4
 LS9
 LS2_20
 LS2_18
 LS5
 LS7

 ISumm1_20
 ISumm1_18
 ISumm4
 ISumm9
 ISumm2_20
 ISumm2_18
 ISumm5
 ISumm7
 Signer
 SignerDover

.endfields
 Ш│@@@@│@@@│@@@@@@@@@│@@@@@@@│@@@@│@@@@@@@@@│@@@@@@@@@│@@@@@@@@@│@@@@@@@@@│@~@@@@@@@│@~@@@@@@@│@~@@@@@@@│@~@@@@@@@│@~@@@@@│&'#&&&&&.&&│&'#&&&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&&&&.&&│ Ш
.[f
 Ш└────┴───┴─────────┴───────┴────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┼─────────┴───────┴───────────┴─────────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────────┤ Ш
 Ш                                                                                                      │  Всего по листу № @@@@@@@                 │&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&&&&.&&│ Ш
 Ш                                                                                                      └───────────────────────────────────────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴──────────────┘ Ш
.]f
.}
 Щ                                                                                                      ┌───────────────────────────────────────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬──────────────┐ Ш
 Щ                                                                                                      │   Всего                                   │&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&&&&.&&│ Щ
 Щ                                                                                                      └───────────────────────────────────────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴──────────────┘ Ш

.}
.{CheckEnter BkPrZkAllVal
.}
.}
 И
     Руководитель организации
     или иное уполномоченное лицо   _________________________                Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                          (подпись)                               (Ф.И.О.)
                                                                             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
     Индивидуальный предприниматель
     или иное уполномоченное лицо   _________________________              __________________________________________
                                          (подпись)                               (Ф.И.О.)
     Реквизиты свидетельства о государственной
     регистрации индивидуального предпринимателя _____________________________________ И
!
.begin
  SaveMyDsk(nPage + 1, 'o'+'bkprzkf_g_numPageBk');
end.
.endform
