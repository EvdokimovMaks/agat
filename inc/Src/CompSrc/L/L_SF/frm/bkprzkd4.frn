//*******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 9.1
// Печатные формы дополнительных листов книг покупок/продаж с 01.01.2019
//*******************************************************************************
#doc
Дополнительный лист книги продаж (с 01.01.2019)
#end
.linkform 'BkPrZkF_41_D_19' prototype is 'BkPrZkF'
.NameInList 'Дополнительный лист книги продаж (с 01.01.2019)'
.Group 'Дополнительный лист книги продаж 2019'
.Group 'Country' subGroup 'Russia'
.set filler '-'
.var
  ISumm1_18, ISumm2_18 : Double;
  ISumm1_20, ISumm2_20 : Double;
  sItogo               : String;
  bIsBeginReport       : Boolean;
  npp: longint
  nPage    : LongInt;
  lKolItog : LongInt;
.endvar
.P 60
.defo landscape
.begin
  nPage := firstPage;
end.
.fields
 'Дополнительный лист книги продаж № ' + String(NumDopBook)
 DateToStr(BegDate, 'DD.MM.YYYY')
 DateToStr(EndDate, 'DD.MM.YYYY')
 UnnORInn
 MyInn
 FiltTxt
 nPage

 CommonFormHeader
 'ДОПОЛНИТЕЛЬНЫЙ ЛИСТ КНИГИ ПРОДАЖ № ' + String(NumDopBook)
 MyOrg
 MyINN + '/' + MyKPP
 PeriodBook
 DateDopL
.endfields
.[h SKIP
.begin
  nPage++;
end.
 Р @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ за период с  Д@@@@@@@@@@ Д по  Д@@@@@@@@@@ Д ^  Д@@@@@@@@@@@@@@@@@@@@ Д @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                 Лист  Д @@@@@  Д из _____ Р
 Ш├────┼─────┼─────────┼─────────┼─────┼─────────┼─────────┼─────────┼──────────┼─────────┼──────────┼──────────┼─────────┼───────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼─────────────┤ Ш
 Ш│  1 │  2  │    3    │   3а    │ 3б  │    4    │    5    │    6    │     7    │    8    │     9    │    10    │   11    │   12  │    13а    │    13б    │    14     │   14a     │    15     │    16     │    17     │   17а     │    18     │     19      │ Ш
 Ш└────┴─────┴─────────┴─────────┴─────┴─────────┴─────────┴─────────┴──────────┴─────────┴──────────┴──────────┴─────────┴───────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴─────────────┘ Ш
.]h
.begin
  bIsBeginReport := True;
  npp := 0;
end.
^
 И                                                                                                                Утв. постановлением Правительства РФ
                                                                                                                               от 26.12.2011 г. № 1137
                                                                                           (в ред. Постановления Правительства РФ от 19.08.2017 № 981)
 И
 Б                       @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б


 И Продавец      Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 И Идентификационный номер и код причины постановки на учет  И
 И налогоплательщика-продавца   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 И Налоговый период, год        Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ М
 И Дополнительный лист составлен  Д@@@@@@@@@@@ М
.{CheckEnter FiltKontr
.fields
  if(wKolFilt  = 1, 'Наложен фильтр по', '')
  if(wKolKontr = 1, 'контрагентам:'    , '')
  FiltKontrVal
.endfields
.[h OVERWRITE
.]h
 Р @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.{CheckEnter FiltTip
.fields
  if(wKolFilt = 1, 'Наложен фильтр по', '')
  if(wKolTip  = 1, 'типам записей:'   , '')
  FiltTipVal
.endfields
.[h OVERWRITE
.]h
 Р @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.{CheckEnter FiltPodr
.fields
  if(wKolFilt = 1, 'Наложен фильтр по', '')
  if(wKolPodr = 1, 'подразделениям:'  , '')
  FiltPodrVal
.endfields
.[h OVERWRITE
.]h
 Р @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.fields
  nPage
  GetKatOrgAttrName4Rep('UNN', 0, GetStateRef(ccRus)) + '/КПП'
  GetKatOrgAttrName4Rep('UNN', 0, GetStateRef(ccRus)) + '/КПП'
.endfields
 Р                                                                                                                                                                                 Лист  Д @@@@@  Д из _____ Р
 Ш┌────┬─────┬─────────┬─────────┬─────┬─────────┬─────────┬─────────┬──────────┬─────────┬─────────────────────┬─────────┬───────┬───────────────────────┬───────────────────────────────────────────────┬───────────────────────────────────┬─────────────┐ Ш
 Ш│  № │ Код │ Номер и │Регистра-│ Код │ Номер и │ Номер и │ Номер и │ Наимено- │@~@@@@@@@│Сведения о посреднике│ Номер и │ Наиме-│   Стоимость продаж по │          Стоимость продаж, облагаемых         │       Сумма НДС по счету-         │  Стоимость  │ Ш
 Ш│ п/п│ вида│  дата   │ ционный │вида │  дата   │  дата   │  дата   │   вание  │ покупа- │   (комиссионере,    │  дата   │нование│ счету-фактуре, разница│     налогом, по счету-фактуре, разница        │         фактуре, разница          │ продаж, осво│ Ш
 Ш│    │ опе-│  счета- │ номер   │това-│исправле-│корректи-│исправле-│покупателя│  теля   │      агенте)        │ докумен-│ и код │ стоимости по корректи-│       стоимости по   корректировочному        │           суммы налога по         │ бождаемых от│ Ш
 Ш│    │ ра- │ фактуры │ таможен-│ ра  │   ния   │ровочного│   ния   │          │         │                     │    та,  │валюты │ровочному счету-фактуре│        счету-фактуре (без НДС) в рублях       │          корректировочному        │  налога, по │ Ш
 Ш│    │ ции │продавца │   ной   │     │ счета-  │ счета-  │корректи-│          │         │                     │подтверж-│       │    (включая НДС) в    │             и копейках, по ставке             │      счету-фактуре, в рублях      │счету-фактуре│ Ш
 Ш│    │     │         │ деклара-│     │ фактуры │ фактуры │ровочного│          │         │                     │ дающего │       │  валюте счета-фактуры │                                               │        и копейках, по ставке      │   разница   │ Ш
 Ш│    │     │         │   ции   │     │продавца │продавца │ счета-  │          │         │                     │ оплату  │       │                       │                                               │                                   │ стоимости по│ Ш
 Ш│    │     │         │         │     │         │         │ фактуры │          │         ├──────────┬──────────┤         │       ├───────────┬───────────┼───────────┬───────────┬───────────┬───────────┼───────────┬───────────┬───────────┤корректировоч│ Ш
 Ш│    │     │         │         │     │         │         │продавца │          │         │ наимено- │@~@@@@@@@@│         │       │ в валюте  │в рублях и │    20     │    18     │    10     │     0     │     20    │    18     │     10    │  ному счету-│ Ш
 Ш│    │     │         │         │     │         │         │         │          │         │  вание   │посредника│         │       │  счета-   │ копейках  │ процентов │ процентов │ процентов │ процентов │ процентов │ процентов │ процентов │фактуре в руб│ Ш
 Ш│    │     │         │         │     │         │         │         │          │         │посредника│          │         │       │ фактуры   │           │           │           │           │           │           │           │           │лях и копейка│ Ш
 Ш├────┼─────┼─────────┼─────────┼─────┼─────────┼─────────┼─────────┼──────────┼─────────┼──────────┼──────────┼─────────┼───────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼─────────────┤ Ш
 Ш│  1 │  2  │    3    │   3а    │ 3б  │    4    │    5    │    6    │     7    │    8    │     9    │    10    │   11    │   12  │    13а    │    13б    │    14     │   14а     │    15     │    16     │    17     │   17а     │    18     │     19      │ Ш
 Ш└────┴─────┴─────────┴─────────┴─────┴─────────┴─────────┴─────────┴──────────┴─────────┴──────────┴──────────┴─────────┴───────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴─────────────┘ Ш
.{
.{CheckEnter BkPrZkVal
.begin
 ISumm1_18 := 0;
 ISumm2_18 := 0;
 ISumm1_20 := 0;
 ISumm2_20 := 0;
end.
 Ш┌────┬─────┬─────────┬─────────┬─────┬─────────┬─────────┬─────────┬──────────┬─────────┬──────────┬──────────┬─────────┬───────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬─────────────┐ Ш
.{CheckEnter BkPrZkMain
.begin
 npp++;
end.
.if TipUsersGroup
.end
.if PodrGroup
.end
.if GroupBKObjectStroi
.end
.if KatOrgGroup
.end
.if DesGrGroup
.end
.{CheckEnter BookZk
.}
.begin
  if (IsNDS20)
  {
    ISumm1_20 += Summ1;
    ISumm2_20 += Summ2;
  }
  else
  {
    ISumm1_18 += Summ1;
    ISumm2_18 += Summ2;
  }

  bIsBeginReport := False;
end.
.fields
 #DashPrint_(string(npp))
 #DashPrint_(KodOp)
 #DashPrint_(DatNomSF)
 GTDCountry
 KodTNVED
 #DashPrint_(if (longint(DatRevSF)    = 0 and NomRevSF    = '', '', if (ZeroPrint, NomRevSF   , LTrim(NomRevSF   , '0')) + ' ' + DateToStr(DatRevSF   , 'DD.MM.YYYY')))
 #DashPrint_(if (longint(DatCorrV)    = 0 and NomCorrV    = '', '', if (ZeroPrint, NomCorrV   , LTrim(NomCorrV   , '0')) + ' ' + DateToStr(DatCorrV   , 'DD.MM.YYYY')))
 #DashPrint_(if (longint(DatRevCorrV) = 0 and NomRevCorrV = '', '', if (ZeroPrint, NomRevCorrV, LTrim(NomRevCorrV, '0')) + ' ' + DateToStr(DatRevCorrV, 'DD.MM.YYYY')))
 #DashPrint_(KontrNameNazn)
 #DashPrint_(if ((ltrim(trim(KontrINN), '-') = '') and (ltrim(trim(KontrKPP), '-') = ''), '-', KontrINN + '/' + KontrKPP))
 #DashPrint_(MediatorName)
 #DashPrint_(MediatorINN_KPP)
 #DashPrint_(sSomeDateOplata)
 #DashPrint_(KodNameVal)
 SumVal
 SummA
 Summ1_20
 Summ1
 Summ4
 Summ9
 Summ2_20
 Summ2
 Summ5
 Summ7
.endfields
 Ш│@@@@│@@@@@│@@@@@@@@@│@@@@@@@@@│@@@@@│@@@@@@@@@│@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@│@~@@@@@@@│@~@@@@@@@@│@~@@@@@@@@│@@@@@@@@@│@@@@@@@│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&&&.&&│ Ш
.}
 Ш└────┴─────┴─────────┴─────────┴─────┴─────────┴─────────┴─────────┴──────────┴─────────┴──────────┴──────────┴─────────┴───────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴─────────────┘ Ш
.}
 Ш┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬─────────────┐ Ш
.begin
  lKolitog := 0;
end.
.{CheckEnter BkPrZkAllVal
.begin
  lKolItog++;
  sItogo := if (bIsBeginReport and lKolItog = 1, 'Итого', 'Всего');
end.
.fields
 sItogo
 AllSumm1_20
 AllSumm1_18
 AllSumm4
 AllSumm9
 AllSumm2_20
 AllSumm2_18
 AllSumm5
 AllSumm7
 Signer
 SignerDover
.endfields
 Ш│                                                                                                                                              @@@@@@@  │&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&.&&│&'#&&&&&&&.&&│ Ш
.}
 Ш└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴─────────────┘ Ш
.}
 И
     Руководитель организации
     или иное уполномоченное лицо   _________________________  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                          (подпись)                   (Ф.И.О.)
                                                               Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
     Индивидуальный предприниматель
     или иное уполномоченное лицо   _________________________ __________________________________________
                                          (подпись)                   (Ф.И.О.)
     Реквизиты свидетельства о государственной
     регистрации индивидуального предпринимателя _____________________________________ И
.begin
  SaveMyDsk(nPage + 1, 'o' + 'bkprzkf_g_numPageBk_Dop');
end.
.endform
