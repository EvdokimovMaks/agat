//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Логистика
// Функции работы с ДЕИ
//******************************************************************************

// для объявления переменной необходимо использовать #include DEIfuns.var (для
// обеспечения межверсионной устойчивости), в котором описана переменная oDEIfuns
// с типом текущей последней версии объекта
//
// пример использования:
//      if oDEIfuns.

//******************************************************************************
#ifNdef __DEIfuns_vih__
#define __DEIfuns_vih__

//******************************************************************************

#ifdef ComponentVersion
#component "L_COMMON"
#end

#doc
Содержит описание функций работы с ДЕИ
#end
ObjInterface ObjDEIfuns;

//******************************************************************************
#doc
Функция формирования ДЕИ в спецификации сопроводительного документа по количеству
в отпускных единицах. Если записи существуют, то проводится пересчет
с новым количеством. Возвращает 0, если операция прошла успешно, не 0 - иначе
#end
Procedure UpdateDEIKolSpSopr(
                SpSopr__NRec     : comp;
                SPSopr__Vidsopr  : word;
                SpSopr__cMCUsl   : comp;
                SpSopr__PrMC     : word;
                wTipKol          : word;   // wTipKol: 1 - Kolfact  2 - Kol   3 - KolOpl
                _OldKol          : double;
                _NewKol          : TSumma;
                lParam           : longint
          );

//******************************************************************************
#doc
Функция копирования значений ДЕИ из позиции спецификации документа-основания
в позицию спецификации сопроводительного документа.
Проверка на совпадение МЦ не проводится. Копирование проводится без пересчета значений ДЕИ.
#end
Procedure CopyDEISpSteptoSpSopr(
                SpStep__NRec     : comp;
                SpSopr__NRec     : comp;
                SpSopr__VidSopr  : word;
                _wTipKolSrc      : word;    // тип количества источника
                _KolSrc          : double;  // количество источника в отпускных
                _wTipKolDest     : word;    // тип количества приемника
                _KolDest         : double   // количество приемника в отпускных
          );

//******************************************************************************
#doc
Функция копирования значений ДЕИ из позиции спецификации договора/соглашения/ПКП
в позицию спецификации сопроводительного документа.
Проверка на совпадение МЦ не проводится. Копирование проводится без пересчета значений ДЕИ.
#end
Procedure CopyDEISpDocstoSpSopr(
                SpDocs__NRec     : comp;
                SpSopr__NRec     : comp;
                SpSopr__VidSopr  : word;
                _wTipKolSrc      : word;    // тип количества источника
                _KolSrc          : double;  // количество источника в отпускных
                _wTipKolDest     : word;    // тип количества приемника
                _KolDest         : double   // количество приемника в отпускных
          );

//******************************************************************************
#doc
Функция формирования ДЕИ в спецификации документа-основания по количеству
в отпускных единицах. Если записи существуют, то проводится пересчет
с новым количеством. Возвращает 0, если операция прошла успешно, не 0 - иначе
#end
procedure UpdateDEIKolSpStep(
                SpStep_NRec    : comp;
                SpStep_PrMC    : word;
                SpStep_cMCUsl  : comp;
                wTipKol        : word;      // wTipKol: 1 - KolSkl 2 - Kol 3 - KolOpl
                _OldKol        : double;
                _NewKol        : TSumma;
                lParam         : longint;
                _wVidDoc       : word
          );

//******************************************************************************
#doc
Функция копирования значений ДЕИ из позиции спецификации договора/соглашения/ПКП
в позицию спецификации документа-основания.
Проверка на совпадение МЦ не проводится. Копирование проводится без пересчета значений ДЕИ.
#end
Procedure CopyDEISpDocstoSpStep(
                 SpDocs_NRec  : comp;
                 SpStep_NRec  : comp;
                _wTipKolSrc   : word;    // тип количества источника
                _KolSrc       : double;  // количество источника в отпускных
                _wTipKolDest  : word;    // тип количества приемника
                _KolDest      : double;  // количество приемника в отпускных
                _wVidDoc      : word     // вид ДО
           );

//******************************************************************************
#doc
Функция копирования значений ДЕИ из одной позиции спецификации документа-основания в другую.
Проверка на совпадение МЦ не проводится. Копирование проводится без пересчета значений ДЕИ.
#end
Procedure CopyDEISpStep2(
                _cRecSrc      : comp;    // NRec источника
                _wTipKolSrc   : word;    // тип количества источника
                _KolSrc       : double;  // количество источника в отпускных
                _cRecDest     : comp;    // NRec приемника
                _wTipKolDest  : word;    // тип количества приемника
                _KolDest      : double;  // количество приемника в отпускных
                _wVidDoc      : word     // вид ДО
          );

//******************************************************************************
#doc
Функция копирования значений ДЕИ из позиции спецификации сопроводительного документа
в позицию спецификации документа-основания.
Проверка на совпадение МЦ не проводится. Копирование проводится без пересчета значений ДЕИ.
#end
Procedure CopyDEISpSoprtoSpStep(
                _cRecSrc      : comp;    // NRec источника
                _wTipKolSrc   : word;    // тип количества источника
                _KolSrc       : double;  // количество источника в отпускных
                _cRecDest     : comp;    // NRec приемника
                _wTipKolDest  : word;    // тип количества приемника
                _KolDest      : double;  // количество приемника в отпускных
                _wVidDoc      : word     // вид ДО
          );

//******************************************************************************

end;

//******************************************************************************

VipInterface DEIfuns implements ObjDEIfuns licensed (FREE);

#end
//******************************************************************************
