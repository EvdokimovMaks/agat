!подсчет сумм по странице и итоговых сумм
.begin
  Nom++;
  NomFull++;
  _su1 :=0;
  _su2 :=0;
  _su3 :=0;
  fplog('Nom ='+string(Nom) );



  _su1 := oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек);
  Sum3ItogFull += if ( _su1 > 0,  _su1, 0); //уменьшение
  Sum4ItogFull += if ( _su1 < 0, -_su1, 0); //увеличение

  _su2 := oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек);

  Sum5ItogFull += if ( _su2 > 0,  _su2, 0); //уменьшение
  Sum6ItogFull += if ( _su2 < 0, -_su2, 0); //увеличение

  //_su := (oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек))
  //      -(oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек));

  _su3:=_su2-_su1;
  Sum1ItogFull +=  if ( _su3 > 0,  _su3, 0); //уменьшение
  Sum2ItogFull +=  if ( _su3 < 0, -_su3, 0); //увеличение

  Sum7ItogFull += oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек);
  Sum8ItogFull += oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек);
  fplog('Sum1ItogFull ='+string(Sum1ItogFull,0,2)+', Sum2ItogFull='+string(Sum2ItogFull,0,2) );
end.
