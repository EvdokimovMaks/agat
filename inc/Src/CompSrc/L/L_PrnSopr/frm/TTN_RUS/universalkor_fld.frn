!Поля для корректировочного универсального передаточного документа (universal_kor.rtf)
.fields
  Ean13ToEanGnivcTTF(GenerateBarCodeEx(coKatSopr, накладная_нрек))
  номер
  if (Дата=Date(0,0,0),'',DateToStr(Дата,'DD/MM/YYYY'))
  oPrnSoprFun.GetSchFactNum (накладная_нрек)
  oPrnSoprFun.GetSchFactDate(накладная_нрек)

  if (СчФакт_НРек <> 0, '1', '2')
  //продавец
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetOrgFullName(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 0), 8, 0, Дата), (oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 1) + oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 2)))
  LTrim(LTrim(if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactOrgAddr(СчФакт_НРек, 0), #AdrFieldsUr(Поставщик,Поставщик_СТАРАНА_КОД)), ','), ' ')
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactOrgUNN(СчФакт_НРек, 0), (ПоставщикУНН + ' / ' + ПоставщикКПП))

  //покупатель
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetOrgFullName(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 1), 8, 0, Дата), (oPrnSoprFun.GetOrgFullName(накладная_нрек, 3, 1) + oPrnSoprFun.GetOrgFullName(накладная_нрек, 3, 2)))
  LTrim(LTrim(if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactOrgAddr(СчФакт_НРек, 1), #AdrFieldsUr(Получатель,Получатель_СТАРАНА_КОД)), ','), ' ')
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactOrgUNN (СчФакт_НРек, 1), (ПолучательУНН + ' / ' + ПолучательКПП))

  //Валюта: наименование, код
  if (oPrnSoprFun.GetValName(Валюта_нрек) = '', sGetTune('NDE.NAMERUBL'), oPrnSoprFun.GetValName(Валюта_нрек))
  if (oPrnSoprFun.GetValCode(Валюта_нрек) = '', sGetTune('NDE.RUBLISO') , oPrnSoprFun.GetValCode(Валюта_нрек))

  Nom
  КодМЦ
  Название
  //А (до изменения)
  CodeEd
  УчЕд
  DoubleToStr(oPrnSoprFun.GetKDKolOld(спецификацияМЦ_нрек), Kol_Pr)
  DoubleToStr(oPrnSoprFun.GetKDPriceOld(спецификацияМЦ_нрек), Cena_Pr)
  DoubleToStr(oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек), Cena_Pr)
  DoubleToStr(oPrnSoprFun.GetKDAkcisOld(спецификацияМЦ_нрек), Cena_Pr)
  if (ставка_первого_налога = 0, sGetTune('Doc.SD.AbbrField.NDSStZero'), DoubleToStr(ставка_первого_налога, NDS_St))
  DoubleToStr(oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек), Cena_Pr)
  DoubleToStr(oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек), Cena_Pr)
  //Б (после изменения)
  CodeEd
  УчЕд
  DoubleToStr(oPrnSoprFun.GetKDKolNew(спецификацияМЦ_нрек), Kol_Pr)
  DoubleToStr(oPrnSoprFun.GetKDPriceNew(спецификацияМЦ_нрек), Cena_Pr)
  DoubleToStr(oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек), Cena_Pr)
  DoubleToStr(oPrnSoprFun.GetKDAkcisNew(спецификацияМЦ_нрек), Cena_Pr)
  if (ставка_первого_налога = 0, sGetTune('Doc.SD.AbbrField.NDSStZero'), DoubleToStr(ставка_первого_налога, NDS_St))
  DoubleToStr(oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек), Cena_Pr)
  DoubleToStr(oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек), Cena_Pr)
  //В (увеличение)
  DoubleToStr(if ((oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)
                 + oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)) < 0,
                   Abs(oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)
                 + oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)), 0), Cena_Pr)
  DoubleToStr(if ((oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)) < 0,
                   Abs(oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)), 0), Cena_Pr)
  DoubleToStr(if ((oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)) < 0,
                   Abs (oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)), 0), Cena_Pr)
  //Г (уменьшение)
  DoubleToStr(if ((oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)
                 + oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)) > 0,
                   oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)
                 + oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек), 0), Cena_Pr)
  DoubleToStr(if ((oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)) > 0,
                   oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек), 0), Cena_Pr)
  DoubleToStr(if ((oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)) > 0,
                   oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек), 0), Cena_Pr)

  DoubleToStr(Sum2ItogFull, Cena_Pr)
  DoubleToStr(Sum4ItogFull, Cena_Pr)
  DoubleToStr(Sum6ItogFull, Cena_Pr)

  DoubleToStr(Sum1ItogFull, Cena_Pr)
  DoubleToStr(Sum3ItogFull, Cena_Pr)
  DoubleToStr(Sum5ItogFull, Cena_Pr)

  //количество листов
  if (Nom - 36 > 0 , DoubleToStr(Trunc((Nom - 36)/56) + 2, '666'),'1')

  oPrnSoprFun.GetGlBuhName(накладная_нрек, Главный_бухгалтер) //Значение настройки "..Собственная организация\Главный бухгалтер" или "Старший бухгалтер"
 // if (НомерДовер <>'' or LongInt(ДатаДовер) <> LongInt(0), 'По доверенности № ' + НомерДовер + DateToStr(ДатаДовер, 'от DD mon YYYYг.'), '')

  if (Номер_Договора  <> '', 'Договор № '      + Номер_Договора  + DateToStr(Дата_Договора , ' от DD/MM/YYYYг.'),
  if (НарядЗаказНомер <> '', 'Заказ-наряд № '  + НарядЗаказНомер + DateToStr(НарядЗаказДата, ' от DD/MM/YYYYг.'),
  if (Основание       <> '', 'Счет № '         + Основание       + DateToStr(ДатаОснования , ' от DD/MM/YYYYг.'),
  if (НомерДовер      <> '', 'Доверенность № ' + НомерДовер      + DateToStr(ДатаДовер     , ' от DD mon YYYYг.'), ''))))

  отпуск_разрешил_должность
  отпуск_разрешил

  ДовЛицоДолжность
  ДовЛицо

  Спецсимвол
.endfields
