!Поля для корректировочного универсального передаточного документа (universal_kor.rtf)
.fields
  Ean13ToEanGnivcTTF(GenerateBarCodeEx(coKatSopr, накладная_нрек))
  if (СчФакт_НРек <> 0, СчФакт_Номер, if (wGetTune('Doc.SD.Prn.UPD.NumDocWithoutSF') = 0, Номер, 'б/н'))
  if (Дата=Date(0,0,0),'',DateToStr(Дата,'DD/MM/YYYY'))
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactIsp(СчФакт_НРек, 0), '-')
  if (СчФакт_НРек <> 0 and oPrnSoprFun.GetSchFactIsp(СчФакт_НРек, 0) <> '-', oPrnSoprFun.GetSchFactIsp(СчФакт_НРек, 1), '-')

  oPrnSoprFun.GetSchFact (накладная_нрек)
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactIspCorr(накладная_нрек, 0), '-')
  if (СчФакт_НРек <> 0 and oPrnSoprFun.GetSchFactIspCorr(накладная_нрек, 0) <> '-', oPrnSoprFun.GetSchFactIspCorr(накладная_нрек, 1), '-')

  if (СчФакт_НРек <> 0, '1', '2')
  //продавец
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetOrgFullName(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 0), 8, 0, Дата), (oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 1) + oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 2)))
  LTrim(LTrim(if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactOrgAddr(СчФакт_НРек, 0), #AdrFieldsUrUPD(Поставщик,Поставщик_СТАРАНА_КОД)), ','), ' ')
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactOrgUNN(СчФакт_НРек, 0), (ПоставщикУНН + ' / ' + ПоставщикКПП))

  //покупатель
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetOrgFullName(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 1), 8, 0, Дата), (oPrnSoprFun.GetOrgFullName(накладная_нрек, 3, 1) + oPrnSoprFun.GetOrgFullName(накладная_нрек, 3, 2)))
  LTrim(LTrim(if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactOrgAddr(СчФакт_НРек, 1), #AdrFieldsUrUPD(Получатель,Получатель_СТАРАНА_КОД)), ','), ' ')
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetSchFactOrgUNN (СчФакт_НРек, 1), (ПолучательУНН + ' / ' + ПолучательКПП))

  //Валюта: наименование, код
  //ERP-227 if (oPrnSoprFun.GetValName(Валюта_нрек) = '', sGetTune('NDE.NAMERUBL'), oPrnSoprFun.GetValName(Валюта_нрек))
  if (oPrnSoprFun.GetValName(Валюта_нрек) = '', Trim(sGetTune('Nalog.Rus.NDE_FullName')), oPrnSoprFun.GetValNameUPD(Валюта_нрек))
  if (oPrnSoprFun.GetValCode(Валюта_нрек) = '', sGetTune('NDE.RUBLISO') , oPrnSoprFun.GetValCode(Валюта_нрек))
  oPrnSoprFun.GetFullIGKEx(накладная_нрек, СчФакт_НРек)

  Nom
  КодМЦ
  Название
  //А (до изменения)
  if (ТНВЭД ='', '-', ТНВЭД)
  if (CodeEd ='', '-', CodeEd)
  ОтпЕд
  DoubleToStr(if(oPrnSoprFun.IsKorr(накладная_нрек), oPrnSoprFun.GetKDKolOld(спецификацияМЦ_нрек), oPrnSoprFun.GetKNKol(спецификацияМЦ_нрек, 0)), Kol_Pr)
  DoubleToStr(if(oPrnSoprFun.IsKorr(накладная_нрек), oPrnSoprFun.GetKDPriceOld(спецификацияМЦ_нрек), oPrnSoprFun.GetKNPrice(спецификацияМЦ_нрек, 0)), Cena_Pr)
  DoubleToStr(if(oPrnSoprFun.IsKorr(накладная_нрек), (oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек)),
                                                     (oPrnSoprFun.GetKNSumma(спецификацияМЦ_нрек, 0) - oPrnSoprFun.GetKNNalog(спецификацияМЦ_нрек, 0))), Cena_Pr)
  DoubleToStr(if(oPrnSoprFun.IsKorr(накладная_нрек), oPrnSoprFun.GetKDAkcisOld(спецификацияМЦ_нрек), oPrnSoprFun.GetKNAkcis(спецификацияМЦ_нрек, 0)), Cena_Pr)
  if (ПризнакНДС = word(0), sGetTune('Doc.SD.AbbrField.NoNDSStZero'), if (ставка_первого_налога = 0, sGetTune('Doc.SD.AbbrField.NDSStZero'), DoubleToStr(ставка_первого_налога, NDS_St)))
  if (ПризнакНДС = word(0), sGetTune('Doc.SD.AbbrField.NoNDSSummZero'),
                            if (if(oPrnSoprFun.IsKorr(накладная_нрек), oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек), oPrnSoprFun.GetKNNalog(спецификацияМЦ_нрек, 0)) = 0, sGetTune('Doc.SD.AbbrField.NDSSummZero'),
                            DoubleToStr(if(oPrnSoprFun.IsKorr(накладная_нрек), oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек), oPrnSoprFun.GetKNNalog(спецификацияМЦ_нрек, 0)), Cena_Pr)))
  DoubleToStr(if(oPrnSoprFun.IsKorr(накладная_нрек), oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек), oPrnSoprFun.GetKNSumma(спецификацияМЦ_нрек, 0)), Cena_Pr)
  //Б (после изменения)
  if (ТНВЭД ='', '-', ТНВЭД)
  if (CodeEd ='', '-', CodeEd)
  ОтпЕд
  DoubleToStr(if(oPrnSoprFun.IsKorr(накладная_нрек), oPrnSoprFun.GetKDKolNew(спецификацияМЦ_нрек), oPrnSoprFun.GetKNKol(спецификацияМЦ_нрек, 1)), Kol_Pr)
  DoubleToStr(oPrnSoprFun.GetKDPriceNew(спецификацияМЦ_нрек), Cena_Pr)
  DoubleToStr(oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек), Cena_Pr)
  DoubleToStr(oPrnSoprFun.GetKDAkcisNew(спецификацияМЦ_нрек), Cena_Pr)
  if (ПризнакНДС = word(0), sGetTune('Doc.SD.AbbrField.NoNDSStZero'), if (ставка_первого_налога = 0, sGetTune('Doc.SD.AbbrField.NDSStZero'), DoubleToStr(ставка_первого_налога, NDS_St)))
  if (ПризнакНДС = word(0), sGetTune('Doc.SD.AbbrField.NoNDSSummZero'), if (oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек) = 0, sGetTune('Doc.SD.AbbrField.NDSSummZero'), DoubleToStr(oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек), Cena_Pr)))
  DoubleToStr(oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек), Cena_Pr)

  //В (увеличение)
  DoubleToStr(if ((oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)
                 + oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)) < 0,
                   Abs(oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)
                 + oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)), 0), Cena_Pr)
  DoubleToStr(if ((oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)) < 0,
                   Abs(oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)), 0), Cena_Pr)
  DoubleToStr(if ((oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)) < 0,
                   Abs (oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)), 0), Cena_Pr)

  //Г (уменьшение)
  DoubleToStr(if ((oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)
                 + oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)) > 0,
                   oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек)
                 - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)
                 + oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек), 0), Cena_Pr)
  DoubleToStr(if ((oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек)) > 0,
                   oPrnSoprFun.GetKDNalogOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDNalogNew(спецификацияМЦ_нрек), 0), Cena_Pr)
  DoubleToStr(if ((oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек)) > 0,
                   oPrnSoprFun.GetKDSummaOld(спецификацияМЦ_нрек) - oPrnSoprFun.GetKDSummaNew(спецификацияМЦ_нрек), 0), Cena_Pr)
  //Итого сумма - увеличение
  DoubleToStr(Sum2ItogFull, Cena_Pr)
  DoubleToStr(Sum4ItogFull, Cena_Pr)
  DoubleToStr(Sum6ItogFull, Cena_Pr)

  //Итого сумма - уменьшение
  DoubleToStr(Sum1ItogFull, Cena_Pr)
  DoubleToStr(Sum3ItogFull, Cena_Pr)
  DoubleToStr(Sum5ItogFull, Cena_Pr)

  //количество листов
  if (Nom - 36 > 0 , DoubleToStr(Trunc((Nom - 36)/56) + 2, '666'),'1')

  //ERP-984 - меняем в Check_IP 1 на 8
  if (oPrnSoprFun.Check_IP(накладная_нрек, 8), '',if(sFIO1 <> '', sFIO1, Директор))
  oPrnSoprFun.GetGlBuhName(накладная_нрек, if(sFIO2 <> '', sFIO2, Главный_бухгалтер))
  if (oPrnSoprFun.Check_IP(накладная_нрек, 8), if(sFIO1 <> '', sFIO1, Директор),'')         //Руководитель для ИП
  if (oPrnSoprFun.Check_IP(накладная_нрек, 8), oPrnSoprFun.Write_IP(накладная_нрек, 8),'')  //Атрибут "Реквизиты ИП"

  oPrnSoprFun.GetOsnovPerUPD(накладная_нрек)
//------ Предлагающий изменить стоимость
  sPost5
  sFIO5
//------ С изменением стоимости согласен
  sPost7
  sFIO7
//------ Уведомляющий об изменении стоимости
  sPost6
  sFIO6
//------ Ответственный за правильность оформления факта хозяйственной жизни
  sPost3
  sFIO3

//------ Ответственный за правильность оформления факта хозяйственной жизни (контрагент)
  //if (НомерДовер  <> '', '', ДовЛицоДолжность)
  //if (НомерДовер  <> '', '', ДовЛицо)
  if (НомерДовер  = '' or ДовЛицо='', sPost4, ДовЛицоДолжность)
  if (НомерДовер  = '' or ДовЛицо='', sFio4, ДовЛицо)
//------------------------------------

  if (СчФакт_НРек <> 0, oPrnSoprFun.GetOrgFullName(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 0), 8, 0, Дата), (oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 1) + oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 2)))
  if (СчФакт_НРек <> 0, ', ИНН/КПП: ' + oPrnSoprFun.GetSchFactOrgUNN(СчФакт_НРек, 0), (', ИНН/КПП: ' + ПоставщикУНН + ' / ' + ПоставщикКПП))
  if (СчФакт_НРек <> 0, oPrnSoprFun.GetOrgFullName(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 1), 8, 0, Дата), (oPrnSoprFun.GetOrgFullName(накладная_нрек, 3, 1) + oPrnSoprFun.GetOrgFullName(накладная_нрек, 3, 2)))
  if (СчФакт_НРек <> 0, ', ИНН/КПП: ' + oPrnSoprFun.GetSchFactOrgUNN(СчФакт_НРек, 3), (', ИНН/КПП: ' + ПолучательУНН + ' / ' + ГрузополучательКПП))

  Спецсимвол
.endfields
