/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Оперативный Контур                                        ║
 ║ Версия        : 5.00                                                      ║
 ║ Назначение    : Ведомость наличия товаров по предприятию по группам       ║
 ║ Ответственный : Бартош Евгений Анатольевич                                ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#doc
Ведомость наличия товаров по предприятию по группам
#end
.set name='nal_all_gr'
.hide
.var
  TNPv, TGPv, TEPv:string;
  TNP1v, TGP1v, TEP1v:string;
  VNTarv:string;
  VNBasev:string;
  VNPrv:string;
.endvar
.fields
  dDate : date // Дата
  NameOrg
  VidUcheta
  FilterInfo
  TNP TGP TEP  // заголовок
  TNP1 TGP1 TEP1  // заголовок1
  VNTar   // Наименование вал. для отчетов
  VNBase  // Наименование базовой валюты
  VNPr    // наименование валюты прайс-листа

  GroupName    // Наименование группы МЦ
  GroupCode    // Код группы МЦ

  nRecMC:comp  // nRec МЦ
  NameMC       // Наименование товара
  CodeMC       // Бар-код товара
  NameEd       // Учетная ед. измерения
  nRecPodr : comp // nrec подразделения
  Podr         // Наименование подразделения
  nRecMOL  : comp // nrec МОЛ
  Mol          // Наименование МОЛ
  nRecParty : comp
  Party        // Наименование партии
  nRecDogovor NDogovor NDogovor_Ext
  DDogovor DInput
  Kol          // Количество
  Price1:double       // Цена
  Price2:double       // Цена в валюте
  ValMC        // Валюта учкта товара
  Summa1:double       // Сумма
  Summa2:double       // Сумма в валюте
  PriceLS:double       // Цена по прайс-листу
  PriceLSV:double      // Цена по прайс-листу в валюте
  SummaLS:double       // Сумма по прайс-листу
  SummaLSV:double      // Сумма по прайс-листу в валюте
  Reserve:double       // Резерв товара
  Massa:double         // Масса товара
  Volume:double        // Объем товара
  SizeX:double         // Габариты по ширине
  SizeY:double         // Габариты по длине
  SizeZ:double         // Габариты по высоте

  GroupItogo1:double   // Итого по группе в учетных ценах в вал. отчетов
  GroupItogo2:double   // Итого по группе в учетных ценах в баз. вал.
  ValGroup      // Валюта учета группы
  GroupItogoPr:double  // Итого по группе в продажных ценах в вал. отчетов
  GroupItogoPrV:double // Итого по группе в продажных ценах в баз. вал.

  skipped       // служебное

  Itogo1:double        // Итого по учетным ценам в валюте отчетов
  Itogo2:double        // Итого по учетным ценам в баз.вал.
  ValItogo      // Валюта учета итогов
  ItogoPr:double       // Итого по продажным ценам в валюте отчетов
  ItogoPrV:double      // Итого по продажным ценам в баз.вал.
.endfields
Дата      : ^
Организация: ^
Вид учета : ^
Фильтры
.{
  ^
.}
Заголовок ^ ^ ^
Заголовок1 ^ ^ ^
Наименование вал. для отчетов  : ^
Наименование базовой валюты    : ^
наименование валюты прайс-листа: ^
.{
.begin
  TNPv    := TNP;
  TGPv    := TGP;
  TEPv    := TEP;
  TNP1v   := TNP1;
  TGP1v   := TGP1;
  TEP1v   := TEP1;
  VNTarV  := VNTar;
  VNBaseV := VNBase;
  VNPrV   := VNPr;
 end.

.{
Наименование группы МЦ : ^
Код группы МЦ          : ^
.{ CheckEnter
nRec товара                   : ^
Наименование товара           : ^
Бар-код товара                : ^
Учетная ед. измерения         : ^
nRec подразделения            : ^
Наименование подразделения    : ^
nRec МОЛ                      : ^
Наименование МОЛ              : ^
nRec партии                   : ^
Наименование партии           : ^
Договор                       : ^ ^ ^ ^ ^
Количество                    : ^
Цена                          : ^
Цена в валюте                 : ^
Валюта учета МЦ               : ^
Сумма                         : ^
Сумма в валюте                : ^
 Цена по прайс-листу          : ^
 Цена по прайс-листу в валюте : ^
 Сумма по прайс-листу         : ^
 Сумма по прайс-листу в валюте: ^
 Резерв товара                : ^
 Масса товара                 : ^
 Объем товара                 : ^
 Габариты по ширине           : ^
 Габариты по длине            : ^
 Габариты по высоте           : ^
.}
Итого по группе в учетных ценах в вал. отчетов  : ^
Итого по группе в учетных ценах в баз. вал.     : ^
Валюта учета для группы                         : ^
Итого по группе в продажных ценах в вал. отчетов: ^
Итого по группе в продажных ценах в баз. вал.   : ^
.}
служебное : ^
.}
Итого по учетным ценам в валюте отчетов  : ^
Итого по учетным ценам в баз.вал.        : ^
Валюта учета                             : ^
Итого по продажным ценам в валюте отчетов: ^
Итого по продажным ценам в баз.вал.      : ^
.endform

#doc
ВЕДОМОСТЬ НАЛИЧИЯ ПО ГРУППАМ ( ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ )
#end
.linkform 'nal_all_gr_nde_val' prototype is 'nal_all_gr'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ ПО ГРУППАМ ( ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ )'
.p 60
.group '011'
.fields
  CommonFormHeader
  DateToStr(dDate,'DD mon YYYY')
  VidUcheta
  FilterInfo

  TNPv TGPv TEPv TNP1v TGP1v TEP1v
  VNTarv VNBasev
  VNTarv VNBasev

  GroupName GroupCode

  NameMC CodeMC NameEd
  Kol Price1 Price2 ValMC Summa1 Summa2 ValMC

  GroupName GroupCode
  GroupItogo1 GroupItogo2 ValGroup

  Itogo1 Itogo2 //ValItogo
.endfields
^
 Й                       В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                          по предприятию на ^г. Й
 Ш
^
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬───────────┬────────────┬────────────────────────────────┬────────────────────────────────────
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   │@@@@@@@@@@@@@@@│@@@@@@@@@@@│ Количество │        Учетная цена            │   Стоимость в учетных ценах
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   │@@@@@@@@@@@@@@@│@@@@@@@@@@@│            ├──────────────┬─────────────────┼────────────────┬───────────────────
                                      │               │           │            │в @@@@@@@@@@@@│ в @@@@@@@@@@@@  │в @@@@@@@@@@@@@@│ в @@@@@@@@@@@@@@
──────────────────────────────────────┴───────────────┴───────────┴────────────┴──────────────┴─────────────────┴────────────────┴───────────────────
.]h
.{
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@
.{ CheckEnter
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&& @@@ &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&& @@@
.}
 Б               ИТОГО ПО ГРУППЕ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@         &'&&&&&&&&&&&&&&&&&&&&  &'&&&&&&&&&&&&&&&&&& @@@ Б
.}
.}

 Б               ИТОГО ПО ПРЕДПРИЯТИЮ                                                                 &'&&&&&&&&&&&&&&&&&&&&  &'&&&&&&&&&&&&&&&&&& Щ

.endform

#doc
ВЕДОМОСТЬ НАЛИЧИЯ ПО ГРУППАМ ( ЦЕНЫ В НАЦ. ВАЛЮТЕ )
#end
.linkform 'nal_all_gr_nde' prototype is 'nal_all_gr'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ ПО ГРУППАМ ( ЦЕНЫ В НАЦ. ВАЛЮТЕ )'
.p 60
.group '010'
.fields
  CommonFormHeader
 А  DateToStr(dDate,'DD mon YYYY') А
  VidUcheta
  FilterInfo

  TNPv TGPv TEPv TNP1v TGP1v TEP1v

  GroupName GroupCode

  NameMC CodeMC NameEd
  Kol Price1 Summa1

  GroupName GroupItogo1

  Itogo1
.endfields
^
 Й                     В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                        по предприятию на ^г. Й
 Р
^
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬───────────┬────────────┬──────────────┬────────────────
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   │@@@@@@@@@@@@@@@│@@@@@@@@@@@│ Количество │ Учетная цена │   Стоимость
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   │@@@@@@@@@@@@@@@│@@@@@@@@@@@│            │              │в учетных ценах
──────────────────────────────────────┴───────────────┴───────────┴────────────┴──────────────┴────────────────
.]h
.{
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@
.{ CheckEnter
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&&&&&
.}
 Б                ИТОГО ПО ГРУППЕ  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     &'&&&&&&&&&&&&&&&&&&&& Б
.}
.}

 Б                ИТОГО ПО ПРЕДПРИЯТИЮ                                                     &'&&&&&&&&&&&&&&&&&&&& С

.endform


#doc
ИТОГИ ПО ГРУППАМ ТОВАРОВ ( ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ )
#end
.linkform 'nal_all_gr_gr_nde_val' prototype is 'nal_all_gr'
.nameinlist 'ИТОГИ ПО ГРУППАМ ТОВАРОВ ( ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ )'
.p 60
.group '111'
.fields
  CommonFormHeader
  DateToStr(dDate,'DD mon YYYY')
  VidUcheta
  FilterInfo

  VNTarv VNBasev

  GroupName GroupCode GroupItogo1 GroupItogo2 ValGroup

  Itogo1 Itogo2 //ValItogo
.endfields
^
 Й                         В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                            по предприятию на ^г. Й
 И
^
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬──────────────────────────────────────────
   Наименование группы товаров        │  Код группы   │      Стоимость в учетных ценах
                                      │   товаров     ├───────────────────┬──────────────────────
                                      │               │в @@@@@@@@@@@@@@@@@│ в @@@@@@@@@@@@@@@@@
──────────────────────────────────────┴───────────────┴───────────────────┴──────────────────────
.]h
.{
.{ CheckEnter
.}
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& @@@
.}
.}

 Б                ИТОГО ПО ПРЕДПРИЯТИЮ                &'&&&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Й

.endform

#doc
ИТОГИ ПО ГРУППАМ ТОВАРОВ ( ЦЕНЫ В НАЦ. ВАЛЮТЕ )
#end
.linkform 'nal_all_gr_gr_nde' prototype is 'nal_all_gr'
.nameinlist 'ИТОГИ ПО ГРУППАМ ТОВАРОВ ( ЦЕНЫ В НАЦ. ВАЛЮТЕ )'
.p 60
.group '110'
.fields
  CommonFormHeader
 А  DateToStr(dDate,'DD mon YYYY') А
  VidUcheta
  FilterInfo

  GroupName GroupCode GroupItogo1

  skipped

  Itogo1
.endfields
^
 Й                       В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                           по предприятию на ^г. Й
 И
^
Фильтры
.{
  ^
.}
.{
.[h OverWrite

───────────────────────────────────────────┬───────────────┬────────────────────
   Наименование группы товаров             │   Код группы  │     Стоимость
                                           │    товаров    │  в учетных ценах
───────────────────────────────────────────┴───────────────┴────────────────────
.]h
.{
.{ CheckEnter
.}
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&&
.}
 ^
.}

 Б                ИТОГО ПО ПРЕДПРИЯТИЮ                    &'&&&&&&&&&&&&&&&&&&&&&& Б
 И

.endform

#doc
ВЕДОМОСТЬ НАЛИЧИЯ ПО ГРУППАМ ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ
#end
.linkform 'nal_all_gr_spec_nde_val' prototype is 'nal_all_gr'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ ПО ГРУППАМ ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ'
.p 60
.group '001'
.fields
  CommonFormHeader
 А  DateToStr(dDate,'DD mon YYYY') А
  VidUcheta
  FilterInfo

  VNTarv  VNBasev
  VNTarv  VNBasev

  GroupName GroupCode

  NameMC CodeMC NameEd Podr Mol Party
  Kol Price1 Price2 ValMC Summa1 Summa2 ValMC

  GroupName GroupCode GroupItogo1 GroupItogo2 ValGroup

  Itogo1 Itogo2 //ValItogo
.endfields
^
 Й                       В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                          по разрезам на ^г. Й
 Ш
^
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬─────────┬───────────────┬───────────────┬───────────────┬────────────┬────────────────────────────────┬────────────────────────────────────
        Наименование товара           │Номенклатурный │ Единица │ Подразделение │      МОЛ      │    Партия     │ Количество │        Учетная цена            │   Стоимость в учетных ценах
                                      │    номер      │измерения│               │               │               │            ├──────────────┬─────────────────┼────────────────┬───────────────────
                                      │               │         │               │               │               │            │в @@@@@@@@@@@@│ в @@@@@@@@@@@@  │в @@@@@@@@@@@@@@│ в @@@@@@@@@@@@@@
──────────────────────────────────────┴───────────────┴─────────┴───────────────┴───────────────┴───────────────┴────────────┴──────────────┴─────────────────┴────────────────┴───────────────────
.]h
.{
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ Б
.{ CheckEnter
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&& @@@ &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&& @@@
.}
 Б               ИТОГО ПО ГРУППЕ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@                                                        &'&&&&&&&&&&&&&&&&&&&&  &'&&&&&&&&&&&&&&&&&& @@@ Б
.}
.}

 Б               ИТОГО ПО ПРЕДПРИЯТИЮ                                                                                                                &'&&&&&&&&&&&&&&&&&&&&  &'&&&&&&&&&&&&&&&&&& Щ


.endform

#doc
ВЕДОМОСТЬ НАЛИЧИЯ ПО ГРУППАМ ЦЕНЫ В НАЦ. ВАЛЮТЕ
#end
.linkform 'nal_all_gr_spec_nde' prototype is 'nal_all_gr'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ ПО ГРУППАМ ЦЕНЫ В НАЦ. ВАЛЮТЕ'
.p 60
.group '000'
.fields
  CommonFormHeader
  DateToStr(dDate,'DD mon YYYY')
  VidUcheta
  FilterInfo

  GroupName GroupCode

  NameMC CodeMC NameEd Podr Mol Party
  Kol Price1 Summa1

  GroupName GroupItogo1

  Itogo1
.endfields
^
 Й                     В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                        по разрезам на ^г. Й
 Ш
^
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬──────────────┬─────────┬───────────────┬───────────────┬──────────────┬────────────┬──────────────┬────────────────
        Наименование товара           │Номенклатурный│ Единица │ Подразделение │      МОЛ      │    Партия    │ Количество │ Учетная цена │   Стоимость
                                      │    номер     │измерения│               │               │              │            │              │в учетных ценах
──────────────────────────────────────┴──────────────┴─────────┴───────────────┴───────────────┴──────────────┴────────────┴──────────────┴────────────────
.]h
.{
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ Б
.{ CheckEnter
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&&&&&
.}
 Б                ИТОГО ПО ГРУППЕ  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           &'&&&&&&&&&&&&&&&&&&&& Б
.}
.}

 Б                ИТОГО ПО ПРЕДПРИЯТИЮ                                                                                                  &'&&&&&&&&&&&&&&&&&&&& Щ
.endform
