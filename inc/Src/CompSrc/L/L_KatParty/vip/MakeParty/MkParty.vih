!╔═══════════════════════════════════════════════════════════════════════════╗
!║ Назначение    : Формирование партий (накладные на приход,вн.перемещение)  ║
!╚═══════════════════════════════════════════════════════════════════════════╝

#ifndef _MKPARTY_VIH
#define _MKPARTY_VIH

#ifdef ComponentVersion
#component "L_KATPARTY"
#end

// структура для формирования новой партии
#include MkParty.inc

//******************************************************************************
#doc
  Формирование партий (накладные на приход, вн.перемещение)
#end
//******************************************************************************

ObjInterface objMakeParty;

//******************************************************************************
#doc
Назначение:
  проверяет на корректность партии одну позицию накладной
Параметры:
  aPart        - ссылка на партию (возвращаемый)
  aSpSopr      - ссылка на позицию накладной
  ProtParty    - 1 - формирование протокола
  AutoSetParty - 1 - формирование партии
#end
Function OnCheckPosParty(var aPart: comp; aSpSopr: comp; ProtParty, AutoSetParty: word): boolean;


//******************************************************************************
#doc
Назначение:
  формирование(проверка) партий по накладной
Параметры:
  aKatSopr     - ссылка на накладною
  ProtParty    - 1 - формирование протокола
  AutoSetParty - 1 - формирование партии
#end
Function CheckPartys(aKatSopr: comp; ProtParty, AutoSetParty: word): boolean;


//******************************************************************************
#doc
Назначение:
  формирование новой партии по позиции накладной
Параметры:
  aSpSopr      - ссылка на позицию накладной
  ProtParty    - 1 - формирование протокола
  AutoSetParty - 1 - формирование партии
#end
Function MakeNewParty (aSpSopr: comp; ProtParty, AutoSetParty: word) : comp;


//******************************************************************************
#doc
Назначение: !!! Используйте MakeNewParty_3
  формирование новой партии по позиции накладной (по NewPartyRec)
Параметры:
  NewPartyRec  - запись партии
  ProtParty    - 1 - формирование протокола
  AutoSetParty - 1 - формирование партии
#end
Function MakeNewParty_2 (NewPartyRec: tNewPartyRec; ProtParty, AutoSetParty: word) : comp;


//******************************************************************************
#doc
Назначение:
  показать протокол формирование партий
Параметры:
  нет
#end
Procedure ShowProtParty;


//******************************************************************************
#doc
Назначение:
  формирование новой партии по позиции ДО
Параметры:
  aSpStep      - ссылка на позицию ДО
  ProtParty    - 1 - формирование протокола
  AutoSetParty - 1 - формирование партии
#end
Function MakeNewParty_DO (aSpStep: comp; ProtParty, AutoSetParty: word) : comp;


//******************************************************************************
#doc
Назначение:
  проверяет на корректность партии одну позицию ДО
Параметры:
  aPart        - ссылка на партию (возвращаемый)
  aSpStep      - ссылка на позицию ДО
  ProtParty    - 1 - формирование протокола
  AutoSetParty - 1 - формирование партии
#end
Function OnCheckPosParty_DO(var aPart: comp; aSpStep: comp; ProtParty, AutoSetParty: word): boolean;


//******************************************************************************
#doc
Назначение:
  формирование(проверка) партий по ДО
Параметры:
  aStepDoc     - ссылка на StepDoc ДО
  ProtParty    - 1 - формирование протокола
  AutoSetParty - 1 - формирование партии
#end
Function CheckPartys_DO (aStepDoc: comp; ProtParty, AutoSetParty: word): boolean;


//******************************************************************************
#doc
Назначение:
  установка даты ордера для партии с форматом &DO
Параметры:
  aKatSopr - Накладная
  aDOpr    - Дата создания ордера
#end
Procedure SetDateOrd (aKatSopr: comp; aDOpr: Date);

end;

ObjInterface objMakeParty_Ex;

//******************************************************************************
#doc
Назначение:
  формирование новой партии (значения задаются функциями Set_... )
Параметры:
  ProtParty    - 1 - формирование протокола
  AutoSetParty - 1 - формирование партии
#end
Function MakeNewParty_3 (ProtParty, AutoSetParty: word) : comp;


//******************************************************************************
#doc
Назначение:
  Очистка буфера значений
#end
Procedure ClearRec;


//******************************************************************************
#doc
Назначение:
  Заполнение значений
#end
Procedure Set_KatSopr_VidSopr (Value : word  );
Procedure Set_Tip_kons        (Value : word  );
Procedure Set_KatSopr_DSopr   (Value : date  );
Procedure Set_SklOrder_DOrd   (Value : date  );
Procedure Set_KatSopr_DPrice  (Value : date  );
Procedure Set_Dogovor_dDoc    (Value : date  );
Procedure Set_Dogovor_NoDoc   (Value : string);
Procedure Set_KatSopr_NSopr   (Value : string);
Procedure Set_KatSopr_Name    (Value : string);
Procedure Set_KatOrg_Name     (Value : string);
Procedure Set_KatOrg_UNN      (Value : string);
Procedure Set_KatOrg_Code     (Value : string);
Procedure Set_SpSopr_nSertif  (Value : string);
Procedure Set_Sopr_Valuta     (Value : string);
Procedure Set_OrdB_Valuta     (Value : string);
Procedure Set_FactoryPrice    (Value : string);
Procedure Set_FactoryProcNac  (Value : string);
Procedure Set_KatMC_Name      (Value : string);
Procedure Set_KatMC_BarKod    (Value : string);
Procedure Set_KatSopr_NVagon  (Value : string);
Procedure Set_KatSopr_cOrgBase(Value : comp  );
Procedure Set_KatSopr_cVal    (Value : comp  );
Procedure Set_Sopr_cUKS       (Value : comp  );
Procedure Set_KatMC_NRec      (Value : comp  );
Procedure Set_Sopr_Cena       (Value : double);
Procedure Set_OrdB_Cena       (Value : double);
Procedure Set__OtpEdKoef      (Value : double);

end;

VipInterface iMakeParty implements objMakeParty, objMakeParty_Ex Licensed(FREE);

#end
