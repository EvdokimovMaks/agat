//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика ERP 7.12 - базовая функциональность
// Объявление объектного интерфейса для выборки информации об организации
//------------------------------------------------------------------------------

#ifndef _TOTALORGANIZATIONATTRIBUTES_OBJ_INCLUDED_
#define _TOTALORGANIZATIONATTRIBUTES_OBJ_INCLUDED_

#component "L_KatOrg"

// выборка информации (юридической, налоговой и т.п.) об организации
#include OrganizationInfo.vih

// Для использования интерфейса необходимо после описания логической таблицы
// подключить TotalOrganizationAttributes.var (объявление ссылки и создание
// нового экземпляра интерфейса).

#doc
Набор методов для выборки атрибутов организации
#end
objinterface ITotalOrganizationAttributes;

  #doc
  нахождения головной организации по списку подразделений
  #end
  function Calc(Departments: longint): comp;

  #doc
  привязка к организации OrganizationRef
  #end
  procedure Bind(OrganizationRef: comp);

  #doc
  ссылка на текущую организацию
  #end
  function GetOrganizationRef: comp;

  #doc
  ссылка на юридические атрибуты организации (см. методы IOrganizationJuridicalInfo)
  #end
  function GetJuridicalInfo: IOrganizationJuridicalInfo;

  #doc
  ссылка на налоговые атрибуты организации (см. методы IOrganizationTaxationInfo)
  #end
  function GetTaxationInfo: IOrganizationTaxationInfo;

  #doc
  ссылка на банковские счета организации (см. методы IOrganizationAccountsInfo)
  #end
  function GetAccountsInfo: IOrganizationAccountsInfo;

  #doc
  ссылка на список банков, в которых организация имеет расчетные счета
  #end
  function GetBanksList: IOrganizationBanksList;

  #doc
  ссылка на банк по умолчанию
  #end
  function GetDefaultBank(var Value: IBankInfo): boolean;
end;

#doc
Дополнительный метод для извлечения полного имени организации
#end
objinterface ITotalOrganizationAttributesV2(ITotalOrganizationAttributes);

  #doc
  ссылка на юридические атрибуты организации (см. методы IOrganizationJuridicalInfoV2)
  #end
  function GetJuridicalInfoV2: IOrganizationJuridicalInfoV2;
    deprecated 'вместо метода GetJuridicalInfoV2 следует испльзовать свойство JuridicalInfo объекта TOA';
end;

#doc
Дополнительный метод для извлечения полного имени организации
#end
objinterface ITotalOrganizationAttributes1;

  #doc
  Ссылка на vip-интрефейс с методом, который возвращает имя организации в зависимости от системных настроек
  #end
  function GetNaming: IOrganizationNaming;
end;

#doc
Дополнительный метод для извлечения полного имени организации
#end
objinterface ITotalOrganizationAttributes1V2(ITotalOrganizationAttributes1);

  #doc
  Ссылка на vip-интрефейс с методом, который возвращает имя организации в зависимости от системных настроек
  #end
  function GetNamingV2: IOrganizationNamingV2;
    deprecated 'вместо метода GetNamingV2 следует испльзовать свойство JuridicalInfo объекта TOA';
end;

#doc
Очередное расширение интерфейса ITotalOrganizationAttributes
#end
objinterface ITotalOrganizationAttributesV3;

  #doc
  Доступ к атрибутам юридической информации организации
  #end
  property JuridicalInfo: OrganizationJuridicalInfo read;
end;

#end
