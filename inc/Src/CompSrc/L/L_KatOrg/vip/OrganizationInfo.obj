//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика ERP 7.12 - базовая функциональность
// Объявления объектных интерфейсов для выборки информации (юридической,
// налоговой и т.п.) об организации
//------------------------------------------------------------------------------

#ifndef _ORGANIZATIONINFO_OBJ_INCLUDED_
#define _ORGANIZATIONINFO_OBJ_INCLUDED_

#component "L_KatOrg"

#doc
Набор методов для выборки информации об организации.
Загрузка информации об организации по ее номеру записи OrganizationRef.
#end
ObjInterface IOrganizationInfoFinder;

  #doc
  загрузить информации об организации по ее номеру записи OrganizationRef
  #end
  function Seek(OrganizationRef: comp): boolean;
end;

#doc
Обновляемость данных при повторных вызовах поиска по той же ссылке.
По умолчанию находится в true и данные обновляются в любом случае.
#end
objinterface IRefreshingInfoFinder;
  #doc
  опция обновления данных, применяемая при последующих вызовах метода Seek
  #end
  property Refreshable: boolean;
end;

#doc
Набор методов для выборки информации об организации.
Юридические атрибуты организации.
#end
ObjInterface IOrganizationJuridicalInfo;

  #doc
  наименование организации
  #end
  function GetName: string;

  #doc
  дата регистрации
  #end
  function GetRegistrationDate: date;

  #doc
  дата ликвидации
  #end
  function GetLiquidationDate: date;

  #doc
  код по ОКВЭД (ОКОНХ)
  #end
  function GetOkvedCode: string;

  #doc
  код по ОКПО
  #end
  function GetOkpoCode: string;

  #doc
  код по ОКАТО
  #end
  function GetOkatoCode: string;

  #doc
  код по КБК
  #end
  function GetKbkCode: string;

  #doc
  код по ОГРН
  #end
  function GetOgrnCode: string;

  #doc
  регистрационный номер в ПФ
  #end
  function GetPfRegistrationNumber: string;

  #doc
  орган исполнительной власти
  #end
  function GetExecutiveOrgan: string;

  #doc
  адрес органа исполнительной власти
  #end
  function GetExecutiveOrganAddress: comp;

  #doc
  почтовый адрес (ссылка на запись в каталоге адресов)
  #end
  function GetPostAddress: comp;

  #doc
  юридический адрес (ссылка на запись в каталоге адресов)
  #end
  function GetJuridicalAddress: comp;

  #doc
  юридический адрес
  #end
  function GetJuridicalAddressStr: string;

  #doc
  индекс для юридического адреса
  #end
  function GetJuridicalAddressIndex: string;

  #doc
  электронный адрес
  #end
  function GetEmail: string;

  #doc
  контактная информация
  #end
  function GetContactInfo: string;

  #doc
  телефоны, факсы
  #end
  function GetPhones: string;

  #doc
  форма собственности
  #end
  function GetFormSobs: string;

  #doc
  Вид деятельности
  #end
  function GetVidD: string;

  #doc
  уполномоченный представитель (ссылка на физическое лицо)
  #end
  function GetDelegate: comp;

  #doc
  руководитель (ссылка на физическое лицо)
  #end
  function GetDirector: comp;

  #doc
  главный бухгалтер (ссылка на физическое лицо)
  #end
  function GetChiefAccountant: comp;

  #doc
  внутренний номер
  #end
  function GetCode: string;

  #doc
  тип организации
  #end
  function GetType: string;

  #doc
  код по ОКДП
  #end
  function GetOkdpCode: string;

  #doc
  ссылка на запись в KatState (каталог стран)
  #end
  function GetStateRef: comp;

  #doc
  страна
  #end
  function GetStateStr: string;

  #doc
  ссылка на запись в KatCity (каталог городов)
  #end
  function GetCityRef: comp;

  #doc
  город
  #end
  function GetCityStr: string;

  #doc
  альтернативное наименование организации
  #end
  function GetAlternativeName: string;

  #doc
  признак входимости в состав корпорации
  #end
  function IsInCorporation: boolean;

  #doc
  признак архивной организации
  #end
  function IsArchive: boolean;

end;

#doc
Набор методов для выборки информации об организации.
Юридические атрибуты организации.
#end
ObjInterface IOrganizationJuridicalInfoV2(IOrganizationJuridicalInfo);

  #doc
  Идентификационный код
  #end
  function GetJuridicalId: string;

  #doc
  регистрационный номер Регистрационный номер страхователя
  #end
  function GetStraxRegistrationNumber: string;
end;

#doc
Расширение методов для выборки информации об организации.
Юридические атрибуты организации.
#end
ObjInterface IOrganizationJuridicalInfoExt;

  #doc
  Тип организации (  0 - юридическое лицо, 1 - физическое лицо, 2 - индивидуальный предприниматель)
  #end
  function GetOrgType: word;
end;

#doc
Набор методов для выборки информации об организации.
Налоговые атрибуты организации.
#end
ObjInterface IOrganizationTaxationInfo;

  #doc
  идентификационный номер налогоплательщика
  #end
  function GetTaxPayerID: string;

  #doc
  код категории налогоплательщика
  #end
  function GetTaxPayerCategoryCode: string;

  #doc
  категория налогоплательщика
  #end
  function GetTaxPayerCategory: string;

  #doc
  ссылка на запись в таблице KATKOD (Классификатор кодов постановки на учет)
  #end
  function GetKppRef: comp;

  #doc
  строковое представление кода постановки на учет
  #end
  function GetKppStr: string;

  #doc
  серия и номер свидетельства о постановке на учет
  #end
  function GetSertificate: string;

  #doc
  дата выдачи свидетельства о постановке на учет
  #end
  function GetCertificateIssueDate: date;

  #doc
  наименование налоговой инспекции
  #end
  function GetTaxationInspection: string;
end;

#doc
Набор методов для выборки информации об организации.
Атрибуты налоговой инспекции.
#end
ObjInterface ITaxationInspectionInfo;
  #doc
  nrec
  #end
  function GetInspectionRef: comp;

  #doc
  наименование
  #end
  function GetName: string;

  #doc
  код
  #end
  function GetCode: string;

  #doc
  ссылка на единицу административно-территориального деления
  #end
  function GetAtdItemRef: comp;

  #doc
  ссылка на представляющую данную инспекцию организацию
  #end
  function GetOrganizationRef: comp;

  #doc
  ссылка на вышестоящую инспекцию
  #end
  function GetParentRef: comp;
end;

#doc
Набор методов для выборки информации об организации.
Информация о ролях банков, в которых организация имеет расчетные счета.
#end
ObjInterface IOrganizationAccountsInfo;

  #doc
  расчетный счет в банке
  #end
  function GetBank: comp;

  #doc
  валютный расчетный счет в банке
  #end
  function GetMonetaryBank: comp;
end;

#doc
Набор методов для выборки информации об организации.
Атрибуты банков.
#end
ObjInterface IBankInfo;
  #doc
  ссылка на банк
  #end
  function GetBankRef: comp;

  #doc
  наименование
  #end
  function GetName: string;

  #doc
  адрес банка
  #end
  function GetAddress: string;

  #doc
  ссылка на организацию
  #end
  function GetOrganizationRef: comp;

  #doc
  наименование организации банка
  #end
  function GetOrganization: string;

  #doc
  код 1
  #end
  function GetCode1: string;

  #doc
  код 2
  #end
  function GetCode2: string;

  #doc
  номер счета 1
  #end
  function GetAccount1: string;

  #doc
  номер счета 2
  #end
  function GetAccount2: string;

  #doc
  номер счета для платежных документов
  #end
  function GetPaymentDocumentsAccount: string;

  #doc
  признак активного счета
  #end
  function IsActive: boolean;

  #doc
  признак расчетного счета
  #end
  function IsAccounting: boolean;
end;

#doc
Набор методов для выборки информации об организации.
Информация о списке банков, в которых организация имеет расчетные счета.
#end
ObjInterface IOrganizationBanksList;
  #doc
  установить (Value = true) или сбросить (Value - false) режим редактирования
  #end
  procedure SetEditMode(Value: boolean);

  #doc
  позиционироваться на заданный банк
  #end
  function  SeekBank(BankRef: comp): boolean;

  #doc
  обновление текущего банка
  #end
  procedure UpDateKatBank;
end;

ObjInterface IOrganizationNaming;
  #doc
  получить имя организации с типом или нет (в зависимости от системной настроки)
  #end
  function GetFullName: string;
end;

ObjInterface IOrganizationNamingV2(IOrganizationNaming);
  #doc
  получение атрибута организации на дату
  #end
  property dHistory: date;
  #doc
  получить имя организации с типом или нет (в зависимости от системной настроки)
  #end
  function GetFullNameEx(sField: string = ''): string;
end;

#doc
Набор методов для работы с историей наименований
#end
ObjInterface IHistoryName;
  #doc
  вернуть название организации, действовавшее на указанную дату
  #end
  Function GetOldOrgName(cRec: comp; dDate:date): string;

  #doc
  вернуть название города, действовавшее на указанную дату
  #end
  Function  GetOldCityName(cRec: comp; dDate:date): string;

  #doc
  вернуть название территории, действовавшее на указанную дату
  #end
  Function  GetOldTerrName(cRec: comp; dDate:date): string;

end;

ObjInterface IOrganizationNames;
  #doc
  уполномоченный представитель (ФИО)
  #end
  function GetDelegateName: string;

  #doc
  руководитель (ФИО)
  #end
  function GetDirectorName: string;

  #doc
  главный бухгалтер (ФИО)
  #end
  function GetChiefAccountantName: string;
end;

ObjInterface ISetOrganizationNames;
  #doc
  уполномоченный представитель (ФИО)
  #end
  Procedure SetDelegateName(pPerson : comp; sName : string);

  #doc
  руководитель (ФИО)
  #end
  Procedure SetDirectorName(pPerson : comp; sName : string);

  #doc
  главный бухгалтер (ФИО)
  #end
  Procedure SetChiefAccountantName(pPerson : comp; sName : string);
end;

ObjInterface IOrganizationSelectField;
  #doc
  Спозиционировать курсор на поле
  #end
  Procedure SelectFieldInPanel(sPef, sField : string);
end;

#doc
  Муниципальный код территории (ОКТМО)
#end
ObjInterface IOrganizationJuridicalInfoOktmo;

  #doc
  Муниципальный код территории (ОКТМО), обслуживаемой налоговой инспекцией
  #end
  function GetOktmoCode: string;

end;

ObjInterface IOrganizationIndividualInfo;
  #doc
  Получить Фамилию
  #end
  Function GetInd_Surname : string;

  #doc
  Получить Имя
  #end
  Function GetInd_Name : string;

  #doc
  Получить Отчество
  #end
  Function GetInd_Patronymic : string;

  #doc
  Получить дату рождения
  #end
  Function GetInd_DateOfBirth : date;

  #doc
  Получить место рождения
  #end
  Function GetInd_PlaceOfBirth : string;

  #doc
  Получить вид национальности (1 - 'гражданин', 2 - 'лицо без гражданства')
  #end
  Function GetInd_NationalityType : word;

  #doc
  Получить название страны гражданства
  #end
  Function GetInd_NationalityName : string;

  #doc
  Получить код страны гражданства
  #end
  Function GetInd_NationalityCode :  string;

  #doc
  Получить вид документа удостоверяющего личность
  #end
  Function GetInd_DocVid :  string;

  #doc
  Получить код вида документа удостоверяющего личность
  #end
  Function GetInd_DocKodVid :  string;

  #doc
  Получить серия документа
  #end
  Function GetInd_DocSeria :  string;

  #doc
  Получить номер документа
  #end
  Function GetInd_DocNum :  string;

  #doc
  Получить идентификационный номер
  #end
  Function GetInd_DocID :  string;

  #doc
  Получить дата выдачи документа
  #end
  Function GetInd_DocVidanDate : date;

  #doc
  Получить орган, выдавший документ
  #end
  Function GetInd_DocVidan : string;

  #doc
  Получить тип адреса  (1  - 'адрес места жительства', 2 - 'адрес места пребывания (при отсутствии постоянного места жительства в стране)')
  #end
  Function GetInd_AddressType : word;

  #doc
  Получить адрес жительства
  #end
  Function GetInd_Address : string;

  #doc
  Получить ссылку на адрес жительства
  #end
  Function GetInd_Address_nRec : comp;

  #doc
  Получить название страны жительства
  #end
  Function GetInd_OtherStateName : string;

  #doc
  Получить код страны жительства
  #end
  Function GetInd_OtherStateCode : string;

  #doc
  Получить адрес жительства за пределами страны
  #end
  Function GetInd_OtherAddress : string;

  #doc
  Получить код вида деятельности
  #end
  Function GetInd_KodActivity : word;

  #doc
  Получить cтатус налогоплательщика
  #end
  Function GetInd_StatNal : word;

end;

ObjInterface IOrganizationIndividualInfo_Ex;

  #doc
  Получить вид документа удостоверяющего личность
  #end
Function GetInd_DocVid_InCase(wCase : word) : string;

end;


#end
