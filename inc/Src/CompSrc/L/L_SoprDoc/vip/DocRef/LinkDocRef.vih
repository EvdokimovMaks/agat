//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 9.1 - Логистика
// Работа со связями позиций через таблицу DocRef
//
//********************************************************************************
#ifndef _LinkDocRef_VIH
#define _LinkDocRef_VIH

#ifdef ComponentVersion
#component "L_SOPRDOC"
#end

const
  // возможные значение wTbl
  cg_TableAll = 0;
  cg_Table1   = 1;  // подцепка DocRef по первой таблице
  cg_Table2   = 2;  // подцепка DocRef по второй таблице
end;

#doc
Работа со связями позиций через таблицу DocRef
#end
ObjInterface ObjLinkDocRef;

  #doc
  Процедура инициализации
  #end
  Procedure InitParam(wType, coTab1, coTab2: word);

  #doc
  Создание связи, через таблицу DocRef
  #end
  Procedure InsDocRef(vcFld1, vcFld2: comp);

  #doc
  Удаление связи
  #end
  Procedure DelDocRef(wTbl: word; cRec: comp);

  #doc
  Обновление связи
  #end
  Procedure UpdDocRef(wTbl: word; cRec, vcFld: comp);

  #doc
  Проверка существования связи
  #end
  Function isLink(wTbl: word; cRec: comp): boolean;

  #doc
  Получить ссылку на связанную позицию
  #end
  Function GetLink(wTbl: word; cRec: comp): comp;

  #doc
  Количество связанных позиций
  #end
  Function CountLink(wTbl: word; cRec: comp): word;

  #doc
  Наименование связи
  #end
  Function GetNameLink(wTbl: word; cRec: comp): string;

end;

ObjInterface ObjLinkDocRef1(ObjLinkDocRef);
#doc
  Проверка существования связи на конкретный документ cDoc
  #end
  Function IsLinkToDoc(wTbl: word; cRec: comp; cDoc : comp) : boolean;
end;
//******************************************************************************

VipInterface LinkDocRef implements ObjLinkDocRef, ObjLinkDocRef1
  licensed (FREE);
#end  // _LinkDocRef_VIH
