#ifndef __CopySoprDoc_vih__
#define __CopySoprDoc_vih__

#ifdef ComponentVersion
#component "L_SoprDoc"
#end

//******************************************************************************
#doc
  Копирование сопроводительного документа
#end
//******************************************************************************

ObjInterface objCopySoprDoc;

//******************************************************************************
#doc
Назначение:
  сохраняет ссылку на исходный документ
Параметры:
  pRecKatSopr - исходный сопроводительный документ
#end

Procedure SaveSoprDoc(pRecKatSopr: type$KatSopr);


//******************************************************************************
#doc
Назначение:
  копирует сопроводительный документ. pSrcMarker = 0 - одиночное копирование,
  сохраненного ф-ей SaveSoprDoc документа
Параметры:
  pSrcVidSopr - тип исходного документа
  pNewVidSopr - тип нового документа
  pSrcMarker  - исходные документы для копировния
  pNewMarker  - созданные сопроводительные документы (возвращаемый)
  isMess      - выдача сообщений
  wParams     - битовый параметр копирования (1-й бит - сохранение ссылки на ДО
                                              2-й бит - сохранять дату создания)
Возвращает:
  созданный сопроводительный документ (в случае одиночного копирования)
#end

Function CopySoprDoc(pSrcVidSopr, pNewVidSopr: word; pSrcMarker: TPtr; var pNewMarker: TPtr; isMess: boolean): comp;


#doc
Назначение:
  копирование позиции сопроводительного документа
Параметры
  pSpSopr    - ссылка на позицию сопроводительного документа
  pKolPos    - кол-во новых позиций = 1 - одиночное копирование
  isMess     - выдача сообщений
  pNewMarker - созданные позиции сопроводительных документов (возвращаемый)
Возвращает:
  созданную позицию (в случае одиночного копирования), 0 - нет созданных позиций, 1 - есть созданные позиции
#end
Function CopySpSopr(pSpSopr: comp; pKolPos: word; isMess : boolean; var pNewMarker: TPtr): comp;

end;

//******************************************************************************
#doc
  Копирование сопроводительного документа
#end
//******************************************************************************

ObjInterface objCopySoprDocV2(objCopySoprDoc);

#doc
Назначение:
 разбиение позиции сопроводительного документа по серийным номерам
Параметры
 pSpSopr    - ссылка на позицию сопроводительного документа
 isMess     - выдача сообщений
 pNewMarker - созданные позиции сопроводительных документов (возвращаемый)
#end
Function CopySpSoprSerial(pSpSopr: comp; isMess : boolean; var pNewMarker: TPtr): boolean;

//******************************************************************************

end;

//******************************************************************************
#doc
  Копирование сопроводительного документа
#end
//******************************************************************************

ObjInterface objCopySoprDocV3(objCopySoprDocV2);

#doc
Назначение:
  копирует сопроводительный документ. pSrcMarker = 0 - одиночное копирование,
  сохраненного ф-ей SaveSoprDoc документа
Параметры:
  pSrcVidSopr - тип исходного документа
  pNewVidSopr - тип нового документа
  pSrcMarker  - исходные документы для копировния
  pNewMarker  - созданные сопроводительные документы (возвращаемый)
  isMess      - выдача сообщений
  wParams     - битовый параметр копирования (1-й бит - сохранение ссылки на ДО)
Возвращает:
  созданный сопроводительный документ (в случае одиночного копирования)
#end

Function CopySoprDocEx(pSrcVidSopr, pNewVidSopr: word; pSrcMarker: TPtr; var pNewMarker: TPtr; isMess: boolean; wParams: word): comp;

//******************************************************************************

end;

VipInterface CopySoprDoc implements objCopySoprDocV3
licensed(FREE)
;

#end // __CopySoprDoc_vih__
