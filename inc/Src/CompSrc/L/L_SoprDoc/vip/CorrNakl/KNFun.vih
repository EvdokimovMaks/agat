//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 8.1 - логистика
// Функции исправительных документов
//******************************************************************************

#ifndef __KNFun_vih__
#define __KNFun_vih__

#component "L_SoprDoc"

//******************************************************************************
#doc
  Функции корректировочных документов
#end
//******************************************************************************

ObjInterface objKNFun;

//******************************************************************************
#doc
Назначение:
  Буфер исправительной позиции
Параметры:
  pSpSopr  - позиция сопроводительного документа
  pBuf     - буфер исправительной позиции
  wMode    - режим работы. 1 - парный (сторно/корр) документ
Возвращает:
  наличие буфера корректировки позиции
#end
//******************************************************************************
Function GetBufKNSp(pSpSopr: comp; var pBuf: type$SpSopr): boolean;


//******************************************************************************
#doc
Назначение:
  Буфер исправительного документа
Параметры:
  pKatSopr - сопроводительный документ
  pBuf     - Буфер исправительного документа
  wMode    - режим работы. 1 - парный (сторно/корр) документ
Возвращает:
  наличие буфера корректировки
#end
//******************************************************************************
Function GetBufKN(pKatSopr: comp; var pBuf: type$KatSopr): boolean;


//******************************************************************************
#doc
Назначение:
  Буфер сторнирующей позиции
Параметры:
  pSpSopr  - позиция сопроводительного документа
  pBuf     - буфер сторнирующей позиции
  wMode    - режим работы. 1 - парный (сторно/корр) документ
#end
//******************************************************************************
Function GetBufSNSp(pSpSopr: comp; var pBuf: type$SpSopr): boolean;


//******************************************************************************
#doc
Назначение:
  Буфер сторнирующего документа
Параметры:
  pKatSopr - сопроводительный документ
  pBuf     - буфер сторнирующего документа
  wMode    - режим работы. 1 - парный (сторно/корр) документ
Возвращает:
  наличие буфера сторно
#end
//******************************************************************************
Function GetBufSN(pKatSopr: comp; var pBuf: type$KatSopr): boolean;


//********************************************************************************
#doc
Назначение:
  формирование ордеров по сторнирующему и исправительному документу
Параметры:
  pKatSopr   - сопроводительный документ
  pOperation - 1-й бит - только создание ордера
               2-й бит - переформирование ордера
               3-й бит - удаление ордера
#end
Procedure KNOrders(pKatSopr: comp; pOperation: word);

//********************************************************************************
#doc
Назначение:
  удаление сторнирующего и исправительного документов
Параметры:
  pKatSopr   - сопроводительный документ
  pParam     - битовый параметр
#end
Function KNDelSopr(pKatSopr: comp; pParam: word): boolean;

end;

ObjInterface objKNFun2;

//******************************************************************************
#doc
Назначение:
  Буфер корректирующей позиции
Параметры:
  pSpSopr  - позиция сопроводительного документа
  pBuf     - буфер корректирующей позиции
  wMode    - режим работы. 1 - парный (сторно/корр) документ
Возвращает:
  наличие буфера корректировки позиции
#end
//******************************************************************************
Function GetBufKNSp2(pSpSopr: comp; var pBuf: type$SpSopr; pMode: word = 0): boolean;


//******************************************************************************
#doc
Назначение:
  Буфер корректирующего документа
Параметры:
  pKatSopr - сопроводительный документ
  pBuf     - Буфер корректирующего документа
  wMode    - режим работы. 1 - парный (сторно/корр) документ
Возвращает:
  наличие буфера корректировки
#end
//******************************************************************************
Function GetBufKN2(pKatSopr: comp; var pBuf: type$KatSopr; pMode: word = 0): boolean;


//******************************************************************************
#doc
Назначение:
  Буфер сторнирующей позиции
Параметры:
  pSpSopr  - позиция сопроводительного документа
  pBuf     - буфер сторнирующей позиции
  wMode    - режим работы. 1 - парный (сторно/корр) документ
#end
//******************************************************************************
Function GetBufSNSp2(pSpSopr: comp; var pBuf: type$SpSopr; pMode: word = 0): boolean;


//******************************************************************************
#doc
Назначение:
  Буфер сторнирующего документа
Параметры:
  pKatSopr - сопроводительный документ
  pBuf     - буфер сторнирующего документа
  wMode    - режим работы. 1 - парный (сторно/корр) документ
Возвращает:
  наличие буфера сторно
#end
//******************************************************************************
Function GetBufSN2(pKatSopr: comp; var pBuf: type$KatSopr; pMode: word = 0): boolean;


end;

VipInterface KNFun implements objKNFun, objKNFun2 licensed (FREE);

#end
