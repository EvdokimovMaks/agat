!╔═══════════════════════════════════════════════════════════════════════════╗
!║                     (c) 1999 корпорация ГАЛАКТИКА                         ║
!║ Проект        : ГАЛАКТИКА                                                 ║
!║ Система       : Управление сбытом                                         ║
!║ Версия        : 5.70                                                      ║
!║ Назначение    : Удостоверение качества                                    ║
!║ Ответственный : Кратович С.Л.                                             ║
!╚═══════════════════════════════════════════════════════════════════════════╝

#doc
Удостоверение качества
#end
.Form 'PrnSert'
.Hide
.Group 'One_UK_Gr'
.Group 'One_UK'
.Group 'Reestr_UK'
.Fields
Интервал_Дата_С
Интервал_Дата_По
Ветка_Имя
УК_NRec
УК_Дескр
УК_ДесГр
УК_Номер
УК_Дата    : date
УК_Дата_По : date
УК_Имя
УК_Статус
УК_МЦ_Имя
УК_МастерОТК
УК_Проба_Орг
УК_Проба_Подр
УК_ГОСТ
УК_РегНомер
УК_ДержательСертификата
УК_ТУ
УК_Маршрут
УК_ППогрузки

Партия_NRec
Партия_Код
Партия_Имя
Партия_ДатаВремяВыработки : _datetime
Партия_СертИмя
Партия_СертДата : date

СвояОрганизация_Имя
СвояОрганизация_Адрес

Атрибут_Имя
Атрибут_Значение

Группа_Имя

Показатель_Код
Показатель_Имя
Показатель_Значение
Показатель_МинЗначение
Показатель_МаксЗначение
Показатель_ЕдИзм

Вагон_NRec
Вагон_Номер
Вагон_НомерКвитанции
Вагон_Дата  : date
Вагон_Время
Вагон_Масса      : double
Вагон_Нетто      : double
Вагон_МассаОбщая : double
Вагон_Орг
Вагон_Маршрут_Имя
Вагон_ППогрузки
Вагон_ПРазгрузки

.EndFields
Интервал_Дата_С   ^
Интервал_Дата_По  ^
.{ CheckEnter Group_UK
Ветка_Имя         ^
.{ CheckEnter One_UK
NRec                              ^
Дескр.                            ^
Группа                            ^
Номер                             ^
Дата оформления                   ^
Дата окончания действия           ^
Наименование                      ^
Статус                            ^
Матценность                       ^
Мастер ОТК                        ^
Организация, проводившая пробы    ^
Подразделение, проводившее пробы  ^
ГОСТ                              ^
Регистрационный номер             ^
Держатель сертификата             ^
ТУ                                ^
ЖД                                ^
Станция погрузки                  ^

NRec партии                       ^
Код партии                        ^
Наименование партии               ^
Дата и время выработки партии     ^
Наименование сертификата          ^
Дата действия сертификата         ^

Имя своей организации             ^
Адрес своей организации           ^

.if Print_UK_Attr
.{ CheckEnter UK_Attr
Атрибут_Имя                       ^
Атрибут_Значение                  ^
.}
.end
.if Print_UK_Pokaz
.{ CheckEnter UK_Pokaz
.if Print_UK_GrPokaz
Группа_Имя                        ^
.end
Показатель_Код                    ^
Показатель_Имя                    ^
Показатель_Значение               ^
Показатель_МинЗначение            ^
Показатель_МаксЗначение           ^
Показатель_ЕдИзм                  ^
.}
.end

.if Print_UK_Vagon
.{ CheckEnter UK_Vagon
Вагон_NRec                        ^
Вагон_Номер                       ^
Вагон_НомерКвитанции              ^
Вагон_Дата                        ^
Вагон_Время                       ^
Вагон_Масса                       ^
Вагон_Нетто                       ^
Вагон_МассаОбщая                  ^
Вагон_Орг                         ^
Вагон_Маршрут_Имя                 ^
Вагон_ППогрузки                   ^
Вагон_ПРазгрузки                  ^
.}
.end
.}
.}
.EndForm

#doc
Удостоверение качества и безопасности
#end
.LinkForm 'PrnSert_11' Prototype is 'PrnSert'
.NameInList 'Удостоверение качества и безопасности'
.Group 'One_UK_Gr'
.DEFP PA4
.DEFO PORTRAIT
.P 90
.Fields

УК_Номер
datetostr(УК_Дата,'DD/MM/YYYY')
УК_МЦ_Имя
УК_ГОСТ
Партия_СертИмя
Партия_Имя
datetostr(_GetDate(Партия_ДатаВремяВыработки),'DD/MM/YYYY')
СвояОрганизация_Имя
СвояОрганизация_Адрес
trim(УК_ППогрузки)+' '+trim(УК_Маршрут)

Атрибут_Имя
Атрибут_Значение

Группа_Имя

Показатель_Имя
Показатель_ЕдИзм
Показатель_МинЗначение
Показатель_МаксЗначение
Показатель_Значение

УК_МастерОТК
'true' : 's'

.EndFields
.{ CheckEnter Group_UK
.{ CheckEnter One_UK
    Удостоверение качества и безопасности № Б ^  Бот Б @@@@@@@@@@ г.

 Й Наименование МЦ  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Нормативный документ  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Документ о соответствии  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Номер и дата выработки партии  Б ^  Бот Б @@@@@@@@@@ г. И
 Й Предприятие-производитель  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Адрес  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Станция отправления  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И

.if Print_UK_Attr
 Щ  Дополнительные параметры Щ
 Ш ──────────────────────────────────────────┬─────────────────────────────────
           Наименование параметра          │            Значение
 ──────────────────────────────────────────┴───────────────────────────────── Ш
.{ CheckEnter UK_Attr
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.}

.end
.if Print_UK_Pokaz
 Щ  Показатели качества Щ
 Ш ─────────────────────────────────┬───────────────────────┬───────────────────────┬───────────────────────
      Наименование показателя     │ Требования к качеству │ Требования к качеству │       Фактические
                                  │ Минимальное значение  │ Максимальное значение │        показатели
 ─────────────────────────────────┴───────────────────────┴───────────────────────┴─────────────────────── Ш
.{ CheckEnter UK_Pokaz
.if Print_UK_GrPokaz

 Ш ───────────────────────────────────────────────────────────────────────────────────────────────────────── Ш
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
 Ш ───────────────────────────────────────────────────────────────────────────────────────────────────────── Ш
.end
 Ш @@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@ &'&&&&&&&&&&&&&&&&&.&&& &'&&&&&&&&&&&&&&&&&.&&& &'&&&&&&&&&&&&&&&&&.&&& Ш
.}

.end
.if Print_UK_Vagon
.{ CheckEnter UK_Vagon
.}
.end
 Ш ───────────────────────────────────────────────────────────────────────────────────────────────────────── Ш

 Й Мастер ОТК  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
^
.}
.}
.EndForm

.LinkForm 'PrnSert_01' Prototype is 'PrnSert'
.NameInList 'Удостоверение качества'
.Group 'One_UK'
.DEFP PA4
.DEFO PORTRAIT
.P 90
.var
   totalmassa : double
   totalnetto : double
   totalall   : double
.endvar
.Fields

УК_Номер
datetostr(УК_Дата,'DD/MM/YYYY')
УК_Статус
datetostr(УК_Дата_По,'DD/MM/YYYY')
УК_Имя
УК_МЦ_Имя
УК_ГОСТ
УК_ТУ
УК_РегНомер
УК_ДержательСертификата
УК_Проба_Орг
УК_Проба_Подр
УК_МастерОТК
trim(УК_ППогрузки)+' '+trim(УК_Маршрут)

Атрибут_Имя
Атрибут_Значение

Показатель_Имя
Показатель_Значение

datetostr(Вагон_Дата,'DD/MM/YYYY')
Вагон_Время
Вагон_Номер
Вагон_НомерКвитанции
Вагон_МассаОбщая
Вагон_Масса
Вагон_Нетто
Вагон_Орг
Вагон_Маршрут_Имя
Вагон_ППогрузки
Вагон_ПРазгрузки
totalall
totalmassa
totalnetto

'true' : 's'

.EndFields
.{ CheckEnter Group_UK
.{ CheckEnter One_UK
.begin
 totalmassa := 0;
 totalnetto := 0;
 totalall   := 0;
end.
  Б           Удостоверение качества № Б ^  Бот Б @@@@@@@@@@ г.

 Й Статус документа   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Дата окончания действия  Б@@@@@@@@@@ г. И
 Й Наименование  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Название МЦ   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й ГОСТ  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б ТУ  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Регистрационный номер  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Держатель сертификата  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Организация, проводившая пробы    Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Подразделение, проводившее пробы  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Мастер ОТК  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
 Й Станция отправления  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И

.if Print_UK_Attr
 Щ  Дополнительные параметры Щ
 Ш ──────────────────────────────────────────┬─────────────────────────────────
           Наименование параметра          │            Значение
 ──────────────────────────────────────────┴───────────────────────────────── Ш
.{ CheckEnter UK_Attr
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.}

.end
.if Print_UK_Pokaz
 Щ  Показатели качества Щ
 Ш ──────────────────────────────────────────┬─────────────────────────────────
           Наименование показателя         │            Значение
 ──────────────────────────────────────────┴───────────────────────────────── Ш
.{ CheckEnter UK_Pokaz
.if Print_UK_GrPokaz
.end
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&&&&&&&&&&&.&&& Ш
.}

.end
.if Print_UK_Vagon
 Щ  Вагоны Щ
 Ш ──────────┬─────┬────────┬─────────┬───────────────┬───────────────┬───────────────┬────────────────┬────────────────┬────────────────┬────────────────
    Дата   │Время│  Номер │  Номер  │Масса груженого│ Масса пустого │   Вес груза   │  Потребитель   │   Железная     │    Станция     │    Станция
           │     │ вагона │квитанции│    вагона     │    вагона     │               │                │    дорога      │  отправления   │   назначения
 ──────────┴─────┴────────┴─────────┴───────────────┴───────────────┴───────────────┴────────────────┴────────────────┴────────────────┴──────────────── Ш
.{ CheckEnter UK_Vagon
 Ш @@@@@@@@@@ @@@@@ @@@@@@@@ @@@@@@@@@ &'&&&&&&&&&.&&& &'&&&&&&&&&.&&& &'&&&&&&&&&.&&& @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ Ш
.begin
 totalmassa := totalmassa + Вагон_Масса;
 totalnetto := totalnetto + Вагон_Нетто;
 totalall   := totalall   + Вагон_МассаОбщая;
end.
.}
 Ш ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Ш
 Щ Итого:                              &'&&&&&&&&&.&&& &'&&&&&&&&&.&&& &'&&&&&&&&&.&&& Щ

.end
^
.}
.}
.EndForm

#doc
Удостоверение качества
#end
.LinkForm 'PrnSert_02' Prototype is 'PrnSert'
.NameInList 'Удостоверение качества'
.Group 'Reestr_UK'
.DEFP PA4
.DEFO PORTRAIT
.P 90
.var
   totalmassa : double
   totalnetto : double
   totalall   : double
.endvar
.Fields
CommonFormHeader
Интервал_Дата_С
Интервал_Дата_По
Ветка_Имя
УК_Номер
УК_Дата
УК_Дата_По
УК_Статус
УК_Имя
УК_МЦ_Имя
УК_ГОСТ
УК_ТУ
УК_РегНомер
УК_ДержательСертификата
УК_Проба_Орг
УК_Проба_Подр
УК_МастерОТК

Атрибут_Имя
Атрибут_Значение

Показатель_Имя
Показатель_Значение

datetostr(Вагон_Дата,'DD/MM/YYYY')
Вагон_Время
Вагон_Номер
Вагон_НомерКвитанции
Вагон_МассаОбщая
Вагон_Масса
Вагон_Нетто
Вагон_Орг
Вагон_Маршрут_Имя
Вагон_ППогрузки
Вагон_ПРазгрузки
totalall
totalmassa
totalnetto


.EndFields
 Ш^ Ш
 Б                  Реестр удостоверений качества
                за период с ^ по ^ Б

 Ш───────┬──────────┬──────────┬───────────┬──────────────┬───────────┬────────┬────────────┬─────────┬───────────┬───────────┬─────────────┬──────────
 Номер │   Дата   │   Дата   │  Статус   │ Наименование │Матценность│  ГОСТ  │     ТУ     │Рег.номер│ Держатель │Организация│Подразделение│Мастер ОТК
       │оформления│окончания │           │              │           │        │            │         │сертификата│пров. пробы│ пров. пробы │
───────┴──────────┴──────────┴───────────┴──────────────┴───────────┴────────┴────────────┴─────────┴───────────┴───────────┴─────────────┴────────── Ш
.{ CheckEnter Group_UK
 Ы@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ы
.{ CheckEnter One_UK
.begin
 totalmassa := 0;
 totalnetto := 0;
 totalall   := 0;
end.
 Ш@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@ Ш
.if Print_UK_Attr
 Щ  Дополнительные параметры Щ
 Ш ──────────────────────────────────────────┬─────────────────────────────────
           Наименование параметра          │            Значение
 ──────────────────────────────────────────┴───────────────────────────────── Ш
.{ CheckEnter UK_Attr
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.}

.end
.if Print_UK_Pokaz
 Щ  Показатели качества Щ
 Ш ──────────────────────────────────────────┬─────────────────────────────────
           Наименование показателя         │            Значение
 ──────────────────────────────────────────┴───────────────────────────────── Ш
.{ CheckEnter UK_Pokaz
.if Print_UK_GrPokaz
.end
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&&&&&&&&&&&.&&& Ш
.}

.end
.if Print_UK_Vagon
 Щ  Вагоны Щ
 Ш ──────────┬─────┬────────┬─────────┬───────────────┬───────────────┬───────────────┬────────────────┬────────────────┬────────────────┬────────────────
    Дата   │Время│  Номер │  Номер  │Масса груженого│ Масса пустого │   Вес груза   │  Потребитель   │   Железная     │    Станция     │    Станция
           │     │ вагона │квитанции│    вагона     │    вагона     │               │                │    дорога      │  отправления   │   назначения
 ──────────┴─────┴────────┴─────────┴───────────────┴───────────────┴───────────────┴────────────────┴────────────────┴────────────────┴──────────────── Ш
.{ CheckEnter UK_Vagon
 Ш @@@@@@@@@@ @@@@@ @@@@@@@@ @@@@@@@@@ &'&&&&&&&&&.&&& &'&&&&&&&&&.&&& &'&&&&&&&&&.&&& @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ Ш
.begin
 totalmassa := totalmassa + Вагон_Масса;
 totalnetto := totalnetto + Вагон_Нетто;
 totalall   := totalall   + Вагон_МассаОбщая;
end.
.}
 Ш ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Ш
 Щ Итого:                              &'&&&&&&&&&.&&& &'&&&&&&&&&.&&& &'&&&&&&&&&.&&& Щ

.end
.}
.}
.EndForm
