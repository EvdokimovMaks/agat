//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 9.10 - Логистика
// Резервирование по сопроводительным документам
//******************************************************************************

#ifNdef __SoprDocRes_vih__
#define __SoprDocRes_vih__

//******************************************************************************

#component "L_Reserve"

#doc
Резервирование по сопроводительным документам
#end

ObjInterface ObjSoprDocRes;

end;
//******************************************************************************

VipInterface SoprDocRes implements ObjSoprDocRes licensed(FREE);

Public:
//******************************************************************************
#doc
Функция пересчета резервов по сопроводительным документам
#end
Function InsertResSD( dFor  : Date             // дата, на которую рассчитывать резерв
                   ; boAllDoc                  // TRUE = необходимо производить резервирование по всему документу
                   , boReservIns  : boolean    // True = резервирование / False = снятие с резерва
                   ; _cKatSopr, _cSpSopr  : comp // ссылка на документ или на позиции спецификации
                   ; _KolRes  : double
                   ; wModePar : word = 0): boolean;

//******************************************************************************
#doc
Функция пересчета резервов по договору
#end
Function InsertResSDDog(dFor  : Date             // дата, на которую рассчитывать резерв
                   ; boAllDoc                    // TRUE = необходимо производить резервирование по всему документу
                   , boReservIns  : boolean      // True = резервирование / False = снятие с резерва
                   ; _cDogovor, _cSpDocs  : comp // ссылка на документ или на позиции спецификации
                   ; _KolRes : double): boolean;

#doc
Функция расчета резерва по позиции спецификации
#end
Function GetResPos(_SpnRec : comp; _TiDk : word) : double;

#doc
Наличие зарезервированных позиций по договору
#end
Function GetResDoc(_DogovornRec : comp) : boolean;

#doc
Наличие зарезервированных позиций по KatSopr
#end
Function GetResKatSopr(_KatSoprnRec : comp) : boolean;

#doc
Возврат количества по разрезу на дату/ текущего остатка, если дата равно нулю (_cSpDocs = SpSopr.nrec или SpDocs.nRec)
#end
Function GetKolOstResSp(DateOst : Date; SkPr : word; _coTable : word; _cSpDocs, _cPodr, _cMol, _cMcUsl, _cParty, _cOtpEd : comp) : double;

#doc
Частичное удаление резерва по позиции при аннулировании распоряжения (_boCancel = False) или возврат аннулированного резерва (_boCancel = True)
#end
Function DelResSpSopr(_cKatSopr, _cSpSopr : comp; _KolRes : double; _boCancel : boolean): boolean;

end;

#end
//******************************************************************************
