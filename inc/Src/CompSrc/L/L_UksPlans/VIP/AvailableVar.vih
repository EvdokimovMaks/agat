//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.8x - УКС - Управление капитальным строительством
// Доступные копии вариантов планов
//------------------------------------------------------------------------------

!---------------------------------------------------------------------------
#ifndef _AvailableVar_Tbl_
#define _AvailableVar_Tbl_

#ifdef ComponentVersion
 #component "L_UksPlans"
#end

Table struct AvailableVar "Доступные копии вариантов планов"
(
  cPlanVar : tNrec "Ссылка на копию варианта плана",
  IsActive : Word  "Признак активного варианта",
  cName    : tNrec "Ссылка на классификатор вариантов",
  CopyVar  : Word  "Номер копии варианта"
)
With index
(
  AvailableVar01 = IsActive(Desc) + cName + CopyVar,
  AvailableVar02 = cPlanVar
);
#endif // _AvailableVar_Tbl_
!---------------------------------------------------------------------------

#doc
Содержит методы для определения прав доступа к вариантам планов по областям видимости.
#end
ObjInterface OAvailableVar;

!---------------------------------------------------------------------------
#doc
Возвращает наименование текущей области видимости.
#end
  Function AreaName : string;
!---------------------------------------------------------------------------
#doc
Инициализация ссылки на план.
#end
  Procedure SetPlan(acPlan : comp);
!---------------------------------------------------------------------------
#doc
Выбор текущей области видимости.
#end
  Function GetArea(abChoice : boolean) : comp;
!---------------------------------------------------------------------------
#doc
Наличие у пользователя списка областей видимости.
#end
  Function HaveUserArea : boolean;
!---------------------------------------------------------------------------
#doc
Установлены ли ограничения на копии вариантов плана.
#end
  Function BoundedVar(acCmp : comp) : boolean;
!---------------------------------------------------------------------------
#doc
Проверка допустимости заданных атрибутов плана.
#end
  Function CheckPlanAttr(acStatus, acCO, acVar : comp) : boolean;
!---------------------------------------------------------------------------
#doc
Возвращает первый допустимый номер копии.
#end
  Function GetFirstCopyNum : word;
!---------------------------------------------------------------------------
#doc
Проверка допустимости заданного номера копии плана.
#end
  Function IsValidNum(awCopyNum : word) : boolean;
!---------------------------------------------------------------------------
#doc
Проверка допустимости доступа на чтение для заданного регистра учета.
#end
  Function IsValidRegister(aiRegister : integer) : boolean;
!---------------------------------------------------------------------------
#doc
Получение первого доступного для чтения регистра учета.
#end
  Function GetFirstValidRegister(var aiRegister : integer) : boolean;
!---------------------------------------------------------------------------
#doc
Доступен ли заданный регистр учета только для чтения.
#end
  Function IsReadOnlyReg(aiRegister : integer) : boolean;
!---------------------------------------------------------------------------
#doc
Доступно ли редактирование спецификации плана (необходим полный доступ к регистрам "План" и "Факт").
#end
  Function CanEditSpec : boolean;
!---------------------------------------------------------------------------
#doc
Проверка на отображение варианта плана.
#end
  Function GetAccessibleVar(acVar : comp) : boolean;

End;

!---------------------------------------------------------------------------
VipInterface IAvailableVar implements OAvailableVar licensed (FREE);
