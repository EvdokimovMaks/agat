//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 7.12 - 8.5
// Создание цветовых схем для каталога объектов ремонта
//********************************************************************************

#ifNdef _RemColorScheme_vpp_
#define _RemColorScheme_vpp_

#declare GrafRemColor
{
  Font =
  {
    BackColor = if((Cur_D >= GrafRem.DateN AND GrafRem.DateN <> Date(0, 0, 0) AND
        (Cur_D <= GrafRem.DateK or GrafRem.DateK = Date(0, 0, 0))) or
        (Cur_D >= GrafRem.DateNF AND GrafRem.DateNF <> Date(0, 0, 0) AND
        (Cur_D <= GrafRem.DateKF or GrafRem.DateKF = Date(0, 0, 0))), ColorRemToday, 0);
    Color = if(Picked <> '', ColorMark, if(GrafRem.VidGraf = 1, ColorRemNotPlan, 0));
    Bold  = GrafRem.DateKF <> Date(0, 0, 0)
  }
}
#end

#declare JourObjColor
{
  Font =
  {
    BackColor = if((Cur_D >= JourObj.DataOst AND
        JourObj.DataOst <> Date(0, 0, 0) AND
        (Cur_D <= JourObj.DataLik or
        JourObj.DataLik = Date(0, 0, 0))), ColorRemToday, 0)

    Color = if ( isValid(tnVidOst) AND VidOst.IsLeaf = 1, ColorSysRed, 
             if ( JourObj.DataLik = Date(0, 0, 0),          ColorRemNotRab, 0));

    Bold  =    ( JourObj.DataLik = Date(0, 0, 0));
  }
}
#end


#declare ObjRemColor
{
   Font =
   {
      Color = if(ObjRem.UseObjRem = 1, ColorGray, // не использовать в расчете
              if(PickedObj <> '', ColorMark,      // признак группового выбора
              if(ObjRem.Status = 1 , ColorRemNotRab,  // в простое
              if(ObjRem.Status = 2 , ColorRemPlan,    // в плановом ремонте
              if(ObjRem.Status = 3 , ColorRemNotPlan, // внеплановый ремонт
              if(ObjRem.Status = 4 , ColorRemNeispr,  // неисправное состояние
              if(ObjRem.Status = 5 , ColorRemPrevSr,  // превышение срока службы
              if(ObjRem.Status = 6 , ColorRemDefekt,  // обнаружены дефекты
              if(ObjRem.Status = 7 , ColorGray,       // Выбывшие/не использовать в расчете
                                                   0                   // в работе
                )))))))))
   }
}
#end

#declare ObjRemColor2
{
   Font =
   {
      Color = if(ObjRemDescr.cTable = 1
               , if(isValid(tnObjRem2)
                  , if(ObjRem2.UseObjRem = 1, ColorGray, // не использовать в расчете
                    if(Picked <> '', ColorMark,          // признак группового выбора
                    if(ObjRem2.Status = 1, ColorRemNotRab,  // в простое
                    if(ObjRem2.Status = 2, ColorRemPlan,    // в плановом ремонте
                    if(ObjRem2.Status = 3, ColorRemNotPlan, // внеплановый ремонт
                    if(ObjRem2.Status = 4, ColorRemNeispr,  // неисправное состояние
                    if(ObjRem2.Status = 5, ColorRemPrevSr,  // превышение срока службы
                    if(ObjRem2.Status = 6, ColorRemDefekt,  // обнаружены дефекты
                    if(ObjRem2.Status = 7, ColorGray,       // Выбывшие/не использовать в расчете
                                           0                   // в работе
                    )))))))))
                  , 0)
               , 0)
      bold  = ObjRemDescr.isLeaf = 0;  // узел дерева
   }
}
#end


#declare ObjRemColor3
{
  Font =
  {
    Color = if(ObjRemDoc.UseObjRem = 1, ColorGray, // не использовать в расчете
        // признак группового выбора
        if(Picked <> '', ColorMark,
        // признак для узла
        if(ObjRemDescr.cTable <> 1, ColorSysMaroon,
        // признак для узла
        if(ObjRemDoc.Status = 1 AND ObjRemDescr.cTable = 1, ColorRemPlan,
        // внеплановый ремонт
        if(ObjRemDoc.Status = 2 AND ObjRemDescr.cTable = 1, ColorRemNotPlan,
        // в простое
        if(ObjRemDoc.Status = 3 AND ObjRemDescr.cTable = 1, ColorRemNotRab,
        // в плановом ремонте-фактически
        if(ObjRemDoc.Status = 11 AND ObjRemDescr.cTable = 1, ColorRemPlan,
        // внеплановый ремонт-фактически
        if(ObjRemDoc.Status = 12 AND ObjRemDescr.cTable = 1, ColorRemNotPlan,
        // Выбывшие/не использовать в расчете
!        if(ObjRemDoc.Status = 7 and Rem_Var18 = 1, ColorGray,       
        // в работе
        0))))))));

    BackColor = if(
        // в плановом ремонте-фактически
        (ObjRemDoc.Status = 11 AND ObjRemDescr.cTable = 1) or
        // внеплановый ремонт-фактически
        (ObjRemDoc.Status = 12 AND ObjRemDescr.cTable = 1),
        ColorRemToday, 0);
    Italic = (ObjRemDescr.cTable <> 1)
  }
}
#end

#declare RemColorScheme10
{
  Font =
  {
    Color = ColorRemPeriod;
    Bold = TRUE
  }
}
#end

#declare RemColorScheme3
{
  Font =
  {
    Color = ColorRemVidGraf;
    Bold = TRUE
  }
}
#end

#declare RemColorScheme5
{
  Font =
  {
    Color = ColorRemFilter;
    Bold = TRUE
  }
}
#end

#declare RemColorScheme7
{
  Font =
  {
    Color = ColorRemSort;
    Bold = TRUE
  }
}
#end

//------------------------------------------------------------------------------

#declare RemColorScheme_VidOst
{
  Font =
  {
    Color = if(VidOst.IsLeaf = 1, ColorSysRed
!          , if(VidOst.IsLeaf = 2, ColorSysBlue 
!          , if(VidOst.IsLeaf = 3, ColorSysGreen
                                , 0)
!                                   )
!                                   )
  }
}
#end

//------------------------------------------------------------------------------

#declare RemColorScheme_VidOst2
{
  Font =
  {
    Color = if(Picked = 'V', ColorMark
          , if(VidOst.IsLeaf = 1, ColorSysRed
!          , if(VidOst.IsLeaf = 2, ColorSysBlue 
!          , if(VidOst.IsLeaf = 3, ColorSysGreen
                                , 0)
                                   )
!                                   )
!                                   )

  }
}
#end

//------------------------------------------------------------------------------

#declare RemColorScheme_VidOst_Str
  ' - '
, 'Красный' //ColorSysRed
!, 'Синий'   //ColorSysBlue
!, 'Зеленый' //ColorSysGreen
#end



//------------------------------------------------------------------------------

#endif // _RemColorScheme_vpp_
