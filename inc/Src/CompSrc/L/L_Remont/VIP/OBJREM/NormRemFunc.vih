//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 8.1 - функции.
// Функция для норм ремонтов
//******************************************************************************


//******************************************************************************

#ifdef ComponentVersion
#component "L_Remont"
#end

//******************************************************************************

#doc
Функция для норм ремонтов

для использования необходимо
запускать методы объектного интерфейса через переменную:
vo_NormRemFunc.
#end

ObjInterface objNormRemFuncV1;

//------------------------------------------------------------------------------

#doc
Дата следующего ремонта по норме
#end

Function fncGetDateNextRemont(_NormRem_NRec: comp): string;


//------------------------------------------------------------------------------

#doc
Процедура
дата из документа
#end

Procedure prcSetDateLastRemontFromDoc(_vwParam:      word;
                                      _NormRem_NRec: comp;
                                      pk_varg:       comp; 
                                      pr_varg:       Boolean;
                                      vdDateVip:     date;
                                      p_dat1:        date;
                                      _vbWrite:      boolean;
                                      var ts_Ok:     word);


//------------------------------------------------------------------------------

#doc
не смог найти последний ремонт (нет Актов или нет Факта в графике ремонта)
пустого LastRem не должно быть
#end

Procedure prcNormRemLastRemNotNull(ts_Ok:         word;
                                   _NormRem_NRec: comp);


//------------------------------------------------------------------------------

#doc
Дата последнего ремонта
Процедура поиска даты последнего ремонта в Актах работ, заявках или Графике
#end

Procedure prcSetDateLastRemont(_vwParam:      word;
                               _NormRem_NRec: comp;
                               pk_varg:       comp; 
                               pr_varg:       Boolean;
                               vdDateVip:     date;
                               p_dat1:        date;
                               Tkod:          word;
                               _vwParam2:     word;
                               _vcUs:         comp;
                               var WasKor:    boolean);

//------------------------------------------------------------------------------

#doc
Дата последней ручной корректировки не должна быть меньше даты последнего ремонта
#end

Procedure prcNormRemLastKorRem(_NormRem_NRec: comp;
                               pk_varg:       comp; 
                               var WasKor:    boolean);

//------------------------------------------------------------------------------

#doc
Дата последнего ремонта
корректируется с учетом вышестоящих (метод 6, 7)
другого вида ремонта (.. а также единовременного)
#end


Procedure prcSetDateLastRemontFromUp(_vwParam:      word;
                                     _NormRem_NRec: comp);


//------------------------------------------------------------------------------
/*
#doc
Дата ремонта установленная вручную.
получение
#end
Function fncGetDateLastRemontHand(_NormRem_NRec: comp): date;


//------------------------------------------------------------------------------

#doc
Дата ремонта установленная вручную.
Установка
#end

Procedure prcSetDateLastRemontHand(_NormRem_NRec: comp; _vsDateLastRemontHand: string);
*/
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
проверка корректности заполнения вида ремонта в нормах в разрезе Объекта ремонта
#end

function fncIfMojnoNormRem(_vcNormRem_NRec: comp; _vcVidRem_NRec: comp): boolean;
//------------------------------------------------------------------------------


#doc
проверка корректности заполнения вида ремонта в нормах в разрезе Объекта ремонта
#end

Function fncGetTVedRem_ForObjAndVidRem(_vcObjRem_NRec: comp; _vcVidRem_NRec: comp; _vdDateBegin: date): comp;
//------------------------------------------------------------------------------

#doc
установка даты посл ремонта у ОР в норме на соответствующий вид ремонта
#end

Procedure prcSetNormRemLastRem(_vcObjRem_NRec: comp; _vcVidRem_NRec: comp; _vdDate: date);

//------------------------------------------------------------------------------

#doc
взять значение ремонтная сложность
#end

Function fncGetNormRem_RS(_NormRem_NRec: comp): double;

//------------------------------------------------------------------------------

#doc
установить значение ремонтная сложность
#end

Procedure prcSetNormRem_RS(_NormRem_NRec: comp; _vfNormRem_RS: double);

//------------------------------------------------------------------------------

#doc
поиск значения ремонтная сложность по ОР и по виду ремонта из нормы
вернет значение рем. сложности из нормы по указанному ОР и виду ремонта
#end

Function fncGetRS_Norm(_vcObjRemNRec: comp;
                       _vcVidRemNRec: comp): double;

//------------------------------------------------------------------------------

#doc
поиск типового ремонта
вернет значение типового ремонта из нормы по указанному ОР и виду ремонта
#end

Function fncGet_NormTipVed(_vcObjRemNRec: comp;
                           _vcVidRemNRec: comp): comp;


//------------------------------------------------------------------------------

#doc
поиск нормы по ОР и по виду ремонта
#end

Function fncGetNormBy_OR_VidRem(_vcObjRemNRec: comp; _vcVidRemNRec: comp): comp;

//------------------------------------------------------------------------------

Function DateNLong(FNPeriod: double; NormRemEdPeriod, KolD: word; KolM: integer; LastDK: date): date;

//------------------------------------------------------------------------------


#doc
вернет дату окончания ремонта для графика или заявки
#end

Function fncGetDateKRemont(_vcObjRemNRec: comp; _vcVidRemNRec: comp; _vdDateN: date): date;

//------------------------------------------------------------------------------


#doc
взять значение разр период
#end

Function fncGetNormRem_RP(_NormRem_NRec: comp): word;

//------------------------------------------------------------------------------

#doc
установить значение разр период
#end

Procedure prcSetNormRem_RP(_NormRem_NRec: comp; _vfNormRem_RP: word);


end;

//******************************************************************************

#doc
Функция для норм ремонтов

для использования необходимо
запускать методы объектного интерфейса через переменную:
vo_NormRemFunc.
#end

VipInterface NormRemFuncV1 implements objNormRemFuncV1
#ifdef ATL51
  licensed (FREE)
#end
;

//******************************************************************************
