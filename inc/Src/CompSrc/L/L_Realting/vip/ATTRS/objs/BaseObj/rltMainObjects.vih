//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 8.1 - Логистика
// Методы и события для управления базовыми объектами объектов недвижимости
//******************************************************************************

#ifndef __RLTMAINOBJECTS_VIH__
#define __RLTMAINOBJECTS_VIH__

#ifdef ComponentVersion
#component "L_REALTING"
#end

#doc
Содержит описание методов и событий для управления базовыми интерфейсами объектов недвижимости
#end
ObjInterface tRltMainObjCommon;
//******************************************************************************
        #doc
        Устанавливает позицию на объект недвижимости
        #end
        procedure SetPosition(pNewPos : comp);
//******************************************************************************
        #doc
        Перерисовка интерфейса
        #end
        procedure Refresh;
//******************************************************************************
        #doc
        Добавление объекта недвижимости
        #end
        function  doInsertObj(pRltOwner, pOwner : comp) : boolean;
//******************************************************************************
        #doc
        Удаление объекта недвижимости
        #end
        function  doDeleteObj(pObj : comp) : boolean;
//******************************************************************************
        #doc
        Сохранение изменений по объекту недвижимости
        #end
        function  doUpdateObj: boolean;
//******************************************************************************
        #doc
        Событие - возникает после добавления объекта недвижимости
        #end
  event procedure AfterInsertObj(pOwner, pObj : comp; wVidObj : word; sName : string);
//******************************************************************************
        #doc
        Событие - возникает после модификации объекта недвижимости
        #end
  event procedure AfterUpdateObj(pRltOwner, pObj : comp; wVidObjOwner, wVidObj : word; sName : string);
//******************************************************************************
        #doc
        Событие - возникает для позиционирования в иерархии объектов после модификации объекта недвижимости
        #end
  event procedure SetOwnerPosition(pRltOwner, pObj : comp; wVidObjOwner, wVidObj : word);
//******************************************************************************
end;

VipInterface RltMainObjCommon implements tRltMainObjCommon licensed (FREE);
public:
//******************************************************************************
  #doc
  Идентификатор основной закладки ('Основная информация') объекта недвижимости
  #end
  function  GetMainFormat : longint;
//******************************************************************************
  #doc
  Переустановка позиции на объект недвижимости
  #end
  procedure ReSetPosition;
//******************************************************************************
  #doc
  Конструктор по умолчанию
  #end
  Constructor Init;
//******************************************************************************
  #doc
  Конструктор для объекта недвижимости
  #end
  Constructor InitRltObj(wTable: word);
end;

#end //__RLTMAINOBJECTS_VIH__
