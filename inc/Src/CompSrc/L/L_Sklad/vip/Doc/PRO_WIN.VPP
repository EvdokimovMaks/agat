//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - логистика - склад - ордера
// окно со списком складских ордеров
//******************************************************************************

#ifNdef pro_win2
Panel ProSklOrder
#else
Panel Pro2SklOrder
#end

  Show at (, , , 10)
  Table SklOrder;

#ifNdef pro_win2
#ifndef _KartStor_VIP_
Browse ProSklOrder ('<Enter> - редактирование', , sci178EnEscIns1) //sci178EnEsc)
#end
#else
Browse Pro2SklOrder ('', , sci1EnEscInsPM)
#end

Fields

#ifdef pro_win2
{Font = {Color = if (pickOrder_Regim AND IsValid(#PickSklOrder), ColorMark, 0) }};
  PickSklOrderMark 'V'            : [ 1], skip, Centered, NoAutoSize;
#else
#ifndef _KartStor_VIP_
{Font = {Color = if (IsValid(#PickSklOrder1), ColorMark, 0) }};
  if(isValid(#PickSklOrder1), 'V', '') 'V' : [ 1], skip, Centered, NoAutoSize;
#end
#end
  Tord            'Тип'          : [ 3], skip, Centered, NoAutoSize;
  SklOrder.DesGr  'Группа'       : [ 5], protect, NoAutoSize;
  SklOrder.Descr  'Дескр.'       : [ 5], protect, NoAutoSize;
  SklOrder.NOrder '№ ордера'     : [ 8], protect, NoAutoSize;
  SklOrder.dOrd   'Дата ордера'  : [11, 'DD/MM/YYYY'], protect, Centered, NoAutoSize;
  SDocNumber      'Накладная'    : [12], protect, NoAutoSize;
  KatPodr.Name    'Подразделение': [35], protect;
  KatMOL.Name     'МОЛ'          : [25], protect;
#AddFieldArchiveToBrowseDop
#AddFieldPrincipalIntegratorToBrowseDop
end; //Browse
end; // Panel


//********************************************************************************
#ifNdef pro_win2
Panel ProSpecif
#else
Panel Pro2Specif
#end
  Show at (, 11, , 21)
  Table SpOrder;

#ifNdef pro_win2
Browse ProbrSbOrder ('<Enter> - редактирование', , sci1Esc)
#else
Browse Pro2brSbOrder ('', , sci1Esc)
#end
Fields
  SpOrder.npp      '№'                  : [ 3], skip, NoAutoSize;
  KatMC.Name       'Наименование МЦ'    : [25], protect;
  KatMC.barKod     'Номенкл.номер'      : [14], protect, NoAutoSize;
  SpOrder.kol      'Количество'         : [12], [prSignsInKol, '\3p[|-]36`666`666`666`666.888'], skip, NoAutoSize;
  SpOrder.ostatok  'Остаток'            : [12], [prSignsInKol, '\3p[|-]36`666`666`666`666.888'], skip, NoAutoSize;
  SpOrder.ostatokN 'Остаток для НУ': [13], [prSignsInKol, '\3p[|-]36`666`666`666`666.888'], skip, NoAutoSize;
  EdIzm            'ЕдИзм'              : [ 5], skip, NoAutoSize;
  #include DEIskl_3b.vpp
  SpOrder.RSrPrice 'Цена'               : [17], [brForSpOrder_Price, '\2p[|-]36`666`666`666`666.88'], skip, NoAutoSize;
  SpOrder.SrPrice  'Сумма переоценки'   : [17], [brForSpOrder_Price, '\2p[|-]36`666`666`666`666.88'], skip, NoAutoSize;
  KatParty.Name    'Партия'             : [15], skip;
  SmetaMy          'Смета'              : [15], Skip, NoAutoSize;
  SmetaSpMy        'Спецификация сметы' : [18], Skip, NoAutoSize;
  PlJobName        'План работ'         : [20], Skip, Protect;
end; //Browse
end;//Panel

HandleEvent //Panel
cmHotKeys:
  {
    if CurTable = #SpOrder
      PutHotCommand(RunMenu('SpOrderView_HotKeys'));
  }

cmCalc:
  {
    oSerialMove.SetSerialForOrder(SpOrder.nRec, true, false);
  }
end;

//********************************************************************************
//********************************************************************************

// ввод и корректировка проводок

#ifNdef pro_win2
Embedded embEditOborot 'Проводки по типовой хозяйственной операции к документу.' Interface iSyncOborot.wnView;  // так как vpp-шка дважды вызывается
#else
Embedded embViewOborot 'Проводки по типовой хозяйственной операции к документу.' Interface iSyncOborot.wnView;
#end
  Show at(, 22, , 27);
End;
//********************************************************************************
//********************************************************************************

#ifNdef pro_win2
Panel PropnInfo
#else
Panel Pro2pnInfo
#end
  Table SklOrder;

#ifNdef pro_win2
Screen ProscInfo ('', , sci178Esc)
#else
Screen Pro2scInfo ('', , sci178Esc)
#end

  Show at (, 28, , ) fixed_y;

Fields
  tOrdStr          : skip   , {font = {bold   = TRUE}};
  AttrValP.vString : protect, {font = {italic = TRUE}};
  sFldCountAndSum  : skip   , {font = {italic = TRUE}};
<<
 .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Примечание:.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
>>
end; // Screen


//******************************************************************************

HandleEvent //Panel PropnInfo

cmIdle:
  OrdScan;

cmPositionChanged:
{
  OrdScanClear;

  if (SpOrder.VidOrder = 1)
    ToggleFieldVisible(#SpOrder.SrPrice, FALSE)
  else
    {
      ToggleFieldVisible(#SpOrder.SrPrice,      isDoocen);
      ToggleFieldVisible(#SpOrder.rSrPrice, not isDoocen);
    }
}

end; // HandleEvent
end; // Panel
//********************************************************************************
