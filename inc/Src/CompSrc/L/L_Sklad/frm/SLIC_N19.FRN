/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1987,98 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Оперативный контур                                        ║
 ║ Версия        : 5.50                                                      ║
 ║ Назначение    : Сличительная ведомость ИНВ № 19                           ║
 ║ Ответственный : Глушаков Дмитрий Сергеевич                                ║
 ║ Параметры     : нет                                                       ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#doc
ИНВ № 19
#end
.linkform 'SLIC_SKL_n19_2' prototype is 'InvVed'
!.nameInList 'Сличительная ведомость результатов инвентаризации ТМЦ № 19'
.nameInList 'ИНВ № 19'
.group 'Сличительные ведомости (Беларусь)'
.group 'Сличительные ведомости'
#FeeSigners_Os_LinkVar
#FeeSIgners_Os_LinkInit(PrintPereo)
.var
  i, ipt, pkol, pkol2 : integer;
  pcon                : integer;
  pkoli, pkoln        : double;
  psumi, psumn        : double;
  it1, it2, it3, it4  : double;
.endvar
.create view slic_log1
  as select
    KatOrg.Name, KatOrg.OKPO
  from
    KatOrg              (ReadOnly)
  where
    ((
      coGetTune('MyOrg') == KatOrg.nRec
    ))
;
#include FrmDopFunc.frn
.fields
    CommonFormHeader
    if (SLIC_LOG1.GetFirst KatOrg = 0, SLIC_LOG1.KatOrg.Name, '')
    if (SLIC_LOG1.GetFirst KatOrg = 0, SLIC_LOG1.KatOrg.OKPO, '')
    склад
    номер_приказа
    if(дата_приказа = Date(0,0,0), '', DateToStr(дата_приказа, 'DD/MM/YYYY'))
    дата_инвентаризации
    if(дата_окончания_инв = Date(0,0,0), '', DateToStr(дата_окончания_инв, 'DD/MM/YYYY'))
    номер_инвентаризации
    'true' : 's'
.endfields
.begin
  i    := 0;
  pkol := 0;
  it1  := 0;
  it2  := 0;
  it3  := 0;
  it4  := 0;
  pcon := 0;
end.
.p 50
.defo landscape
^


 Ш
.{?Internal; wGetTune('Country') = 0
                                                                                                                                                                        Унифицированная форма № ИНВ-19
                                                                                                                                                                        Утверждена постановлением Госкомстата
                                                                                                                                                                        России от 18.08.98 № 88
.}
                                                                                                                                                                                       ┌─────────────────────┐
                                                                                                                                                                                       │         Код         │
                                                                                                                                                                                       ╠═════════════════════╣
                                                                                                                                                                        Форма по ОКУД  ║       0317017       ║
                                                                                                                                                                                       ╟─────────────────────╢
       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  по ОКПО  ║@~@@@@@@@@@@@@@@@@@@@║
       ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ╟─────────────────────╢
       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  ║                     ║
       ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╫─────────────────────╢
                                                                               структурное подразделение                                                             Вид деятельности  ║                     ║
                                                                                                                                                                             ┌─────────╫─────────────────────╢
                                                 Основание для проведения инвентаризации:                        приказ, постановление, распоряжение                         │  номер  ║&~&&&&&&&&&&&&&&&&&& ║
                                                                                          ───────────────────────────────────────────────────────────────────────────────────┼─────────╫─────────────────────╢
                                                                                                                         ненужное зачеркнуть                                 │   дата  ║@~@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                             └─────────╫─────────────────────╢
                                                                                                                                                           Дата начала инвентаризации  ║@~@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                                       ╟─────────────────────╢
                                                                                                                                                        Дата окончания инвентаризации  ║@~@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                                       ╟─────────────────────╢
                                                                                                                                                                         Вид операции  ║                     ║
                                                                                                                                                                                       ╚═════════════════════╝
                                                                                                                                              ┌────────────────────┬────────────────────┐
                                                                                                                                              │  Номер документа   │  Дата составления  │
                                                                                                                                              ╠════════════════════╪════════════════════╣
                                                                                 БС Л И Ч И Т Е Л Ь Н А Я   В Е Д О М О С Т Ь Б                   ║ &~&&&&&&&&&&&&&&&& │                    ║
                                                                                                                                              ╚════════════════════╧════════════════════╝
                                                                          Брезультатов инвентаризации товарно-материальных ценностей Б

             Проведена инвентаризация фактического наличия ценностей, находящихся на ответственном хранении


                  ___________________________________________     _____________________________________________________________________________________________________________________________________
                                   должность                                                                             фамилия, имя, отчество
                  ___________________________________________     _____________________________________________________________________________________________________________________________________
                                   должность                                                                             фамилия, имя, отчество

             по состоянию на  "_____" ________________________  _________ г.

             При инвентаризации установлено следующее: Ш
^
.fields
      pkol
      if(мц_название='','',string(i))
      мц_название +' '+if(партия<>'', '(' +партия+ ')', '')
      мц_код : 'p:r'
      ед_код
      ед_измерения
       // излишек
      if(кол_программно-кол_инвентаризации<0,
         DoubleToStr(кол_инвентаризации-кол_программно, '[|-]3666`666`666`666`666'+sKolZnak),
         '' )
      if(кол_программно-кол_инвентаризации<0,
         DoubleToStr(RoundSum((кол_инвентаризации-кол_программно)*цена_излишек, wRoundSum, Сум_число_знаков), '[|-]3666`666`666`666`666'+sKolZnakS),
         DoubleToStr(0, '6'+sKolZnakS))

       // недостача
      if(кол_программно-кол_инвентаризации>0,
         DoubleToStr(кол_программно-кол_инвентаризации, '[|-]3666`666`666`666`666'+sKolZnak),
         '' )
      if(кол_программно-кол_инвентаризации>0,
         DoubleToStr(RoundSum((кол_программно-кол_инвентаризации)*цена_недостача, wRoundSum, Сум_число_знаков), '[|-]3666`666`666`666`666'+sKolZnakS),
         DoubleToStr(0, '6'+sKolZnakS))
.endfields
.{
.[h OverWrite
.begin
  pkoli := 0;
  pkoln := 0;
  psumi := 0;
  psumn := 0;
  pkol  += 2;
  if pcon < 3 pcon++;
end.
 Ш                                                                                                                                                                                      &&-я страница формы № ИНВ-19 Ш

.{?Internal; wGetTune('Country') = 0
 Ш
┌───┬─────────────────────────────────────────────┬───────────────────┬───────────────────┬─────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────┐
│   │        Товарно-материальные ценности        │ Единица измерения │      Номер        │                Результаты инвентаризации                │       Отрегулировано за счет уточнения записей в учете      │
│   ├───────────────────────────────┬─────────────┼────────┬──────────┼────────┬──────────┼────────────────────────────┬────────────────────────────┼──────────────────────────────┬──────────────────────────────┤
│ № │         наименование,         │     код     │        │          │        │ паспорта │          излишек           │         недостача          │            излишек           │           недостача          │
│п/п│        характеристика         │   (номен-   │ код по │ наимено- │ инвен- │(документа├────────────┬───────────────┼────────────┬───────────────┼──────┬─────────┬─────────────┼──────┬─────────┬─────────────┤
│   │      (вид, сорт, группа)      │  клатурный  │  ОКЕИ  │  вание   │ тарный │  о ре-   │ количество │     сумма,    │ количество │     сумма,    │ коли-│  сумма, │номер счета, │ коли-│  сумма, │номер счета, │
│   │                               │    номер)   │        │          │        │гистрации)│            │   руб. коп.   │            │   руб. коп.   │чество│руб. коп.│статьи,заказа│чество│руб. коп.│статьи,заказа│
├───┼───────────────────────────────┼─────────────┼────────┼──────────┼────────┼──────────┼────────────┼───────────────┼────────────┼───────────────┼──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤
│ 1 │               2               │      3      │   4    │     5    │    6   │     7    │     8      │       9       │     10     │      11       │  12  │   13    │     14      │  15  │   16    │     17      │
├───┼───────────────────────────────╬═════════════╪════════╬──────────╬════════╪══════════╪════════════╪═══════════════╪════════════╪═══════════════╬──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤ Ш
.}
.{?Internal; wGetTune('Country') <> 0
 Ш
┌───┬─────────────────────────────────────────────┬───────────────────┬───────────────────┬─────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────┐
│   │        Товарно-материальные ценности        │ Единица измерения │      Номер        │                Результаты инвентаризации                │       Отрегулировано за счет уточнения записей в учете      │
│   ├───────────────────────────────┬─────────────┼────────┬──────────┼────────┬──────────┼────────────────────────────┬────────────────────────────┼──────────────────────────────┬──────────────────────────────┤
│ № │         наименование,         │     код     │        │          │        │ паспорта │          излишек           │         недостача          │            излишек           │           недостача          │
│п/п│        характеристика         │   (номен-   │ код по │ наимено- │ инвен- │(документа├────────────┬───────────────┼────────────┬───────────────┼──────┬─────────┬─────────────┼──────┬─────────┬─────────────┤
│   │      (вид, сорт, группа)      │  клатурный  │  ОКЕИ  │  вание   │ тарный │  о ре-   │ количество │     сумма     │ количество │     сумма     │ коли-│  сумма  │номер счета, │ коли-│  сумма  │номер счета, │
│   │                               │    номер)   │        │          │        │гистрации)│            │               │            │               │чество│         │статьи,заказа│чество│         │статьи,заказа│
├───┼───────────────────────────────┼─────────────┼────────┼──────────┼────────┼──────────┼────────────┼───────────────┼────────────┼───────────────┼──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤
│ 1 │               2               │      3      │   4    │     5    │    6   │     7    │     8      │       9       │     10     │      11       │  12  │   13    │     14      │  15  │   16    │     17      │
├───┼───────────────────────────────╬═════════════╪════════╬──────────╬════════╪══════════╪════════════╪═══════════════╪════════════╪═══════════════╬──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤ Ш
.}
.]h
.if flagParty
.{
.begin
  i++;

  pkoli += if((кол_программно - кол_инвентаризации) < 0,
              кол_инвентаризации - кол_программно, double(0));
  pkoln += if((кол_программно - кол_инвентаризации) > 0,
              кол_программно - кол_инвентаризации, double(0));
  psumi += if((кол_программно-кол_инвентаризации)<0,
              (кол_инвентаризации-кол_программно)*цена_излишек,
              double(0)) ;
  psumn += if((кол_программно-кол_инвентаризации)>0,
              (кол_программно-кол_инвентаризации)*цена_недостача,
              double(0)) ;
end.
 Ш│&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@│@@@@@@@@║@@@@@@@@@@║        │          │&#&&&&&&&&&&│&#&&&&&&&&&&&&&│&#&&&&&&&&&&│&#&&&&&&&&&&&&&║      │         │             │      │         │             │ Ш
.}
.end
.[f
.begin
  if pcon < 3 pcon++;
  it1 += pkoli;
  it2 += psumi;
  it3 += pkoln;
  it4 += psumn;
end.
.fields
  if(pkoli > 0, DoubleToStr(pkoli, '[|-]3666`666`666`666`666' + sKolZnak), '')
  DoubleToStr(RoundSum(psumi, wRoundSum, Сум_число_знаков), '[|-]3666`666`666`666`666'+sKolZnakS)
  if(pkoln > 0, DoubleToStr(pkoln, '[|-]3666`666`666`666`666' + sKolZnak), '')
  DoubleToStr(RoundSum(psumn, wRoundSum, Сум_число_знаков), '[|-]3666`666`666`666`666'+sKolZnakS)
.endfields
 Ш└───┴───────────────────────────────╩═════════════╧════════╩──────────╩════════╧══════════╪════════════╪═══════════════╪════════════╪═══════════════╬──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤
                                                                                    БИтого Б  │ Б&#&&&&&&&&&& Б│ Б&#&&&&&&&&&&&&& Б│ Б&#&&&&&&&&&& Б│ Б&#&&&&&&&&&&&&& Б│      │         │             │      │         │             │
                                                                                          └────────────┴───────────────┴────────────┴───────────────┴──────┴─────────┴─────────────┴──────┴─────────┴─────────────┘

                  Бухгалтер          _________________________________    _______________________________________________________________________________
                                                  подпись                                             расшифровка подписи Ш
.]f
.}
.{?Internal; pcon > 2
.fields
  if(it1 > 0, DoubleToStr(it1, '[|-]3666`666`666`666`666' + sKolZnak), '')
  DoubleToStr(RoundSum(it2, wRoundSum, Сум_число_знаков), '[|-]3666`666`666`666`666'+sKolZnakS)
  if(it3 > 0, DoubleToStr(it3, '[|-]3666`666`666`666`666' + sKolZnak), '')
  DoubleToStr(RoundSum(it4, wRoundSum, Сум_число_знаков), '[|-]3666`666`666`666`666'+sKolZnakS)
.endfields
 Ш
                                                                                          ┌────────────┬───────────────┬────────────┬───────────────┬──────┬─────────┬─────────────┬──────┬─────────┬─────────────┐
                                                                                    БВсего Б  │ Б&#&&&&&&&&&& Б│ Б&#&&&&&&&&&&&&& Б│ Б&#&&&&&&&&&& Б│ Б&#&&&&&&&&&&&&& Б│      │         │             │      │         │             │
                                                                                          └────────────┴───────────────┴────────────┴───────────────┴──────┴─────────┴─────────────┴──────┴─────────┴─────────────┘ Ш
.}
.begin
  ipt   := 0;
  pkol2 := 1;
end.
.fields
  'true' : 's'
.endfields
^
.{While(ipt<i)
.[h OverWrite
.begin
  pkol2 += 2;
end.
.fields
  pkol2
.endfields
 Ш                                                                                                                                                                                       &&-я страница формы № ИНВ-19
┌─────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────┐
│                                         Пересортица                                         │ Приходуются окончательные излишки    │                          Окончательные недостачи                            │
├──────────────────────────────────────────────┬──────────────────────────────────────────────┼────────────┬────────────┬────────────┼─────────────────────────┬─────────────────────────┬─────────────────────────┤
│    излишки, зачтенные в покрытие недостач    │         недостачи, покрытые излишками        │            │            │            │                         │                         │                         │
├────────────┬──────────────┬──────────────────┼────────────┬──────────────┬──────────────────┤ количество │   сумма,   │   номер    ├────────────┬────────────┼────────────┬────────────┼────────────┬────────────┤
│ количество │    сумма,    │ порядковый номер │ количество │    сумма,    │ порядковый номер │            │  руб. коп. │   счета    │ количество │   сумма,   │ количество │   сумма,   │ количество │   сумма,   │
│            │   руб. коп.  │зачтенных излишков│            │   руб. коп.  │зачтенных излишков│            │            │            │            │  руб. коп. │            │  руб. коп. │            │  руб. коп. │
├────────────┼──────────────┼──────────────────┼────────────┼──────────────┼──────────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┤
│     18     │      19      │        20        │     21     │      22      │        23        │     24     │     25     │     26     │     27     │     28     │     29     │     30     │     31     │     32     │
├────────────┼──────────────┼──────────────────┼────────────┼──────────────┼──────────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┤ Ш
.]h
.begin
  ipt++;
end.
 Ш│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │ Ш
.[f
.fields
  Долж_МОЛ
  мол
.endfields
 Ш└────────────┴──────────────┴──────────────────┴────────────┴──────────────┴──────────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┘
  С результатами сличения ознакомлен:
            Материально ответственное(ые) лицо(а)   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е  ___________________________    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                               должность                         подпись                                            расшифровка подписи
                                                   _________________________________   ___________________________   _________________________________________________________________________________
                                                               должность                         подпись                                            расшифровка подписи Ш
.]f
.}
.{While (Номер_подписанта < Количество_Членов_комиссии)
.begin
  Номер_подписанта++;
end.
.}
.endform
