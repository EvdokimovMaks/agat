#doc
Сличительные ведомости (Беларусь)
Форма № ИНВ-3 по ОКУД
#end
.linkform 'InvVed_BEL' prototype is 'InvVed'
.group 'Бланки (Беларусь)'
.group 'Сличительные ведомости (Беларусь)'
.group 'Country' subgroup 'Belarus'
.nameInList 'Форма № ИНВ-3 по ОКУД (б)'
.create view invlog
  as select
    KatOrg.Name, KatOrg.OKPO
  from
    KatOrg      (ReadOnly)
  where
    ((
        coGetTune('MyOrg')  ==   KatOrg.nRec
    ))
;
.var
   pnum  : word   // количество строк на старнице
   pkolF : double // 'количество' на странице фактическое
   pkolP : double // 'количество' на странице программно
   psumF : double // 'сумма' на странице фактическая
   psumP : double // 'сумма' на странице программно
   rnum  : word   // количество строк в отчете
   rkolF : double // 'количество' в отчете фактическое
   rkolP : double // 'количество' в отчете программно
   rsumF : double // 'сумма' в отчете фактическая
   rsumP : double // 'сумма' в отчете программно
.endvar
#include FrmDopFunc.frn
.function if01(d_: double): double;
begin
  if01 := if(abs(d_) < GetPresision_forKol,
             if(Признак_описи, d_, 1),
             d_);
end.
.function if02(d_: double): double;
begin
  if02 := if(abs(d_) < GetPresision_forKol, 1, d_);
end.
#CommissionLinkVar
#CommissionLinkInit(PrintPereo)
.fields
    CommonFormHeader
    номер_инвентаризации
    if (invlog.GetFirst KatOrg = 0, invlog.KatOrg.Name, '')
    if (invlog.GetFirst KatOrg = 0, invlog.KatOrg.OKPO, '')
    склад
    номер_приказа
    if(дата_приказа = Date(0,0,0), '', DateToStr(дата_приказа, 'DD mon YYYY г.'))
    дата_инвентаризации:'m:DD mon YYYY г.'
    if(дата_окончания_инв = Date(0,0,0), '', DateToStr(дата_окончания_инв, 'DD mon YYYY г.'))
    Долж_МОЛ
    МОЛ
      rnum : 'p:c'
      мц_название +' '+if(партия<>'', '(партия: ' +партия+ ')','') //: 'd:r'
      мц_код       : /*'d:r',*/'p:r'
      ед_код
      ед_измерения //: 'd:r'
      цена_партии

      if(abs(кол_инвентаризации) >= GetPresision_forKol, DoubleToStr(кол_инвентаризации,'[|-]3666`666`666`666`666'+sKolZnak), '')
      RoundSum(цена_новая * кол_инвентаризации, wRoundSum, Сум_число_знаков)

      DoubleToStr(кол_программно,'[|-]3666`666`666`666`666'+sKolZnak)
      RoundSum(цена_программно * if02(кол_программно), wRoundSum, Сум_число_знаков)
.endfields
.p 60
.defo landscape
.begin
  rnum  := 0;
  rkolF := 0;
  rkolP := 0;
  rsumF := 0;
  rsumP := 0;
end.
^
                             И Н В Е Н Т А Р И З А Ц И О Н Н А Я   О П И С Ь
                              товарноматериальных ценностей № &~&&&&&&&&&&&&&&&& Б
 Ш                                                                                                                                                                                         ╔═══════════════════════╗
                                                                                                                                                                                         ║          Код          ║
                                                                                                                                                                                         ╠═══════════════════════╣
                                                                                                                                                                    Форма ИНВ-3 по ОКУД  ║                       ║
                                                                                                                                                                                         ╟───────────────────────╢
 Предприятие (учреждение) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     по ОКПО  ║@~@@@@@@@@@@@@@@@@@@@@@║
                         ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────              ╟───────────────────────╢
 Структурная единица предприятия (учреждения) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@              ║                       ║
                                             ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────    ┌─────────╫───────────────────────╢
                        Основание для проведения инвентаризации:                           приказ, постановление, распоряжение                                                 │  номер  ║ &~&&&&&&&&&&&&&&&&&&& ║
                                                                 ──────────────────────────────────────────────────────────────────────────────────────────────────────────    ├─────────╫───────────────────────╢
                                                                                                   ненужное зачеркнуть                                                         │   дата  ║ @~@@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                               └─────────╫───────────────────────╢
                                                                                                                                                             Дата начала инвентаризации  ║ @~@@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                                         ╟───────────────────────╢
                                                                                                                                                          Дата окончания инвентаризации  ║ @~@@@@@@@@@@@@@@@@@@@ ║
                                                                                                                                                                                         ╟───────────────────────╢
                                                                                                                                                                           Вид операции  ║                       ║
                                                                                                                                                                                         ╚═══════════════════════╝ Ш
                                         Р А С П И С К А
 Р
 И        К началу проведения инвентаризации все расходные и приходные документы на товарно-материальные ценности сданы в бухгалтерию и все товарно-материальные ценности, поступившие на мою (нашу)
 ответственность, оприходованы, а выбывшие списаны в расход. Ш
 Р Материально ответственное(ые) лицо(а):
 Е@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е __________________________   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
          (должность)                 (подпись)                                   (расшифровка подписи)
  _________________________  __________________________  __________________________________________________________________________
          (должность)                 (подпись)                                   (расшифровка подписи)
 Р
.{
.[h
!OverWrite
.begin
  pnum  := 0;
  pkolF := 0;
  pkolP := 0;
  psumF := 0;
  psumP := 0;
end. // сжатый!
 Ш                                                                                                                                                                                  @np@-я страница формы № ИНВ-3
┌───────┬───────────────────────────────────────────────────────────┬────────────────────────┬─────────────────┬───────────────────────┬────────────────────────────────────┬────────────────────────────────────┐
│       │               Товарно-материальные ценности               │   Единица измерения    │                 │        Номер          │         Фактическое наличие        │   По данным бухгалтерского учета   │
│ Номер ├──────────────────────────────────────────┬────────────────┼───────────┬────────────┤      Цена,      ├──────────┬────────────┼────────────────┬───────────────────┼────────────────┬───────────────────┤
│  по   │            наименование,харак-           │  код (номен-   │   код по  │  наимено-  │      руб.       │  инвен-  │            │                │      сумма,       │                │      сумма,       │
│порядку│              теристика (вид,             │   клатурный    │    ОКЕИ   │   вание    │                 │  тарный  │  паспорта  │   количество   │       руб.        │    количество  │       руб.        │
│       │               сорт, группа)              │     номер)     │           │            │                 │          │            │                │                   │                │                   │
├───────┼──────────────────────────────────────────┼────────────────┼───────────┼────────────┼─────────────────┼──────────┼────────────┼────────────────┼───────────────────┼────────────────┼───────────────────┤
│   1   │                    2                     │       3        │      4    │      5     │         6       │     7    │     8      │        9       │       10          │        11      │         12        │
├───────┼──────────────────────────────────────────╔════════════════╪═══════════╗────────────╔═════════════════╪══════════╪════════════╪════════════════╪═══════════════════╗────────────────┼───────────────────┤ Ш
.]h
.if flagParty
.{
.begin
  rnum++;
  pnum++;

  pkolF += кол_инвентаризации;
  pkolP += кол_программно;
  psumF += цена_новая      * (кол_инвентаризации);
  psumP += цена_программно * if02(кол_программно);

  rkolF += кол_инвентаризации;
  rkolP += кол_программно;
  rsumF += цена_новая      * (кол_инвентаризации);
  rsumP += цена_программно * if02(кол_программно);
end.
 Ш│ @@@@@ │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@@@@│@@@@@@@@@@@║ @@@@@@@@@@@║&&&&&&&&&&&&&&.&&│          │            │&#'&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&.&&║&#'&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&.&&│ Ш
.}
.end
.[f
.fields
  // фактическое количество
  if (abs(pkolF) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(pkolF,'[|-]3666`666`666`666`666'+sKolZnak)),
      '' )
  // фактическая сумма
  RoundSum(psumF, wRoundSum, Сум_число_знаков)
  // программное количество
  if (abs(pkolP) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(pkolP,'[|-]3666`666`666`666`666'+sKolZnak)),
      '' )
  // программная сумма
  RoundSum(psumP, wRoundSum, Сум_число_знаков)

  // количество порядковых номеров прописью
  if (abs(pnum) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(pnum,'\m 4')),
      '' )

  // общее количество единиц фактически прописью
  if (abs(pkolF) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(Round(pkolF,5),'\m 4 целых,\m 5')),
      '' )

  // на сумму фактически прописью
  if (abs(psumF) >= 0.01, MyFrmUpCaseDoubleToStr(doubletostr(RoundSum(round(psumF,2), wRoundSum, Сум_число_знаков),'\m4руб.')) +
    if ((Trunc(RoundSum(Round(psumF,2), wRoundSum, Сум_число_знаков)*100)-Trunc(RoundSum(round(psumF,2), wRoundSum, Сум_число_знаков))*100)>0,
      replace(replace(doubletostr(RoundSum(round(psumF,2), wRoundSum, Сум_число_знаков),', \f\2p5 коп.'), ' сотых', ''), ' сотая', ''), ''), '')
.endfields
 Ш└───────┴──────────────────────────────────────────╚════════════════╧═══════════╝────────────╚═════════════════╧══════════╧════════════╪════════════════╪═══════════════════╝────────────────┼───────────────────┤
                                                                                                                               Итого   │&#'&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&.&&│
                                                                                                                                       └────────────────┴───────────────────┴────────────────┴───────────────────┘ Ш
 Ш  Итого по странице :
                количество порядковых номеров:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                          прописью
                общее количество единиц фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                          прописью
                на сумму фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                          прописью Ш
.]f
.}
.fields
  'true' : 's'
  // количество порядковых номеров (по отчету)
  if (abs(rnum) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rnum,'666`666`666`666`666')),
      '' )
  // фактическое количество (по отчету)
  if (abs(rkolF) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rkolF,'[|-]3666`666`666`666`666'+sKolZnak)),
      '' )
  // фактическая сумма (по отчету)
  RoundSum(rsumF, wRoundSum, Сум_число_знаков)

  // программное количество (по отчету)
  if (abs(rkolP) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rkolP,'[|-]3666`666`666`666`666'+sKolZnak)),
      '' )
  // программная сумма (по отчету)
  RoundSum(rsumP, wRoundSum, Сум_число_знаков)

  // количество порядковых номеров прописью (по отчету)
  if (abs(rnum) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rnum,'\m 4')),
      '' )
  // общее количество единиц фактически прописью (по отчету)
  if (abs(rkolF) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(Round(rkolF,5),'\m 4 целых,\m 5')),
      '' )
  // на сумму фактически прописью (по отчету)
  if (abs(rsumF) >= 0.01, MyFrmUpCaseDoubleToStr(doubletostr(RoundSum(round(RsumF,2), wRoundSum, Сум_число_знаков),'\m4руб.')) +
    if ((Trunc(RoundSum(Round(RsumF,2), wRoundSum, Сум_число_знаков)*100)-Trunc(RoundSum(round(RsumF,2), wRoundSum, Сум_число_знаков))*100)>0,
      replace(replace(doubletostr(RoundSum(round(RsumF,2), wRoundSum, Сум_число_знаков),', \f\2p5 коп.'), ' сотых', ''), ' сотая', ''), ''), '')

.endfields
^
 Ш                                                                                                                                                                            @np@-я страница формы № ИНВ-3
┌───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬──────────────────┬───────────────┬──────────────────┐
│&&&&&& │                                                                                                          Всего по описи    │&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&.&&│
└───────┘                                                                                                                            └───────────────┴──────────────────┴───────────────┴──────────────────┘ Ш
 Р
 И Итого по описи:
                количество порядковых номеров:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                          (прописью)
                общее количество единиц фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                          (прописью)
                на сумму, фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                          (прописью)
.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
 И
 Комиссия в составе:
   Председатель комиссии             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   ________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              должность                    подпись                  расшифровка подписи
.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
   @@@@@@@@@@@@@@@                   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   ________________  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                             должность                     подпись                 расшифровка подписи
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 Члены комиссии:                    _____________________________   ________________   __________________________________
                                             должность                 подпись                 расшифровка подписи
                                    _____________________________   ________________   __________________________________
                                             должность                 подпись                 расшифровка подписи
.}
 И
.fields
  Долж_МОЛ
  МОЛ
.endfields
     Все товарно-материальные ценности, поименованные в настоящей инвентаризационной описи с № _______________ по № _______________ комиссией проверены в натуре в моем (нашем) присутствии и
 внесены в опись, в связи с чем претензий к инвентаризационной комиссии не имею (не имеем). Товарно-материальные ценности, перечисленные в описи, находятся на моем (нашем) ответственном хранении.

     Лицо(а), ответственное(ые) за сохранность товарно-материальных ценностей:

                          Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е  ______________________    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                    (должность)                  (подпись)                                         (расшифровка подписи)

                         _______________________________   ______________________   _____________________________________________________________________________________
                                    (должность)                  (подпись)                                         (расшифровка подписи)

                         _______________________________   ______________________   _____________________________________________________________________________________
                                    (должность)                  (подпись)                                         (расшифровка подписи)

                         "_____" ________________________  _________ г.

Указанные в настоящей описи данные и расчеты проверил: _________________________   __________________   _______________________________________________________________________
                                                             (должность)              (подпись)                                (расшифровка подписи)

                                                      "_____" ________________________  _________ г. Ш
.endform

#doc
Сличительные ведомости
Форма № ИНВ-3 по ОКУД
#end
.linkform 'InvVed_RUR' prototype is 'InvVed'
.group 'Бланки'
.group 'Сличительные ведомости'
.group 'Сличительные ведомости (Беларусь)'
.nameInList 'Форма № ИНВ-3 по ОКУД'
.create view invlog
  as select KatOrg.Name, KatOrg.OKPO from KatOrg (ReadOnly) where (( coGetTune('MyOrg')  ==   KatOrg.nRec ));
.var
   pnum    : word   // количество строк на старнице
   str     : word
   pkolF   : double // 'количество' на странице фактическое
   pkolP   : double // 'количество' на странице программно
   psumF   : double // 'сумма' на странице фактическая
   psumP   : double // 'сумма' на странице программно
   rnum    : word   // количество строк в отчете
   rkolF   : double // 'количество' в отчете фактическое
   rkolP   : double // 'количество' в отчете программно
   rsumF   : double // 'сумма' в отчете фактическая
   rsumP   : double // 'сумма' в отчете программно
   tip_num : word   // тип нумерации
.endvar
#include FrmDopFunc.frn
.function if01(d_: double): double;
begin
  if01 := if(abs(d_) < GetPresision_forKol, if(Признак_описи, d_, 1), d_);
end.
.function if02(d_: double): double;
begin
  if02 := if(abs(d_) < GetPresision_forKol, 1, d_);
end.
#CommissionLinkVar
#CommissionLinkInit(PrintPereo)
.fields
    if (invlog.GetFirst KatOrg = 0, invlog.KatOrg.Name, '')
    if (invlog.GetFirst KatOrg = 0, invlog.KatOrg.OKPO, '')
    склад
    номер_приказа
    if(дата_приказа = Date(0,0,0), '', DateToStr(дата_приказа, 'DD mon YYYY г.'))
    дата_инвентаризации:'m:DD mon YYYY г.'
    if(дата_окончания_инв = Date(0,0,0), '', DateToStr(дата_окончания_инв, 'DD mon YYYY г.'))
    номер_инвентаризации
    Долж_МОЛ
    мол
    'true' : 's'
    str-1
!.{
      rnum : 'p:c'

      Код_группы_налогов_МЦ

      мц_название +' '+if(партия<>'', '(партия: ' +партия+ ')','') //: 'd:r'
      мц_код       : /*'d:r',*/'p:r'
      ед_код
      ед_измерения //: 'd:r'
      цена_партии

      if(abs(кол_инвентаризации) >= GetPresision_forKol, DoubleToStr(кол_инвентаризации, '[|-]3666`666`666`666`666'+sKolZnak), '')
      RoundSum(цена_новая * кол_инвентаризации, wRoundSum, Сум_число_знаков)

      DoubleToStr(кол_программно,'[|-]3666`666`666`666`666'+sKolZnak)
      RoundSum(цена_программно * if02(кол_программно), wRoundSum, Сум_число_знаков)
!.}
.endfields
.p 50
.defo landscape
.begin
  rnum := 0; rkolF := 0; rkolP := 0; rsumF := 0; rsumP := 0; str := word(0FFFFh); tip_num := тип_нум;
end.
 Р.{?Internal; wGetTune('Country') = 0
                                                                                                                                           Унифицированная форма № ИНВ-3
                                                                                                                                           Утверждена постановлением Госкомстата
                                                                                                                                           России от 18.08.98 № 88
.}
                                                                                                                                                          ┌───────────────────────┐
                                                                                                                                                          │         Код           │
                                                                                                                                                          ╠═══════════════════════╣
                                                                                                                                           Форма по ОКУД  ║       0317004         ║
                                                                                                                                                          ╟───────────────────────╢
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  по ОКПО  ║ Б@~@@@@@@@@@@@@@@@@@@@@@ Б║
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ╟───────────────────────╢
                                                                         организация                                                                      ║                       ║
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  ║                       ║
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╫───────────────────────╢
                                                                    структурное подразделение                                           Вид деятельности  ║                       ║
                                                                                                                                                ┌─────────╫───────────────────────╢
                              Основание для проведения инвентаризации:                  приказ, постановление, распоряжение                     │  номер  ║ &~&&&&&&&&&&&&&&&&&&& ║
                                                                       ─────────────────────────────────────────────────────────────────────────┼─────────╫───────────────────────╢
                                                                                                ненужное зачеркнуть                             │   дата  ║@~@@@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                                └─────────╫───────────────────────╢
                                                                                                                              Дата начала инвентаризации  ║ Б@~@@@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                                          ╟───────────────────────╢
                                                                                                                           Дата окончания инвентаризации  ║@~@@@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                                          ╟───────────────────────╢
                                                                                                                                            Вид операции  ║                       ║
                                                                                                                                                          ╚═══════════════════════╝
                                                                                                                                ┌──────────────────┬──────────────────┐
                                                                                                                                │ Номер документа  │ Дата составления │
                                                                                                                                ╠══════════════════╪══════════════════╣
                                                                   И Н В Е Н Т А Р И З А Ц И О Н Н А Я   О П И С Ь              ║ &~&&&&&&&&&&&&&&&│                  ║
                                                                         товарно-материальных ценностей                         ╚══════════════════╧══════════════════╝

 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                         вид товарно-материальных ценностей
 находящиеся
             ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                               в собственности организации, полученные для переработки

                                                                                   Р А С П И С К А

        К началу проведения инвентаризации все расходные и приходные документы на товарно-материальные ценности сданы в бухгалтерию и все товарно-материальные ценности, поступившие
 на мою (нашу) ответственность, оприходованы, а выбывшие списаны в расход.

 Материально ответственное(ые) лицо(а):  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е  ________________________   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                  (должность)                 (подпись)                                       (расшифровка подписи)
                                         ____________________________  ________________________  _____________________________________________________________________________
                                                  (должность)                 (подпись)                                       (расшифровка подписи)

 Произведено снятие фактических остатков ценностей по состоянию на  "_____" ________________________  _________ г.
^
.{
.[h OverWrite
.begin
  str   := str + 1;
  pnum  := 0 ;
  pkolF := 0 ;
  pkolP := 0 ;
  psumF := 0 ;
  psumP := 0 ;
end. //
.{?Internal; tip_num = 1                                                                                                                                                                     сжатый!
.{?Internal; str <= 1
                                                                                                                                                              @np@-я страница формы № ИНВ-3
.}
.{?Internal; str > 1
                                                                                                                                                           Вкладной лист к форме № ИНВ-3 № ^
.}
.}
.{?Internal; tip_num = 0
                                                                                                                                                              @np@-я страница формы № ИНВ-3
.}
.{?Internal; wGetTune('Country') = 0
┌───────┬───────────┬─────────────────────────────────────────┬──────────────────────┬──────────────┬────────────────────┬────────────────────────────────┬────────────────────────────────┐
│       │           │        Товарно-материальные ценности    │  Единица измерения   │              │       Номер        │       Фактическое наличие      │ По данным бухгалтерского учета │
│ Номер │   Счет,   ├──────────────────────────┬──────────────┼──────────┬───────────┤    Цена,     ├─────────┬──────────┼──────────────┬─────────────────┼──────────────┬─────────────────┤
│  по   │  субсчет  │     наименование,харак-  │ код (номен-  │  код по  │ наимено-  │   руб. коп.  │ инвен-  │          │              │     сумма,      │              │     сумма,      │
│порядку│           │       теристика (вид,    │  клатурный   │   ОКЕИ   │  вание    │              │ тарный  │ паспорта │  количество  │    руб. коп.    │  количество  │    руб. коп.    │
│       │           │        сорт, группа)     │    номер)    │          │           │              │         │          │              │                 │              │                 │
├───────┼───────────┼──────────────────────────┼──────────────┼──────────┼───────────┼──────────────┼─────────┼──────────┼──────────────┼─────────────────┼──────────────┼─────────────────┤
│   1   │     2     │              3           │      4       │     5    │     6     │       7      │    8    │    9     │      10      │       11        │      12      │        13       │
├───────┼───────────┼──────────────────────────╔══════════════╪══════════╗───────────╔══════════════╪═════════╪══════════╪══════════════╪═════════════════╗──────────────┼─────────────────┤
.}
.{?Internal; wGetTune('Country') <> 0
┌───────┬───────────┬─────────────────────────────────────────┬──────────────────────┬──────────────┬────────────────────┬────────────────────────────────┬────────────────────────────────┐
│       │           │        Товарно-материальные ценности    │  Единица измерения   │              │       Номер        │       Фактическое наличие      │ По данным бухгалтерского учета │
│ Номер │   Счет,   ├──────────────────────────┬──────────────┼──────────┬───────────┤     Цена     ├─────────┬──────────┼──────────────┬─────────────────┼──────────────┬─────────────────┤
│  по   │  субсчет  │     наименование,харак-  │ код (номен-  │  код по  │ наимено-  │              │ инвен-  │          │              │     сумма       │              │     сумма       │
│порядку│           │       теристика (вид,    │  клатурный   │   ОКЕИ   │  вание    │              │ тарный  │ паспорта │  количество  │                 │  количество  │                 │
│       │           │        сорт, группа)     │    номер)    │          │           │              │         │          │              │                 │              │                 │
├───────┼───────────┼──────────────────────────┼──────────────┼──────────┼───────────┼──────────────┼─────────┼──────────┼──────────────┼─────────────────┼──────────────┼─────────────────┤
│   1   │     2     │              3           │      4       │     5    │     6     │       7      │    8    │    9     │      10      │       11        │      12      │        13       │
├───────┼───────────┼──────────────────────────╔══════════════╪══════════╗───────────╔══════════════╪═════════╪══════════╪══════════════╪═════════════════╗──────────────┼─────────────────┤
.}
.]h
!.{
.if flagParty
.{
.begin
  rnum  := rnum + 1 ;
  pnum  := pnum + 1 ;
  pkolF := pkolF + кол_инвентаризации;
  pkolP := pkolP + кол_программно;
  psumF := psumF + цена_новая * (кол_инвентаризации);
  psumP := psumP + цена_программно * if02(кол_программно);

  rkolF := rkolF + кол_инвентаризации;
  rkolP := rkolP + кол_программно;
  rsumF := rsumF + цена_новая * (кол_инвентаризации);
  rsumP := rsumP + цена_программно * if02(кол_программно);
end.
│ @@@@@ │@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@@│@@@@@@@@@@║ @@@@@@@@@@║&&&&&&&&&&&.&&│         │          │&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&&║&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&&│
.}
.end
.[f
.fields
  // фактическое количество
  if (abs(pkolF) >= GetPresision_forKol,
      DoubleToStr(pkolF,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // фактическая сумма
  RoundSum(psumF, wRoundSum, Сум_число_знаков)

  // программное количество
  if (abs(pkolP) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(pkolP,'[|-]3666`666`666`666`666'+sKolZnak)),
      '' )
  // программная сумма
  RoundSum(psumP, wRoundSum, Сум_число_знаков)

  // количество порядковых номеров прописью
  if (abs(pnum) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(pnum,'\m 4')),
      '' )

  // общее количество единиц фактически прописью
  if (abs(pkolF) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(Round(pkolF,5),'\m 4 целых,\m 5')),
      '' )

  // на сумму фактически прописью
  if (abs(psumF) >= 0.01, MyFrmUpCaseDoubleToStr(doubletostr(RoundSum(round(psumF,2), wRoundSum, Сум_число_знаков),'\m4руб.')) +
    if ((Trunc(RoundSum(Round(psumF,2), wRoundSum, Сум_число_знаков)*100)-Trunc(RoundSum(round(psumF,2), wRoundSum, Сум_число_знаков))*100)>0,
      replace(replace(doubletostr(RoundSum(round(psumF,2), wRoundSum, Сум_число_знаков),', \f\2p5 коп.'), ' сотых', ''), ' сотая', ''), ''), '')
.endfields
└───────┴───────────┴──────────────────────────╚══════════════╧══════════╝───────────╚══════════════╧═════════╧══════════╪══════════════╪═════════════════╝──────────────┼─────────────────┤
                                                                                                                  БИтого Б   │ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│
                                                                                                                         └──────────────┴─────────────────┴──────────────┴─────────────────┘
  Итого по странице :
                а) количество порядковых номеров:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                б) общее количество единиц фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                в) на сумму фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
.]f
.}
.fields
  'true' : 's'
  str + 3   //итого страниц
  // количество порядковых номеров (по отчету)
  if (abs(rnum) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rnum,'666`666`666`666`666')),
      '' )
  // фактическое количество (по отчету)
  if (abs(rkolF) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rkolF,'[|-]3666`666`666`666`666'+sKolZnak)),
      '' )
  // фактическая сумма (по отчету)
  RoundSum(RsumF, wRoundSum, Сум_число_знаков)

  // программное количество (по отчету)
  if (abs(rkolP) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rkolP,'[|-]3666`666`666`666`666'+sKolZnak)),
      '' )
  // программная сумма (по отчету)
  RoundSum(rsumP, wRoundSum, Сум_число_знаков)

  // количество порядковых номеров прописью (по отчету)
  if (abs(rnum) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr((DoubleToStr(rnum,'\m 4'))),
      '' )
  // общее количество единиц фактически прописью (по отчету)
  if (abs(rkolF) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(Round(rkolF,5),'\m 4 целых,\m 5')),
      '' )
  // на сумму фактически прописью (по отчету)
  if (abs(rsumF) >= 0.01, MyFrmUpCaseDoubleToStr(doubletostr(RoundSum(round(RsumF,2), wRoundSum, Сум_число_знаков),'\m4руб.')) +
    if ((Trunc(RoundSum(Round(RsumF,2), wRoundSum, Сум_число_знаков)*100)-Trunc(RoundSum(round(RsumF,2), wRoundSum, Сум_число_знаков))*100)>0,
      replace(replace(doubletostr(RoundSum(round(RsumF,2), wRoundSum, Сум_число_знаков),', \f\2p5 коп.'), ' сотых', ''), ' сотая', ''), ''), '')
.endfields
^
.{?Internal; tip_num = 0
                                                                                                                                                            ^-я страница формы № ИНВ-3
.}
.{?Internal; tip_num = 1
                                                                                                                                                            4-я страница формы № ИНВ-3
.}
┌───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────┬─────────────────┬──────────────┬─────────────────┐
│ Б&&&&&&  Б│                                                                                           Всего по описи       │ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│
└───────┘                                                                                                                └──────────────┴─────────────────┴──────────────┴─────────────────┘

 Итого по описи:
                а) количество порядковых номеров:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                        прописью
                б) общее количество единиц фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                        прописью
                в) на сумму, фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                        прописью
                ____________________________________________________________________________________________________________________________________________________________________________
     Все цены, подсчеты итогов по строкам, страницам и в целом по инвентаризационной описи товарно-материальных ценностей проверены.
.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
 И
 Комиссия в составе:
   Председатель комиссии             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              должность                     подпись                 расшифровка подписи
.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
   @@@@@@@@@@@@@@@                   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                             должность                      подпись                 расшифровка подписи
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 Члены комиссии:                    _____________________________   ________________   __________________________________
                                             должность                 подпись                 расшифровка подписи
                                    _____________________________   ________________   __________________________________
                                             должность                 подпись                 расшифровка подписи
.}
 И
.fields
  Долж_МОЛ
  мол
.endfields
     Все товарно-материальные ценности, поименованные в настоящей инвентаризационной описи с № _______________ по № _______________ комиссией проверены в натуре в моем (нашем) при-
 сутствии и внесены в опись, в связи с чем претензий к инвентаризационной комиссии не имею (не имеем). Товарно-материальные ценности, перечисленные в описи, находятся на моем
 (нашем) ответственном хранении.

     Лицо(а), ответственное(ые) за сохранность товарно-материальных ценностей:

                             Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е   _______________________    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                       должность                       подпись                                          расшифровка подписи

                            _______________________________   _______________________   __________________________________________________________________________________
                                       должность                       подпись                                          расшифровка подписи

                            _______________________________   _______________________   __________________________________________________________________________________
                                       должность                       подпись                                          расшифровка подписи

                            "_____" ________________________  _________ г.

Указаные в настоящей описи данные и расчеты проверил: _______________________   __________________   _________________________________________________________________
                                                             должность                подпись                                расшифровка подписи
                                                      "_____" ________________________  _________ г. Р
.endform



!==============================================================================
!==============================================================================
!==============================================================================
#doc
Сличительные ведомости (Беларусь)
Сличительная ведомость с группировкой по счетам, субсчетам
#end
.linkform 'InvVed_RUR_Kaz' prototype is 'InvVed'
.group 'Бланки (Беларусь)'
.group 'Сличительные ведомости (Беларусь)'
.group 'Бланки'
.group 'Сличительные ведомости'
.nameInList 'Сличительная ведомость с группировкой по счетам, субсчетам'
.defo landscape
.p 50
.create view invlog
  as select
    KatOrg.Name, KatOrg.OKPO
  from
    KatOrg      (ReadOnly)
  where
    ((
        coGetTune('MyOrg')  ==   KatOrg.nRec
    ))
;
.var
   pnum  : word   // количество строк на старнице
   pkolF : double // 'количество' на странице фактическое
   pkolP : double // 'количество' на странице программно
   psumF : double // 'сумма' на странице фактическая
   psumP : double // 'сумма' на странице программно
   rnum  : word   // количество строк в отчете
   rkolF : double // 'количество' в отчете фактическое
   rkolP : double // 'количество' в отчете программно
   rsumF : double // 'сумма' в отчете фактическая
   rsumP : double // 'сумма' в отчете программно

   sSchet : String[20];
.endvar
#include FrmDopFunc.frn
.function if01(d_: double): double;
begin
  if01 := if(abs(d_) < GetPresision_forKol,
             if(Признак_описи, d_, 1),
             d_);
end.
.function if02(d_: double): double;
begin
  if02 := if(abs(d_) < GetPresision_forKol, 1, d_);
end.
#CommissionLinkVar
#CommissionLinkInit(PrintPereo)
.fields
    CommonFormHeader
    if (invlog.GetFirst KatOrg = 0, invlog.KatOrg.Name, '')
    if (invlog.GetFirst KatOrg = 0, invlog.KatOrg.OKPO, '')
    склад
    номер_приказа
    if(дата_приказа = Date(0,0,0), '', DateToStr(дата_приказа, 'DD mon YYYY г.'))
    дата_инвентаризации:'m:DD mon YYYY г.'
    if(дата_окончания_инв = Date(0,0,0), '', DateToStr(дата_окончания_инв, 'DD mon YYYY г.'))
    номер_инвентаризации
    Долж_МОЛ
    мол
    'true' : 's'
.endfields
.begin
  rnum  := 0 ;
  rkolF := 0 ;
  rkolP := 0 ;
  rsumF := 0 ;
  rsumP := 0 ;

  pnum  := 0 ;
  pkolF := 0 ;
  pkolP := 0 ;
  psumF := 0 ;
  psumP := 0 ;

  sSchet := '???';
end.
^
 Р                                                                                                                                                    ┌─────────────────────┐
                                                                                                                                                    │         Код         │
                                                                                                                                                    ╠═════════════════════╣
                                                                                                                                     Форма по ОКУД  ║       0317004       ║
                                                                                                                                                    ╟─────────────────────╢
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  по ОКПО  ║ Б@~@@@@@@@@@@@@@@@@@@@ Б║
 ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ╟─────────────────────╢
                                                                      организация                                                                   ║                     ║
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б  ║                     ║
 ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╫─────────────────────╢
                                                              структурное подразделение                                           Вид деятельности  ║                     ║
                                                                                                                                          ┌─────────╫─────────────────────╢
                        Основание для проведения инвентаризации:                  приказ, постановление, распоряжение                     │  номер  ║ Б&~&&&&&&&&&&&&&&&&&& Б ║
                                                                 ─────────────────────────────────────────────────────────────────────────┼─────────╫─────────────────────╢
                                                                                          ненужное зачеркнуть                             │   дата  ║@~@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                          └─────────╫─────────────────────╢
                                                                                                                        Дата начала инвентаризации  ║ Б@~@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                                    ╟─────────────────────╢
                                                                                                                     Дата окончания инвентаризации  ║@~@@@@@@@@@@@@@@@@@@ Б ║
                                                                                                                                                    ╟─────────────────────╢
                                                                                                                                      Вид операции  ║                     ║
                                                                                                                                                    ╚═════════════════════╝
                                                                                                                          ┌──────────────────┬──────────────────┐
                                                                                                                          │ Номер документа  │ Дата составления │
                                                                                                                          ╠══════════════════╪══════════════════╣
                                                             И Н В Е Н Т А Р И З А Ц И О Н Н А Я   О П И С Ь              ║ &~&&&&&&&&&&&&&&&│                  ║
                                                                                                                          ╚══════════════════╧══════════════════╝
                                                             товарно-материальных ценностей

 ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                   вид товарно-материальных ценностей
 находящиеся
             ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                         в собственности организации, полученные для переработки

                                                                             Р А С П И С К А

        К началу проведения инвентаризации все расходные и приходные документы на товарно-материальные ценности сданы в бухгалтерию и все товарно-материальные ценности,
 поступившие на мою (нашу) ответственность, оприходованы, а выбывшие списаны в расход.

 Материально ответственное(ые) лицо(а): Е@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е  ________________________   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                (должность)                 (подпись)                 (расшифровка подписи)
                                         _________________________  ________________________  __________________________________________________________________________
                                                (должность)                 (подпись)                 (расшифровка подписи)

 Произведено снятие фактических остатков ценностей по состоянию на  "_____" ________________________  _________ г. Р
^
.{
.[h OverWrite
 Ш┌───────┬────────────────────┬─────────────────────────────────────────────────────────┬─────────────────────┬──────────────┬────────────────────┬────────────────────────────────┬────────────────────────────────┐ Ш
 Ш│       │                    │              Товарно-материальные ценности              │  Единица измерения  │              │       Номер        │       Фактическое наличие      │ По данным бухгалтерского учета │ Ш
 Ш│ Номер │                    ├───────────────────────────────────────────┬─────────────┼──────────┬──────────┤    Цена,     ├─────────┬──────────┼──────────────┬─────────────────┼──────────────┬─────────────────┤ Ш
 Ш│  по   │  Счет, субсчет     │       наименование, характеристика        │     код     │  код по  │ наимено- │  руб. коп.   │ инвен-  │ паспорта │  количество  │     сумма,      │  количество  │     сумма,      │ Ш
 Ш│порядку│                    │           (вид, сорт, группа)             │             │   ОКЕИ   │  вание   │              │ тарный  │          │              │    руб. коп.    │              │    руб. коп.    │ Ш
 Ш├───────┼────────────────────┼───────────────────────────────────────────┼─────────────┼──────────┼──────────┼──────────────┼─────────┼──────────┼──────────────┼─────────────────┼──────────────┼─────────────────┤ Ш
 Ш│   1   │         2          │                     3                     │      4      │     5    │    6     │      7       │    8    │    9     │      10      │       11        │      12      │        13       │ Ш
 Ш└───────┴────────────────────┴───────────────────────────────────────────┴─────────────┴──────────┴──────────┴──────────────┴─────────┴──────────┴──────────────┴─────────────────┴──────────────┴─────────────────┘ Ш
.]h
.{?Internal; (sSchet = '???')
.begin
  sSchet := Код_группы_налогов_МЦ;
end.
.}  //Internal
.if flagParty
.{
.{?Internal; (sSchet <> Код_группы_налогов_МЦ)
.fields
  sSchet
  // фактическое количество (по cчету, субсчету)
  if (abs(pkolF) >= GetPresision_forKol,
      DoubleToStr(pkolF,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // фактическая сумма (по cчету, субсчету)
  RoundSum(psumF, wRoundSum, Сум_число_знаков)

  // программное количество (по cчету, субсчету)
  if (abs(pkolP) >= GetPresision_forKol,
      DoubleToStr(pkolP,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // программная сумма (по cчету, субсчету)
  RoundSum(psumP, wRoundSum, Сум_число_знаков)
.endfields
 Щ                                                                                                  Итого по cчету, субсчету  @@@@@@@@@@@@@@@@@@@@  &#'&&&&&&&&&&& &#'&&&&&&&&&&&.&& &#'&&&&&&&&&&& &#'&&&&&&&&&&&.&& Щ
.begin
  sSchet := Код_группы_налогов_МЦ;

  pnum  := 0 ;
  pkolF := 0 ;
  pkolP := 0 ;
  psumF := 0 ;
  psumP := 0 ;
end.
.}  //Internal
.begin
  pnum  := pnum + 1 ;
  pkolF := pkolF + кол_инвентаризации;
  pkolP := pkolP + кол_программно;
  psumF := psumF + цена_новая * (кол_инвентаризации);
  psumP := psumP + цена_программно * if02(кол_программно);

  //итоги по всему отчету
  rnum  := rnum + 1 ;
  rkolF := rkolF + кол_инвентаризации;
  rkolP := rkolP + кол_программно;
  rsumF := rsumF + цена_новая * (кол_инвентаризации);
  rsumP := rsumP + цена_программно * if02(кол_программно) ;
end.
.fields
  pnum : 'p:c'

  Код_группы_налогов_МЦ

  мц_название +' '+if(партия<>'', '(партия: ' +партия+ ')','') //: 'd:r'
  мц_код       : /*'d:r',*/'p:r'
  ед_код
  ед_измерения //: 'd:r'
  цена_партии

  if(abs(кол_инвентаризации) >= GetPresision_forKol, DoubleToStr(кол_инвентаризации,'[|-]3666`666`666`666`666'+sKolZnak), '')
  RoundSum(цена_новая * кол_инвентаризации, wRoundSum, Сум_число_знаков)

  DoubleToStr(кол_программно,'[|-]3666`666`666`666`666'+sKolZnak)
  RoundSum(цена_программно * if02(кол_программно), wRoundSum, Сум_число_знаков)
.endfields
 Ш @@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&.&&                      &#'&&&&&&&&&&& &#'&&&&&&&&&&&.&& &#'&&&&&&&&&&& &#'&&&&&&&&&&&.&&  Ш
.}
.end  //if flagParty
.}
.fields
  sSchet
  // фактическое количество (по cчету, субсчету)
  if (abs(pkolF) >= GetPresision_forKol,
      DoubleToStr(pkolF,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )
  // фактическая сумма (по cчету, субсчету)
  RoundSum(psumF, wRoundSum, Сум_число_знаков)

  // программное количество (по cчету, субсчету)
  if (abs(pkolP) >= GetPresision_forKol,
      DoubleToStr(pkolP,'[|-]3666`666`666`666`666'+sKolZnak),
      '' )

  // программная сумма (по cчету, субсчету)
  RoundSum(psumP, wRoundSum, Сум_число_знаков)
.endfields
 Щ                                                                                                  Итого по cчету, субсчету  @@@@@@@@@@@@@@@@@@@@  &#'&&&&&&&&&&& &#'&&&&&&&&&&&.&& &#'&&&&&&&&&&& &#'&&&&&&&&&&&.&& Щ
.fields
  'true' : 's'
  // количество порядковых номеров (по отчету)
  if (abs(rnum) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rnum,'666`666`666`666`666')),
      '' )
  // фактическое количество (по отчету)
  if (abs(rkolF) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rkolF,'[|-]3666`666`666`666`666'+sKolZnak)),
      '' )
  // фактическая сумма (по отчету)
  RoundSum(rsumF, wRoundSum, Сум_число_знаков)

  // программное количество (по отчету)
  if (abs(rkolP) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rkolP,'[|-]3666`666`666`666`666'+sKolZnak)),
      '' )

  // программная сумма (по отчету)
  RoundSum(rsumP, wRoundSum, Сум_число_знаков)

  // количество порядковых номеров прописью (по отчету)
  if (abs(rnum) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(rnum,'\m 4')),
      '' )

  // общее количество единиц фактически прописью (по отчету)
  if (abs(rkolF) >= GetPresision_forKol,
      MyFrmUpCaseDoubleToStr(DoubleToStr(Round(rkolF,5),'\m 4 целых,\m 5')),
      '' )

  // на сумму фактически прописью (по отчету)
  if (abs(rsumF) >= 0.01,
      MyFrmUpCaseDoubleToStr(DoubleToStr(RoundSum(RsumF, wRoundSum, Сум_число_знаков),'\m 4 руб'))+
        if ((Trunc(RoundSum(RsumF, wRoundSum, Сум_число_знаков)*100)-Trunc(RoundSum(RsumF, wRoundSum, Сум_число_знаков))*100)>0,
          DoubleToStr(Trunc(round(RoundSum(RsumF, wRoundSum, Сум_число_знаков),2)*100)-Trunc(round(RoundSum(RsumF, wRoundSum, Сум_число_знаков),2))*100,',\f 4 коп.'),''),
      '' )
.endfields
^
 Ш┌───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────┬─────────────────┬──────────────┬─────────────────┐ Ш
 Ш│ Б&&&&&&  Б│                                                                                                                   Всего по описи       │ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│ Б&#'&&&&&&&&&&&│&#'&&&&&&&&&&&.&& Б│ Ш
 Ш└───────┘                                                                                                                                        └──────────────┴─────────────────┴──────────────┴─────────────────┘ Ш
 Р
 Итого по описи:
                а) количество порядковых номеров:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                б) общее количество единиц фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                в) на сумму, фактически:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                    прописью
                ________________________________________________________________________________________________________________________________________________________________________
     Все цены, подсчеты итогов по строкам, страницам и в целом по инвентаризационной описи товарно-материальных ценностей проверены.
.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
 И
 Комиссия в составе:
   Председатель комиссии             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   ________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              должность                    подпись                  Ф.И.О.
.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
   @@@@@@@@@@@@@@@                   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                             должность                      подпись                 расшифровка подписи
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 Члены комиссии:                    _____________________________   ________________   __________________________________
                                             должность                 подпись                 расшифровка подписи
                                    _____________________________   ________________   __________________________________
                                             должность                 подпись                 расшифровка подписи
.}
 И
.fields
  Долж_МОЛ
  мол
.endfields
     Все товарно-материальные ценности, поименованные в настоящей инвентаризационной описи с № _______________ по № _______________ комиссией проверены в натуре в моем (нашем) при-
 сутствии и внесены в опись, в связи с чем претензий к инвентаризационной комиссии не имею (не имеем). Товарно-материальные ценности, перечисленные в описи, находятся на моем
 (нашем) ответственном хранении.

     Лицо(а), ответственное(ые) за сохранность товарно-материальных ценностей:

                            Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е  _______________________    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е

                                      должность                     подпись                                         расшифровка подписи

                            _____________________________   ______________________   _________________________________________________________________________________
                                      должность                     подпись                                         расшифровка подписи

                            _____________________________   ______________________   _________________________________________________________________________________
                                      должность                     подпись                                         расшифровка подписи

                            "_____" ________________________  _________ г.

Указаные в настоящей описи данные и расчеты проверил: _______________________   __________________   _________________________________________________________________
                                                             должность                подпись                                расшифровка подписи
                                                      "_____" ________________________  _________ г. Р
.endform
