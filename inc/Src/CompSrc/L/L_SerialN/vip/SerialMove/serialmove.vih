//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 8.10 - логистика
// Движение серийных номеров МЦ
//******************************************************************************

#ifNdef __SerialMove_vih__
#define __SerialMove_vih__

#include SetSoprSerialList.vih
//******************************************************************************

#component "L_SerialN"

//******************************************************************************

#doc
Содержит описание методов для работы с серийными номерами
#end
ObjInterface ObjSerialMove;

//******************************************************************************

#doc
Оприходование/списание серийного номера
#end
Function MoveSerial(pSpOrder : comp; bCreate, bInsert : boolean) : boolean;

#doc
Выбор перечня серийных номеров к позиции накладной
#end
Function SetSerialForSopr(pSpSopr : comp; bCreate : boolean) : boolean;

#doc
Выбор перечня серийных номеров к позиции ордера
#end
Function SetSerialForOrder(pSpOrder : comp; bCreate, bR1 : boolean) : boolean;

#doc
Редактирование серийного номера
#end
Function EditSerial(pCardSN : comp; bChange : boolean) : boolean;

#doc
Удаление информации об операции (перед удалением ордера)
#end
Function RemoveHistory(pSpOrder : comp) : boolean;

#doc
Очистка списка серийных номеров для накладной
#end
Function RemoveSpSoprLink(pSpSopr : comp) : boolean;

#doc
Установка статуса серийного номера в значение соответствующее последней операции
#end
Function UpdateSerialHistory(pCardSN : comp) : boolean;

#doc
Создание карточки серийного номера
#end
Function CreateNewSerial(pMC, pPodr, pMOL, pParty : comp; sSerial : string; wShowFlags : word) : comp;

#doc
Возвращает состояние серийного номера
#end
Function GetSerialStatus(pCardSN : comp) : string;

#doc
Устанавливает состояние серийного номера
#end
Function SetSerialStatus(pCardSN : comp; bNewStatus : integer) : boolean;

#doc
Резервирование серийных номеров
#end
Function SetSerialReserved(pcRes : comp; pwObjRes : word; bCreate : boolean) : boolean;

#doc
Снятие резерва серийных номеров
#end
Function ClearSerialReserv(pcRes : comp; pwObjRes : word) : boolean;

#doc
Возвращает true, если изменение разреза накладной разрешено
#end
Function CanChangeRzSopr(pKatSopr, pSpSopr : comp) : boolean;

#doc
Возвращает true, если изменение разреза ордера разрешено
#end
Function CanChangeRzOrder(pSklOrder : comp) : boolean;

#doc
Возвращает true, если удаление накладной разрешено
#end
Function CanDeleteSopr(pKatSopr : comp) : boolean;

/*
#doc
Возвращает true, если удаление позиции разрешено
#end
Function CanDeleteSpSopr(pSpSopr : comp) : boolean;
*/

#doc
Возвращает true, если удаление ордера разрешено
#end
Function CanDeleteOrder(pSklOrder : comp) : boolean;

#doc
Тест на соответствие разреза хранения серийного номера заданному
#end
Function IsRzEqual(pCardSN, pSklad, pMOL : comp) : boolean;

#doc
Возвращает true, если существует достаточное количество серийных номеров доступных к списанию
#end
Function CheckSerialKol(pSklad, pMOL, pMC : comp; plT : longint) : boolean;

#doc
Функция копирования серийных номеров
#end
Function CopySerialCard(pCardSN: comp): boolean;

#doc
Возвращает состояние серийного номера на дату
#end
Function GetStatusOnDate(pCardSN: comp; pDate: date; var pPodr, pMOL, pParty: comp): word;

#doc
Возвращает состояние серийного номера на дату
#end
Function GetStatusOnDateStr(pCardSN: comp; pDate: date; var pPodr, pMOL, pParty: comp): string;

#doc
Оприходование/списание серийного номера по акту на перемещение между объектами
#end
Function AktPeremMoveSerial(pSpOrder : comp; bCreate, bInsert : boolean) : boolean;

#doc
Замена партии для всех серийных номеров к позиции ордера
#end
Function ChangeSpOrderParty(pSpOrder, pParty: comp): boolean;

end;

#doc
Содержит описание методов для работы с серийными номерами
#end
ObjInterface ObjSerialMoveV2(ObjSerialMove);

//******************************************************************************

#doc
Оприходование/списание серийного номера
#end
Function MoveSerialEx(pSpOrder : comp; bCreate, bInsert : boolean; bParamMakeRash : boolean = False) : boolean;

end;

//******************************************************************************

VipInterface ISerialMove implements ObjSerialMoveV2, ISerialListPar licensed (FREE);

//******************************************************************************

#end

//******************************************************************************
