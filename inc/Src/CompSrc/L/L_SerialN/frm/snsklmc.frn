//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 8.1 - Логистика
// Отчет о наличии серийных номеров
//******************************************************************************

#doc
Наличие серийных номеров (сортировка по МЦ)
#end
.Linkform 'snsklmc_txt' prototype is 'snsklrazr'
.defo portrait
.NameInList 'Наличие серийных номеров (сортировка по МЦ)'
.Group 'Сортировка по МЦ'
.Var
  lSubTotal : longint;
  lTotal    : longint;
.Endvar
.begin
 lTotal := 0;
 lSubTotal := 0;
end.

                                        БОтчет о наличии серийных номеров Б

┌────────────┬──────────────┬────────────┬──────────┬─────────────┬─────────────┬────────────┬─────────────────┐
│Наименование│Номенклатурный│  Группа МЦ │ Ед. изм. │Подразделение│     МОЛ     │   Партия   │     Серийный    │
│     МЦ     │     номер    │            │          │             │             │            │       номер     │
├────────────┼──────────────┼────────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────────┤
│      1     │       2      │      3     │     4    │      5      │      6      │      7     │        8        │
└────────────┴──────────────┴────────────┴──────────┴─────────────┴─────────────┴────────────┴─────────────────┘
.{
.{ ?INTERNAL; (lSubTotal > 0)
.begin
 lTotal := lTotal + 1;
 lSubTotal := lSubTotal + 1;
end.
.{?INTERNAL; (not LastRec)
.Fields
 SkladName
 MOLName
 PartyName
 SerialN
.Endfields
                                                     @@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@
.}
.{?INTERNAL; (LastRec)
.Fields
 SkladName
 MOLName
 PartyName
 SerialN
.Endfields
                                                     @@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.}
.{ ?INTERNAL; (lSubTotal = 0)
.begin
 lTotal := lTotal + 1;
 lSubTotal := lSubTotal + 1;
end.
.Fields
 MCName
 MCKod
 GroupMC
 EdIzmAbbr
 SkladName
 MOLName
 PartyName
 SerialN
.Endfields
 @@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@
.}
.{?INTERNAL; (ShowTotal and LastRec)
.Fields
 MCName
 lSubTotal
.Endfields
  БВсего по МЦ  ^:  ^ Б
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.begin
 If (LastRec)
   lSubTotal := 0;
end.
.}
.{?INTERNAL; (ShowTotal)
.Fields
 lTotal
.Endfields
  БИтого серийных номеров:  ^ Б
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.Endform
//******************************************************************************

#doc
Наличие серийных номеров с ОС (сортировка по МЦ)
#end
.Linkform 'snsklmc1_txt' prototype is 'snsklrazr'
.defo landscape
.NameInList 'Наличие серийных номеров с ОС (сортировка по МЦ)'
.Group 'Сортировка по МЦ'
.Var
  lSubTotal : longint;
  lTotal    : longint;
.Endvar
.begin
 lTotal := 0;
 lSubTotal := 0;
end.

                                                                        БОтчет о наличии серийных номеров Б

┌────────────┬──────────────┬────────────┬──────────┬─────────────┬─────────────┬────────────┬─────────────────┬─────────────────┬────────┬───────────┬────────┐
│Наименование│Номенклатурный│  Группа МЦ │ Ед. изм. │Подразделение│     МОЛ     │   Партия   │     Серийный    │ Наименование ОС │Инв.№ ОС│ Заводской │ Статус │
│     МЦ     │     номер    │            │          │             │             │            │       номер     │(вышестоящего ОС)│(вышест)│   номер   │        │
├────────────┼──────────────┼────────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────────┼─────────────────┼────────┼───────────┼────────┤
│      1     │       2      │      3     │     4    │      5      │      6      │      7     │        8        │        9        │   10   │     11    │   12   │
└────────────┴──────────────┴────────────┴──────────┴─────────────┴─────────────┴────────────┴─────────────────┴─────────────────┴────────┴───────────┴────────┘
.{
.{ ?INTERNAL; (lSubTotal > 0)
.begin
 lTotal := lTotal + 1;
 lSubTotal := lSubTotal + 1;
end.
.{?INTERNAL; (not LastRec)
.Fields
 SkladName
 MOLName
 PartyName
 SerialN
 NameOs
 InNum
 ZavNom
 Status
.Endfields
                                                     @@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@ @@@@@@@@@@@ @@@@@@@@
.}
.{?INTERNAL; (LastRec)
.Fields
 SkladName
 MOLName
 PartyName
 SerialN
 NameOs
 InNum
 ZavNom
 Status
.Endfields
                                                     @@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@ @@@@@@@@@@@ @@@@@@@@
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.}
.{ ?INTERNAL; (lSubTotal = 0)
.begin
 lTotal := lTotal + 1;
 lSubTotal := lSubTotal + 1;
end.
.Fields
 MCName
 MCKod
 GroupMC
 EdIzmAbbr
 SkladName
 MOLName
 PartyName
 SerialN
 NameOs
 InNum
 ZavNom
 Status
.Endfields
 @@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@ @@@@@@@@@@@ @@@@@@@@
.}
.{?INTERNAL; (ShowTotal and LastRec)
.Fields
 MCName
 lSubTotal
.Endfields
  БВсего по МЦ  ^:  ^ Б
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.begin
 If (LastRec)
   lSubTotal := 0;
end.
.}
.{?INTERNAL; (ShowTotal)
.Fields
 lTotal
.Endfields
  БИтого серийных номеров:  ^ Б
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.Endform
