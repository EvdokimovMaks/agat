//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 8.1 - Логистика
// Отчет о наличии серийных номеров
//******************************************************************************

#doc
Наличие серийных номеров (сортировка по МОЛ)
#end
.Linkform 'snsklmol_txt' prototype is 'snsklrazr'
.defo portrait
.NameInList 'Наличие серийных номеров (сортировка по МОЛ)'
.Group 'Сортировка по МОЛ'
.Var
  lSubTotal : longint;
  lTotal    : longint;
.Endvar
.begin
 lTotal := 0;
 lSubTotal := 0;
end.

                                      БОтчет о наличии серийных номеров Б

┌─────────────┬─────────────┬────────────┬──────────────┬────────────┬──────────┬────────────┬─────────────────┐
│     МОЛ     │Подразделение│Наименование│Номенклатурный│ Группа МЦ  │ Ед. изм. │   Партия   │     Серийный    │
│             │             │     МЦ     │     номер    │            │          │            │       номер     │
├─────────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼────────────┼─────────────────┤
│      1      │      2      │      3     │       4      │      5     │     6    │      7     │        8        │
└─────────────┴─────────────┴────────────┴──────────────┴────────────┴──────────┴────────────┴─────────────────┘
.{
.{ ?INTERNAL; (lSubTotal > 0)
.begin
 lTotal := lTotal + 1;
 lSubTotal := lSubTotal + 1;
end.
.{?INTERNAL; (not LastRec)
.Fields
 SkladName
 MCName
 MCKod
 GroupMC
 EdIzmAbbr
 PartyName
 SerialN
.Endfields
               @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@
.}
.{?INTERNAL; (LastRec)
.Fields
 SkladName
 MCName
 MCKod
 GroupMC
 EdIzmAbbr
 PartyName
 SerialN
.Endfields
               @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@
───────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.}
.{ ?INTERNAL; (lSubTotal = 0)
.begin
 lTotal := lTotal + 1;
 lSubTotal := lSubTotal + 1;
end.
.Fields
 MOLName
 SkladName
 MCName
 MCKod
 GroupMC
 EdIzmAbbr
 PartyName
 SerialN
.Endfields
 @@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@
.}
.{?INTERNAL; (ShowTotal and LastRec)
.Fields
 MOLName
 lSubTotal
.Endfields
  БВсего по МОЛ  ^:  ^ Б
───────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.begin
 If (LastRec)
   lSubTotal := 0;
end.
.}
.{?INTERNAL; (ShowTotal)
.Fields
 lTotal
.Endfields
  БИтого серийных номеров:  ^ Б
───────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.Endform
//******************************************************************************

#doc
Наличие серийных номеров с ОС (сортировка по МОЛ)
#end
.Linkform 'snsklmol1_txt' prototype is 'snsklrazr'
.defo landscape
.NameInList 'Наличие серийных номеров с ОС (сортировка по МОЛ)'
.Group 'Сортировка по МОЛ'
.Var
  lSubTotal : longint;
  lTotal    : longint;
.Endvar
.begin
 lTotal := 0;
 lSubTotal := 0;
end.

                                                                      БОтчет о наличии серийных номеров Б

┌─────────────┬─────────────┬────────────┬──────────────┬────────────┬──────────┬────────────┬─────────────────┬─────────────────┬────────┬───────────┬────────┐
│     МОЛ     │Подразделение│Наименование│Номенклатурный│ Группа МЦ  │ Ед. изм. │   Партия   │     Серийный    │ Наименование ОС │Инв.№ ОС│ Заводской │ Статус │
│             │             │     МЦ     │     номер    │            │          │            │       номер     │(вышестоящего ОС)│(вышест)│   номер   │        │
├─────────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼────────────┼─────────────────┼─────────────────┼────────┼───────────┼────────┤
│      1      │      2      │      3     │       4      │      5     │     6    │      7     │        8        │        9        │   10   │     11    │   12   │
└─────────────┴─────────────┴────────────┴──────────────┴────────────┴──────────┴────────────┴─────────────────┴─────────────────┴────────┴───────────┴────────┘
.{
.{ ?INTERNAL; (lSubTotal > 0)
.begin
 lTotal := lTotal + 1;
 lSubTotal := lSubTotal + 1;
end.
.{?INTERNAL; (not LastRec)
.Fields
 SkladName
 MCName
 MCKod
 GroupMC
 EdIzmAbbr
 PartyName
 SerialN
 NameOs
 InNum
 ZavNom
 Status
.Endfields
               @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@ @@@@@@@@@@@ @@@@@@@@
.}
.{?INTERNAL; (LastRec)
.Fields
 SkladName
 MCName
 MCKod
 GroupMC
 EdIzmAbbr
 PartyName
 SerialN
 NameOs
 InNum
 ZavNom
 Status
.Endfields
               @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@ @@@@@@@@@@@ @@@@@@@@
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.}
.{ ?INTERNAL; (lSubTotal = 0)
.begin
 lTotal := lTotal + 1;
 lSubTotal := lSubTotal + 1;
end.
.Fields
 MOLName
 SkladName
 MCName
 MCKod
 GroupMC
 EdIzmAbbr
 PartyName
 SerialN
 NameOs
 InNum
 ZavNom
 Status
.Endfields
 @@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@ @@@@@@@@@@@ @@@@@@@@
.}
.{?INTERNAL; (ShowTotal and LastRec)
.Fields
 MOLName
 lSubTotal
.Endfields
  БВсего по МОЛ  ^:  ^ Б
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.begin
 If (LastRec)
   lSubTotal := 0;
end.
.}
.{?INTERNAL; (ShowTotal)
.Fields
 lTotal
.Endfields
  БИтого серийных номеров:  ^ Б
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.Endform
