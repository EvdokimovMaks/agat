
#ifndef _Dogovor_vih_
#define _Dogovor_vih_

#ifdef ComponentVersion
#component "L_DOGOVOR"
#end

#include TDocument.vih
#include TDogovor.vih
#include FltDog.inc       // TFilterDog
#include ExtMenu.vih      // Точки расширения для дополнительного локального меню
#include JournalProbPocDoc.vih
#include MenuMaker.vih

#doc
Содержит описание методов интерфейса договоров
#end
ObjInterface tDogovorObjInterface;
//******************************************************************************
  #doc
  устанавливает позицию на запись пункта календарного плана
  #end
  function SetPosition(pDog: comp): boolean;
//******************************************************************************
  #doc
  удаление текущего пункта календарного плана
  #end
  function DeleteDogovor : word;
//******************************************************************************
  #doc
  формирование соглашения на основе договора
  #end
  function CreateFirstAppDogovor(DBuf: TDogovor; var pNewDog: comp): boolean;
//******************************************************************************
  #doc
  тиражирование договора
  #end
  Function DogovorDuplicator(pDogovor, pOrg: comp): boolean;
//******************************************************************************
end;

#doc
Содержит метод обновления таблицы договоров
#end
ObjInterface tDogovorObjInterfaceV2(tDogovorObjInterface);
  #doc
  обновление договора
  #end
  Function DogovorReDraw(bUpdate : boolean): boolean;
//******************************************************************************
end;

ObjInterface IFilterDog;
  property FilterParameters : TFilterDog read;
end;

VipInterface Dogovor implements TDocument, tDogovorObjInterfaceV2, IMenuMakerParameters, IExtMenu
  licensed(dogovor,stroy,DogUsl)
  Parameters(pVidDog, pTiDk, pDirect, pStatus : word; pDogovor, pRec : comp; FilterDog: IFilterDog = NullRef);
Public:
  function  GetCurTreeBrowse: longint;
  function  GetCurMenu      : string;
  function  GetDopMenu      : string;
  Procedure ChangeZamenFieldsVisible;
  DataStream dsDogovor;
  Function  FilterFldKol : word;
  Procedure SaveFilterInDSK;
  Procedure LoadFilterFromDSK;
  Function  GetFilterRec : TFilterDog;
  Function  CheckDogFilter(buf: type$Dogovor) : boolean;
  procedure SetMyTitle;
  Procedure ResetAllFilterBounds;
  Function  SetFilterBounds : boolean;
  Function  SetDefaultDogovor(var DogBuf: #TDogovor): boolean;
  Procedure ExportMarkerToName(sName : string; bInsCurIfEmpty : boolean);
  Function  sDSK_prefix     : string;
end;

VipInterface U_AbitDogovor (Dogovor);

#end // _Dogovor_vih_