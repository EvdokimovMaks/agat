//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 8.1 - Бухгалтерский контур
// Функции работы с типами документов, входят в TiDkInfo
//------------------------------------------------------------------------------

#ifdef Gal8_1
  #ifdef __TiDkInfoCompile__
    #define __CompileDirVeksl__
  #end
#else
  #define __CompileDirVeksl__
#end

#ifNdef __CompileDirVeksl__
// Раскомментировать, когда разбранчимся с 7.1x
// #warning Нет необходимости больше подключать DirVeksl.vpp
#else

#ifndef __DIRVEKSL_VPP__
#define __DIRVEKSL_VPP__

// ----------------------------------------------------------------------------
// Документы, хранящиеся в таблице AppVeks:
// Акты на прием, передачу и гашение векселей и ценных бумаг
Function isAppVeksDoc(wTip: word): boolean;
{
  case wTip of
    cgDoc_0081,  // Акт на передачу векселей
    cgDoc_0082,  // Акт на гашение собственных векселей
    cgDoc_0083,  // Акт на гашение сторонних векселей
    cgDoc_0084,  // Акт на получение векселей
    cgDoc_0085,  // Акт на передачу ценных бумаг
    cgDoc_0086,  // Акт на гашение собственных ценных бумаг
    cgDoc_0087,  // Акт на гашение сторонних ценных бумаг
    cgDoc_0088:  // Акт на получение ценных бумаг
      isAppVeksDoc := true;
  else
    isAppVeksDoc := false;
  end;
}

// ----------------------------------------------------------------------------
// Акты на прием, передачу и погашение векселей (только)
Function isAppVeks(wTip: word): boolean;
{
  case wTip of
    cgDoc_0081,  // Акт на передачу векселей
    cgDoc_0082,  // Акт на гашение собственных векселей
    cgDoc_0083,  // Акт на гашение сторонних векселей
    cgDoc_0084:  // Акт на получение векселей
      isAppVeks := true;
  else
    isAppVeks := false;
  end;
}

// ----------------------------------------------------------------------------
// Акты на прием, передачу и погашение ЦБ (только)
Function isAppCb(wTip: word): boolean;
{
  case wTip of
    cgDoc_0085,  // Акт на передачу ценных бумаг
    cgDoc_0086,  // Акт на гашение собственных ценных бумаг
    cgDoc_0087,  // Акт на гашение сторонних ценных бумаг
    cgDoc_0088:  // Акт на получение ценных бумаг
      isAppCb := true;
  else
    isAppCb := false;
  end;
}

// ----------------------------------------------------------------------------
// Акты на получение (только)
Function isAppTake(wTip: word): boolean;
{
  case wTip of
    cgDoc_0084,  // Акт на получение векселей
    cgDoc_0088:  // Акт на получение ценных бумаг
      isAppTake := true;
  else
    isAppTake := false;
  end;
}

// ----------------------------------------------------------------------------
// Акты на передачу (только)
Function isAppGive(wTip: word): boolean;
{
  case wTip of
    cgDoc_0081,  // Акт на передачу векселей
    cgDoc_0085:  // Акт на передачу ценных бумаг
      isAppGive := true;
  else
    isAppGive := false;
  end;
}

// ----------------------------------------------------------------------------
// Акты на гашение собсвенных векселей, ц/б (только)
Function isAppOwn(wTip: word): boolean;
{
  case wTip of
    cgDoc_0082,  // Акт на гашение собственных векселей
    cgDoc_0086:  // Акт на гашение собственных ценных бумаг
      isAppOwn := true;
  else
    isAppOwn := false;
  end;
}

// ----------------------------------------------------------------------------
// Акты на гашение сторонних векселей, ц/б (только)
Function isAppExt(wTip: word): boolean;
{
  case wTip of
    cgDoc_0083,  // Акт на гашение сторонних векселей
    cgDoc_0087:  // Акт на гашение сторонних ценных бумаг
      isAppExt := true;
  else
    isAppExt := false;
  end;
}

// ----------------------------------------------------------------------------
// Направление документа
Function AppVeks_GetDirect(wTip: word): word;
{
  case wTip of
    cgDoc_0082,  // Акт на гашение собственных векселей
    cgDoc_0084,  // Акт на получение векселей
    cgDoc_0086,  // Акт на гашение собственных ценных бумаг
    cgDoc_0088:  // Акт на получение ценных бумаг
      AppVeks_GetDirect := cgDirPrihod;
    cgDoc_0081,  // Акт на передачу векселей
    cgDoc_0083,  // Акт на гашение сторонних векселей
    cgDoc_0085,  // Акт на передачу ценных бумаг
    cgDoc_0087:  // Акт на гашение сторонних ценных бумаг
      AppVeks_GetDirect := cgDirRashod;
  else
    AppVeks_GetDirect := cgDirNotDef;
  end;
}

// ----------------------------------------------------------------------------
// По типу документа возвращает тип для NastrV.TiDk
Function GetTiDkForNastrV(wTip: word): word;
{
  GetTiDkForNastrV := 0; // не вексль и не ц/б
  if isAppVeks(wTip)
    GetTiDkForNastrV := 81; // векселя
  else
    if isAppCB(wTip)
      GetTiDkForNastrV := 83; // ц/б
}

// ----------------------------------------------------------------------------
// Название акта // типа 'на гашение собственных векселей'
Function App_GetName(wTip: word): string;
{
  var sMes1, sMes2: string;
  sMes1 := if(isAppGive(wTip), 'передачу',
              if(isAppTake(wTip), 'получение',
                 'гашение ' + if(isAppOwn(wTip), 'собственных', 'сторонних')));
  sMes2 := if(isAppVeks(wTip), 'векселей', 'ценных бумаг');
  App_GetName := 'на ' + sMes1 + ' ' + sMes2;
}

#end // __DIRVEKSL_VPP__
#end // __CompileDirVeksl__
