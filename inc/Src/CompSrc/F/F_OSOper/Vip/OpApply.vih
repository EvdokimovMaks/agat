/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 2004 корпорация ГАЛАКТИКА                         ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Основные средства                                         ║
 ║ Версия        : 5.8                                                       ║
 ║ Назначение    : Проведение и отмена операций ОС/НМА                       ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#ifndef __OPAPPLY_VIH__
#define __OPAPPLY_VIH__

#Component "F_OSOPER"

#doc
Проведение и отмена операций ОС/НМА
#end
ObjInterface oOperApply;
// ---------------------------------------------------------------------------
#doc
  Выполнение операции по методу учета
#end
  // Передаваемые параметры:
  //    pcSpMove - ссылка на операцию в некотором методе учета.
  //               (ссылка на запись в таблице SpMove с которой связаны
  //               хозоперации и проводки)
  //    pbSilent - режим выдачи сообщений:
  //                 true - не выдавать (например для пакетных режимов),
  //                 false - выдавать.
  procedure DoSpMove( pcSpMove : comp; pbSilent : boolean );
// ---------------------------------------------------------------------------
#doc
  Откат операции
#end
  // Передаваемые параметры:
  //    pcSpMove - ссылка на операцию в некотором методе учета.
  //               (ссылка на запись в таблице SpMove с которой связаны
  //               хозоперации и проводки)
  procedure UndoSpMove( pcSpMove : comp );
// ---------------------------------------------------------------------------
#doc
  Перепроведение операции по всем методам учета
#end
  // Передаваемые параметры:
  //    pcMoveOs - ссылка на операцию.
  //    pbSilent - режим выдачи сообщений:
  //                 true - не выдавать (например для пакетных режимов),
  //                 false - выдавать.
  // procedure RedoMoveOs( pcMoveOs : comp; pbSilent : boolean );
  procedure RedoMoveOs( pcMoveOs : comp; pbSilent : boolean; _wList : word = cgPick_KatOs127 );

// ---------------------------------------------------------------------------
#doc
  Получить дату операции частичного перемещения, в результате которой создана новая карточка
#end
  Function GetDateCreateNewKatOS(pcKatOS : comp) : date;

  Procedure Init(_wTiDk: word);

  #doc
  Контроль привязки ТХО в операциях поступления перед проведением любой другой операции
  #end
  Function ControlLinkedTXObyPost(pcMoveOs, pcNastrOS: comp; var pwModeMsg: word) : boolean;

  // Предварительное проведение операции по одному методу
  procedure DoSpMovePrev( _cSpMove : comp; _isMsg : boolean = true; _isUpdateKatOsPrev : boolean = false );
  // Отмена Предварительного проведение операции по одному методу
  procedure UnDoSpMovePrev( _cSpMove : comp; _isUpdateKatOsPrev : boolean = false );


  // Предварительное проведение операции
  Function DoMoveOsPrev( _cMoveOs : comp; _isMsg : boolean = true) : boolean;
  // Предварительное проведение операции
  Function UndoMoveOsPrev( _cMoveOs : comp; _isMsg : boolean = true ) : boolean;

end;

// ---------------------------------------------------------------------------
VipInterface OperApply  implements oOperApply
  Licensed   (Free);


//==============================================================================
#doc
Точка расширения epCanDoOperOS. Вызывается для проверки возможности проведения операций.
</brief>
  Вызывается из интерфейса проведения операций (OperApply) перед  проведением операции.
  Если обработчик точки расширения вернет FALSE, то операция не проводится.
  Параметры:
 <p> _cSpMove - ссылка на SpMove. <br>
#end
ExtensionPoint epCanDoOperOS(_cSpMove: comp);


#end // __OPAPPLY_VIH__
