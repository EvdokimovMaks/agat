//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.1 - Операции по ОС и НМА
// Пакетное проведение операций с ОС и НМА
//------------------------------------------------------------------------------
#ifndef __PICKOPAPPLY_VIH__
#define __PICKOPAPPLY_VIH__

#Component "F_OSOPER"

#doc
Пакетное проведение и отмена операций ОС/НМА
#end
ObjInterface oPickOperApply;
//------------------------------------------------------------------------------
#doc
  Инициализация
#end
  Procedure Init(pwTiDk : word);
//------------------------------------------------------------------------------
#doc
  Установка метода учета
#end
  Procedure SetNastrOs(pcNastrOsNRec : comp);

//------------------------------------------------------------------------------
#doc
  Стать на MoveOs
#end
Function SetMoveOS(_cMoveOS: comp) : boolean;

#doc
  проверяет соответствие полей в карточке и в операции (проверять надо при проведении операции)...
#end
Function CheckIkParams(pcKatOs, pcNastrOS: comp; var boIsChkPodrInMoveOS: boolean; var Out_sMessage : string) : boolean;

//------------------------------------------------------------------------------
#doc
  Проверка ИК из спецификации операции, по которым проведение операции запрещено
#end
  Function CheckSpMoveOS(pcMoveOS: comp; pbDoMove: boolean) : boolean;
//------------------------------------------------------------------------------
#doc
  Проведение одной операции ОС/НМА
#end
  Function DoOneApplyMoveOS(pcMoveOS: comp; pwParam: word) : boolean;
//------------------------------------------------------------------------------
#doc
  Проведение выбранных операцй ОС/НМА
#end
  Procedure DoPickMoveOS(pcMoveOS: comp; psMrkMoveOS: string; pwParam : word);
//------------------------------------------------------------------------------
#doc
  Отмена проведение одной операции ОС/НМА
#end
  Function UndoOneApplyMoveOS(pcMoveOS: comp; pwParam: word) : boolean;
//------------------------------------------------------------------------------
#doc
  Отмена проведения выбранных операции ОС/НМА
#end
  Procedure UndoPickMoveOS(pcMoveOS: comp; psMrkMoveOS: string; pwParam : word);
//------------------------------------------------------------------------------
#doc
  Обновление хозоперации и формирование проводок
#end
  Function UpdateSoprHozAndMakeOborot(pwParam: word) : boolean;
//------------------------------------------------------------------------------
#doc
  Запущен ли процесс проведения/отмены проведения по выбранным операциям
#end
  Function CanRunTimePickOpApply(pwTiDk: word) : boolean;
//------------------------------------------------------------------------------
#doc
  Установить семафор процесса проведения/отмены проведения по выбранным операциям
#end
  Function SetSemaphoreOpApply(sNameVisual: string) : boolean;
//------------------------------------------------------------------------------
#doc
  Снять семафор процесса проведения/отмены проведения по выбранным операциям
#end
  Function ClearSemaphoreOpApply : boolean;
//------------------------------------------------------------------------------
#doc
  Актуализация данных в операции на основании данных картотеки
#end
  Function  RefreshDataInMoveOS(pcMoveOS: comp; psMrkMoveOS: string; pwParam: word) : boolean;
//------------------------------------------------------------------------------
end;

ObjInterface oPickOperApplyEx;

#doc
  Проверка на возможность проведения/отмены проведения операции в закрытом периоде
#end
  Function CanDoUndoOperInClosedPeriod(_dDatOb : date; _boSilent : boolean; var _wRes : word) : boolean;

end;

VipInterface PickOperApply Implements oPickOperApply, oPickOperApplyEx
  Licensed   (Free)
;
#end
