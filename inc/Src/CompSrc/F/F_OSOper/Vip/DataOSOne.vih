//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10  - Бухгалтерский контур
// Объект для формирования фоорм ОС-1, ОС-2, ОС-3 и т.д.
//------------------------------------------------------------------------------

#ifndef __DATAOSONE_VIH__
#define __DATAOSONE_VIH__

#component "F_OSOPER"

// в эту таблицу считаем суммы драгметаллов для объектов, у которых общий вышестоящий ОС
Table Struct DragMetForHigher
(
  nRec      : comp,
  Name      : string[100],
  Kod       : s20,
  cKatEd    : comp,
  KatEdName : string[80],
  KatEdAbbr : string[40],
  Sum       : tSumma,
  Method    : string[40],
  Price     : tSumma,
  nn        : word,
  StrMemo   : string[120]
)
with index
(
  Index1 = nRec,
  Index2 = nRec + Method + Price,
  Index3 = nn,
  Index4 = Kod
);

// для печати состава объектов
Table Struct OSSostav
(
  nRec      : comp,
  Name      : string,
  Kol       : tSumma,
  TiDk      : word,
  DatV      : date
)
with index
(
  Index1 = nRec
);

// для печати амортизации
Table Struct OSAmort
(
  nRec      : comp,
  dDate      : date,
  SrokIsp   : tSumma,
  SIznM     : tSumma,
  SumIzn    : tSumma,
  NormaNRec : comp,
  Norma     : tSumma,
  cSpMoveOS : comp,
  SysOper   : word,
  cArcIznos : comp
)
with index
(
  Index1 = nRec,
  Index2 = dDate
);

// для печати операций
Table Struct OSOper
(
  SpMoveOsNRec : Comp,
  SysOper      : Word,
  TipOper      : Word,
  DatOb        : Date,
  DtDoc        : Date,
  cOsnov       : Comp
)
With Index
(
  Index1 = DatOb,
  Index2 = TipOper,
  Index3 = DtDoc
);

#doc
Объект для формирования фоорм ОС-1, ОС-2, ОС-3 и т.д.
#end
ObjInterface IDataOsOne;
//----------------------------------------------------------------------//
//------------------------ Методы интерфейса ---------------------------//
//----------------------------------------------------------------------//
// установка ссылки на таблицы SpMoveOs, KatOs, NastrOs, ArcIznos
function SetSpMoveOs(_cpSpMoveOs : comp) : boolean;

// установка ссылки на таблицу SpMoveOs
function SetParamOper(_cpSpMoveOs : comp) : boolean;

// установка ссылки на таблицу KatOs
function SetKatOs(_cpKatOs : comp) : boolean;

// установка ссылки на таблицу NastrOs
function SetNastrOs(_cpNastrOs : comp) : boolean;

// установка ссылки на таблицу ArcIznos
function SetArcOs(_dArc : date) : boolean;

// установка ссылки на таблицу HigherOs - синоним KatOs для вышестоящего
function SetHigherOs(_cpHighKatOs : comp) : boolean;

// установка ссылки на таблицу KatPodr
function SetOldPodr(_cpOldPodr : comp) : boolean;

// установка ссылки на таблицу KatPodr
function SetNewPodr(_cpNewPodr : comp) : boolean;

// установка ссылки на таблицу KatPodr
function SetOldPodrTr(_cpOldPodrTr : comp) : boolean;

// установка ссылки на таблицу KatPodr
function SetNewPodrTr(_cpNewPodrTr : comp) : boolean;

// получить в таблице DragMetForHigher список драг. металлов для объекта
function GetDragMList(_cpKatOsNalDrag : comp; _wMode : word) : boolean;

// получить в таблице OSSostav список составляющих объекта
function GetOsSostav(_dArcOsMc : date) : boolean;

// получить в таблице OSAmort список всех операций, где изменялась сумма начисления амортизации для объекта
function GetOperIzmAmort(_dBegOper, _dOsAmort : date) : boolean;

// получить в таблице OSAmort список начислений амортизации для объекта
function GetOsAmort(_dBegOper, _dOsAmort : date) : boolean;

// получить в таблице OSOper список проведенных операций для объекта
function GetOsOper(_TipOper : word; _dOSOper : date) : boolean;

// получить должность МОЛ по ссылке
function PersonPost(InPersons : comp) : string;

// получить имя МОЛ по ссылке
function MolName(InMol : comp) : string;

// получить в таблице DragMetForHigher список драг. металлов для объекта на дату
function GetDragMListDate(_cpKatOsNRec : comp; _VidDrag : word; _dOtchPer : date) : boolean;

// получить в таблице DragMetForHigher список драг. металлов для сложного объекта на дату
//pMode = 1 - очистка таблицы DragMetForHigher
function GetDragMListDateForComplObj(_cpKatOsHierNRec : comp; _VidDrag : word; _dOtchPer : date; pMode : word) : boolean;

// получить в таблице OSSostav список составляющих простого/сложного объекта
Function GetFullOsSostav(_dArcOsMc : date) : boolean;

// установка ссылки на план счетов
Function SetPlansSch(_cpPlansSch : comp) : boolean;

//----------------------------------------------------------------------//
//----------------------- Свойства интерфейса --------------------------//
//----------------------------------------------------------------------//
//----------------- Информация о своей организации ---------------------//
  // Своя_организация_Наименование
  Property OwnOrgName:                    string read;

  // Своя_организация_ОКПО
  Property OwnOrgOKPO:                    string read;

  // Своя_организация_УНН
  Property OwnOrgUNN:                     string read;

  // Своя_организация_Адрес
  Property OwnOrgAddr:                    string read;

  // Своя_организация_ТЕЛ
  Property OwnOrgTel:                     string read;

  // Своя_организация_ОКОНХ
  Property OwnOrgOKONH:                   string read;

  // Своя_организация_КПП
  Property OwnOrgKPP:                     string read;

  // Своя_организация_БАНК_Имя
  Property BankOwnOrgName:                string read;

  // Своя_организация_БАНК_Адрес
  Property BankOwnOrgAddr:                string read;

  // Своя_организация_БАНК_Счет
  Property BankOwnOrgSchet:               string read;

  // Своя_организация_БАНК_Счет_в_РКЦ
  Property BankOwnOrgSchetRKC:            string read;

  // Своя_организация_БАНК_Счет_ПДокументов
  Property BankOwnOrgSchetPDoc:           string read;

  // Своя_организация_БАНК_Мфо
  Property BankOwnOrgMFO:                 string read;

  // Своя_организация_БАНК_РКЦ
  Property BankOwnOrgRKC:                 string read;


//----------------- Информация о чужой организации ---------------------//
  // Чужая_организация_Наименование
  Property OrgName:                       string read;

  // Чужая_организация__ОКПО
  Property OrgOKPO:                       string read;

  // Чужая_организация__УНН
  Property OrgUNN:                        string read;

  // Чужая_организация__Адрес
  Property OrgAddr:                       string read;

  // Чужая_организация__ТЕЛ
  Property OrgTel:                        string read;

  // Чужая_организация__ОКОНХ
  Property OrgOKONH:                      string read;

  // Чужая_организация_КПП
  Property OrgKPP:                        string read;

  // Чужая_организация__БАНК_Имя
  Property BankOrgName:                   string read;

  // Чужая_организация__БАНК_Адрес
  Property BankOrgAddr:                   string read;

  // Чужая_организация__БАНК_Счет
  Property BankOrgSchet:                  string read;

  // Чужая_организация__БАНК_Счет_в_РКЦ
  Property BankOrgSchetRKC:               string read;

  // Чужая_организация__БАНК_Счет_ПДокументов
  Property BankOrgSchetPDoc:              string read;

  // Чужая_организация__БАНК_Мфо
  Property BankOrgMFO :                   string read;

  // Чужая_организация__БАНК_РКЦ
  Property BankOrgRKC:                    string read;


//---- Информация о руководителях своей организации в печатных формах -----//
  // Руководитель_nRec
  Property BossNRec:                      comp   read;

  // Руководитель_ФИО
  Property BossName:                      string read;

  // Руководитель_Должность
  Property BossPost:                      string read;

  // Главный_бухгалтер_nRec
  Property MainBuhNRec:                   comp   read;

  // Главный_бухгалтер_ФИО
  Property MainBuhName:                   string read;

  // Главный_бухгалтер_Должность
  Property MainBuhPost:                   string read;

//---- Информация о руководителях чужой организации в печатных формах -----//
  // Чужой_Руководитель_nRec
  Property OrgBossNRec:                   comp   read;

  // Чужой_Руководитель_ФИО
  Property OrgBossName:                   string read;

  // Чужой_Руководитель_Должность
  Property OrgBossPost:                   string read;

  // Чужой_Главный_бухгалтер_nRec
  Property OrgMainBuhNRec:                comp   read;

  // Чужой_Главный_бухгалтер_ФИО
  Property OrgMainBuhName:                string read;

  // Чужой_Главный_бухгалтер_Должность
  Property OrgMainBuhPost:                string read;

//------------------------ Информация о подразделениях --------------------//
  // Структурное_подразделение_текущей_ИК_NRec
  Property KatOsPodrNRec:                 comp read;

  // Структурное_подразделение_текущей_ИК
  Property KatOsPodrName:                 string read;

  // Адрес_структурного_подразделения_текущей_ИК
  Property KatOsPodrAddr:                 string read;

  // Код_структурного_подразделения_текущей_ИК
  Property KatOsPodrKod:                  string read;

  // Вид_деятельности_подразделения_текущей_ИК
  Property KatOsPodrFilialNo:             longint read;

  // Обособленное_подразделение_текущей_ИК_NRec
  Property KatOsPodrTrNRec:               comp read;

  // Обособленное_подразделение_текущей_ИК
  Property KatOsPodrTrName:               string read;

  // Адрес_обособленного_подразделения_текущей_ИК
  Property KatOsPodrTrAddr:               string read;

  // Код_обособленного_подразделения_текущей_ИК
  Property KatOsPodrTrKod:                string read;

  // Вид_деятельности_обособленного_подразделения_текущей_ИК
  Property KatOsPodrTrFilialNo:           longint read;

  // Структурное_подразделение_вышестоящей_ИК_NRec
  Property KatOsHigherPodrNRec:           comp read;

  // Структурное_подразделение_вышестоящей_ИК_Наименование
  Property KatOsHigherPodrName:           string read;

  // Структурное_подразделение_вышестоящей_ИК_Код
  Property KatOsHigherPodrKod:            string read;

  // Обособленное_подразделение_вышестоящей_ИК_NRec
  Property KatOsHigherPodrTrNRec:         comp read;

  // Обособленное_подразделение_вышестоящей_ИК_Наименование
  Property KatOsHigherPodrTrName:         string read;

  // Обособленное_подразделение_вышестоящей_ИК_Код
  Property KatOsHigherPodrTrKod:          string read;

  // Старое_структурное_подразделение_NRec
  Property OldPodrNRec:                   comp read;

  // Старое_структурное_подразделение_наименование
  Property OldPodrName:                   string read;

  // Адрес_старого_подразделения
  Property OldPodrAddr:                   string read;

  // Вид_деятельности_старого_подразделения
  Property OldPodrFilialNo:               longint read;

  // Старое_обособленное_подразделение_NRec
  Property OldPodrTrNRec:                 comp read;

  // Старое_обособленное_подразделение_наименование
  Property OldPodrTrName:                 string read;

  // Адрес_старого_обособленного_подразделения
  Property OldPodrTrAddr:                 string read;

  // Вид_деятельности_старого_обособленного_подразделения
  Property OldPodrTrFilialNo:             longint read;

  // Новое_структурное_подразделение_NRec
  Property NewPodrNRec:                   comp read;

  // Новое_структурное_подразделение_наименование
  Property NewPodrName:                   string read;

  // Адрес_нового_подразделения
  Property NewPodrAddr:                   string read;

  // Вид_деятельности_нового_подразделения
  Property NewPodrFilialNo:               longint read;

  // Новое_обособленное_подразделение_NRec
  Property NewPodrTrNRec:                 comp read;

  // Новое_обособленное_подразделение_наименование
  Property NewPodrTrName:                 string read;

  // Адрес_нового_обособленного_подразделения
  Property NewPodrTrAddr:                 string read;

  // Вид_деятельности_нового_обособленного_подразделения
  Property NewPodrTrFilialNo:             longint read;

  // Структурное_подразделение_текущей_ИК_из_операции
  // если не задано возвращается из карточки
  Property OperPodrName:                  string read;

  // Обособленное_подразделение_текущей_ИК_из_операции
  // если не задано возвращается из карточки
  Property OperPodrTrName:                string read;

  // Вид_деятельности_подразделения_текущей_ИК_из_операции
  // если не задано возвращается из карточки
  Property OperPodrFilialNo:              longint read;

  // Структурное_подразделение_из_архива_ИК_NRec
  Property ArcPodrNRec:                   comp read;

  // Структурное_подразделение_из_архива_ИК
  Property ArcPodrName:                   string read;

  // Адрес_структурного_подразделения_из_архива_ИК
  Property ArcPodrAddr:                 string read;

  // Код_структурного_подразделения_из_архива_ИК
  Property ArcPodrKod:                    string read;

  // Вид_деятельности_подразделения_из_архива_ИК
  Property ArcPodrFilialNo:               longint read;

  // Структурное_подразделение_из_архива_вышестоящей_ИК_NRec
  Property ArcHigherPodrNRec:             comp read;

  // Обособленное_подразделение_из_архива_ИК_NRec
  Property ArcPodrTrNRec:                 comp read;

  // Обособленное_подразделение_из_архива_ИК
  Property ArcPodrTrName:                 string read;

  // Адрес_обособленного_подразделения_из_архива_ИК
  Property ArcPodrTrAddr:               string read;

  // Код_обособленного_подразделения_из_архива_ИК
  Property ArcPodrTrKod:                  string read;

  // Вид_деятельности_обособленного_подразделения_из_архива_ИК
  Property ArcPodrTrFilialNo:             longint read;
  // Обособленное_подразделение_из_архива_вышестоящей_ИК_NRec
  Property ArcHigherPodrTrNRec:           comp read;

  // Архивное_количество
  Property ArcOsKol:                      tSumma read;

//------------------------ Информация о МОЛ-ах ----------------------------//
  // МОЛ_текущей_ИК_NRec
  Property KatOsMolNRec:                  tNrec read;

  // МОЛ_текущей_ИК_Name
  Property KatOsMolName:                  string read;

  // МОЛ_текущей_ИК_ТабНомер
  Property KatOsMolTabNum:                string read;

  // МОЛ_текущей_ИК_Должность
  Property KatOsMolPost:                  string read;

  // МОЛ_вышестоящей_ИК_NRec
  Property HigherOsMolNRec:               tNrec read;

  // МОЛ_вышестоящей_ИК_Name
  Property HigherOsMolName:               string read;

  // МОЛ_вышестоящей_ИК_ТабНомер
  Property HigherOsMolTabNum:             string read;

  // МОЛ_вышестоящей_ИК_Должность
  Property HigherOsMolPost:               string read;

  // Старый_МОЛ_NRec
  Property OldMolNRec:                    tNrec read;

  // Старый_МОЛ_Name
  Property OldMolName:                    string read;

  // Старый_МОЛ_ТабНомер
  Property OldMolTabNum:                  string read;

  // Старый_МОЛ_Должность
  Property OldMolPost:                    string read;

  // Новый_МОЛ_NRec
  Property NewMolNRec:                    tNrec read;

  // Новый_МОЛ_Name
  Property NewMolName:                    string read;

  // Новый_МОЛ_ТабНомер
  Property NewMolTabNum:                  string read;

  // Новый_МОЛ_Должность
  Property NewMolPost:                    string read;

  // МОЛ_текущей_ИК_из_операции_NRec
  // если не задано возвращается из карточки
  Property OperMolNRec:                   tNrec read;

  // МОЛ_текущей_ИК_из_операции_Name
  // если не задано возвращается из карточки
  Property OperMolName:                   string read;

  // МОЛ_текущей_ИК_из_операции_ТабНомер
  // если не задано возвращается из карточки
  Property OperMolTabNum:                 string read;

  // МОЛ_текущей_ИК_из_операции_Должность
  // если не задано возвращается из карточки
  Property OperMolPost:                   string read;

  // МОЛ_архивной_ИК_NRec
  Property ArcMolNRec:                    tNrec read;

  // МОЛ_архивной_ИК_Name
  Property ArcMolName:                    string read;

  // МОЛ_архивной_ИК_ТабНомер
  Property ArcMolTabNum:                  string read;

  // МОЛ_архивной_ИК_Должность
  Property ArcMolPost:                    string read;

  // МОЛ_архивной_вышестоящей_ИК_NRec
  Property ArcHigherMolNRec:              tNrec read;

  // МОЛ_архивной_вышестоящей_ИК_Name
  Property ArcHigherMolName:              string read;

  // МОЛ_архивной_вышестоящей_ИК_ТабНомер
  Property ArcHigherMolTabNum:            string read;

  // МОЛ_архивной_вышестоящей_ИК_Должность
  Property ArcHigherMolPost:              string read;

//---------------------- Информация об операциях  ----------------------------//
  // Операция_NRec
  Property MoveOsNRec:                    comp read;

  // Операция_тип
  Property MoveOsSysOper:                 word read;

  // Перепроводима_ли_операция
  Property MoveOsCanPereprov:             word read;

  // Операция_дата_проведения
  Property MoveDatOb:                     date read;

  // Операция_номер_документа
  Property MoveOsNoDoc:                   string read;

  // Операция_дата_приказа
  Property MoveDatPrk:                    date read;

  // Операция_номер_приказа
  Property MoveOsNoPrk:                   string read;

  // Тип_документов_операции
  Property MoveOSTipDoc:                  word read;

  // Спецификация_операции_NRec
  Property SpMoveOsNRec:                  comp read;

  // Спецификация_операции_Дата
  Property SpMoveOsDatOb:                 date read;

  // Спецификация_операции_Метод_учета
  Property SpMoveOsNastrNRec:             comp read;

  // Спецификация_операции_Тип_документа
  Property SpMoveOsTipDoc:                word read;

  // Спецификация_операции_Коэффициент
  Property SpMoveOsKoef:                  tSumma read;

 // Спецификация_операции_NRec
  Property SpMoveNRec:                    comp read;

  // Спецификация_операции_признак_проведения
  Property SpMoveProved:                  word read;

  // Спецификация_операции_тип_документа
  Property SpMoveTipDoc:                  comp read;

  // Основание_операции
  Property MoveOsOsnov:                   string read;

  // Основание_операции_код
  Property MoveOsOsnovKod:                string read;

  // Основание_операции_числовой_код
  Property MoveOsOsnovNumKod:             tSumma read;

  // Причина_операции
  Property MoveOsPrich:                   string read;

  // Причина_операции_код
  Property MoveOsPrichKod:                string read;

  // Причина_операции_числовой_код
  Property MoveOsPrichNumKod:             tSumma read;

  // Количетво_объектов_в_карточке_операции
  Property SpMoveOsKol:                   tSumma read;

  // Вышестоящая_спецификация_карточки
  Property SpMoveOsHigherNRec:            comp read;

  // Количество_в_вышестоящей_карточке
  Property SpMoveOsHigherKol:             tSumma read;

  // Определение_является_ли_спецификация_карточки_листом
  Property SpMoveOsIsLeaf:                boolean read;

//-------------- Информация о стоимости из операции --------------------------//
  // Стоимость_приобретения_продажи
  Property SpMoveOsSumma:                 tSumma read;

  // Стоимость_приобретения_за_единицу
  Property SpMoveOsOneSumma:              tSumma read;

  // Стоимость_приобретения_за_общее_количество
  Property SpMoveOsFullSumma:             tSumma read;

  // Стоимость_приобретения_продажи
  Property SpMoveOsSumma2:                tSumma read;

  // Стоимость_за_единицу
  Property SpMoveOsNewOneSumma:           tSumma read;

  // Стоимость_за_общее_количество
  Property SpMoveOsNewFullSumma:          tSumma read;

  // Полная_стоимость
  Property SpMoveOsNewSumma:              tSumma read;

  // Новая_сумма_износа
  Property SpMoveOsNewSumizn:             tSumma read;

  // Новая_сумма_износа_за_общее_количество
  Property SpMoveOsNewFullSumizn:         tSumma read;

  // Новая_сумма_износа_за_единицу
  Property SpMoveOsNewOneSumizn:          tSumma read;

  // Сумма_износа
  Property SpMoveOsNewOldSumizn:          tSumma read;

  // Сумма_износа_за_общее_количество
  Property SpMoveOsNewOldFullSumizn:      tSumma read;

  // Сумма_износа_за_единицу
  Property SpMoveOsNewOldOneSumizn:       tSumma read;

  // Сумма_износа_за_месяц_за_общее_количество
  Property SpMoveOsOldFullSumizn:         tSumma read;

  // Расходы_на_реализацию
  Property SpMoveOsRashod:                tSumma read;

  // Старая_полная_стоимость
  Property SpMoveOsOldSumma:              tSumma read;

  // Старая_сумма_износа
  Property SpMoveOsOldSumizn:             tSumma read;

  // Новая_остаточная_стоимость
  Property NewOstStoim:                   tSumma read;

  // Новая_остаточная_стоимость_без_учета_за_месяц
  Property NewOstStoimM:                  tSumma read;

  // Новая_остаточная_стоимость_единицы
  Property NewOstOneStoim:                tSumma read;

  // Полная_остаточная_стоимость_единицы
  Property FullNewOstOneStoim:            tSumma read;

  // Старая_остаточная_стоимость
  Property OldOstStoim:                   tSumma read;

  // Изменение_стоимости
  Property DeltaStoim:                    tSumma read;

  // Старая_сумма_износа_за_месяц_за_единицу
  Property SpMoveOs_OldSIznM :            tSumma read;
//---------------------- Общая информация об операции --------------------------//
  // Количество_спецификаций_в_операции
  Property SpMoveOsAll:                   longint read;

  // Количество_листов_у_текущей_карточки
  Property SpMoveOsLeafKol:               longint read;

  // Вышестоящий_объект
  Property SpMoveOsOldHigher:             comp read;

//------------- Информация о хоз.операции из операции и карточки -----------//
  // Ссылка_на_хозоперацию
  Property SpKatOsHozOper:                comp read;

  // Ссылка_на_хозоперацию_Архив
  Property ArcKatOsHozOper:               comp read;

  // Счет_амортизации
  Property KatOsSchet:                    tSchet19 read;

  // Субсчет_амортизации
  Property KatOsSubSchet:                 tSubSch read;

  // ХозОперация_операции
  Property SpMoveHozOper:                 comp read;

  // Есть_ли_обороты_для_ТХО
  Property isSpMoveHozObor:               boolean read;

  // Счет_деб_операции
  Property SpMoveSchetD:                  tSchet19 read;

  // Субсчет_деб_операции
  Property SpMoveSubSchetD:               tSubSch read;

  // Счет_кред_операции
  Property SpMoveSchetK:                  tSchet19 read;

  // Субсчет_кред_операции
  Property SpMoveSubSchetK:               tSubSch read;

//------------------------- Информация об объекте --------------------------//
  // Инвентарный_объект_ОС_NRec
  Property KatOsNRec:                     comp read;

  // Наименование_ОС
  Property KatOsName:                     string read;

  // Инвентарный_номер_ОС
  Property KatOsInNum:                    string read;

  // Инвентарный_номер_ОС_с_учетом_вышестоящего
  Property KatOsInNumWithHigher:          string read;

  // Имущественный_номер_ОС
  Property KatOsDopInNum:                 string read;

  // Гаражный_Номер_ОС
  Property KatOsGarNom:                   string read;

  // Организация_изготовитель
  Property OrgIzgName:                    string read;

  // Регистрационный_номер
  Property KatOsRegNum:                   string read;

  // Номенклатурный_номер
  Property KatOsBarKod:                   string read;

  // Год_выпуска_ОС
  Property KatOsGodV:                     date read;

  // Дата_поступления_ОС
  Property KatOsDatOk:                    date read;

  // Дата_ввода_в_эксплуатацию_ОС
  Property KatOsDatEk:                    date read;

  // Дата_выбытия_ОС
  Property KatOsDatV:                     date read;

  // Количество_объектов
  Property KatOsKol:                      tSumma read;

  // Отчетный_период_ИК_ОС
  Property KatOsOtchPer:                  date read;

  // Тип_объекта
  Property KatOsTiDk:                     word read;

  // Тип_объекта_наименование
  Property KatOsTiDkName:                 string read;

  // Код_группы_ОС_объекта
  Property KatOsGrOsKodGr:                string read;

  // Наименование_группы_ОС_объекта
  Property KatOsGrOsNameGr:              string read;

  // Ссылка_на_ОКОФ_инвентарного_объекта
  Property KatOsKodOKOFNRec:              comp read;
  Property ArcOsKodOKOFNRec:              comp read;

  // Наименование_кода_по_ОКОФ_инвентарного_объекта
  Property KatOsKodOKOFName:              string read;
  Property ArcOsKodOKOFName:              string read;

  // Код_по_ОКОФ_инвентарного_объекта
  Property KatOsKodOKOF:                  string read;
  Property ArcOsKodOKOF:                  string read;

  // Вид_инвентарного_объекта_наименование
  Property KatOsVidName:                  string read;

  // Вид_инвентарного_объекта_код
  Property KatOsVidKod:                   string read;

  // Вид_инвентарного_объекта_архив_наименование
  Property ArcOsVidName:                  string read;

  // Вид_инвентарного_объекта_архив_код
  Property ArcOsVidKod:                   string read;

  // Единицы_измерения_инвентарного_объекта_NRec
  Property KatOsKatEdNRec:                string read;

  // Наименование_единицы_измерения_инвентарного_объекта
  Property KatOsKatEdName:                string read;

  // Сокрашенное_наименование_единицы_измерения_инвентарного_объекта
  Property KatOsKatEdAbbr:                string read;

  // Код_единицы_измерения_ИК
  Property KatOsKatEdKod:                string read;

  // Заводской_номер_объекта_ОС
  Property KatOsZavNom:                   string read;

  // Марка_объекта_ОС
  Property KatOsTipMark:                  string read;

  // Номер_паспорта_объекта_ОС
  Property KatOsPsNum:                    string read;

  // Задан_ли_признак_использования_ОС
  Property KatOsIspOs:                    boolean read;

  // Признак_начисления_амортизации
  Property KatOsAmOk:                     word read;

  // Фиксированная сумма амортизации
  Property KatOsAmSumFld:                 tSumma read;

  // Инвентарный_объект_ОС_вышестоящий_объект
  Property KatOsHigherNRec:               comp read;

  // Инвентарный_объект_ОС_ссылка_на_матценность
  Property KatOsMC:                       comp read;

  // Инвентарный_объект_ОС_проверка_листа
  Property KatOsIsLeaf:                   boolean read;

  // Инвентарный_объект_ОС_проверка_папки
  Property KatOsIsNotLeaf:                boolean read;

  // Инвентарный_объект_ОС_проверка_подчиненности
  Property KatOsIsLeafOfHighter:          boolean read;

  // Амортизационная_группа_ИК_Наименование
  Property AmortGroupKatOsName:           string read;

  // Амортизационная_группа_ИК_Код
  Property AmortGroupKatOsKod:            string read;

  // Амортизационная_группа_Архив_Наименование
  Property AmortGroupArcName:             string read;

  // Амортизационная_группа_Архив_Код
  Property AmortGroupArcKod:              string read;

  // Срок_эксплуатации_до_поступления_ИК
  Property KatOsIspPs:                    tSumma read;

  // Текущий_срок_эксплуатации_ИК
  Property KatOsIspCur:                   tSumma read;

  // Текущий_срок_эксплуатации_ИК_Архив
  Property ArcOsIspCur:                   tSumma read;

  // Фактический_срок_эксплуатации_ИК
  Property KatOsIspFact:                  tSumma read;

  // Фактический_срок_эксплуатации_Архив
  Property ArcOsIspFact:                  tSumma read;

  // Стоимость_ИК
  Property KatOsStoim:                    tSumma read;

  // Стоимость_ИК_за_единицу
  Property KatOsOneStoim:                 tSumma read;

  // Стоимость_ИК_за_общее_количество
  Property KatOsFullStoim:                tSumma read;

  // Полный_износ_ИК
  Property KatOsFullIznos:                tSumma read;

  // Износ_ИК
  Property KatOsSumIznos:                 tSumma read;

  // Износ_за месяц_ИК
  Property KatOsSIznM:                    tSumma read;

  // Износ_за месяц_ИК_Архив
  Property ArcOsSIznM:                    tSumma read;

  // Стоимость_при_поступлении_ИК
  Property KatOsStoimPs:                  tSumma read;

  // Стоимость_при_поступлении_Архив
  Property ArcOsStoimPs:                  tSumma read;

  // Стоимость_при_поступлении_ИК для НУ
  Property KatOsStoimPs_NU:               tSumma read;

  // Стоимость_при_поступлении_Архив  для НУ
  Property ArcOsStoimPs_NU:               tSumma read;

  // Износ_при_поступлении_ИК
  Property KatOsIznosPs:                  tSumma read;

  // Износ_при_поступлении_Архив
  Property ArcOsIznosPs:                  tSumma read;

  // Стоимость_ИК_Архив
  Property ArcOsStoim:                    tSumma read;

  // Стоимость_ИК_Архив_за_единицу
  Property ArcOsOneStoim:                 tSumma read;

  // Стоимость_ИК_Архив_за_общее_количество
  Property ArcOsFullStoim:                tSumma read;

  // Полный_износ_ИК_Архив
  Property ArcOsFullIznos:                tSumma read;

  // Износ_ИК_Архив
  Property ArcOsSumIznos:                 tSumma read;

  // Стоимость_при_поступлении_новой_ИК
  Property NewKatOsStoimPs:               tSumma read;

  // Стоимость_при_поступлении_новой_ИК_за_единицу
  Property NewKatOsOneStoimPs:            tSumma read;

  // Объект_куда_передают_NRec
  Property SpKatOsPrNRec:                 comp read;

  // Объект_откуда_передают_NRec
  Property SpKatOsOldNRec:                comp read;

  // Объект_откуда_передают_инвентарный_номер
  Property SpKatOsOldInNum:               string read;

  // Объект_откуда_передают_инвентарный_номер_вышестоящего
  Property SpKatOsOldHigherInNum:         string read;

  // Новая_ИК_NRec
  Property NewKatOsNRec:                  comp read;

  // Инвентарный_номер_новой_ИК
  Property NewKatOsInNum:                 string read;

  // Спецификация_карточки_NRec
  Property SpKatOsNRec:                   comp read;

  // Адрес ОС
  Property FullAdresOS:                 string read;

//---------------- Информация о строительстве и методе учета ------------------//
  // KatStroyName
  Property KatStroyName:                  string read;

  // KatStroyDataReg
  Property KatStroyDataReg:               date read;

  // KatStroyNoSvidReg
  Property KatStroyNoSvidReg:             string read;

  // Метод_Учета_nRec
  Property NastrOsNRec:                   tNRec read;

  // Метод_Учета_Наименование
  Property NastrOsName:                   string read;

  // Метод_Учета_Коэффициент_индексации_амортизации
  Property NastrOsKIAO:                   tSumma read;

  // Наименование_Валюты
  Property SimvalVal:                     string read;

  // Учет_групповых_карточек
  Property NastrOsKol:                    word read;

  // Разрядность_дробной_части
  Property RazrKol:                       word read;

//---------------------- Информация о вышестоящем объекте ---------------------//
  // Наличие_архива_для_ИК
  Property isArcKatOs:                    boolean read;

  // Наличие_архива_для_вышестоящего_ИК
  Property isArcHigherOs:                 boolean read;

  // Наименование_вышестоящего
  Property HigherOsName:                  string read;

  // Инвентарный_номер_вышестоящего
  Property HigherOsInNum:                 string read;

  // Инвентарный_номер_вышестоящего_с_учетом_вышестоящего
  Property HigherOsInNumWithHigher:       string read;

  // Заводской_номер_вышестоящего
  Property HigherOsZavNom:                string read;

  // Количество_вышестоящего
  Property HigherOsKol:                   tSumma read;

  // Наименование_кода_по_ОКОФ_вышестоящего_объекта
  Property HigherOsKodOKOFName:           string read;

  // Код_по_ОКОФ_вышестоящего_объекта
  Property HigherOsKodOKOF:               string read;

  // Год_выпуска_вышестоящего_ОС
  Property HigherOsGodV:                  date read;

  // Дата_поступления_вышестоящего_ОС
  Property HigherOsDatOk:                 date read;

  // Дата_выбытия_вышестоящего_ОС
  Property HigherOsDatV:                  date read;

  // Отчетный_период_вышестоящего_ОС
  Property HigherOsOtchPer:               date read;

  // Единицы_измерения_инвентарного_объекта_NRec
  Property HigherOsKatEdNRec:             comp read;

  // Наименование_единицы_измерения_инвентарного_объекта
  Property HigherOsKatEdName:             string read;

  // Сокращенное_наименование_единицы_измерения_инвентарного_объекта
  Property HigherOsKatEdAbbr:             string read;

  // Номер_паспорта_объекта_вышестоящего_ОС
  Property HigherOsPsNum:                 string read;

  // Спецификация_вышестоящего_NRec
  Property SpHigherOsNRec:                comp read;

  // Хоз_операция_вышестоящего
  Property SpHigherOsHozOper:             comp read;

  // Счет_амортизации_вышестоящего
  Property HigherOsSchet:                 tSchet19 read;

  // Субсчет_амортизации_вышестоящего
  Property HigherOsSubSchet:              tSubSch read;

  // Амортизационная_группа_вышестоящего
  Property AmortGroupHigherOsKod:         string read;

//---------------------- Информация о норме ------------------------------------//
  // Ссылка_на_норму
  Property KatOsVidNormaNRec:             comp read;

  // Задана_ли_норма_ИК
  Property KatOsVidNormaIsValid:          boolean read;

  // Норма_наименование
  Property KatOsVidNormaName:             string read;

  // Норма_код
  Property KatOsVidNormaKod:              string read;

  // Норма_норма
  Property KatOsVidNormaNorma:            tSumma read;

  // Срок_полезного_использования_по_норме_ИК
  Property KatOsNormaIspP:                tSumma read;

  // Срок_полезного_использования_ИК
  Property KatOsIspP:                     tSumma read;

  // Ссылка_на_норму_вышестоящего
  Property HigherOsVidNormaNRec:          comp read;

  // Норма_наименование_вышестоящего
  Property HigherOsVidNormaName:          string read;

  // Норма_код_вышестоящего
  Property HigherOsVidNormaKod:           string read;

  // Норма_норма_вышестоящего
  Property HigherOsVidNormaNorma:         tSumma read;

  // Срок_полезного_использования_по_норме_вышестоящей
  Property HigherOsNormaIspP:             tSumma read;

  // Срок_полезного_использования_вышестоящей_ИК
  Property HigherOsIspP:                  tSumma read;

  // Ссылка_на_норму_архив
  Property ArcKatOsVidNormaNRec:          comp read;

  // Задана_ли_норма_ИК_Архив
  Property ArcKatOsVidNormaIsValid:       boolean read;

  // Норма_наименование_архив
  Property ArcKatOsVidNormaName:          string read;

  // Норма_код_архив
  Property ArcKatOsVidNormaKod:           string read;

  // Норма_норма_архив
  Property ArcKatOsVidNormaNorma:         tSumma read;

  // Срок_полезного_использования_по_норме_Архив
  Property ArcKatOsNormaIspP:             tSumma read;

  // Срок_полезного_использования_Архив
  Property ArcOsIspP:                     tSumma read;

  // Ссылка_на_норму_вышестоящего_архив
  Property ArcHigherOsVidNormaNRec:       comp read;

  // Норма_наименование_вышестоящего_архив
  Property ArcHigherOsVidNormaName:       string read;

  // Норма_код_вышестоящего_архив
  Property ArcHigherOsVidNormaKod:        string read;

  // Норма_норма_вышестоящего_архив
  Property ArcHigherOsVidNormaNorma:      tSumma read;

  // Срок_полезного_использования_по_норме_Архив_вышестоящего
  Property ArcHigherOsNormaIspP:          tSumma read;

  // Срок_полезного_использования_Архив_вышестоящего
  Property ArcHigherOsIspP:               tSumma read;

//---------------- Информация об алгоритме начисления амортизации --------------//
// Алгоритм_начисления_амортизации_NRec
  Property KatOsAlgNRec:                  comp read;

// Алгоритм_начисления_амортизации_наименование
  Property KatOsAlgName:                  string read;

// Алгоритм_начисления_амортизации_NRec_вышестоящего
  Property HigherOsAlgNRec:               comp read;

// Алгоритм_начисления_амортизации_наименование_вышестоящего
  Property HigherOsAlgName:               string read;

// Алгоритм_начисления_амортизации_NRec_архив
  Property ArcKatOsAlgNRec:               comp read;

// Алгоритм_начисления_амортизации_наименование_архив
  Property ArcKatOsAlgName:               string read;

// Алгоритм_начисления_амортизации_NRec_вышестоящего_архив
  Property ArcHigherOsAlgNRec:            comp read;

// Алгоритм_начисления_амортизации_наименование_вышестоящего_архив
  Property ArcHigherOsAlgName:            string read;

//---------------------- Информация о старом и новом подразделениях ------------//
  // Старое_подразделение_наименование
  Property OldKatPodrName:                string read;

  // Старое_подразделение_код
  Property OldKatPodrKod:                 string read;

  // Новое_подразделение_наименование
  Property NewKatPodrName:                string read;

  // Новое_подразделение_код
  Property NewKatPodrKod:                 string read;

  // Старое_обособленное_подразделение_наименование
  Property OldKatPodrTrName:              string read;

  // Старое_обособленное_подразделение_код
  Property OldKatPodrTrKod:               string read;

  // Новое_обособленное_подразделение_наименование
  Property NewKatPodrTrName:              string read;

  // Новое_обособленое_подразделение_код
  Property NewKatPodrTrKod:               string read;

//------------- Информация о накладной, по которой получены МЦ ------------------//
  // Накладная_NRec
  Property NaklNRec:                      comp read;

  // Дата_накладной
  Property NaklDate:                      date read;

  // ДО_на_поступление_NRec
  Property NaklDONRec:                    comp read;

  // Банк_из_ДО_на_поступления_Есть_ли
  Property IsBankDO:                      boolean read;

  // Банк_из_ДО_на_поступления_Имя
  Property BankDOName:                    string read;

  // Банк_из_ДО_на_поступление_Адрес
  Property BankDOAddr:                    string read;

  // Банк_из_ДО_на_поступление_Счет
  Property BankDOSchet:                   string read;

  // Банк_из_ДО_на_поступление_Счет_в_РКЦ
  Property BankDOSchetRKC:                string read;

  // Банк_из_ДО_на_поступление_Счет_ПДокументов
  Property BankDOSchetPDoc:               string read;

  // Банк_из_ДО_на_поступление_Мфо
  Property BankDOMFO:                     string read;

  // Банк_из_ДО_на_поступление_РКЦ
  Property BankDORKC:                     string read;

//------------- Информация о накладной передачи МЦ в ОС ------------------//
  // Накладная_передачи_NRec
  Property NaklMCToOSNRec:                comp read;

  // Накладная_передачи_код_валюты
  Property NaklMCToOScVal:                comp read;

  // Накладная_передачи_наименование_валюты
  Property NaklMCToOSSimvolV:             string read;

  // Накладная_передачи_сумма_в_валюте
  Property NaklMCToOSSumVal:              tSumma read;

//------------- Информация о накладной на выбытие ------------------//
  // Накладная_выбытие_Есть ли
  Property isExistsNaklReal:              boolean read;

  // Накладная_выбытие_NRec
  Property NaklRealNRec:                  comp read;

  // Спецификация_накладной на выбытие_NRec
  Property SpNaklRealNRec:                comp read;

  // Информация о стоимости из накладной на выбытие
  // Накладная_выбытие_Стоимость_без_НДС
  Property RealSumma:                     tSumma read;

  // Накладная_выбытие_Ставка_НДС
  Property RealNalogNDS:                  tSumma read;

  // Накладная_выбытие_Сумма_НДС
  Property RealSummaNDS:                  tSumma read;

//----------------------- Информация о доверенности -----------------------------//
  // Доверенность_NRec
  Property DoverKatOsNRec:                comp read;

  // Доверенность_дата_выдачи
  Property DoverKatOsDate:                date read;

  // Доверенность_номер
  Property DoverKatOsNo:                  string read;

  // Доверенное_лицо_ФИО
  Property DoverKatOsFio:                 string read;

  // Доверенное_лицо_ФИО_дат_падеж
  Property DoverKatOsFioDat:              string read;

  // Доверенное_лицо_Должность
  Property DoverKatOsPost:                string read;

//---- Даты последней / первой амортизации, поступления, выбытия, перемещения ---//
  // Дата_последней_амортизации
  Property LastDateAmort:                 date read;

  // Первая_операция_получения_NRec
  Property FirstPolOperNRec:              comp read;

  // Первая_операция_получения_Есть_ли
  Property IsFirstPolOper:                boolean read;

  // Первая_операция_получения_дата_операции
  Property FirstPolOperDate:              date read;

  // Есть_ли_архив_при_поступлении
  Property IsArcFirstPolOper:             boolean read;

  // Срок_полезного_использования_при_поступлении
  Property FirstPolOperSrokIsp:           tSumma read;

  // Стоимость_при_поступлении_за_единицу
  Property FirstPolOperOneSumma:          tSumma read;

  // Последняя_операция_выбытия_Есть_ли
  Property IsLastVibOper:                 boolean read;

  // Последняя_операция_выбытия_NRec
  Property LastVibOperNRec:               comp read;

  // Последняя_операция_частичного_выбытия_Есть_ли_по_новой_ИК
  Property IsLastVibPartOper:             boolean read;

  // Последняя_операция_частичного_выбытия_NRec_по_новой_ИК
  Property LastVibPartOperNRec:           comp read;

  // Первая_операция_частичного_перемещения_Есть_ли_по_новой_ИК
  Property IsFirstMovePartOper:           boolean read;

  // Первая_операция_частичного_перемещения_NRec_по_новой_ИК
  Property FirstMovePartOperNRec:         comp read;

  // Является_ли_операция_последней_среди_частичных_перемещений_и_выбытий_по_ИК
  Property IsCurOperFirstPartIK:          boolean read;

  // Является_ли_операция_последней_среди_частичных_перемещений_и_выбытий_по_новой_ИК
  Property IsCurOperFirstPartNewIK:       boolean read;

//---- Коэффициенты изменения стоимости при частичных перемещениях и выбытиях ---//
  // Коэффициент_индексации_стоимости
  Property KoefIndexStoim:                tSumma read;

  // Расходы_на_реализацию_за_единицу
  Property SpMoveOsOneRashod:             tSumma read;

  // Расходы_на_реализацию_за_общее_количество
  Property SpMoveOsFullRashod:            tSumma read;

  // Старая_стоимость_за_единицу
  Property SpMoveOsOldOneSumma:           tSumma read;

  // Старая_стоимость_за_общее_количество
  Property SpMoveOsOldFullSumma:          tSumma read;

  // Сумма_износа_за_месяц_за_единицу
  Property SpMoveOsOldOneSumizn:          tSumma read;

  // Изменение_стоимости_за_единицу
  Property DeltaOneStoim:                 tSumma read;

  // Изменение_стоимости_за_общее_количество
  Property DeltaFullStoim:                tSumma read;

  // Номер Единый государственный реестр прав   (РФ) KatOs_EGRP_NoDoc
  Property KatOs_EGRP_NoDoc :              string read;

  // дата Единый государственный реестр прав   (РФ) KatOs_EGRP_Date
  Property KatOs_EGRP_Date :               date read;

end;

//------------------------------------------------------------------------------
ObjInterface IDataOsOneExt1;
  // срок использования от заданной даты на дату (без записи в БД)
  Function GetSrokUsedByDate(_dBeg, _dEnd : date; pwMode: word) : tSumma;

end;

//------------------------------------------------------------------------------
VipInterface DataOsOne implements IDataOsOne, IDataOsOneExt1  Licensed (Free);

#end // __DATAOSONE_VIH__
