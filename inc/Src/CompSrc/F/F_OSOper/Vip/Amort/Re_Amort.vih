//                                                      (c) корпорация Галактика
// Галактика 8.1 - Бухгалтерский контур
// Операции по объекту ОС (НМА)
//******************************************************************************

#ifndef __RE_AMORT__VIH__
#define __RE_AMORT__VIH__

#ifdef ComponentVersion
#component "F_OSOPER"
#end

#doc
Перерасчет амортизации по объекту ОС (НМА)
#end

#include mt_ReAmort.tbl

ObjInterface ObjRe_Amort;
//------------------------------------------------------------------------------
#doc
  инициализация 
#end
  Procedure Init(pwTip, pwSysOper: word);
//------------------------------------------------------------------------------
#doc
  установка метода учета
#end
  Procedure SetNastrOs(pcNastrOsNRec : comp);    
//------------------------------------------------------------------------------
#doc
  окно параметров перерасчета амортизации
#end
  Function SetParamReCalcAmort(pwTiDk, pwSysOper: word; pcMoveOS : comp): boolean;
//------------------------------------------------------------------------------
#doc
  перерасчет амортизации для объекта ОС за период 
  по заданному методу учета
#end
  Function ReCalcAmortOne(pcRecOS, pcRecNastrOS: comp; pdBeg, pdEnd: date): word;
//------------------------------------------------------------------------------
#doc
  перерасчет амортизации для объектов ОС (выбранных объектов ОС)
#end
  Function FullReCalcAmort(pwTiDk, pwSysOper, pwMode : word) : word;
//------------------------------------------------------------------------------
#doc  
  Возвращает величину изменения суммы амортизации (с учетом поправочных коэффициентов)
#end
  Function GetSumIznFromMT(pcRecOS, pcRecNastrOS: comp; var pdoPrevSum, pdoNewSum: double): double;
//------------------------------------------------------------------------------
#doc
  Возвращает величину изменения суммы амортизации (без учета поправочных коэффициентов)
#end  
  Function GetSumAlgFromMT(pcRecOS, pcRecNastrOS: comp; var pdoPrevSum, pdoNewSum: double): double;
//------------------------------------------------------------------------------
#doc
  Просмотр перерассчитанных величин амортизаций за период
#end
  Procedure SeeMT_ReAmort;
//------------------------------------------------------------------------------
end;

VipInterface OperCorrectAmort Implements ObjRe_Amort
  #ifdef ATL51
  licensed (FREE)
  #end
;

#end
