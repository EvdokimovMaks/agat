//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Встраиваемый объектный интерфейс : "Книга финансовых операций"
//------------------------------------------------------------------------------

#include FpGalDocument.Vih      // Информация о документах Галактики

#ifndef __ExtEmbFpOborot_Obj__
#define __ExtEmbFpOborot_Obj__

#ifdef  ComponentVersion
#component "F_FpOborot"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Встраиваемый объектный интерфейс : "Книга финансовых операций"<br>
#end
ObjInterface iExtEmbFpOborot;

//------------------------------------------------------------------------------
#doc
   Активизация окна для связывания<br>
#end
//------------------------------------------------------------------------------
Function IntWinActivate(
    _wMode: word                // режим работы:
                                //   cgiFpOborot_BrowseFull  - Browse с нижней панелью доп.информации
                                //   cgiFpOborot_ScreenFull  - большой Screen
                                //   cgiFpOborot_BrowseShort - Browse без нижней панели с доп.информацией
                                //   cgiFpOborot_ScreenShort - маленький Screen
) : boolean;

//------------------------------------------------------------------------------
#doc
   Инициализация интерфейса ч/з сервис документа<br>
#end
//------------------------------------------------------------------------------
Function InitByObjDoc(
    _wIntMode     : word;       // режим (выбор/просмотр: cgiNo, cgiPick,...)
    _wRunMode     : word;       // режим работы:
                                //   cgiFpOborot_AllOborot         - все
                                //   cgiFpOborot_DocOborot         - только документ
                                //   cgiFpOborot_DocAndSpDocOborot - документ+спецификация
                                //   cgiFpOborot_SpDocOborot       - только спецификация
                                //   cgiFpOborot_SoprHozOborot     - только по SoprHoz
    _wKodReg      : word;       // код регистра учета
    _cFpOborot    : comp;       // фин.операция
    _pObjDocument : #mTDocument // ссылка на сервис документа
) : boolean;

//------------------------------------------------------------------------------
#doc
   Освободить обратные ссылки<br>
#end
//------------------------------------------------------------------------------
Procedure FreeLinks;

//------------------------------------------------------------------------------
#doc
   добавить меню _IHotKey в меню текущего окна<br>
#end
//------------------------------------------------------------------------------
Procedure AddIHotKey(_IHotKey : string);

//------------------------------------------------------------------------------
#doc
   изменить меню текущего окна на меню _IHotKey<br>
#end
//------------------------------------------------------------------------------
Procedure SetIHotKey(_IHotKey : string);

//==============================================================================
//                                 EVENT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   произошло событие _Command.<br>
   Если нужно заменить стандартную обработку события собственной,<br>
   то вернуть _Command = cmCancel<br>
#end
//------------------------------------------------------------------------------
Event Procedure EventPutCommand(var _Command : integer);

//------------------------------------------------------------------------------
#doc
   произошло событие изменения текущей позиции<br>
#end
//------------------------------------------------------------------------------
Event Procedure EventSetPosition(var _nRec : tNRec);

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

#endif//__ExtEmbFpOborot_Obj__
