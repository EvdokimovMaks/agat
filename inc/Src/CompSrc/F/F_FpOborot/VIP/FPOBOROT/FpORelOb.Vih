//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Базовый объект : "Правила передачи данных"
//------------------------------------------------------------------------------

#ifndef __FpORelOb_Vih__
#define __FpORelOb_Vih__

#ifdef  ComponentVersion
#component "F_FpOborot"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include FPOBFILT.Vih  // Фильтры
//------------------------------------------------------------------------------

//==============================================================================
//#region DEFINE

// в 712 поменяли словарь
#ifdef  GAL7_12
#define __ChangedDict_FpRelOb__
#endif//GAL7_12
// если поменяли словарь, то компилируем на новых таблицах
#ifdef  __ChangedDict_FpRelOb__
  // но проверяем, что это не для конвертера
  #ifndef __AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__
    #define __NewDict_FpRelOb__
  #else //__AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__
    #undef  __NewDict_FpRelOb__
  #endif//__AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__
#endif//__ChangedDict_FpRelOb__

#undef _BufTypeP_
#ifdef  __NewDict_FpRelOb__
  #define _BufTypeP_  type$p_FpRelOb
#else //__NewDict_FpRelOb__
  #define _BufTypeP_  type$p_UserDeskRep
#endif//__NewDict_FpRelOb__

/////////////////////////////////////////////////////////////////////
#ifdef  __NewDict_FpRelOb__
  #declare mDeclGetFun(_Fun,_Type)
  Function Buf#_Fun(_Buff : type$p_FpRelOb) : #_Type;
  Function #_Fun(_cRec : comp) : #_Type;
  #end // mDeclGetFun
#else //__NewDict_FpRelOb__
  #declare mDeclGetFun(_Fun,_Type)
  Function Buf#_Fun(_Buff : type$p_UserDeskRep) : #_Type;
  Function #_Fun(_cRec : comp) : #_Type;
  #end // mDeclGetFun
#endif//__NewDict_FpRelOb__

/////////////////////////////////////////////////////////////////////
#ifdef  __NewDict_FpRelOb__
  #declare mDeclSetFun(_Fun,_Type)
  Function Buf#_Fun(var _Buff : type$p_FpRelOb; _Value : #_Type) : boolean;
  Function #_Fun(var _cRec : comp; _Value : #_Type) : boolean;
  #end // mDeclSetFun
#else //__NewDict_FpRelOb__
  #declare mDeclSetFun(_Fun,_Type)
  Function Buf#_Fun(var _Buff : type$p_UserDeskRep; _Value : #_Type) : boolean;
  Function #_Fun(var _cRec : comp; _Value : #_Type) : boolean;
  #end // mDeclSetFun
#endif//__NewDict_FpRelOb__
//#endregion DEFINE
//******************************************************************************


//==============================================================================
#doc
Базовый объект : "Правила передачи данных"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#ifndef __AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__  // если обычная компиляция
  Private ObjInterface IFpORelOb;
#else //__AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__  // если для конвертера
  Private ObjInterface IFpORelOb#__AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__;
#endif//__AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывод сообщения последней ошибки
  #end
  Function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region MODIFY
  //----------------------------------------------------------------------------
  #doc
     Вставка записи по буферу таблицы<br>
  #end
  Function InsP(var _Buff : #_BufTypeP_) : integer;
  //----------------------------------------------------------------------------
  #doc
     Изменение записи по буферу таблицы<br>
  #end
  Function UpdP(var _Buff : #_BufTypeP_) : integer;
  //----------------------------------------------------------------------------
  #doc
     Удаление записи по буферу таблицы<br>
  #end
  Function DelP(_Buff : #_BufTypeP_) : integer;
  //#endregion MODIFY
  //****************************************************************************


  //============================================================================
  //#region FIELDS (Get)
  //----------------------------------------------------------------------------
  #mDeclGetFun(GetName,      String)
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetNode(_Buff : #_BufTypeP_) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetActiveMode(_Buff : #_BufTypeP_) : word;
  //----------------------------------------------------------------------------
  #mDeclGetFun(GetIsActive,  Boolean)

  //============================================================================
  //#region Область данных в книге финансовых операций
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetObRegMode(_Buff : #_BufTypeP_) : word;
  //----------------------------------------------------------------------------
  #mDeclGetFun(GetIsObPlan,      Boolean)
  #mDeclGetFun(GetIsObFact,      Boolean)
  #mDeclGetFun(GetIsObBuh,       Boolean)
  #mDeclGetFun(GetIsObRezerv,    Boolean)
  #mDeclGetFun(GetObKodReg,      Word   )
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetTiDkMode(_Buff : #_BufTypeP_) : word;
  #mDeclGetFun(GetIsAllTiDk, Boolean)
  //----------------------------------------------------------------------------
  #mDeclGetFun(GetObFltMode,     Word   )
  #mDeclGetFun(GetIsObFltMode,   Boolean)
  #mDeclGetFun(GetObFlt,         Comp   )
  //#endregion Область данных в книге финансовых операций
  //****************************************************************************

  //============================================================================
  //#region Область данных в бюджете
  //----------------------------------------------------------------------------
  #mDeclGetFun(GetBudKodReg,      Word   )

  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetBudRegMode     (_Buff : #_BufTypeP_) : word;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetIsBudPlan      (_Buff : #_BufTypeP_) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetIsBudFact      (_Buff : #_BufTypeP_) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetIsBudRezerv    (_Buff : #_BufTypeP_) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetBudCOMode      (_Buff : #_BufTypeP_) : word;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetBudDefCO       (_Buff : #_BufTypeP_) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetBudTPer        (_Buff : #_BufTypeP_) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetBudVariant     (_Buff : #_BufTypeP_) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetBudStage       (_Buff : #_BufTypeP_) : string;

  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetBudDefCOName   (_Buff : #_BufTypeP_) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetBudTPerName    (_Buff : #_BufTypeP_) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства по буферу таблицы<br>
  #end
  Function BufGetBudVariantName (_Buff : #_BufTypeP_) : string;

  //----------------------------------------------------------------------------
  #doc
     Получить ссылку на каталог соответствий статей бюджета
  #end
  Function BufGetKAURel (_Buff : #_BufTypeP_) : comp;
  //#endregion Область данных в бюджете
  //****************************************************************************

  //============================================================================
  //#region Контроль передачи данных
  //----------------------------------------------------------------------------
  #doc
     Получить режим контроля формирования финансовых операций
  #end
  Function BufGetDTCMode(_Buff : #_BufTypeP_) : word;
  //----------------------------------------------------------------------------
  #doc
     Получить алгоритм контроля формирования финансовых операций
  #end
  #mDeclGetFun(GetDTCAlg,    String)
  //Function BufGetDTCAlg (_Buff : #_BufTypeP_) : string;
  //#endregion Контроль передачи данных
  //****************************************************************************

  //#endregion FIELDS (Get)
  //****************************************************************************


  //============================================================================
  //#region FIELDS (Set)
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetName      (var _Buff : #_BufTypeP_; _Value : string) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetNode      (var _Buff : #_BufTypeP_; _Value : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetActiveMode(var _Buff : #_BufTypeP_; _Value : word) : boolean;

  //============================================================================
  //#region Область данных в книге финансовых операций
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetObRegMode (var _Buff : #_BufTypeP_; _Value : word) : boolean;
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetTiDKMode  (var _Buff : #_BufTypeP_; _Value : word) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetObFltMode (var _Buff : #_BufTypeP_; _Value : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetObFlt     (var _Buff : #_BufTypeP_; _Value : comp) : boolean;
  //#endregion Область данных в книге финансовых операций
  //****************************************************************************

  //============================================================================
  //#region Область данных в бюджете
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetBudRegMode(var _Buff : #_BufTypeP_; _Value : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetBudCOMode (var _Buff : #_BufTypeP_; _Value : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetBudDefCO  (var _Buff : #_BufTypeP_; _Value : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetBudTPer   (var _Buff : #_BufTypeP_; _Value : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetBudVariant(var _Buff : #_BufTypeP_; _Value : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить значения свойства по буферу таблицы<br>
  #end
  Function BufSetBudStage  (var _Buff : #_BufTypeP_; _Value : string) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Установить ссылку на каталог соответствий статей бюджета
  #end
  Function BufSetKAURel (var _Buff : #_BufTypeP_; _Value : comp) : boolean;

  //----------------------------------------------------------------------------
  #undef mDeclGetFun
  #undef mDeclSetFun
  //#endregion Область данных в бюджете
  //****************************************************************************

  //============================================================================
  //#region Контроль передачи данных
  //----------------------------------------------------------------------------
  #doc
     Установить режим контроля формирования финансовых операций
  #end
  Function BufSetDTCMode(var _Buff : #_BufTypeP_; _Value : word  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить алгоритм контроля формирования финансовых операций
  #end
  Function BufSetDTCAlg (var _Buff : #_BufTypeP_; _Value : string) : boolean;
  //#endregion Контроль передачи данных
  //****************************************************************************

  //#endregion FIELDS (Set)
  //****************************************************************************


  //============================================================================
  //#region CASH
  //----------------------------------------------------------------------------
  #doc
     Определить актуальность кэша
  #end
  Function GetCashActual : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить актуальность кэша
  #end
  Function SetCashActual(_Value : boolean) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Обновить кэша
  #end
  Function RefreshAllCash : boolean;
  //----------------------------------------------------------------------------
  #doc
     Обновить кэша для заданной настройки
  #end
  Function RefreshAllCashForSingleTune(
    _cTune   : comp
  ) : boolean;
  //#endregion CASH
  //****************************************************************************


  //============================================================================
  //#region COMMON
  //----------------------------------------------------------------------------
  //
  //----------------------------------------------------------------------------
  #doc
     Копировать дополнительные поля сущности
  #end
  Function CopyAllAddFld(_SrcRec : comp; _DstRec : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Построить список синхронизируемых копий бюджета
  #end
  Function MakeListSynchBudVar(
    _Buff : type$p_FpOborot
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Построить список синхронизируемых копий бюджета, по статусу
  #end
  Function MakeListSynchBudVarForState(
    _Buff   : type$p_FpOborot;
    _wState : word
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Построить список синхронизируемых копий бюджета, для заданной настройки
  #end
  Function MakeListSynchBudVarForSingleTune(
    _Buff : type$p_FpOborot
  ) : boolean;


  //----------------------------------------------------------------------------
  #doc
     Построить фильтр по финоперациям
  #end
  Function MakeOborotFilter(
    _cTune   : comp;
    _pFlt    : iObjFpUserFilt
  ) : boolean;
  //#endregion COMMON
  //****************************************************************************


  //============================================================================
  //#region CONVERTER
  //----------------------------------------------------------------------------
  #doc
     Запуск корректировки финоперация к текущему типу периода
  #end
  Function CorrectToCurTPer : boolean;
  //#endregion CONVERTER
  //****************************************************************************

End; //ObjInterface
//******************************************************************************


//==============================================================================
#ifndef __AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__  // если обычная компиляция
  VipInterface FpORelOb implements IFpORelOb
  #Licensed_Free;
#else //__AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__  // если для конвертера
  VipInterface FpORelOb#__AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__ implements IFpORelOb#__AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__
  #Licensed_Free;
#endif//__AddFP_RunConv_NewDict_FpRelOb_CompileForOldTBL__
Public:
  Constructor Init;
  Destructor  Done;
End;
//******************************************************************************


#endif//__FpORelOb_Vih__
