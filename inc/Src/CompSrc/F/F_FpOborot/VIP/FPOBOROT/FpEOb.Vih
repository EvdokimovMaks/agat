//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Интерфейс редактирования : "Книга финансовых операций"
//------------------------------------------------------------------------------

#include FpGalDocument.Vih      // Информация о документах Галактики

#ifndef _EditFpOborotObj_Included_
#define _EditFpOborotObj_Included_

#ifdef  ComponentVersion
#component "F_FpOborot"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Интерфейс редактирования : "Книга финансовых операций"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
ObjInterface iEditFpOborot;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;
//------------------------------------------------------------------------------
#doc
   Показать сообщение о последней ошибке
#end
Function RunShowError : boolean;


//==============================================================================
//                                  INIT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Инициализация интерфейса "покажем всю книгу"
#end
Function InitByAll(
    _wIntMode     : word;       // режим (выбор/просмотр: cgiNo, cgiPick,...)
    _wKodReg      : word;       // код регистра учета
    _cFpOborot    : comp        // фин.операция
) : boolean;

//------------------------------------------------------------------------------
#doc
   Инициализация интерфейса ч/з сервис документа
#end
Function InitByObjDoc(
    _wIntMode     : word;       // режим (выбор/просмотр: cgiNo, cgiPick,...)
    _wRunMode     : word;       // режим работы:
                                //   0 - все
                                //   1 - только документ
                                //   2 - документ+спецификация
                                //   3 - только спецификация
    _wKodReg      : word;       // код регистра учета
    _cFpOborot    : comp;       // фин.операция
    _pObjDocument : #mTDocument // ссылка на сервис документа
) : boolean;

//------------------------------------------------------------------------------
#doc
   Инициализация интерфейса ч/з ссылку на документ
#end
Function InitByDoc(
    _wIntMode     : word;       // режим (выбор/просмотр: cgiNo, cgiPick,...)
    _wKodReg      : word;       // код регистра учета
    _cFpOborot    : comp;       // фин.операция
    _wTiDk        : word;       // тип документа
    _cDocument    : comp        // ссылка на документ
) : boolean;

//------------------------------------------------------------------------------
#doc
   Инициализация интерфейса по SoprHoz
#end
Function InitBySoprHoz(
    _wIntMode     : word;       // режим (выбор/просмотр: cgiNo, cgiPick,...)
    _wKodReg      : word;       // код регистра учета
    _cFpOborot    : comp;       // фин.операция
    _cSoprHoz     : comp        // SoprHoz
) : boolean;


//------------------------------------------------------------------------------
#doc
   Инициализация главного окна с аналитикой
#end
Function InitMainBrowAn : boolean;

//------------------------------------------------------------------------------
#doc
   Инициализация окна редактирования с аналитикой
#end
Function InitWiKatEdit : boolean;


//==============================================================================
//                                COMMON
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Добавить локальное меню в локальное меню текущего окна
#end
Procedure AddIHotKey(_IHotKey : string);

//------------------------------------------------------------------------------
#doc
   Изменить меню текущего окна на меню
#end
Procedure SetIHotKey(_IHotKey : string);


//==============================================================================
//                                 EVENT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
<brief>Произошло событие _Command.</brief>
   Если нужно заменить стандартную обработку
   события собственной,то вернуть _Command = cmCancel
#end
Event Procedure Event_PutCommand(var _Command : word);

//------------------------------------------------------------------------------
#doc
   Произошло событие изменения текущей позиции
#end
Event Procedure Event_PositionChanged(var _cRec : comp);

//------------------------------------------------------------------------------
#doc
   Произошло событие изменения заголовка окна
#end
Event Procedure Event_SetTitle(_sTitle : string);

//------------------------------------------------------------------------------
#doc
   Произошло событие смены регистра учета
#end
Event Procedure Event_SetKodReg(var _wKodReg : word);

//------------------------------------------------------------------------------
#doc
   Событие заполнения буфера FpOborot при его создании
#end
Event Procedure Event_SetBufferFromParent(var _Buff : type$p_FpOborot);

//------------------------------------------------------------------------------
#doc
   Событие заполнения аналитики из места вызова
#end
Event Procedure Event_GetParentAnalitics(_CAn : TPtr);

//------------------------------------------------------------------------------
#doc
   Событие возникновения каких либо модификаций финопераций
#end
Event Procedure Event_IsBeModification;

//------------------------------------------------------------------------------
#doc
   Освободить обратные ссылки
#end
Procedure FreeLinks;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface EditFpOborot implements iEditFpOborot
#Licensed_Free
#ifdef Atl51
Parameters (
  wIntMode : word;
  wRunMode : word;
  wKodReg  : word;
  cGetRec  : comp;
  pObjDocument : #mTDocument
)
#endif//Atl51
;

#endif // _EditFpOborotObj_Included_
