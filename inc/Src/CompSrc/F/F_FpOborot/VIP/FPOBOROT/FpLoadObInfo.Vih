//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Объектный интерфейс : "Информация о загруженных финоперациях"
//------------------------------------------------------------------------------

#ifndef __FpLoadObInfo_Vih__
#define __FpLoadObInfo_Vih__

#ifdef  ComponentVersion
#component "F_FpOborot"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include FpLoadObInfo.Tbl  // Таблица загруженных финопераций
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Объектный интерфейс : "Информация о загруженных финоперациях"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
ObjInterface IFpLoadObInfo;

  //----------------------------------------------------------------------------
  #doc
     Функция возвращает описание последней ошибки
  #end
  Function GetStLastError : string;

  //----------------------------------------------------------------------------
  #doc
     Включено ли протоколирование загрузки
  #end
  Function GetIsJournalingOn: boolean;

  //----------------------------------------------------------------------------
  #doc
     Запуск диалога установки режима протоколлирования
  #end
  Procedure RunSetJournalingMode;

  //----------------------------------------------------------------------------
  #doc
     Время начала сесии работы пльзователя
  #end
  Function GetDTStartJournaling : _DateTime;

  //----------------------------------------------------------------------------
  #doc
     Была ли загрузжена заданная ФО в заданный бюджет
  #end
  Function GetIsLoadOb(
    _cRec    : comp;  // NRec финоперации   
    _cBudVar : comp;  // копия бюджета      
    _wKodReg : word   // код регистра учета 
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Время загрузки заданной ФО в заданный бюджет
  #end
  Function GetTimeLoadOb(
    _cRec    : comp;  // NRec финоперации  
    _cBudVar : comp;  // копия бюджета     
    _wKodReg : word   // код регистра учета
  ) : Time;

  //----------------------------------------------------------------------------
  #doc
     Добавить информацию о загруженной финоперации
  #end
  Function AddLoadOb(
    _cRec    : comp;  // NRec финоперации
    _cBudVar : comp;  // копия бюджета
    _wKodReg : word;  // код регистра учета                           
    _cStBud  : comp;  // статья бюджета
    _cPeriod : comp   // период бюджета
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Удалить все записи, удовлетворяющие входным параметрам
  #end
  Function DelLoadOb3Seg(
    _cBudVar : comp;  // копия бюджета     
    _wKodReg : word;  // код регистра учета
    _cStBud  : comp   // статья бюджета    
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Удалить все записи, удовлетворяющие входным параметрам
  #end
  Function DelLoadOb4Seg(
    _cBudVar : comp;  // копия бюджета     
    _wKodReg : word;  // код регистра учета
    _cStBud  : comp;  // статья бюджета    
    _cPeriod : comp   // период бюджета    
  ) : boolean;
  
End;

VipInterface FpLoadObInfo implements IFpLoadObInfo
#Licensed_Free
;

Public:
  //----------------------------------------------------------------------------
  #doc
    Destructor интерфейса
  #end
  Constructor Init;

  //----------------------------------------------------------------------------
  #doc
    Destructor интерфейса
  #end
  Destructor  Done;
End;

#endif//__FpLoadObInfo_Vih__
