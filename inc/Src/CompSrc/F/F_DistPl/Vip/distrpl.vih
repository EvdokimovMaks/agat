/*
 ╔══════════════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                                 ║
 ║ Проект        : ГАЛАКТИКА                                                            ║
 ║ Система       : Бухгалтерский контур                                                 ║
 ║ Версия        : 5.84                                                                 ║
 ║ Назначение    : Распределение платежных документов(объектный вызов)                  ║
 ║ Ответственный : Жалейко Алексей Сергеевич                                            ║
 ║ Параметры     : все параметры запуска интерфейса сделаны через DSK и                 ║
 ║ именованные маркеры. Все настройки в окне "Настройки пакетного                       ║
 ║ распределения платежей" зашиты в DSK и маркеры.                                      ║
 ║                                                                                      ║
 ║  = Договор     InitMarker('MDogovor',8,100,10)                                       ║
 ║  - ДО          ReadMyDsk(cDO,'PriDO',isError)                                        ║
 ║  - Дата оплаты платежа, период ReadMyDsk(BegPlat,'PriRPDBegPlat',isError)            ║
 ║                                ReadMyDsk(EndPlat,'PriRPDEndPlat',isError)            ║
 ║  - Организация InitMarker('DistrPl_KatOrg_Marker',8,100,10,false)                    ║
 ║                                                                                      ║
 ║   чтобы читались настройки параметр ReadMyDsk(wSaveSett,'PriRPDwSaveSett',isError)   ║
 ║   должен быть больше нуля                                                            ║
 ║   -------------------------------------------------------------------------          ║
 ║   типы платежных документов       InitMarker('hPLDocTypes',2,100,10,false);          ║
 ║   типы накладных                  InitMarker('hSoprDocTypes',2,100,10,false);        ║
 ║   Отбор платежных документов                                                         ║
 ║   по их статусу                   InitMarker('MKatNotes',8,100,10);                  ║
 ║   направление платежейЖ:                                                             ║
 ║   'отгрузки - входящие платежи',                                                     ║
 ║   'поставки - исходящие платежи',                                                    ║
 ║   'внутренние операции'           ReadMyDsk(wDirPlat,'PriRPDwDirPlat',isError))      ║
 ║   состояние накладных                                                                ║
 ║    'все документы',                                                                  ║
 ║    'оприходованные документы'     ReadMyDsk(wGetNakl,'PriRPDwGetNakl',isError))      ║
 ║                                                                                      ║
 ║   какие платежи отбирать                                                             ║
 ║   'все документы',                                                                   ║
 ║   'только разнесенные по ДО ',                                                       ║
 ║   'только разнесенные частично'                                                      ║
 ║   'только разнесенные полностью   ReadMyDsk(wModePlat,'PriRPDwModePlat',isError)     ║
 ║                                                                                      ║
 ║   способ расчета задолженности по ДО                                                 ║
 ║    1  'Задолженность по платежам',                                                   ║
 ║    2  'Задолженность по отгрузкам',                                                  ║
 ║    3  'Задолженность по платежам с учетом отгрузок',                                 ║
 ║    4  'Сумма по ДО'               ReadMyDsk(wDODebtsCalc,'PriRPDwDODebtsCalc',isError║)
 ║                                                                                      ║
 ║   Платежные документы:                                                               ║
 ║                      [.] Распределять по договорам`                                  ║
 ║                      [.] Осуществлять привязку к ДО`                                 ║
 ║                      [.] Распределять суммы по спецификации ДО`                      ║
 ║                                   ReadMyDsk(wPlWorkMode,'PriRPDwPlWorkMode',isError) ║
 ║                                                                                      ║
 ║   Разрешать привязку ДО при сформированной ТХО',,) : [List 1 'Да','Нет'];            ║
 ║                                   ReadMyDsk(wProvTXO,'PriRPDwProvTXO',isError))      ║
 ║                                                                                      ║
 ║   Учитывать неоплаченные платежи при расчете сумм                                    ║
 ║                                   ReadMyDsk(boPlat,'PriRPDboPlat',isError)           ║
 ║                                                                                      ║
 ║   ТХО               ReadMyDsk(sTXOName,'TXOName',isError)) sTXOName := '';           ║
 ║   Буффер сопрхоза для распределения по ТХО                                           ║
 ║                                   ReadMyDsk(bp_SoprHoz,'bp_SoprHoz',isError          ║
 ║   разрешать привязку ТХО                                                             ║
 ║           ReadMyDsk(wTXO,'wTXO',isError)) wTXO := 0;                                 ║
 ║                                                                                      ║
 ║                                                                                      ║
 ║                                                                                      ║
 ╚══════════════════════════════════════════════════════════════════════════════════════╝
*/

#ifndef __DISTRPL_VIH__
#define __DISTRPL_VIH__

#ifdef ComponentVersion
#Component "F_DistPl"
#end

#include TDocument.vih

#doc
  Пакетное распределение платежа по ДО, накладным, договорам
  Объектный вызов визуального интерфейса                  
#end

ObjInterface ObjDistrPl;

#doc
 Функция запускает интерфейс пакетного распределения платежей.
 Все настройки берутся из заранее подготовленного DSK
#end
  public procedure RunAll;

#doc
 Запуск интерфейса распределения отфильтрованого по контрагенту, дате платежей и ДО. Данные
 берутся из ДО
#end
  public procedure RunOnDO(cDOdist : comp);

end;

#doc
  Объектный интерфейс для работы с настройками
#end
ObjInterface ObjDistrPlTune;

#doc
  Получить ссылку на настройку по умолчанию для юзера по типу отчета и плану счетов<br>
  Если настройки нет - вернет false
#end
  function  ExistDefaultNastr  (wReport: word; cPlanSch: comp; var cReport: comp): boolean;

#doc
  Создать настройку по умолчанию
#end
  function  CreateDefaultNastr (wReport: word; cPlanSch: comp): comp;

#doc
  Получить ссылку на настройку по умолчанию для указанного разреза.<br>
  Если нету - создается новая и возвращается на нее указатель
#end
  function  GetDefaultNastr    (wReport: word; cPlanSch: comp): comp;

#doc
  Загрузить настройку отчета
#end
  procedure LoadNastr          (wReport: word; cReport: comp);

#doc
  Сохранить настройку отчета
#end
  procedure SaveNastr          (wReport: word; cReport: comp);

#doc
  Запустить загрузку настроек
#end
  function Execute            (wReport: word; cReport: comp):boolean;

#doc
  Установить значения параметров и фильтров  по-умолчанию
#end
  function SetDefNastr:boolean;

end;

VipInterface PlDocDistr
  Implements ObjDistrPl, TDocument, ObjDistrPlTune, IGetSomeKontrPrimParameters
  #ifdef Atl51
  Licensed (Free)
  #end
;

#end
