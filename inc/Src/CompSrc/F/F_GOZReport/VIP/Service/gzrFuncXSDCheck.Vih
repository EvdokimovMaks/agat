//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Электронная отчетность ГОЗ"
// Библиотека функций : "Проверка XML по XSD"
//------------------------------------------------------------------------------

#ifndef __gzrFuncXSDCheck_Vih__
#define __gzrFuncXSDCheck_Vih__

#Component "F_GOZReport"

//------------------------------------------------------------------------------
#include gzr_BaseAbstractObj.Vih  // Абстрактный базовый интерфейс : "Object"
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
Type TXmlMultyError = record
  sError1 : string;
  sError2 : string;
End;
Type TXmlMultyErrorList = Array[0..0] of TXmlMultyError;
//------------------------------------------------------------------------------

//==============================================================================
#doc
Библиотека функций : "Проверка XML по XSD"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования
#end
Private ObjInterface IgzrFuncXSDCheck(Igzr_BaseAbstractObj);  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения (множественное)
  #end
  function GetStLastErrorList : TXmlMultyErrorList;
  //----------------------------------------------------------------------------
  #doc
     Очистить список описаний последней ошибки выполнения (множественное)
  #end
  procedure ClearStLastErrorList;
  //#endregion ERROR
  //****************************************************************************

  //============================================================================
  //#region ПРОВЕРКА ДАННЫХ
  //----------------------------------------------------------------------------
  #doc
     Получить путь на каталог расположения XSD файлов
  #end
  function GetXSDFileDir : string;

  //----------------------------------------------------------------------------
  #doc
     Проверить XML файл по заданной XSD схеме
  #end
  function CheckFileByXSD(
    _sXMLFilePath : string;  // путь на XML файл
    _sXSDFilePath : string   // путь на XSD файл
  ) : boolean;
  //#endregion ПРОВЕРКА ДАННЫХ
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface gzrFuncXSDCheck(gzr_BaseAbstractObj) implements IgzrFuncXSDCheck
#Licensed_Free;
Public:
  constructor Init;
  destructor  Done;
End;
//******************************************************************************


#endif//__gzrFuncXSDCheck_Vih__
