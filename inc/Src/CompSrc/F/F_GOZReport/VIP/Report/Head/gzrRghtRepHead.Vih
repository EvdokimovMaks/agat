//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Электронная отчетность ГОЗ"
// Библиотека функций : "Права доступа к отчетам"
//------------------------------------------------------------------------------

#ifndef __gzrRghtRepHead_Vih__
#define __gzrRghtRepHead_Vih__

#Component "F_GOZReport"

//------------------------------------------------------------------------------
#include gzr_BaseAbstractObj.Vih  // Абстрактный базовый интерфейс : "Object"
//------------------------------------------------------------------------------

//==============================================================================
#doc
Библиотека функций : "Права доступа к отчетам"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования
#end
Private ObjInterface IgzrRghtRepHead(Igzr_BaseAbstractObj);  //#region ObjInterface

  //============================================================================
  //#region ПРАВА ДОСТУПА
  //----------------------------------------------------------------------------
  #doc
     Разрешено ли текущему пользователю просматривать отчет по заданному дескриптору
  #end
  function CanViewByUserDescr(
    _repDescr : TDescr;  // "дескриптор пользователя"  отчета
    _repDesGr : TDesGr   // "код группы пользователей" отчета
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Разрешено ли текущему пользователю редактировать отчет по заданному дескриптору
  #end
  function CanEditByUserDescr(
    _repDescr : TDescr;  // "дескриптор пользователя"  отчета
    _repDesGr : TDesGr;  // "код группы пользователей" отчета
    _cRepNote : comp = 0 // ссылка на пояснение к статусу отчета
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Разрешено ли текущему пользователю переводить отчет в заданный статус
  #end
  function GetIsCanSetStatus(
    _cOldNote : comp;    // ссылка на пояснение к старому статусу отчета
    _cNewNote : comp     // ссылка на пояснение к новому статусу отчета
  ) : boolean;
  //#endregion ПРАВА ДОСТУПА
  //****************************************************************************

  //============================================================================
  //#region УСТАНОВКА СТАТУСА
  //----------------------------------------------------------------------------
  // Получить статус "по умолчанию"
  function GetDefaultStatus(
  var _wStatus : word;  // код статуса
  var _cStatus : comp   // ссылка на пояснение к статусу отчета
  ) : boolean;

  //------------------------------------------------------------------------------
  // Запустить выбор статуса
  function RunPickStatus(
      _cRec    : comp;  // ссылка на отчет
  var _wStatus : word;  // код статуса
  var _cStatus : comp   // ссылка на пояснение к статусу отчета
  ) : boolean;

  //------------------------------------------------------------------------------
  // Запустить просмотр статуса
  function RunViewStatus(
      _cRec    : comp;  // ссылка на отчет
      _wStatus : word;  // код статуса
      _cStatus : comp   // ссылка на пояснение к статусу отчета
  ) : boolean;
  //#endregion УСТАНОВКА СТАТУСА
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface gzrRghtRepHead(gzr_BaseAbstractObj) implements IgzrRghtRepHead
#Licensed_Free;
Public: //#region Public
  constructor Init;
  destructor  Done;
End; //#endregion Public
//******************************************************************************


#endif//__gzrRghtRepHead_Vih__
