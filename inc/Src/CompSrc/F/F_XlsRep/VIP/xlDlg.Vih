//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - компонента "Excel-отчеты"
// Стандартные диалоги формирования Excel-отчетов
//------------------------------------------------------------------------------

#ifndef _ViewXlSRepDlg_Included_
#define _ViewXlSRepDlg_Included_

#ifdef  ComponentVersion
#component "F_XLSRep"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Стандартные диалоги формирования Excel-отчетов<br>
#end
ObjInterface iViewXlSRepDlg;

//==============================================================================
//                                INIT-DONE
//******************************************************************************
//------------------------------------------------------------------------------
#doc
   Инициализация параметров интерфейса<br>
#end
Function InitParam(
  _wRunMode     : word;
  _wXLTMode     : word;
  _wRetMode     : word;
  _sDBFileName  : string;
  _sXLTFileName : string;
  _sRepFileName : string
) : boolean;

//==============================================================================
//                                 FIELDS
//******************************************************************************
//------------------------------------------------------------------------------
#doc
   Получить режим формирования Excel-отчетов
#end
Function GetXLTMode : word;
//------------------------------------------------------------------------------
#doc
   Получить имя файла XLS-базы данных
#end
Function GetDBFileName : string;
//------------------------------------------------------------------------------
#doc
   Получить имя файла XLT-шаблона
#end
Function GetXLTFileName : string;
//------------------------------------------------------------------------------
#doc
   Получить имя файла XLS-отчета
#end
Function GetRepFileName : string;

//------------------------------------------------------------------------------
#doc
   Установить режим формирования Excel-отчетов
#end
Function SetXLTMode(_Value : word) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить имя файла XLS-базы данных
#end
Function SetDBFileName(_Value : string) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить имя файла XLT-шаблона
#end
Function SetXLTFileName(_Value : string) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить имя файла XLS-отчета
#end
Function SetRepFileName(_Value : string) : boolean;

//==============================================================================
//                                 DIALOG
//******************************************************************************
//------------------------------------------------------------------------------
#doc
<brief>Диалог формирования отчетов по ID-отчета</brief>
   Диалог формирования отчетов по ID-отчета:
   <ul> 
   <li> _wRunMode     - режим запуска
     <ul> 
     <li> cgxlRepDlg_MakeXLT       - стандартный диалог формирования/отладки XLT - шаблонов<br>
     <li> cgxlRepDlg_MakeRep       - создание отчета с предварительным сохранением<br>
     <li> cgxlRepDlg_TuneRep       - создание отчета без сохранения<br>
     </ul> 
   <li> _RepID        - идентификатор отчета
   <li> _wRetMode     - если создается шаблон то возвращается 1
   <li> _DBFileName   - файл базы данных
   <li> _XLTFileName  - файл шаблона
   <li> _RepFileName  - файл отчета
   </ul> 
#end
Function RunRepIDDialog(
    _wRunMode    : word;
var _wRetMode    : word;
var _DBFileName  : string;
var _XLTFileName : string;
var _RepFileName : string;
    _RepID       : string
) : boolean;


//==============================================================================
//                                 EVENT
//******************************************************************************
//------------------------------------------------------------------------------
#doc
   Событие при формировании XLS-отчета
#end
Event Function Event_RunReport : boolean;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface ViewXlSRepDlg implements iViewXlSRepDlg
#ifdef  Atl51
  Licensed (FREE)
Parameters (
  wRunMode     : word;       //  cgxlRepDlg_MakeXLT     - стандартный диалог формирования/отладки XLT - шаблонов
                             //  cgxlRepDlg_MakeRep     - создание отчета с предварительным сохранением
                             //  cgxlRepDlg_TuneRep     - создание отчета без сохранения

  wXLTMode     : word;       //  cgxlRepDlg_CreateRep   - формирование отчета
                             //  cgxlRepDlg_CreateTempl - создание шаблона
  wRetMode     : word;       //  если создается шаблон то возвращается 1
  sDBFileName  : string;     //  файл базы данных
  sXLTFileName : string;     //  файл шаблона
  sRepFileName : string      //  файл отчета
)
#endif//Atl51
;

#endif//_ViewXlSRepDlg_Included_

