//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Платежный календарь"
// Объектный интерфейс для работы с ValutDoc
//------------------------------------------------------------------------------

#ifndef __AVALUTDOC_VIH__
#define __AVALUTDOC_VIH__
//**************************************************************
#ifndef __TYPE_TVALUTDOC__
#define __TYPE_TVALUTDOC__
#ifdef ComponentVersionInDict
  #include IValutDoc.vih
  Public
#end
  Type TValutDoc = record as Table ValutDoc;
#end //__TYPE_TVALUTDOC__

#include fintypes.vpp // TSoprHoz

#ifdef ComponentVersion
#component "F_ValutDoc"
#end

#doc
Объектный интерфейс для работы с ValutDoc
#end
ObjInterface objValutDoc;

  ///////////////////// СОЗДАНИЕ И УДАЛЕНИЕ ///////////////////////////
  #doc
  Заполнение переданного буфера таблицы ValutDoc значениями по-умолчанию
  #end
  Function ValutDoc_Fill(var bufValutDoc: TValutDoc;
                         _TiDkGal: word): boolean;
  #doc
  Установка банков обеих валют в переданном буфере в зависимоти от типа валютно-обменного документа
  #end
  Function ValutDoc_SetBanks(var bufValutDoc: TValutDoc;
                             _cBankPlat: comp; _cBankPol: comp): boolean;
  #doc
  Установка обеих валют и сумм в зависимоти от типа валютно-обменного документа
  #end
  Function ValutDoc_SetSums(var bufValutDoc: TValutDoc;
                            _cValFrom: comp; _SumFrom: double;
                            _cValTo  : comp; _SumTo  : double): boolean;

  #doc
  Заполнение буфера ValutDoc назначением из 6 заданных строковых значений
  #end
  Function ValutDoc_SetUseTarget(var bufValutDoc: TValutDoc;
                                          _UseTarget1: String;
                                          _UseTarget2: String;
                                          _UseTarget3: String;
                                          _UseTarget4: String;
                                          _UseTarget5: String;
                                          _UseTarget6: String)
                                                     : boolean;

  #doc
  Проверка максимального количества записей (Демо-режим)
  #end
  Function ValutDoc_CheckMaxRecords(_Message: word): boolean;

  #doc
  Добавление записи
  #end
  Function ValutDoc_Insert(bufValutDoc: TValutDoc): comp;

  //////////////////////////// SOPRHOZ ////////////////////////////////
  #doc
  Заполнение SoprHoz по ValutDoc
  #end
  Function SoprHoz_FillByValutDoc(var bufSoprHoz: TSoprHoz;
                                  bufValutDoc: TValutDoc;
                                  _dValCurse: date): boolean;

  #doc
  Формирование записи в SoprHoz
  #end
  Function SoprHoz_Check(bufValutDoc: TValutDoc; _dValCurse: date): comp;
  
  #doc
  Удаление SoprHoz при удалении ValutDoc
  #end
  Function SoprHoz_DeleteByValutDoc(bufValutDoc: TValutDoc): boolean;

End;

VipInterface viValutDoc
  implements objValutDoc
#ifdef ATL51
  licensed   (FREE)
#end
;
//**************************************************************
#end //__AVALUTDOC_VIH__
