//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.85 - Векселя/кредиты
// Объектный интерфейс для работы с правами доступа по статусам
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
// Передаваемые параметры:
//   myNastr   - признак проверки активности настройки (true - проверять)
//   myTiDk    - тип документа
//   mySysOper - тип настройки
//               1 - цепочка возможных переводов статуса документа независимо
//                   от пользователя
//               2 - статусы в которые может переводить документ конкретный
//                   пользователь
//               3 - права доступа к документу в конкретном статусе конкретного
//                   пользователя
//               4 - статус по умолчанию для конкретного пользователя
//   myDescr   - пользователь
//   myOp      - признак вывода предупреждающих сообщений
//               true  - выводить
//               false - нет
//------------------------------------------------------------------------------

#ifndef _StatUser_vih_Included
#define _StatUser_vih_Included

#ifdef ComponentVersion
#component "F_Veks"
#end

#doc
Объектный интерфейс для работы с правами доступа по статусам
#end

ObjInterface ObjStatUser;

//------------------------------------------------------------------------------
#doc
Определение активности настройки
#end
Function Stat_Nastr(myTiDk : word) : boolean;

#doc
Определение статуса по умолчанию для указанного типа документа конкретного пользователя
#end
// Определение статуса по умолчанию для документа типа myTiDk пользователя myDescr
Function Descr_Stat_U(myNastr  : boolean;
                      myTiDk   : word;
                      myDescr  : string[20];
                  var NRecStat : comp) : boolean;

#doc
Есть ли у пользователя доступ к данному типу документов
#end
Function Descr_HazAccess(myNastr : boolean;
                         myTiDk  : word;
                         myDescr : string[20]): boolean;

#doc
Права доступа к документу в указанном статусе конкретного пользователя,
если настройки нет, то проверяется настройка папки "Прочие"
#end
// Права доступа к документу в статусе NRecStat конкретного пользователя CurDescr,
// если настройки нет, то проверяется настройка папки 'Прочие'
Function Descr_Stat_D(myNastr  : boolean;
                      myTiDk   : word;
                      myDescr  : string[20];
                      NRecStat : comp) : boolean;

#doc
Права доступа к документу в статусе NRecStat конкретного пользователя CurDescr.
Если настройки нет, то проверяется настройка папки 'Прочие' (без учета полный доступ / смена статуса), 
нужен для пакетной установки статуса накладных ERP-1050
#end
//Права доступа к документу в статусе NRecStat конкретного пользователя CurDescr.
//Если настройки нет, то проверяется настройка папки 'Прочие' (без учета полный доступ / смена статуса), 
//нужен для пакетной установки статуса накладных ERP-1050
Function Descr_Stat_AllTipD(myNastr  : boolean;
                            myTiDk   : word;
                            myDescr  : tDescr;
                            NRecStat : comp) : boolean;

#doc
Определение возможности перевода документа заданного типа конкретному пользователю
в указанный статус
#end
// Определение возможности перевода документа типа myTiDk пользователю myDescr
// в статус NRecStat
Function Descr_Stat(myNastr  : boolean;
                    myTiDk   : word;
                    myDescr  : string[20];
                    NRecStat : comp) : boolean;

#doc
Возможность выбора документов в спецификацию в указанном статусе, если шапка
документа в другом статусе
#end
// Возможность выбора документов в спецификацию в статусе NRecStat1, если шапка
// документа в статусе NRecStat2
Function Stat1_Stat2(myNastr   : boolean;
                     myTiDk    : word;
                     NRecStat1 : comp;
                     NRecStat2 : comp) : boolean;

#doc
Статус документа конкретного пользователя
#end
Function UserStat(myNastr   : boolean;
                  myTiDk    : word;
                  mySysOper : word;
                  myDescr   : string[20];
              var NRecStat1 : comp;
                  NRecStat2 : comp;
                  myOp      : boolean) : boolean;

//------------------------------------------------------------------------------
end;

#doc
Объектный интерфейс для работы с правами доступа по статусам
#end

ObjInterface ObjStatUserV2(ObjStatUser);

//------------------------------------------------------------------------------
#doc
Права доступа на изменение статуса документа в статусе NRecStat конкретного пользователя CurDescr.
Если настройки нет, то проверяется настройка папки 'Прочие'
#end
Function Descr_Stat_DS(myNastr  : boolean;
                       myTiDk   : word;
                       myDescr  : tDescr;
                       NRecStat : comp) : boolean;
//------------------------------------------------------------------------------
end;

//------------------------------------------------------------------------------
VipInterface VipStatUser Implements ObjStatUserV2 Licensed(Free);
//------------------------------------------------------------------------------
#end // _StatUser_vih_Included
