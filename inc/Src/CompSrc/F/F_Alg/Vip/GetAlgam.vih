//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.1 - ОС и НМА
// Выбор алгоритма, вычисление значений по алгоритмам (через LotExpression)
//------------------------------------------------------------------------------

#ifndef __GETALGAM_VIH__
#define __GETALGAM_VIH__

#Component "F_Alg"

#doc
  Объект для доступа к интерфейсу выбора алгоритмов расчета
#end

ObjInterface ObjGetAlgAmort;
end;

ObjInterface ObjGetAlgAmort1;
//------------------------------------------------------------------------------
#doc
  Спозиционироваться на запись в таблице
#end
  Function SetPositionInTable(sNameTable: string; pcRec: comp): boolean;
//------------------------------------------------------------------------------
// Пустышка
  Function FullCheckAlgoritm(_cOsAlg :comp) : boolean;
//------------------------------------------------------------------------------
#doc
  Вычисление значения алгоритма
#end
  Function GetAlgoritmValue(_cOsAlg :comp; var rez : TSumma) : boolean;
//------------------------------------------------------------------------------
#doc
  Упоминание "строки" в алгоритме расчета
#end
  Function SearchSubStrInAlg(_cOsAlg: comp; sSubStrInAlgoritm : string) : boolean;
//------------------------------------------------------------------------------
#doc
  Строка формулы алгоритма расчета, в которой произошла ошибка при расчете
#end
  Function GetFormulaWithError(_cOsAlg : comp): string;
//------------------------------------------------------------------------------
end;

ObjInterface ObjGetAlgAmort2;
#doc
  Проверка корректности алгоритма
#end
  Function CheckAlgoritm(_cOsAlg :comp; isMes: boolean) : boolean;
end;

//==============================================================================
VipInterface GetAlgAmort Implements ObjGetAlgAmort, ObjGetAlgAmort1, ObjGetAlgAmort2
  Licensed (Free)
  Parameters
  (
    c1       : comp;   // NRec алгоритма возвращается,
                       // предается (-1 - для заполнения, NRec алгоритма - для выбора)
    strTitle : string; // часть названия окна (пр. 'начисления амортизации')
    TD       : word;   // тип документа
    c2       : word;   // 1 - групповой выбор,
                       // 0 - одиночный
    oldp     : comp    // не надо высвечивать данную запись
  );

#end // __GETALGAM_VIH__
