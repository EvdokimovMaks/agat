//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 8.0 - Бухгалтерский контур
// Объект обработки платежных документов (PlPor)
//------------------------------------------------------------------------------

#ifndef __PlPor__vih__
#define __PlPor__vih__

#include TDocument.vih
#include ObjExtStr.Vih
#include PlPor.obj

#ifdef ComponentVersion
#Component "F_PlPor"
#end

VipInterface PlPor Implements ObjPlPor, TDocument, TDocument1, ObjPlPorExt, ObjPlPorExt1, ObjPlPorExtPrint, ObjPlPorExtPrint1, ObjPlPorExt2, ObjPlPorAlg
  #ifdef Atl51
  // Надо бы как то сделать контроль по Типам документов
  Licensed (#include PlPor.lih )
  Parameters (myTiDkGal, myTiDkUser : word; NRecFinDoc : comp)
  #end
;

//------------------------------------------------------------------------------
#doc
Проверка реализации точек расширения.
При существовании обработчиков точек должна возвращать false
#end
ExtensionPoint epKO_isNotExistExtPoint;

//------------------------------------------------------------------------------
#doc
Инициализация регистрации ККТ
cDoc - NREC документа
sAdmPass - пароль администратора системы
sOperatorPass - пароль оператора для ККТ
wOperation - тип операции (0-не определен; 1-продажа; 2-возврат продажи; 3-покупка)
pStr - объект работы со строками
#end
ExtensionPoint epKO_KKTInitConnection(cDoc: comp; sAdmPass, sOperatorPass : string; wOperation : word; pStr : iObjExtStr);

//------------------------------------------------------------------------------
#doc
Регистрация оплаченной позиции документа
wTiDk - тип документа
wOperation - тип операции (0-не определен; 1-продажа; 2-возврат продажи; 3-покупка)
sAdmPass - пароль администратора системы
sOperatorPass - пароль оператора для ККТ
sNamePos - наименование мц/услуги
dKol     - количество
dPrice   - цена
dTaxRate - ставка
dSumTax  - сумма налога
dSumTaxForOne - не округленная сумма налога за 1 позицию
bModeTax - входимость налога
pObject  - ссылка на драйвер кассового аппарата
#end
ExtensionPoint epKO_KKTRegistration(wTiDk, wOperation: word; sAdmPass, sOperatorPass, sNamePos: string; dKol, dPrice, dTaxRate, dSumTax, dSumTaxForOne: double; bModeTax : boolean; pObject : pointer);

//------------------------------------------------------------------------------
#doc
Завершение регистрации ККТ
cDoc - NREC документа
sAdmPass - пароль администратора системы
sOperatorPass - пароль оператора для ККТ
wPaymentType - тип оплаты (0 - наличные; 1- банковская карта)
pObject  - ссылка на драйвер кассового аппарата
pStr - объект работы со строками
#end
ExtensionPoint epKO_KKTDoneConnection(cDoc: comp; sAdmPass, sOperatorPass : string; wPaymentType : word; pObject : pointer; pStr : iObjExtStr);

//------------------------------------------------------------------------------
#doc
Закрытие смены в ККТ
sAdmPass - пароль администратора системы
sOperatorPass - пароль оператора для ККТ
#end
ExtensionPoint epKO_KKTCloseSession(sAdmPass, sOperatorPass : string);

//------------------------------------------------------------------------------
#end // __PlPor__vih__
