//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Библиотека функций : "Проверка корректности периодов планирования"
//------------------------------------------------------------------------------

#ifndef __FpChkPeriod_Vih__
#define __FpChkPeriod_Vih__

//------------------------------------------------------------------------------
#include LBadRec.Tbl     // Сервисная таблица: "Список некорректный записей"
//------------------------------------------------------------------------------

#ifdef  ComponentVersion
#component "F_FpCatalog"
#endif //ComponentVersion

//------------------------------------------------------------------------------
#doc
Библиотека функций : "Проверка корректности периодов планирования"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iLibCheckFpPeriod;

//==============================================================================
// Описание последней ошибки 
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки<br>
#end
//------------------------------------------------------------------------------
Function GetStLastError : string;


//==============================================================================
// FPTPER CHECK
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Выравнивает дату согласно установленным выравниваниям<br>
#end
//------------------------------------------------------------------------------
Function AlignTPerDate(
  _BuffSpTPer : type$p_FpTPer;
  _dtDate     : date
) : date;
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Запуск функции проверки корректности<br>
#end
Function CheckAlignTPerDate(
  _cSpTPer    : comp
) : boolean;

//==============================================================================
// FIELDS CHECK
//------------------------------------------------------------------------------
#doc
   Формирует стандартное наименование периода<br>
#end
//------------------------------------------------------------------------------
Function MakeStdPeriodName(
  _BuffSpTPer : type$p_FpTPer;
  _dtBeg      : date;
  _dtEnd      : date;
  _Npp        : word
) : string;
//------------------------------------------------------------------------------
#doc
   Устанавливает стандартное наименование периода<br>
#end
//------------------------------------------------------------------------------
Function BufSetStdPeriodName(
var  _BuffPeriod : type$p_FpPeriod
) : boolean;
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Установить значения свойства по Nrec-у таблицы<br>
#end
Function SetStdPeriodName(
    _cPeriod : comp
) : boolean;

//------------------------------------------------------------------------------
#doc
   Корректно устанавливает даты периода (с корректировкой размера периода)<br>
#end
//------------------------------------------------------------------------------
Function BufSetCorrectDate(
var _BuffPeriod : type$p_FpPeriod;
    _dtBeg      : date;
    _dtEnd      : date
) : boolean;
//------------------------------------------------------------------------------
#doc
   Корректирует размер периода<br>
#end
//------------------------------------------------------------------------------
Function BufSetCorrectSize(
var _BuffPeriod : type$p_FpPeriod
) : boolean;
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Установить значения свойства по Nrec-у таблицы<br>
#end
Function SetCorrectSize(
    _cPeriod : comp
) : boolean;


//==============================================================================
// PREV CHECK
//------------------------------------------------------------------------------
#doc
   Проверка ссылок на предыдущие периоды по заданному типу периода<br>
#end
//------------------------------------------------------------------------------
Function CheckPrev(
  _wMode     : word;   // режим запуска 
  _cMainTPer : comp    // ссылка на главный тип периода
) : boolean;
//------------------------------------------------------------------------------
#doc
   Проверка ссылок на предыдущие периоды по всем типам периода<br>
#end
//------------------------------------------------------------------------------
Function  CheckPrevForAllTPer(
  _wMode     : word    // режим запуска 
) : boolean;


//==============================================================================
// CODE CHECK
//------------------------------------------------------------------------------
#doc
   Проверка кодов для сортировки<br>
#end
//------------------------------------------------------------------------------
Function CheckCode(
  _cMainTPer : comp    // ссылка на главный тип периода
) : boolean;


//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface LibCheckFpPeriod implements iLibCheckFpPeriod
#Licensed_Free
;

#endif//__FpChkPeriod_Vih__

