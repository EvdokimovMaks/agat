//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Работа с внешними факторами и др. индексами
//------------------------------------------------------------------------------

#ifndef  _ObjAllIndex_Included_
#define  _ObjAllIndex_Included_

#ifdef  ComponentVersion
#component "F_FpCatalog"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Работа с внешними факторами и др. индексами<br>
#end
ObjInterface tAllIndexObjInterface;

//------------------------------------------------------------------------------
#doc
   Запуск функции удаления<br>
#end
Function DeleteAllIndex : boolean;

//------------------------------------------------------------------------------
#doc
   Закачка в память индекса и его значений для таблицы<br>
#end
Procedure RefreshIndexTable(wTbl: word);

//------------------------------------------------------------------------------
#doc
   Получить значение индекса с учетом иерархии периодов<br>
#end
Function isGetValIndexPP(cID: comp;
                         cPP: comp;
                  var SumInd: double) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить значение индекса<br>
#end
Function GetIndexValue(
                  cIndRec: comp;      //NRec индекса
                      cPP: comp;      //период
                    wType: word;      //тип индекса
                    wMode: word;      //маска приоритетов параметров для подбора индекса
                     wTbl: word;      //таблица
                     cRec: comp;      //запись
                      cCO: comp;      //ЦО
                     cVar: comp;      //вариант
                     cVal: comp;      //валюта
           var IndexValue: double     //найденный индех
                     ) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить новое значение с учетом индекса<br>
#end
Function GetNewValues(cIndRec : comp; //NRec индекса
                      cPP: comp;      //период
                    wType: word;      //тип индекса
                    wMode: word;      //маска приоритетов параметров для подбора индекса
                     wTbl: word;      //таблица
                     cRec: comp;      //запись
                      cCO: comp;      //ЦО
                     cVar: comp;      //вариант
                     cVal: comp;      //валюта
                   SumOld: double     //старая сумма
                     ) : double;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface ObjAllIndex implements tAllIndexObjInterface
#Licensed_Free
;

#endif//_ObjAllIndex_Included_
