//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Управление бюджетом"
// Интерфейс редактирования : "Атрибуты статьи бюджета"
//------------------------------------------------------------------------------

#ifndef __FpExtEditAttStBud_Vih__
#define __FpExtEditAttStBud_Vih__

#ifdef  ComponentVersion
#component "F_FpCatalog"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Интерфейс редактирования : "Атрибуты статьи бюджета"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface IFpExtEditAttStBud;

  //============================================================================
  //                                  ERROR
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает описание последней ошибки
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывод сообщения последней ошибки
  #end
  Function RunShowError : boolean;
  //****************************************************************************


  //============================================================================
  //                                  INIT
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Инициализация параметров интерфейса
  #end
  Function InitParam(
    _wIntMode  : word;           // режим запуска (cgiNo, cgiPick, ...) см.GLOCONST.INC
    _BuffStBud : type$p_FpStBud  // буффер статьи бюджета                              
  ) : boolean;
  //****************************************************************************


  //============================================================================
  //                                 EVENT
  //----------------------------------------------------------------------------
  //----------------------------------------------------------------------------
  #doc
     Требование переинициализации по параметрам
  #end
  Event Procedure Event_NeedReInitParam;

  //============================================================================
  // HOTKEY
  //----------------------------------------------------------------------------
  #doc
     Событие при запуске меню
  #end
  Event Function Event_RunMenu : boolean;
  //----------------------------------------------------------------------------
  #doc
     Выполнение команды меню
  #end
  Event Function Event_PutCommand(_Command : word) : boolean;

  //============================================================================
  // Атрибуты статьи
  //----------------------------------------------------------------------------
  #doc
     Событие при установке валюты стьтьи
  #end
  Event Procedure Event_SetAttr_Valut(_Value : comp);
  //----------------------------------------------------------------------------
  #doc
     Событие при установке единицы измерения стьтьи
  #end
  Event Procedure Event_SetAttr_EdIzm(_Value : comp);
  //----------------------------------------------------------------------------
  #doc
     Событие при установке атрибута "внутренние обороты"
  #end
  Event Procedure Event_SetAttr_VnObr(_Value : boolean);
  //----------------------------------------------------------------------------

  //============================================================================
  // Агрегация по иерархии статей
  //----------------------------------------------------------------------------
  #doc
     Событие при установке атрибута: Агрегация по иерархии статей - не является агрегатом
  #end
  Event Procedure Event_SetAgrHierSB_NotAgr(_Value : boolean);
  //----------------------------------------------------------------------------
  #doc
     Событие при установке атрибута: Агрегация по иерархии статей - не входит в вышестоящий агрегат
  #end
  Event Procedure Event_SetAgrHierSB_NotInc(_Value : boolean);
  //----------------------------------------------------------------------------

  //============================================================================
  // Агрегация по периодам
  //----------------------------------------------------------------------------
  #doc
     Событие при установке атрибута: Агрегация по периодам - сумма
  #end
  Event Procedure Event_SetAgrHierPP_Summa (_Value : boolean);
  //----------------------------------------------------------------------------
  #doc
     Событие при установке атрибута: Агрегация по периодам - входящий остаток 
  #end
  Event Procedure Event_SetAgrHierPP_InpSld(_Value : boolean);
  //----------------------------------------------------------------------------
  #doc
     Событие при установке атрибута: Агрегация по периодам - исходящий остаток
  #end
  Event Procedure Event_SetAgrHierPP_OutSld(_Value : boolean);
  //----------------------------------------------------------------------------
  #doc
     Событие при установке атрибута: Агрегация по периодам - среднее арифметическое
  #end
  Event Procedure Event_SetAgrHierPP_AVG_PP(_Value : boolean);
  //----------------------------------------------------------------------------
  #doc
     Событие при установке атрибута: Агрегация по периодам - сальдо
  #end
  Event Procedure Event_SetAgrHierPP_SSaldo(_Value : boolean);
  //----------------------------------------------------------------------------

  //============================================================================
  // Расчет формул
  //----------------------------------------------------------------------------
  #doc
     Событие при установке режима: Расчет формул - на каждом уровне   
  #end
  Event Procedure Event_SetFormulaLevel_AllLevel  (_Value : boolean);
  //----------------------------------------------------------------------------
  #doc
     Событие при установке режима: Расчет формул - только на детальном уровне
  #end
  Event Procedure Event_SetFormulaLevel_OnlyDetail(_Value : boolean);
  //----------------------------------------------------------------------------
  #doc
     Событие при установке режима: Расчет формул - только на уровне статьи   
  #end
  Event Procedure Event_SetFormulaLevel_OnlyStBud (_Value : boolean);

  //----------------------------------------------------------------------------
  #doc
     Событие при установке признака: Рассчитывается по формулам
  #end
  Event Procedure Event_SetIsFormulaCalc(_Value : boolean);
  //****************************************************************************

End; // ObjInterface


//==============================================================================
VipInterface FpExtEditAttStBud implements IFpExtEditAttStBud
#Licensed_Free;
Public:
  Constructor Init;
  Destructor  Done;
End;


#endif//__FpExtEditAttStBud_Vih__

