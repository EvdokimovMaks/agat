//------------------------------------------------------------------------------
//    Public-функции для работы с соответствиями Ролей и Аналитик (RoleKAU)
//                     реализация в oRoleKAU.vip
//------------------------------------------------------------------------------

#ifdef ComponentVersion
#component "F_An"
#end

#doc
Функции работы с соответствиями ролей и аналитик.
#end
ObjInterface oRoleKAUObjInterface;

#doc
Создает новое соответствие Роли и Аналитики. Если создаст, то вернет True.
#end
Function AddRec (pRole_  : comp;   // RoleKAU.cRole
                 pKAU_   : word;   // RoleKAU.KodGrKau
             var pNRec   : comp;   // если создаст, то вернет RoleKAU.NRec, иначе =0
                 pIsMess : boolean // выдавать ли Error-сообщения
                )        : boolean;

#doc
Проверяет корректность обновления таблицы RoleKAU.
#end
Function IsUpdate (pRole_  : comp;   // RoleKAU.cRole
                   pKAU_   : word;   // RoleKAU.KodGrKau
                   pNrec_  : comp;   // RoleKAU.NRec (если новая, то =0)
                   pWhatGr_: word;   // группировка по: 0-Ролям; 1-Аналитикам
                   pIsMess : boolean // выдавать ли сообщения
                  )        : boolean;

#doc
Возвращает следующий номер в группе RoleKAU.
#end
Function NextNpp (pRole_   : comp;  // RoleKAU.cRole
                  pKAU_    : word;  // KatKAU.KodGroup
                  pWhatGr_ : word   // группировка по: 0-Ролям; 1-Аналитикам
                 )         : word;

#doc
Перенумеровывает все позиции в группе RoleKAU.
#end
Function RecalcNpp (pRole_   : comp;  // RoleKAU.cRole
                    pKAU_    : word;  // KatKAU.KodGroup
                    pWhatGr_ : word   // группировка по: 0-Ролям; 1-Аналитикам
                   )         : boolean;

end;
VipInterface oRoleKAU implements oRoleKAUObjInterface
#ifdef ATL51
  licensed (FREE)
#end
;
