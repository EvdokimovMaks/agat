//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Электронная отчетность РБ"
// Абстрактный интерфейс редактирования: "Редактор отчета"
//------------------------------------------------------------------------------

#ifndef __TRBBaseRepEditor_Vih__
#define __TRBBaseRepEditor_Vih__

#Component "F_TBYReport"

//------------------------------------------------------------------------------
#include TRB_ScrnAbstractEnt.Vih  // Абстрактный визуальный интерфейс : "Screen"
#include TRBRLogRepEditor.Obj     // Библиотека функций : "Лог расчета"
#include TaxScriptHolder.Obj      // Библиотека функций : "Сервис работы со скриптами"
//------------------------------------------------------------------------------

//==============================================================================
#doc
Абстрактный интерфейс редактирования: "Редактор отчета"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface ITRBBaseRepEditor(ITRB_ScrnAbstractEnt);  //#region ObjInterface

  //----------------------------------------------------------------------------
  //#region INIT/DONE
  //----------------------------------------------------------------------------
  #doc
     Инициализировать параметры интерфейса
  #end
  function InitParam(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOconst.INC
    _cGetRec  : comp   // ссылка на запись
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс (модально)
  #end
  function RunThisInterfaceModal(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOconst.INC
    _cGetRec  : comp   // ссылка на запись
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс (не модально)
  #end
  function RunThisInterfaceNoModal(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOconst.INC
    _cGetRec  : comp   // ссылка на запись
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Освободить ссылки на объекты, провоцирующие циклические зависимости
  #end
  procedure FreeCrossVipRef;
  //#endregion INIT/DONE
  //----------------------------------------------------------------------------

  //----------------------------------------------------------------------------
  //#region METHODS
  //#endregion METHODS
  //----------------------------------------------------------------------------

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface TRBBaseRepEditor(TRB_ScrnAbstractEnt) implements
  ITRBBaseRepEditor
, ITRBRLogRepEditor
, ObjTaxScriptHolder
#Licensed_Free;
Public:
  constructor Init;
  destructor  Done;

  function  ITRBBaseRepEditor.GetIName     : string;
  function  ITRBBaseRepEditor.GetIHead     : string;
  function  ITRBBaseRepEditor.GetIHotKey   : string;
  procedure ITRBBaseRepEditor.ReReadAllTables;

  function  ITRBBaseRepEditor.CanEditTbl   : boolean;
  function  ITRBBaseRepEditor.CanEditRec   : boolean;

  function  ITRBBaseRepEditor.InitParam(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOconst.INC
    _cGetRec  : comp   // ссылка на запись
  ) : boolean;
  function  ITRBBaseRepEditor.InitGlobal   : boolean;
  function  ITRBBaseRepEditor.DoneGlobal   : boolean;

  function  StdInitParam : boolean;
  function  StdDoneParam : boolean;

  function  myAutoGen_GetCurFieldPath : string;
  function  myAutoGen_GetFieldIDByPath(_sPath : string) : LongInt;
  function  myAutoGen_GetPageIDByPath (_sPath : string) : string;
  function  GetCurFieldPath : string;
  function  GetFieldIDByPath(_sPath : string) : LongInt;
  function  GetPageIDByPath (_sPath : string) : string;

  procedure CheckFieldsState;

  function  OnNavigator_PosChanged : boolean;
  function  OnNavigator_AddRec     : boolean;
  function  OnNavigator_DelRec     : boolean;
  function  BuildNavigator         : boolean;

  function  RunCalcVisable         : boolean;
  function  RunCheckReport         : boolean;
  function  RunReCalcReport        : boolean;
  function  RunExportData          : boolean;
  function  RunImportData          : boolean;
End;
//******************************************************************************


#endif//__TRBBaseRepEditor_Vih__
