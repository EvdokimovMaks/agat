//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.1 - Основные средства
// Интерфейс настройки строк формы № 11
//------------------------------------------------------------------------------

#ifndef __FORM11_VIH__
#define __FORM11_VIH__

#Component "F_OSREP"

#doc
Объектный интерфейс для работы с расчетными коэффициентами при переоценке ОС
#end

ObjInterface ObjForm11;

#doc
Функция для удаления карточек из настройки формы 11 для всех строк
#end
// Функция для удаления карточек из настройки формы 11 для всех строк
function DelAllNastrForm11(cpKatOs : comp) : word;
//------------------------------------------------------------------------------
#doc
  Наличие привязанной позиции спецификации к настройке строки формы 11
#end
  // pwMode = 0 - для текущей настройки
  //        = 1 - включае привязку к подчиненным строкам
  // Возвращает первый KatForm.NREc привязанной спецификацией
  Function GetKatFormWithLinkSpForm(cRecForm : comp; pwMode : word) : comp;
//------------------------------------------------------------------------------
#doc
   Удаление строки настройки формы 11
#end
  // pwMode: 0 - удалить только текущую запись и спецификацию
  //     and 1 - удалить текущую запись со всеми подчиненными ( + спецификацию)
  Function DeleteKatForm(cRecForm : comp; pwMode : word; pbMess : boolean) : word;

//------------------------------------------------------------------------------
#doc
  Получить NREC настройки строки формы по номеру строки
#end
  Function GetCurrentKatForm( SourceParamNum : string ) : comp;
//------------------------------------------------------------------------------
#doc
  получить NREC настройки строки формы по "номеру строки"
#end
  Function GetParentKatForm( SourceParamNum : string ) : comp;

 // Создать иерархию для одной записи
 Procedure DoIerarh (cKatForm: comp);

// Обновить поле DopParamNum по номеру строки
 Procedure UpdateDopStrForm (ParamNum, DopStr : string);

 // Обновление/Создание строки формы по номеру строки. Для утилиты конвертации
 function UpdateStrForm (
                      _OldParamNum : string; //  "Номер строки",  старый
                      _ParamNum    : string; //  "Номер строки",
                      _sParent     : string; //  "Вышестоящий показатель",
                      _isLeaf      : word;   //  "Признак листа"
                      _FilialNo    : word;   //  "Подраздел",
                      _ParamName   : string  //  "Наименование показателя",
                     ) : word;


//добавление записи в KatForm при закачке
procedure FillKatFormNew (
                      pParamNum  : string; //  "Номер строки",
                      sParent    : string;  //  "Вышестоящий показатель",
                      pisLeaf    : word;   //  "Признак листа"
                      pFilialNo  : word;   //  "Подраздел",
                      pParamName : string  //  "Наименование показателя",
                     );

// Удалить строку формы по номеру строки
Procedure DeleteKatFormStr (_ParamNum: string[20]);


// Установить тип формы
Procedure SetTipForm (_TiFr: word);

end;



//------------------------------------------------------------------------------
VipInterface Form11 implements ObjForm11  Parameters (c1 : comp; c2 : word; wTipDoc : word; pTiFr: word)
  Licensed (Free);

#end // __FORM11_VIH__
