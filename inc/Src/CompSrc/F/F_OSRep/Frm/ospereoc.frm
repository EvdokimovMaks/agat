//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 6.00 - Основные средства
// Ведомости переоценки
// Внимание! Существует slk-отчет в формате Excel
//------------------------------------------------------------------------------

#include Commission.frn // комиссии

#doc
Ведомости переоценки
#end


//===============================================================================================================================
.linkform 'OsPereoc_01' prototype is 'OsPereoc'
.NameInList 'Стандартная ведомость переоценки'
.p 60
.Group '<<Общие>>'
.defo landscape
#CommissionLinkVar
.var
   Dat   : date
   iExcelFormat : ExcelFormat;
.endvar
.[h  skip
 Щ                                                                                                                                                                                   Лист @Np@
 Щ
.]h
#CommissionLinkInit(OSPereoc)

.Fields
  Информация_о_председателе
  Список_членов_комиссии
.EndFields
 Й         Предприятие ___________________________________
        Ведомость переоценки основных фондов по состоянию на ____________ 20  г.
        Комиссия в составе:
        председателя:  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д,
        и членов:
         Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
        назначенная приказом руководителя предприятия от "__"___________20  г.
        N____________ произвела переоценку основных фондов по состоянию
                  на "__"____________20  г.  Й
 Щ
.fields
  NastrOsName
  Divider
  sDivider
  CurrName
  sGrpName
  sSrtName
.endfields
Метод учета:          ^
Денежная единица:     ^ (^) ^
Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter  FilterLoop
.fields
  sFltName
.endfields
 ^
.}
 Щ
.{ MainLoop
.fields
  CodeName
  Divider
  CurrName
.endfields
 Ш.[h
┌───────────────┬──────────────────────────┬─────────┬──────────┬──────────────────┬─────────────────────────┬───────┬──────────────────┬──────────────────┬─────────────────────────────────────┐
│               │                          │         │  Дата    │    Первонача-    │   Остаточная стоимость  │Коэффи-│    Восстанови-   │    Остаточная    │       Накопленная переоценка        │
│  Инвентарный  │       Наименование       │   Код   │  ввода   │       льная      ├──────────────────┬──────┤ циент │    тельная       │     стоимость    ├──────────────────┬──────────────────┤
│     номер     │         объекта          │  @@@@@  │    в     │     стоимость    │        в         │  в   │ перес-│    стоимость     │      после       │                  │                  │
│               │                          │         │эксплуат. │                  │@~@@@@@@@@@@@@@@@@│ проц │ чета  │    после         │    переоценки    │    стоимости     │     износа       │
│               │                          │         │/поступл. │                  │@~@@@@@@@@@@@@@@@@│      │       │    переоценки    │                  │                  │                  │
└───────────────┴──────────────────────────┴─────────┴──────────┴──────────────────┴──────────────────┴──────┴───────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘
.]h Ш
.{ CheckEnter GroupLoop
.fields
  GroupName
  if (NeedSum1, DoubleToStr(Head_StoimGrp,       Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_OstStoimGrp,    Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_StoimGrpNew,    Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_OstStoimGrpNew, Формат_Сумм), '')
.endfields

 Щ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&                &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Щ
.}
.{ CheckEnter DataLoop
.begin
  If not (Date_sost > date(0,0,0))
    Dat:=Date_post
  else
    Dat:=Date_sost
end.
.fields
  fInnum           OSName                   Kod       Dat        DoubleToStr(Stoim, Формат_Сумм)
                                                                                      DoubleToStr(OstStoim,Формат_Сумм)
                                                                                                         IznPerc // DoubleToStr(IznPerc, '\2p666.99')
                                                                                                                Coeff // DoubleToStr(Coeff, '\4p66.8888')
                                                                                                                        DoubleToStr(NewStoim, Формат_Сумм)
                                                                                                                                           DoubleToStr(NewOstStoim, Формат_Сумм)
                                                                                                                                                                  iExcelFormat.DoubleToStrRep(PerStoim, Формат_Сумм)  iExcelFormat.DoubleToStrRep(PerSumIzn, Формат_Сумм)
.endfields
 Ш @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &&&.&& &&.&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Ш
.}
.{ CheckEnter ItogLoop
.fields
            ItgGroupName                                           DoubleToStr(StoimGrp, Формат_Сумм)
                                                                                      DoubleToStr(OstStoimGrp, Формат_Сумм)
                                                                                                                        DoubleToStr(StoimGrpNew, Формат_Сумм)
                                                                                                                                           DoubleToStr(OstStoimGrpNew, Формат_Сумм)
.endfields

 Щ Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&                &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Щ
.}
.}
! End MainLoop ----------------------------------------------------------------

 ЩБухгалтер Щ
 ЩОтветственный за выпуск Щ
.endform

//===============================================================================================================================
.linkform 'OsPereoc_02' prototype is 'OsPereoc'
.NameInList 'Ведомость переоценки с месячным износом'
.p 60
.Group '<<Общие>>'
.defo portrait
#CommissionLinkVar
.var
   Dat   : date
.endvar
.[h skip
 Щ                                                                                                                                              Лист @Np@
 Щ
.]h
#CommissionLinkInit(OSPereoc)

.Fields
  Информация_о_председателе
  Список_членов_комиссии
.EndFields
 Й         Предприятие ___________________________________
        Ведомость переоценки основных фондов по состоянию на ____________ 20  г.
        Комиссия в составе:
        председателя:  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д,
        и членов:
         Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
        назначенная приказом руководителя предприятия от "__"___________20  г.
        N____________ произвела переоценку основных фондов по состоянию
                       на "__"____________20  г.  Й
 Щ
.fields
  NastrOsName
  Divider
  sDivider
  CurrName
  sGrpName
  sSrtName
.endfields
Метод учета:          ^
Денежная единица:     ^ (^) ^
Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter  FilterLoop
.fields
  sFltName
.endfields
 ^
.}
 Щ
.{ MainLoop
.fields
  sNameField_Iznosa
  CodeName
  Divider
  CurrName
.endfields
.[h
 Ш┌───────────────┬──────────────────────────┬─────────┬──────────┬──────────────┬─────────────────────┬───────┬──────────────┬──────────────┬──────────────┐
│               │                          │         │  Дата    │  Первонача-  │ Остаточная стоимость│Коэффи-│  Восстанови- │  Остаточная  │    Сумма     │
│  Инвентарный  │       Наименование       │   Код   │  ввода   │     льная    ├──────────────┬──────┤ циент │  тельная     │   стоимость  │@~@@@@@@@@@@@@│
│     номер     │         объекта          │  @@@@@  │    в     │   стоимость  │      в       │  в   │ перес-│  стоимость   │    после     │  за  месяц   │
│               │                          │         │эксплуат. │              │ @~@@@@@@@@@@@│ проц │ чета  │  после       │  переоценки  │    после     │
│               │                          │         │/поступл. │              │ @~@@@@@@@@@@@│      │       │  переоценки  │              │ переоценки   │
└───────────────┴──────────────────────────┴─────────┴──────────┴──────────────┴──────────────┴──────┴───────┴──────────────┴──────────────┴──────────────┘ Ш
.]h
.{ CheckEnter GroupLoop
.fields
  GroupName
  if (NeedSum1, DoubleToStr(Head_StoimGrp, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_OstStoimGrp, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_StoimGrpNew, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_OstStoimGrpNew, Формат_Сумм), '')
.endfields

 Щ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&& &'&&&&&&&&&&&&                &'&&&&&&&&&&&& &'&&&&&&&&&&&& Щ
.}
.{ CheckEnter DataLoop
.begin
  If not (Date_sost > date(0,0,0))
    Dat:=Date_post
  else
    Dat:=Date_sost
end.
.fields
  fInnum           OSName                   Kod       Dat        DoubleToStr(Stoim, Формат_Сумм)
                                                                                  DoubleToStr(OstStoim, Формат_Сумм)
                                                                                                 IznPerc
                                                                                                        Coeff // DoubleToStr(Coeff, '\4p66.8888')
                                                                                                                DoubleToStr(NewStoim, Формат_Сумм)
                                                                                                                               DoubleToStr(NewOstStoim, Формат_Сумм)
                                                                                                                                              DoubleToStr(NewIznMes, Формат_Сумм)
.endfields

 Ш @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&& &'&&&&&&&&&&&& &&&.&& &&.&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&&& Ш
.}
.{ CheckEnter ItogLoop
.fields
            ItgGroupName                                           DoubleToStr(StoimGrp, Формат_Сумм)
                                                                                  DoubleToStr(OstStoimGrp, Формат_Сумм)
                                                                                                               DoubleToStr(StoimGrpNew, Формат_Сумм)
                                                                                                                               DoubleToStr(OstStoimGrpNew, Формат_Сумм)
.endfields

 Щ Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&& &'&&&&&&&&&&&&                &'&&&&&&&&&&&& &'&&&&&&&&&&&& Щ
.}
.}
! End MainLoop ----------------------------------------------------------------

 ЩБухгалтер Щ
 ЩОтветственный за выпуск Щ
.endform


//===============================================================================================================================
.linkform 'OsPereoc_04' prototype is 'OsPereoc'
.NameInList 'Расширенная ведомость переоценки'
.p 60
.Group '<<Общие>>'
.defo landscape
#CommissionLinkVar
.var
   Dat   : date
.endvar
.[h skip
 И                                                                                                                                                                                                                       Лист @Np@ И
.]h
#CommissionLinkInit(OSPereoc)
.Fields
  'по состоянию на ' +
  '1 '+ DateToStr(if(Day(Date_Pereoc) = Last_Day(Date_Pereoc), Add_Months(Date_Pereoc, 1), Date_Pereoc), 'mon') +
  ' ' + Year(if(Day(Date_Pereoc) = Last_Day(Date_Pereoc), Add_Months(Date_Pereoc, 1), Date_Pereoc)) + ' г.'
  Информация_о_председателе
  Список_членов_комиссии
  DateToStr(if(Day(Date_Pereoc) = Last_Day(Date_Pereoc), Add_Months(Date_Pereoc, 1), Date_Pereoc), 'mon')
  Year(if(Day(Date_Pereoc) = Last_Day(Date_Pereoc), Add_Months(Date_Pereoc, 1), Date_Pereoc))
.EndFields
 Ш  Предприятие _____________________________________________________________________________________________________________________________________________________________________




                                     Ведомость переоценки основных фондов
              @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@



      Комиссия в составе:
         председателя: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
         и членов:
                       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,

      назначенная приказом руководителя предприятия от "__"___________20  г. N____________,  произвела переоценку основных фондов по состоянию на " 1 "  ^  ^ г.
.fields
  NastrOsName
  Divider
  sDivider
  CurrName
  sGrpName
  sSrtName
.endfields

Метод учета:          ^
Денежная единица:     ^ (^) ^
Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter  FilterLoop
.fields
  sFltName
.endfields
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.{ MainLoop
.fields
  CodeName
  'в ' + Divider + ' ' + CurrName
.endfields
.[h
┌───────────────┬──────────────────────────┬─────────┬──────────┬────────────────┬───────┬────────────────┬────────────────┬────────────────┬───────┬────────────────┬────────────────┬─────────────────────────┬────────────────┐
│               │                          │         │  Дата    │ Первоначальная │Коэффи-│ Первоначальная │   Величина     │  Амортизация   │Коэффи-│  Амортизация   │   Величина     │   Остаточная стоимость  │   Остаточная   │
│  Инвентарный  │       Наименование       │   Код   │ ввода в  │   стоимость    │ циент │   стоимость    │   изменения    │    (износ)     │ циент │    (износ)     │   изменения    │      до переоценки      │   стоимость    │
│     номер     │         объекта          │  @@@@@  │эксплуат. │       до       │ перес-│     после      │ первоначальной │       до       │ перес-│     после      │  амортизации   ├──────────────────┬──────┤     после      │
│               │                          │         │/поступл. │   переоценки   │ чета  │   переоценки   │   стоимости    │   переоценки   │ чета  │   переоценки   │    (износа)    │@~@@@@@@@@@@@@@@@@│ в %  │   переоценки   │
└───────────────┴──────────────────────────┴─────────┴──────────┴────────────────┴───────┴────────────────┴────────────────┴────────────────┴───────┴────────────────┴────────────────┴──────────────────┴──────┴────────────────┘
.]h
.{ CheckEnter GroupLoop
.fields
  GroupName
  if (NeedSum1, DoubleToStr(Head_StoimGrp, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_StoimGrpNew, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_StoimGrpNew - Head_StoimGrp, Формат_Сумм), '')

  if (NeedSum1, DoubleToStr(Head_IznosGrp, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_IznosGrpNew, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_IznosGrpNew - Head_IznosGrp, Формат_Сумм), '')

  if (NeedSum1, DoubleToStr(Head_OstStoimGrp, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_OstStoimGrpNew, Формат_Сумм), '')
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&         &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&         &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&        &'&&&&&&&&&&&&&&
.}
.{ CheckEnter DataLoop
.begin
  If not (Date_sost > date(0,0,0))
    Dat:=Date_post
  else
    Dat:=Date_sost
end.
.fields
  fInnum
  OSName
  Kod
  Dat
  DoubleToStr(Stoim, Формат_Сумм)
  Coeff
  DoubleToStr(NewStoim, Формат_Сумм)
  DoubleToStr(NewStoim - Stoim, Формат_Сумм)

  DoubleToStr(SumIzn, Формат_Сумм)
  DoubleToStr(NewSumIzn / SumIzn, '66.8888')
  DoubleToStr(NewSumIzn, Формат_Сумм)
  DoubleToStr(NewSumIzn - SumIzn, Формат_Сумм)

  DoubleToStr(OstStoim, Формат_Сумм)
  IznPerc
  DoubleToStr(NewOstStoim, Формат_Сумм)
.endfields
 @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&& &&.&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &&.&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &&&&&& &'&&&&&&&&&&&&&&
.}
.{ CheckEnter ItogLoop
.fields
  ItgGroupName
  DoubleToStr(StoimGrp, Формат_Сумм)
  DoubleToStr(StoimGrpNew, Формат_Сумм)
  DoubleToStr(StoimGrpNew - StoimGrp, Формат_Сумм)

  DoubleToStr(IznosGrp, Формат_Сумм)
  DoubleToStr(IznosGrpNew, Формат_Сумм)
  DoubleToStr(IznosGrpNew - IznosGrp, Формат_Сумм)

  DoubleToStr(OstStoimGrp,    Формат_Сумм)
  DoubleToStr(OstStoimGrpNew, Формат_Сумм)
.endfields
 Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&         &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&         &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&        &'&&&&&&&&&&&&&&
.}
.}
! End MainLoop ----------------------------------------------------------------

Бухгалтер
Ответственный за выпуск Ш
.endform
! endform  Р'OsPereoc_04'

//===============================================================================================================================
.linkform 'OsPereoc_05' prototype is 'OsPereoc'
.NameInList 'Ведомость переоценки (от 5.11.2010)'
.p 40
.Group '<<Беларусь>>'
.defo landscape
#CommissionLinkVar
.var
   nPop   : word
   Dat1   : string
   nMonth : byte
   nYear  : word
   sMonth : string
.endvar
.[h skip
 Р                                                                                                                                                                   Лист @Np@ Р
.]h
#CommissionLinkInit(OSPereoc)
.fields
  Dat1
  Валюта_прописью_сокр : "p:c"
  Валюта_прописью_сокр : "p:c"
  Валюта_прописью_сокр
  Валюта_прописью_сокр : "p:c"
.Endfields
.begin
  var tdPer : date;
  tdPer := if(Day(Date_Pereoc)=Last_Day(Date_Pereoc),Add_Months(Date_Pereoc,1),Date_Pereoc);
  nMonth:=Month(tdPer);
  nYear:=Year(tdPer);
  case nMonth of
    0:sMonth :=' ';
    1:sMonth := 'января ';
    2:sMonth := 'февраля ';
    3:sMonth := 'марта ';
    4:sMonth := 'апреля ';
    5:sMonth := 'мая ';
    6:sMonth := 'июня ';
    7:sMonth := 'июля ';
    8:sMonth := 'августа ';
    9:sMonth := 'сентября ';
    10:sMonth:= 'октября ';
    11:sMonth:= 'ноября ';
    12:sMonth:= 'декабря ';
  end;
  Dat1 := 'на 1 ' + sMonth + if(nYear <> 0, String(nYear), ' ') + ' г.';
end.
 Р
 Р                                                                                                                                                                Приложение 1
                                                                                                                                           к Инструкции о порядке переоценки
                                                                                                                                            основных средств, не завершенных
                                                                                                                                                   строительством объектов и
                                                                                                                                              неустановленного оборудования,
                                                                                                                                                утверждено Постановлением РБ
                                                                                                                                                    от 5.11.2010 №162/131/37

                                            В Е Д О М О С Т Ь
                            переоценки основных средств по состоянию ^

.{ CheckEnter  FilterLoop
.}
.{ MainLoop
.[h
┌─────┬───────────────┬──────────────────────────┬──────────┬──────────────┬──────────────────┬─────────┬──────────────────┬────────────────────────────┬──────────────────┐
│     │               │                          │Шифр групп│     Дата     │  Первоначальная  │ Коэффи- │                  │   Накопленная амортизация  │    Остаточная    │
│  №  │  Инвентарный  │       Наименование       │ основных │   принятия   │    стоимость     │  циент  │   Переоцененная  ├───────────┬────────────────┤    стоимость     │
│ п/п │     номер     │     основных средств     │средств по│   основных   │     основных     │  пере-  │    стоимость,    │ удельный  │   сумма после  │   (графа 8 -     │
│     │               │                          │Временному│  средств к   │    средств до    │  счета  │    @@@@@@@@@@    │вес на дату│   переоценки   │   - графа 10),   │
│     │               │                          │ классифи-│бухгалтерскому│   переоценки,    │         │                  │переоценки │   (графа 8 х   │    @@@@@@@@@@    │
│     │               │                          │  катору  │    учету     │   числящаяся в   │         │                  │ в перво-  │   х графа 9 /  │                  │
│     │               │                          │          │ (месяц,год)  │  бухгалтерском   │         │                  │ начальной │     / 100),    │                  │
│     │               │                          │          │              │ учете, @@@@@@@@@ │         │                  │ стоимости,│   @@@@@@@@@@   │                  │
│     │               │                          │          │              │                  │         │                  │ процентов │                │                  │
├─────┼───────────────┼──────────────────────────┼──────────┼──────────────┼──────────────────┼─────────┼──────────────────┼───────────┼────────────────┼──────────────────┤
│  1  │       2       │            3             │     4    │       5      │         6        │    7    │         8        │     9     │       10       │        11        │
└─────┴───────────────┴──────────────────────────┴──────────┴──────────────┴──────────────────┴─────────┴──────────────────┴───────────┴────────────────┴──────────────────┘
.]h
.{ CheckEnter GroupLoop
.fields
  GroupName
  if (NeedSum1, DoubleToStr(Head_StoimGrp,    Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_StoimGrpNew, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_IznosGrpNew, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_OstStoimGrpNew, Формат_Сумм), '')
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@            &'&&&&&&&&&&&&&&&&            &'&&&&&&&&&&&&&&&              &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.}
.{ CheckEnter DataLoop
.fields
 nPop
 fInnum
 OSName
 Kod
 DateToStr(Date_Sost, 'MM/YYYY') : "p:c"
 DoubleToStr(Stoim, Формат_Сумм)
 Coeff
 DoubleToStr(NewStoim, Формат_Сумм)
 100-IznPerc
 DoubleToStr(NewSumIzn, Формат_Сумм)
 DoubleToStr(NewOstStoim, Формат_Сумм)
.endfields
.begin
  nPop++;
end.
 @@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&   &&.&&&&  &'&&&&&&&&&&&&&&&     &&&&.&&  &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.}
.{ CheckEnter ItogLoop
.fields
 ItgGroupName
 DoubleToStr(StoimGrp,    Формат_СУМм)
 DoubleToStr(StoimGrpNew, Формат_Сумм)
 DoubleToStr(IznosGrpNew, Формат_Сумм)
 DoubleToStr(OstStoimGrpNew, Формат_Сумм)
.endfields
 Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@            &'&&&&&&&&&&&&&&&&            &'&&&&&&&&&&&&&&&              &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.}
.}
! End MainLoop ----------------------------------------------------------------

.Fields
!  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.EndFields
   Председатель комиссии ___________________________   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                 (подпись)                                                   (инициалы, фамилия)

.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
!  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
   @@@@@@@@@@@@@@@       ___________________________   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                 (подпись)                                                   (инициалы, фамилия)

.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
   Члены комиссии:       ___________________________   __________________________________________________________________________________________
                                 (подпись)                                                   (инициалы, фамилия)

                         ___________________________   __________________________________________________________________________________________
                                 (подпись)                                                   (инициалы, фамилия)

.} Р
.endform
! endform  Р'OsPereoc_05'

//===============================================================================================================================
.linkform 'OsPereoc_06' prototype is 'OsPereoc'
.NameInList 'Ведомость переоценки с поправ. коэфф. (от 5.11.2010)'
.p 40
.Group '<<Беларусь>>'
.defo landscape
#CommissionLinkVar
.var
   nPop   : word
   Dat1   : string
   nMonth : byte
   nYear  : word
   sMonth : string
   iExcelFormat : ExcelFormat;
.endvar
.[h skip
 Р                                                                                                                                                                              Лист @Np@ Р
.]h
#CommissionLinkInit(OSPereoc)
.fields
  Dat1
  Валюта_прописью_сокр : "p:c"
  Валюта_прописью_сокр : "p:c"
  Валюта_прописью_сокр
  Валюта_прописью_сокр : "p:c"
.Endfields
.begin
  var tdPer : date;
  tdPer := if(Day(Date_Pereoc)=Last_Day(Date_Pereoc),Add_Months(Date_Pereoc,1),Date_Pereoc);
  nMonth:=Month(tdPer);
  nYear:=Year(tdPer);
  case nMonth of
    0:sMonth :=' ';
    1:sMonth := 'января ';
    2:sMonth := 'февраля ';
    3:sMonth := 'марта ';
    4:sMonth := 'апреля ';
    5:sMonth := 'мая ';
    6:sMonth := 'июня ';
    7:sMonth := 'июля ';
    8:sMonth := 'августа ';
    9:sMonth := 'сентября ';
    10:sMonth:= 'октября ';
    11:sMonth:= 'ноября ';
    12:sMonth:= 'декабря ';
  end;
  Dat1 := 'на 1 ' + sMonth + if(nYear <> 0, String(nYear), ' ') + ' г.';
end.
 Р
 Р                                                                                                                                                                            Приложение 1
                                                                                                                                                       к Инструкции о порядке переоценки
                                                                                                                                                        основных средств, не завершенных
                                                                                                                                                               строительством объектов и
                                                                                                                                                          неустановленного оборудования,
                                                                                                                                                            утверждено Постановлением РБ
                                                                                                                                                                от 5.11.2010 №162/131/37

                                            В Е Д О М О С Т Ь
                            переоценки основных средств по состоянию ^

.{ CheckEnter  FilterLoop
.}
.{ MainLoop
.[h
┌─────┬───────────────┬──────────────────────────┬──────────┬──────────────┬──────────────────┬─────────┬───────────┬──────────────────┬────────────────────────────┬──────────────────┐
│     │               │                          │Шифр групп│     Дата     │  Первоначальная  │ Коэффи- │ Корректи- │                  │   Накопленная амортизация  │    Остаточная    │
│  №  │  Инвентарный  │       Наименование       │ основных │   принятия   │    стоимость     │  циент  │  рующий   │   Переоцененная  ├───────────┬────────────────┤    стоимость     │
│ п/п │     номер     │     основных средств     │средств по│   основных   │     основных     │  пере-  │  коэффи-  │    стоимость,    │ удельный  │   сумма после  │   (графа 9 -     │
│     │               │                          │Временному│  средств к   │    средств до    │  счета  │   циент   │    @@@@@@@@@@    │вес на дату│   переоценки   │   - графа 11),   │
│     │               │                          │ классифи-│бухгалтерскому│   переоценки,    │         │           │                  │переоценки │   (графа 9 х   │    @@@@@@@@@@    │
│     │               │                          │  катору  │    учету     │   числящаяся в   │         │           │                  │ в перво-  │   х графа 10/  │                  │
│     │               │                          │          │ (месяц,год)  │  бухгалтерском   │         │           │                  │ начальной │     / 100),    │                  │
│     │               │                          │          │              │ учете, @@@@@@@@@ │         │           │                  │ стоимости,│   @@@@@@@@@@   │                  │
│     │               │                          │          │              │                  │         │           │                  │ процентов │                │                  │
├─────┼───────────────┼──────────────────────────┼──────────┼──────────────┼──────────────────┼─────────┼───────────┼──────────────────┼───────────┼────────────────┼──────────────────┤
│  1  │       2       │            3             │     4    │       5      │         6        │    7    │     8     │         9        │     10    │       11       │        12        │
└─────┴───────────────┴──────────────────────────┴──────────┴──────────────┴──────────────────┴─────────┴───────────┴──────────────────┴───────────┴────────────────┴──────────────────┘
.]h
.{ CheckEnter GroupLoop
.fields
  GroupName
  if (NeedSum1, DoubleToStr(Head_StoimGrp,    Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_StoimGrpNew, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_IznosGrpNew, Формат_Сумм), '')
  if (NeedSum1, DoubleToStr(Head_OstStoimGrpNew, Формат_Сумм), '')
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@            &'&&&&&&&&&&&&&&&&                       &'&&&&&&&&&&&&&&&              &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.}
.{ CheckEnter DataLoop
.fields
 nPop
 fInnum
 OSName
 Kod
 DateToStr(Date_Sost, 'MM/YYYY') : "p:c"
 DoubleToStr(Stoim, Формат_Сумм)
 Coeff
 iExcelFormat.DoubleToStrRep(PoprCoeff,'\4p66.8888')
 DoubleToStr(NewStoim, Формат_Сумм)
 100-IznPerc
 DoubleToStr(NewSumIzn, Формат_Сумм)
 DoubleToStr(NewOstStoim, Формат_Сумм)
.endfields
.begin
  nPop := nPop +1
end.
 @@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&   &&.&&&&   &&.&&&&   &'&&&&&&&&&&&&&&&     &&&&.&&  &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.}
.{ CheckEnter ItogLoop
.fields
 ItgGroupName
 DoubleToStr(StoimGrp,    Формат_СУМм)
 DoubleToStr(StoimGrpNew, Формат_Сумм)
 DoubleToStr(IznosGrpNew, Формат_Сумм)
 DoubleToStr(OstStoimGrpNew, Формат_Сумм)
.endfields
 Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@            &'&&&&&&&&&&&&&&&&                       &'&&&&&&&&&&&&&&&              &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.}
.}
! End MainLoop ----------------------------------------------------------------

.Fields
!  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.EndFields
   Председатель комиссии ___________________________   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                 (подпись)                                                   (инициалы, фамилия)

.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
!  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
   @@@@@@@@@@@@@@@       ___________________________   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                 (подпись)                                                   (инициалы, фамилия)

.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
   Члены комиссии:       ___________________________   __________________________________________________________________________________________
                                 (подпись)                                                   (инициалы, фамилия)

                         ___________________________   __________________________________________________________________________________________
                                 (подпись)                                                   (инициалы, фамилия)

.} Р
.endform
! endform  Р'OsPereoc_06' Р

//===============================================================================================================================
.linkform 'AktPereoc_01' prototype is 'OsPereoc'
.NameInList 'Акт по результатам переоценки'
.P 70
.Group '<<Общие>>'
.defo portrait
.var
   Dat1   : string
   nMonth : byte
   nYear  : word
   sMonth : string

   Уровень              : word
   Itog_StoimGrp        : double
   Itog_OstStoimGrp     : double
   Itog_StoimGrpNew     : double
   Itog_OstStoimGrpNew  : double
.endvar
#CommissionLinkVar
.begin
  Уровень := 65535;
  Itog_StoimGrp       := 0;
  Itog_OstStoimGrp    := 0;
  Itog_StoimGrpNew    := 0;
  Itog_OstStoimGrpNew := 0;

  nMonth:=Month(Date_Pereoc);
  nYear:=Year(Date_Pereoc);
  case nMonth of
    0:sMonth:=' ';
    1:sMonth:='января ';
    2:sMonth:='февраля ';
    3:sMonth:='марта ';
    4:sMonth:='апреля ';
    5:sMonth:='мая ';
    6:sMonth:='июня ';
    7:sMonth:='июля ';
    8:sMonth:='августа ';
    9:sMonth:='сентября ';
    10:sMonth:='октября ';
    11:sMonth:='ноября ';
    12:sMonth:='декабря ';
  end;
  Dat1:='на 1 '+sMonth+if(nYear<>0,String(nYear),' ')+' г.';
end.
#CommissionLinkInit(OSPereoc)
.{ CheckEnter  FilterLoop
.}
.{ MainLoop
.{ CheckEnter GroupLoop
.begin
  if (GroupLevel < Уровень)
  {
    Уровень := GroupLevel;
    // GroupName
    Itog_StoimGrp       := Head_StoimGrp;
    Itog_OstStoimGrp    := Head_OstStoimGrp;
    Itog_StoimGrpNew    := Head_StoimGrpNew;
    Itog_OstStoimGrpNew := Head_OstStoimGrpNew;
  }
end.
.}
.{ CheckEnter DataLoop
.}
.{ CheckEnter ItogLoop
.}
.}
.fields
  Информация_о_председателе
  Список_членов_комиссии
  DoubleToStr(Itog_StoimGrp, Формат_Сумм)
   РВалюта_прописью_сокр Р
  DoubleToStr(Itog_StoimGrpNew, Формат_Сумм)
   РВалюта_прописью_сокр Р
  DoubleToStr(Itog_OstStoimGrp, Формат_Сумм)
   РВалюта_прописью_сокр Р
  DoubleToStr(Itog_OstStoimGrpNew, Формат_Сумм)
   РВалюта_прописью_сокр Р
   РВалюта_прописью_сокр Р
   РВалюта_прописью_сокр Р
.endfields
 Р


 Б                                                                                 УТВЕРЖДАЮ Б

                                           _______________________________________________
                                                       Руководитель организации

                                           "____"________________20  г.


                             БАКТ ПО РЕЗУЛЬТАТАМ ПЕРЕОЦЕНКИ Б

   Комиссия в составе:
   председателя  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д ,

   членов комиссии
    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д ,

   действовала на основании приказа от "____"________________ 20   г. №_________________ ,

   произвела переоценку основных фондов и установила следующее.

   1. Результаты переоценки основных средств.

     Первоначальная стоимость основных фондов до переоценки
      Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д @@@@@@@@@@@@@

     Восстановительная стоимость основных фондов после переоценки
      Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д @@@@@@@@@@@@@

     Остаточная стоимость основных фондов до переоценки
      Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д @@@@@@@@@@@@@

     Остаточная стоимость основных фондов после переоценки
      Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д @@@@@@@@@@@@@

   2. При проведении инвентаризации основных фондов выявлены:

     а) недостачи на сумму ____________________________________________________ @@@@@@@@@

     б) излишки на сумму ______________________________________________________ @@@@@@@@@

   3. К настоящему акту прилагается следующая документация по переоценке основных фондов:

     а) __________________________________________________________________________________

     б) __________________________________________________________________________________

     в) __________________________________________________________________________________


.Fields
!  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.EndFields
   Председатель комиссии ___________________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                 (подпись)                    (И.О. Фамилия)

.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
!  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
   @@@@@@@@@@@@@@@       ___________________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                 (подпись)                    (И.О. Фамилия)

.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
   Члены комиссии:       ___________________________   ___________________________________
                                 (подпись)                    (И.О. Фамилия)

                         ___________________________   ___________________________________
                                 (подпись)                    (И.О. Фамилия)

.}
.endform
! endform 'AktPereoc_01'


//===============================================================================================================================
.linkform 'AktPereoc_03' prototype is 'OsPereoc'
.NameInList 'Акт по результатам переоценки (от 5.11.2010)'
.P 70
.Group '<<Беларусь>>'
.defo portrait
.var
   Dat1   : string
   nMonth : byte
   nYear  : word
   sMonth : string

   Уровень              : word
   Itog_StoimGrp        : double
   Itog_OstStoimGrp     : double
   Itog_StoimGrpNew     : double
   Itog_OstStoimGrpNew  : double
.endvar
#CommissionLinkVar
.begin
  Уровень := 65535;
  Itog_StoimGrp       := 0;
  Itog_OstStoimGrp    := 0;
  Itog_StoimGrpNew    := 0;
  Itog_OstStoimGrpNew := 0;

  var tdPer : date;
  tdPer := if(Day(Date_Pereoc)=Last_Day(Date_Pereoc),Add_Months(Date_Pereoc,1),Date_Pereoc);
  nMonth:=Month(tdPer);
  nYear:=Year(tdPer);
  case nMonth of
    0:sMonth :=' ';
    1:sMonth := 'января ';
    2:sMonth := 'февраля ';
    3:sMonth := 'марта ';
    4:sMonth := 'апреля ';
    5:sMonth := 'мая ';
    6:sMonth := 'июня ';
    7:sMonth := 'июля ';
    8:sMonth := 'августа ';
    9:sMonth := 'сентября ';
    10:sMonth:= 'октября ';
    11:sMonth:= 'ноября ';
    12:sMonth:= 'декабря ';
  end;
  Dat1 := 'на 1 ' + sMonth + if(nYear <> 0, String(nYear), ' ') + ' г.';
end.
#CommissionLinkInit(OSPereoc)
.{ CheckEnter  FilterLoop
.}
.{ MainLoop
.{ CheckEnter GroupLoop
.begin
  if (GroupLevel < Уровень)
  {
    Уровень := GroupLevel;
    // GroupName
    Itog_StoimGrp       := Head_StoimGrp;
    Itog_OstStoimGrp    := Head_OstStoimGrp;
    Itog_StoimGrpNew    := Head_StoimGrpNew;
    Itog_OstStoimGrpNew := Head_OstStoimGrpNew;
  }
end.
.}
.{ CheckEnter DataLoop
.}
.{ CheckEnter ItogLoop
.}
.}
.fields
  Dat1
  Информация_о_председателе
  Список_членов_комиссии
  Валюта_прописью_сокр
  DoubleToStr(Itog_StoimGrp,    Формат_Сумм)
  Валюта_прописью_сокр
  DoubleToStr(Itog_StoimGrpNew, Формат_Сумм)
  Валюта_прописью_сокр
  DoubleToStr(Itog_OstStoimGrp, Формат_Сумм)
  Валюта_прописью_сокр
  DoubleToStr(Itog_OstStoimGrpNew, Формат_Сумм)
.endfields
 Р
 И                                                                              Приложение 2
                                                         к Инструкции о порядке переоценки
                                                          основных средств, не завершенных
                                                                 строительством объектов и
                                                             неустановленного оборудования,
                                                              утверждено Постановлением РБ
                                                                 от 5.11.2010 №162/131/37


                                                   УТВЕРЖДАЮ

                                                   ______________________________________
                                                          (руководитель организации)

                                                   ___________   ________________________
                                                    (подпись)       (инициалы, фамилия)

                                                   "____"________________ 20___ г.


                                         АКТ
                       результатов переоценки основных средств
                           по состоянию ^


   Комиссия в составе:
   председателя @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ,

   членов комиссии
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ,

   действующая на основании приказа от "____"________________ 20___ г. №_________________,

   произвела переоценку основных средств и установила следующее.

   1. Результаты переоценки основных средств.

     Первоначальная стоимость основных средств до переоценки, @@@@@@@@@@ @@@@@@@@@@@@@@@@@

     Переоцененная стоимость основных средств, @@@@@@@@@@                @@@@@@@@@@@@@@@@@

     Остаточная стоимость основных средств до переоценки, @@@@@@@@@@     @@@@@@@@@@@@@@@@@

     Остаточная стоимость основных средств после переоценки, @@@@@@@@@@  @@@@@@@@@@@@@@@@@

   2. К настоящему акту прилагается следующая документация по переоценке основных средств:

   _______________________________________________________________________________________

   _______________________________________________________________________________________

.Fields
!  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.EndFields
   Председатель комиссии ___________________________   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                 (подпись)                    (инициалы, фамилия)

.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
!  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
   @@@@@@@@@@@@@@@       ___________________________   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                 (подпись)                    (инициалы, фамилия)

.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
   Члены комиссии:       ___________________________   ___________________________________
                                 (подпись)                    (инициалы, фамилия)

                         ___________________________   ___________________________________
                                 (подпись)                    (инициалы, фамилия)

.}
 И
 Р.endform
! endform 'AktPereoc_03'
