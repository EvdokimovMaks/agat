//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Электронная отчетность"
// Базовый объект : "Работа с налоговыми отчетами"
//------------------------------------------------------------------------------

#ifndef _OTaxReport_Vih__
#define _OTaxReport_Vih__

#ifdef  ComponentVersion
#component "F_TaxReport"
#endif //ComponentVersion

//==============================================================================
#doc
Базовый объект : "Работа с налоговыми отчетами"
#end
Private ObjInterface IObjTaxReport;  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывести сообщения о последней ошибке выполнения
  #end
  Function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region GET
  //----------------------------------------------------------------------------
  #doc
     Получить актуальную версию отчета
  #end
  function GetActualVersion(
    _IDTaxReport : word
  ) : word;
  //----------------------------------------------------------------------------
  #doc
     Получить актуальное наименование отчета
  #end
  function GetActualName(
    _IDTaxReport : word
  ) : string;

  //----------------------------------------------------------------------------
  #doc
     Получить количество типов отчетов
  #end
  function GetCountRecord : longint;

  //----------------------------------------------------------------------------
  #doc
     Получить версию отчета по заданной дате из периода формирования
  #end
  function GetVersionByDate(
    _IDTaxReport : word;
    _dBeg        : date
  ): word;

  //----------------------------------------------------------------------------
  #doc
     Получить наименование отчета
  #end
  function GetName(
    _IDTaxReport : word;
    _Version     : word
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить наименование отчета
  #end
  function GetNameByDate(
    _IDTaxReport : word;
    _dBeg        : date
  ) : string;


  //----------------------------------------------------------------------------
  #doc
     Получить наименование интерфейса
  #end
  function GetInterfaceName(
    _IDTaxReport : word;
    _Version     : word
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить наименование интерфейса
  #end
  function GetInterfaceNameByDate(
    _IDTaxReport : word;
    _dBeg        : date
  ) : string;


  //----------------------------------------------------------------------------
  #doc
     Получить тип налогового отчета
  #end
  function GetTypeRep(
    _IDTaxReport : word;
    _vwVersion   : word
  ) : word;

  //----------------------------------------------------------------------------
  #doc
     Получить наименование интерфейса редактирования налогового отчета
  #end
  function GetEditorName(
    _IDTaxReport : word;
    _vwVersion   : word
  ) : string;
  //#endregion GET
  //****************************************************************************


  //============================================================================
  //#region ISVALID
  //----------------------------------------------------------------------------
  #doc
     Возможно ли формирование отчета в заданном типе периода
  #end
  function IsCreateTPer(
    _IDTaxReport : word;
    _Version     : word;
    _TPerEd      : byte
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Возможно ли формирование отчета в заданном периоде
  #end
  function IsCreatePeriod(
    _IDTaxReport : word;
    _Version     : word;
    _cPeriod     : comp;
    _isMessage   : boolean
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Возможно ли формирование актуального отчета в заданном типе периода
  #end
  function IsActualCreatePeriod(
    _IDTaxReport : word;
    _TPerEd      : byte
  ) : boolean;
  //#endregion ISVALID
  //****************************************************************************


  //============================================================================
  //#region MODIFY
  //----------------------------------------------------------------------------
  #doc
     Обновить данные всех системных отчетов
  #end
  function UpdateAllSysRepData(
    _isCheck : boolean     // проверять потребность обновления
  ) : LongInt;             // количеств записей в таблице AllReport
  //#endregion MODIFY
  //****************************************************************************


  //============================================================================
  //#region DIALOD
  //----------------------------------------------------------------------------
  #doc
     Запустить выбор типов системных отчетов
  #end
  function RunViewTaxReport(
      _wIntMode : word;
      _title    : string;
  var _RepID    : word;
  var _RepVer   : word;
      _MID      : TPtr     // список выбранных записей
  ) : boolean;
  //#endregion DIALOD
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface ObjTaxReport implements IObjTaxReport
#Licensed_Free;
Public:
  constructor Init;
  destructor  Done;
End;
//******************************************************************************

#endif // _OTaxReport_Vih__
