//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - модуль "Электронная отчетность"
// Сервисная библиотека : "Выбор из каталогов"
//------------------------------------------------------------------------------

#ifndef __TRPickNSI_Vih__
#define __TRPickNSI_Vih__

#component "F_TaxReport"

//==============================================================================
#doc
Сервисная библиотека : "Выбор из каталогов"
#end
Private ObjInterface ITRPickNSI;  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  function GetStLastError : string;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region ВЫБОР ИЗ КАТАЛОГОВ
  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога ОКВЭД
  #end
  function RunPickOKVED(
  var _sCode : string  // код ОКВЭД
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога ОКВЭД
  #end
  function RunPickOKVED_Name(
  var _sCode : string; // код ОКВЭД
  var _sName : string  // наименование ОКВЭД
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога КБК
  #end
  function RunPickKBK(
  var _sCode : string  // код KBK
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога КПП
  #end
  function RunPickKPP(
  var _sCode : string  // код КПП
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога ОКТМО
  #end
  function RunPickOKTMO(
  var _cRec  : comp    // ссылка на ОКТМО
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога организаций
  #end
  function RunPickINNKPPKatOrg(
  var _sINN : string;  // ИНН
  var _sKPP : string;  // КПП
  var _cRec : comp     // ссылка на контрагента
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога организаций (Наименование, ИНН, КПП)
  #end
  function RunPickNameINNKPPKatOrg(
  var _sName : string;  // наименование
  var _sINN  : string;  // ИНН
  var _sKPP  : string;  // КПП
  var _cRec  : comp     // ссылка на организацию
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога организаций (Наименование)
  #end
  function RunPickNameKatOrg(
  var _sName : string  // наименование
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога Сотрудники
  #end
  function RunPickFIO(
  var _sF    : string; // фамилия
  var _sI    : string; // имя
  var _sO    : string  // отчество
  ) : boolean;

   //----------------------------------------------------------------------------
  #doc
     Запустить выбор ФИО и телефон сотрудника
  #end
  function RunPickFIOAndTel(
  var _sF    : string; // фамилия
  var _sI    : string; // имя
  var _sO    : string;  // отчество
  var _sTel : string   // Телефон сотрудника
  ) : boolean;

   //----------------------------------------------------------------------------
  #doc
     Запустить выбор ФИО, телефон и E-mail сотрудника
  #end
  function RunPickFIOTelEMail(
  var _FIO : string;  // фамилия  имя отчество
  var _Dolzhnost : string; //должность
  var _sTel : string; // Телефон сотрудника
  var _sEmail :string // e-mail
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога Сотрудники (без разбивки)
  #end
  function RunPickFullFIO(
  var _cRec : comp // Ссылка на сотрудника
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
    Запустить выбор из каталога ПТ
  #end
  function RunPickKodPT(
  var _sCode  : string;
  var _dNalSt : string;
  var _sEdRas : string
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
    Запустить выбор из каталога ПТ
  #end
  function RunPickKodPT_(
  var _sCode  : string
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога "Видов операций"
  #end
  function RunPickKodVidOper(
  var _sCode : string    // код вида операции
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить выбор из каталога "Операции НДС"
  #end
  function RunPickKodOperNDS(
  var _sCode : string    // код операции
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс выбора ИФНС
  #end
  function RunPickFNSCode(
  var _sCode  : string   // код ФНС
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс выбора кода, наименования и адреса ФНС
  #end
  function RunPickFNSCodeNameAdr(
  var _sCode  : string;  // код ФНС
  var _sName  : string;  // наименования ФНС
  var _sAdr   : string   // адрес ФНС
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс выбора ИФНС и его ОКТМО
  #end
  function RunPickFNSCodeAndOKTMO(
  var _sCode  : string;  // код ФНС
  var _sOKTMO : string   // ОКТМО ФНС
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс выбора "Кода категории земли"
  #end
  function RunPickCategoryLandCode(
  var _sCode  : string   // код категории земли
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс выбора "Кода налоговой льготы"
  #end
  function RunPickZemLg(
  var _sCode  : string;          // код налоговой льготы
      _fl7Zn  : boolean = False; // добавить 2ю часть
      _for2ch : string = ''      // при каком значении добавить 2ю часть
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс выбора "Кода вида имущества"
  #end
  function RunPickVidInushCode(
  var _wCode  : word     // код вида имущества
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс выбора "Кода региона"
  #end
  function RunPickKodRegion(
  var _sCode  : string   // код региона
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить ОКТМО
  #end
  function GetOKTMO(
      _cRec : comp  ; // ссылка на "Каталог ОКТМО"
  var _var  : string
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить nRec по значению ОКТМО
  #end
  function GetOKTMO_nRec(
      _Val  : string; // код ОКТМО
  var _nRec : comp    // ссылка на "Каталог ОКТМО"
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Вернуть ФИО из каталога Сотрудники (без разбивки)
  #end
  function GetFullFIO(
      _cRec  : comp  ; // Ссылка на сотрудника
  var _sName : string
  ) : boolean;
  //#endregion ВЫБОР ИЗ КАТАЛОГОВ
  //****************************************************************************


  //============================================================================
  //#region СЛУЖЕБНЫЕ ФУНКЦИИ
  //----------------------------------------------------------------------------
  #doc
     Декомпозировать ФИО
  #end
  function FIOtoFamImyOtch (
      _FIO : string; // ФИО
  var _sF  : string; // Фамилия
  var _sI  : string; // Имя
  var _sO  : string  // Отчество
  ) : boolean;
  #doc
     Вернуть nRec организации по ИНН и КПП
  #end
  function GetNRecKatOrgByINNKPP(
    _sINN : string;  // ИНН
    _sKPP : string   // КПП
  ) : comp;
  //#endregion СЛУЖЕБНЫЕ ФУНКЦИИ
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface TRPickNSI implements ITRPickNSI
#Licensed_Free;
Public: //#region Public
  Constructor Init;
  Destructor  Done;
End; //#endregion Public
//******************************************************************************

#endif//__TRPickNSI_Vih__
