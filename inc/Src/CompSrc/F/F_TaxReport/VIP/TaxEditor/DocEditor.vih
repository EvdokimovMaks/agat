//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - модуль "Электронная отчетность"
// Интерфейс редактирования : "Электронный отчет"
//------------------------------------------------------------------------------

#ifndef __DocEditor__vih__
#define __DocEditor__vih__

#component "F_TaxReport"

//------------------------------------------------------------------------------
#include MasterAllEditor.Vih
#include XmlStruct.Vih
//------------------------------------------------------------------------------

//==============================================================================
#doc
Интерфейс редактирования : "Электронный отчет"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования
#end
Private ObjInterface ODocEditor;  //#region ObjInterface

  //----------------------------------------------------------------------------
  #doc
     Получить титул интерфейса
  #end
  function GetIHead : string;

  //----------------------------------------------------------------------------
  #doc
     Проверить разрешено ли редактирования
  #end
  function CheckCanEdit(
    _wMessage : word = cgiNoMessage  // режим вывода сообщений (см. GLOCONST.INC cgi*Message)
  ) : boolean;
#ifdef  __TPR2__
  //----------------------------------------------------------------------------
  #doc
     Проверить разрешено ли редактирования (возвращает код ошибки)
  #end
  function CheckCanEdit_ErrorCode(
  var _ErrorCode : word;                // код ошибки
      _wMessage  : word = cgiNoMessage  // режим вывода сообщений (см. GLOCONST.INC cgi*Message)
  ) : boolean;
#endif//__TPR2__
  //----------------------------------------------------------------------------
  #doc
     Задать мастер - интерфейс
  #end
  procedure SetMaster(_pMaster : OMasterAllEditor);

  //----------------------------------------------------------------------------
  #doc
     Обновить панель редактирования показателей отчета
  #end
  procedure RefreshValuesPanel;

  //----------------------------------------------------------------------------
  #doc
     Получить признак доступности FR отчета
  #end
  function GetIsFastReportEnable : boolean;

  //----------------------------------------------------------------------------
  #doc
     Актуализировать состояния полей интерфейса
  #end
  procedure CheckFieldsState;

  //----------------------------------------------------------------------------
  #doc
     Инициализировать отчет
  #end
#ifdef  __TPR2__
  procedure InitTax (
    cTax         : comp           ; // ссылка на отчет
    IsAutoCreate : boolean = False  // признак автоматически созданной декларации
  );
#else
  procedure InitTax(cTax : comp);
#endif//__TPR2__
#ifdef  __TPR2__
  //----------------------------------------------------------------------------
  #doc
     Инициализировать отчет (для экспорта данных)
  #end
  function InitTaxForExp (
        cTax         : comp       // ссылка на отчет
  ; var XMLReportMap : XmlStruct  // XMLMap отчета
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Инициализировать отчет (для экспорта данных; с датой сдачи отчета)
  #end
  function InitTaxForExpDeliv (
    cTax             : comp       // ссылка на отчет
  ; var XMLReportMap : XmlStruct  // XMLMap отчета
  ; var DDeliv       : date       // Дата сдачи отчета
  ) : boolean;
#endif//__TPR2__

  //----------------------------------------------------------------------------
  #doc
     Удалить отчет
  #end
  procedure DeleteTax(cTax : comp);

  //----------------------------------------------------------------------------
  #doc
     Копировать отчет
  #end
  procedure CopyTax(cSource, cDest : comp);

  //----------------------------------------------------------------------------
  #doc
     Действия выполняемые при 1-м редактировании копии отчета
  #end
  function RunOnFirstEditCopyTax : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить диалог сохранения отчета
  #end
#ifdef  __TPR2__
  function RunSave (var _isNo : boolean) : boolean;
#else
  function RunSave : boolean;
#endif//__TPR2__

  //----------------------------------------------------------------------------
  #doc
     Очистить все
  #end
  procedure ClearAll;

#ifdef  __TPR2__
  //----------------------------------------------------------------------------
  #doc
     Обновить поля таблицы TaxDat
  #end
  procedure UpdateInfoTaxDat_DocEditor;

  //----------------------------------------------------------------------------
  #doc
     Сформировать строковое представление итератора
  #end
  function getStrIter(iter : LongInt) : string;

  //----------------------------------------------------------------------------
  #doc
     Был ли сохранен данный отчет
  #end
  function Get_IsWasSave : boolean;
#endif//__TPR2__
End; //#endregion ObjInterface
//******************************************************************************

#endif//__DocEditor__vih__
