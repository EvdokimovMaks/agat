//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - модуль "Электронная отчетность"
// Мастер интерфейс редактирования : "Электронный отчет"
//------------------------------------------------------------------------------

#ifndef __MasterAllEditor__vih__
#define __MasterAllEditor__vih__

#component "F_TaxReport"

//==============================================================================
#doc
Мастер интерфейс редактирования : "Электронный отчет"
#end
Private ObjInterface OMasterAllEditor;  //#region ObjInterface
  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывести сообщения о последней ошибки выполнения
  #end
  function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region СЕРВИС ДЛЯ РЕДАКТОРА
  //----------------------------------------------------------------------------
  #doc
     Задать текущее окно редактирования показателей
  #end
  procedure SetEditWin(
    _sWinName : string   // наименование окна
  );

  //----------------------------------------------------------------------------
  #doc
     Установить титул master окна
  #end
  procedure SetWinTitle(
    _sTitle   : string   // титул окна
  );

  //----------------------------------------------------------------------------
  #doc
     Активизировать заданную область master окна
  #end
  procedure SelectArea(
    _wArea   : word      // идентификатор области окна
  );

  //----------------------------------------------------------------------------
  #doc
     Установить видимость кнопки на инструментальной панели
  #end
  function SetVisibleToolButton(
    _sToolBar  : string;
    _sButton   : string;
    _isVisible : boolean
  ) : boolean;
  //#endregion СЕРВИС ДЛЯ РЕДАКТОРА
  //****************************************************************************


  //============================================================================
  //#region СЕРВИС ДЛЯ UserTaxRep
  //----------------------------------------------------------------------------
  #doc
     Запустить редактирование заданного отчета
  #end
#ifdef  __TPR2__
  function RunEditTaxRep(
    _sInt         : string         ; // наименование интерфейса редактирования
    _cTax         : comp           ; // ссылка на отчет
    _IsAutoCreate : boolean = False  // признак автоматически созданной декларации
  ) : boolean;
#else
  function RunEditTaxRep(
    _sInt : string;  // наименование интерфейса редактирования
    _cTax : comp     // ссылка на отчет
  ) : boolean;
#endif//__TPR2__

  //----------------------------------------------------------------------------
  #doc
     Запустить 1-й раз редактирование копии отчета
  #end
#ifdef  __TPR2__
  function RunFirstEditCopyTaxRep(
    _sInt         : string         ; // наименование интерфейса редактирования
    _cTax         : comp           ; // ссылка на отчет
    _IsAutoCreate : boolean = False  // признак автоматически созданной декларации
  ) : boolean;
#else
  function RunFirstEditCopyTaxRep(
    _sInt : string;  // наименование интерфейса редактирования
    _cTax : comp     // ссылка на отчет
  ) : boolean;
#endif//__TPR2__

  //----------------------------------------------------------------------------
  #doc
     Скопировать данные заданного отчета
  #end
  function CopyTaxData(
    _sInt : string;  // наименование интерфейса редактирования
    _cSRC : comp;    // ссылка на отчет источник
    _cDST : comp     // ссылка на отчет приемник
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Удалить данные заданного отчета
  #end
  function DelTaxData(
    _sInt : string;  // наименование интерфейса редактирования
    _cTax : comp     // ссылка на отчет
  ) : boolean;

#ifdef  __TPR2__
  //----------------------------------------------------------------------------
  #doc
     Был ли сохранен данный отчет
  #end
  function Get_IsWasSave : boolean;
#endif//__TPR2__
  //#endregion СЕРВИС ДЛЯ UserTaxRep
  //****************************************************************************


  //============================================================================
  //#region CROSSVIPREF
  //----------------------------------------------------------------------------
  #doc
     Освобождение ссылок на объекты, провоцирующие циклические зависимости объектов
  #end
  function FreeCrossVipRef : boolean;
  //#endregion CROSSVIPREF
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface MasterAllEditor implements OMasterAllEditor
#Licensed_Free;
public:
  constructor Init;
  destructor  Done;
End;
//******************************************************************************

#endif//__MasterAllEditor__vih__
