//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Электронная отчетность"
// Табличный объект : "Каталог ставок и льгот по налогу на ТС"
//------------------------------------------------------------------------------

#ifndef __TRTablTSRate_Vih__
#define __TRTablTSRate_Vih__

#Component "F_TaxReport"

//------------------------------------------------------------------------------
#include IModify.Vih        // Модификация табличных объектов
#include IManualIndex.Vih   // Индексы типа Manual
//------------------------------------------------------------------------------

//==============================================================================
#doc
Табличный объект : "Каталог ставок и льгот по налогу на ТС"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface ITRTablTSRate;  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывести сообщения о последней ошибке выполнения
  #end
  function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region FIELDS
  //----------------------------------------------------------------------------
  #doc
     Получить используемое значение поля: "Налоговая ставка"
  #end
  function GetUsedTaxRate : TSumma;

  //----------------------------------------------------------------------------
  #doc
     Получить используемое значение поля: "Освобождение от налога: Код налоговой льготы"
  #end
  function GetUsedFreeLgCode : string;

  //----------------------------------------------------------------------------
  #doc
     Получить используемое значение поля: "Снижение налоговой ставки: Код налоговой льготы"
  #end
  function GetUsedLowRLgCode : string;
  //----------------------------------------------------------------------------
  #doc
     Получить используемое значение поля: "Снижение налоговой ставки: процент"
  #end
  function GetUsedLowRLgProc : TSumma;

  //----------------------------------------------------------------------------
  #doc
     Получить используемое значение поля: "Уменьшение суммы налога: Код налоговой льготы"
  #end
  function GetUsedLowSLgCode : string;
  //----------------------------------------------------------------------------
  #doc
     Получить используемое значение поля: "Уменьшение суммы налога: процент"
  #end
  function GetUsedLowSLgProc : TSumma;
  //#endregion FIELDS
  //****************************************************************************


  //============================================================================
  //#region CHECKFLD
  //----------------------------------------------------------------------------
  #doc
     Проверить корректность полей текущей записи
  #end
  function CheckFld : Boolean;
  //#endregion CHECKFLD
  //****************************************************************************


  //============================================================================
  //#region OBJECTTABLE
  //----------------------------------------------------------------------------
  property NRec         : comp     read write;  // Номер записи
  property Code         : s10      read write;  // Код записи
  property Name         : string   read write;  // Наименование
  property TaxRate      : TSumma   read write;  // Налоговая ставка
  property wLgMode      : word     read write;  // Режим налоговых льгот
  property wLowLgMode   : word     read write;  // Режим снижения налога
  property FreeLgCode   : string   read write;  // Освобождение от налога: Код налоговой льготы
  property LowRLgCode   : string   read write;  // Снижение налоговой ставки: Код налоговой льготы
  property LowRLgProc   : TSumma   read write;  // Снижение налоговой ставки: процент
  property LowSLgCode   : string   read write;  // Уменьшение суммы налога: Код налоговой льготы
  property LowSLgProc   : TSumma   read write;  // Уменьшение суммы налога: процент
  property IsLowRLgMode : boolean  read write;  // Установлен ли режим "Снижение налоговой ставки"
  property IsLowSLgMode : boolean  read write;  // Установлен ли режим "Уменьшение суммы налога"
  property wLowRLgMode  : word     read write;  // Режим "Снижение налоговой ставки"
  property wLowSLgMode  : word     read write;  // Режим "Уменьшение суммы налога"
  //----------------------------------------------------------------------------
  //index TRTablTSRate01 = NRec(Unique, Primary);
  index TRTablTSRate02 = Code;
  //#endregion OBJECTTABLE
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************

//==============================================================================
VipInterface TRTablTSRate implements ITRTablTSRate, IModify, IManualIndex
#Licensed_Free;

Public: //#region Public
  constructor Init;
  destructor  Done;
End; //#endregion Public
//******************************************************************************

#endif//__TRTablTSRate_Vih__
