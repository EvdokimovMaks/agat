//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - модуль "Электронная отчетность"
// Форма печати: "Лог данных расчета стр. 042 и 043"
//------------------------------------------------------------------------------

//==============================================================================
#doc
Базовая форма: "Лог данных расчета стр. 042 и 043"
#end
//------------------------------------------------------------------------------
.set name='RepLogAmortPrib'
.hide
.fields
  CurPer_Start  : Date
  CurPer_Finish : Date

  PrPer_Start  : Date
  PrPer_Finish : Date

  NRec
  TypeOper : String // тип операции: поступление или изменение стоимости
  NumOper  : String // номер операции
  InNum    : String // инвентарный номер ОС
  DateOper : Date   // дата операции
  PrUch    : String // 1 - учитывать в тек. отч. пер. // 2 - учитывать в сл. отч. пер.
  SumAmLg  : Double // сумма амортизационной льготы
  ProcAmLg : Double // % льготы

.endfields
 ^ ^
 ^ ^
.{CycleLogAmortPrib CheckEnter
 ^ ^ ^ ^ ^ ^ ^ ^
.}

.endform
//******************************************************************************


//==============================================================================
#doc
Присоединенная форма: "Все данные"
#end
//------------------------------------------------------------------------------
.linkform 'RepLogAmortPrib1' prototype is 'RepLogAmortPrib'
.Nameinlist 'Лог данных расчета стр. 042 и 043'
.defo landscape
.P 55
.fields
  CommonFormHeader

  CurPer_Start
  CurPer_Finish

  PrPer_Start
  PrPer_Finish

  TypeOper // тип операции: поступление или изменение стоимости
  NumOper  // номер операции
  InNum    // инвентарный номер ОС
  DateOper // дата операции
  PrUch    // 1 - учитывать в тек. отч. пер. // 2 - учитывать в сл. отч. пер.
  SumAmLg  // сумма амортизационной льготы
  ProcAmLg // % льготы

.endfields
.[H Skip
                                                                                                     лист @np@
┌─────────────┬────────────────────┬──────────────────────┬────────────┬──────────┬─────────────────┬────────┐
│  Тип опер.  │   Номер операции   │ Инвентарный номер ОС │ Дата опер. │ Пер. уч. │Сумма аморт. льг.│ % льг. │
├─────────────┼────────────────────┼──────────────────────┼────────────┼──────────┼─────────────────┼────────┤
.]H
^

Текущий период:   с @@@@@@@@@@ по @@@@@@@@@@
Следующий период: с @@@@@@@@@@ по @@@@@@@@@@

                                                  Все данные                                        лист @np@
┌─────────────┬────────────────────┬──────────────────────┬────────────┬──────────┬─────────────────┬────────┐
│  Тип опер.  │   Номер операции   │ Инвентарный номер ОС │ Дата опер. │ Пер. уч. │Сумма аморт. льг.│ % льг. │
├─────────────┼────────────────────┼──────────────────────┼────────────┼──────────┼─────────────────┼────────┤
.{CycleLogAmortPrib CheckEnter
│@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&&&&.&&│&&&&&.&&│
.[F
└─────────────┴────────────────────┴──────────────────────┴────────────┴──────────┴─────────────────┴────────┘
.]F
.}

.endform
//******************************************************************************


//==============================================================================
#doc
Присоединенная форма: "Данные участвовавшие в расчете"
#end
//------------------------------------------------------------------------------
.linkform 'RepLogAmortPrib2' prototype is 'RepLogAmortPrib'
.Nameinlist 'Лог данных расчета стр. 042 и 043 (только участвующие в расчете данные)'
.defo landscape
.P 55
.fields
  CommonFormHeader

  CurPer_Start
  CurPer_Finish

  PrPer_Start
  PrPer_Finish

  TypeOper // тип операции: поступление или изменение стоимости
  NumOper  // номер операции
  InNum    // инвентарный номер ОС
  DateOper // дата операции
  PrUch    // 1 - учитывать в тек. отч. пер. // 2 - учитывать в сл. отч. пер.
  SumAmLg  // сумма амортизационной льготы
  ProcAmLg // % льготы

.endfields
.[H Skip
                                                                                                     лист @np@
┌─────────────┬────────────────────┬──────────────────────┬────────────┬──────────┬─────────────────┬────────┐
│  Тип опер.  │   Номер операции   │ Инвентарный номер ОС │ Дата опер. │ Пер. уч. │Сумма аморт. льг.│ % льг. │
├─────────────┼────────────────────┼──────────────────────┼────────────┼──────────┼─────────────────┼────────┤
.]H
^

Текущий период:   с @@@@@@@@@@ по @@@@@@@@@@
Следующий период: с @@@@@@@@@@ по @@@@@@@@@@

                                        Данные участвовавшие в расчете                              лист @np@
┌─────────────┬────────────────────┬──────────────────────┬────────────┬──────────┬─────────────────┬────────┐
│  Тип опер.  │   Номер операции   │ Инвентарный номер ОС │ Дата опер. │ Пер. уч. │Сумма аморт. льг.│ % льг. │
├─────────────┼────────────────────┼──────────────────────┼────────────┼──────────┼─────────────────┼────────┤
.{CycleLogAmortPrib CheckEnter
.{?internal; ProcAmLg <= 30;
│@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&&&&.&&│&&&&&.&&│
.}
.[F
└─────────────┴────────────────────┴──────────────────────┴────────────┴──────────┴─────────────────┴────────┘
.]F
.}

.endform
