//------------------------------------------------------------------------------
//                                           (c) корпорация ГАЛАКТИКА
// Версия        : 8.1
// Назначение    : Обьектный интерфейс : "Обработка рекламационных накладных в платежах"
//------------------------------------------------------------------------------


#ifndef __ObjAktRec_Vih__
#define __ObjAktRec_Vih__

#ifdef  ComponentVersion
#component "F_SoprHoz"
#endif//ComponentVersion


//------------------------------------------------------------------------------
#doc
Обьектный интерфейс : "Обработка рекламационных накладных в платежах"
#end
ObjInterface iObjLibAktRec;

//------------------------------------------------------------------------------
#doc
  Функция возвращает описание последней ошибки
#end
Function GetStLastError : string;

//------------------------------------------------------------------------------
#doc
   Выполнялось ли вывобождение платежа по рекламации
#end
Function ActRecStatusOb(_cKatSopr : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить признак высвобождения платежа для рекламации
#end
Function SetActRecStatus(_cKatSopr : comp; _wStatus : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Выполнялся ли возврат платежа
#end
Function ReturnStatusOb(_cBaseFin : comp) : boolean;

#doc
   Установить признак обработки возврата платежа
#end
Function SetReturnStatus(_cBaseFin : comp; _wStatus : word) : boolean;

//------------------------------------------------------------------------------
#doc
 Найти накладую которая распределена в данной хозопераии
#end
function GetKatSoprFromSH ( _cFindSH : comp ) : comp;

//------------------------------------------------------------------------------
#doc
 Найти накладую по которой сформирована рекламация
#end
function GetKatSoprFromActRec ( _cAktRec : comp ) : comp;

//------------------------------------------------------------------------------
#doc
 Найти номер накладой по которой сформирована рекламация
#end
Function GetKatSoprNameFromActRec ( _cAktRec : comp ) : string;

//------------------------------------------------------------------------------
#doc
   Высвобождениее ранее распределенного платежа
#end
Function MakeFreePlatWithAktRec(_cKatSopr : comp; bShowMsg : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Возврат денег покупателю по рекламации
#end
Function MakeRelationWithFreePlat(_cPlPor : comp; _cBaseDoc : comp; _cSoprHoz : comp; bShowMsg : boolean) : boolean;

end; // ObjInterface iObjLibAktRec;


//------------------------------------------------------------------------------
ObjInterface iObjLibAktRecV1;

#doc
   Прочитать ссылку на хозоперацию по которой было высвобождение
#end
Function GetRecSH(_cSoprHoz : comp) : comp;

#doc
   Установить ссылку на хозоперацию по которой было высвобождение
#end
Function SetRecSH(_cSoprHoz : comp; _cRec : comp) : boolean;

end; // ObjInterface iObjLibAktRecV1;

//------------------------------------------------------------------------------
#doc
Обьектный интерфейс : "Обработка корректировочных накладных в платежах"
#end
ObjInterface iObjLibCorrDoc;

#doc
   Высвобождение платежей по корректируемым накладным
#end
Function MakeFreePlatWithCorrDoc(_cKatSopr : comp; bShowMsg : boolean) : boolean;

end;

//------------------------------------------------------------------------------
VipInterface ObjLibAktRec implements iObjLibAktRec, iObjLibAktRecV1, iObjLibCorrDoc
#Licensed_Free
;

#endif // __ObjAktRec_Vih__
