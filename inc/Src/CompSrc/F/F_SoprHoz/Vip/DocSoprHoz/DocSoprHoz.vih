//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.1 - Бухгалтерский контур
// ХозОперации документа
//------------------------------------------------------------------------------


#ifndef DocSoprHoz_vih
#define DocSoprHoz_vih

#ifdef ComponentVersion
 #Component "F_SoprHoz"
#end

#include TDocument.vih // Свойства документов и их спецификаций
#include PSManager.vih // Работа с регистрами учета и планами счетов
#include TPlPor.vih
#include ChkSoprHoz.inc // для cgMakeSH, cgSilentMakeSH, cgMakeDoc

#doc
ХозОперации документа
#end
ObjInterface ObjDocSoprHoz;

  #doc
  Инициализация ссылки на объектный интерфейс документа
  #end
  Procedure SetDocIfc(aiDoc: TDocument; _PS: PSManager);

  #doc
  Запуск окна просмотра ХозОпераций документа с проводками
  #end
  Procedure ViewSoprHoz;

  #doc
  Освободить обратные ссылки
  #end
  Procedure FreeLinks;

  #doc
  Позиционирование на текущий документ
  #end
  Procedure GotoDoc;

  #doc
  Изменение режима интерфейса
  #end
  Procedure SetIfcMode(abBaseFin: boolean);

  #doc
  Проверка соответствия атрибутов документа его ХозОперациям<br>
  <i>Возвращает SoprHoz.NRec, созданный для последующей разноски</i>
  #end
  // awMode = [cgMakeSH, cgSilentMakeSH или cgMakeDoc]
  Function CheckDoc(awMode: word): comp;

  #doc
  Выбор Типовой ХозОперации для всего документа
  #end
  Function GetHozOper: boolean;
  
  #doc
  Удаление Типовых ХозОпераций во всем документе
  #end
  Function DelHozOper: boolean;
  
  #doc
  Проверка прав доступа на редактирование документа
  #end
  Event Function EventCanEditDoc(awShowMessage: word; var awDocProtect: word): boolean;

  #doc
  Коррекция атрибутов документа (Генерируется при необходимости изменения атрибутов документа)
  #end
  Event Function EventCorrectDoc(wMode: word; bDocInfo: tInfoDocument) : boolean;

End;

#doc
Расширение №1 интерфейса ObjDocSoprHoz
#end
ObjInterface ObjDocSoprHoz2;

  #doc
  Привязка ТХО и формирование Проводок (по настройке)<br> 
  <i>в документах модулей Спецоснастка и Спецодежда</i>
  #end
  Procedure SetHozOper(acHozOper: comp);

End;


#doc
Расширение №2 интерфейса ObjDocSoprHoz
#end
ObjInterface ObjDocSoprHoz3;

  #doc
  Выбор документа-основания в шапке документа
  #end
  Function GetDO: boolean;

  #doc
  Отмена распределения платежа по документу-основанию в шапке документа
  #end
  Function DelDO: boolean;

End;

#doc
Расширение №3 интерфейса ObjDocSoprHoz
#end
ObjInterface ObjDocSoprHoz4;

  #doc
  Привязка ТХО и формирование Проводок (по настройке)<br>
  <i>в документах модулей Спецоснастка и Спецодежда</i><br>
  без оповещения об ошибках прав доступа
  #end
  Procedure SetHozOperSilent(acHozOper: comp);

End;


#ifdef Atl51
  VipInterface DocSoprHoz implements ObjDocSoprHoz, ObjDocSoprHoz2, ObjDocSoprHoz3, ObjDocSoprHoz4, TDocument Licensed(Free);
#else
  VipInterface DocSoprHoz implements ObjDocSoprHoz, ObjDocSoprHoz2, ObjDocSoprHoz3, ObjDocSoprHoz4, TDocument;
#end

#end // DocSoprHoz_vih
