//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.7 - Бухгалтерский контур
// Расчет долга по ДО
//------------------------------------------------------------------------------

#ifndef __GETDBASE_VIH__
#define __GETDBASE_VIH__

#ifdef ComponentVersion
#Component "F_SoprHoz"
#end

//#include TSoprHoz.vih
//документ к которому привязываем ДО
type TGetDBaseBuf = record
  cPlatDoc : Comp;   //ссылка на шапку документа
  cSoprHoz : Comp;   //ссылка на кусок шапки документа
  TidkGal  : word;   //тип документа

  Summa    : Double; //рублевая сумма документа
  SumValut : Double; //валютная сумма документа
  cVal     : Comp;   //валюта документа

  dVip : Date;       //дата выписки документа
  dOb  : Date;       //дата оплаты документа
end;
//------------------------------------------------------------------------------
#doc
Расчет долга по ДО
#end
ObjInterface ObjGetDB;

  #doc
  Функция возвращает сумму долга по ДО
  #end
  //функция возвращает сумму долга по ДО с позицией Pos. TipCulc - вид долга
  // 0   долг по платежам   (не оплачено по ДО)
  // 1   долг по отгрузкам  (сумма не отгруженного)
  // 2   долг с учетом отгрузок МЦ (отгруженно но не оплачено)
  // 3   сумма по ДО
  // 4   расчет суммы по алгоритму
  // 5   сумма по накладным (отгрузки/поставки)
  //10   долг с учетом возвратов (долго работает)
  //запуск
  function Run(pOkOne       : boolean;
             var pmyDirect    : word;
             var pmyVidDoc    : word;
             var pmyGetBDoc   : comp;
             var pmyGetSDoc   : comp;
             var pmyGetOrgDoc : comp;
             var pmySumma     : TSumma;
             var pSH : TGetDBaseBuf) : word;

  #doc
  Сумма долга по ДО, исключая из внимания указанную SoprHoz
  #end
  function GetDolgBaseDocExceptSoprHoz(Poz: comp; tipCulc: word;
                                            _cExceptSoprHoz: comp) : double;

  #doc
  Сумма долга по заданному ДО
  #end
  function GetDolgBaseDoc(Poz : comp;tipCulc : word) : double;
end;
//------------------------------------------------------------------------------
#doc
Объект работы с фильтрами хранимыми в ДСК
#end
ObjInterface ObjGetDBFltParam;

  Function GetAlgByVidDoc(wVidDoc : word): Word;
  Procedure SetAlgByVidDoc(wVidDoc, wValue : Word);

  function  GetDBParam(sParamName : string): variant;
  procedure SetDBParam(sParamName : string; vValue : variant);

End;
//------------------------------------------------------------------------------

VipInterface GetDbase
  implements ObjGetDB, ObjGetDBFltParam
#ifdef Atl51
  licensed   (FREE)
  Parameters (OkOne : boolean; myDirect : word; myVidDoc : word; myGetBDoc : comp; myGetSDoc : comp; myGetOrgDoc : comp; mySumma : TSumma)
#end
;
#end
