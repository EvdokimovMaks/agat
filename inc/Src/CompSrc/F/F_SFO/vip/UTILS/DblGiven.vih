//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.1 - Спецодежда
// Функции для работы с двойными выдачами спецодежды
//------------------------------------------------------------------------------

#ifndef __DBLGIVEN_VIH__
#define __DBLGIVEN_VIH__

#ifdef ComponentVersion
 #Component "F_SFO"
#end

Const
  cgDblGiv_Insert = 1;
  cgDblGiv_Update = 2;
  cgDblGiv_Delete = 3;
end;

#doc
Функции для работы с двойными выдачами спецодежды
#end
ObjInterface ObjDblGiven;

  #doc
  Выдан ли предмет по спецификации нормы с двойной выдачей
  #end
  Function IsDblGiven(acPersSFO: comp): boolean;

  #doc
  Установлен ли признак двойной выдачи в справочнике норм
  #end
  Function IsDblGivenByNorm(acPersSpec: comp; adCount: date): boolean;

  #doc
  Пересчет даты окончания срока носки при двойной выдаче
  #end
  Procedure SetSrokSFO(acPersSFO: comp; awMode: word);

  #doc
  Расчет количества спецодежды, находящейся в носке
  #end
  Function GetInUseSFO(acPersSpec: comp; adCount: date) : double;

end;

ObjInterface ObjDblGiven2(ObjDblGiven);
  #doc
  Установлено ли ограничение на количество, выдаваемое по требованию
  #end
  Function IsLimitReqKol(acPersSpec: comp): boolean;

end;

#doc
Функции для работы с едиными выдачами спецодежды
#end
ObjInterface ObjUnitGiven;

  #doc
  Установлен ли признак единой выдачи в справочнике норм
  #end
  Function IsUnitGivenByNorm(acPersSpec: comp; adCount: date): boolean;

end;

VipInterface DblGiven implements ObjDblGiven, ObjDblGiven2, ObjUnitGiven licensed(FREE);

#end // __DBLGIVEN_VIH__
