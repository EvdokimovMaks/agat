//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецодежда
// Печать справочника норм выдачи СФО
//------------------------------------------------------------------------------

#doc
Печать справочника норм выдачи СФО.<br>
#end
.Form LstNrSFOProt
.Group 'Список'
.Group 'Иерархия'
.Group 'Соответствия'
.Hide
.Fields
   fNormKod : String  fNormName : String
   fNacop   : String  fSingle   : String
   fIsNorm  : Boolean fLevel    : Longint
   fFrDate  : String  fToDate   : String
   fGrpKod  : String  fGrpName  : String
   fEd : String  fKol : Word  fSrok : String
   fArticle : String  fCls : String
   fAlign : String
.endFields
.{
   ^ ^ ^ ^ ^ ^
.{
   ^ ^
.{
   ^ ^ ^ ^ ^ ^ ^ ^
.}
.}
.}
.endForm

!------------------------------------------------------------

.LinkFORM  LstNrSFO  Prototype Is LstNrSFOProt
.Group 'Список'
.NameInList 'Нормы выдачи спецодежды'
.Fields
   CommonFormHeader
   fNormKod fNormName
   fNacop   fSingle
   fFrDate  fToDate
   fGrpKod  fGrpName  fEd
   fKol  fSrok  fArticle
   fCls  fAlign
.endFields
 И   ^

                   Нормы выдачи специальной (форменной) одежды
  ┌────────────────────┬───────────────────────────────┬────────┬───┬─────────┬──────┬───┬───┐
  │        Код         │         Наименование          │Ед. изм.│Кол│Срок(мес)│Парагр│Зак│Выр│
  └────────────────────┴───────────────────────────────┴────────┴───┴─────────┴──────┴───┴───┘
.{

    Б@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   ^ ^ Б
   ──────────────────────────────────────────────────────────────────────────────────────────
.{

     ^   ^
.{
   @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@ &#& &&&&&&&&& @@@@@@  @   @
.}
.}
   ──────────────────────────────────────────────────────────────────────────────────────────
.} И
.endForm

!------------------------------------------------------------

.LinkFORM  IerNrSFO  Prototype Is LstNrSFOProt
.Group 'Иерархия'
.NameInList 'Нормы выдачи спецодежды'
.Fields
   CommonFormHeader
   PadCh('', ' ', fLevel)
   fNormKod fNormName
   PadCh('', ' ', fLevel)
   fNormKod fNormName
   fNacop   fSingle
   fFrDate  fToDate
   fGrpKod  fGrpName  fEd
   fKol  fSrok  fArticle
   fCls  fAlign
.endFields
 И   ^

                   Нормы выдачи специальной (форменной) одежды
  ┌────────────────────┬───────────────────────────────┬────────┬───┬─────────┬──────┬───┬───┐
  │        Код         │         Наименование          │Ед. изм.│Кол│Срок(мес)│Парагр│Зак│Выр│
  └────────────────────┴───────────────────────────────┴────────┴───┴─────────┴──────┴───┴───┘
.{
.{?Internal;(not fIsNorm);
    Б^@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}
.{?Internal;fIsNorm;
   ^@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   ^ ^
   ──────────────────────────────────────────────────────────────────────────────────────────
.}
.{
.{?Internal;fIsNorm;

     ^   ^
.}
.{
.{?Internal;fIsNorm;
   @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@ &#& &&&&&&&&& @@@@@@  @   @
.}
.}
.}
   ──────────────────────────────────────────────────────────────────────────────────────────
.} И
.endForm

!------------------------------------------------------------

.LinkFORM  LstAccords  Prototype Is LstNrSFOProt
.Group 'Соответствия'
.NameInList 'Соответствия должность - норма'
.Fields
   CommonFormHeader
   fNormName + if (fNormKod <> '', ' (' + fNormKod + ')', '')
   fNacop + if (fSingle <> '', ' (' + fSingle + ')', '')
   if (fLevel = 2, 'Жен.', if (fLevel = 1, 'Муж.', '-'))
   fGrpKod  fGrpName
   fCls  fAlign
.endFields
 Ш   ^

                                Соответствия должностей и норм выдачи специальной (форменной) одежды
  ┌─────────────────────┬────────────────────────────────────────────────────────────────────────────────────────┬───────────┬───────────┐
  │      Код нормы      │                                   Наименование нормы                                   │Форм./Спец.│ Осн./Доп. │
  └─────────────────────┴────────────────────────────────────────────────────────────────────────────────────────┴───────────┴───────────┘
.{
    Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.{?Internal;(fNacop <> '');
      Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}
.{?Internal;(fLevel <> 0);
        Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}
   ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
   @@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@@@│@~@@@@@@@@@
.}
.}
   ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.} Ш
.endForm
