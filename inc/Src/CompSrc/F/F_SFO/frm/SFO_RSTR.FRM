//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецодежда
// Реестр документов СФО
//------------------------------------------------------------------------------

#doc
Печать реестров специфических документов модуля "Спецодежда": Аттестатов
на вещевое довольствие, Актов выбытия, Документов на возврат из использования,
Документов по расчетам при увольнении.<br>
#end
.Form SFODocsReestrProt
.Hide
.Fields
  RepType:word
  ReestrType : String
  BegDate : Date  EndDate : Date
  Filter : String
  MyOrgName : String
  NDE_ShName : String

  DocDate : Date   DocNum : String
  fDesGr : String  fDescr : String
  Person : String  TabN : String    CardNom : String
  Podr : String    frmSum : Double  spcSum : Double

  totFrmSum : Double  totSpcSum : Double
.endFields
   ^ - тип отчета
   ^ - название реестра
   ^ ^ - диапазон дат формирования реестра
   ^ - информация об установке фильтра
   ^ - наименование собственной организации
   ^ - сокращенное наименование НДЕ
.{
  ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}
  ^ ^
.{ CheckEnter FeeSignersCycle_SFODocsReestrProt
.Fields
  Подписант_nRec : comp
  Подписант_ФИО : String
  Подписант_Табельный_Номер : String
  Подписант_Должность : String
  Подписант_Роль : String
.EndFields
  ^ ^ ^ ^ ^
.}
.endForm

//-------------------------------------------------------------------------

.linkForm SFODocsReestr01 prototype is SFODocsReestrProt
.Group 'суммы вместе'
.NameInList 'Реестр разнесенных требований (суммы вместе)'
.Fields
  CommonFormHeader
  MyOrgName
  ReestrType
  DateToStr(BegDate, 'DD/MM/YYYY')
  DateToStr(EndDate, 'DD/MM/YYYY')
  Filter
  NDE_ShName
  DateToStr(DocDate, 'DD/MM/YYYY')  DocNum  Person  TabN  CardNom  Podr  frmSum + spcSum
  totFrmSum + totSpcSum
.endFields
 Р ^
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

                  Реестр @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                  сформированных за период с  @~@@@@@@@@ по @~@@@@@@@@

  Установленные фильтры: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.[h
                                                                                               стр.@np@
┌──────────┬──────────┬───────────────────────────┬───────┬──────────┬─────────────────┬───────────────┐
│   Дата   │  Номер   │            ФИО            │ Таб.№ │№ карточки│  Подразделение  │ Сумма, @@@@@@ │
└──────────┴──────────┴───────────────────────────┴───────┴──────────┴─────────────────┴───────────────┘
.]h
 @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@ &'&&&&&&&&&&.&&
.}
───────────────────────────────────────────────────────────────────────────────────────────────────────
 Б Итого:                                                                                 &'&&&&&&&&&&.&& Б
.{ CheckEnter FeeSignersCycle_SFODocsReestrProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   ___________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
             должность                     подпись                     расшифровка подписи
.} Р
.endForm

//-------------------------------------------------------------------------

.linkForm SFODocsReestr02 prototype is SFODocsReestrProt
.Group 'суммы раздельно'
.NameInList 'Реестр разнесенных требований (суммы раздельно)'
.Fields
  CommonFormHeader
  MyOrgName
  ReestrType
  DateToStr(BegDate, 'DD/MM/YYYY')
  DateToStr(EndDate, 'DD/MM/YYYY')
  Filter
  NDE_ShName
  DateToStr(DocDate, 'DD/MM/YYYY')  DocNum  Person  TabN  CardNom  Podr  frmSum  spcSum
  totFrmSum totSpcSum
.endFields
 Р ^
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

                  Реестр @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                  сформированных за период с  @~@@@@@@@@ по @~@@@@@@@@

  Установленные фильтры: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.[h
                                                                                                               стр.@np@
┌──────────┬──────────┬───────────────────────────┬───────┬──────────┬─────────────────┬───────────────────────────────┐
│          │          │                           │       │          │                 │         Сумма, @@@@@@         │
│   Дата   │  Номер   │            ФИО            │ Таб.№ │№ карточки│  Подразделение  ├───────────────┬───────────────┤
│          │          │                           │       │          │                 │   Форменная   │  Специальная  │
└──────────┴──────────┴───────────────────────────┴───────┴──────────┴─────────────────┴───────────────┴───────────────┘
.]h
 @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@ &'&&&&&&&&&&.&& &'&&&&&&&&&&.&&
.}
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б Итого:                                                                                 &'&&&&&&&&&&.&& &'&&&&&&&&&&.&& Б
.{ CheckEnter FeeSignersCycle_SFODocsReestrProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   ___________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
             должность                     подпись                     расшифровка подписи
.} Р
.endForm

//-------------------------------------------------------------------------

.linkForm SFODocsReestr03 prototype is SFODocsReestrProt
.Group 'неразнесенное'
.NameInList 'Реестр неразнесенных требований'
.Fields
  CommonFormHeader
  MyOrgName
  ReestrType
  DateToStr(BegDate, 'DD/MM/YYYY')
  DateToStr(EndDate, 'DD/MM/YYYY')
  Filter
  DateToStr(DocDate, 'DD/MM/YYYY')  DocNum  Person  TabN  CardNom  Podr
.endFields
 Р ^
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

                  Реестр @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                  сформированных за период с  @~@@@@@@@@ по @~@@@@@@@@

  Установленные фильтры: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.[h
                                                                               стр.@np@
┌──────────┬──────────┬───────────────────────────┬───────┬──────────┬─────────────────┐
│   Дата   │  Номер   │            ФИО            │ Таб.№ │№ карточки│  Подразделение  │
└──────────┴──────────┴───────────────────────────┴───────┴──────────┴─────────────────┘
.]h
 @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@
.}
───────────────────────────────────────────────────────────────────────────────────────
.{ CheckEnter FeeSignersCycle_SFODocsReestrProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   _______________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
          должность                подпись                расшифровка подписи
.} Р
.endForm
