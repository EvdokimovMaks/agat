//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецодежда
// Печать Личной карточки учета СФО
//------------------------------------------------------------------------------

#doc
Формирование различных печатных вариантов ЛК учета СФО.<br>
#end
// Заполнение данными в PrsCdPr.vpp и PrsCrdBasket.vip
.Set Name = 'PersCardProt'
.Hide
.Var
  IsCustom : boolean;
.endVar
.Begin
  if (Lic_ItemExists('Custom'))
    IsCustom := True;
end.
.{
.Fields
  OrgName : String  ОКПО : String  CardNo : String  sostDate : Date
  FIO : String  TabN : String  Pol : String  Cex : String  Podr : String
  Prof : String  InDate : Date chDate : Date uvDate : Date
  Rost : String  Od1 : String  Od2 : String  Ob : String
  GUb : String  Perch : String  ISZ : String Pog : String  Ob2 : String
  GMask : String Respir : String Rukav : String
  cSigners : Comp
  frmFlag : Boolean  spcFlag : Boolean
.endFields
  ^ ^ ^ ^
  ^ ^ ^ ^ ^ ^
  ^ ^ ^
  ^ ^ ^ ^ ^ ^ ^ ^ ^
  ^ ^ ^
  ^
  ^ ^

.{ frmCircle checkenter
.Fields
  frName  : String  frKod : String  frIsSIZ : Boolean frEd   : String
  frPar   : String  frKol : String  frSrok  : String  frMark : String
  frIsSOS : Boolean frRec : Comp
.endFields
  ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}

.{ spcCircle checkenter
.Fields
  spName  : String  spKod : String  spIsSIZ : Boolean spEd   : String
  spPar   : String  spKol : String  spSrok  : String  spMark : String
  spIsSOS : Boolean spRec : Comp
.endFields
  ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.Fields
  frStr : String
.endFields
 ^
.{
.Fields
  sfName : String  sfKod : String  sfIsSIZ : Boolean sfGive : Date  sfGiveKol : Double
  sfPrice : Double  sfPercGodnIn : Double
  SrokInUse: String DopInfo: String  sfMark : String MBPInNRec : Comp
  NSertif: String DSertif: Date WSertif: String
  spisType : String  sfSpis : Date  sfSpisKol : Double
  sfSpisPrice : Double  sfPercGodnOut : Double
  NumAct : String sfIsSOS : Boolean PasNum : String
  ExpDoc : String ReqDoc : String GivDoc : String OutDoc : String
.endFields
 ^ ^ ^ ^ ^ ^ ^
 ^ ^ ^ ^
 ^ ^ ^
 ^ ^ ^ ^ ^
 ^ ^ ^
 ^ ^ ^ ^
.}
.}
.endForm

!------------------------------------------------------------

.LinkFORM PersCard Prototype Is PersCardProt
.Group 'Личные карточки учета СФО'
.Group 'Личные карточки учета СФО (Беларусь)'
.NameInList 'Личная карточка учета СФО'
.declare
#include FeeSigners.vih
.endDeclare
.Var
  totSum : double;
  iFeeSigners : FeeSigners;
  sBuh, sDirect : string;
.endVar
.begin
  // Бухгалтер и руководитель
  sBuh := sDirect := '';
  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Бухгалтер'))
      sBuh := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Директор'))
      sDirect := iFeeSigners.GetSignerFIO(7);

    iFeeSigners.ClearRestriction;
  }
end.
.{
.Fields
  CommonFormHeader
  OrgName  CardNo  FIO TabN  Pol  Cex
  Podr  Rost
  Prof  Od1
  if (Longint(InDate) = 0, '', DateToStr(InDate, 'DD/MM/YYYY'))  Od2
  if (Longint(chDate) = 0, '', DateToStr(chDate, 'DD/MM/YYYY'))  Ob
  if (Longint(uvDate) = 0, '', DateToStr(uvDate, 'DD/MM/YYYY'))  Ob2
  Perch  GUb  ISZ
.endFields
  ^
  ^

                        ЛИЧНАЯ КАРТОЧКА №  Б^ Б
            УЧЕТА ФОРМЕННОЙ И СПЕЦИАЛЬНОЙ ОДЕЖДЫ, ОБУВИ,
                  ПРЕДОХРАНИТЕЛЬНЫХ ПРИСПОСОБЛЕНИЙ

Фамилия И.О.   Б^ Б
Табельный номер  @@@@@@@@@@                             Пол         @@@
Цех(Отдел)  &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
Вышестоящее &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&          Рост      &&&&&
Профессия (должность) &&&&&&&&&&&&&&&&&&&&&&&&  Размеры:одежды1   &&&&&
Дата поступления на работу          @@@@@@@@@@          одежды2   &&&&&
Дата изменения норм (проф., должн.) @#@@@@@@@@          обуви1    &&&&&
Дата увольнения                     @#@@@@@@@@          обуви2    &&&&&
                                                        перчаток  &&&&&
                                                        гол.убора &&&&&
                                                        ИСЗ       &&&&&
.{?INTERNAL; (IsCustom)
.Fields
  Pog
.endFields
                                                        погон     &&&&&
.}

Предусмотрено по утвержденным нормам
.{?Internal;(frmFlag=True);

 Форменная одежда и обувь
┌───────────┬─────────────────────┬──────────┬──────────┬────────┬─────────┐
│    Код    │     Наименование    │  Ед.изм. │ Пар.норм │ Кол-во │   Срок  │
├───────────┼─────────────────────┼──────────┼──────────┼────────┼─────────┤
.{ frmCircle checkenter
.Fields
  frKod  frName  frEd  frPar  frKol  frSrok
.endFields
│@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&│&&&&&&&&&│
.}
└───────────┴─────────────────────┴──────────┴──────────┴────────┴─────────┘
.}
.{?Internal;(spcFlag=True);

 Специальная одежда и обувь
┌───────────┬─────────────────────┬──────────┬──────────┬────────┬─────────┐
│    Код    │     Наименование    │  Ед.изм. │ Пар.норм │ Кол-во │   Срок  │
├───────────┼─────────────────────┼──────────┼──────────┼────────┼─────────┤
.{ spcCircle checkenter
.Fields
  spKod  spName  spEd  spPar  spKol  spSrok
.endFields
│@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&│&&&&&&&&&│
.}
└───────────┴─────────────────────┴──────────┴──────────┴────────┴─────────┘
.}
.Fields
  sBuh sDirect
.endFields

Начальник ОТБ                      Бухгалтер               @@@@@@@@@@@@@@@@@@@
Инженер ОТ и ТБ                    Начальник цеха (отдела) @@@@@@@@@@@@@@@@@@@


.Fields
  frStr  if (Longint(sostDate) = 0, '', DateToStr(sostDate, 'DD/MM/YYYY'))
.endFields
.begin
  totSum := 0;
end.

 РВыдача и возврат форменной и специальной одежды и обуви, предохранит. приспособлений.
Выдано ^. Cостояние на ^.
┌──────────────────────────────────┬─────────────────────────────────────────────────────────┬────────────────────────────────────────┐
│ Форм. и спецодежда,обувь, присп. │                         Выдано                          │            Возвращено, списано         │
├──────────────────────┬───────────┼──────────┬──────┬──────────┬─────────────┬──────────────┼───────┬──────────┬──────┬──────────────┤
│     Наименование     │ Номенкл.№ │   Дата   │ К-во │   Цена   │  Стоимость  │Прим.(подпись)│Отметка│   Дата   │ К-во │Прим.(подпись)│
├──────────────────────┼───────────┼──────────┼──────┼──────────┼─────────────┼──────────────┼───────┼──────────┼──────┼──────────────┤
.{
.Fields
  sfName  sfKod  if (Longint(sfGive) = 0, '', DateToStr(sfGive, 'DD/MM/YYYY'))  sfGiveKol  sfPrice  sfGiveKol*sfPrice  GivDoc
  spisType  if (Longint(sfSpis) = 0, '', DateToStr(sfSpis, 'DD/MM/YYYY'))  sfSpisKol  OutDoc
.endFields
.begin
  totSum := totSum + (sfGiveKol * sfPrice - sfSpisKol * sfSpisPrice);
end.
│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│&#&&&&│&#&&&&&.&&│&#&&&&&&&&.&&│@@@@@@@@@@@@@@│@@~@@@@│@@@@@@@@@@│&#&&&&│@@@@@@@@@@@@@@│
.}
└──────────────────────┴───────────┴──────────┴──────┴──────────┴─────────────┴──────────────┴───────┴──────────┴──────┴──────────────┘
 Р
.Fields
  totSum
.endFields
 БИтого по находящимся в использовании : &'#&&&&&&&&.&& Б

.}
.endForm

!===================================================================================================
.LinkFORM PersCard_MB_2 Prototype Is PersCardProt
.Group 'Личные карточки учета СФО'
.Group 'Личные карточки учета СФО (Беларусь)'
.NameInList 'Личная карточка учета МБП'
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  PrintObr : Boolean;
  PageNumber : Longint;
  iFeeSigners : FeeSigners;
  sFIO, sPost : string;
.endvar
.begin
  // Составитель карточки
  sFIO := sPost := '';
  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Составитель'))
    {
      sFIO := iFeeSigners.GetSignerFIO(1);
      sPost := iFeeSigners.GetSignerPosition(1)
    }

    iFeeSigners.ClearRestriction;
  }
end.
.{
.Fields
  CommonFormHeader
  CardNo
  OrgName
  ОКПО
  Cex
  if (Longint(sostDate) = 0, '', DateToStr(sostDate, 'DD/MM/YYYY'))
  Cex
  TabN
  FIO
  Prof
.endFields
.begin
  PrintObr := True;
  PageNumber := 1;
end.
 Ш ^
                                                                                                            Типовая межотраслевая форма № МБ-2
                                                                                                            Утверждена постановлением Госкомстата России
                                                                                                            от 30.10.97 № 71а
                                               БКАРТОЧКА №  Д@~@@@@@@@@ Е                                                                       ┌─────────────┐
                              Бучета малоценных и быстроизнашивающихся предметов Б                                                            │    Коды     │
                                                                                                                                           Б├─────────────┤ Б
                                                                                                                            Форма по ОКУД  Б│   0320001   │ Б
                                                                                                                                           Б├ Б───────────── Б┤ Б
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е            по ОКПО  Б│@~@@@@@@@@@@@│ Б
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                     Б└─────────────┘ Б
                                                 ┌──────────┬──────────┬───────────────────────────┬──────────────┬──────────────────────────┬──────────┐
                                                 │   Дата   │          │        Cтруктурное        │     Вид      │  Корреспондирующий счет  │Табельный │
                                                 │  состав- │ Код вида │       подразделение       │ деятельности ├─────────┬────────────────┤  номер   │
                                                 │   ления  │ операции │                           │              │  счет,  │  код аналити-  │получателя│
                                                 │          │          │                           │              │ субсчет │ ческого учета  │          │
                                                 ├──────────┼──────────┼───────────────────────────┼──────────────┼─────────┼────────────────┼──────────┤
                                                 │@@@@@@@@@@│          │@~@@@@@@@@@@@@@@@@@@@@@@@@@│              │         │                │@~@@@@@@@@│
                                                 └──────────┴──────────┴───────────────────────────┴──────────────┴─────────┴────────────────┴──────────┘
 Фамилия И.,О.  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
  ДПрофессия  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
 Должность
.{ frmCircle checkenter
.}
.{ spcCircle checkenter
.}
.{
.[h
.{?INTERNAL;(PageNumber > 1) // На всех страницах, кроме первой

.}
.{?INTERNAL;((PageNumber mod 2) = 0) // На четных страницах
                                                                                                                          Оборотная сторона формы № МБ-2
.}
╔══════════════════════════════════════════╦════════════════════════════════════╦══════════════════════════════╦════════════════════╦════════╦══════════╗
║                   Предмет                ║              Выдано                ║           Возвращено         ║     Акт выбытия    ║        ║          ║
╟───────────────────────────┬──────────────╫──────────┬────────┬────────────────╫──────────┬────────┬──────────╫─────────┬──────────╢  Срок  ║  Номер   ║
║       Наименование,       │ Номенклатур- ║   Дата   │ Кол-во │Подпись работни-║   Дата   │ Кол-во │ Подпись  ║  Номер  │   Дата   ║ службы ║ паспорта ║
║       марка, размер       │   ный номер  ║          │        │ ка (бригадира) ║          │        │кладовщика║         │          ║        ║          ║
╟───────────────────────────┼──────────────╫──────────┼────────┼────────────────╫──────────┼────────┼──────────╫─────────┼──────────╫────────╫──────────╢
║             1             │      2       ║     3    │    4   │       5        ║     6    │    7   │     8    ║    9    │    10    ║   11   ║    12    ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
.]h
.Fields
  sfName
  sfKod
  if (Longint(sfGive) = 0, '', DateToStr(sfGive, 'DD/MM/YYYY'))
  sfGiveKol
  GivDoc
  if (Longint(sfSpis) = 0, '', DateToStr(sfSpis, 'DD/MM/YYYY'))
  sfSpisKol
  NumAct
  if (Longint(sfSpis) = 0, '', DateToStr(sfSpis, 'DD/MM/YYYY'))
  SrokInUse
  PasNum
  sPost
  sFIO
  sPost
  sFIO
.endFields
║@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@║@@@@@@@@@@│&#&&&.&&│@@@@@@@@@@@@@@@@║@@@@@@@@@@│&#&&&.&&│          ║@~@@@@@@@│@~@@@@@@@@║@~@@#@@@║@@@@@@@@@@║
.[f1
.begin
  PrintObr := True;
  PageNumber := PageNumber + 1;
end.
╚═══════════════════════════╧══════════════╩══════════╧════════╧════════════════╩══════════╧════════╧══════════╩═════════╧══════════╩════════╩══════════╝
.]f
.[f2
.begin
  PrintObr := False;
  PageNumber := PageNumber + 1;
end.
╚═══════════════════════════╧══════════════╩══════════╧════════╧════════════════╩══════════╧════════╧══════════╩═════════╧══════════╩════════╩══════════╝
Карточку заполнил  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                            должность           подпись              расшифровка подписи

                  "  "  ___________  20  г.
.]f
.}
.{?INTERNAL;PrintObr

                                                                                                                           Оборотная сторона формы № МБ-2
╔══════════════════════════════════════════╦════════════════════════════════════╦══════════════════════════════╦════════════════════╦════════╦══════════╗
║                   Предмет                ║              Выдано                ║           Возвращено         ║     Акт выбытия    ║        ║          ║
╟───────────────────────────┬──────────────╫──────────┬────────┬────────────────╫──────────┬────────┬──────────╫─────────┬──────────╢  Срок  ║  Номер   ║
║       Наименование,       │ Номенклатур- ║   Дата   │ Кол-во │Подпись работни-║   Дата   │ Кол-во │ Подпись  ║  Номер  │   Дата   ║ службы ║ паспорта ║
║       марка, размер       │   ный номер  ║          │        │ ка (бригадира) ║          │        │кладовщика║         │          ║        ║          ║
╟───────────────────────────┼──────────────╫──────────┼────────┼────────────────╫──────────┼────────┼──────────╫─────────┼──────────╫────────╫──────────╢
║             1             │      2       ║     3    │    4   │       5        ║     6    │    7   │     8    ║    9    │    10    ║   11   ║    12    ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╚═══════════════════════════╧══════════════╩══════════╧════════╧════════════════╩══════════╧════════╧══════════╩═════════╧══════════╩════════╩══════════╝
Карточку заполнил  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                            должность           подпись              расшифровка подписи

                  "  "  ___________  20  г.
.} Ш
.fields
  'true' : 's'
.endfields
^
.}
.endForm

!===================================================================================================
.LinkFORM PersCard_M37_p Prototype Is PersCardProt
.Group 'Личные карточки учета СФО (Беларусь)'
.NameInList 'Личная карточка учета СФО (Форма M-37п)'
.f "MBPM_37p.OUT"
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  totSum : Double;
  Counter1 : Longint;
  Counter2 : Longint;
  PrintObr : Boolean;
  PrintBrk : Boolean;
  iFeeSigners : FeeSigners;
  sBuh, sSostav : string;
  Nom_Utv, Kol_Utv : longint;
  Utv_FIO, Utv_Post : array [1..2] of string;
.endVar
.begin
  // Бухгалтер, составитель, согласующие лица
  for (Kol_Utv := 1; Kol_Utv <= Count(Utv_FIO); Kol_Utv++)
  {
    Utv_FIO[Kol_Utv] := '';
    Utv_Post[Kol_Utv] := '';
  }

  sBuh := sSostav := '';
  Kol_Utv := 0;

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Бухгалтер'))
      sBuh := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Составитель'))
      sSostav := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Утверждающее лицо'))
      if (iFeeSigners.GetSignerFirst)
        do
        {
          Kol_Utv++;
          Utv_FIO[Kol_Utv] := iFeeSigners.GetSignerFIO(7);
          Utv_Post[Kol_Utv] := iFeeSigners.GetSignerPosition(1);
        }
        while (iFeeSigners.GetSignerNext);

    iFeeSigners.ClearRestriction;
  }

  if (Kol_Utv = 0)
  {
    Kol_Utv := 3;
    Utv_FIO[1] := Utv_FIO[2] := Utv_FIO[3] := '';
    Utv_Post[1] := Utv_Post[2] := Utv_Post[3] := '';
  }
end.
.{
.Fields
  CommonFormHeader
  OrgName
  ОКПО
  Cex
  CardNo
  if (Longint(sostDate) = 0, '', DateToStr(sostDate, 'DD/MM/YYYY'))
  FIO
  Prof
  //------
  TabN
  Cex
  if (Longint(InDate) = 0, '', DateToStr(InDate, 'DD/MM/YYYY'))
  if (Longint(chDate) = 0, '', DateToStr(chDate, 'DD/MM/YYYY'))
  Pol
  Rost
  Od1
  Ob
  GUb
  'true' : 's'
.endFields
.begin
  totSum := 0;
  Counter1 := 0;
  PrintObr := True;
end.
 Р ^
                                                                                                                           Утверждена
                                                                                                          Постановлением Министерства
                                                                                                                    промышленности РБ
                                                                                                                    от 29.12.2004 №21

                                                                                                                          Форма М-37п
                                                                                                                        ┌────────────┐
                                                                                                                        │    Коды    │
                                                                                                                        ├────────────┤
                                                                                                          Форма по ОКУД │            │
                                                                                                                        ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д по ОКЮЛП │@~@@@@@@@@@@│
                                               наименование организации                                                 ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д          │            │
                                       наименование структурного подразделения                                          └────────────┘
                                                                                           ┌─────────────────┬──────────────────┐
                                             БЛИЧНАЯ КАРТОЧКА Б                                │      Номер      │       Дата       │
                                       БУЧЕТА СПЕЦОДЕЖДЫ, СПЕЦОБУВИ Б                          │    документа    │    составления   │
                                   БИ ПРЕДОХРАНИТЕЛЬНЫХ ПРИСПОСОБЛЕНИЙ Б                       ├─────────────────┼──────────────────┤
                                                                                           │@~@@@@@@@@@@@@@@@│@~@@@@@@@@@@@@@@@@│
                                                                                           └─────────────────┴──────────────────┘
  Фамилия, и., о. работника  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
   ДПрофессия  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
  Должность

   БИнформация о работнике Б
 ┌────────────┬─────────────────────────────────────────────────────┬──────────────────────────┬─────┬───────┬───────────────────────┐
 │            │                Подразделения организации            │            Дата          │     │       │         Размер        │
 │  Табельный ├─────────────────┬─────────────────┬─────────────────┼─────────────┬────────────┤ Пол │ Рост  ├──────┬─────┬──────────┤
 │    номер   │                 │                 │                 │ поступления │ изменения  │     │       │одежды│обуви│ головного│
 │            │                 │                 │                 │  на работу  │ профессии  │     │       │      │     │   убора  │
 ├────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────┼────────────┼─────┼───────┼──────┼─────┼──────────┤
 │     1      │        2        │        3        │         4       │      5      │      6     │  7  │   8   │  9   │ 10  │    11    │
 ├────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────┼────────────┼─────┼───────┼──────┼─────┼──────────┤
 │@~@@@@@@@@@@│@@@@@@@@@@@@@@@@@│                 │                 │@~@@@@@@@@@@@│@~@@@@@@@@@@│@~@@@│&&&&&&&│&&&&&&│&&&&&│&&&&&&&&&&│
 └────────────┴─────────────────┴─────────────────┴─────────────────┴─────────────┴────────────┴─────┴───────┴──────┴─────┴──────────┘
^
 Б Предусмотрено по утвержденным нормам: Б
.begin
  PrintBrk := False;
end.
.{ frmCircle checkenter
.[h
.{?INTERNAL;PrintBrk // На всех страницах, кроме первой

.}
 ┌─────────────────────────────────────────────────────────────────────────────────────┬─────────────┬─────────┬──────────┬──────────┐
 │                                                                                     │  Основание  │         │          │          │
 │                            Наименование спецодежды, спецобуви,                      │ (ссылка на  │ Единица │Количество│Срок носки│
 │                             предохранительных приспособлений                        │ нормативный │измерения│          │          │
 │                                                                                     │  документ)  │         │          │          │
 ├─────────────────────────────────────────────────────────────────────────────────────┼─────────────┼─────────┼──────────┼──────────┤
 │                                          1                                          │      2      │    3    │    4     │     5    │
 ├─────────────────────────────────────────────────────────────────────────────────────┼─────────────┼─────────┼──────────┼──────────┤
.]h
.Fields
 frName
 frEd
 frKol
 frSrok
.endFields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│             │@@@@@@@@@│&&&&&&&&&&│&&&&&&&&&&│
.[f
.begin
  PrintObr := False;
  PrintBrk := True;
  Counter1 := Counter1 + 1;
end.
 └─────────────────────────────────────────────────────────────────────────────────────┴─────────────┴─────────┴──────────┴──────────┘

.begin
  Nom_Utv := 0;
end.
.{While (Nom_Utv < Kol_Utv)
.begin
  Nom_Utv := Nom_Utv + 1;
end.
.fields
  if (Nom_Utv = 1, 'СОГЛАСОВАНО', '')
  Utv_Post[Nom_Utv]
  Utv_FIO[Nom_Utv]
.endfields
  Б@@@@@@@@@@@ Б  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@ Д   ____________________     Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                     должность                   подпись                        фамилия, инициалы
.}
.]f
.}
.fields
  'true' : 's'
.endfields
.{?Internal;(PrintBrk)
^
.}
.begin
  PrintBrk := False;
end.
.{ spcCircle checkenter
.[h
.{?INTERNAL;PrintBrk // На всех страницах, кроме первой

.}
 ┌─────────────────────────────────────────────────────────────────────────────────────┬─────────────┬─────────┬──────────┬──────────┐
 │                                                                                     │  Основание  │         │          │          │
 │                            Наименование спецодежды, спецобуви,                      │ (ссылка на  │ Единица │Количество│Срок носки│
 │                             предохранительных приспособлений                        │ нормативный │измерения│          │          │
 │                                                                                     │  документ)  │         │          │          │
 ├─────────────────────────────────────────────────────────────────────────────────────┼─────────────┼─────────┼──────────┼──────────┤
 │                                          1                                          │      2      │    3    │    4     │     5    │
 ├─────────────────────────────────────────────────────────────────────────────────────┼─────────────┼─────────┼──────────┼──────────┤
.]h
.Fields
 spName
 spEd
 spKol
 spSrok
.endFields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│             │@@@@@@@@@│&&&&&&&&&&│&&&&&&&&&&│
.[f
.begin
  PrintObr := False;
  PrintBrk := True;
  Counter1 := Counter1 + 1;
end.
 └─────────────────────────────────────────────────────────────────────────────────────┴─────────────┴─────────┴──────────┴──────────┘

.begin
  Nom_Utv := 0;
end.
.{While (Nom_Utv < Kol_Utv)
.begin
  Nom_Utv := Nom_Utv + 1;
end.
.fields
  if (Nom_Utv = 1, 'СОГЛАСОВАНО', '')
  Utv_Post[Nom_Utv]
  Utv_FIO[Nom_Utv]
.endfields
  Б@@@@@@@@@@@ Б  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@ Д   ____________________     Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                     должность                   подпись                        фамилия, инициалы
.}
.]f
.}
.{?INTERNAL;PrintObr
.begin
  PrintBrk := True;
  Counter1 := 1;
end.
 ┌─────────────────────────────────────────────────────────────────────────────────────┬─────────────┬─────────┬──────────┬──────────┐
 │                                                                                     │  Основание  │         │          │          │
 │                            Наименование спецодежды, спецобуви,                      │ (ссылка на  │ Единица │Количество│Срок носки│
 │                             предохранительных приспособлений                        │ нормативный │измерения│          │          │
 │                                                                                     │  документ)  │         │          │          │
 ├─────────────────────────────────────────────────────────────────────────────────────┼─────────────┼─────────┼──────────┼──────────┤
 │                                          1                                          │      2      │    3    │    4     │     5    │
 ├─────────────────────────────────────────────────────────────────────────────────────┼─────────────┼─────────┼──────────┼──────────┤
 └─────────────────────────────────────────────────────────────────────────────────────┴─────────────┴─────────┴──────────┴──────────┘

.begin
  Nom_Utv := 0;
end.
.{While (Nom_Utv < Kol_Utv)
.begin
  Nom_Utv := Nom_Utv + 1;
end.
.fields
  if (Nom_Utv = 1, 'СОГЛАСОВАНО', '')
  Utv_Post[Nom_Utv]
  Utv_FIO[Nom_Utv]
.endfields
  Б@@@@@@@@@@@ Б  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@ Д   ____________________     Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                     должность                   подпись                        фамилия, инициалы
.}
.}
.fields
 'true' : 's'
.endfields
.{?Internal;(PrintBrk)
^
.}
.begin
  PrintObr := False;
  Counter2 := 0; // Отследить начало следующей таблицы
end.
.{
.[h
.{?INTERNAL;(Counter2 > 0) // На всех страницах, кроме первой

.}
.{?INTERNAL;((Counter1 mod 2) = 0) // На четных страницах
                                                                                                        Оборотная сторона формы М-37п
.}
.{?INTERNAL;(((Counter1 mod 2) > 0) or (Counter2 = 0)) // На НЕчетных и в начале таблицы
  БВыдача и возврат форменной и спецодежды, спецобуви и предохранительных приспособлений Б
 ┌──────────────────┬──────────┬───────────────────────────────────────────────────┬─────────────────────────────────────────────────┐
 │   Наименование   │    Код   │                      Выдано                       │                   Возвращено                    │
 │    спецодежды,   │(номенкла-├──────────┬──────┬────────┬─────────────┬──────────┼──────────┬──────┬────────┬──────────────────────┤
 │    спецобуви,    │  турный  │          │      │        │             │ подпись  │          │      │        │       подпись        │
 │предохранительных │  номер)  │   дата   │ коли-│процент │  стоимость, │  лица в  │   дата   │ коли-│процент ├──────────┬───────────┤
 │ приспособлений   │          │          │чество│годности│     руб.    │получении │          │чество│годности│работника │кладовщика │
 │                  │          │          │      │        │             │          │          │      │        │о возврате│в получении│
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼──────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │         1        │     2    │     3    │   4  │    5   │      6      │    7     │     8    │   9  │   10   │    11    │     12    │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼──────────┼──────────┼──────┼────────┼──────────┼───────────┤
.}
.{?INTERNAL;(((Counter1 mod 2) = 0) and ((Counter2 > 0))) // На четных, но не в начале таблицы
 ┌──────────────────┬──────────┬──────────┬──────┬────────┬─────────────┬──────────┬──────────┬──────┬────────┬──────────┬───────────┐
 │         1        │     2    │     3    │   4  │    5   │      6      │    7     │     8    │   9  │   10   │    11    │     12    │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼──────────┼──────────┼──────┼────────┼──────────┼───────────┤
.}
.]h
.Fields
  sfName
  sfKod
  if (Longint(sfGive) = 0, '', DateToStr(sfGive, 'DD/MM/YYYY'))
  sfGiveKol
  sfPercGodnIn
  sfGiveKol*sfPrice
  GivDoc
  if (Longint(sfSpis) = 0, '', DateToStr(sfSpis, 'DD/MM/YYYY'))
  sfSpisKol
  sfPercGodnOut
  OutDoc
.endFields
.begin
  totSum := totSum + (sfGiveKol * sfPrice - sfSpisKol * sfSpisPrice);
end.
 │@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@~@@@@@@@@│&#&&&&│&#&&&.&&│&#&&&&&&&&.&&│@@@@@@@@@@│@@~@@@@@@@│&#&&&&│&#&&&.&&│@@@@@@@@@@│           │
.[f1
.begin
  PrintObr := True;
  Counter1 := Counter1 + 1;
  Counter2 := Counter2 + 1;
end.
 └──────────────────┴──────────┴──────────┴──────┴────────┴─────────────┴──────────┴──────────┴──────┴────────┴──────────┴───────────┘
.]f
.[f2
.begin
  PrintObr := False;
  Counter1 := Counter1 + 1;
  Counter2 := Counter2 + 1;
end.
 └──────────────────┴──────────┴──────────┴──────┴────────┴─────────────┴──────────┴──────────┴──────┴────────┴──────────┴───────────┘
.fields
  sSostav
  sBuh
.endfields

  БКарточку оформил кладовщик Б __________________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     подпись                           фамилия, инициалы
  БПроверил бухгалтер Б         __________________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     подпись                           фамилия, инициалы
.]f
.}
.{?INTERNAL;PrintObr
.fields
  'true' : 's'
  sSostav
  sBuh
.endfields
^
                                                                                                        Оборотная сторона формы М-37п
  БВыдача и возврат форменной и спецодежды, спецобуви и предохранительных приспособлений Б
 ┌──────────────────┬──────────┬───────────────────────────────────────────────────┬─────────────────────────────────────────────────┐
 │   Наименование   │    Код   │                      Выдано                       │                   Возвращено                    │
 │    спецодежды,   │(номенкла-├──────────┬──────┬────────┬─────────────┬──────────┼──────────┬──────┬────────┬──────────────────────┤
 │    спецобуви,    │  турный  │          │      │        │             │ подпись  │          │      │        │       подпись        │
 │предохранительных │  номер)  │   дата   │ коли-│процент │  стоимость, │  лица в  │   дата   │ коли-│процент ├──────────┬───────────┤
 │ приспособлений   │          │          │чество│годности│     руб.    │получении │          │чество│годности│работника │кладовщика │
 │                  │          │          │      │        │             │          │          │      │        │о возврате│в получении│
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼──────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │         1        │     2    │     3    │   4  │    5   │      6      │    7     │     8    │   9  │   10   │    11    │     12    │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼──────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │          │          │      │        │          │           │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼──────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │          │          │      │        │          │           │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼──────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │          │          │      │        │          │           │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼──────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │          │          │      │        │          │           │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼──────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │          │          │      │        │          │           │
 └──────────────────┴──────────┴──────────┴──────┴────────┴─────────────┴──────────┴──────────┴──────┴────────┴──────────┴───────────┘

  БКарточку оформил кладовщик Б __________________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     подпись                           фамилия, инициалы
  БПроверил бухгалтер Б         __________________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     подпись                           фамилия, инициалы
.} Р
.fields
  'true' : 's'
.endfields
^
.}
.endForm

!===================================================================================================
.LinkFORM PersCard_MB_3 Prototype Is PersCardProt
.Group 'Личные карточки учета СФО'
.NameInList 'Личная карточка учета выдачи СИЗ'
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  Array_Of_Norms1 : array [1..50] of string;
  Array_Of_Norms2 : array [1..50] of string;
  Array_Of_Norms3 : array [1..50] of string;
  Array_Of_Norms4 : array [1..50] of string;
  Count_Of_Array : integer;
  Number_Of_Array : integer;
  iFeeSigners : FeeSigners;
  sDirect : string;
.endvar
.function GetNameFromFIO(sFIO : string; wNumName : word) : string;
var
  tmpFIO : string;
  posFIO : byte;
begin
  GetNameFromFIO := '';
  sFIO := Trim(sFIO);

  case (wNumName) of
  //----------------
    1 : // Фамилия
    {
      posFIO := Pos(' ', sFIO);
      GetNameFromFIO := SubStr(sFIO, 1, if(posFIO = 0, Length(sFIO), posFIO));
    }
  //----------------
    2 : // Имя
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        GetNameFromFIO := SubStr(tmpFIO, 1, Pos(' ', tmpFIO));
      }
    }
  //----------------
    3 : // Отчество
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        posFIO := Pos(' ', tmpFIO);

        if (posFIO = 0) // задана только фамилия и имя
          GetNameFromFIO := '';
        else
        {
          tmpFIO := Trim(SubStr(tmpFIO, Pos(' ', tmpFIO) + 1, Length(tmpFio)));
          GetNameFromFIO := SubStr(tmpFIO, 1, Length(tmpFIO));
        }
      }
    }
  //----------------
  end;
end.
.function YearEdIzmWord(YearNumberInMonth : double) : string;
var
  ModYearNumber : integer;
  tmpDouble : double;
begin
  YearEdIzmWord := '';
  ModYearNumber := Integer(YearNumberInMonth) mod 12;

  if (ModYearNumber <> 0) // дробное число
    YearEdIzmWord := String(YearNumberInMonth / 12) + ' года';
  else                    // целое число
  {
    ModYearNumber := Integer(YearNumberInMonth / 12);

    if (length(string(ModYearNumber)) > 1)
    {
      tmpDouble := integer(SubStr(string(ModYearNumber), length(string(ModYearNumber)) - 1, 2));

      if (tmpDouble > 9)
        if (tmpDouble >= 11) and (tmpDouble <= 19)
          YearEdIzmWord := 'лет';
    }

    if (YearEdIzmWord = '')
    {
      tmpDouble := integer(SubStr(string(ModYearNumber), length(string(ModYearNumber)), 1));

      if ((tmpDouble >= 5) and (tmpDouble <= 9)) or (tmpDouble = 0)
        YearEdIzmWord := 'лет';
      else
      {
        if (tmpDouble >= 2) and (tmpDouble <= 4)
          YearEdIzmWord := 'года';
        else
          YearEdIzmWord := 'год';
      }
    }

    YearEdIzmWord := String(ModYearNumber) + ' ' + YearEdIzmWord;
  }
end.
.function GetStrSrok(strSrok : string) : string;
begin
  GetStrSrok := '';

  if (Double(strSrok) = 12)
    Exit;

  if (UpCase(strSrok) = 'РАЗОВАЯ') or (UpCase(strSrok) = 'ДО ИЗНОСА')
    GetStrSrok := ' ' + LoCase(strSrok);
  else
    GetStrSrok := ' на ' + YearEdIzmWord(Double(strSrok));
end.
.begin
  for(Count_Of_Array := 1; Count_Of_Array <= Count(Array_Of_Norms1); Count_Of_Array := Count_Of_Array + 1)
  {
    Array_Of_Norms1[Count_Of_Array] := '';
    Array_Of_Norms2[Count_Of_Array] := '';
    Array_Of_Norms3[Count_Of_Array] := '';
    Array_Of_Norms4[Count_Of_Array] := '';
  }

  Number_Of_Array := 0;
  Count_Of_Array := 0;

  // Руководитель подразделения
  sDirect := '';
  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Директор'))
      sDirect := iFeeSigners.GetSignerFIO(7);

    iFeeSigners.ClearRestriction;
  }
end.
.{
.Fields
  CommonFormHeader
  CardNo
  GetNameFromFIO(FIO, 1)
  Pol
  GetNameFromFIO(FIO, 2)
  GetNameFromFIO(FIO, 3)
  Rost
  TabN
  Cex
  Od1
  Prof
  Ob
  if (Longint(InDate) = 0, '', DateToStr(InDate, 'DD/MM/YYYY'))
  GUb
  GMask
  Respir
  if (Longint(chDate) = 0, '', DateToStr(chDate, 'DD/MM/YYYY'))
  Rukav
  Perch
  sGetTune('Fin.SFO.NameOfTypeNorm')
.endFields
 Ш^
.{?internal;wGetTune('Country') = ccRus;
                                                                                                                                               Приложение
                                                                                                                     к Межотраслевым правилам обеспечения
                                                                                                              работников специальной одеждой, специальной
                                                                                                               обувью и другими средствами индивидуальной
                                                                                                                            защиты, утвержденным приказом
                                                                                                                           Министерства здравоохранения и
                                                                                                                                  социального развития РФ
                                                                                                                                 от 1 июня 2009 г. № 290н
.}
                                               БЛИЧНАЯ КАРТОЧКА №  Д@~@@@@@@@@ Е
                                        Бучета выдачи средств индивидуальной защиты Б

  Фамилия  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Пол  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Имя  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Отчество  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Рост  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Табельный номер  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Размер:
  Структурное подразделение  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  одежды  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Профессия (должность)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  обуви  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Дата поступления на работу  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  головного убора  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Дата изменения профессии (должности)                                          противогаза  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  или перевода в другое структурное                                             респиратора  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  подразделение  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  рукавиц  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                                перчаток  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д

  Предусмотрена выдача:  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                (Наименование типовых (типовых отраслевых) норм)

.{ frmCircle checkenter
.begin
  if (frIsSIZ)
  {
    Count_Of_Array := Count_Of_Array + 1;
    Array_Of_Norms1[Count_Of_Array] := frName;
    Array_Of_Norms2[Count_Of_Array] := frEd;
    Array_Of_Norms3[Count_Of_Array] := frKol + GetStrSrok(Trim(frSrok));
    Array_Of_Norms4[Count_Of_Array] := frPar;
  }
end.
.}
.{ spcCircle checkenter
.begin
  if (spIsSIZ)
  {
    Count_Of_Array := Count_Of_Array + 1;
    Array_Of_Norms1[Count_Of_Array] := spName;
    Array_Of_Norms2[Count_Of_Array] := spEd;
    Array_Of_Norms3[Count_Of_Array] := spKol + GetStrSrok(Trim(spSrok));
    Array_Of_Norms4[Count_Of_Array] := spPar;
  }
end.
.}
.{ while Number_Of_Array < Count_Of_Array
.[h
┌────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────┬─────────────────┬──────────────────────┐
│                               Наименование средств                                 │      Пункт типовых      │     Единица     │      Количество      │
│                              индивидуальной защиты                                 │          норм           │    измерения    │        на год        │
├────────────────────────────────────────────────────────────────────────────────────┼─────────────────────────┼─────────────────┼──────────────────────┤
.]h
.begin
  Number_Of_Array := Number_Of_Array + 1;
end.
.Fields
  Array_Of_Norms1[Number_Of_Array]
  Array_Of_Norms4[Number_Of_Array]
  Array_Of_Norms2[Number_Of_Array]
  Array_Of_Norms3[Number_Of_Array]
  sDirect
  'true' : 's'
.endFields
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&&&&&&&&&&│
.[f
└────────────────────────────────────────────────────────────────────────────────────┴─────────────────────────┴─────────────────┴──────────────────────┘
.]f
.}
.{?Internal;(Count_Of_Array <= 0);
┌────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────┬─────────────────┬──────────────────────┐
│                               Наименование средств                                 │      Пункт типовых      │     Единица     │      Количество      │
│                              индивидуальной защиты                                 │          норм           │    измерения    │        на год        │
├────────────────────────────────────────────────────────────────────────────────────┼─────────────────────────┼─────────────────┼──────────────────────┤
└────────────────────────────────────────────────────────────────────────────────────┴─────────────────────────┴─────────────────┴──────────────────────┘
.}

  Руководитель структурного подразделения  _________________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                   (подпись)                          (Фамилия, инициалы)

^
.{
.[h
┌────────────────────────────────────────┬────────────┬──────────────────────────────────────────┬──────────────────────────────────────────────────────┐
│                                        │  № серти-  │                  Выдано                  │                      Возвращено                      │
│            Наименование СИЗ            │ фиката или ├──────────┬──────────┬──────┬─────────────┼──────────┬──────────┬──────┬────────────┬────────────┤
│                                        │ декларации │   дата   │   коли-  │  %   │ подпись по- │   дата   │   коли-  │  %   │  подпись   │подпись при-│
│                                        │соответствия│          │  чество  │износа│лучившего СИЗ│          │  чество  │износа│сдавшего СИЗ│нявшего СИЗ │
├────────────────────────────────────────┼────────────┼──────────┼──────────┼──────┼─────────────┼──────────┼──────────┼──────┼────────────┼────────────┤
│                   1                    │     2      │    3     │    4     │  5   │      6      │    7     │    8     │  9   │     10     │     11     │
├────────────────────────────────────────┼────────────┼──────────┼──────────┼──────┼─────────────┼──────────┼──────────┼──────┼────────────┼────────────┤
.]h
.Fields
  sfName
  NSertif
  if (Longint(sfGive) = 0, '', DateToStr(sfGive, 'DD/MM/YYYY'))
  sfGiveKol
  if (Longint(sfGive) = 0, 0.0, 100 - sfPercGodnIn)
  GivDoc
  if (Longint(sfSpis) = 0, '', DateToStr(sfSpis, 'DD/MM/YYYY'))
  sfSpisKol
  if (Longint(sfSpis) = 0, 0.0, 100 - sfPercGodnOut)
  OutDoc
.endFields
.{?Internal;(sfIsSIZ);
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│@~@@@@@@@@│&#&&&&&&&&│&#&.&&│@@@@@@@@@@@@@│@~@@@@@@@@│&#&&&&&&&&│&#&.&&│@@@@@@@@@@@@│            │
.}
.[f
└────────────────────────────────────────┴────────────┴──────────┴──────────┴──────┴─────────────┴──────────┴──────────┴──────┴────────────┴────────────┘
.]f
.} Ш

.}
.endForm

!===================================================================================================
.LinkFORM 'PersCard_MB_4' Prototype Is 'PersCardProt'
.Group 'Синхронизация с лицевыми счетами'
.NameInList 'Список Личных карточек с измененными параметрами'
.{
.Fields
  CommonFormHeader
.endFields
^

                     ЛИЧНЫЕ КАРТОЧКИ УЧЕТА спецоснастки/СФО
                           с измененными параметрами

.{ frmCircle checkenter
.[h
  ┌────────────┬────────────────┬──────────────────────────┬──────────────────────────┐
  │    Дата    │    Название    │         Значение         │          Новое           │
  │ изменения  │    параметра   │    в Личной карточке     │         значение         │
  └────────────┴────────────────┴──────────────────────────┴──────────────────────────┘
.]h
.Fields
  frName
  frKod
  frEd
  frKod
  frEd
  frMark
  frPar
  frKol
  frSrok
.endFields
.{?Internal;(frIsSIZ);
    БЛК учета №^: ^, ^ Б
.}
.{?Internal;(frIsSOS);
    БСотрудник: ^, ^ Б
.}
    @@@@@@@@@@  @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@
.[f
  ─────────────────────────────────────────────────────────────────────────────────────
.]f
.}
.{ spcCircle checkenter
.}
.{
.}
.}
.endForm

!===================================================================================================
.LinkFORM PersCard_MB_5 Prototype Is PersCardProt
.Group 'Личные карточки учета СФО (Беларусь)'
.NameInList 'Личная карточка учета выдачи СИЗ'
.P 80
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  Array_Of_Norms1 : array [1..50] of string;
  Array_Of_Norms2 : array [1..50] of string;
  Array_Of_Norms3 : array [1..50] of string;
  Array_Of_Norms4 : array [1..50] of string;
  Array_Of_Norms5 : array [1..50] of string;
  Count_Of_Array : integer;
  Number_Of_Array : integer;
  iFeeSigners : FeeSigners;
  sBuh, sDirect, sMOL : string;
.endvar
.function GetNameFromFIO(sFIO : string; wNumName : word) : string;
var
  tmpFIO : string;
  posFIO : byte;
begin
  GetNameFromFIO := '';
  sFIO := Trim(sFIO);

  case (wNumName) of
  //----------------
    1 : // Фамилия
    {
      posFIO := Pos(' ', sFIO);
      GetNameFromFIO := SubStr(sFIO, 1, if(posFIO = 0, Length(sFIO), posFIO));
    }
  //----------------
    2 : // Имя
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        GetNameFromFIO := SubStr(tmpFIO, 1, Pos(' ', tmpFIO));
      }
    }
  //----------------
    3 : // Отчество
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        posFIO := Pos(' ', tmpFIO);

        if (posFIO = 0) // задана только фамилия и имя
          GetNameFromFIO := '';
        else
        {
          tmpFIO := Trim(SubStr(tmpFIO, Pos(' ', tmpFIO) + 1, Length(tmpFio)));
          GetNameFromFIO := SubStr(tmpFIO, 1, Length(tmpFIO));
        }
      }
    }
  //----------------
  end;
end.
.begin
  for(Count_Of_Array := 1; Count_Of_Array <= Count(Array_Of_Norms1); Count_Of_Array := Count_Of_Array + 1)
  {
    Array_Of_Norms1[Count_Of_Array] := '';
    Array_Of_Norms2[Count_Of_Array] := '';
    Array_Of_Norms3[Count_Of_Array] := '';
    Array_Of_Norms4[Count_Of_Array] := '';
    Array_Of_Norms5[Count_Of_Array] := '';
  }

  Number_Of_Array := 0;
  Count_Of_Array := 0;

  // Бухгалтер, руководитель, ответственный
  sBuh := sDirect := sMOL := '';
  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Бухгалтер'))
      sBuh := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Директор'))
      sDirect := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Ответственный'))
      sMOL := iFeeSigners.GetSignerFIO(7);

    iFeeSigners.ClearRestriction;
  }
end.
.{
.Fields
  CommonFormHeader
  OrgName
  CardNo
  GetNameFromFIO(FIO, 1)
  Pol
  GetNameFromFIO(FIO, 2)
  GetNameFromFIO(FIO, 3)
  Rost
  TabN
  Cex
  Od1
  Prof
  Ob
  GUb
  GMask
  Respir
  if (Longint(InDate) = 0, '', DateToStr(InDate, 'DD/MM/YYYY'))
  Rukav
  if (Longint(chDate) = 0, '', DateToStr(chDate, 'DD/MM/YYYY'))
  Perch
.endFields
 Ш^
                                                                                                                                                 Приложение 2
                                                                                                                к Инструкции о порядке обеспечения работников
                                                                                                                             средствами индивидуальной защиты

  Организация (предприятие)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д

                                                 БЛИЧНАЯ КАРТОЧКА №  Д@@@@@@@@@@ Е
                                             Бучета средств индивидуальной защиты Б

                                                   Сведения о работнике

  Фамилия  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Пол  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Собственное имя  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Отчество (если таковое имеется)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Рост  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Табельный номер  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Размер:
  Структурное подразделение  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  одежды  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Профессия (должность)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  обуви  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Код профессии (должности) по                                                                                             головного убора  Д@@@@@@@@@@@@@@@@@@ Д
  Общегосударственному классификатору Республики Беларусь                                                                  противогаза  Д@@@@@@@@@@@@@@@@@@@@@@ Д
  "Профессии рабочих и должности служащих" ______________________________________________________________________________  респиратора  Д@@@@@@@@@@@@@@@@@@@@@@ Д
  Дата поступления на работу  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  рукавиц  Д@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Дата изменения профессии (должности)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  перчаток  Д@@@@@@@@@@@@@@@@@@@@@@@@@ Д

  Предусмотрено по установленным нормам:
.{ frmCircle checkenter
.begin
  if (frIsSIZ)
  {
    Count_Of_Array := Count_Of_Array + 1;
    Array_Of_Norms1[Count_Of_Array] := frName;
    Array_Of_Norms2[Count_Of_Array] := frMark;
    Array_Of_Norms3[Count_Of_Array] := frEd;
    Array_Of_Norms4[Count_Of_Array] := frKol;
    Array_Of_Norms5[Count_Of_Array] := frSrok;
  }
end.
.}
.{ spcCircle checkenter
.begin
  if (spIsSIZ)
  {
    Count_Of_Array := Count_Of_Array + 1;
    Array_Of_Norms1[Count_Of_Array] := spName;
    Array_Of_Norms2[Count_Of_Array] := spMark;
    Array_Of_Norms3[Count_Of_Array] := spEd;
    Array_Of_Norms4[Count_Of_Array] := spKol;
    Array_Of_Norms5[Count_Of_Array] := spSrok;
  }
end.
.}
.{ while Number_Of_Array < Count_Of_Array
.[h
┌─────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────┬─────────────────┬────────────┬────────────┐
│                                                                                 │ Классификация (маркировка)  │                 │            │            │
│                       Наименование средств индивидуальной                       │средств индивидуальной защиты│     Единица     │ Количество │ Срок носки │
│                                     защиты                                      │  по защитным свойствам или  │    измерения    │            │            │
│                                                                                 │ конструктивным особенностям │                 │            │            │
├─────────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                        1                                        │              2              │        3        │     4      │     5      │
├─────────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
.]h
.begin
  Number_Of_Array := Number_Of_Array + 1;
end.
.Fields
  Array_Of_Norms1[Number_Of_Array]
  Array_Of_Norms2[Number_Of_Array]
  Array_Of_Norms3[Number_Of_Array]
  Array_Of_Norms4[Number_Of_Array]
  Array_Of_Norms5[Number_Of_Array]
  sBuh
  sDirect
  sMOL
  GetNameFromFIO(FIO, 1) + if (GetNameFromFIO(FIO, 2) = '', '', SubStr(GetNameFromFIO(FIO, 2), 1, 1) + '. ' + if (GetNameFromFIO(FIO, 3) = '', '', SubStr(GetNameFromFIO(FIO, 3), 1, 1) + '.'))
  'true' : 's'
.endFields
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&│&&&&&&&&&&&&│
.[f
└─────────────────────────────────────────────────────────────────────────────────┴─────────────────────────────┴─────────────────┴────────────┴────────────┘
.]f
.}
.{?Internal;(Count_Of_Array <= 0);
┌─────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────┬─────────────────┬────────────┬────────────┐
│                                                                                 │ Классификация (маркировка)  │                 │            │            │
│                       Наименование средств индивидуальной                       │средств индивидуальной защиты│     Единица     │ Количество │ Срок носки │
│                                     защиты                                      │  по защитным свойствам или  │    измерения    │            │            │
│                                                                                 │ конструктивным особенностям │                 │            │            │
├─────────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                        1                                        │              2              │        3        │     4      │     5      │
├─────────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                                                                 │                             │                 │            │            │
├─────────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                                                                 │                             │                 │            │            │
├─────────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                                                                 │                             │                 │            │            │
├─────────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                                                                 │                             │                 │            │            │
└─────────────────────────────────────────────────────────────────────────────────┴─────────────────────────────┴─────────────────┴────────────┴────────────┘
.}

  Главный бухгалтер (бухгалтер)                               Д&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Д
                                                                          (личная подпись, дата, расшифровка подписи)
  Согласовано:
  специалист отдела кадров                                   _____________________________________________________________________
                                                                          (личная подпись, дата, расшифровка подписи)
  руководитель структурного подразделения                     Д&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Д
                                                                          (личная подпись, дата, расшифровка подписи)
  специалист по охране труда                                 _____________________________________________________________________

  ответственное лицо за выдачу средств индивидуальной защиты  Д&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Д
                                                                          (личная подпись, дата, расшифровка подписи)
  Ознакомлен:
  работник                                                    Д&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Д
                                                                          (личная подпись, дата, расшифровка подписи)
^
.{
.[h
                                                                                                                            Оборотная сторона личной карточки
┌──────────────────────────────────┬───────────────┬───────────────────────────────────────────────┬────────────────────────────────────────────────────────┐
│                                  │ Классификация │                    Выдано                     │                       Возвращено                       │
│                                  │ (маркировка)  ├──────────┬──────┬──────┬───────────┬──────────┼──────────┬──────┬──────┬───────────┬──────────┬────────┤
│        Наименование средств      │средств индиви-│          │      │      │           │          │          │      │      │           │          │        │
│          индивидуальной          │дуальной защиты│          │      │      │           │ Расписка │          │      │      │           │          │Расписка│
│              защиты              │  по защитным  │   Дата   │Кол-во│  %   │ Стоимость │ работни- │   Дата   │Кол-во│  %   │ Стоимость │ Расписка │кладов- │
│                                  │ свойствам или │          │      │износа│           │ ка в по- │          │      │износа│           │ сдавшего │щика в  │
│                                  │конструктивным │          │      │      │           │ лучении  │          │      │      │           │          │приемке │
│                                  │ особенностям  │          │      │      │           │          │          │      │      │           │          │        │
├──────────────────────────────────┼───────────────┼──────────┼──────┼──────┼───────────┼──────────┼──────────┼──────┼──────┼───────────┼──────────┼────────┤
│                1                 │       2       │    3     │  4   │  5   │     6     │    7     │    8     │  9   │  10  │    11     │    12    │   13   │
├──────────────────────────────────┼───────────────┼──────────┼──────┼──────┼───────────┼──────────┼──────────┼──────┼──────┼───────────┼──────────┼────────┤
.]h
.Fields
  sfName
  sfMark
  if (Longint(sfGive) = 0, '', DateToStr(sfGive, 'DD/MM/YYYY'))
  sfGiveKol
  if (Longint(sfGive) = 0, 0.0, 100 - sfPercGodnIn)
  sfPrice * sfGiveKol
  GivDoc
  if (Longint(sfSpis) = 0, '', DateToStr(sfSpis, 'DD/MM/YYYY'))
  sfSpisKol
  if (Longint(sfSpis) = 0, 0.0, 100 - sfPercGodnOut)
  sfSpisPrice * sfSpisKol
  OutDoc
.endFields
.{?Internal;(sfIsSIZ);
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@│@~@@@@@@@@│&#&&&&│&#&.&&│&#&&&&&&.&&│@@@@@@@@@@│@~@@@@@@@@│&#&&&&│&#&.&&│&#&&&&&&.&&│@@@@@@@@@@│        │
.}
.[f
└──────────────────────────────────┴───────────────┴──────────┴──────┴──────┴───────────┴──────────┴──────────┴──────┴──────┴───────────┴──────────┴────────┘
.]f
.} Ш
.fields
  'true' : 's'
.endfields
^
.}
.endForm

!===================================================================================================
.LinkFORM PersCard_MB_6 Prototype Is PersCardProt
.Group 'Личные карточки учета СФО'
.NameInList 'Личная карточка учета смывающих и обезвреживающих средств'
.P 80
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  Array_Of_Norms1 : array [1..50] of string;
  Array_Of_Norms2 : array [1..50] of string;
  Array_Of_Norms3 : array [1..50] of string;
  Array_Of_Norms4 : array [1..50] of string;
  Count_Of_Array : integer;
  Number_Of_Array : integer;
  iFeeSigners : FeeSigners;
  sDirect : string;
.endvar
.function GetNameFromFIO(sFIO : string; wNumName : word) : string;
var
  tmpFIO : string;
  posFIO : byte;
begin
  GetNameFromFIO := '';
  sFIO := Trim(sFIO);

  case (wNumName) of
  //----------------
    1 : // Фамилия
    {
      posFIO := Pos(' ', sFIO);
      GetNameFromFIO := SubStr(sFIO, 1, if(posFIO = 0, Length(sFIO), posFIO));
    }
  //----------------
    2 : // Имя
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        GetNameFromFIO := SubStr(tmpFIO, 1, Pos(' ', tmpFIO));
      }
    }
  //----------------
    3 : // Отчество
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        posFIO := Pos(' ', tmpFIO);

        if (posFIO = 0) // задана только фамилия и имя
          GetNameFromFIO := '';
        else
        {
          tmpFIO := Trim(SubStr(tmpFIO, Pos(' ', tmpFIO) + 1, Length(tmpFio)));
          GetNameFromFIO := SubStr(tmpFIO, 1, Length(tmpFIO));
        }
      }
    }
  //----------------
  end;
end.
.function YearEdIzmWord(YearNumberInMonth : double) : string;
var
  ModYearNumber : integer;
  tmpDouble : double;
begin
  YearEdIzmWord := '';
  ModYearNumber := Integer(YearNumberInMonth) mod 12;

  if (ModYearNumber <> 0) // дробное число
    YearEdIzmWord := String(YearNumberInMonth / 12) + ' года';
  else                    // целое число
  {
    ModYearNumber := Integer(YearNumberInMonth / 12);

    if (length(string(ModYearNumber)) > 1)
    {
      tmpDouble := integer(SubStr(string(ModYearNumber), length(string(ModYearNumber)) - 1, 2));

      if (tmpDouble > 9)
        if (tmpDouble >= 11) and (tmpDouble <= 19)
          YearEdIzmWord := 'лет';
    }

    if (YearEdIzmWord = '')
    {
      tmpDouble := integer(SubStr(string(ModYearNumber), length(string(ModYearNumber)), 1));

      if ((tmpDouble >= 5) and (tmpDouble <= 9)) or (tmpDouble = 0)
        YearEdIzmWord := 'лет';
      else
      {
        if (tmpDouble >= 2) and (tmpDouble <= 4)
          YearEdIzmWord := 'года';
        else
          YearEdIzmWord := 'год';
      }
    }

    YearEdIzmWord := String(ModYearNumber) + ' ' + YearEdIzmWord;
  }
end.
.function GetStrSrok(strSrok : string) : string;
begin
  GetStrSrok := '';

  if (Double(strSrok) = 12)
    Exit;

  if (UpCase(strSrok) = 'РАЗОВАЯ') or (UpCase(strSrok) = 'ДО ИЗНОСА')
    GetStrSrok := ' ' + LoCase(strSrok);
  else
    GetStrSrok := ' на ' + YearEdIzmWord(Double(strSrok));
end.
.begin
  for(Count_Of_Array := 1; Count_Of_Array <= Count(Array_Of_Norms1); Count_Of_Array := Count_Of_Array + 1)
  {
    Array_Of_Norms1[Count_Of_Array] := '';
    Array_Of_Norms2[Count_Of_Array] := '';
    Array_Of_Norms3[Count_Of_Array] := '';
    Array_Of_Norms4[Count_Of_Array] := '';
  }

  Number_Of_Array := 0;
  Count_Of_Array := 0;

  // Руководитель подразделения
  sDirect := '';
  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Директор'))
      sDirect := iFeeSigners.GetSignerFIO(1);

    iFeeSigners.ClearRestriction;
  }
end.
.{
.Fields
  CommonFormHeader
  CardNo
  GetNameFromFIO(FIO, 1)
  GetNameFromFIO(FIO, 2)
  GetNameFromFIO(FIO, 3)
  TabN
  Cex
  Prof
  if (Longint(InDate) = 0, '', DateToStr(InDate, 'DD/MM/YYYY'))
  if (Longint(chDate) = 0, '', DateToStr(chDate, 'DD/MM/YYYY'))
.endFields
 Ш^
.{?internal;wGetTune('Country') = ccRus;
                                                                                                                                               Приложение
                                                                                                                           к стандарту безопасности труда
                                                                                                                                  "Обеспечение работников
                                                                                                                      смывающими и (или) обезвреживающими
                                                                                                                      средствами", утвержденному Приказом
                                                                                                                               Минздравсоцразвития России
                                                                                                                            от 17 декабря 2010 г. № 1122н
.}
                                               БЛИЧНАЯ КАРТОЧКА №  Д@~@@@@@@@@ Е
                                    БУЧЕТА ВЫДАЧИ СМЫВАЮЩИХ И (ИЛИ) ОБЕЗВРЕЖИВАЮЩИХ СРЕДСТВ Б

  Фамилия  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Имя  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Отчество (при наличии)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Табельный номер  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Структурное подразделение  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Профессия (должность)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Дата поступления на работу  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Дата изменения профессии (должности) или перевода в другое
  структурное подразделение  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д

  Предусмотрено типовыми нормами бесплатной выдачи работникам смывающих и (или) обезвреживающих средств:
.{ frmCircle checkenter
.begin
  if (frIsSOS)
  {
    Count_Of_Array := Count_Of_Array + 1;
    Array_Of_Norms1[Count_Of_Array] := frName;
    Array_Of_Norms2[Count_Of_Array] := frEd;
    Array_Of_Norms3[Count_Of_Array] := frKol + GetStrSrok(Trim(frSrok));
    Array_Of_Norms4[Count_Of_Array] := frPar;
  }
end.
.}
.{ spcCircle checkenter
.begin
  if (spIsSOS)
  {
    Count_Of_Array := Count_Of_Array + 1;
    Array_Of_Norms1[Count_Of_Array] := spName;
    Array_Of_Norms2[Count_Of_Array] := spEd;
    Array_Of_Norms3[Count_Of_Array] := spKol + GetStrSrok(Trim(spSrok));
    Array_Of_Norms4[Count_Of_Array] := spPar;
  }
end.
.}
.{ while Number_Of_Array < Count_Of_Array
.[h
┌─────────────────────────┬────────────────────────────────────────────────────────────────────────────────────┬─────────────────┬──────────────────────┐
│      Пункт типовых      │                              Вид смывающих и (или)                                 │     Единица     │      Количество      │
│          норм           │                             обезвреживающих средств                                │    измерения    │        на год        │
│                         │                                                                                    │     (г/мл)      │                      │
├─────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┼─────────────────┼──────────────────────┤
.]h
.begin
  Number_Of_Array := Number_Of_Array + 1;
end.
.Fields
  Array_Of_Norms4[Number_Of_Array]
  Array_Of_Norms1[Number_Of_Array]
  Array_Of_Norms2[Number_Of_Array]
  Array_Of_Norms3[Number_Of_Array]
  sDirect
  'true' : 's'
.endFields
│@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&&&&&&&&&&│
.[f
└─────────────────────────┴────────────────────────────────────────────────────────────────────────────────────┴─────────────────┴──────────────────────┘
.]f
.}
.{?Internal;(Count_Of_Array <= 0);
┌─────────────────────────┬────────────────────────────────────────────────────────────────────────────────────┬─────────────────┬──────────────────────┐
│      Пункт типовых      │                              Вид смывающих и (или)                                 │     Единица     │      Количество      │
│          норм           │                             обезвреживающих средств                                │    измерения    │        на год        │
│                         │                                                                                    │     (г/мл)      │                      │
├─────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┼─────────────────┼──────────────────────┤
└─────────────────────────┴────────────────────────────────────────────────────────────────────────────────────┴─────────────────┴──────────────────────┘
.}

  Руководитель структурного подразделения   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
^
.{
.[h
┌─────────────────────────────────────────────────────────────┬─────────────────────────┬───────────────────────────────────────────────────────────────┐
│                                                             │     Свидетельство о     │                             Выдано                            │
│                                                             │     государственной     ├──────────┬────────────┬─────────────────────┬─────────────────┤
│                    Вид смывающих и (или)                    │       регистрации,      │          │            │    способ выдачи    │     расписка    │
│                   обезвреживающих средств                   │        сертификат       │   дата   │ количество │   (индивидуально;   │        в        │
│                                                             │       соответствия      │          │   (г/мл)   │     посредством     │     получении   │
│                                                             │                         │          │            │ дозирующей системы) │                 │
├─────────────────────────────────────────────────────────────┼─────────────────────────┼──────────┼────────────┼─────────────────────┼─────────────────┤
.]h
.Fields
  sfName
  NSertif
  if (Longint(sfGive) = 0, '', DateToStr(sfGive, 'DD/MM/YYYY'))
  sfGiveKol
  GivDoc
  sDirect
.endFields
.{?Internal;(sfIsSOS);
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@@│&#&&&&&&&&&&│                     │@@@@@@@@@@@@@@@@@│
.}
.[f
└─────────────────────────────────────────────────────────────┴─────────────────────────┴──────────┴────────────┴─────────────────────┴─────────────────┘
.]f
.}

  Руководитель структурного подразделения   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Ш

.}
.endForm
