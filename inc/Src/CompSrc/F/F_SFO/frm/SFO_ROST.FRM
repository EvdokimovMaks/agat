//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецодежда
// Печать ростовочной ведомости
//------------------------------------------------------------------------------

#doc
Печать Ростовочной ведомости.<br>
#end
.Set name = 'SFO_RostVed'
.Hide
.Fields
  dFrom : Date
  dTo : Date
  Grouping : String
  isVacancyEnabled : String
  fltName : String
  Podr
  NomNum  SFOName  NormPer : double  UsePer : double  OutPer : double  NeedPer : double  DolgPer : double  OnStock : double  Sub : double
  Size Height Sex  NormPerS : double UsePerS : double OutPerS : double NeedPerS : double DolgPerS : double OnStockS : double SubS : double
.endfields
Начало периода ^
Конец периода  ^
Группировка ^
^ вакансий
.{ cirFiltRost CheckEnter // Установленные фильтры
  ^
.}
.{
Группа ^
.{
Код ^
Наименование ^
Количество по нормам на начало периода ^
В пользовании на начало периода ^
Выбывает к концу периода ^
Потребность на период ^
Задолженность на начало периода ^
Наличие на складах ^
Запас/нехватка ^
 по размеру/росту/полу:
.if SizesSFO
.{
  Размер ^
  Рост ^
  Пол ^
  Количество по нормам на начало периода ^
  В пользовании на начало периода ^
  Выбывает к концу периода ^
  Потребность на период ^
  Задолженность на начало периода ^
  Наличие на складах ^
  Запас/нехватка ^
.}
.end
.}
.}
.endform

! По выбранным подразделениям

.Linkform SFO_RostVed01 prototype is SFO_RostVed
.Nameinlist 'Ростовочная ведомость'
.Group 'Ростовочная ведомость по подразделениям'
.Fields
  CommonFormHeader
  DateToStr(dFrom, 'DD/MM/YYYY')
  DateToStr(dTo, 'DD/MM/YYYY')
  isVacancyEnabled
  fltName : 'T:-'
  Grouping
  Podr
  NomNum  SFOName  NormPer  UsePer  OutPer  NeedPer
  Size Height Sex  NormPerS UsePerS OutPerS NeedPerS
.endfields
 С ^
                                                  РОСТОВОЧНАЯ ВЕДОМОСТЬ
                                           на период с @~@@@@@@@@ по @~@@@@@@@@
                                               по специальной одежде, обуви
 ^
 Установленные фильтры: Б
.{ cirFiltRost CheckEnter
   ^
.}

  Б────────┬────────────────────────┬──────┬───────┬───┬─────────────────┬────────────────┬──────────────┬──────────────
   Код   │      Наименование      │Размер│ Рост  │Пол│К-во по нормам на│В пользовании на│  Выбывает к  │ Потребность
         │                        │      │       │   │     период      │ начало периода │ концу периода│  на период
 ────────┴────────────────────────┴──────┴───────┴───┴─────────────────┴────────────────┴──────────────┴────────────── Б
.{
 Б ^: ^ Б

.{
 @@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@                    &&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&& &&&&&&&&&&&&&&  Б&'&&&&&&&&&&&& Б
.if SizesSFO
                  Бв том числе: Б
.{
                                   @@@@@@ @@@@@@@  @  &&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&& &&&&&&&&&&&&&&  Б&'&&&&&&&&&&&& Б
.}

.end
.}
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.} Р
.endform

! По всему предприятию

.Linkform SFO_RostVed02 prototype is SFO_RostVed
.Nameinlist 'Ростовочная ведомость'
.Group 'Ростовочная ведомость по предприятию'
.Fields
  CommonFormHeader
  DateToStr(dFrom, 'DD/MM/YYYY')
  DateToStr(dTo, 'DD/MM/YYYY')
  isVacancyEnabled
  fltName : 'T:-'
  NomNum  SFOName  NormPer  UsePer  OutPer  NeedPer  OnStock  Abs(Sub)  if (Sub < 0, '(н)', '(з)')
  Size Height Sex  NormPerS UsePerS OutPerS NeedPerS OnStockS Abs(SubS) if (SubS < 0, '(н)', '(з)')
.endfields
 С ^
                                                    РОСТОВОЧНАЯ ВЕДОМОСТЬ
                                             на период с @~@@@@@@@@ по @~@@@@@@@@
                                                 по специальной одежде, обуви
 ^
 Установленные фильтры: Б
.{ cirFiltRost CheckEnter
   ^
.}
 И
  Б────────┬────────────────────────┬──────┬───────┬───┬─────────────────┬────────────────┬──────────────┬─────────────┬────────────┬────────────────
   Код   │      Наименование      │Размер│ Рост  │Пол│К-во по нормам на│В пользовании на│  Выбывает к  │ Потребность │  Наличие   │ Запас/нехватка
         │                        │      │       │   │     период      │ начало периода │ концу периода│  на период  │  на складе │
 ────────┴────────────────────────┴──────┴───────┴───┴─────────────────┴────────────────┴──────────────┴─────────────┴────────────┴──────────────── Б
.{
.{
 Б @@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ Б                    &&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&& &&&&&&&&&&&&&&  Б&'&&&&&&&&&&& &'&&&&&&&&&& &'&&&&&&&&&& @@@ Б
.if SizesSFO
                  Бв том числе: Б
.{
                                   @@@@@@ @@@@@@@  @  &&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&& &&&&&&&&&&&&&&  Б&'&&&&&&&&&&& &'&&&&&&&&&& &'&&&&&&&&&& @@@ Б
.}

.end
.}
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.} Ш
.endform

.Linkform SFO_RostVed03 prototype is SFO_RostVed
.Nameinlist 'Ростовочная ведомость'
.Group 'Ростовочная ведомость с задолженностью'
.Fields
  CommonFormHeader
  DateToStr(dFrom, 'DD/MM/YYYY')
  DateToStr(dTo, 'DD/MM/YYYY')
  isVacancyEnabled
  fltName : 'T:-'
  NomNum  SFOName  NormPer  UsePer  OutPer  NeedPer  DolgPer  OnStock  Abs(Sub)  if (Sub < 0, '(н)', '(з)')
  Size Height Sex  NormPerS UsePerS OutPerS NeedPerS DolgPerS OnStockS Abs(SubS) if (SubS < 0, '(н)', '(з)')
.endfields
 С ^
                                                    РОСТОВОЧНАЯ ВЕДОМОСТЬ
                                             на период с @~@@@@@@@@ по @~@@@@@@@@
                                                 по специальной одежде, обуви
 ^
 Установленные фильтры: Б
.{ cirFiltRost CheckEnter
   ^
.}
 И
  Б────────┬────────────────────────┬──────┬───────┬───┬──────────────┬───────────────┬─────────────┬─────────────┬────────────┬───────────┬────────────────
   Код   │      Наименование      │Размер│ Рост  │Пол│Кол. по нормам│ В пользовании │ Выбывает к  │ Потребность │Задолжен. на│  Наличие  │ Запас/нехватка
         │                        │      │       │   │  на период   │на нач. периода│концу периода│  на период  │нач. периода│ на складе │
 ────────┴────────────────────────┴──────┴───────┴───┴──────────────┴───────────────┴─────────────┴─────────────┴────────────┴───────────┴──────────────── Б
.{
.{
 Б @@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ Б                    &&&&&&&&&&&&&& &&&&&&&&&&&&&&& &&&&&&&&&&&&&  Б&'&&&&&&&&&&& &'&&&&&&&&&& &'&&&&&&&&& &'&&&&&&&&&& @@@ Б
.if SizesSFO
                  Бв том числе: Б
.{
                                   @@@@@@ @@@@@@@  @  &&&&&&&&&&&&&& &&&&&&&&&&&&&&& &&&&&&&&&&&&&  Б&'&&&&&&&&&&& &'&&&&&&&&&& &'&&&&&&&&& &'&&&&&&&&&& @@@ Б
.}

.end
.}
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.} Ш
.endform
