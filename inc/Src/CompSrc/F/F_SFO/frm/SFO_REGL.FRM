//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецодежда
// Печать Акта регламентного списания СФО
//------------------------------------------------------------------------------

#include Commission.frn

#doc
Печать Акта регламентного списания СФО.<br>
#end
.Form 'SFO_Regl'
.Group 'Акт регламентного списания'
.Group 'Акт регламентного списания (Казахстан)'
.Hide
.Fields
  ANo : String  ADate : Date
  PodrFiltr : String  MolFiltr : String
#CommissionFields
.endFields
  ^ ^
  ^ ^
#CommissionBody(SFO_Regl)
.{ spcSFORegl CheckEnter
.Fields
  EmptItog : Double
  sfName : String  sfKod : String  sfEd : String
  sfKol  : Word    sfPrice : Double
  sfSrok : String  sfEnd : Date
  psCdN  : String  psFIO : String  psTabN : String
  psMol  : String  psPodr: String
.endFields
.if ActSpLevItog
  Итого по ЛК: ^
.else

  ^ ^ ^  ^ ^  ^ ^  ^ ^ ^ ^ ^
.end
.}

.endForm

!----------------------------------------------------------------------------

.LinkFORM SFO_Regl1 Prototype Is SFO_Regl
.NameInList 'Акт регламентного списания СФО'
.Group 'Акт регламентного списания'
.Group 'Акт регламентного списания (Казахстан)'
.Defo LandScape
.p 55
#CommissionLinkVar
#CommissionLinkInit(SFO_Regl)
.Fields
  CommonFormHeader
  ANo  DateToStr( ADate, 'DD/MM/YYYY')
  PodrFiltr  MolFiltr
.endFields
.Var
  CardItog : Double
  Itog : Double
.endVar
 Ш ^
                                                               Акт регламентного списания СФО №  Б^ Б от  Б^ Б

Фильтр
  по подразделениям: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  по МОЛ:            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.begin
  CardItog := 0;
  Itog := 0;
end.
.{ spcSfoRegl checkenter
.[h
                                                                                                                                                                                                            стр. @NP@
┌───────────────────────────┬────────────┬──────┬───────────┬───────────────┬───────────────┬─────────┬────────────┬──────────┬─────────┬────────────────────────────┬──────────────────────────┬────────────────────┐
│     Наименование СФО      │ Номенклат. │Кол-во│  Единица  │     Цена      │   Стоимость   │Срок мес.│Дата окончан│ Номер ЛК │ Табельн │             ФИО            │           МОЛ            │    Подразделение   │
│                           │   номер    │      │ измерения │               │               │         │срока службы│учета  СФО│  номер  │          работника         │                          │                    │
├───────────────────────────┼────────────┼──────┼───────────┼───────────────┼───────────────┼─────────┼────────────┼──────────┼─────────┼────────────────────────────┼──────────────────────────┼────────────────────┤
.]h
.Fields
  CardItog
  sfName  sfKod  sfKol  sfEd  sfPrice  sfPrice*sfKol
  sfSrok  DateToStr( sfEnd, 'DD/MM/YYYY')
  psCdN  psTabN  psFIO  psMol  psPodr
.endFields
.if ActSpLevItog
├───────────────────────────┴────────────┴──────┴───────────┴───────────────┴───────────────┴─────────┴────────────┴──────────┴─────────┴────────────────────────────┴──────────────────────────┴────────────────────┤
│                                                               Итого по ЛК: &#'&&&&&&&&&.&&                                                                                                                         │
├───────────────────────────┬────────────┬──────┬───────────┬───────────────┬───────────────┬─────────┬────────────┬──────────┬─────────┬────────────────────────────┬──────────────────────────┬────────────────────┤
.begin
  CardItog := 0;
end.
.else
.begin
  CardItog := CardItog + sfPrice*sfKol;
  Itog := Itog + sfPrice*sfKol;
end.
│@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│&#&.&&│@@@@@@@@@@@│&#'&&&&&&&&&.&&│&#'&&&&&&&&&.&&│&&&&&&&&&│&&&&&&&&&&&&│&&&&&&&&&&│&&&&&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│
.end
.[f
└───────────────────────────┴────────────┴──────┴───────────┴───────────────┼───────────────┼─────────┴────────────┴──────────┴─────────┴────────────────────────────┴──────────────────────────┴────────────────────┘
.]f
.}
.Fields
  Itog
.endFields
 Утиль, не подлежащий учету уничтожен.                         БИтого по акту:│&#'&&&&&&&&&.&&│ Б
                                                                             Б└───────────────┘ Б

.Fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endFields
  Председатель комиссии:  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                       должность                        подпись                расшифровка подписи
.{While (Номер_члена_комиссии < Количество_членов_комиссии) OR (Номер_члена_комиссии < 3)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = Word(1), 'Члены комиссии:', '')
  if (Номер_члена_комиссии <= Количество_членов_комиссии, Массив_Член_комиссии_Должность[Номер_члена_комиссии], '')
  if (Номер_члена_комиссии <= Количество_членов_комиссии, Массив_Член_комиссии_ФИО[Номер_члена_комиссии], '')
.endfields
         @@@@@@@@@@@@@@@  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                       должность                        подпись                расшифровка подписи
.}

   Утиль (лом) по накладной № ___________________сдан

      "_____"_______________20___г.
 Ш
.endForm

!----------------------------------------------------------------------------

.LinkFORM SFO_Regl2 Prototype Is SFO_Regl
.NameInList 'Акт регламентного списания СФО (Казахстан)'
.Group 'Акт регламентного списания (Казахстан)'
.Defo LandScape
.p 55
#CommissionLinkVar
#CommissionLinkInit(SFO_Regl)
.Fields
  CommonFormHeader
  ANo  DateToStr( ADate, 'DD/MM/YYYY')
  PodrFiltr  MolFiltr
.endFields
.Var
  CardItog : Double
  Itog : Double
.endVar
 Ш ^
                                                               Акт регламентного списания СФО №  Б^ Б от  Б^ Б

Фильтр
  по подразделениям: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  по МОЛ:            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.begin
  CardItog := 0;
  Itog := 0;
end.
.{ spcSfoRegl checkenter
.[h
                                                                                                                                                                                                            стр. @NP@
┌──────────────────────────────────────────────────┬────────────────────┬────────────┬───────────┬───────────────┬───────────────┬─────────┬────────────┬──────────┬────────────┬────────────────────────────────────┐
│                 Наименование СФО                 │   Номенклатурный   │   Кол-во   │  Единица  │     Цена      │   Стоимость   │Срок мес.│ Дата оконч.│ Номер ЛК │  Табельн.  │                ФИО                 │
│                                                  │       номер        │            │ измерения │               │               │         │срока службы│учета  СФО│    номер   │             работника              │
├──────────────────────────────────────────────────┼────────────────────┼────────────┼───────────┼───────────────┼───────────────┼─────────┼────────────┼──────────┼────────────┼────────────────────────────────────┤
.]h
.Fields
  CardItog
  sfName  sfKod  sfKol  sfEd  sfPrice  sfPrice*sfKol
  sfSrok  DateToStr(sfEnd, 'DD/MM/YYYY')
  psCdN  psTabN  psFIO
.endFields
.if ActSpLevItog
├──────────────────────────────────────────────────┴────────────────────┴────────────┴───────────┴───────────────┴───────────────┴─────────┴────────────┴──────────┴────────────┴────────────────────────────────────┤
│                                                                                                    Итого по ЛК: &#'&&&&&&&&&.&&                                                                                    │
├──────────────────────────────────────────────────┬────────────────────┬────────────┬───────────┬───────────────┬───────────────┬─────────┬────────────┬──────────┬────────────┬────────────────────────────────────┤
.begin
  CardItog := 0;
end.
.else
.begin
  CardItog := CardItog + sfPrice*sfKol;
  Itog := Itog + sfPrice*sfKol;
end.
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│&#&&&&&&&.&&│@@@@@@@@@@@│&#'&&&&&&&&&.&&│&#'&&&&&&&&&.&&│&&&&&&&&&│@~@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
.end
.[f
└──────────────────────────────────────────────────┴────────────────────┴────────────┴───────────┴───────────────┼───────────────┼─────────┴────────────┴──────────┴────────────┴────────────────────────────────────┘
.]f
.}
.Fields
  Itog
.endFields
 Утиль, не подлежащий учету уничтожен.                                                              БИтого по акту:│&#'&&&&&&&&&.&&│ Б
                                                                                                                  Б└───────────────┘ Б

.Fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endFields
  Председатель комиссии:  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                       должность                        подпись                расшифровка подписи
.{While (Номер_члена_комиссии < Количество_членов_комиссии) OR (Номер_члена_комиссии < 3)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = Word(1), 'Члены комиссии:', '')
  if (Номер_члена_комиссии <= Количество_членов_комиссии, Массив_Член_комиссии_Должность[Номер_члена_комиссии], '')
  if (Номер_члена_комиссии <= Количество_членов_комиссии, Массив_Член_комиссии_ФИО[Номер_члена_комиссии], '')
.endfields
         @@@@@@@@@@@@@@@  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                       должность                        подпись                расшифровка подписи
.}

   Утиль (лом) по накладной № ___________________сдан

      "_____"_______________20___г.
 Ш
.endForm
