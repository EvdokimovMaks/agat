//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецоснастка
// Печать Личной карточки учета спецоснастки
//------------------------------------------------------------------------------

#doc
Формирование различных печатных форм из ЛК учета спецоснастки.<br>
#end
.Set Name = 'RepPersMBP'
.Hide
.Fields
  CardNRec: Comp  CardNo : String  OrgName : String  OKPO : String  Podr : String
  repDate : Date  TabN : String  FIO : String  Prof : String cSigners : Comp
.endFields
  ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.{
.Fields
  MBPNRec : Comp  MBPName: String   MBPKod : String
  InNRec  : Comp  dMBPIn : Date  kolMBPIn  : Double  MBPInPrice  : Double  MBPInPerIsn  : Double
  OutNRec : Comp dMBPOut : Date  kolMBPOut : Double  MBPOutPrice : Double  MBPOutPerIsn : Double
  nAct : String  dAct : Date  Srok : String  DopInfo : String  PasNum : String
.endFields
  ^ ^ ^  ^ ^ ^ ^ ^  ^ ^ ^ ^ ^  ^ ^ ^ ^ ^
.}
.endForm

!------------------------------------------------------------

.LinkFORM RepPersMBP1 Prototype Is RepPersMBP
.Group 'Личная карточка учета'
.Group 'Личная карточка учета (Беларусь)'
.NameInList 'Личная карточка учета МБП'
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  sFIO, sPost : string;
.endvar
.begin
  sFIO := sPost := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Составитель'))
    {
      sFIO := iFeeSigners.GetSignerFIO(1);
      sPost := iFeeSigners.GetSignerPosition(1);
    }

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
  CommonFormHeader
  CardNo
  OrgName
  OKPO
  Podr
  DateToStr(repDate, 'DD/MM/YYYY')
  Podr
  TabN
  FIO
  Prof
.endFields
.var
  PrintObr : Boolean;
.endvar
.begin
  PrintObr := True;
end.
 Ш ^
                                                                                                            Типовая межотраслевая форма № МБ-2
                                                                                                            Утверждена постановлением Госкомстата России
                                                                                                            от 30.10.97 № 71а
                                               БКАРТОЧКА №  Д@~@@@@@@@@ Е                                                                       ┌─────────────┐
                              Бучета малоценных и быстроизнашивающихся предметов Б                                                            │    Коды     │
                                                                                                                                           Б├─────────────┤ Б
                                                                                                                            Форма по ОКУД  Б│   0320001   │ Б
                                                                                                                                           Б├ Б───────────── Б┤ Б
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е            по ОКПО  Б│@~@@@@@@@@@@@│ Б
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                     Б└─────────────┘ Б
                                                 ┌──────────┬──────────┬───────────────────────────┬──────────────┬──────────────────────────┬──────────┐
                                                 │   Дата   │          │        Cтруктурное        │     Вид      │  Корреспондирующий счет  │Табельный │
                                                 │  состав- │ Код вида │       подразделение       │ деятельности ├─────────┬────────────────┤  номер   │
                                                 │   ления  │ операции │                           │              │  счет,  │  код аналити-  │получателя│
                                                 │          │          │                           │              │ субсчет │ ческого учета  │          │
                                                 ├──────────┼──────────┼───────────────────────────┼──────────────┼─────────┼────────────────┼──────────┤
                                                 │@@@@@@@@@@│          │@~@@@@@@@@@@@@@@@@@@@@@@@@@│              │         │                │@~@@@@@@@@│
                                                 └──────────┴──────────┴───────────────────────────┴──────────────┴─────────┴────────────────┴──────────┘
 Фамилия И.,О.  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
  ДПрофессия  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
 Должность
.{
.[h1
╔══════════════════════════════════════════╦════════════════════════════════════╦══════════════════════════════╦════════════════════╦════════╦══════════╗
║                   Предмет                ║              Выдано                ║           Возвращено         ║     Акт выбытия    ║        ║          ║
╟───────────────────────────┬──────────────╫──────────┬────────┬────────────────╫──────────┬────────┬──────────╫─────────┬──────────╢  Срок  ║  Номер   ║
║       Наименование,       │ Номенклатур- ║   Дата   │ Кол-во │Подпись работни-║   Дата   │ Кол-во │ Подпись  ║  Номер  │   Дата   ║ службы ║ паспорта ║
║       марка, размер       │   ный номер  ║          │        │ ка (бригадира) ║          │        │кладовщика║         │          ║        ║          ║
╟───────────────────────────┼──────────────╫──────────┼────────┼────────────────╫──────────┼────────┼──────────╫─────────┼──────────╫────────╫──────────╢
║             1             │      2       ║     3    │    4   │       5        ║     6    │    7   │     8    ║    9    │    10    ║   11   ║    12    ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
.]h
.[h2
                                                                                                                          Оборотная сторона формы № МБ-2
╔══════════════════════════════════════════╦════════════════════════════════════╦══════════════════════════════╦════════════════════╦════════╦══════════╗
║                   Предмет                ║              Выдано                ║           Возвращено         ║     Акт выбытия    ║        ║          ║
╟───────────────────────────┬──────────────╫──────────┬────────┬────────────────╫──────────┬────────┬──────────╫─────────┬──────────╢  Срок  ║  Номер   ║
║       Наименование,       │ Номенклатур- ║   Дата   │ Кол-во │Подпись работни-║   Дата   │ Кол-во │ Подпись  ║  Номер  │   Дата   ║ службы ║ паспорта ║
║       марка, размер       │   ный номер  ║          │        │ ка (бригадира) ║          │        │кладовщика║         │          ║        ║          ║
╟───────────────────────────┼──────────────╫──────────┼────────┼────────────────╫──────────┼────────┼──────────╫─────────┼──────────╫────────╫──────────╢
║             1             │      2       ║     3    │    4   │       5        ║     6    │    7   │     8    ║    9    │    10    ║   11   ║    12    ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
.]h
.Fields
  MBPName
  MBPKod
  if (LongInt(dMBPIn) > 0, DateToStr(dMBPIn, 'DD/MM/YYYY'), '')
  kolMBPIn
  if (LongInt(dMBPOut) >0, DateToStr(dMBPOut, 'DD/MM/YYYY'), '')
  kolMBPOut
  nAct
  if (LongInt(dAct) > 0, DateToStr(dAct, 'DD/MM/YYYY'), '')
  Srok
  PasNum
  sPost
  sFIO
  sPost
  sFIO
.endFields
║@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@║@@@@@@@@@@│&#&&&.&&│                ║@@@@@@@@@@│&#&&&.&&│          ║@~@@@@@@@│@~@@@@@@@@║@~@@@@@@║@@@@@@@@@@║
.[f1
.begin
  PrintObr := True;
end.
╚═══════════════════════════╧══════════════╩══════════╧════════╧════════════════╩══════════╧════════╧══════════╩═════════╧══════════╩════════╩══════════╝

.]f
.[f2
.begin
  PrintObr := False;
end.
╚═══════════════════════════╧══════════════╩══════════╧════════╧════════════════╩══════════╧════════╧══════════╩═════════╧══════════╩════════╩══════════╝
Карточку заполнил  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                            должность           подпись              расшифровка подписи

                  "  "  ___________  20  г.

.]f
.}
.{?INTERNAL;PrintObr
                                                                                                                           Оборотная сторона формы № МБ-2
╔══════════════════════════════════════════╦════════════════════════════════════╦══════════════════════════════╦════════════════════╦════════╦══════════╗
║                   Предмет                ║              Выдано                ║           Возвращено         ║     Акт выбытия    ║        ║          ║
╟───────────────────────────┬──────────────╫──────────┬────────┬────────────────╫──────────┬────────┬──────────╫─────────┬──────────╢  Срок  ║  Номер   ║
║       Наименование,       │ Номенклатур- ║   Дата   │ Кол-во │Подпись работни-║   Дата   │ Кол-во │ Подпись  ║  Номер  │   Дата   ║ службы ║ паспорта ║
║       марка, размер       │   ный номер  ║          │        │ ка (бригадира) ║          │        │кладовщика║         │          ║        ║          ║
╟───────────────────────────┼──────────────╫──────────┼────────┼────────────────╫──────────┼────────┼──────────╫─────────┼──────────╫────────╫──────────╢
║             1             │      2       ║     3    │    4   │       5        ║     6    │    7   │     8    ║    9    │    10    ║   11   ║    12    ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╚═══════════════════════════╧══════════════╩══════════╧════════╧════════════════╩══════════╧════════╧══════════╩═════════╧══════════╩════════╩══════════╝
Карточку заполнил  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                            должность           подпись              расшифровка подписи

                  "  "  ___________  20  г.
.}
 Ш
.endForm

!========================================================================================================

.LinkFORM RepPersMBP2 Prototype Is RepPersMBP
.Group 'Личная карточка учета (Беларусь)'
.NameInList 'Карточка учета инструмента и инвентаря (Форма М-31п)'
.f "MBPM_31p.OUT"
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  TmpIsn: double;
  iFeeSigners : FeeSigners;
  sBuh, sSostav : string;
.endvar
.begin
  sBuh := sSostav := '';
  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Бухгалтер'))
      sBuh := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Составитель'))
      sSostav := iFeeSigners.GetSignerFIO(7);

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
  CommonFormHeader
  OrgName
  OKPO
  Podr
  CardNo
  DateToStr(repDate, 'DD/MM/YYYY')
  FIO
  TabN
  Podr
.endFields
.var
  PrintObr : Boolean;
.endvar
.begin
  PrintObr := False;
end.
 Ш ^
                                                                                                                                           Утверждена
                                                                                                                          Постановлением Министерства
                                                                                                                                    промышленности РБ
                                                                                                                                    от 29.12.2004 №21

                                                                                                                                          Форма М-31п
                                                                                                                                        ┌────────────┐
                                                                                                                                        │    Коды    │
                                                                                                                                        ├────────────┤
                                                                                                                          Форма по ОКУД │            │
                                                                                                                                        ├────────────┤
    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д               ПО ОКЮЛП │@~@@@@@@@@@@│
                                                     наименование организации                                                           ├────────────┤
    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д                        │            │
                                             наименование структурного подразделения                                                    └────────────┘

                                                                  БКАРТОЧКА
                                                             УЧЕТА ИНСТРУМЕНТА И
                                                          ИНВЕНТАРЯ В ЭКСПЛУАТАЦИИ Б
                                                                                                                                            Таблица 1
 ┌────────────┬─────────────┬─────────────┬─────────────┬─────────────┬───────────────────────────────────────┬─────────┬────────────────────────────┐
 │   Номер    │     Дата    │   Участок   │     Цех     │ Раздаточная │     Фамилия, имя, отчество рабочего   │Табельный│         Структурное        │
 │ документа  │ составления │             │             │   кладовая  │                                       │  номер  │        подразделение       │
 ├────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────────────────────────────────────┼─────────┼────────────────────────────┤
 │     1      │      2      │      3      │      4      │      5      │                    6                  │    7    │               8            │
 ├────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────────────────────────────────────┼─────────┼────────────────────────────┤
 │@~@@@@@@@@@@│@~@@@@@@@@@@@│             │             │             │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
 └────────────┴─────────────┴─────────────┴─────────────┴─────────────┴───────────────────────────────────────┴─────────┴────────────────────────────┘

                                                                                                                                            Таблица 2
.{
.[h1
 ┌──────────┬──────────────────────────┬──────────────────────────────────────────┬──────────────────────────────────────────────┬───────────────────┐
 │          │                          │                  Выдано                  │                     Возвращено               │     Акт выбытия   │
 │ Номенкла-│                          ├──────────┬──────┬──────┬───────┬─────────┼──────────┬──────┬────────┬──────────┬────────┼────────┬──────────┤
 │  турный  │       Наименование       │          │      │  %   │  на   │ подпись │          │      │        │ подпись  │подпись │        │          │
 │   номер  │         предмета         │   дата   │ коли-│ год- │ срок  │  лица о │   дата   │ коли-│    %   │кладовщика│ лица о │ номер  │   дата   │
 │          │                          │          │чество│ ности│       │получении│          │чество│годности│ о приеме │возврате│        │          │
 ├──────────┼──────────────────────────┼──────────┼──────┼──────┼───────┼─────────┼──────────┼──────┼────────┼──────────┼────────┼────────┼──────────┤
 │    1     │             2            │     3    │   4  │  5   │   6   │    7    │    8     │   9  │   10   │    11    │   12   │   13   │    14    │
 ├──────────┼──────────────────────────┼──────────┼──────┼──────┼───────┼─────────┼──────────┼──────┼────────┼──────────┼────────┼────────┼──────────┤
.]h
.[h2
                                                                                                                        Оборотная сторона формы М-31п
 ┌──────────┬──────────────────────────┬──────────┬──────┬──────┬───────┬─────────┬──────────┬──────┬────────┬──────────┬────────┬────────┬──────────┐
 │    1     │             2            │     3    │   4  │  5   │   6   │    7    │    8     │   9  │   10   │    11    │   12   │   13   │    14    │
 ├──────────┼──────────────────────────┼──────────┼──────┼──────┼───────┼─────────┼──────────┼──────┼────────┼──────────┼────────┼────────┼──────────┤
.]h
.Fields
  MBPKod
  MBPName
  if (LongInt(dMBPIn) > 0, DateToStr(dMBPIn, 'DD/MM/YYYY'), '')
  kolMBPIn
  if (MBPInPerIsn <> 0, MBPInPerIsn, 0)
  Srok
  if (LongInt(dMBPOut) > 0, DateToStr(dMBPOut, 'DD/MM/YYYY'), '')
  kolMBPOut
  MBPOutPerIsn
  nAct
  if (LongInt(dAct) > 0, DateToStr(dAct, 'DD/MM/YYYY'), '')
  sSostav
  sBuh
  sSostav
  sBuh
.endFields
 │&&&&&&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@@│&#&&&&│&&&.&&│@~@@@@@│         │@~@@@@@@@@│&#&&&&│&#&&&.&&│          │        │&&&&&&&&│@~@@@@@@@@│
.[f1
.begin
  PrintObr := True;
end.
 └──────────┴──────────────────────────┴──────────┴──────┴──────┴───────┴─────────┴──────────┴──────┴────────┴──────────┴────────┴────────┴──────────┘

.]f
.[f2
.begin
  PrintObr := False;
end.
 └──────────┴──────────────────────────┴──────────┴──────┴──────┴───────┴─────────┴──────────┴──────┴────────┴──────────┴────────┴────────┴──────────┘

  БКарточку заполнил кладовщик Б ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                         фамилия, инициалы
  БПроверил бухгалтер Б          ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                         фамилия, инициалы

.]f
.}
.{?INTERNAL;PrintObr
                                                                                                                        Оборотная сторона формы М-31п
 ┌──────────┬──────────────────────────┬──────────┬──────┬──────┬───────┬─────────┬──────────┬──────┬────────┬──────────┬────────┬────────┬──────────┐
 │    1     │             2            │     3    │   4  │  5   │   6   │    7    │    8     │   9  │   10   │    11    │   12   │   13   │    14    │
 ├──────────┼──────────────────────────┼──────────┼──────┼──────┼───────┼─────────┼──────────┼──────┼────────┼──────────┼────────┼────────┼──────────┤
 │          │                          │          │      │      │       │         │          │      │        │          │        │        │          │
 ├──────────┼──────────────────────────┼──────────┼──────┼──────┼───────┼─────────┼──────────┼──────┼────────┼──────────┼────────┼────────┼──────────┤
 │          │                          │          │      │      │       │         │          │      │        │          │        │        │          │
 ├──────────┼──────────────────────────┼──────────┼──────┼──────┼───────┼─────────┼──────────┼──────┼────────┼──────────┼────────┼────────┼──────────┤
 │          │                          │          │      │      │       │         │          │      │        │          │        │        │          │
 ├──────────┼──────────────────────────┼──────────┼──────┼──────┼───────┼─────────┼──────────┼──────┼────────┼──────────┼────────┼────────┼──────────┤
 │          │                          │          │      │      │       │         │          │      │        │          │        │        │          │
 ├──────────┼──────────────────────────┼──────────┼──────┼──────┼───────┼─────────┼──────────┼──────┼────────┼──────────┼────────┼────────┼──────────┤
 │          │                          │          │      │      │       │         │          │      │        │          │        │        │          │
 └──────────┴──────────────────────────┴──────────┴──────┴──────┴───────┴─────────┴──────────┴──────┴────────┴──────────┴────────┴────────┴──────────┘

  БКарточку заполнил кладовщик Б ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                         фамилия, инициалы
  БПроверил бухгалтер Б          ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                         фамилия, инициалы

.} Ш
.endForm

!===================================================================================================

.LinkFORM RepPersMBP3 Prototype Is RepPersMBP
.Group 'Личная карточка учета (Беларусь)'
.NameInList 'Личная карточка учета выдачи СИЗ'
.f "MBP_SIZ.OUT"
.P 80
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  sBuh, sDirect, sMOL : string;
.endvar
.function GetNameFromFIO(sFIO : string; wNumName : word) : string;
var
  tmpFIO : string;
  posFIO : byte;
begin
  GetNameFromFIO := '';
  sFIO := Trim(sFIO);

  case (wNumName) of
  //----------------
    1 : // Фамилия
    {
      posFIO := Pos(' ', sFIO);
      GetNameFromFIO := SubStr(sFIO, 1, if(posFIO = 0, Length(sFIO), posFIO));
    }
  //----------------
    2 : // Имя
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        GetNameFromFIO := SubStr(tmpFIO, 1, Pos(' ', tmpFIO));
      }
    }
  //----------------
    3 : // Отчество
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        posFIO := Pos(' ', tmpFIO);

        if (posFIO = 0) // задана только фамилия и имя
          GetNameFromFIO := '';
        else
        {
          tmpFIO := Trim(SubStr(tmpFIO, Pos(' ', tmpFIO) + 1, Length(tmpFio)));
          GetNameFromFIO := SubStr(tmpFIO, 1, Length(tmpFIO));
        }
      }
    }
  //----------------
  end;
end.
.begin
  sBuh := sDirect := sMOL := '';
  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Бухгалтер'))
      sBuh := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Директор'))
      sDirect := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Ответственный'))
      sMOL := iFeeSigners.GetSignerFIO(7);

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
  CommonFormHeader
  OrgName
  CardNo
  GetNameFromFIO(FIO, 1)
  GetNameFromFIO(FIO, 2)
  GetNameFromFIO(FIO, 3)
  TabN
  Podr
  Prof
  sBuh
  sDirect
  sMOL
  GetNameFromFIO(FIO, 1) + if (GetNameFromFIO(FIO, 2) = '', '', SubStr(GetNameFromFIO(FIO, 2), 1, 1) + '. ' + if (GetNameFromFIO(FIO, 3) = '', '', SubStr(GetNameFromFIO(FIO, 3), 1, 1) + '.'))
  'true' : 's'
.endFields
 Ш^
                                                                                                                                             Приложение 2
                                                                                                            к Инструкции о порядке обеспечения работников
                                                                                                                         средствами индивидуальной защиты

  Организация (предприятие)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д

                                               БЛИЧНАЯ КАРТОЧКА №  Д@@@@@@@@@@ Е
                                           Бучета средств индивидуальной защиты Б

                                                 Сведения о работнике

  Фамилия  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Пол ___________________________________
  Собственное имя  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Отчество (если таковое имеется)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Рост __________________________________
  Табельный номер  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Размер:
  Структурное подразделение  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  одежды _______________________________
  Профессия (должность)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  обуви ________________________________
  Код профессии (должности) по                                                                                     головного убора ______________________
  Общегосударственному классификатору Республики Беларусь                                                          противогаза __________________________
  "Профессии рабочих и должности служащих" ______________________________________________________________________  респиратора __________________________
  Дата поступления на работу ____________________________________________________________________________________  рукавиц ______________________________
  Дата изменения профессии (должности) __________________________________________________________________________  перчаток _____________________________

  Предусмотрено по установленным нормам:
┌─────────────────────────────────────────────────────────────────────────────┬─────────────────────────────┬─────────────────┬────────────┬────────────┐
│                                                                             │ Классификация (маркировка)  │                 │            │            │
│                     Наименование средств индивидуальной                     │средств индивидуальной защиты│     Единица     │ Количество │ Срок носки │
│                                   защиты                                    │  по защитным свойствам или  │    измерения    │            │            │
│                                                                             │ конструктивным особенностям │                 │            │            │
├─────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                      1                                      │              2              │        3        │     4      │     5      │
├─────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                                                             │                             │                 │            │            │
├─────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                                                             │                             │                 │            │            │
├─────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                                                             │                             │                 │            │            │
├─────────────────────────────────────────────────────────────────────────────┼─────────────────────────────┼─────────────────┼────────────┼────────────┤
│                                                                             │                             │                 │            │            │
└─────────────────────────────────────────────────────────────────────────────┴─────────────────────────────┴─────────────────┴────────────┴────────────┘

  Главный бухгалтер (бухгалтер)                               Д&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Д
                                                                          (личная подпись, дата, расшифровка подписи)
  Согласовано:
  специалист отдела кадров                                   _____________________________________________________________________
                                                                          (личная подпись, дата, расшифровка подписи)
  руководитель структурного подразделения                     Д&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Д
                                                                          (личная подпись, дата, расшифровка подписи)
  специалист по охране труда                                 _____________________________________________________________________

  ответственное лицо за выдачу средств индивидуальной защиты  Д&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Д
                                                                          (личная подпись, дата, расшифровка подписи)
  Ознакомлен:
  работник                                                    Д&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& Д
                                                                          (личная подпись, дата, расшифровка подписи)
^
.{
.[h
                                                                                                                        Оборотная сторона личной карточки
┌──────────────────────────────────┬───────────────┬─────────────────────────────────────────────┬──────────────────────────────────────────────────────┐
│                                  │ Классификация │                   Выдано                    │                      Возвращено                      │
│                                  │ (маркировка)  ├──────────┬──────┬──────┬───────────┬────────┼──────────┬──────┬──────┬───────────┬────────┬────────┤
│        Наименование средств      │средств индиви-│          │      │      │           │        │          │      │      │           │        │        │
│          индивидуальной          │дуальной защиты│          │      │      │           │Расписка│          │      │      │           │        │Расписка│
│              защиты              │  по защитным  │   Дата   │Кол-во│  %   │ Стоимость │работни-│   Дата   │Кол-во│  %   │ Стоимость │Расписка│кладов- │
│                                  │ свойствам или │          │      │износа│           │ка в по-│          │      │износа│           │сдавшего│щика в  │
│                                  │конструктивным │          │      │      │           │лучении │          │      │      │           │        │приемке │
│                                  │ особенностям  │          │      │      │           │        │          │      │      │           │        │        │
├──────────────────────────────────┼───────────────┼──────────┼──────┼──────┼───────────┼────────┼──────────┼──────┼──────┼───────────┼────────┼────────┤
│                1                 │        2      │    3     │  4   │  5   │     6     │   7    │    8     │  9   │  10  │    11     │   12   │   13   │
├──────────────────────────────────┼───────────────┼──────────┼──────┼──────┼───────────┼────────┼──────────┼──────┼──────┼───────────┼────────┼────────┤
.]h
.Fields
  MBPName
  if (Longint(dMBPIn) = 0, '', DateToStr(dMBPIn, 'DD/MM/YYYY'))
  kolMBPIn
  if (Longint(dMBPIn) = 0, 0.0, 100 - MBPInPerIsn)
  MBPInPrice * kolMBPIn
  if (Longint(dMBPOut) = 0, '', DateToStr(dMBPOut, 'DD/MM/YYYY'))
  kolMBPOut
  if (Longint(dMBPOut) = 0, 0.0, 100 - MBPOutPerIsn)
  MBPOutPrice * kolMBPOut
.endFields
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│               │@~@@@@@@@@│&#&&&&│&#&.&&│&#&&&&&&.&&│        │@~@@@@@@@@│&#&&&&│&#&.&&│&#&&&&&&.&&│        │        │
.[f
└──────────────────────────────────┴───────────────┴──────────┴──────┴──────┴───────────┴────────┴──────────┴──────┴──────┴───────────┴────────┴────────┘
.]f
.} Ш
.endForm

!========================================================================================================

.LinkFORM RepPersMBP4 Prototype Is RepPersMBP
.Group 'Личная карточка учета (Беларусь)'
.NameInList 'Личная карточка учета спецодежды (Форма М-37п)'
.f "MBPM_37p.OUT"
.P 80
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  sBuh, sSostav : string;
  Nom_Utv, Kol_Utv : longint;
  Utv_FIO, Utv_Post : array [1..2] of string;
.endvar
.begin
  for (Kol_Utv := 1; Kol_Utv <= Count(Utv_FIO); Kol_Utv++)
  {
    Utv_FIO[Kol_Utv] := '';
    Utv_Post[Kol_Utv] := '';
  }

  sBuh := sSostav := '';
  Kol_Utv := 0;

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(3, 'Бухгалтер'))
      sBuh := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Составитель'))
      sSostav := iFeeSigners.GetSignerFIO(7);

    if (iFeeSigners.RestrictFeeByRole(3, 'Утверждающее лицо'))
      if (iFeeSigners.GetSignerFirst)
        do
        {
          Kol_Utv++;
          Utv_FIO[Kol_Utv] := iFeeSigners.GetSignerFIO(7);
          Utv_Post[Kol_Utv] := iFeeSigners.GetSignerPosition(1);
        }
        while (iFeeSigners.GetSignerNext);

    iFeeSigners.ClearRestriction;
  }

  if (Kol_Utv = 0)
  {
    Kol_Utv := 3;
    Utv_FIO[1] := Utv_FIO[2] := Utv_FIO[3] := '';
    Utv_Post[1] := Utv_Post[2] := Utv_Post[3] := '';
  }
end.
.Fields
  CommonFormHeader
  OrgName
  OKPO
  Podr
  CardNo
  if (Longint(repDate) > 0, DateToStr(repDate, 'DD/MM/YYYY'), '')
  FIO
  Prof
  ''
  TabN
  Podr
.endFields
 Ш  ^
                                                                                                                                           Утверждена
                                                                                                                          Постановлением Министерства
                                                                                                                                    промышленности РБ
                                                                                                                                    от 29.12.2004 №21

                                                                                                                                          Форма М-37п
                                                                                                                                         Б┌────────────┐
                                                                                                                                        │    Коды    │
                                                                                                                                        ├────────────┤ Б
                                                                                                                          Форма по ОКУД │            │
                                                                                                                                        ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д               ПО ОКЮЛП │@~@@@@@@@@@@│
                                              (наименование организации)                                                                ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д                        │            │
                                       (наименование структурного подразделения)                                                        └────────────┘
                                                                                                                 Б┌─────────────────┬──────────────────┐ Б
                                                    БЛИЧНАЯ КАРТОЧКА Б                                              Б │      Номер      │       Дата       │ Б
                                              Бучета спецодежды, спецобуви Б                                        Б │    документа    │    составления   │ Б
                                           Би предохранительных приспособлений Б                                     Б├─────────────────┼──────────────────┤ Б
                                                                                                                │@~@@@@@@@@@@@@@@@│@~@@@@@@@@@@@@@@@@│
                                                                                                                └─────────────────┴──────────────────┘
  Имя, отчество, фамилия работника  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Профессия  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Должность  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д

  Информация о работнике
  Б┌───────────────┬────────────────────────────────────────────────────────────────────┬──────────────────────────┬─────┬─────┬───────────────────────┐
 │               │                     Подразделения организации                      │            Дата          │     │     │         Размер        │
 │   Табельный   ├──────────────────────┬──────────────────────┬──────────────────────┼─────────────┬────────────┤ Пол │Рост ├──────┬─────┬──────────┤
 │     номер     │                      │                      │                      │ поступления │ изменения  │     │     │одежды│обуви│головного │
 │               │                      │                      │                      │  на работу  │ профессии  │     │     │      │     │  убора   │
 ├───────────────┼──────────────────────┼──────────────────────┼──────────────────────┼─────────────┼────────────┼─────┼─────┼──────┼─────┼──────────┤
 │       1       │          2           │          3           │          4           │      5      │      6     │  7  │  8  │  9   │ 10  │    11    │
 ├───────────────┼──────────────────────┼──────────────────────┼──────────────────────┼─────────────┼────────────┼─────┼─────┼──────┼─────┼──────────┤ Б
 │@~@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@│                      │                      │             │            │     │     │      │     │          │
 └───────────────┴──────────────────────┴──────────────────────┴──────────────────────┴─────────────┴────────────┴─────┴─────┴──────┴─────┴──────────┘

  Предусмотрено по утвержденным нормам:
  Б┌────────────────────────────────────────────────────────────────────────────────────┬──────────────────────────┬─────────────┬──────────┬──────────┐
 │                         Наименование спецодежды, спецобуви,                        │   Основание (ссылка на   │   Единица   │Количество│Срок носки│
 │                          предохранительных приспособлений                          │   нормативный документ)  │  измерения  │          │          │
 ├────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────┼─────────────┼──────────┼──────────┤
 │                                         1                                          │            2             │      3      │    4     │     5    │
 ├────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────┼─────────────┼──────────┼──────────┤ Б
 │                                                                                    │                          │             │          │          │
 ├────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────┼─────────────┼──────────┼──────────┤
 │                                                                                    │                          │             │          │          │
 ├────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────┼─────────────┼──────────┼──────────┤
 │                                                                                    │                          │             │          │          │
 └────────────────────────────────────────────────────────────────────────────────────┴──────────────────────────┴─────────────┴──────────┴──────────┘

.begin
  Nom_Utv := 0;
end.
.{While (Nom_Utv < Kol_Utv)
.begin
  Nom_Utv := Nom_Utv + 1;
end.
.fields
  if (Nom_Utv = 1, 'СОГЛАСОВАНО', '')
  Utv_Post[Nom_Utv]
  Utv_FIO[Nom_Utv]
.endfields
  @@@@@@@@@@@   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д     Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                          (должность, подпись)                           (инициалы, фамилия)
.}
.fields
  'true' : 's'
.endfields
^
                                                                                                                        Оборотная сторона формы М-37п
  Выдача и возврат спецодежды, спецобуви и предохранительных приспособлений
  Б┌──────────────────────────────┬───────────────┬──────────────────────────────────────────────────┬─────────────────────────────────────────────────┐
 │                              │               │                      Выдано                      │                   Возвращено                    │
 │         Наименование         │      Код      ├──────────┬──────┬────────┬─────────────┬─────────┼──────────┬──────┬────────┬──────────────────────┤
 │    спецодежды, спецобуви,    │(номенклатурный│          │      │        │             │ подпись │          │      │        │       подпись        │
 │      предохранительных       │    номер)     │   дата   │ коли-│процент │  стоимость, │  лица в │   дата   │ коли-│процент ├──────────┬───────────┤
 │        приспособлений        │               │          │чество│годности│     руб.    │получении│          │чество│годности│работника │кладовщика │
 │                              │               │          │      │        │             │         │          │      │        │о возврате│в получении│
 ├──────────────────────────────┼───────────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │              1               │       2       │    3     │  4   │   5    │      6      │    7    │    8     │  9   │   10   │    11    │    12     │
 ├──────────────────────────────┼───────────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤ Б
.{
.[h skip
                                                                                                                        Оборотная сторона формы М-37п
  Б┌──────────────────────────────┬───────────────┬──────────┬──────┬────────┬─────────────┬─────────┬──────────┬──────┬────────┬──────────┬───────────┐
 │              1               │       2       │    3     │  4   │   5    │      6      │    7    │    8     │  9   │   10   │    11    │    12     │
 ├──────────────────────────────┼───────────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤ Б
.]h
.Fields
  MBPName
  MBPKod
  if (LongInt(dMBPIn) > 0, DateToStr(dMBPIn, 'DD/MM/YYYY'), '')
  kolMBPIn
  if (MBPInPerIsn <> 0, MBPInPerIsn, 0)
  MBPInPrice * kolMBPIn
  if (LongInt(dMBPOut) > 0, DateToStr(dMBPOut, 'DD/MM/YYYY'), '')
  kolMBPOut
  MBPOutPerIsn
  sSostav
  sBuh
.endFields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@│@~@@@@@@@@│&#&&&&│&#&&&.&&│&#&&&&&&&&.&&│         │@~@@@@@@@@│&#&&&&│&#&&&.&&│          │           │
.[f
 └──────────────────────────────┴───────────────┴──────────┴──────┴────────┴─────────────┴─────────┴──────────┴──────┴────────┴──────────┴───────────┘
.]f
.}

  Карточку оформил кладовщик _________________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     (подпись)                         (инициалы, фамилия)
  Проверил бухгалтер         _________________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     (подпись)                         (инициалы, фамилия)
  "______" _______________ 20____ г. Ш
.endForm
