//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Управление бюджетом"
// Работа с каталогами
//------------------------------------------------------------------------------

#ifndef _ObjFpKat_Included_
#define _ObjFpKat_Included_

//------------------------------------------------------------------------------
#include LBadRec.Tbl     // Сервисная таблица: "Список некорректный записей"
//------------------------------------------------------------------------------

#ifdef  ComponentVersion
#component "F_FpKatH"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Работа с каталогами<br>
#end
ObjInterface tFpKatObjInterface;

//------------------------------------------------------------------------------
#doc
   Инициализация объекта<br>
#end
Function InitObj : boolean;

//------------------------------------------------------------------------------
#doc
   Инициализация параметров интерфейса<br>
#end
Function InitParam(
  _wIntMode : word;
  _cTopRec  : comp;
  _cNodeTop : comp;
  _cGetRec  : comp
) : boolean;

//------------------------------------------------------------------------------
#doc
   Можно ли редактировать каталог<br>
#end
Function CanEdit : boolean;

//------------------------------------------------------------------------------
#doc
   Спозиционироваться на заданную запись<br>
#end
Function SetPosKatH(cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Вставка в таблицу ListBadRec<br>
#end
Function InsertBadNRec(cBadNRec : comp; sBadName : string) : boolean;
//------------------------------------------------------------------------------
#doc
   Поиск записи в таблице ListBadRec<br>
#end
Function FindBadNRec(cBadNRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Удаление записи из каталога<br>
#end
Function DeleteKatH(cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Копирование записи<br>
#end
Function CopyKatH(cRec : comp) : comp;

//------------------------------------------------------------------------------
#doc
<brief>Проверка отвязанных значений</brief><br>
   Некорректные значения:<br>
    - удалять      ((wMode and cgFpKatH_Check_IsDel) = cgFpKatH_Check_IsDel);<br>
    - исправлять   ((wMode and cgFpKatH_Check_IsCorrect) = cgFpKatH_Check_IsCorrect);<br>
#end
Function CheckNodeKatH(wMode : word) : boolean;

//------------------------------------------------------------------------------
#doc
<brief>Проверка корректности текущей записи</brief><br>
   Некорректные значения:<br>
    - удалять      ((wMode and cgFpKatH_Check_IsDel) = cgFpKatH_Check_IsDel);<br>
    - исправлять   ((wMode and cgFpKatH_Check_IsCorrect) = cgFpKatH_Check_IsCorrect);<br>
#end
Function CheckCorrectCurKatH(wMode : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Проверка корректности всего каталога<br>
#end
Function CheckCorrectAllKatH(wMode : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Полный пересчет всех кодов каталога<br>
#end
Procedure RecAllLevels(cTop : comp);

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

#endif//_ObjFpKat_Included_
