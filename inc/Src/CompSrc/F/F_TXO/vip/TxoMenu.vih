//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 8.1 - Бухгалтерский контур
// Выбор и высветка режимов для интерфейсов ТXО
//********************************************************************************

#ifndef _txomenu_vih_Included
#define _txomenu_vih_Included

#include TxoApi.vih

#ifdef ComponentVersion
#Component "F_TXO"
#end

#doc
Выбор и высветка режимов для интерфейсов ТXО
#end
ObjInterface ObjTxoMenu;

  #doc
  to do - MenuEnablePiston - т.к. не могу ждать решения ПИР 102.26561 (Larin)
  Ну не работают EnableCommand и DisableCommand в объектном интерфейсе
  поэтому сделаю событие на которое должны будут подписываться все вызывающие интерфейсы
  #end
  event procedure ev_SetQuickChoiceName(QCName:string);

  #doc
  to do - MenuEnablePiston - т.к. не могу ждать решения ПИР 102.26561 (Larin)
  Ну не работают EnableCommand и DisableCommand в объектном интерфейсе
  поэтому сделаю событие на которое должны будут подписываться все вызывающие интерфейсы
  #end
  event function ev_RunGetBuhSchet(aIntMode : Word; aPlansNo : comp; var aSch : tSchet3; var aSub : tSubSch) : word;

  #doc
  храним циклические обработки в ТП T_TXOMenuCycles
  #end
  function AddMenuCycles(wCycle:word) : boolean;

  #doc
  все удаляем из T_TXOMenuCycles
  #end
  function DelAllMenuCycles : boolean;

  #doc
  установить доступ к меню режимов аналитики.
  ModeEnable : особые случай доступности общих режимов, см. константы cgModeEnable_XXXX
  #end
  procedure SetEnableModeMenu(TipDoc,SysOper,ModeEnable : word);

  #doc
  установить доступ к меню валют
  #end
  procedure SetEnableValMenu(TipDoc : word);

  #doc
  установить доступ к меню валют для конвертации
  #end
  procedure SetEnableConvValMenu(TipDoc : word);

  #doc
  высветка режима аналитики
  #end
  function ShowFlKauName(wKau : word; flKau : word; cKau : comp) : string;

  #doc
  высветка режима аналитики для конкретно заданного NameKau, ObjNameKau
  #end
  function ShowFlKauName_RTXO(wKau : word; flKau : word; NameKau, ObjNameKau : string) : string;

  #doc
  высветка "режима" ЦО
  #end
  function ShowACycle(aCycle : word; name : string) : string;

  #doc
  высветка режима валюты
  #end
  function ShowFlVal(flVal:Word; name : string):string;

  #doc
  высветка режима конвертации проводок
  #end
  function ShowConvMode(flConvMode:Word):string;

  #doc
  высветка режима валюты конвертации проводки
  #end
  function ShowConvVal(flConvVal:Word; name : string):string;

  #doc
  высветка режима - порядок обработки рассчитанной суммы проводки
  #end
  function ShowPrProv(flPrProv:Word):string;

  #doc
  высветка режима - системные операции ОС, НМА
  #end
  function ShowFlSysOper(TiDk,flSysOper:word):string;

  #doc
  высветка режима формирования счета/субсчета
  #end
  function ShowFlSchSub(flSchSub:word; SchSub:string):string;

  #doc
  высветка режима формирования даты проводки
  #end
  function ShowFlDatOb(flDatOb:word; DatOb:date):string;

  #doc
  сформировать системное меню режимов аналитики
  #end
  function RunDynamicKauMenu(wKau : word; var flKau : word; var cKau : comp) : boolean;

  #doc
  сформировать меню пользовательских режимов аналитики
  #end
  function RunDynamicUserKauMenu(wKau : word; var flKau : word; var cKau : comp) : boolean;

  #doc
  сформировать меню для режима ЦО
  #end
  function RunDynamicCycleMenu(var aCycle : word) : boolean;

  #doc
  сформировать меню для режима валют для алгоритма в валюте
  #end
  function RunDynamicValutaMenu(var flVal : word; var cVal : comp) : boolean;

  #doc
  сформировать меню для режима конвертации проводок
  #end
  function RunDynamicConvModeMenu(var flConvMode : word) : boolean;

  #doc
  сформировать меню для режима валюты конвертации проводки
  #end
  function RunDynamicConvValMenu(var flConvVal : word; var cVal : comp) : boolean;

  #doc
  сформировать меню для режима - порядок обработки рассчитанной суммы проводки
  #end
  function RunDynamicPrProvMenu(var flPrProv : word) : boolean;

  #doc
  сформировать меню для режима - тип хозяйственной операции
  #end
  function RunDynamicSysOperMenu(wKau : word; var flSysOper : word) : boolean;

  #doc
  сформировать меню для режима формирования счета/субсчета
  #end
  function RunDynamicSchSubMenu(UseQC, IsUserMenu : boolean; ModeEnable : word; TiDk, wIntMode : word; myPlansNo : comp; var flSch, flSub : word; var Schet : tSchet3; var SubSch : tSubSch) : boolean;

  #doc
  сформировать меню для режима формирования даты проводки
  #end
  function RunDynamicDatObMenu(UseQC, IsUserMenu : boolean; var flDatOb:word; var DatOb:date) : boolean;

  #doc
  очистить хранилище дополнительно подкачиваемых пунктов меню
  #end
  procedure ChargeStorageClear;

  #doc
  добавить элемент в хранилище дополнительно подкачиваемых пунктов меню
  #end
  procedure ChargeStorageAdd(Flag : word; Name : string);

  #doc
  удалить элемент из хранилище дополнительно подкачиваемых пунктов меню
  #end
  procedure ChargeStorageDel(Flag : word);

  #doc
  запуск окошка для явного ввода и выбора даты проводки
  #end
  function InputDateOB(var _DateOb:date):boolean;
end; // ObjInterface

#doc
Выбор и высветка режима формирования единиц измерения количества в проводках
#end
ObjInterface ObjTxoMenuKol;
  #doc
  высветка режима единицы измерения
  #end
  function ShowFlKol(flKol:Word; name : string):string;

  #doc
  установить доступ к меню количества
  #end
  procedure SetEnableKolMenu(TipDoc : word);

  #doc
  сформировать меню для режима валют для алгоритма в валюте
  #end
  function RunDynamicKolMenu(var flKol : word; var cEd : comp) : boolean;

end; // ObjInterface

#doc
Доступ к меню режимов заданной аналитики.
#end
ObjInterface ObjTxoMenuExt;
  #doc
  установить доступ к меню режимов заданной аналитики.
  ModeEnable : особые случай доступности общих режимов, см. константы cgModeEnable_XXXX
  #end
  procedure SetEnableModeMenuKau(TipDoc,SysOper,ModeEnable,wKau : word);

end; // ObjInterface


VipInterface TxoMenu
  Implements ObjTxoMenu, ObjTxoMenuKol, ObjTxoMenuServer, ObjTxoMenuExt
  #ifdef Atl51
  Licensed (Free) // (B_Hozop) - Не делать
  #end
;

#end // _txomenu_vih_Included
