//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Финансовый контур
// Декларация интерфейса поддержки группировки документов по разрезам
//******************************************************************************

#ifndef _oGRP_Razr_
#define _oGRP_Razr_

//-----------------------------------------------------------------------------

#ifdef ComponentVersion
#component "F_MBPPub"
#end

//-----------------------------------------------------------------------------

// Структура для обмена данными с интерфейсом

Type TRazrBuf = Record
       wType : word;   // Тип документа
       cPodF : comp;   // Ссылка на подразделение
       cMolF : comp;   // Ссылка на МОЛ
       cPodT : comp;   // Ссылка на подразделение
       cMolT : comp;   // Ссылка на МОЛ
       dDate : date;   // Дата для группировки
       cDoc  : comp;   // Ссылка на документ по разрезу
       NDoc  : string; // Номер сформированного документа
       Summa : double; // Сумма по документу-разрезу
       SumVal: double; // Еще одна сумма
       Npp   : word;   // Порядковый номер строки спецификации в документе
     end;

//-----------------------------------------------------------------------------

#doc
Данный интерфейс описывает набор функций для поддержки группировки документов по разрезам.<br>
#end
ObjInterface oGRP_Razr;

#doc
Функция ищет во внутренней ТП интерфейса документ, соответствующий по дате и разрезу
параметрам, указанным во входной структуре _RazrBuf. Если требуется сгруппировать по
меньшему количеству параметров, чем имеется в структуре, в лишних полях (разрез "куда")
можно передавать нулевые значения. Возвращается NRec подходящего документа, если он
найден, иначе ноль.<br>
#end
  function  FndRazr(var _RazrBuf : TRazrBuf) : comp;

#doc
Вставляет во внутреннюю ТП информацию о новом созданном документе.<br>
#end
  procedure InsRazr(var _RazrBuf : TRazrBuf);

#doc
Возвращает количество записей о созданных документах указанного типа во внутренней таблице в памяти.<br>
#end
  function  GetCntByType(_wType : word) : longint;

#doc
Возвращает количество записей о созданных документах во внутренней таблице в памяти.<br>
#end
  function  GetCnt : longint;

#doc
Возвращает информацию о сумме документа из текущей записи в ТП из поля "Summa".<br>
#end
  function  GetSum : double;

#doc
Возвращает информацию о сумме документа в валюте из текущей записи в ТП из поля "SumVal".<br>
#end
  function  GetSumVal : double;

#doc
Перемещает указатель текущей записи во внутренней ТП на первую запись. Используется
для организации цикла перебора документов в таблице.<br>
#end
  function  GetFst : boolean;

#doc
Перемещает указатель текущей записи во внутренней ТП на следующую запись. Используется
для организации цикла перебора документов в таблице.<br>
#end
  function  GetNxt : boolean;

#doc
Возвращает номер документа из текущей записи внутренней ТП.<br>
#end
  function  GetNom : string;

#doc
Возвращает NRec документа из текущей записи внутренней ТП.<br>
#end
  function  GetDoc : comp;

#doc
Возвращает дату документа из текущей записи внутренней ТП.<br>
#end
  function  GetDat : date;

#doc
Возвращает номер по порядку из текущей записи внутренней ТП.<br>
#end
  function  GetNpp : word;

#doc
Увеличивает значение поля суммы в текущей записи внутренней ТП.<br>
#end
  procedure AddSum(_Sum : double);

#doc
Увеличивает значение поля суммы в валюте в текущей записи внутренней ТП.<br>
#end
  procedure AddSumVal(_Sum : double);

#doc
Увеличивает значение счетчика номера по порядку в текущей записи внутренней ТП.<br>
#end
  procedure IncNpp;

#doc
Очищает внутреннюю таблицу в памяти.<br>
#end
  procedure Clear;

// Нужны еще GetLast и DeleteDoc!
end;

//-----------------------------------------------------------------------------

VipInterface GRP_Razr implements oGRP_Razr Licensed (FREE);

//-----------------------------------------------------------------------------

#endif
