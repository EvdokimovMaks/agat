//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Функции"
// Автопометка с функцией обхода помеченных записей в порядке их пометки
//------------------------------------------------------------------------------

#ifndef __PosMarker_vih__
#define __PosMarker_vih__

#include Marker.vih

#ifdef ComponentVersion
#component "F_COMMON"
#end

#doc
Автопометка с функцией обхода помеченных записей в порядке их пометки
#end
ObjInterface IPosMarker(IMarker);

//-----------------------------------------------------------------------------
// атрибуты

  #doc
  Номер записи в маркере в порядке пометки
  #end
  Property plPos : longint Read Write;

  #doc
  Ссылка на помеченную запись
  #end
  Property pcRec : comp    Read Write;

//-----------------------------------------------------------------------------
// индексы

  #doc
  Индекс для обхода помеченных записей в порядке их пометки
  #end
  Index ByPos = plPos;

//-----------------------------------------------------------------------------
// события

  #doc
  Событие, которое будем генерить при пометке и снятии пометки для одной записи
  #end
  Event Procedure EventMarkUnmark(abMark: boolean);

  #doc
  Это событие придет перед снятием всех пометок по "-", Если вернуть true, то Inherited::UnselectAll не отработает.
  #end
  Event Function EventUnselectAll : boolean;

end;

VipInterface PosMarker (Marker) implements IPosMarker;

Public:

  Function IModify.doInsert : word;
  Function IModify.doDelete : word;
  Procedure IMarker.UnselectAll;

end;

#end // __PosMarker_vih__
