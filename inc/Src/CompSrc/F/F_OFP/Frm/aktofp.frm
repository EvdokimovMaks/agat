//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Платежный календарь"
// Отчеты - Финансовое обязательство
//------------------------------------------------------------------------------

#doc
Отчеты - Финансовое обязательство (прототип).<br>
#end
.set name='AktOFP'
.hide
.Fields
  AktOfpNRec
// 12
  AktOFP_desgr              // Группа дескрипторов
  AktOFP_descr              // Дескриптор менеджера
  AktOFP_dInput             // Дата создания документа
  AktOFP_NoDoc              // Номер документа

  AktOFP_Group              // Группа ФОБ
  AktOFP_Svodnoe            // Сводное ФОБ
  AktOFP_Status             // Статус документа
  AktOFP_TipMoney           // Тип по валюте
  AktOFP_Purpose            // Назначение
  AktOFP_Prior              // Приоритет исполнения
  AktOFP_dDoc               // Планируемая дата погашения обязательств
  AktOFP_dFirstLast
//11
  AktDogovorName            // Договор
  DocReasonName             // Документ-основание
  AktOrg_Name               // Контрагент
  AktOFP_Direct             // Направление жвижения средств
  AktOFP_TypePlat           // Вид платежа
  AktOFP_Summa              // Сумма обязательств
  AktOFPValSimv             // Символ денежной единицы
  AktOFP_HozSumma           // Сумма фактического исполнения
  AktOFPValSimv1
  AktPodr_Name              // Центр учета
  AktCurator_FIO            // Куратор акта
  TuneBudget                // есть связь с бюджетом

  AktOfp_StBudName          // цикл по разноске по статьям
  AktOfp_StBudCO            // центр ответственности
  AktOFPBud_cVal            // валюта статьи
  AktOFPBud_Sum_FPPlan      // сумма по Регистру План
  AktOFPBud_Sum_FPRezerv    // сумма по Регистру Резерв
  AktOFPBud_Sum_FPFact      // сумма по Регистру Факт
  AktOFPBud_Sum_Free        // свободная сумма
  AktOFPBud_StBudSum        // сумма по статье
  AktOFPBud_StBudSumVal     // валюта суммы по статье
  AktOFPBud_Percent         // процент
  AktOfp_AnTypeName         // наименование аналитики статьи
  AktOfp_AnValueName        // значение аналитики статьи

.endFields
.{
^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^

.{ AktOfp_StBud CheckEnter
 ^ ^ ^ ^ ^ ^ ^ ^ ^ ^

.if AktOfp_AnaliticsTitle
.{ AktOfp_Analitics CheckEnter
 ^ ^
.}
.end

.}

.}
.endform

//*******************************************************************
#doc
Финансовое обязательство.<br>
#end
.linkform 'AktOFP01' prototype is 'AktOFP'
.nameinlist 'Финансовое обязательство'
.group 'Финансовое обязательство'
.p 50
.defo portrait
.set filler = '_'
.Fields
  AktOFP_desgr              // Группа дескрипторов
  AktOFP_descr              // Дескриптор менеджера
  AktOFP_dInput             // Дата создания документа
  AktOFP_NoDoc              // Номер документа

  AktOFP_Group              // Группа ФОБ
  AktOFP_Svodnoe            // Сводное ФОБ
  AktOFP_Status             // Статус документа
  AktOFP_TipMoney           // Тип по валюте
  AktOFP_Purpose            // Назначение
  AktOFP_Prior              // Приоритет исполнения
  AktOFP_dDoc               // Планируемая дата погашения обязательств
  AktOFP_dFirstLast

  AktDogovorName            // Договор
  DocReasonName             // Документ-основание
  AktOrg_Name               // Контрагент
  AktOFP_Direct             // Направление жвижения средств
  AktOFP_TypePlat           // Вид платежа
  AktOFP_Summa              // Сумма обязательств
  AktOFPValSimv             // Символ денежной единицы
  AktOFP_HozSumma           // Сумма фактического исполнения
  AktOFPValSimv1
  AktPodr_Name              // Центр учета
  AktCurator_FIO            // Куратор акта

  // цикл по разноске по статьям
  AktOfp_StBudName          // цикл по разноске по статьям
  AktOfp_StBudCO            // центр ответственности
  AktOFPBud_Percent         // процент
  AktOFPBud_StBudSum        // сумма по статье
  AktOFPBud_StBudSumVal     // валюта суммы по статье
  AktOFPBud_Sum_FPPlan      // сумма по Регистру План
  AktOFPBud_cVal            // валюта статьи
  AktOFPBud_StBudSum        // сумма по статье
  AktOFPBud_StBudSumVal     // валюта суммы по статье
  AktOFPBud_Sum_Free        // свободная сумма
  AktOFPBud_cVal            // валюта статьи
  AktOfp_AnTypeName         // наименование аналитики статьи
  AktOfp_AnValueName        // значение аналитики статьи

.endFields
.{

                             БФИНАНСОВОЕ ОБЯЗАТЕЛЬСТВО Б


 Группа/дескриптор  Ж@@@@@@/@@@@@@@@@@ Ж Дата создания  Ж@@@@@@@@@@@ Ж Номер  Ж@@@@@@@@@@ Ж

 Группа ФОБ   Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Сводное ФОБ  Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Статус       Ж@@@@@@@@@@@@@@@@@@@@@@@ Ж Тип по валюте  Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Назначение   Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Приоритет    Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж

 Планируемая дата погашения  Ж@@@@@@@@@@@ Ж  Интервал   Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Договор      Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Основание    Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Контрагент   Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж

 Направление  Ж@@@@@@@@@@@@@@@@@@@@@@ Ж   Вид платежа   Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Сумма        Ж&'&&&&&&&&&&&&&&& @@@@ Ж   Фактическая сумма   Ж&'&&&&&&&&&&&&&&& @@@@ Ж
 Центр ответственности  Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Куратор      Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж

.{ AktOfp_StBud CheckEnter
 Статья       Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
 Центр ответственности  Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
.{?internal; (TuneBudget = 0)
                          Процент   Ж&'&&&% Ж         Сумма   Ж&'&&&&&&&&&&&&&&& @@@@ Ж
.}
.{?internal; (TuneBudget = 1)
 Лимит        Ж&'&&&&&&&&&&&&&&& @@@@ Ж
 Потребность  Ж&'&&&&&&&&&&&&&&& @@@@ Ж
 Свободно     Ж&'&&&&&&&&&&&&&&& @@@@ Ж
.}

.if AktOfp_AnaliticsTitle
 Аналитика                               Значение аналитики
.{ AktOfp_Analitics CheckEnter
  Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж   Ж@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ж
.}

.end
.}

.}
.endform
