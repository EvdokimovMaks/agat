//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Платежный календарь"
// Множественные фильтры - UserDeskRep
//------------------------------------------------------------------------------
#include ofpMacro.vpp // mIsFlag

// -----------------------------------------------------------------------------
// значения фильтров
Function Filter_GetWord(_nFilter: word): word;
{
  Result := UserDeskRep.ResWord[20+_nFilter];
}

// -----------------------------------------------------------------------------
Function Filter_GetComp(_nFilter: word): comp;
{
  Result := UserDeskRep.ResComp[20+_nFilter];
}

// -----------------------------------------------------------------------------
Function Filter_SetWord(_nFilter: word; _Value: word) : boolean;
{
  Result := true;
  set UserDeskRep.ResWord[20+_nFilter] := _Value;
}

// -----------------------------------------------------------------------------
Function Filter_SetComp(_nFilter: word; _Value: comp) : boolean;
{
  Result := true;
  set UserDeskRep.ResComp[20+_nFilter] := _Value;
}

// -----------------------------------------------------------------------------
Function Filter_Clear(_FltPos: word) : boolean;
{
  Result := true;

  Mark2PicksFuncs.DelPickRep(_FltPos, UserDeskRep.nRec);
  Filter_SetWord(_FltPos, 0);
  Filter_SetComp(_FltPos, 0);
}

// -----------------------------------------------------------------------------
// маркер с множ.выбором - в таблицу PickRep с кодом nReport
Function MyMarker2PickRep(_MarkerName: string; _nFilter: word) : boolean;
var
  tmpWord: TNumPick;
  tmpComp: comp;
{
  Result := true;

  Mark2PicksFuncs.DelPickRep(_nFilter, UserDeskRep.nRec);
  // скопируем
  Mark2PicksFuncs.Marker2PickRep(_MarkerName, _nFilter, tmpComp, tmpWord, UserDeskRep.nRec);
  // просто чтобы обновилось поле
  set UserDeskRep.ResComp[20+_nFilter] := tmpComp;
  set UserDeskRep.ResWord[20+_nFilter] := tmpWord;
}

// -----------------------------------------------------------------------------
// наоборот
Function MyPickRep2Marker(_MarkerName: string; _nFilter: word) : boolean;
{
  Result := true;
  // скопируем
  Mark2PicksFuncs.PickRep2Marker(_MarkerName, _nFilter, UserDeskRep.ResComp[20+_nFilter], UserDeskRep.nRec);
}
