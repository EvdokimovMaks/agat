//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Платежный календарь"
// Финансовые обязательства - построение дерева
//------------------------------------------------------------------------------

#ifndef __AAKTTR_VIH__
#define __AAKTTR_VIH__

//******************************************************************************
#component "F_OFP"

//******************************************************************************
#include aTreeNew.vih

// для параметра функций
Type TAktTr = record
  cDiapSum
  , cCatZadolj
  , cPrcZadolj
  , cFpPeriodT: comp; // = cFpPeriodTU
end;

#doc
Печать: Финобязательства.<br>
#end
ObjInterface objAktTr;

  ////////////////////// ЗАПОЛНЕНИЕ ЗАПИСИ ФО //////////////////////////////////
  #doc
  Заполнение ФО по дереву.<br>
  #end
  Function AktTr_FOFillByTree(_cNode: comp; var bufAktOfp: TAktOfp): boolean;

  ///////////////// ПОСТРОЕНИЕ ВЕТКИ ДЕРЕВА ПО БУФЕРУ ФО ///////////////////////
  #doc
  Инициализация (код дерева).<br>
  #end
  Function AktTr_Init(_Code: word): boolean;
  #doc
  Деинициализация (код дерева).<br>
  #end
  Function AktTr_Done: boolean;
  #doc
  Подсчитывать все суммы.<br>
  #end
  Function AktTr_SumsCallAll(_cTreeVal: comp): boolean;
  #doc
  Проверять удовлетворение фильтру.<br>
  #end
  Function AktTr_SetCheckFilter(rTuneFO: TTuneFO): boolean;
  #doc
  Возвращает ссылку на запись.<br>
  #end
  Function AktTr_GetLevelRec(    bufAktOfp   : TAktOfp;
                                 bufClearing : TClearing;
                             var _wTable     : word;
                                 _LevelN     : word;
                                 _cStBud     : comp;
                                 _cFpCO      : comp;
                                 _cSpAttr    : comp;
                                 _rAktTr     : TAktTr
                                            ): comp;
  #doc
  Ветка по буферу ФО.<br>
  #end
  Function AktTr_BranchByBuffer( bufAktOfp    : TAktOfp;
                                 _HasStBud    : boolean;
                                 _HasClearing : boolean;
                                 _NumLevels   : word;
                                 _NumSorts    : word;
                                 _rAktTr      : TAktTr
                                             ): comp;
  #doc
  Анализ всех ФО.<br>
  #end
  Function AktTr_Loop( _HasStBud    : boolean;
                       _HasClearing : boolean;
                       _NumLevels   : word;
                       _NumSorts    : word;
                       _rAktTr      : TAktTr
                                   ): boolean;
End;

ObjInterface objAktTr01;

  #doc
  Группировка для дерева.<br>
  #end
  Function AktTr_FillTuneLevels(_cTuneLevels: comp): boolean;

End;

VipInterface iAktTr implements objAktTr, objAktTr01
  Licensed(Free);
#end //__AAKTTR_VIH__
