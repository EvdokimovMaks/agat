//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
// Табличный объект взаимодействия: "Основания документов"
//------------------------------------------------------------------------------

#ifndef __ExtTablBase_Vih__
#define __ExtTablBase_Vih__

#ifdef  ComponentVersion
#component "F_OFP"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include IModify.Vih            // Абстрактный табличный интерфейс
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Табличный объект взаимодействия: "Основания документов"
#end
ObjInterface oExtTablBase;
  Property NRec      : comp     read write; // Номер записи
  Property wDocType  : word     read write; // Тип документа системы
  Property wBaseType : word     read write; // Тип основания документа
  Property sBaseName : string   read      ; // Наименование документа

  Index TablDoc01 = wDocType, wBaseType;

  //----------------------------------------------------------------------------
  #doc
     Описание последней ошибки
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Сообщение последней ошибки
  #end
  Function RunShowError : boolean;
  //----------------------------------------------------------------------------
  #doc
    Конвертация настроек
  #end
  Procedure ConvertBaseAlg(_wDocType, _wBaseType: word);
  //----------------------------------------------------------------------------
  #doc
     Восстановить значения по умолчанию для общих настроек
  #end
  Function SetAllDefValue(_isMess: boolean): boolean;
  //----------------------------------------------------------------------------
  #doc
     Восстановить значения по умолчанию для общих настроек по документу
  #end
  Function SetDocDefValue(_wDocType: word; _isMess: boolean): boolean;
  //----------------------------------------------------------------------------
  #doc
     Восстановить значения по умолчанию для общих настроек по основанию
  #end
  Function SetBaseDefValue(_wDocType, _wBaseType: word; _isMess: boolean) : boolean;

End; // ObjInterface

//------------------------------------------------------------------------------
VipInterface ExtTablBase implements oExtTablBase, IModify
  Licensed(Free);
Public:
  Constructor Init;
  Destructor  Done;
End;

#endif//__ExtTablBase_Vih__
