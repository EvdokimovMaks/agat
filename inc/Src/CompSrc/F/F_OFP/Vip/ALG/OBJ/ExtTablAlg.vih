//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
// Табличный объект взаимодействия: "Алгоритмы"
//------------------------------------------------------------------------------

#ifndef __ExtTablAlg_Vih__
#define __ExtTablAlg_Vih__

#ifdef  ComponentVersion
#component "F_OFP"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include IModify.Vih            // Абстрактный табличный интерфейс
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Табличный объект взаимодействия: "Алгоритмы"
#end
ObjInterface oExtTablAlg;
  Property NRec     : comp   read write; // Номер записи
  Property wAlg     : word   read write; // алгоритм
  Property wBaseAlg : word   read write; // шаблон
  Property sParam   : s200   read write; // параметр типа String
  Property wParam   : word   read write; // параметр типа word
  Property cParam   : comp   read write; // параметр типа comp
  Property dParam   : date   read write; // параметр типа date
  Property sName    : string read      ; // наименование
  Property coTbl    : word   read      ; // документ - источник
  Property cHashAn  : comp   read      ; // аналитика

  Index TablUserAlg01 = NRec;
  Index TablUserAlg02 = wAlg, wBaseAlg;

  //----------------------------------------------------------------------------
  #doc
     Описание последней ошибки
  #end
  Function GetStLastError: string;
  //----------------------------------------------------------------------------
  #doc
     Сообщение последней ошибки
  #end
  Function RunShowError: boolean;
  //----------------------------------------------------------------------------
  #doc
    Описание
  #end
  Function GetLongName(var s1, s2, s3, s4, s5, s6: string): boolean;
  //----------------------------------------------------------------------------
  #doc
    КАУ по коду алгоритма
  #end
  Function GetCodeKauByAlg(wAlg: word = 0): word;
  //----------------------------------------------------------------------------
  #doc
    Добавить алгоритм "явно"
  #end
  Function AddManualAlg(wFieldAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
    Добавить алгоритм "внешний атрибут"
  #end
  Function AddExtAttrAlg(wFieldAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
    Добавить алгоритм "внешняя классификация"
  #end
  Function AddExtClassAlg(wFieldAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
    Добавить алгоритм "Разноска по книге финансовых операций"
  #end
  Function AddKfoAlg(wFieldAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
  Добавить алгоритм "Из каталога соответствий"
  #end
  Function AddSootAlg(wFieldAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
  Добавить алгоритм "Разноска на основании целевого учета"
  #end
  Function AddMTRAlg(wFieldAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
  Добавить алгоритм "Разноска на основании спецификации"
  #end
  Function AddMTRManualAlg(wFieldAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
  Добавить алгоритм "Разноска на основании проводок"
  #end
  Function AddOborotAlg(wFieldAlg: word): boolean;
  //----------------------------------------------------------------------------
  #doc
    Редактировать алгоритм
  #end
  Function EditAlg: boolean;
  //----------------------------------------------------------------------------
End; // ObjInterface

//------------------------------------------------------------------------------
VipInterface ExtTablAlg implements oExtTablAlg, IModify
  Licensed(Free);
Public:
  Constructor Init;
  Destructor  Done;
End;

#endif//__ExtTablAlg_Vih__
