//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
// Функции компоненты "Платежный календарь" доступные другим модулям
//------------------------------------------------------------------------------

#ifndef __AOFPOUT_OBJ__
#define __AOFPOUT_OBJ__

//------------------------------------------------------------------------------
#ifdef  ComponentVersion
#component "F_OFP"
#endif//ComponentVersion

//******************************************************************************
//!!D переделать consig consigb vschet vschetb vschetp vschetpb

//------------------------------------------------------------------------------
#include fintypes.vpp // TSoprHoz

//------------------------------------------------------------------------------
Type TTRq_MTO = Record
  cTRq_MTO    : TnRec;    // nRec позиции ПЛАНА
  TRq_MTO_Name: String;   // Имя позиции плана (Nпл + Дата +Nпоз .. )
  cOfp_FOb    : TnRec;    // nRec ПК.ФОб
  OFP_FOb_Name: String;   // Имя ПК.ФОб (Nфоб+Дата)
  OplData     : date;     // Дата ПК.ФОб
  Purpose     : s80;      // "Назначение"
  cCO         : TnRec;    // ссылка для подразделения (для ЦО)
  cDogovor    : TnRec;    // ссылка на договор
  cNote       : TnRec;    // ссылка на статус
  Status      : Word;     // статус ФОб
  cBaseDoc    : TnRec;    // ссылка на BaseDoc
  cStBud      : TnRec;    // ссылка на статью бюджета
  cVal        : TnRec;    // ссылка на валюту
  KursData    : date;     // дата валютного курса
  Summa       : TSumma;   // сумма
  _ContAnID   : Longint;  // контейнер аналитик
End;


//------------------------------------------------------------------------------
#doc
Функции компоненты "Платежный календарь" доступные другим модулям.<br>
#end
ObjInterface objOfpOut;
  #doc
  Проверка лицензии на модуль.<br>
  #end
  Function ExistsOfp: boolean;
  #doc
  Проверка флага "Формировать плат доки только из модуля "ПК".<br>
  #end
  Function CheckOnlyFromOfp(_TiDkGal: word): boolean;

  /////////////////// ВЗАИМОДЕЙСТВИЕ С ХОЗОПЕРАЦИЯМИ ///////////////////////////
  #doc
  Реакция на распределение SoprHoz по ДО.<br>
  #end
  Function OnAllocSoprHoz(_cSoprHoz: comp): boolean;

  #doc
  Реакция на добавление, обновление, удаление записей в таблице SoprHoz.<br>
  #end
  Function OnChangeSoprHoz(Var bufSoprHoz: TSoprHoz
                               ; _command: word
                                        ): boolean;

  #doc
  Интерфейс распределения ХозОперации по ФинОперациям.<br>
  #end
  Function RunAllocSoprHoz(bufSoprHoz: TSoprHoz): boolean;

  /////////////////////// ВЗАИМОДЕЙСТВИЕ С ДО //////////////////////////////////
  #doc
  Реакция на добавление, обновление, удаление записей в таблице BaseDoc.<br>
  #end
  Function OnChangeBaseDoc(bufBaseDoc: TBaseDoc; _command: word): boolean;

  #doc
  Интерфейс формирования ФО по ДО.<br>
  #end
  Function RunMakeFo(_DocReasonType: word; _cDocReason: comp): boolean;

  #doc
  Название меню с единственным пунктом "Формирование ФО" (Alt+F cmNal).<br>
  #end
  Function GetMakeFoMenuName: string;

  #doc
  Существует ли ФО по ук.ДО.<br>
  #end
  Function ExistsFoByDo(_DocReasonType: word; _cDocReason: comp): boolean;

  #doc
  Символ, показывающий, существует ли ФО по ук.ДО.<br>
  #end
  Function SymExistsFoByDo(_DocReasonType: word; _cDocReason: comp): string;

  #doc
  Найти связанное с пунктом плана ФОб.<br>
  #end
  function TRq_MTO_To_FOb(_cTRq_MTO:TnRec):TnRec;

  #doc
  AMD для ФОб по Плану МТО (Add_Mod_Del).<br>
  #end
  Function OnChangeTRq_MTO_Ent(Var TRq_MTO: TTRq_MTO; _command: word): boolean;
End;
//------------------------------------------------------------------------------

#endif//__AOFPOUT_OBJ__
