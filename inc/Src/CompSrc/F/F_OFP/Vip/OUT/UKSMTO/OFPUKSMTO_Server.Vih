//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
// Сервер взаимодействия : "Взаимодействие F_OFP с L_UKSMTO"
//------------------------------------------------------------------------------

#ifndef __OFPUKSMTO_Server_Vih__
#define __OFPUKSMTO_Server_Vih__

#ifdef  ComponentVersion
#Component "F_OFP"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include epOFPUKSMTO.Vih        // Точки расширения        : "Взаимодействие F_OFP с L_UKSMTO"
#include OFPUKSMTO_KatStroy.Vih // Объектный буффер обмена : "Взаимодействие F_OFP с L_UKSMTO"
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Сервер взаимодействия : "Взаимодействие F_OFP с L_UKSMTO"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface oOFPUKSMTO_Server;

  //----------------------------------------------------------------------------
  #doc
    Функция возвращает описание последней ошибки
  #end
  Function GetStLastError : string;

  //----------------------------------------------------------------------------
  #doc
    Функции для проверки наличия лицензии на L_UKSMTO
  #end
  Function GetIsUseUksMTO : boolean;

  //----------------------------------------------------------------------------
  #doc
    Функции для проверки использования L_UKSMTO специально для ДСД
  #end
  Function GetIsUseUksMTODSD : boolean;

  //----------------------------------------------------------------------------
  #doc
    Получить значения полей объекта строительства
  #end
  Function GetKatStroyFlds(
    _TblBuff : type$p_DocReq;       // буффер таблицы заявок
    _ObjBuff : oOFPUKSMTO_KatStroy  // объектный буффер обмена
  ) : boolean;

    //----------------------------------------------------------------------------
  #doc
    Получить значения полей объекта строительства и маркер подобъектов
  #end
  Function GetKatStroyFldsAndMarker(
  _TblBuff : type$p_DocReq;       // буффер таблицы заявок
  _ObjMark : TPtr;          // Маркер подобъектов строительства
  _ObjBuff : oOFPUKSMTO_KatStroy  // объектный буффер обмена
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
    Для заданного "Объекта строительства", получить значения поля "Инвестор"
  #end
  Function GetInvestor(
    _cObjStroy : comp               // ссылка на "Объекта строительства"
  ) : comp;

  //----------------------------------------------------------------------------
  #doc
    Для заданного "Объекта строительства", получить значения поля "Код проекта"
  #end
  Function GetCodProekt(
    _cObjStroy : comp               // ссылка на "Объекта строительства"
  ) : string;

  //----------------------------------------------------------------------------
  #doc
    Проверка на наличие проблемны по позиции "Заявки"
  #end
  Function GetDocReqNotCloseProblem(
    _TblBuff : type$p_DocReq        // буффер таблицы заявок
  ) : boolean;

End;

VipInterface OFPUKSMTO_Server implements oOFPUKSMTO_Server
  Licensed(Free);
Public:
  Constructor Init;
  Destructor  Done;
End;

#endif//__OFPUKSMTO_Server_Vih__
