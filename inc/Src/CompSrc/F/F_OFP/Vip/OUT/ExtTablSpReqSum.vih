//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
// Табличный объект взаимодействия: "Спецификация сводной заявки на оплату"
//------------------------------------------------------------------------------

#ifndef __ExtTablSpReqSum_Vih__
#define __ExtTablSpReqSum_Vih__

#ifdef  ComponentVersion
#component "F_OFP"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include IModify.Vih            // Абстрактный табличный интерфейс
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Табличный объект взаимодействия: "Спецификация сводной заявки на оплату"
#end
ObjInterface oExtTablSpReqSum;
  Property NRec      : comp   read write; // Номер записи
  Property wCode     : word   read write; // Код каталога документа
  Property cDoc      : comp   read write; // Ссылка на заявку
  Property wKat      : word   read write; // Код каталога
  Property cStBud    : comp   read write; // Статья бюджета
  Property cFpCO     : comp   read write; // Центр ответственности
  Property Proc      : tSumma read write; // Процент
  Property Summa     : tSumma read write; // Сумма
  Property cGrAn     : comp   read      ; // Группа аналитик
  Property cHashAn   : comp   read      ; // Хэш аналитик
  Property sHashAn   : string read      ; // Признак того, что по статье ведется аналитический учет
  Property sStBud    : string read      ; // Наименование статьи
  Property sFpCO     : string read      ; // Наименование ЦО
  Property Abbr      : s20    read      ; // Аббревиатура
  Property Sum1      : tSumma read write; // Сумма за январь
  Property Sum2      : tSumma read write; // Сумма за февраль
  Property Sum3      : tSumma read write; // Сумма за март
  Property Sum4      : tSumma read write; // Сумма за апрель
  Property Sum5      : tSumma read write; // Сумма за май
  Property Sum6      : tSumma read write; // Сумма за июнь
  Property Sum7      : tSumma read write; // Сумма за июль
  Property Sum8      : tSumma read write; // Сумма за август
  Property Sum9      : tSumma read write; // Сумма за сентябрь
  Property Sum10     : tSumma read write; // Сумма за октябрь
  Property Sum11     : tSumma read write; // Сумма за ноябрь
  Property Sum12     : tSumma read write; // Сумма за декабрь
  Property SaldoInD  : tSumma read write; // Входящая дебиторская задолженность
  Property SaldoInK  : tSumma read write; // Входящая кредиторская задолженность
  Property SaldoOutD : tSumma read write; // Исходящая дебиторская задолженность
  Property SaldoOutK : tSumma read write; // Исходящая кредиторская задолженность

  Index TablSpReqSum01 = nRec(unique);
  Index TablSpReqSum02 = wCode, cDoc, wKat, cStBud;

  //----------------------------------------------------------------------------
  #doc
     Пересчет суммы заявки
  #end
  Function GetSumReq(_cDoc: comp) : double;
  //----------------------------------------------------------------------------
  #doc
     Установить центр ответственности
  #end
  Procedure SetCO(_cDoc, _cCO: comp);
  //----------------------------------------------------------------------------
  #doc
     Распределить сумму по месяцам равномерно
  #end
  Procedure SetSumByMonth;
  //----------------------------------------------------------------------------
  #doc
    Удалить суммы по месяцам
  #end
  Procedure DelSumByMonth;
  //----------------------------------------------------------------------------
  #doc
     Обновить хэш
  #end
  Procedure SetHashAn(_cHashAn: comp);
  //----------------------------------------------------------------------------
  #doc
     Обновить статью бюджета
  #end
  Procedure SetStBud(_cStBud, _cGrAn: comp);
  //----------------------------------------------------------------------------
  #doc
     Проверка корректности спецификации заявок
  #end
  Procedure CheckSpReqSum;
  //----------------------------------------------------------------------------
  #doc
     Описание последней ошибки
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Сообщение последней ошибки
  #end
  Function RunShowError : boolean;

End; // ObjInterface

//------------------------------------------------------------------------------
VipInterface ExtTablSpReqSum implements oExtTablSpReqSum, IModify
  Licensed(Free);
Public:
  Constructor Init;
  Destructor  Done;
End;

#endif//__ExtTablSpReqSum_Vih__
