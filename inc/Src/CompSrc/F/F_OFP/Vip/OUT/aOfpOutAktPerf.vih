//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
// Исполнение финансовых операций
//------------------------------------------------------------------------------

#ifndef __AOFPOUTAKTPERF_VIH__
#define __AOFPOUTAKTPERF_VIH__

//------------------------------------------------------------------------------
#component "F_OFP"

//------------------------------------------------------------------------------
#include ofptypes.vpp
//------------------------------------------------------------------------------

#doc
Интерфейс взаимодействия: "Исполнение финансовых операций"
#end
ObjInterface objOfpOutAktPerf;

  #doc
  Сумма распределения SoprHoz по ФОП ук.направления(для ФОП2 конвертации).<br>
  #end
  Function AktPerf_AllSummaBySoprHoz(_cSoprHoz: comp; _TiDkGal: word; _Direct: word; _cVal: comp; _Date: date): double;
  #doc
  Одно исполнение для обеих ФОП.<br>
  #end
  Function AktPerf_OneForBothFop(bufClearing: TClearing; bufClearing2: TClearing): boolean;
  #doc
  Создание таблицы Исполнение с определенным типом.<br>
  #end
  Function AktPerf_Create(_cClearing: comp; _cSoprHoz: comp; _wMode: word): boolean;
  #doc
  Создание Исполнения - выбирается SoprHoz -> Clearing и AktPerf.<br>
  #end
  Function AktPerf_GetHoAndCreate(_rec: comp; _MakeByClearing: boolean): boolean;
  #doc
  Формирование исполнения (и ФОП) по ХО (ФОБ д б исполняемое).<br>
  #end
  Function AktPerf_MakeByDo(_cAktOfp: comp; bufSoprHoz: TSoprHoz; _IspDoToFop: word): comp;
  #doc
  Удаление исполнения при удалении ФОП (для ФОБ - не надо).<br>
  #end
  Function AktPerf_DeleteByFop(_cClearing: comp; _NeedChangeFop: boolean): boolean;
  #doc
  Удаление исполнения при удалении ФОБ.<br>
  #end
  Function AktPerf_DeleteByFO(_cAktOfp: comp): boolean;
  #doc
  Удаление исполнения.<br>
  #end
  Function AktPerf_DeleteP(_pAktPerf: TPAktPerf): boolean;
  #doc
  Удаление AktPerf при удалении SoprHoz.<br>
  #end
  Function AktPerf_DeleteBySoprHoz(_cSoprHoz: comp): boolean;
  #doc
  Изменение суммы исполнения.<br>
  #end
  Function AktPerf_OnChangeSummaHo(_pAktPerf: TPAktPerf; _NewSum: double; _dSoprHoz: date): boolean;
  #doc
  Изменение даты исполнения.<br>
  #end
  Function AktPerf_OnChangeDateHo(var _pAktPerf: TPAktPerf; _NewDate: date): boolean;
  #doc
  Переподцепка исполнения от старой ФОП к новой.<br>
  #end
  Function AktPerf_ReattachFop(_cOldFop: comp; _cNewFop: comp; _cNewFO: comp): boolean;
  #doc
  По F4 на AktPerf.<br>
  #end
  Function AktPerf_EditDoc(_cSoprHoz: comp): boolean;
End;

//------------------------------------------------------------------------------
VipInterface iOfpOutAktPerf implements objOfpOutAktPerf
  Licensed(Free);
Public:
  Constructor Init;
  Destructor  Done;
End;
//------------------------------------------------------------------------------
#end //__AOFPOUTAKTPERF_VIH__
