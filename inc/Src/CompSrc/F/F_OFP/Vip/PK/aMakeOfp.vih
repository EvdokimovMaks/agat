//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Платежный календарь"
// построение ПК
//------------------------------------------------------------------------------

#ifndef __AMAKEOFP_VIH__
#define __AMAKEOFP_VIH__

//******************************************************************************
#ifdef ComponentVersion
#component "F_OFP"
#end

//******************************************************************************
#doc
Построение ПК.<br>
#end
ObjInterface objMakeOFP;
  #doc
  N сумм по N отчета и модели.<br>
  #end
  Function GetNSums(_nReport: word; _cModel: comp): word;
  #doc
  Инициализация построителя по настройке.<br>
  #end
  Function BeforeBuild(_nReport: word; _rTunePK: TTunePK): boolean;
  #doc
  Пересчет сумм после построения дерева.<br>
  #end
  Function AfterBuild(_nReport: word; _cModel: comp): boolean;
  #doc
  Построение дерева по Фоп (предвар.иниц.).<br>
  #end
  Function BuildTree(_nReport: word; _cModel: comp; _cModelCompare: comp): boolean;
  #doc
  Основная функция пересчета сальдо.<br>
  #end
  Function RecountSaldoForPeriod(_Code: word; _cModel: comp; _cVal: comp): boolean;
  #doc
  Добавление сумм к уровням дерева.<br>
  #end
  Function Sums_AddToTree(_nReport: word; _SumsNpp: word): boolean;
  #doc
  Перестраивает ветку, возвращает ссылку на перестроенную ветку.<br>
  #end
  Function RebuidTreeByMarker(_nReport: word; _RecountComp: boolean; _Level: word; _isLeaf: word; _marker: TPtr): comp;
  #doc
  Записывает в маркер доки группы ук.типа (возвр. кол-во записей).<br>
  #end
  Function GetGroupDocs(_marker: TPtr; _cNode: comp; _RecType: word): word;
  #doc
  Записывает в маркер помеченные записи.<br>
  #end
  Function GetMarkerDocs(_markTree: TPtr; _markDocs: TPtr; _RecType: word): word;
  #doc
  Записывает в маркер помеченные записи, если нет - записи группы (или текущую).<br>
  #end
  Function GetMarkerOrGroupDocs(_markTree: TPtr; _markDocs: TPtr; _cNode: comp; _RecType: word): word;
  #doc
  Удаление ветки по группе.<br>
  #end
  Function Branch_DelByGroup(_cNode: comp; var _retNode: comp): boolean;
  #doc
  То же, но по маркеру - записи ук.типа (маркер удаляет).<br>
  #end
  Function Branch_DelByMarker(_markTree: TPtr; _RecType: word): boolean;
  #doc
  Удаление веток по помеченным записям, если нет - по группе.<br>
  #end
  Function Branch_DelByMarkerOrGroup(_markTree: TPtr; _cNode: comp; _RecType: word): boolean;
  #doc
  Помещает ветку в маркер (для пометки уровня).<br>
  #end
  Function Branch_ToFromMarker(_Code: word; _cNode: comp; _marker: TPtr; _ToFrom: boolean): boolean;
  #doc
  Построенное дерево.<br>
  #end
  Procedure SeeTestTree(_sTitle: string);
  #doc
  Пересчитанные остатки.<br>
  #end
  Procedure SeeTestWindow(_sTitle: string);

End;

VipInterface iMakeOFP implements objMakeOFP
  Licensed(Free);
#end  // __AMAKEOFP_VIH__
