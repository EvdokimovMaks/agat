//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
//  Заявки
//------------------------------------------------------------------------------

#ifndef __ADocReq_VIH__
#define __ADocReq_VIH__

// -----------------------------------------------------------------------------
#ifdef ComponentVersion
#component "F_OFP"
#end
// -----------------------------------------------------------------------------
// Заявки
#doc
Заявки.<br>
#end
Private ObjInterface objDocReq;

  //                                  ERROR
  Function GetLastError( Var _LastError: TLastError ): Boolean;
  ///////////////////// СВЯЗЬ С ФИНПЛАНИРОВАНИЕМ ///////////////////////////////
  #doc
  Просмотр бюджета по заявке.<br>
  #end
  Function DocReq_SeeBudget( bufDocReq: TDocReq): boolean;
  #doc
  Аналитика только данного документа.<br>
  #end
  Function DocReq_GetDocAnaliticByBuf(bufDocReq: TDocReq; var _contId: longint): boolean;
  #doc
  Заполнение контейнера аналитик по буферу Заявки.<br>
  #end
  Function DocReq_GetAnaliticByBuf(bufDocReq: TDocReq; var _contId: longint): boolean;

  ////////////////////// РАЗЛИЧНЫЕ НАЗВАНИЯ ////////////////////////////////////
  Function DocReq_GetPeriodName(n: word): string;
  #doc
  Название заявки для отображения в иерархии.<br>
  #end
  Function DocReq_GetName(_NoDoc: string; _DocType: word): string;
  #doc
  То же по nRec.<br>
  #end
  Function DocReq_GetNameRec(_cDocReq: comp): string;
  #doc
  Название модуля, из которого сформирована Заявка на расходование средств.<br>
  #end
  Function DocReq_GetNameRecType(_RecType: word): string;
  #doc
  Заголовок окна ред. Заявки на расходование средств.<br>
  #end
  Function DocReq_CheckTitle(_isFromOfp: boolean; _Modul: word; _DocType: word; var retTitle: string): boolean;

  /////////////////////// РАЗЛИЧНЫЕ АТРИБУТЫ ///////////////////////////////////
  #doc
  Тип заявки по умолчанию.<br>
  #end
  Function DocReq_GetDefDocType(_Direct: word): word;
  #doc
  Направление денег для заявок.<br>
  #end
  Function DocReq_GetDirect(_DocType: word): word;
  #doc
  В заявке можно указать ПС.<br>
  #end
  Function DocReq_HasPlatMean(_DocType: word): boolean;
  #doc
  Тип ПС.<br>
  #end
  Function DocReq_GetMeanType(_cRec: comp): word;
  #doc
  ПС.<br>
  #end
  Function DocReq_GetPlatMean(_DocType: word; _cRec: comp): comp;
  #doc
  Тип ПС, ПС и тип документа для ФОБ, сформированного на основании заявки.<br>
  #end
  Function DocReq_GetPSbyDocReq(_cRec: comp; var _MeanType: word; var _cPlatMean: comp; var _TiDkGal: word): boolean;
  #doc
  Можно ли формировать ФО по заявке.<br>
  #end
  Function DocReq_CanMakeFO(bufDocReq: TDocReq; _NeedMessage: word): boolean;

  ///////////////////// СОЗДАНИЕ И УДАЛЕНИЕ ////////////////////////////////////
  #doc
  Обновление SoprHoz (для ТФО - разноски по статьям бюджета).<br>
  #end
  Function DocReq_MakeSoprHoz(bufDocReq: TDocReq): boolean;
  #doc
  Сразу после добавления любой записи.<br>
  #end
  Function DocReq_AfterInsert(bufDocReq: TDocReq): boolean;
  #doc
  Заполение буфера.<br>
  #end
  Procedure DocReq_Fill(var bufDocReq: TDocReq; _DocType, _Modul: word);
  #doc
  можно ли создавать заявку (с сообщением или без)
  #end
  Function DocReq_CanSetDefault(_OfpDocType: word; _NeedMessage: boolean): boolean;
  #doc
  можно ли редактировать заявку (с сообщением или без).<br>
  #end
  Function DocReq_CanEdit(bufDocReq: TDocReq; _CheckStatus, _NeedMessage: boolean): boolean;
  #doc
  Можно ли удалять заявку (с сообщением или без).<br>
  #end
  Function DocReq_CheckDelete(bufDocReq: TDocReq; _NeedMessage: boolean): boolean;
  #doc
  Удаление ук.заявки (c сообщением).<br>
  #end
  Function DocReq_Delete_Eval_01( _cDocReq: comp; _isMessage: word): boolean;
  #doc
  Удаление ук.заявки (без сообщения).<br>
  #end
  Function DocReq_Delete(_cDocReq: comp): boolean;
  #doc
  Удаление всех заявок по ДО (без сообщения).<br>
  #end
  Function DocReq_DeleteByBase(_cBase: comp): boolean;

  //////////////////////// РАЗЛИЧНЫЕ ОПЕРАЦИИ //////////////////////////////////
  #doc
  проверка превышает ли сумма заявки расчетную сумму.<br>
  #end
  Function DocReq_CheckSumReq(bufDocReq: TDocReq; var _ReqSumma: double) : boolean;
  #doc
  Количество ФО, которые будут сформированы по такой заявке.<br>
  #end
  Function DocReq_PeriodNumFO(_dBegPlat, _dEndPlat: date; _wPeriod: word; _DaysOffset: word): longint;
  #doc
  Формирование ФО по Периодической заявке.<br>
  #end
  Function DocReq_PeriodMakeFO(_cDocReq: comp; _rMaket: TMaketAktOfp): boolean;
  #doc
  Формирование ФО (настройка, что делать с существующими ФО).<br>
  #end
  Function DocReq_MakeFO(_cDocReq: comp; _rMaket: TMaketAktOfp): boolean;
  #doc
  Изменение статуса.<br>
  #end
  Function DocReq_SetStatus(_cDocReq: comp; _New_Status: word; _New_cNote: comp; _comment: string[80] = ''): boolean;
  #doc
  Изменение приоритета.<br>
  #end
  Function DocReq_SetPrior(_cDocReq: comp; _NewPrior: word): boolean;
  #doc
  Перенос планируемой даты оплаты.<br>
  #end
  Function RecChangeDatePlat(_cDocReq : comp; dateBeg, dateEnd : date): boolean;
  #doc
  Освобождение ссылок на объекты, провоцирующие циклические зависимости объектов.<br>
  #end
  Function FreeCrossVipRef : boolean;

End;

VipInterface iDocReq implements objDocReq
  Licensed(Free);
// -----------------------------------------------------------------------------
#end //__ADocReq_VIH__
