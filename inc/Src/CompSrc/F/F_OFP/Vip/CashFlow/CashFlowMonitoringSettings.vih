//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - модуль "Платежный календарь"
// Визуальный интерфейс : "Настройки отчета БДДС"
//------------------------------------------------------------------------------

#ifndef __CashFlow_Monitoring_Settings_Vih__
#define __CashFlow_Monitoring_Settings_Vih__

#ifdef ComponentVersion
#component "F_OFP"
#end

#doc
  Визуальный интерфейс : "Настройки отчета БДДС"
#end
ObjInterface ICashFlowMonitoringSettings;

//------------------------------------------------------------------------------
#doc
  Проверить пользовательские настройки отчета
#end
Function CheckUserSettings: boolean;

//------------------------------------------------------------------------------
#doc
  Проверить настройки отчета
#end
Function CheckReportSettings: boolean;

//------------------------------------------------------------------------------
#doc
  Проверить системные настройки отчета
#end
Function CheckSystemSettings(
  _checkOnlyGeneral: boolean; // Проверять только общие настройки
  _needMessage     : boolean  // Требуется ли сообщение
): boolean;


//------------------------------------------------------------------------------
#doc
  Типовая форма БДДС
#end
Function GetCashFlowTF: comp;

//------------------------------------------------------------------------------
#doc
 Открыть окно текущих настроек отчета
#end
Function ShowShortSettingsWindow: boolean;

//------------------------------------------------------------------------------
#doc
 Маркер периодов планирования
#end
Function GetPeriodMarker(
  _periodMarker: TPtr // Маркер периодов
): boolean;

//------------------------------------------------------------------------------
#doc
  Тип периода бюджета
#end
Function GetBudgetPeriodType: comp;

//------------------------------------------------------------------------------
#doc
 Валюта отчета
#end
Function GetCurrency: comp;

//------------------------------------------------------------------------------
#doc
 Формировать денежный поток
#end
Function GetIfShowCashFlow: boolean;

//------------------------------------------------------------------------------
#doc
 Формировать план
#end
Function GetIfFormPlan: boolean;

//------------------------------------------------------------------------------
#doc
 Формировать прогноз
#end
Function GetIfFormPrediction: boolean;

//------------------------------------------------------------------------------
#doc
 Формировать с учетом исполнения
#end
Function GetIfUsePerformance: boolean;

//------------------------------------------------------------------------------
#doc
 Формировать с учетом факта
#end
Function GetIfUseFact: boolean;

//------------------------------------------------------------------------------
#doc
 Выводить ПС
#end
Function ShowPayingMeans: word;

//------------------------------------------------------------------------------
#doc
 Статьи дохода (ссылка на ТФ)
#end
Function IncomeStBud: comp;

//------------------------------------------------------------------------------
#doc
 Статьи расхода (ссылка на ТФ)
#end
Function ChargeStBud: comp;

//------------------------------------------------------------------------------
#doc
 Выводить факт
#end
Function GetIfShowFact: boolean;

//------------------------------------------------------------------------------
#doc
 Выводить ЦО
#end
Function GetIfShowCO: boolean;

//------------------------------------------------------------------------------
#doc
 Список ЦО БДДС
#end
Procedure GetCOList(_COMarker: TPtr);

//------------------------------------------------------------------------------
#doc
 Вариант бюджета
#end
Function GetBudVar: comp;

//------------------------------------------------------------------------------
#doc
 Стадия бюджета
#end
Function GetBudStage: string;

//------------------------------------------------------------------------------
#doc
 Дата по которой берется курс валют
#end
Function GetDateOfValCourse: date;

//------------------------------------------------------------------------------
#doc
 Статья БДДС, на которой хранятся плановые остатки на начало периода
#end
Function GetBeginingPlanStBud: comp;

//------------------------------------------------------------------------------
#doc
 Статья БДДС, на которой хранятся плановые остатки на конец периода
#end
Function GetEndPlanStBud: comp;

//------------------------------------------------------------------------------
#doc
 Строка с формулой для вычисления отклонения
#end
Function GetDeviationAlg: string;

//------------------------------------------------------------------------------
#doc
 Строка с формулой для вычисления критичности отклонения
#end
Function GetCriticalDeviationAlg: string;

//------------------------------------------------------------------------------
#doc
 Путь на файл XLT-шаблона
#end
Function GetXLTFileName: string;

//------------------------------------------------------------------------------
#doc
 Показывать окно "Параметры отчета" при запуске интерактивного отчета
#end
Function GetIfShowSettingsWindow: boolean;

//------------------------------------------------------------------------------
#doc
 Обновить значения настроек
#end
Procedure RefreshSettings(
  _fillReportSettings: boolean // Заполнять настройки отчета
);

//------------------------------------------------------------------------------
#doc
 Проверить идентичность начального и конечного периодов.
 Получить название начального и конечного периода.
#end
Function CheckIsOnePeriod(
  var _beginPeriodName: string; // Наименование начального периода
  var _endPeriodName  : string  // Наименование конечного периода
): boolean;

//------------------------------------------------------------------------------
#doc
 Получить значение начального периода
#end
Function GetBeginPeriod: comp;

//------------------------------------------------------------------------------
#doc
 Получить значение конечного периода
#end
Function GetEndPeriod: comp;

End;

VipInterface CashFlowMonitoringSettings implements ICashFlowMonitoringSettings
  Licensed(ofp);
public:
#doc
  Инициализировать интерфейс
#end
  Constructor Init;

//------------------------------------------------------------------------------
#doc
  Завершить работу с интерфейсом
#end
  Destructor  Done;
End;


#endif// __CashFlow_Monitoring_Settings_Vih__
