//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Бухгалтерская отчетность"
// Интерфейс редактирования : "Дополнительные разделы декларации по НДС"
//------------------------------------------------------------------------------

#ifndef __eTaxNDSDRM_Vih__
#define __eTaxNDSDRM_Vih__

#Component "F_PAT"

//==============================================================================
#doc
Интерфейс редактирования : "Дополнительные разделы декларации по НДС"
#end
ObjInterface IeTaxNDSDRM;  //#region ObjInterface

  //============================================================================
  //#region PROPERTY
  //------------------------------------------------------------------------------
  Property dRepBeg : date  read write;  // Дата начала диапазона данных              
  Property dRepEnd : date  read write;  // Дата окончания диапазона данных           
  Property dDopBeg : date  read write;  // Дата начала диапазона данных доп. книги   
  Property dDopEnd : date  read write;  // Дата окончания диапазона данных доп. книги
  //#endregion PROPERTY
  //****************************************************************************


  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  Function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывести сообщения о последней ошибки выполнения
  #end
  Function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region FIELDS
  //----------------------------------------------------------------------------
  #doc
     Получить каталог расположения TMP файлов
  #end
  Function GetTmpFileDir           : string ;

  //----------------------------------------------------------------------------
  #doc
     Получить каталог расположения XSD файлов
  #end
  Function GetXSDFileDir           : string ;

  //----------------------------------------------------------------------------
  #doc
     Получить значение поля "Номер корректировки"
  #end
  Function GetNomKorr              : word   ;

  //----------------------------------------------------------------------------
  #doc
     Получить режимы нумерации
  #end
  Function GetDopRazdelNumber_Mode : word   ;
  //----------------------------------------------------------------------------
  #doc
     Получить начальный номер "Раздел 8"
  #end
  Function GetR08BegNpp            : LongInt;
  //----------------------------------------------------------------------------
  #doc
     Получить начальный номер "Раздел 8 Приложение 1"
  #end
  Function GetR8DBegNpp            : LongInt;
  //----------------------------------------------------------------------------
  #doc
     Получить начальный номер "Раздел 9"
  #end
  Function GetR09BegNpp            : LongInt;
  //----------------------------------------------------------------------------
  #doc
     Получить начальный номер "Раздел 9 Приложение 1"
  #end
  Function GetR9DBegNpp            : LongInt;

  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 8"
  #end
  Function GetR08_SumNDSVsego : double;

  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  Function GetR09_SumRub18Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  Function GetR09_SumRub10Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  Function GetR09_SumRub00Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  Function GetR09_SumNDS18Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  Function GetR09_SumNDS10Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  Function GetR09_SumNDSNoVsego : double;
  //#endregion FIELDS
  //****************************************************************************


  //============================================================================
  //#region СЕРВИС
  //----------------------------------------------------------------------------
  #doc
     Определить является ли ИНН для индивидуального предпринимателя, или для юр лица
  #end
  Function GetIsINNForIP(
    _sINN    : string   // ИНН
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить первичный идентификатор файла
  #end
  Function GetPrimeFileID : string;

  //----------------------------------------------------------------------------
  #doc
     Получить имя файла из полного пути на файл
  #end
  Function GetFileFromFilePath(
    _sFilePath : string  // полный путь на файл
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить директорию из полного пути на файл
  #end
  Function GetDir_FromFilePath(
    _sFilePath : string  // полный путь на файл
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить имя файла без расширения
  #end
  Function GetFileNameWithoutExtention(
    _sFileName : string  // наименование файла
  ) : string;
  //#endregion СЕРВИС
  //****************************************************************************


  //============================================================================
  //#region РАБОТА С ДАННЫМИ РАЗДЕЛОВ
  //----------------------------------------------------------------------------
  #doc
     Запустить создание данных разделов
  #end
  Function RunCreateData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить сохранение данных разделов
  #end
  Function RunSaveData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить загрузку данных разделов
  #end
  Function RunLoadData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить обновление данных по текущему XML файлу
  #end
  Function RunReLoadData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить проверку данных разделов
  #end
  Function RunCheckData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить расчет данных разделов
  #end
  Function RunReCalcData : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить менеджер дополнительных разделов
  #end
  Function RunDopRazdelManager : boolean;

  //----------------------------------------------------------------------------
  #doc
     Добавить описание ошибки проверки
  #end
  Function AddCheckErrNote(
    _wRazdel : word  ;  // идентификатор раздела
    _FldPath : string;  // путь на поле
    _ErrNote : string   // описание ошибки
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Проверить контрольную сумму ИНН
  #end
  Function CheckINNCS(
    _sINN    : string   // ИНН
  ) : boolean;
  //#endregion РАБОТА С ДАННЫМИ РАЗДЕЛОВ
  //****************************************************************************

  //============================================================================
  //#region CROSSVIPREF
  //----------------------------------------------------------------------------
  #doc
     Освобождение ссылок на объекты, провоцирующие циклические зависимости объектов
  #end
  Function FreeCrossVipRef : boolean;
  //#endregion CROSSVIPREF
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface eTaxNDSDRM implements IeTaxNDSDRM
#Licensed_Free
Parameters (
  sXMLFilePath : string   // Полный путь на файл
);
Public: //#region Public
  Constructor Init;
  Destructor  Done;
End; //#endregion Public
//******************************************************************************

#endif//__eTaxNDSDRM_Vih__
