//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Бухгалтерская отчетность"
// Интерфейс редактирования : "Дополнительные разделы декларации по НДС 2017"
//------------------------------------------------------------------------------

#ifndef __v002_eTaxNDSDRM_Vih__
#define __v002_eTaxNDSDRM_Vih__

#Component "F_PAT"

//==============================================================================
#doc
Интерфейс редактирования : "Дополнительные разделы декларации по НДС 2017"
#end
Private ObjInterface Iv002_eTaxNDSDRM;  //#region ObjInterface

  //============================================================================
  //#region PROPERTY
  //------------------------------------------------------------------------------
  Property dRepBeg : date  read write;  // Дата начала диапазона данных              
  Property dRepEnd : date  read write;  // Дата окончания диапазона данных           
  Property dDopBeg : date  read write;  // Дата начала диапазона данных доп. книги   
  Property dDopEnd : date  read write;  // Дата окончания диапазона данных доп. книги
  //#endregion PROPERTY
  //****************************************************************************


  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывести сообщения о последней ошибки выполнения
  #end
  function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region FIELDS
  //----------------------------------------------------------------------------
  #doc
     Получить каталог расположения TMP файлов
  #end
  function GetTmpFileDir           : string ;

  //----------------------------------------------------------------------------
  #doc
     Получить каталог расположения XSD файлов
  #end
  function GetXSDFileDir           : string ;

  //----------------------------------------------------------------------------
  #doc
     Получить значение поля "Номер корректировки"
  #end
  function GetNomKorr              : word   ;

  //----------------------------------------------------------------------------
  #doc
     Получить режимы нумерации
  #end
  function GetDopRazdelNumber_Mode : word   ;
  //----------------------------------------------------------------------------
  #doc
     Получить начальный номер "Раздел 8"
  #end
  function GetR08BegNpp            : LongInt;
  //----------------------------------------------------------------------------
  #doc
     Получить начальный номер "Раздел 8 Приложение 1"
  #end
  function GetR8DBegNpp            : LongInt;
  //----------------------------------------------------------------------------
  #doc
     Получить начальный номер "Раздел 9"
  #end
  function GetR09BegNpp            : LongInt;
  //----------------------------------------------------------------------------
  #doc
     Получить начальный номер "Раздел 9 Приложение 1"
  #end
  function GetR9DBegNpp            : LongInt;

  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 8"
  #end
  function GetR08_SumNDSVsego : double;

  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  function GetR09_SumRub18Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  function GetR09_SumRub10Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  function GetR09_SumRub00Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  function GetR09_SumNDS18Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  function GetR09_SumNDS10Vsego : double;
  //----------------------------------------------------------------------------
  #doc
     Получить сумму налога всего из "Раздел 9"
  #end
  function GetR09_SumNDSNoVsego : double;
  //#endregion FIELDS
  //****************************************************************************


  //============================================================================
  //#region СЕРВИС
  //----------------------------------------------------------------------------
  #doc
     Определить является ли ИНН для индивидуального предпринимателя, или для юр лица
  #end
  function GetIsINNForIP(
    _sINN    : string   // ИНН
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить первичный идентификатор файла
  #end
  function GetPrimeFileID : string;

  //----------------------------------------------------------------------------
  #doc
     Получить имя файла из полного пути на файл
  #end
  function GetFileFromFilePath(
    _sFilePath : string  // полный путь на файл
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить директорию из полного пути на файл
  #end
  function GetDir_FromFilePath(
    _sFilePath : string  // полный путь на файл
  ) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить имя файла без расширения
  #end
  function GetFileNameWithoutExtention(
    _sFileName : string  // наименование файла
  ) : string;
  //#endregion СЕРВИС
  //****************************************************************************


  //============================================================================
  //#region РАБОТА С ДАННЫМИ РАЗДЕЛОВ
  //----------------------------------------------------------------------------
  #doc
     Запустить создание данных разделов
  #end
  function RunCreateData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить сохранение данных разделов
  #end
  function RunSaveData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить загрузку данных разделов
  #end
  function RunLoadData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить обновление данных по текущему XML файлу
  #end
  function RunReLoadData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить проверку данных разделов
  #end
  function RunCheckData : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запустить расчет данных разделов
  #end
  function RunReCalcData : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить менеджер дополнительных разделов
  #end
  function RunDopRazdelManager : boolean;

  //----------------------------------------------------------------------------
  #doc
     Добавить описание ошибки проверки
  #end
  function AddCheckErrNote(
    _wRazdel : word  ;  // идентификатор раздела
    _FldPath : string;  // путь на поле
    _ErrNote : string   // описание ошибки
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Проверить контрольную сумму ИНН
  #end
  function CheckINNCS(
    _sINN    : string   // ИНН
  ) : boolean;
  //#endregion РАБОТА С ДАННЫМИ РАЗДЕЛОВ
  //****************************************************************************

  //============================================================================
  //#region CROSSVIPREF
  //----------------------------------------------------------------------------
  #doc
     Освобождение ссылок на объекты, провоцирующие циклические зависимости объектов
  #end
  function FreeCrossVipRef : boolean;
  //#endregion CROSSVIPREF
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface v002_eTaxNDSDRM implements Iv002_eTaxNDSDRM
#Licensed_Free
Parameters (
  sXMLFilePath : string   // Полный путь на файл
);
Public: //#region Public
  constructor Init;
  destructor  Done;
End; //#endregion Public
//******************************************************************************

#endif//__v002_eTaxNDSDRM_Vih__
