//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Интерфейс : "Сервер мониторинга"
//------------------------------------------------------------------------------

#ifndef __FpExtMonitoringServer_Vih__
#define __FpExtMonitoringServer_Vih__

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Интерфейс: "Сервер мониторинга"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface IFpExtMonitoringServer;

//------------------------------------------------------------------------------
#doc
  Проверить установлен ли монопольный доступ
  Возвращаемые параметры:
    out AdminUserId - идентификатор пользователя, установившего запись
#end
  function GetIsExclusiveAccess(out AdminUserId: comp) : boolean;
  
//------------------------------------------------------------------------------
#doc
  Установить/Отменить монопольный доступ
  Передаваемые параметры:
    _Value - true - установить монопольный доступ, false - отменить
#end
  function SetIsExclusiveAccess(_Value: boolean) : boolean;
  
//------------------------------------------------------------------------------
#doc
  Проверить возможно ли редактирование данных
#end
  function GetIsCanEditData     : boolean;
  
//------------------------------------------------------------------------------
#doc
  Проверить возможно ли редактирование метаданных
#end
  function GetIsCanEditMetaData : boolean;
  
//------------------------------------------------------------------------------
#doc
  Начать сессию редактирования
  Передаваемые параметры:
    _sIntType - тип + название вызывающего интерфейса
#end
  function BegEditSession(_sIntType: string): boolean;
  
//------------------------------------------------------------------------------
#doc
  Закончить сессию редактирования
  Передаваемые параметры:
    _sIntType - тип + название вызывающего интерфейса
#end
  function EndEditSession(_sIntType: string): boolean;

//------------------------------------------------------------------------------
#doc
  Получить данные о последней произошедшей ошибке
#end
  function GetStLastError       : string;

//------------------------------------------------------------------------------
#doc
  Возвращает код причины, из-за которой отказано в доступе (в случае ошибки возвращает -1)
  Передаваемые параметры:
    _InhibitOfMetaData - узнать причину запрета редактирования метаданных
    true  - вернет значение для метаданных
    false - вернет значение для данных
#end
  function GetReasonOfInhibit(_InhibitOfMetaData: boolean): word;

//------------------------------------------------------------------------------
#doc
  Возвращает название причины отказа в доступе
  Передаваемые параметры:
  _ReasonOfInhibit - код причины отказа в доступе
#end
  function GetNameOfInhibitReason(_ReasonOfInhibit: word): string;

//------------------------------------------------------------------------------
#doc
  Возвращает название причины отказа для конкретного интерфейса
  Можно применять в сообщениях
  Передаваемые параметры:
  interfaceName - название интерфейса с префиксом
#end
  function GetProhibitionReasonForMessage(interfaceName: string): string;
End;

VipInterface FpExtMonitoringServer implements IFpExtMonitoringServer
#Licensed_Free;
public:
#doc
  Инициализировать интерфейс
#end
  constructor Init;

//------------------------------------------------------------------------------
#doc
  Завершить работу с интерфейсом
#end
  destructor  Done;
End;


#endif//__FpExtMonitoringServer_Vih__
