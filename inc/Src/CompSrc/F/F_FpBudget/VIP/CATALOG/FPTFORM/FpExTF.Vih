//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Интерфейс взаимодействия : "Типовые формы бюджетов"
//------------------------------------------------------------------------------

#ifndef _ExtFpTForm_Included_
#define _ExtFpTForm_Included_

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

//------------------------------------------------------------------------------
#doc
Интерфейс взаимодействия : "Типовые формы бюджетов"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface iExtFpTForm;

//==============================================================================
//                               FIELDS (Get)
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "Наименование"
#end
function GetName            (_cTForm : comp) : string;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "последний номер аналитики 1-й оси"
#end
function GetLastNpp1        (_cTForm : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "есть аналитика"
#end
function GetHaveAnMean      (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "типовая форма корректна"
#end
function GetCorrect         (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "автосинхронизация"
#end
function GetAutoSynch       (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "ускоренная загрузка аналитик"
#end
function GetLocalLoadAnMean (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "XXL-метаданные"
#end
function GetXXLMetaData     (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "XXL-данные"
#end
function GetXXLData         (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "Не привязывать аналитику к агрегатам"
#end
function GetAgrAnalitLoad   (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства "Удалять прежнюю информацию"
#end
function GetIsDelAxis       (_cTForm : comp) : boolean;


//==============================================================================
//                               FIELDS (Set)
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "типовая форма корректна"
#end
function SetCorrect         (_cTForm : comp; _Value : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "автосинхронизация"
#end
function SetAutoSynch       (_cTForm : comp; _Value : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "ускоренная загрузка аналитик"
#end
function SetLocalLoadAnMean (_cTForm : comp; _Value : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "Не привязывать аналитику к агрегатам"
#end
function SetAgrAnalitLoad   (_cTForm : comp; _Value : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Установить значения свойства "Удалять прежнюю информацию"
#end
function SetIsDelAxis       (_cTForm : comp; _Value : boolean) : boolean;


//==============================================================================
//                                  LOCK
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Проверка заблокирована ли типовая форма для использования при редактировании бюджета
#end
function IsLockUseTForm(_cTForm : comp; _isMessage : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Проверка заблокирована ли типовая форма для редактирования
#end
function IsLockEditTForm(_cTForm : comp; _isMessage : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Проверка заблокирована ли типовая форма
#end
function IsLockTForm(_cTForm : comp; _isMessage : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Блокировка типовой формы для использования при редактировании бюджета
#end
function LockUseTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Блокировка типовой формы для редактирования
#end
function LockEditTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Разблокировка типовой формы для использования при редактировании бюджета
#end
function UnLockUseTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Разблокировка типовой формы для редактирования
#end
function UnLockEditTForm(_cTForm : comp) : boolean;

//==============================================================================
//                                AUTORASP
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function IsStBudRasp             (_cTForm : comp) : boolean;
function IsPeriodRasp            (_cTForm : comp) : boolean;
function IsAnalitRasp            (_cTForm : comp) : boolean;
function IsAnalitRaspTFormAgr    (_cTForm : comp) : boolean;
function IsAnalitRaspTFormLeaf   (_cTForm : comp) : boolean;
function IsAnalitAutoRasp        (_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
function GetAutoAlgEditAgrMode   (_cTForm : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
function GetHandleAlgEditAgrMode (_cTForm : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
function IsMessageEditAgr        (_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Копирование настроек типовой формы
#end
function CopyAutoRaspFields(_cDTForm : comp; _cSTForm : comp) : boolean;

//==============================================================================
//                                FORMAT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить количество знаков после запятой
#end
function GetCellDecimal(_cTForm : comp) : word;

//==============================================================================
//                                TPerView
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Загрузить из БД список видимых типов периодов
#end
function LoadTFormTPTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Загрузить из БД список аналитик синхронизации
#end
function LoadTFormKAUTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Сохранить в БД список видимых типов периодов
#end
function SaveTFormTPTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Сохранить в БД список аналитик синхронизации
#end
function SaveTFormKAUTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Удалить из БД список видимых типов периодов
#end
function DelTFormTPTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Удалить из БД список аналитик синхронизации
#end
function DelTFormKAUTune(_cTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Скопировать список видимых типов периодов из одной типовой формы в другую
#end
function CopyTFormTPTune(_cDTForm : comp; _cSTForm : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Скопировать список аналитик синхронизации из одной типовой формы в другую
#end
function CopyTFormKAUTune(_cDTForm : comp; _cSTForm : comp) : boolean;


//==============================================================================
//                                SYNCHTFORM
//------------------------------------------------------------------------------
#doc
   Выполнить синхронизацию значений аналитик типовой формы
#end
function SynchTForm(
  _cTForm   : comp;      // ссылка на типовую форму
  _wSynSRC  : word;      // источник данных (см. FpSynTF.Inc)
  _wDelMode : word;      // режим удаления прежних данных (см. FpSynTF.Inc)
  _wKodReg  : word;      // код регистра
  _cFilter  : comp;      // ссылка на фильтр
  _cBudVar  : comp;      // копия бюджета
  _FltSBMID : TPtr = 0   // список статей фильтра
) : boolean;

//------------------------------------------------------------------------------
#doc
   Запустить интерфейс синхронизации значений аналитик типовой формы
#end
function RunSynchTForm(
  _cTForm   : comp;      // ссылка на типовую форму
  _wSynSRC  : word;      // источник данных (см. FpSynTF.Inc)
  _wKodReg  : word;      // код регистра
  _cBudVar  : comp;      // копия бюджета
  _FltSBMID : TPtr = 0   // список статей фильтра
) : boolean;

//------------------------------------------------------------------------------
#doc
   Синхронизация иерархии
#end
function SynchHier(_cTForm : comp; _wMode : word) : boolean;

//==============================================================================
//                                  STBUD
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Удаление статьи из типовой формы
#end
function DelStBudInAxis   (_cTForm : comp; _cStBud : comp; _IsReCalcTForm : boolean) : boolean;
//------------------------------------------------------------------------------
#doc
   Удаление статьи из типовой формы
#end
function DelAllStBudInAxis(_cTForm : comp; _MID : TPtr; _IsReCalcTForm : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Входит ли статья _cStBud в типовую форму _cTForm<br>
     Просматривать:<br>
     _wMode = 0 - все используемые статьи<br>
     _wMode = 1 - видимые статьи<br>
#end
function StBudInTForm(
    _cTForm : comp;
    _cStBud : comp;
    _wMode  : word
) : boolean;

//==============================================================================
//                                  COMMON
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
function GetAllAxis(
    _cTForm : comp;
var _cAxis1 : comp;
var _cAxis2 : comp
) : boolean;

//------------------------------------------------------------------------------
#doc
   Пересчитать типовую форму
#end
function ReCalcTForm(_cTForm : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить аналитику типовой формы
#end
function GetAnTForm(_cTForm : comp; _CAn : TPtr) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить типовую форму
#end
function DelTForm(_cTForm : comp; _isMessage : boolean) : boolean;

//==============================================================================
//                                  DIALOG
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает наименование маркера
#end
function GetMarkerName : string;

//------------------------------------------------------------------------------
#doc
   Запуск интерфейса редактирования
#end
function RunAllTForm(
    _wIntMode : word;    // режим
    _cNodeTop : comp;    // вершина
var _cGetRec  : comp     // типовая форма
) : LongInt;

//------------------------------------------------------------------------------
#doc
   Запуск интерфейса доступных типовых форм
#end
function RunAvTForm(
    _wIntMode : word;    // режим
var _cCO      : comp;    // ЦО
var _cTForm   : comp     // типовая форма
) : LongInt;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface vExtFpTForm implements iExtFpTForm
#Licensed_Free
;

#endif //_ExtFpTForm_Included_
