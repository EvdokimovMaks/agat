//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Интерфейс взаимодействия : "Аналитика бюджетирования"
//------------------------------------------------------------------------------

#ifndef __ExtFpBudAn_Vih__
#define __ExtFpBudAn_Vih__

#component "F_FpBudget"

//------------------------------------------------------------------------------
#include FpBudAn.Def    // define "Аналитика бюджетирования"
#include FpMeanTF.Inc   // все типы "Аналитика бюджетирования"
//------------------------------------------------------------------------------

//==============================================================================
#doc
Интерфейс взаимодействия : "Аналитика бюджетирования"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface IExtFpBudAn;  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает описание последней ошибки
  #end
  function GetStLastError : string;
  //----------------------------------------------------------------------------
  #doc
     Вывод сообщения последней ошибки
  #end
  function RunShowError : boolean;
  //#endregion ERROR
  //****************************************************************************

  //============================================================================
  //#region CASH
  //----------------------------------------------------------------------------
  #doc
  <brief>Получить режим кэширования</brief>
     Получить режим кэширования
     <ul>
     <li> FpNo_Cash     - кэширование отключено<br>
     <li> FpNormal_Cash - обычный режим кэширования<br>
     </ul>
  #end
  function GetCashMode : word;

  //----------------------------------------------------------------------------
  #doc
  <brief>Установить режим кэширования</brief>
     Установить режим кэширования
     <ul>
     <li> _wMode - режим кэширования
       <ul>
       <li> FpNo_Cash     - кэширование отключено<br>
       <li> FpNormal_Cash - обычный режим кэширования<br>
       </ul>
     </ul>
  #end
  function SetCashMode(_wMode : word) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Перегрузить кэш
  #end
  function ReInitCash : boolean;
  //#endregion CASH
  //****************************************************************************


  //============================================================================
  //#region АТРИБУТЫ АНАЛИТИКИ
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика иерархической
  #end
  function IsAnHier         (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Включен ли режим "Виртуальные агрегаты"
  #end
  function IsVirtualAgrMode (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Включен ли режим "Автосинхронизация"
  #end
  function IsAnAutoSynch    (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика бюджетируемой
  #end
  function IsAnBud          (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика пользовательской
  #end
  function IsAnUser         (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика синонимом
  #end
  function IsAnSyn          (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить аналитику родителя синонима
  #end
  function GetAnSynBase     (_wAn : word) : word;

  //----------------------------------------------------------------------------
  #doc
     Получить наименование
  #end
  function GetAnName        (_wAn : word) : string;
  //#endregion АТРИБУТЫ АНАЛИТИКИ
  //****************************************************************************


  //============================================================================
  //#region АТРИБУТЫ ЗНАЧЕНИЙ АНАЛИТИКИ БЮДЖЕТИРОВАНИЯ
  //----------------------------------------------------------------------------
  #doc
     Получить значения аналитики
  #end
  function GetMeanName         (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить вышестоящее значения аналитики
  #end
  function GetMeanNode         (_wAn: word; _cAn: comp) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить код значения аналитики
  #end
  function GetMeanCode         (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить аббревиятуру значения аналитики
  #end
  function GetMeanAbbr         (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить унарный оператор значения аналитики
  #end
  function GetMeanUO           (_wAn: word; _cAn: comp) : word;
  //----------------------------------------------------------------------------
  #doc
     Получить агрегат значения аналитики
  #end
  function GetMeanAgr          (_wAn: word; _cAn: comp) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить свойство "лист" значения аналитики
  #end
  function GetMeanIsLeaf       (_wAn: word; _cAn: comp) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить свойство "виртуальный агрегат" значения аналитики
  #end
  function GetMeanIsVirtualAgr (_wAn: word; _cAn: comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить свойство "базовый агрегат" значения аналитики
  #end
  function GetMeanBaseAgrMean  (_wAn: word; _cAn: comp) : comp;

  //----------------------------------------------------------------------------
  #doc
     Получить свойство "собственные данные агрегата" значения аналитики
  #end
  function GetMeanIsAgrOwnData (_wAn: word; _cAn: comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Получить свойство "владелец" значения аналитики
  #end
  function GetMeanOwnerAgrMean (_wAn: word; _cAn: comp) : comp;
  //#endregion АТРИБУТЫ ЗНАЧЕНИЙ АНАЛИТИКИ БЮДЖЕТИРОВАНИЯ
  //****************************************************************************


  //============================================================================
  //#region FPAGREGAT
  //----------------------------------------------------------------------------
  #doc
     Есть ли агрегат в контейнере
  #end
  function IsMeanAgrInContAn(_CAn : TPtr) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Есть ли агрегат в HasAn
  #end
  function IsMeanAgrInHashAn(_cHasAn : comp) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запуск функции проверки корректности
  #end
  function CheckAgrKauMeanHash(_cHashAn : comp) : comp;
  //#endregion FPAGREGAT
  //****************************************************************************


  //============================================================================
  //#region АТРИБУТЫ ЗНАЧЕНИЙ АНАЛИТИКИ ГАЛАКТИКИ
  //----------------------------------------------------------------------------
  #doc
     Получить наименование значения аналитики
  #end
  function GetGalMeanName   (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить вышестоящего значения аналитики
  #end
  function GetGalMeanNode   (_wAn: word; _cAn: comp) : comp;
  //----------------------------------------------------------------------------
  #doc
     Получить код значения аналитики
  #end
  function GetGalMeanCode   (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить аббревиатуру значения аналитики
  #end
  function GetGalMeanAbbr   (_wAn: word; _cAn: comp) : string;
  //----------------------------------------------------------------------------
  #doc
     Получить свойство "лист" значения аналитики
  #end
  function GetGalMeanIsLeaf (_wAn: word; _cAn: comp) : boolean;
  //#endregion АТРИБУТЫ ЗНАЧЕНИЙ АНАЛИТИКИ ГАЛАКТИКИ
  //****************************************************************************

  //============================================================================
  //#region GALAGREGAT
  //----------------------------------------------------------------------------
  #doc
     Является ли аналитика иерархической
  #end
  function IsGalAnHier(_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Есть ли агрегат в контейнере
  #end
  function IsGalMeanAgrInContAn(_CAn : TPtr) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Есть ли агрегат в HasAn
  #end
  function IsGalMeanAgrInHashAn(_cHasAn : comp) : boolean;
  //#endregion GALAGREGAT
  //****************************************************************************


  //============================================================================
  //#region MODIFY
  //----------------------------------------------------------------------------
  #doc
     Вставка значения аналитики бюджетирования
  #end
  function InsAnMean (
      _cMain : comp;
      _wAn   : word;
      _cAn   : comp;
  var _cRec  : comp
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Поиск значения аналитики бюджетирования
  #end
  function FindAnMean(
      _cMain : comp;
      _wAn   : word;
      _cAn   : comp;
  var _cRec  : comp
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Вставка значения аналитики бюджетирования
  #end
  function InsAnBud (_wAn : word; _cAn : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Найти для заданного значения аналитики, соответствующее значение в аналитике бюджетирования
  #end
  function FindAnBud(_wAn : word; _cAn : comp) : comp;

  //----------------------------------------------------------------------------
  #doc
     Существуют ли в бюджетировании значения по заданной аналитике
  #end
  function IsAnyAnBudExists (_wAn : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Существуют ли заданное значение аналитики
  #end
  function IsAnMeanExist    (_cMain : comp; _wAn : word; _cAn : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Реальное ли заданное значение аналитики
  #end
  function IsRealAnMeanExist(_cMain : comp; _wAn : word; _cAn : comp) : boolean;
  //#endregion MODIFY
  //****************************************************************************


  //============================================================================
  //#region COMMON
  //----------------------------------------------------------------------------
  #doc
     Запуск функции проверки корректности ссылок на вышестоящие
  #end
  function CheckNode(_cRec : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Запуск функции синхронизации иерархии
  #end
  function ReSetGalNode(_cRec : comp) : boolean;
  //#endregion COMMON
  //****************************************************************************


  //============================================================================
  //#region MAKEMARKER
  //----------------------------------------------------------------------------
  #doc
     Построить список подчиненных значений
  #end
  function MakeMarkerAnBud(
    _MID   : TPtr;  // ID маркера
    _wAn   : word;     // код аналитики
    _cAn   : comp      // значение аналитики
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Построить список листовых подчиненных значений
  #end
  function MakeMarkerLeafAnBud(
    _MID   : TPtr;  // ID маркера
    _wAn   : word;     // код аналитики
    _cAn   : comp      // значение аналитики
  ) : boolean;
  //#endregion MAKEMARKER
  //****************************************************************************


  //============================================================================
  //#region DIALOG
  //----------------------------------------------------------------------------
  #doc
     Возвращает имя маркера интерфейса каталога бюджетов
  #end
  function GetMarkerName : string;
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает наименование маркера значений аналитики Бюджетирования
  #end
  function GetBudAnMarkerName(_wAn : word) : string;
  //----------------------------------------------------------------------------
  #doc
     Функция возвращает наименование маркера значений аналитики Галактики
  #end
  function GetGalAnMarkerName(_wAn : word) : string;

  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса выбора значений аналитики Галактики
  #end
  function RunViewGalAnMean(
      _wIntMode : word;    // режим (выбор/просмотр: cgiNo, cgiPick,...)
      _wAn      : word;    // КАУ
  var _cAn      : comp     // значение выбранной аналитики
  ) : LongInt;
  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса просмотра
  #end
  function RunViewSimpleGalAnMean(
      _wIntMode : word;    // режим (выбор/просмотр: cgiNo, cgiPick,...)
      _wAn      : word;    // КАУ
  var _cAn      : comp     // значение выбранной аналитики
  ) : LongInt;

  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса выбора значение аналитики бюджетирования
  #end
  function RunViewBudAnMean(
      _wIntMode : word;    // режим (выбор/просмотр: cgiNo, cgiPick,...)
      _wAn      : word;    // КАУ
  var _cAn      : comp     // значение выбранной аналитики
  ) : LongInt;

  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса выбора КАУ
  #end
  function RunViewBudAn(
      _wIntMode : word;    // Режим запуска (выбор/просмотр: cgiNo, cgiPick,...)
  var _wAn      : word     // Код аналитики
  ) : LongInt;
  //#endregion DIALOG
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface vExtFpBudAn implements IExtFpBudAn
#Licensed_Free;
Public:
  constructor Init;
  destructor  Done;
End;
//******************************************************************************


#endif  // __ExtFpBudAn_Vih__
