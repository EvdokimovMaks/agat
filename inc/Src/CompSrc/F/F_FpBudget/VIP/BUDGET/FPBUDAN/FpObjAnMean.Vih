//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Базовый объект : "Значения аналитик бюджетирования"
//------------------------------------------------------------------------------

#ifndef __OBJFPANMEAN_VIH
#define __OBJFPANMEAN_VIH

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif //ComponentVersion

#include FpBudAn.Def      // define "Аналитика бюджетирования"
#ifndef __FpPBudAn_Inc__
#define __FpPBudAn_Inc__
#include FpPBudAn.Inc     // типы данных для PAS
#endif//__FpPBudAn_Inc__

//------------------------------------------------------------------------------
#doc
Базовый объект : "Значения аналитик бюджетирования"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
ObjInterface IObjFpAnMean;

//==============================================================================
//                                    ERROR
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки<br>
#end
function GetStLastError : string;

//==============================================================================
//                                    RIGHT
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Разрешено ли редактирование таблицы<br>
#end
function CanEditTbl(
  _wMessage : word
) : boolean;

//==============================================================================
//                                    MODIFY
//------------------------------------------------------------------------------
#doc
   Инициализация сессии модификации
#end
function BegInsSession : boolean;

//------------------------------------------------------------------------------
#doc
   Закрытие сессии модификации
#end
function EndInsSession : boolean;

//------------------------------------------------------------------------------
#doc
   Вставка записи по буферу таблицы<br>
#end
function InsP(var _Buff : type$p_fpMeanTF) : integer;

//------------------------------------------------------------------------------
#doc
   Изменение записи по буферу таблицы<br>
#end
function UpdP(var _Buff : type$p_fpMeanTF) : integer;

//------------------------------------------------------------------------------
#doc
   Удаление записи по буферу таблицы<br>
#end
function DelP(    _Buff : type$p_fpMeanTF) : integer;

//==============================================================================
// АТРИБУТЫ ЗНАЧЕНИЙ АНАЛИТИКИ ГАЛАКТИКИ
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить значения свойства по коду и Nrec-у значения аналитики
#end
function GetGalMeanName(_wAn: word; _cAn: comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по коду и Nrec-у значения аналитики
#end
function GetGalMeanNode(_wAn: word; _cAn: comp) : comp;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по коду и Nrec-у значения аналитики
#end
function GetGalMeanCode(_wAn: word; _cAn: comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по коду и Nrec-у значения аналитики
#end

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по коду и Nrec-у значения аналитики
#end
function GetGalMeanAbbr(_wAn: word; _cAn: comp) : string;

//==============================================================================
//                                   FIELDS
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
function BufSetNode(var _Buff : type$p_fpMeanTF; _Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetCalcIsLeaf(_Buff : type$p_fpMeanTF) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по коду и Nrec-у значения аналитики
#end
function GetCalcIsLeaf(_cMain : comp; _wAn : word; _cAn : comp) : boolean;

//------------------------------------------------------------------------------
#undef mDeclGetFun
#declare mDeclGetFun(_Fun,_Type)
function Buf#_Fun(_Buff : type$p_fpMeanTF) : #_Type;
function #_Fun(_wAn : word; _cAn : comp) : #_Type;
#end // mDeclGetFun
//------------------------------------------------------------------------------
#undef mDeclSetFun
#declare mDeclSetFun(_Fun,_Type)
function Buf#_Fun(var _Buff : type$p_fpMeanTF; _Value : #_Type) : boolean;
function #_Fun(_wAn : word; _cAn : comp; _Value : #_Type) : boolean;
#end // mDeclSetFun
//------------------------------------------------------------------------------
#mDeclGetFun(GetName             , string )
#mDeclGetFun(GetNode             , comp   )
#mDeclGetFun(GetCode             , string )
#mDeclGetFun(GetAbbr             , string )
#mDeclGetFun(GetUO               , word   )
#mDeclGetFun(GetAgr              , comp   )
#mDeclGetFun(GetIsLeaf           , boolean)

#mDeclGetFun(GetIsVirtualAgr     , boolean)
#mDeclGetFun(GetBaseAgrMean      , comp   )
#mDeclGetFun(GetBaseAgrMeanName  , string )

#mDeclGetFun(GetIsAgrOwnData     , boolean)
#mDeclGetFun(GetOwnerAgrMean     , comp   )
#mDeclGetFun(GetOwnerAgrMeanName , string )

#mDeclGetFun(GetIsSysDeleted     , boolean)

//------------------------------------------------------------------------------
#mDeclSetFun(SetName         , string )
#mDeclSetFun(SetCode         , string )
#mDeclSetFun(SetAbbr         , string )
#mDeclSetFun(SetUO           , word   )
#mDeclSetFun(SetIsLeaf       , boolean)
#mDeclSetFun(SetIsVirtualAgr , boolean)

//------------------------------------------------------------------------------
function MakeFldRecord(_wAn : word; _cAn : comp; var _Buff : TPasBudAnMeanFld) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по коду и Nrec-у значения аналитики
#end
function GetFldRecord (_wAn : word; _cAn : comp) : TPasBudAnMeanFld;


//==============================================================================
//                                   COMMON
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Вставка значения аналитики бюджетирования
#end
function InsAnMean (_cMain : comp; _wAn : word; _cAn : comp; var _cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Поиск значения аналитики бюджетирования
#end
function FindAnMean(_cMain : comp; _wAn : word; _cAn : comp; var _cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Создать значение аналитики бюджетирования
#end
function InsAnBud  (_wAn : word; _cAn : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Найти для заданного значения аналитики, соответствующее значение в аналитике бюджетирования
#end
function FindAnBud (_wAn : word; _cAn : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Существуют ли в бюджетировании значения по заданной аналитике
#end
function IsAnyAnBudExists (_wAn : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Существуют ли значения по заданной аналитике
#end
function IsAnMeanExist    (_cMain : comp; _wAn : word; _cAn : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Существуют ли заданное значение аналитики
#end
function IsRealAnMeanExist(_cMain : comp; _wAn : word; _cAn : comp) : boolean;

//==============================================================================
// VIRTUALAGR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Запуск функции проверки корректности<br>
#end
function CheckAllVirtualAgr(_wAn : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Построение виртуальных агрегатов
#end
function MakeVirtualAgrByAgr(
    _cOldAgr : comp;
var _cNewAgr : comp
) : boolean;

//------------------------------------------------------------------------------
#doc
   Построение виртуальных агрегатов
#end
function MakeVirtualAgrByMarker(
    _wAn     : word;
    _cNode   : comp;
    _MID     : TPtr;
var _cNewAgr : comp
) : boolean;

//==============================================================================
// CHECKTBL
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Запуск функции восстановления наименований для аналитики Галактики
#end
function ReSetGalName (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск функции восстановления аббревиятуры для аналитики Галактики
#end
function ReSetGalAbbr (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск функции восстановления вышестоящий для аналитики Галактики
#end
function ReSetGalNode (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск функции проверки вышестоящий для аналитики Бюджетирования
#end
function CheckNode    (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск функции проверки листов для аналитики Бюджетирования
#end
function CheckIsLeaf  (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск функции проверки корректности иерархический атрибутов
#end
function CheckHierAnAttr(_wAn : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск функции восстановления наименований для аналитики Галактики
#end
function ReSetAllGalNode(_wAn : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск функции восстановления кода на уровне для аналитики Галактики
#end
function RecAllLevelInd (_cMain : comp; _wAn : word; _cNode : comp) : boolean;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End; // IObjFpAnMean

VipInterface ObjFpAnMean implements IObjFpAnMean
#Licensed_Free
;

#endif  // __OBJFPANMEAN_VIH
