//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Библиотека функций : "Блокировка данных бюджета"
//------------------------------------------------------------------------------

#ifndef _FpL5Val_Vih__
#define _FpL5Val_Vih__

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#include FpLockVal.Inc       // типы данных объекта "Блокировка данных бюджета"
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Библиотека функций : "Блокировка данных бюджета"
#end
Private ObjInterface iObjFpLockValues;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
function GetStLastError : string;
//------------------------------------------------------------------------------
#doc
   Вывод сообщения последней ошибки
#end
function ShowMessageLastError : boolean;
//------------------------------------------------------------------------------
#doc
   Функция возвращает имя пользователя заблокировавшего данные
#end
function GetLastLockUserName : string;
//------------------------------------------------------------------------------


//==============================================================================
//                                 COMMON
//------------------------------------------------------------------------------
#doc
   Копирование параметров блокировки
#end
function CopyLockParam(
    _SLockParam : TFpLockLaluesParam;
var _DLockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------


//==============================================================================
//                                SINGLE WORK
//------------------------------------------------------------------------------
#doc
   Возможно ли использовать данные
#end
function GetIsMayUseValues(
  _LockParam : TFpLockLaluesParam
) : boolean;

//------------------------------------------------------------------------------
#doc
   Заблокировать данные
#end
function LockValues(
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Снять блокировку данных
#end
function UnLockValues(
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------


//==============================================================================
//                               SESSION WORK
//------------------------------------------------------------------------------
#doc
   Добавить в список блокировку
#end
function Session_AddLock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Добавить в список активную блокировку
#end
function Session_AddALock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Добавить в список пассивную блокировку
#end
function Session_AddPLock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;

//------------------------------------------------------------------------------
#doc
   Добавить в список листовую блокировку
#end
function Session_AddLeafLock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Добавить в список листовую активную блокировку
#end
function Session_AddLeafALock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;
//------------------------------------------------------------------------------
#doc
   Добавить в список листовую пассивную блокировку
#end
function Session_AddLeafPLock(
  _SessionID : LongInt;
  _LockParam : TFpLockLaluesParam
) : boolean;

//------------------------------------------------------------------------------
#doc
   Возможно ли использовать данные
#end
function Session_IsMayUse(
  _SessionID  : LongInt;
  _TimeOut    : comp;
  _wMessage   : word
) : boolean;

//------------------------------------------------------------------------------
#doc
   Заблокировать данные
#end
function Session_TryLock(
  _SessionID : LongInt
) : boolean;
//------------------------------------------------------------------------------
#doc
   Заблокировать данные
#end
function Session_GuidedTryLock(
  _SessionID : LongInt;
  _TimeOut   : comp;
  _wMessage  : word
) : boolean;
//------------------------------------------------------------------------------
#doc
   Снять блокировку данных
#end
function Session_TryUnLock(
  _SessionID : LongInt
) : boolean;

//------------------------------------------------------------------------------
#doc
   Начало сессии блокировки данных
#end
function Session_Begin : LongInt;
//------------------------------------------------------------------------------
#doc
   Завершение сессии блокировки данных
#end
function Session_End(
  _SessionID : LongInt
) : boolean;
//------------------------------------------------------------------------------


//==============================================================================
//                                  DIALOG
//------------------------------------------------------------------------------
#doc
   Запуск интерфейса просмотра блокировок
#end
function RunViewSemaphor : boolean;
//------------------------------------------------------------------------------


//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End; // ObjInterface

VipInterface ObjFpLockValues implements iObjFpLockValues
#Licensed_Free;


#endif//_FpL5Val_Vih__
