//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Интерфейс редактирования : "Параметры редактирования бюджета"
//------------------------------------------------------------------------------

#ifndef __BudETit_Vih__
#define __BudETit_Vih__

#component "F_FpBudget"

//------------------------------------------------------------------------------
#doc
Интерфейс редактирования : "Параметры редактирования бюджета"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface iEditBudEditTitle;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
function GetStLastError : string;
//------------------------------------------------------------------------------
#doc
   Вывод сообщения последней ошибки
#end
function RunShowError : boolean;
//******************************************************************************


//==============================================================================
//                                 INIT-DONE
//******************************************************************************
//------------------------------------------------------------------------------
#doc
   Инициализация параметров интерфейса
#end
function InitParam(
  _wBudMode   : word;   // Тип бюджета:
                        //   cgiBudget_GetSingle - одиночный бюджета
                        //   cgiBudget_GetArg    - агрегированный бюджет
                        //   cgiBudget_GetArg    - консолидированный бюджет
  _wRunMode   : word;   // Режим запуска:
                        //   0 - просто титл бюджета
                        //   1 - редактирование титла бюджета
  _cGetBudget : comp;   // Бюджет
  _cGetBudVar : comp    // Копия бюджета
) : boolean;
//******************************************************************************


//==============================================================================
//                                 FIELDS
//******************************************************************************
//------------------------------------------------------------------------------
#doc
   Получить наименование бюджета
#end
function GetBudName : string;

//------------------------------------------------------------------------------
#doc
   Получить стадию бюджета
#end
function GetStage : string;

//------------------------------------------------------------------------------
#doc
   Получить наименование варианта бюджета
#end
function GetBudVariantName : string;

//------------------------------------------------------------------------------
#doc
   Получить наименование копии бюджета
#end
function GetBudVarName : string;

//------------------------------------------------------------------------------
#doc
   Получить наименование валюты бюджета
#end
function GetValName : string;

//------------------------------------------------------------------------------
#doc
   Получить режим редактирования
#end
function GetEditMode : word;

//------------------------------------------------------------------------------
#doc
   Получить режим синхронизации
#end
function GetSynchMode : word;

//------------------------------------------------------------------------------
#doc
   Получить режим загрузки бюджета
#end
function GetBudMode : word;

//------------------------------------------------------------------------------
#doc
   Получить ссылку на типовую форму
#end
function GetTForm : comp;

//------------------------------------------------------------------------------
#doc
   Получить ссылку на бюджет
#end
function GetBudget : comp;

//------------------------------------------------------------------------------
#doc
   Получить ссылку на копию бюджета
#end
function GetBudVar : comp;

//------------------------------------------------------------------------------
#doc
   Получить код регистра бюджета
#end
function GetKodReg : word;

//------------------------------------------------------------------------------
#doc
   Получить ссылку на валюту бюджета
#end
function GetVal : comp;

//------------------------------------------------------------------------------
#doc
   Получить значение режима валюты
#end
function GetValMode : boolean;

//------------------------------------------------------------------------------
#doc
   Получить значение режима прогнозного курса
#end
function GetForecastMode : word;

//------------------------------------------------------------------------------
#doc
   Получить ссылку на вариант валюты бюджета
#end
function GetValVariant : comp;

//------------------------------------------------------------------------------
#doc
   Получить ссылку на вариант расчета бюджета
#end
function GetAlgVariant : comp;

//------------------------------------------------------------------------------
#doc
   Установить режим редактирования бюджета
#end
function SetEditMode(_Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить режим синхронизации бюджета
#end
function SetSynchMode(_Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить ссылку на типовую форму
#end
function SetTForm(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить ссылку на бюджет
#end
function SetBudget(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить ссылку на ЦО бюджета
#end
function SetBudCO(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить ссылку на период бюджета
#end
function SetBudPeriod(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить ссылку на копию бюджета
#end
function SetBudVar(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить код регистра бюджета
#end
function SetKodReg(_Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить ссылку на валюту бюджета
#end
function SetVal(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значение режима прогнозного курса
#end
function SetForecastMode(_Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значение варианта валюты бюджета
#end
function SetValVariant(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значение варианта расчета бюджета
#end
function SetAlgVariant(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установлен ли прогнозный курс
#end
function isForecastMode : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
function SetColor(_Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Можно ли в принципе редактивраоть данные копии бюджета
#end
function CanEditBudVarValues(
  _cBudVar     : comp;
  _wKodReg     : word;
  _cValVariant : comp;
  _cAlgVariant : comp
) : boolean;
//******************************************************************************


//==============================================================================
//                                 EVENT
//******************************************************************************
//------------------------------------------------------------------------------
#doc
   Событие при запуске меню
#end
Event function Event_RunMenu : boolean;
//------------------------------------------------------------------------------
#doc
   Выполнение команды меню
#end
Event function Event_PutCommand(_Command : word) : boolean;
//------------------------------------------------------------------------------
#doc
   Событие при установке бюджета
#end
Event function Event_SetBudget(_wBudMode : word; _cBudget : comp; _cBudVar : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Событие при установке копии бюджета
#end
Event function Event_SetBudVar(_Value : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Событие при установке регистра учета бюджета
#end
Event function Event_SetKodReg(_Value : word) : boolean;
//------------------------------------------------------------------------------
#doc
   Событие при установке варианта бюджета
#end
Event function Event_SetAlgAndVal : boolean;


//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End; // ObjInterface

VipInterface EditBudEditTitle implements iEditBudEditTitle
#Licensed_Free Parameters (
  wBudMode : word      // Тип бюджета:
                       //   cgiBudget_GetSingle - одиночный бюджета
                       //   cgiBudget_GetArg    - агрегированный бюджет
                       //   cgiBudget_GetArg    - консолидированный бюджет
; wRunMode : word      // Режим запуска:
                       //   0 - просто титл бюджета
                       //   1 - редактирование титла бюджета
; cGetBudget : comp    // Бюджет
; cGetBudVar : comp    // Копия бюджета
);


#endif //__BudETit_Vih__
