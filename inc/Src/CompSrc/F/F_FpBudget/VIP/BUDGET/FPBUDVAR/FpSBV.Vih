//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Интерфейс редактирования : "Стадия бюджетного процесса"
//------------------------------------------------------------------------------

#ifndef _EditStageFpBudVar_Included_
#define _EditStageFpBudVar_Included_

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Интерфейс редактирования : "Стадия бюджетного процесса"
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования
#end
#IntPrivate ObjInterface tEditStageFpBudVarObjInterface;

//==============================================================================
//                                 INIT-DONE
//------------------------------------------------------------------------------
#doc
   Инициализация параметров интерфейса
#end
function InitParam(
  _wRunMode  : word;
  _cCurArea   : comp;
  _cCurBudget : comp;
  _cCurVar    : comp;
  _sCurStage  : string;
  _sCurDescr  : string;
  _wCurMode   : word
) : boolean;

//------------------------------------------------------------------------------
#doc
   Проверка корректности задания
#end
function CheckAllSet : boolean;
//******************************************************************************

//==============================================================================
//                                 FIELDS
//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
function GetArea : comp;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
function GetVariant : comp;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
function GetStage : string;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
function GetDescr : string;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства
#end
function GetIsActiveCopy : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
function SetArea(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
function SetBudget(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
function SetVariant(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
function SetStage(_Value : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
function SetDescr(_Value : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
function SetIsMayActiveCopy(_Value : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства
#end
function SetCanEdit(_Value : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить текущую справку
#end
function SetIHelp(_TypeHelpContextID : #__TypeHelpContextID__) : boolean;

//------------------------------------------------------------------------------
#doc
   Проверка видимости полей интерфейса
#end
procedure CheckFieldsState;
//******************************************************************************

//==============================================================================
//                                 EVENT
//------------------------------------------------------------------------------
#doc
   Событие интерфейса
#end
Event procedure Event_GetPrev;

//------------------------------------------------------------------------------
#doc
   Событие интерфейса
#end
Event procedure Event_GetNext;

//------------------------------------------------------------------------------
#doc
   Событие интерфейса
#end
Event procedure Event_Insert;

//------------------------------------------------------------------------------
#doc
   Событие интерфейса
#end
Event procedure Event_Delete;

//------------------------------------------------------------------------------
#doc
   Событие интерфейса
#end
Event function Event_SetArea(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Событие интерфейса
#end
Event function Event_SetVariant(_Value : comp) : boolean;

//------------------------------------------------------------------------------
#doc
   Событие интерфейса
#end
Event function Event_SetStage(_Value : string) : boolean;
//******************************************************************************

End;

VipInterface EditStageFpBudVar implements tEditStageFpBudVarObjInterface
#Licensed_Free

Parameters (
  wRunMode   : word   // режим
                      // 0 - создание новой копии бюджеты (scVarStageDescr)
                      // 1 - редактирование ст.бюдж. процесса (scStage)
                      // 2 - просто выбор (scVarStage)
                      // 3 - просто выбор, без кнопок (scVarStageNoButton)
                      // 4 - создание новой копии бюджеты, без кнопок (scVarStageDescrNoButton)
; cGetArea   : comp   // обл видимости
; cGetBudget : comp   // бюджет
; cGetVar    : comp   // Вариант бюджета
; sGetStage  : string // стадия бюджета
; sGetDescr  : string // Дескриптор пользователя
; wGetMode   : word   // Активная ли копия
                      // wGetMode = 1 Активная копия

);

#endif  // _EditStageFpBudVar_Included_
