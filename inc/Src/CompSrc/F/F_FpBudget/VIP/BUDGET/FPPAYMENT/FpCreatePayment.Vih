//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Базовый объект : "Формирования платежных документов"
//------------------------------------------------------------------------------
              
#ifndef __FpCreatePayment_Vih__
#define __FpCreatePayment_Vih__

#component "F_FpBudget"

//------------------------------------------------------------------------------
#include FpPaymentTempl.Inc     // типы/константы сущности
#include FpObjPaymentTempl.Map  // мапирование таблицы
//------------------------------------------------------------------------------
Type TFpCreatePaymentRunMode = record
  isPreView : boolean;
end;
Type TFpCreatePaymentEMailMode = record
  IsSendEMail : boolean;
  wSendMode   : word;
end;
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Базовый объект : "Формирования платежных документов"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iObjFpCreatePayment;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки
#end
function GetStLastError : string;
//------------------------------------------------------------------------------
#doc
   Вывод сообщения последней ошибки
#end
function RunShowError : boolean;

//==============================================================================
//                                   RUN
//------------------------------------------------------------------------------
#doc
   Инициализация сессии работы
#end
function InitAll : boolean;
//------------------------------------------------------------------------------
#doc
   Закрытие сессии работы 
#end
function DoneAll : boolean;

//------------------------------------------------------------------------------
#doc
   Инициализация сессии работы алгоритма
#end
function InitAlgTune(
  _cTune       : comp; 
  _cBudTPer    : comp; 
  _cBudCO      : comp; 
  _wKodReg     : word;
  _cBudVariant : comp;
  _sBudStage   : string;
  _dtBudBeg    : date;
  _dtBudEnd    : date;
  _rcRunMode   : TFpCreatePaymentRunMode;
  _rcEMailMode : TFpCreatePaymentEMailMode
) : boolean;
//------------------------------------------------------------------------------
#doc
   Закрытие сессии работы алгоритма
#end
function DoneAlgTune : boolean;

//------------------------------------------------------------------------------
#doc
   Запуск функции проверки корректности
#end
function CheckAlg : boolean;
//------------------------------------------------------------------------------
#doc
   Запуск алгоритма на выполнение
#end
function RunAlg   : boolean;

//------------------------------------------------------------------------------
#doc
   Получить значение свойства
#end
function GetKolRecount : LongInt;

//------------------------------------------------------------------------------
#doc
   Запуск окна просмотра сформированных документов
#end
function RunViewPaymentDoc : boolean;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface ObjFpCreatePayment implements iObjFpCreatePayment
#Licensed_Free
;

#endif//__FpCreatePayment_Vih__



