//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Визуальный интерфейс : "Агрегация и декомпозиция бюджетов"
//------------------------------------------------------------------------------

#ifndef __FpBudAgrDec_Vih__
#define __FpBudAgrDec_Vih__

#component "F_FpBudget"

//------------------------------------------------------------------------------
#include FpObjBudCopy.Vih    // Типы данных и константы объекта копирования бюджетов
#include FpObjDefModel.Vih   // Базовый объект: Инициализация параметров модели операции
//------------------------------------------------------------------------------

//==============================================================================
#doc
Визуальный интерфейс : "Агрегация и декомпозиция бюджетов"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface IFpBudgetAggrDecomp;  //#region ObjInterface

  //============================================================================
  //#region ERROR
  //----------------------------------------------------------------------------
  #doc
     Получить описание последней ошибки выполнения
  #end
  function GetStLastError : string;
  //#endregion ERROR
  //****************************************************************************


  //============================================================================
  //#region INIT
  //----------------------------------------------------------------------------
  #doc
     Инициализировать параметры интерфейса
  #end
  function InitParam(
    _wRunMode : word   // 0 - агрегация; 1 - декомпозиция
  ) : boolean;
  //#endregion INIT
  //****************************************************************************


  //============================================================================
  //#region COMMON
  //----------------------------------------------------------------------------
  #doc
     Проверить корректность задания
  #end
  function CheckAllSet  : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запустить интерфейс на выполнение
  #end
  function RunOperation : boolean;

  //----------------------------------------------------------------------------
  #doc
     Установить имя лог файла
  #end
  function SetLogFile(_sLogFileName : string) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Провести смещение периодов
  #end
  function DoShiftPer(
    _cTPer  : comp;     // тип периода
    _iShift : integer   // смещение
  ) : boolean;
  //#endregion COMMON
  //****************************************************************************


  //============================================================================
  //#region УСТАНОВКА ДАННЫХ ИЗ ПАРАМЕТРОВ ЗАПУСКА ДЛЯ БП
  //----------------------------------------------------------------------------
  #doc
     Установить ЦО из параметров запуска БП
  #end
  function SetDefCO(_Value : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить период из параметров запуска БП
  #end
  function SetDefPer(_Value : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить вариант из параметров запуска БП
  #end
  function SetDefVariant(_Value : comp) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить стадию из параметров запуска БП
  #end
  function SetDefStage(_Value : string) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить код регистра из параметров запуска БП
  #end
  function SetDefKodReg(_Value : word) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Установить ТФ из параметров запуска БП
  #end
  function SetDeTF(_Value : comp) : boolean;
  //#endregion УСТАНОВКА ДАННЫХ ИЗ ПАРАМЕТРОВ ЗАПУСКА ДЛЯ БП
  //****************************************************************************


  //============================================================================
  //#region FPITUNE
  //----------------------------------------------------------------------------
  #doc
     Загрузить настройки интерфейса
  #end
  function Read_ITune(_cTune : comp) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Сохранить настройки интерфейса
  #end
  function Save_ITune(_cTune : comp) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Удалить настройки интерфейса
  #end
  function Del_ITune (_cTune : comp) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Загрузить из менеджера ЦО
  #end
  function Read_ITune1CO(_cTune : comp; _wEntity : word) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Загрузить из менеджера период
  #end
  function Read_ITune1Per(_cTune : comp; _wEntity : word) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Загрузить из менеджера реквизиты копии
  #end
  function Read_ITune1Stage(_cTune : comp; _wEntity : word) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Загрузить из менеджера код регистра
  #end
  function Read_ITune1KodReg(_cTune : comp; _wEntity : word) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Загрузить из менеджера режим замены
  #end
  function Read_ITune1ReplaceMode(_cTune : comp; _wEntity : word) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Загрузить из менеджера бюджеты источники
  #end
  function Read_ITuneNBudSrc(_cTune : comp; _wEntity : word) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Обновить бюджеты и копии после загрузки данных из менеджера параметров
  #end
  function Read_BudUpdate : boolean;
  //#endregion FPITUNE
  //****************************************************************************

End; //#endregion ObjInterface
//******************************************************************************


//==============================================================================
VipInterface FpBudgetAggrDecomp implements IFpBudgetAggrDecomp, IObjFpDefModel
#Licensed_Free
Parameters (
  wRunMode : word   // 0 - агрегация; 1 - декомпозиция
);
//******************************************************************************

#endif//__FpBudAgrDec_Vih__
