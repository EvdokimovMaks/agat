//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Параметры периода и подпериодов
//------------------------------------------------------------------------------
#ifndef _ObjFpPerParam_Included_
#define _ObjFpPerParam_Included_

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

#include ManagerTypes.inc

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
Параметры периода и подпериодов<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iFpPerParam;

//------------------------------------------------------------------------------
#doc
   Получить в каком режиме задаются данные (0 - оба режима; 1 - один период; 2 - список периодов)<br>
#end
function GetDataModePer : word;

//------------------------------------------------------------------------------
#doc
   Получить режим единичного параметра Периодов<br>
#end
function GetMode1Per : word;

//------------------------------------------------------------------------------
#doc
   Получить режим параметра списка Периодов<br>
#end
function GetModeNPer : word;

//------------------------------------------------------------------------------
#doc
   Получить значение роли родителя для единичного Периода
#end
function GetParent1Per : word;

//------------------------------------------------------------------------------
#doc
   Получить значение роли родителя для списка Периодов
#end
function GetParentNPer : word;

//------------------------------------------------------------------------------
#doc
   Получить значение единичного периода
#end
function Get1Per : comp;

//------------------------------------------------------------------------------
#doc
   Выставить всем параметрам ссылку на родителя _wParent = 0 (Роль А) = 1 (Роль Б)
#end
function SetParentDefaults(_wParent : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Получение буфера таблицы периодов<br>
#end
function GetBuff(var _Buff : TParamPer): boolean;

//------------------------------------------------------------------------------
#doc
   Получить 1-ю запись таблицы Периодов
#end
function GetFirstRec : boolean;

//------------------------------------------------------------------------------
#doc
   Получить следующую запись таблицы Периодов
#end
function GetNextRec  : boolean;

//------------------------------------------------------------------------------
#doc
   Провести смещение периодов<br>
   <ul>
   <li> _cTPer  - тип периода
   <li> _iShift - смещение
   </ul>
#end
function DoShiftPer(_cTPer : comp; _iShift : integer) : boolean;

//------------------------------------------------------------------------------
#doc
   Загрузить настройки интерфейса<br>
#end
function Read_ITune(_cTune : comp; _wEntity : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Сохранить настройки интерфейса<br>
#end
function Save_ITune(_cTune : comp; _wEntity : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Удалить настройки интерфейса<br>
#end
function Del_ITune(_cTune : comp; _wEntity : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Проверка корректности задания<br>
#end
function CheckAllSet : boolean;

//------------------------------------------------------------------------------
#doc
   Проверка видимости полей<br>
#end
function CheckFieldState : boolean;

//------------------------------------------------------------------------------
#doc
   Инициализация параметров интерфейса<br>
#end
function InitParam(
   _wModeN     : word;   // 0 - оба режима; 1 - один ЦО; 2 - список ЦО
   _wSubPerUse : word    // 0 - только периоды; 1 - периоды с подпериодами
): boolean;

//------------------------------------------------------------------------------
#doc
   Событие при открытии сценария модели<br>
#end
Event function Event_OpenScenario : boolean;

//------------------------------------------------------------------------------
#doc
   Событие при установке ссылки на родительские значения<br>
#end
Event function Event_SetParentDefaults : boolean;

end;
//------------------------------------------------------------------------------

VipInterface FpPerParam implements iFpPerParam
#Licensed_Free
#ifdef  Atl51
Parameters (
  wModeN     : word;
  wSubPerUse : word
)
#endif//Atl51
;

#endif  // _ObjFpCOParam_Included_
