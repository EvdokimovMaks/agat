//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Базовый объект : "Шаблон Экспорт/Импорта"
//------------------------------------------------------------------------------

#ifndef __FpObjIETempl_Vih__
#define __FpObjIETempl_Vih__

//------------------------------------------------------------------------------
#include FpIETempl.Inc  // типы/константы сущности : "Шаблон Экспорт/Импорта"
#include FpIETempl.Tbl  // таблицы сущности : "Шаблон Экспорт/Импорта"
//------------------------------------------------------------------------------
#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Базовый объект : "Шаблон Экспорт/Импорта"<br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
#IntPrivate ObjInterface iObjFpIETemplater;
//==============================================================================
//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
//------------------------------------------------------------------------------
function BufGetHeadAnType  (_Buff : TPFpIEHeadFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetHeadKodGrKau(_Buff : TPFpIEHeadFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetHeadAnMean  (_Buff : TPFpIEHeadFld) : comp;
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetBodyAnType  (_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetBodyKodGrKau(_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetBodyFldName (_Buff : TPFpIEBodyFld) : string;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetBodyFldNumber(_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetBodyFldType (_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetBodyStartPos(_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetBodyStopPos (_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить значения свойства по буферу таблицы<br>
#end
function BufGetBodyFldLenght(_Buff : TPFpIEBodyFld) : word;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона вариант<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetHeadVariant (_cFixTempl : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона стадию<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _FileName  - файл по которому уже были проимпортированы финоперации<br>
   </ul> 
#end
function GetHeadStage (_cFixTempl : comp; _FileName : string) : string;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона код регистра<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetHeadKodReg (_cFixTempl : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона тип периода<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetHeadTPer (_cFixTempl : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона режим загрузки<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetLoadMode(_cFixTempl : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить из шаблона делать ли резервную копию<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end

//------------------------------------------------------------------------------
function GetIsRezerwCopy(_cFixTempl : comp) : boolean;

#ifndef __FpSpecPostRuNewDict__
//------------------------------------------------------------------------------
// Получить шаблон по деревянной таблице
// _cTmpKat - Nrec дерева
//------------------------------------------------------------------------------
#doc
  nction GetTemplate(_cTmpKat : comp) : comp;<br>
   Получить дерево по шаблону<br>
   _cFixKat - шаблон<br>
   wMode    - режим<br>
#end
//------------------------------------------------------------------------------
function GetTreeTemplate(_cFixKat : comp; _wMode : word ) : comp;
#endif // _FpSpecPostRuNewDict__

//==============================================================================
//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
//------------------------------------------------------------------------------
function BufSetHeadAnType  (var _Buff : TPFpIEHeadFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
function BufSetHeadKodGrKau(var _Buff : TPFpIEHeadFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
function BufSetBodyAnType  (var _Buff : TPFpIEBodyFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
function BufSetBodyKodGrKau(var _Buff : TPFpIEBodyFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
function BufSetBodyStartPos(var _Buff : TPFpIEBodyFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить значения свойства по буферу таблицы<br>
#end
function BufSetBodyStopPos (var _Buff : TPFpIEBodyFld; _Value : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить фильтр по теме письма<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _sSubj - тема письма<br>
   </ul> 
#end
function SetFltSubj(_cFixTempl : comp; _sSubj : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить фильтр по адресу отправителя<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _sAddr - адрес отправителя<br>
   </ul> 
#end
function SetFltAddr(_cFixTempl : comp; _sAddr : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить фильтр по телу письма<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _sBody - тело письма<br>
   </ul> 
#end
function SetFltBody(_cFixTempl : comp; _sBody : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить в фильтр начальную дату<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _Dt - начальная дата<br>
   </ul> 
#end
function SetFltStartDt(_cFixTempl : comp; _Dt : Date) : boolean;

//------------------------------------------------------------------------------
#doc
   Установить в фильтр конечную дату<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   <li> _Dt - конечная дата<br>
   </ul> 
#end
function SetFltStopDt(_cFixTempl : comp; _Dt : Date) : boolean;

//==============================================================================

//------------------------------------------------------------------------------
#doc
   Получить фильтр по теме письма<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetFltSubj(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить фильтр по адресу отправителя<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetFltAddr(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить фильтр по телу письма<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetFltBody(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить из фильтра начальную дату с которой будет начинаться обработка писем<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetFltStartDt(_cFixTempl : comp) : Date;

//------------------------------------------------------------------------------
#doc
   Получить из фильтра конечную дату до которой будет вестись обработка писем<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetFltStopDt(_cFixTempl : comp) : Date;

//------------------------------------------------------------------------------
#doc
   Проверить является ли аналитика таблицы  Аналитика+Сумма<br>
   <ul> 
   <li> _wType - тип аналитики<br>
   </ul> 
#end
function GetIsAnSumFldType (_wType : word) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить тип шаблона (DBF,TXT и т.п)<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetTemplType(_cFixTempl : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить кодировку файла<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetPageCode(_cFixTempl : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить символ-разделитель для TXT с разделителями<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetCharDelim(_cFixTempl : comp) : char;

//------------------------------------------------------------------------------
#doc
   Получить получить имя таблицы в XML файле<br>
   <ul> 
   <li> _cFixTempl - шаблон<br>
   </ul> 
#end
function GetXMLTableName(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Построить список файлов пакета удовлетворяющих маске<br>
#end
function FindPackadgeFile(_cTempl : comp): boolean;

//------------------------------------------------------------------------------
#doc
   Получить первый файл пакета удовлетворяющий маске<br>
#end
function FirstPackadgeFile(var _sFile : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Получить следующий файл пакета удовлетворяющий маске<br>
#end
function NextPackadgeFile(var _sFile : string) : boolean;

//------------------------------------------------------------------------------
#doc
   Каталог пакета<br>
#end
function GetPackadgeKatName(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Получить маску поиска<br>
#end
function GetPackadgeFileMask(_cFixTempl : comp) : string;

//------------------------------------------------------------------------------
#doc
   Загрузить во временные таблицы аналитику по умолчанию и аналитику таблицы<br>
   для шаблона _cRec<br>
#end
function LoadMetaTbl(_cRec : comp) : boolean;

//==============================================================================
//==============================================================================
end;

VipInterface ObjFpIETemplater implements iObjFpIETemplater
#Licensed_Free
;

#endif//__FpObjIETempl_Vih__

