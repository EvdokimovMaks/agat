//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Базовый объект : "Менеджер блокировки данных"
//------------------------------------------------------------------------------

#ifndef __FpSemaphor_Vih__
#define __FpSemaphor_Vih__

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
#doc
Базовый объект : "Менеджер блокировки данных"
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования<br>
#end
Private ObjInterface iObjFpSemaphor;

//==============================================================================
//                                  ERROR
//------------------------------------------------------------------------------
#doc
Возвращает последнюю возникшую ошибку
#end
function GetStLastError : string;

//------------------------------------------------------------------------------
#doc
Вывести сообщение с последней возникшей ошибкой
#end
function ShowMessageLastError : boolean;

//------------------------------------------------------------------------------
#doc
Возвращает NRec пользователя выставившего семафор
#end
function GetLastLockUser : comp;

//------------------------------------------------------------------------------
#doc
 Возвращает имя пользователя выставившего семафор
#end
function GetLastLockUserName : string;

//==============================================================================
//                                  Семафоры
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
Выставить семафор
#end
function fpSetSemaphore(sName : string; iFlags : word) : word;

//------------------------------------------------------------------------------
#doc
Снять семафор
#end
function fpClearSemaphore(sName : string) : word;

//------------------------------------------------------------------------------
#doc
Проверить состояние семафора
#end
function fpIsSemaphore(sName : string; var iMode : word) : boolean;

//------------------------------------------------------------------------------
#doc
Проверить состояние семафора для пользователя
#end
function fpIsSemaphoreByUser(
    sName    : string;
    pcUserID : comp;
var wMode    : word
) : boolean;

//------------------------------------------------------------------------------
#doc
Убить "протухшие" семафорфы
#end
function KillInefficientSemaphore : boolean;

//------------------------------------------------------------------------------
#doc
Убить свои "протухшие" сессионные семафорфы
#end
function KillOwnInefficientSemaphore : boolean;

//==============================================================================
//                                  DIALOG
//------------------------------------------------------------------------------
#doc
Функция позволяет просмотреть список выставленных семафоров
#end
function RunViewSemaphor : boolean;

//------------------------------------------------------------------------------
End;

VipInterface ObjFpSemaphor implements iObjFpSemaphor
#Licensed_Free
;

#endif//__FpSemaphor_Vih__
