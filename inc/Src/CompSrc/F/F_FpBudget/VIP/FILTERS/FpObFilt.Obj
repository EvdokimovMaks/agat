//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Универсальный интерфейс : "Фильтры пользователя"
//------------------------------------------------------------------------------

#ifndef __FpObFilt_Obj__
#define __FpObFilt_Obj__

#include FpTypes.inc

#ifdef  ComponentVersion
#component "F_FpBudget"
#endif//ComponentVersion

//------------------------------------------------------------------------------
type ArrayOfWord = array [0..0] of word;

//------------------------------------------------------------------------------
#doc
Универсальный интерфейс : "Фильтры пользователя"
#end
ObjInterface IObjFpUserFilt;
  //----------------------------------------------------------------------------
  #doc
     Определить возможность установки Bounds-ов на FpOborot
  #end
  function PossibleBounds(
    var Bnd       : LongInt;       // Bounds-ы которые можно установить
    var BndValues : tFiltValues;   // Режимы фильтрации
        NotSetBnd : LongInt        // Bounds-ы запрещенные к установке
  ) : boolean;
  //----------------------------------------------------------------------------
  #doc
     Определить возможность установки Bounds-ов на FpValues
  #end
  function PossibleValuesBounds(
    var Bnd : LongInt;             // Bounds-ы которые можно установить
    var BndValues : tFiltValues    // Режимы фильтрации
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Проверить запись на удовлетворение фильтру
  #end
  function CheckOborotStateFilter(
        Buf : tFpOborot;
        wState : word;
        Bnd : LongInt
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Проверить запись на удовлетворение фильтру
  #end
  function CheckFilter(
        Buf : tFpOborot;
        Bnd : LongInt
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Проверить запись на удовлетворение фильтру
  #end
  function CheckValuesFilter(
        Buf : tFpValues;
        Bnd : LongInt
  ) : boolean;

  //------------------------------------------------------------------------------
  #doc
     Проверяет на соответсвие фильтру, заданных полей
  #end
  function CheckThisSimpleAnalitika(
    _cCO : comp;     // ЦО
    _cPP : comp;     // Период
    _cSB : comp;     // Статья бюджета
    _Bnd : LongInt   // Ограничения которые проверять не надо
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Установка фильтра
  #end
  function SetFilter(
    tcFilter : comp;
    DopParam : LongInt // 0-аналитика документа, 1-аналитика статьи
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Снятие фильтра
  #end
  procedure ReSetFilter;

  //----------------------------------------------------------------------------
  #doc
     Снятие фильтра
  #end
  procedure ClearTmpFilter;

  //----------------------------------------------------------------------------
  #doc
     Добавить спецификацию фильтра
  #end
  function AddFilter(
      wType     : word;    // Тип спецификации фильтра (константа cgFpGroup_XX)
      wKod      : word;    // KodGrKau (только для cgFpGroup_Kau)
      wFilter   : word;    // Отношения для фильтрации:
                           //   0 - 'нет'
                           //   1 - '='
                           //   2 - '<>'
                           //   3 - '<='
                           //   4 - '=>'
      CurMark   : TPtr; // кол-во эл-ов в tChoice
      ResComp_1 : comp     // ссылка tChoice или само значение поля (wType = 6)
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Получить значения свойства
  #end
  function GetSpFilter(
      wType   : word;      // Тип спецификации фильтра (константа cgFpGroup_XX)
      wKod    : word;      // KodGrKau (только для cgFpGroup_Kau)
  var wFilter : word;      // Отношения для фильтрации:
                           //   0 - 'нет'
                           //   1 - '='
                           //   2 - '<>'
                           //   3 - '<='
                           //   4 - '=>'
  var Value   : comp;      // значение элемента в фильтре (в случае одиночного фильтра)
      FltMID  : TPtr    // маркер со значениями элементов фильтра
  ) : integer;             // количество элементов в фильтре

  //----------------------------------------------------------------------------
  #doc
     Получить значения типов и кодов установленных значений фильтра
  #end
  procedure GetAllFilterKeys(var wTypesArray: ArrayOfWord; var wKodArray: ArrayOfWord);

  //----------------------------------------------------------------------------
  #doc
     Удалить спецификацию фильтра
  #end
  function DelSpFilter(
      wType   : word;
      wKod    : word
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Добавить спецификацию фильтра из другого
  #end
  function AddFiltersFrom(
    _cFilter : comp
  ) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запуск печати сущности
  #end
  function Debug_PrintFilter : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запускать ли фильтр по датам
  #end
  function IsRunDateFlt(_cFilter : comp) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Запуск интерфейса фильтра по датам
  #end
  function RunDateFlt(var _dtBeg, _dtEnd : Date) : boolean;

  //----------------------------------------------------------------------------
  #doc
     Предварительная обработка параметров фильтра
  #end
  function PreProcessFilter : boolean;

End;

#endif//__FpObFilt_Obj__
