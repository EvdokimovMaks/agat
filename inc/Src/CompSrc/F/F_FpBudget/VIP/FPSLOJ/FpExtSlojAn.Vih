//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Управление бюджетом"
// Интерфейс взаимодействия : "Слои аналитик в FP"
//------------------------------------------------------------------------------

#ifndef __ExtFpSlojAn_Vih__
#define __ExtFpSlojAn_Vih__

#ifdef  componentVersion
#component "F_FpBudget"
#endif//componentVersion

//------------------------------------------------------------------------------
#doc
Интерфейс взаимодействия : "Слои аналитик в FP"<br>
<b>Внимание!</b> Интерфейс предназначен только для использования внутри контура "Финансы"<br>
#end
ObjInterface iExtFpSlojAn;

//------------------------------------------------------------------------------
#doc
   Функция возвращает описание последней ошибки<br>
#end
function GetStLastError : string;

//------------------------------------------------------------------------------
#doc
   Вывод сообщения последней ошибки<br>
#end
function RunShowError : boolean;


//==============================================================================
//                                 MODIFY
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить слой по контейнеру аналитик
#end
function GetSlojByContAn(
    _cGrAn  : comp;
    _CAnID  : TPtr;
    _IsIns  : boolean;
var _wError : word
) : comp;


//==============================================================================
//                                  FIELDS
//------------------------------------------------------------------------------
#doc
   Наименование слоя
#end
function GetName            (_cRec : comp) : string ;
//------------------------------------------------------------------------------
#doc
   Группа аналитик слоя
#end
function GetGrAn            (_cRec : comp) : comp   ;
//------------------------------------------------------------------------------
#doc
   Является ли слой группой аналитик
#end
function GetIsGrAn          (_cRec : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Существуют ли подчиненные слой аналитик
#end
function GetIsSubSlojExist  (_cRec : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Используется слой аналитик
#end
function GetIsUsed          (_cRec : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Количество аналитик в слое
#end
function GetSlojKolAn       (_cRec : comp) : integer;


//==============================================================================
//                                  CHECK
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Запуск функции проверки корректности<br>
#end
function CheckSloj(_cSloj : comp) : boolean;
//------------------------------------------------------------------------------
#doc
   Запуск функции проверки корректности<br>
#end
function CheckAllSlojsByGrAn(_cGrAn : comp) : boolean;

//==============================================================================
//                                  DIALOG
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Функция возвращает наименование маркера по слоям
#end
function GetSlojMarkerName   : string;
//------------------------------------------------------------------------------
#doc
   Функция возвращает наименование маркера по спецификации слоя
#end
function GetSpSlojMarkerName : string;

//------------------------------------------------------------------------------
#doc
   Запуск интерфейса просмотра групп аналитик
#end
function RunViewGrAn(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOCONST.INC
var _cGetRec  : comp   // выбранная запись
) : LongInt;

//------------------------------------------------------------------------------
#doc
   Запуск интерфейса просмотра слоев по группе аналитик
#end
function RunViewSlojGrAn(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOCONST.INC
    _cTopRec  : comp;  // Группа аналитик
var _cGetRec  : comp   // выбранная запись
) : LongInt;

//------------------------------------------------------------------------------
#doc
   Запуск интерфейса просмотра спецификации слоя
#end
function RunViewSpSloj(
    _wIntMode : word;  // режим запуска (cgiNo, cgiPick, ...) см.GLOCONST.INC
    _cTopRec  : comp;  // Группа аналитик
var _wGetKod  : word   // выбранный код аналитики
) : LongInt;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface vExtFpSlojAn implements iExtFpSlojAn
#Licensed_Free
;

#endif//__ExtFpSlojAn_Vih__
