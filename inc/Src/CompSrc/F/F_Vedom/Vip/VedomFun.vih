//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Касса"
// Функции для работы с ведомостями
//------------------------------------------------------------------------------

#component "F_Vedom"

#doc
Функции для работы с ведомостями
#end
Private ObjInterface ObjVedomFunPriv;

#doc
Номер платежной ведомости
#end
Function GetNoDocVedPlat(_cKassa: comp; _wTip: word): tNoDok;

#doc
Номер ведомости депонирования
#end
Function GetNoDocVedDep(_cKassa: comp; _wTip: word): tNoDok;

#doc
Корректировка признака ведомости депонирования
#end
Function CheckPriznakVedDep(_cRec: comp; _dForm: date = date(0,0,0)): boolean;

#doc
Удаление ведомости депонирования
#end
Function DeleteVedDep(_cRec: comp): boolean;

#doc
Формирование платежной ведомости по ведомости депонирования
#end
Function MakeVedPlatByVedDep(_cRec: comp; _dForm: date): comp;

#doc
Формирование платежных ведомостей по ведомостям депонирования
#end
Function MakeVedPlatByMarkVedDep(_Marker, _SpMarker: TPtr; _dForm: date; GroupPar: word): word;

#doc
Формирование платежной ведомости по позиции ведомости депонирования
#end
Function MakeVedPlatBySpVedDep(_cRec, _cSpRec: comp; _dForm: date): comp;

#doc
Формирование платежной ведомости по позициям ведомости депонирования
#end
Function MakeVedPlatByMarkSpVedDep(_cRec: comp; _SpMarker: TPtr; _dForm: date): comp;

#doc
Формирование платежных ведомостей по ведомостям депонирования выбранных ЛС
#end
Function MakeVedPlatByLS(_Marker: TPtr; _LsMarker: TPtr; _dForm: date): word;

#doc
Ведомость на выплату алиментов
#end
function IsAlimentVed(pref: s5): boolean;

#doc
Ведомость на выплату подотчетных сумм
#end
function IsPodotVed(pref: s5): boolean;

#doc
Создание или корректировка карточки депонирования
#end
! isPV = true для ПВ (влияет на знак суммы в сальдо и выдачу сообщений)
! isAliment = true для ведомостей на выплату алиментов через кассу
! dcurse = SpVed.DataN
! valsum = SpVed.SumUdV - SpVed.SumOplV для ПВ
!          SpVed.SumUdV для ВД
! rubsum = SpVed.SumUd - SpVed.SumOpl для ПВ
!          SpVed.SumUd для ВД
procedure UpdateDeponKart(isPV, isAliment: boolean;
                         dcurse: date;
                         LSch, Pers: comp;
                         FIO: string;
                         Val: comp;
                         valsum, rubsum: TSumma);

#doc
Регистрация документов из маркера в карточках подотчетников
#end
procedure RegNewPodotPlPor(_isNew: boolean; _marker: TPtr);

#doc
Удаление номера ведомости из БД.
#end
procedure DeleteNumber(_cKassa: comp; _NoDoc: s20; _Descr: TDescr);

#doc
Удаление записи спецификации с корректировкой сальдо
#end
function DeleteSpPlVed(_prefix: s5; _cSpPlVed: comp): boolean;

#doc
Удаление документов, сформированных по ПВ.</brief>
<p><code>_marker</code> - маркер с элементами типа <code>comp</code> - ссылки на неудаленные <code>PlPor</code>.</p>
#end
procedure BackingPlatVed(_cPlatVed: comp; _marker: TPtr);

#doc
Удаление платежной ведомости.
#end
function DeletePlatVed(_cPlatVed: comp): boolean;

#doc
Пересчет сумм в платежной ведомости по ее спецификации.
#end
procedure RecalcPlatVedBySpec(_cPlatVed: comp);

#doc
Пересчет суммы в записи спецификации.
#end
procedure RecalcSpPlVed(_cSpPlVed: comp);

end;

#doc
Раздельная нумерация платежных ведомостей с модулем "Заработная плата"
#end
Private ObjInterface ObjVedomFunPrivZP;

#doc
Номер платежной ведомости (раздельная нумерация)
#end
function GetNoDocVedPlatZP(_cKassa: comp; _wTip: word; Pref: string): tNoDok;

#doc
Удаление последнего номера платежной ведомости из специальной таблицы
(раздельная нумерация)
#end
procedure DeleteNumberZP(_cKassa: comp; _NoDoc: s20; _Descr : TDescr; _Pref: string);

end;

Private VipInterface iVedomFun implements ObjVedomFunPriv, ObjVedomFunPrivZP
  Licensed(Free);
