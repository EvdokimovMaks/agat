//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 5.8 - ФРО
// Аналитическая ведомость (оборотная)
//------------------------------------------------------------------------------

// Внимание! Существует slk-отчет (копии этих присоединенных форм)

#include FeeSigners.frn

#doc
Базовая форма отчета "Аналитическая ведомость (оборотная)"
#end
.set name = 'AnFrm_Ob'
.hide
.defo LANDSCAPE

.fields
//-------------------
  PlanSchet_Capt
  MainSchet
  MainPeriod
  GroupTuneName  // наименование настройки группировки
  BuhName
//-------------------
  FilterTitle
  FilterName
//-------------------
  O_NRec       // Oborot.nRec
  O_Kol        // Oborot.Kol

  KAUName : string :'t:r'
  SumInD  SumInK
  SumD    SumK
  SumOutD SumOutK
#FeeSignersCycleFields
.endfields
План счетов ^ 
Счет ^ 
Период ^
Группировка ^
Главный бухгалтер ^
.if FiltOb
.{ Ob_Filters CheckEnter
^
.{ Ob_Detail
^
.}
.}
.end
.{
.{ An_Obor
 ^ ^
 ^  ^ ^  ^ ^  ^ ^
.}
.}
#FeeSignersCycle(AnFrm_Ob)
.endform

.linkform 'AnFrm_Nob' prototype is 'AnFrm_Ob'
.nameinlist 'Оборотная ведомость'
.defo LANDSCAPE
.nonextheader
.var
  MyOrg   :string;
  iKatOrg : KatOrg;
.endvar
.fields
CommonFormHeader PlanSchet_Capt
MyOrg
MainSchet MainPeriod
FilterTitle FilterName
KAUName : 't:r'
SumD SumK
.endfields
.begin
  MyOrg := iKatOrg.GetKatOrgName(coGetTune('Myorg'), koOnTune);
end.
 Р^ [^]
^
                                           Аналитическая ведомость по счету ^
                                           @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.if FiltOb
 ВПрименен фильтр... В
.{ Ob_Filters CheckEnter
 В   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ В
.{ Ob_Detail
 В     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ В
.}
.}
.end
.{
.[H
─────────────────────────────────────────────────────────────────────────┬─────────────────────────┬────────────────────────┐
 Объект учета (по параметрам группировки)                                │          Оборот         │          Оборот        │
                                                                         │           дебет         │          кредит        │
─────────────────────────────────────────────────────────────────────────┼─────────────────────────┼────────────────────────┤
.]H
.{ An_Obor
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │&'&&&&&&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&&&&&│
.}
.}
─────────────────────────────────────────────────────────────────────────┴─────────────────────────┴────────────────────────┘


.fields
if(Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
Подписант_ФИО
.endfields
.if ExistFeeSigners_AnFrm_Ob
.{checkenter FeeSignersCycle_AnFrm_Ob
 Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  __________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                         подпись
.}
.else
.fields
BuhName
.endfields
Главный бухгалтер  ___________________   ^
                          подпись
.end
 Р
.endform


//***************************************************************************
.linkform 'AnFrm_NobSaldo' prototype is 'AnFrm_Ob'
.nameinlist 'Оборотная ведомость (с учетом сальдо)'
.defo LANDSCAPE
.nonextheader
.var
  MyOrg   :string;
  iKatOrg : KatOrg;
.endvar
.fields
CommonFormHeader PlanSchet_Capt
MyOrg
MainSchet MainPeriod
FilterTitle FilterName
 KAUName : 't:r'
 SumInD  SumInK
 SumD    SumK
 SumOutD SumOutK
.endfields
.begin
  MyOrg := iKatOrg.GetKatOrgName(coGetTune('Myorg'), koOnTune);
end.
 Р^ [^]
^
                                                                          Аналитическая ведомость по счету ^
                                                                          @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.if FiltOb
 ВПрименен фильтр... В
.{ Ob_Filters CheckEnter
 В   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ В
.{ Ob_Detail
 В     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ В
.}
.}
.end
.{
.[H
─────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────┬─────────────────────────────────────┬─────────────────────────────────────
                                                                         │           Сальдо входящее           │               Обороты               │           Сальдо исходящее
 Объект учета (по параметрам группировки)                                ├──────────────────┬──────────────────┼──────────────────┬──────────────────┼──────────────────┬──────────────────
                                                                         │       Дебет      │     Кредит       │       Дебет      │      Кредит      │       Дебет      │      Кредит
─────────────────────────────────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
.]H
.{ An_Obor
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&
.}
.}
─────────────────────────────────────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────


.fields
if(Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
Подписант_ФИО
.endfields
.if ExistFeeSigners_AnFrm_Ob
.{checkenter FeeSignersCycle_AnFrm_Ob
 Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  __________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                         подпись
.}
.else
.fields
BuhName
.endfields
Главный бухгалтер  ___________________   ^
                          подпись
.end
 Р
.endform
