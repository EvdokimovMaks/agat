//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 5.8
// Обьектный интерфес работы с таблицей PickBuh
//------------------------------------------------------------------------------

#ifndef _PickBuh_vih_Included
#define _PickBuh_vih_Included

#Component "F_BuhRep"

!-------------------------------------------------------------------------------
Table struct PickBuh
(
   KodTable : word             "таблица"
  ,PickRec  : tNRec            "номер элемента в списке"
  ,PickKod  : tSchet3          "код или NRec элемента"
  ,Schet    : tSchet3          "бухг.счет"
  ,SubKau   : tSchet3          "субсчет/КАУ"
#ifdef Gal9_1
  ,Name     : s250             "имя фильтра"
  ,Pick     : longint          "порядок выбора"
#else
  ,Name     : tName            "имя фильтра"
  ,Pick     : integer          "порядок выбора"
#endif
  ,PickKol  : double           "количество"
)
with index
(
   PickBuhRec = KodTable + PickRec
  ,PickBuhKod = KodTable + PickKod
  ,PickBuhSch = KodTable + Schet + PickKod
  ,PickBuhPck = KodTable + Pick
);
!-------------------------------------------------------------------------------

!-------------------------------------------------------------------------------
#doc
Сервисные функции для работы с таблицей PickBuh
#end
ObjInterface ObjPickBuh;
!-------------------------------------------------------------------------------
  #doc
  Подсчет количесва записей по коду таблицы
  #end
  function GetCountItem      (wTab : word)                  : TNumPick;
!-------------------------------------------------------------------------------
  #doc
  Существуют ли записи по коду таблицы
  #end
  function FoundInPick       (wTab : word)                  : boolean;
!-------------------------------------------------------------------------------
  #doc
  Вернуть PickRec первой найденной по коду таблицы записи
  #end
  function FoundInPick_GetRec
                             (wTab : word)                  : comp;
!-------------------------------------------------------------------------------
  #doc
  Вернуть PickKod первой найденной по коду таблицы записи
  #end
  function FoundInPick_GetKod
                             (wTab : word)                  : tSchet3;
!-------------------------------------------------------------------------------
  #doc
  Вернуть Schet первой найденной по коду таблицы записи
  #end
  function FoundInPick_GetSchet(wTab : word)                : tSchet3;
!-------------------------------------------------------------------------------
  #doc
  Существуют ли запись по коду таблицы и PickKod
  #end
  function FoundInPickByKod  (wTab : word; sKod : tSchet3)  : boolean;
!-------------------------------------------------------------------------------
  #doc
  Существуют ли запись по коду таблицы и PickRec
  #end
  function FoundInPickByRec  (wTab : word; cRec : comp)     : boolean;
!-------------------------------------------------------------------------------
  // приходится искать _Loop - ом, надо это дело как то грохать
  #doc
  Есть ли субсчет
  #end
  function FoundSubSch       (Sch : tSchet3; Sub : tSubSch) : boolean;
!-------------------------------------------------------------------------------
  #doc
  Найти первый попавшийся субсчет и вернуть его и его счет
  #end
  function FoundFirstSub     (var Sch : tSchet3;
                              var Sub : tSubSch)            : boolean;
!-------------------------------------------------------------------------------
  #doc
  Есть ли в PickBuh субсчета указанного счета
  #end
  function FoundSubForSchet  (Sch : tSchet3)                : boolean;
!-------------------------------------------------------------------------------
  #doc
  Очистка таблицы
  #end
  function DeletePickBuh                                    : boolean;
!-------------------------------------------------------------------------------
  #doc
  Удаление по коду таблицы
  #end
  function DeleteItem        (wTbl : word)                  : boolean;
!-------------------------------------------------------------------------------
  #doc
  Удаление по коду таблицы и PickRec
  #end
  function DeleteItemByRec   (wTab : word; cRec : comp)     : boolean;
!-------------------------------------------------------------------------------
  #doc
  Удаление по коду таблицы и Счету
  #end
  function DeleteItemBySchet (wTab : word; Sch : tSchet3)   : boolean;
!-------------------------------------------------------------------------------
  #doc
  Скопировать записи и вернуть количество
  #end
  function CopyItem          (wOld, wNew : word)            : TNumPick;
!-------------------------------------------------------------------------------
  #doc
  Перенести записи на новый код таблицы и вернуть количество
  #end
  function MoveItem          (wOld, wNew : word)            : TNumPick;
!-------------------------------------------------------------------------------
  #doc
  Вставить запись (все поля)
  #end
  function InsertFullRecord  (wTbl  : word;
                              cRec  : comp;
                              sKod, sSch, sSub, sName : string;
#ifdef Gal9_1
                              iPick : longint;
#else
                              iPick : integer;
#end
                              dPick : double)               : boolean;
!-------------------------------------------------------------------------------
  #doc
  Вставить запись (все поля для аналитики)
  #end
  function InsertAnRecord    (wTbl : word;
                              cRec : comp;
                              sKod, sName : string;
#ifdef Gal9_1
                              iPick : longint)              : boolean;
#else
                              iPick : integer)              : boolean;
#end
!-------------------------------------------------------------------------------
end;
!-------------------------------------------------------------------------------
VipInterface PickBuh implements ObjPickBuh #Licensed_Free;
!-------------------------------------------------------------------------------
#end // _PickBuh_vih_Included
