/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,2001 корпорация ГАЛАКТИКА                    ║
 ║ Система       : ГАЛАКТИКА                                                 ║
 ║ Проект        : Бухгалтерский контур                                      ║
 ║ Версия        : 5.80                                                      ║
 ║ Назначение    : Тип для настроек отчетов                                  ║
 ║ Ответственный : Герман Юрий Эдуардович                                    ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#ifndef _BuhRep_Vpp_Included
#define _BuhRep_Vpp_Included

type
  //----------------------------------------------------------------------------
  // Все настройки отчета (кроме фильтров), которые используются в Паскале
  //----------------------------------------------------------------------------
  // Данная запись должна на 100% соответствовать записи
  // B_Report.TReportParameters (кроме массивов :( )
  //----------------------------------------------------------------------------
  TPasReportParams = record
    //--------------------------------------------------------------------------
    // 23/05/2002 Для начала делаю все параметры из B_Report.GetTuneBuhReport
    //--------------------------------------------------------------------------
    cPlansSch    : comp;      // План счетов
    BegDate      : date;      // Дата начала расчетов
    EndDate      : date;      // Дата окончания расчетов
    // Фильтры
    RepSch       : tSchet3;   // Счет
    RepSub       : tSubSch;   // Субсчет
    RepPodr      : tNRec;     // Подразделение
    RepBackPodr  : word;      // Обратная фильтрация по подразделению
    RepPostPol   : tNRec;     // Поставщик/получатель
    RepBackPP    : word;      // Обратная фильтрация по поставшику/получателю
//    RepTbl       : tTabKAU;   // Коды Аналитик
    RepTbl1      : word;
    RepTbl2      : word;
    RepTbl3      : word;
    RepTbl4      : word;
    RepTbl5      : word;
    RepTbl6      : word;
//    RepKAU       : tGetKAU;   // Значения Аналитик
    RepKau1      : tKodKau;
    RepKau2      : tKodKau;
    RepKau3      : tKodKau;
    RepKau4      : tKodKau;
    RepKau5      : tKodKau;
    RepKau6      : tKodKau;
//    RepBack      : tTabKau;   // Обратная фильтрация
    RepBack1     : word;
    RepBack2     : word;
    RepBack3     : word;
    RepBack4     : word;
    RepBack5     : word;
    RepBack6     : word;
    RepVal       : tNRec;     // Валюта
    // Режимы отбора и прочее ...
    SetValVed    : word;      // установленный вид отчетов:НДЕ/БВ/НДЕ+БВ
    SetTipVed    : word;      // тип ведомости:по операциям/содержанию/оборотам
    SetFilter    : word;      // значение фильтра из диалога
    SetSort      : word;      // сортировка данных в отчете
    SodrMode     : word;      // Способ формирования содержания
    _SaldoSource : word;      // Способ формирования входящего сальдо в отчетах.
                              // Или на начало отчетного периода, или ближайшее
                              // на дату формирования отчета
    // Всякие разные переменные ...
    _DlgComp1    : tNRec;     // Дополнительная ссылка
    _DlgCashBank : tNRec;     // Ссылка на кассу ?!
    _DlgValut    : tNRec;     // Настройка пересчета Курсовых разниц
    _DlgTiDkUser : word;      // Тип документа пользователя
    _DlgRound    : word;      // Округление
    _DlgMinSumm  : double;    // Минимальная сумма для выборки
    _DlgMaxSumm  : double;    // Максимальная сумма для выборки
    SumMode      : word;      // режим сравнения сумм
    RepSaldo     : word;      // Параметры расчета сальдо
    wTune4       : word;      // Дополнительные параметры
    wParam1      : word;      // - // -
    wParam2      : word;      // - // -
    wParam3      : word;      // - // -
    sTune1       : string;    // Наименование некоторого параметра
    sIName       : string;    // Именование интерфейса для сохранения параметров в Dsk
    RepDAS       : word;      // ДАС
    _DlgDasLevel : word;      // Выбранный уровень ДАС
    // Корсчет
    mSchK        : TNumPick;
    SchK         : tSchet3;
    mSubK        : TNumPick;
    SubK         : tSubSch;
    mPodrK       : TNumPick;
    PodrK        : tNRec;
    wBackPodrK   : word;
    wBackSchK    : word;      // Обратный фильтр по счету/корсчету
    // Тип документа
    mTiDk        : TNumPick;
    TiDk         : word;
    //TXO
    mTXO         : TNumPick;  // множественный фильтр по тxo
    cTXO         : comp;      // фильтр по тхо
    wBackTXO     : word;      // Обратный фильтр по TXO
    // Дескриптор
    mDescr       : TNumPick;
    Descr        : tDescr;
    cFeeSign     : comp;      // подпись в отчете
    // Вид отчета
    wVidOtch     : word;      // вид отчета : Бизнес-текст, Excel
    sShablon     : string;    // путь шаблона
#ifdef __FastClose__
    // Статусы
    mStatus      : TNumPick;  
    cStatus      : comp;      
    wBackStatus  : word;      // обратный фильтр 
#endif    

    wCorrespO    : word;
    mCorrespO    : TNumPick;     // множественный фильтр по соответствиям основного счета
    cCorrespO    : comp;         // соответствие основного счета
    wCorrespK    : word;
    mCorrespK    : TNumPick;     // множественный фильтр по соответствиям корр. счета
    cCorrespK    : comp;         // соответствие основного счета

    CorrespO_Obj : comp;
    CorrespK_Obj : comp;
  end; // TPasReportParams

!-------------------------------------------------------------------------------
  TVipReportParams = record
    // План счетов
    cPlansSch : comp;
    // Основной счет и субсчет
    mSchetO   : TNumPick;
    SchetO    : tSchet3;
    dbSchetO  : tSchet19;
    mSubOsSch : TNumPick;                    // кол-во выбранных
    SubOsSch  : tSubSch;
    mKauOs1, mKauOs2, mKauOs3, mKauOs4, mKauOs5, mKauOs6 : TNumPick;// кол-во выбранных
    cKauOs1, cKauOs2, cKauOs3, cKauOs4, cKauOs5, cKauOs6 : tKodKau; // Перевести на массив
    wKauOs1, wKauOs2, wKauOs3, wKauOs4, wKauOs5, wKauOs6 : word;    // Перевести на массив
    mKodSPO   : TNumPick;                    // кол-во выбранных
    KodSPO    : comp;
    // Корреспондирующий счет и субсчет
    mSchK     : TNumPick;
    SchK      : tSchet3;
    mSubK     : TNumPick;
    SubK      : tSubSch;
    mKodSPK   : TNumPick;                    // кол-во выбранных
    KodSPK    : comp;
    /* for future
    mKauKs1, mKauKs2, mKauKs3, mKauKs4, mKauKs5, mKauKs6 : TNumPick;    // кол-во выбранных
    cKauKs1, cKauKs2, cKauKs3, cKauKs4, cKauKs5, cKauKs6 : tKodKau; // Перевести на массив
    wKauKs1, wKauKs2, wKauKs3, wKauKs4, wKauKs5, wKauKs6 : word;    // Перевести на массив
    */

    // Прочие поля
    BegDate   : date;
    EndDate   : date;
    ViOb      : word;      // вид оборота (дебет/кредит)
    mTXO      : TNumPick;  // множественный фильтр по тxo
    cTXO      : comp;      // фильтр по тхо
    mTiDk     : TNumPick;  // множественный фильтр по типам документов
    TiDk      : word;      // тип документа
    TiDkUser  : word;      // тип документа пользователя
    ValVed    : word;      // установленный вид отчетов: НДЕ/БВ/НДЕ+БВ
    TipVed    : word;      // тип ведомости: по операциям/содержанию/оборотам
    RepSort   : word;      // сортировка данных в отчете
    SodrMode  : word;      // Способ формирования содержания
    SaldoMode : word;      // Параметры расчета сальдо
    SaldoSource : word;    // Способ формирования входящего сальдо в отчетах.
                           // на начало отчетного периода / ближайшее на дату формирования отчета
    RoundRule : word;      // округление данных в отчетах (да/нет)
    mDas      : TNumPick;  // кол-во выбранных значений ДАС
    cDas      : tKodKau;   // выбранное значение ДАС (если одно)
    DAS       : word;      // ДАС
    DasLevel  : word;      // Выбранный уровень ДАС
    PageNum   : word;      // номер очередного листа в кассовой книге с начала года
    PageCount : word;      // количество листов в текущем месяце
    wKassaParam : word;    // дополнительные параметры для кассовой книги
    wTreeParam: word;      // дополнительные параметры для интерактивных отчетов
    SaveRep   : word;      // сохраниение отчета (интерактивные отчеты)
    BackMode  : longint;   // обратная фильтрация - битовая маска
                           // бит 1..6 - обратный фильтр по КАУ 1..6
                           //     7 - обратный фильтр по подразделению
                           //     8 - обратный фильтр по поставщикам/получателям
                           //     9 - обратный фильтр по кор счету/субсчету
                           //     10 - обратный фильтр по ТХО

    cListGD   : comp;      // список групп пользователей
    mDescr    : TNumPick;
    Descr     : tDescr;
    DesGr     : tDesGr;
    SodPr     : tSodPr;    // содержание проводки

    MinSum    : double;    // Минимальная сумма для выборки
    MaxSum    : double;    // Максимальная сумма для выборки
    SumMode   : word;      // режим сравнения сумм
    isTurnMinus : boolean; // переворачивать отрицательные проводки

    cValut    : comp;      // код валюты
    mValut    : TNumPick;  // кол-во выбранных валют
    cFilKor   : comp;      // филиал
    cHozOper  : comp;      // хоз. операция
    cJOrder   : comp;      // ссылка на настройку журнала-ордера
    mJOrder   : TNumPick;  // ссылка на настройку журнала-ордера
    cCachBank : comp;      // при многокассовости - ссылка на выбранную кассу
    cDeltaVal : comp;      // настройка пересчета Курсовых разниц
    cPostPol  : tNRec;     // Поставщик/получатель
    cGroupKA  : comp;      // код группы контрагентов
    mGroupKA  : TNumPick;  // количество выбранных групп контрагентов
    TypeVed   : word;      // Тип ведомости 0 - FastReport, 1 - FCOM
    xlPath    : string;    // путь на excel отчет
    cFeeSign  : comp;      // подпись в отчете
    sFeeSign  : string;

    // Анализ задолженности
    ShagS     : byte;      // Шаг сетки (месяц, день)
    SpeedS    : word;      // Размер шага сетки
    NumRecord : longint;   // Количество интервалов

    //ПГК - начисление процентов по депозитам
    rDate     : Date;      //Дата размещения депозита
    wVidOtch  : word; // вид отчета : Бизнес-текст, Excel
#ifdef __FastClose__
    mStatus   : TNumPick;  // множественный фильтр по статусам
    cStatus   : comp;      // статус
#endif

    wCorrespO : word;
    mCorrespO : TNumPick;     // множественный фильтр по соответствиям основного счета
    cCorrespO : comp;         // соответствие основного счета
    wCorrespK : word;
    mCorrespK : TNumPick;     // множественный фильтр по соответствиям корр. счета
    cCorrespK : comp;         // соответствие основного счета

    CorrespO_Obj : comp;
    CorrespK_Obj : comp;
  end; // TVipReportParams


#end // _BuhRep_Inc_Included
