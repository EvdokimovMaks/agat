//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 8.10 - ФРО
// Обьектный интерфейс "Выбор видов деятельности"
//------------------------------------------------------------------------------
#ifndef _JtTune_vih
#define _JtTune_vih

#Component "F_BuhRep"
!-------------------------------------------------------------------------------
#doc
Выбор видов деятельности
#end
const                                 // для загрузки настроек
  cgPick = 0;                         // загрузить 1у
  cgAll  = 1;                         // все
  cgMark = 2;                         // помеченные(из Pickbuh)

  // порядок констант важен! используется в индексе
  joJobType_Saldo = 0;                // сальдо
  joJobType_NOtgr = 1;                // наши отгрузки
  joJobType_VOpl  = 2;                // входящие оплаты
  joJobType_VOtgr = 3;                // входящие отгрузки
  joJobType_NOpl  = 4;                // наши оплаты
  joJobType_NDS   = 100;              // НДС
  
  cgMarkerName    = 'JobType_Tune';   //имя маркера для сохранения
end;
ObjInterface ObjJtTune;
!-------------------------------------------------------------------------------
  #doc
   Загрузка настроек
   cRec - ссылка на настройку для загрузки(для cgAll, cgMark - 0 )
   wType
     cgPick - загрузить одну настройку
     cgAll - загрузить все (если нет настроек возвращает )
     cgMark - помеченные из PickBuhNew
  #end
  function  LoadNastr(cRec: comp; wType: word) : boolean;
!  для тестирования. Окно со списком загруженных настроек
  procedure ShowLoadedTunes;

  #doc
  Получения названия вида деятельности(настройки)
  #end
  function  GetJTName(cRec: comp): string;

  #doc
    Получение типа вида деятельности и ссылки на настройку, для оборота
    если оборот не попадает ни в одну настройку возвращает false
  #end
  function FindJobTypeOborot(SchO: tSchet3; SubO: tSubSch; KauO: tGetKau; SchK: tSchet3; SubK: tSubSch; KauK: tGetKau;
                           var cJob: comp; var JobType: word): boolean;

  #doc
    Получение типа вида деятельности и ссылки на настройку, для оборота
    если оборот не попадает ни в одну настройку возвращает false
    поиск осуществляется только среди операций с типом НДС
  #end
  function FindJobTypeNDS(SchO: tSchet3; SubO: tSubSch; KauO: tGetKau; SchK: tSchet3; SubK: tSubSch; KauK: tGetKau;
                          var cJob: comp; var JobType: word): boolean;
  #doc
    Получение типа вида деятельности и ссылки на настройку, для сальдо
    если оборот не попадает ни в одну настройку возвращает false
  #end
  function FindJobTypeSaldo(SchO: tSchet3; SubO: tSubSch; KauO: tGetKau; var cJob: comp): boolean;
end;
!-------------------------------------------------------------------------------
VipInterface JobTypeTune
  implements ObjJtTune
  #Licensed_Free
  ;

!-------------------------------------------------------------------------------
#end

