//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - Спецоснастка
// Объектный интерфейс "Акт перевода в утиль"
//------------------------------------------------------------------------------
 
#ifndef __UTIL_MBP__vih__
#define __UTIL_MBP__vih__

#include TDocument.vih

#ifdef ComponentVersion
#component "F_MBP"
#end

#ifndef _T_MBP_Doc_
#define _T_MBP_Doc_

#ifdef ComponentVersionInDict
  public
#end
Type TMBP_Doc = Record As Table MBPMove;

#end

// Информация об Акте перевода в утиль
Type TUtilDocInfo = Record
                      Nom        : string; // Номер_документа
                      DocDate    : date;   // Дата_выписки_документа
                      OperDate   : date;   // Дата_проведения_операции
                      MCUNRec    : string; // МЦ_Ветошь_NRec
                      MCUName    : string; // МЦ_Ветошь_Наименование
                      MCUNumber  : string; // МЦ_Ветошь_Номенклатурный_номер
                      EdIzmNRec  : comp;   // МЦ_Ветошь_Единица_измерения_NRec
                      EdIzmName  : string; // МЦ_Ветошь_Единица_измерения_Наименование
                      EdIzmShNm  : string; // МЦ_Ветошь_Единица_измерение_Сокращенное_Наименование
                      EdIzmKod   : string; // МЦ_Ветошь__Единица_измерения_Код
                      PodrFrNRec : comp;   // Подразделение_Откуда_NRec
                      PodrFrName : string; // Подразделение_Откуда_Наименование
                      PodrToNRec : comp;   // Подразделение_Куда_NRec
                      PodrToName : string; // Подразделение_Куда_Наименование
                      MolFrNRec  : comp;   // МОЛ_Откуда_NRec
                      MolFrName  : string; // МОЛ_Откуда_Наименование
                      MolToNRec  : comp;   // МОЛ_Куда_NRec
                      MolToName  : string; // МОЛ_Куда_Наименование
                      DocKol     : double; // Количество_по_документу
                      DocSumma   : double; // Сумма_по_документу
                    end;

// Информация о спецификации Акта перевода в утиль
Type TUtilSpcInfo = Record
                      MBPName    : string; // Наименование_предмета
                      MBPNNumber : string; // Номенклатурный_номер_предмета
                      MBPKol     : double; // Количество_списываемых предмемтов
                      NormWeight : double; // Нормативный_вес_получаемого_утиля
                      NormPrice  : double; // Цена_получаемого_утиля
                      UtilWeight : double; // Фактический_вес_получаемого_утиля
                      UtilStoim  : double; // Фактическай_стоимость_получаемого_утиля
                    end;

#doc
Данный интерфейс описывает набор функций для работы с Актом перевода в утиль.<br>
#end
ObjInterface ObjUtil_Doc;

#doc
Функция возвращает ссылку на Акт перевода в утиль, связанный с данным Актом на списание.<br>
#end
function GetUtilDocNRec(_cSpisDoc : comp) : comp;

#doc
Функция возвращает ссылку на спецификацию Акта перевода в утиль,
связанную с данной спецификацией Акта на списание.<br>
#end
function GetUtilSpcNRec(_cSpisSpc : comp) : comp;

#doc
Функция возвращает информацию об Акте перевода в утиль.<br>
#end
function GetUtilDocInfo(_cUtilDoc : comp; var UtilDocInfo : TUtilDocInfo) : boolean;

#doc
Функция возвращает информацию о спецификации Акта перевода в утиль.<br>
#end
function GetUtilSpcInfo(_cUtilSpc : comp; var UtilSpcInfo : TUtilSpcInfo) : boolean;

#doc
Функция проверяет необходимость создания Акта перевода в утиль
для данного Акта на списание.<br>
#end
function NeedToCreateUtilDoc(_cSpisDoc : comp) : boolean;

#doc
Функция создания Акта перевода в утиль для данного Акта на списание.
Возвращает ссылку на созданный Акт перевода в утиль.<br>
#end
function CreateUtilDoc(_cSpisDoc : comp) : comp;

#doc
Процедура пересчета итогового количества и стоимости утиля по документу.<br>
#end
procedure ReCalcUtilDoc(_cUtilDoc : comp);

#doc
Функция проверяет, можно ли удалять Акт перевода в утиль.<br>
#end
function ChkDeleteUtilDoc(_cUtilDoc : comp; _bFrUtilDoc : boolean) : boolean;

#doc
Функция удаления Акта перевода в утиль.<br>
#end
function DeleteUtilDoc(_cUtilDoc : comp) : boolean;

end;

#doc
Интерфейс "Акт перевода в утиль"
#end

VipInterface Util_MBP implements TDocument, ObjUtil_Doc
  Licensed(FREE) Parameters(pCommand, pTypeDoc : word; pNRec : comp; pSubType : word);

#end // __UTIL_MBP__vih__
