//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецоснастка
// Накладные на внутренее перемещение и др. документы по спецоснастке
//------------------------------------------------------------------------------

#doc
Формирование различных печатных форм из документов спецоснастки следующих
типов: внутреннее перемещение, ввод в эксплуатацию, акт переоценки, возврат
из эксплуатации.<br>
#end
.set name = 'Move_MBP'
.NameInList 'Базовая форма'
.hide
.fields
 TipOrg      :String   // Тип организации - ОАО, ЗАО, и т.д.
 NameOrg     :string   // Название организации
 ОКПО        :string   // ОКПО собственной организации
 DocTiDk     :word
 DocNRec     :comp
 Nom         :string
 Dat         :date
 FromPodr    :String
 FromMol     :String
 FrMolShort  :String
 FromMolDlg  :String
 ToPodr      :String
 ToMol       :String
 ToMolShort  :String
 ToMolDlg    :String
 MainBuh     :String
 PersonFIO   :String
 PersonShort :String
 PersonDlg   :String
 ReqPersFIO  :String
 ReqPersSht  :String
 ReqPersDlg  :String
 LetPersFIO  :String
 LetPersSht  :String
 LetPersDlg  :String
 cSigners    :comp
.endfields
.{
123456
^^^^^^^^^^^^^^^^^^^^^^^^^^
.{
.fields
  WokerFIO  :string       // 01
  WokerTabN :string       // 02
  SpNRec    :comp         // 03
  Npp       :longint      // 04
  MbpName   :string       // 05
  MbpNum    :string       // 06
  MbpEd     :string       // 07
  MbpEdKod  :string       // 07
  MbpGrKod  :string       // 08
  MbpGrName :string       // 09
  SklNum    :string       // 10
  InvNum    :string       // 11
  PasNum    :string       // 12
  otpKol    :double       // 13
  price     :double       // 14
  sumpr     :double       // 15
  oldSumPr  :double       // 16
  SrokExp   :string       // 17
  IznKoef   :double       // 18
.endfields
//-------- Spec ----------
WokerFIO  - ^
WokerTabN - ^
^^^^^^^^^^^^^^
^^^
//--------endSpec ----------
.}
.fields
  Kol     :double
  Sum     :double      // 01
  Count   :longint     // 02
.endfields
12
^^^
.}
.endform

!======================================================================================================================

.linkform 'Move_MBP_01' prototype is Move_MBP
.Group 'Внутреннее перемещение'
.Group 'Внутреннее перемещение. Россия.'
.Group 'Внутреннее перемещение (Беларусь)'
.Group 'Внутреннее перемещение. ВСМН.'
.Group 'Возврат из эксплуатации. Россия.'
.Group 'Возврат из эксплуатации. ВСМН.'
.Group 'Передача в МЦ. Россия.'
.Group 'Передача в МЦ. ВСМН.'
.NameInList 'Стандартная накладная на внутреннее перемещение'
.declare
#include FeeSigners.vih
.endDeclare
.var
 iFeeSigners : FeeSigners;
 DocNpp, i, lSign : longint;
 FIOs, Post : array [1..2] of string;
.endvar
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 ToPodr
 FromPodr
.endfields
.begin
 DocNpp := 0;
 lSign := 0;

 for (i := 1; i <= Count(FIOs); i++)
 {
   FIOs[i] := '';
   Post[i] := '';
 }

 iFeeSigners.InitFeeSigners(cgReport_MBP);
 iFeeSigners.FindFeeSignersByNRec(cSigners);

 if (iFeeSigners.FeeSignersIsValid)
   if (iFeeSigners.GetSignerFirst)
     do
     {
       lSign++;
       FIOs[lSign] := iFeeSigners.GetSignerFIO(1);
       Post[lSign] := if (iFeeSigners.GetSignerRole <> '', iFeeSigners.GetSignerRole, iFeeSigners.GetSignerPosition(1));
     }
     while (iFeeSigners.GetSignerNext);
end.
.{
.begin
  DocNpp++;
end.
.{?Internal;(DocNpp > 1);

.}
 ^

                          НАКЛАДНАЯ НА ВНУТРЕННЕЕ ПЕРЕМЕЩЕНИЕ
                                №  Б^ Б от  Б^ Б

  Куда   : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Откуда : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Р
┌───┬────────────┬─────────────────────────────────────┬───────────┬──────────────┬───────────────┬──────────────┐
│ № │ Номенклат. │            Наименование             │  Единица  │  Количество  │     Цена      │   Стоимость  │
│п/п│   номер    │                                     │ измерения │              │               │              │
├───┼────────────┼─────────────────────────────────────┼───────────┼──────────────┼───────────────┼──────────────┤
.{
.fields
 Npp
 MbpNum
 MbpName
 MbpEd
 otpKol
 price
 sumpr
.endfields
│&&.│@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│
.}
.fields
 Sum
 FromMol
 ToMol
.endfields
└───┴────────────┴─────────────────────────────────────┴───────────┴──────────────┴───────────────┴──────────────┘
 Б Итого :                                                                                          &&&&&&&&&&&&.&& Б Р

  Сдал   : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Принял : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.begin
 i := 0;
end.
.{While (i < lSign)
.begin
 i++;
end.
.fields
 Post[i] + ': ' + FIOs[i]
.endfields
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
.endform

!======================================================================================================================

#include move_mbp.frn

!======================================================================================================================

.linkform 'Move_MBP_02' prototype is Move_MBP
.Group 'Ввод в эксплуатацию'
.Group 'Ввод в эксплуатацию. Россия.'
.Group 'Ввод в эксплуатацию. ВСМН.'
.NameInList 'Стандартная накладная на ввод в эксплуатацию'
.declare
#include FeeSigners.vih
.endDeclare
.var
 iFeeSigners : FeeSigners;
 DocNpp, i, lSign : longint;
 FIOs, Post : array [1..2] of string;
.endvar
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 ToPodr
 FromPodr
.endfields
.begin
 DocNpp := 0;
 lSign := 0;

 for (i := 1; i <= Count(FIOs); i++)
 {
   FIOs[i] := '';
   Post[i] := '';
 }

 iFeeSigners.InitFeeSigners(cgReport_MBP);
 iFeeSigners.FindFeeSignersByNRec(cSigners);

 if (iFeeSigners.FeeSignersIsValid)
   if (iFeeSigners.GetSignerFirst)
     do
     {
       lSign++;
       FIOs[lSign] := iFeeSigners.GetSignerFIO(1);
       Post[lSign] := if (iFeeSigners.GetSignerRole <> '', iFeeSigners.GetSignerRole, iFeeSigners.GetSignerPosition(1));
     }
     while (iFeeSigners.GetSignerNext);
end.
.{
.begin
  DocNpp++;
end.
.{?Internal;(DocNpp > 1);

.}
 ^

                          НАКЛАДНАЯ НА ВВОД В ЭКСПЛУАТАЦИЮ
                                №  Б^ Б от  Б^ Б

  Куда   : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Откуда : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Р
┌───┬────────────┬─────────────────────────────────────┬───────────┬──────────────┬───────────────┬──────────────┐
│ № │ Номенклат. │            Наименование             │  Единица  │  Количество  │     Цена      │   Стоимость  │
│п/п│   номер    │                                     │ измерения │              │               │              │
├───┼────────────┼─────────────────────────────────────┼───────────┼──────────────┼───────────────┼──────────────┤
.{
.fields
 Npp
 MbpNum
 MbpName
 MbpEd
 otpKol
 price
 sumpr
.endfields
│&&.│@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│
.}
└───┴────────────┴─────────────────────────────────────┴───────────┴──────────────┴───────────────┴──────────────┘
.fields
 Sum
 FromMol + if (FromMolDlg <> '', ' (' + FromMolDlg + ')', '')
 if (PersonFIO <> '',
   PersonFIO + if (PersonDlg <> '', ' (' + PersonDlg + ')', ''),
     ToMol + if (ToMolDlg <> '', ' (' + ToMolDlg + ')', ''))
.endfields
 Б Итого :                                                                                          &&&&&&&&&&&&.&& Б Р

  Сдал   : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Принял : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.begin
 i := 0;
end.
.{While (i < lSign)
.begin
 i++;
end.
.fields
 Post[i] + ': ' + FIOs[i]
.endfields
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
.endform

!======================================================================================================================

.linkform 'Move_MBP_03' prototype is Move_MBP
.Group 'Переоценка МБП'
.NameInList 'Акт переоценки'
.declare
#include FeeSigners.vih
.endDeclare
.var
 iFeeSigners : FeeSigners;
 DocNpp, i, lSign : longint;
 FIOs, Post : array [1..2] of string;
 SumOld : double;
.endvar
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 FromPodr
 FromMol
.endfields
.begin
 DocNpp := 0;
 SumOld := 0;
 lSign := 0;

 for (i := 1; i <= Count(FIOs); i++)
 {
   FIOs[i] := '';
   Post[i] := '';
 }

 iFeeSigners.InitFeeSigners(cgReport_MBP);
 iFeeSigners.FindFeeSignersByNRec(cSigners);

 if (iFeeSigners.FeeSignersIsValid)
   if (iFeeSigners.GetSignerFirst)
     do
     {
       lSign++;
       FIOs[lSign] := iFeeSigners.GetSignerFIO(1);
       Post[lSign] := if (iFeeSigners.GetSignerRole <> '', iFeeSigners.GetSignerRole, iFeeSigners.GetSignerPosition(1));
     }
     while (iFeeSigners.GetSignerNext);
end.
.{
.begin
  DocNpp++;
end.
.{?Internal;(DocNpp > 1);

.}
 ^

                                 АКТ ПЕРЕОЦЕНКИ
                             №  Б^ Б от  Б^ Б

  Подразделение : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  МОЛ           : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Р
.begin
 SumOld := 0;
end.
┌───┬────────────┬───────────────────────┬───────────┬────────┬──────────────┬──────────────┬──────────────┐
│ № │ Номенклат. │     Наименование      │  Единица  │ Кол-во │    Старая    │     Новая    │   Разница    │
│п/п│   номер    │                       │ измерения │        │   стоимость  │   стоимость  │  стоимостей  │
├───┼────────────┼───────────────────────┼───────────┼────────┼──────────────┼──────────────┼──────────────┤
.{
.begin
 SumOld := SumOld + oldSumPr;
end.
.fields
 Npp
 MbpNum
 MbpName
 MbpEd
 otpKol
 oldSumPr
 sumpr
 sumpr - oldSumPr
.endfields
│&&.│@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│&&&&&.&&│ &&&&&&&&&&.&&│ &&&&&&&&&&.&&│ &&&&&&&&&&.&&│
.}
└───┴────────────┴───────────────────────┴───────────┴────────┴──────────────┴──────────────┴──────────────┘
.fields
 SumOld Sum Sum-SumOld
.endfields
 Б Итого :                                                        &&&&&&&&&&.&&  &&&&&&&&&&.&&  &&&&&&&&&&.&& Б Р

.begin
 i := 0;
end.
.{While (i < lSign)
.begin
 i++;
end.
.fields
 Post[i]
 FIOs[i]
.endfields
  @@@@@@@@@@@@@@: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
.endform

!========================================================================================================

.linkform 'Move_MBP_05' prototype is Move_MBP
.NameInList 'Ведомость на изъятие инструмента (Форма М-30п)'
.Group 'Внутреннее перемещение (Беларусь)'
.f "MBPM_30p.OUT"
.p 80
.var
  PageKol : longint;
  PrintObr : boolean;
.endvar
.fields
 'true' : 's'
 CommonFormHeader
 NameOrg
 ОКПО
 FromPodr
 Nom
 DateToStr(Dat, 'DD/MM/YYYY')
.endfields
.{
.begin
  PageKol := 0;
  PrintObr := True;
end.
^ Р ^
                                                                                                                         Утверждена
                                                                                                         Постановлением Минпрома РБ
                                                                                                                  от 29.12.2004 №21
                                                                                                                        Форма М-30п
                                                                                                                      ┌────────────┐
                                                                                                                      │    Коды    │
                                                                                                                      ├────────────┤
                                                                                                        Форма по ОКУД │            │
                                                                                                                      ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   по ОКЮЛП │@~@@@@@@@@@@│
                                           наименование организации                                                   ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д            │            │
                                   наименование структурного подразделения                                            └────────────┘

                                                            БВЕДОМОСТЬ
                                    НА ИЗЪЯТИЕ ПОСТОЯННОГО ЗАПАСА ИНСТРУМЕНТА (ПРИСПОСОБЛЕНИЙ) Б
                                                                                                                    Таблица 1
       ┌────────────┬─────────────┬────────────────────────────────────────────────┬─────────────────────────────────────────┐
       │            │             │                        Код                     │           Корреспондирующий счет        │
       │   Номер    │    Дата     ├────────────────┬───────────────┬───────────────┼────────────────────┬────────────────────┤
       │ документа  │ составления │ вида операции  │  отправителя  │   получателя  │    счет, субсчет   │   код аналитичес-  │
       │            │             │                │               │               │                    │      кого учета    │
       ├────────────┼─────────────┼────────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┤
       │     1      │      2      │        3       │       4       │       5       │          6         │          7         │
       ├────────────┼─────────────┼────────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┤
       │@@@@@@@@@@@@│@~@@@@@@@@@@@│                │               │               │                    │                    │
       └────────────┴─────────────┴────────────────┴───────────────┴───────────────┴────────────────────┴────────────────────┘
                                                                                                                           Таблица 2
.{
.[h
.{?Internal;(PageKol mod 2 = 0);
 ┌─────────────────────────────────────────────────────────────┬─────────────────────────┬─────────────────────────────────────────┐
 │                     Инструмент (приспособление)             │    Единица измерения    │                 Изъятие                 │
 │                                                             │                         │            постоянного запаса           │
 ├──────────────────────────────────────────────┬──────────────┼────────┬────────────────┼──────────┬───────────────┬──────────────┤
 │                 наименование,                │номенклатурный│  код   │  наименование  │количество│     цена,     │    сумма,    │
 │                 размер, марка                │    номер     │        │                │          │      руб.     │     руб.     │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                        1                     │       2      │   3    │       4        │    5     │       6       │      7       │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
.}
.{?Internal;(PageKol mod 2 > 0);
                                                                                                      Оборотная сторона формы М-30п
 ┌──────────────────────────────────────────────┬──────────────┬────────┬────────────────┬──────────┬───────────────┬──────────────┐
 │                        1                     │       2      │   3    │       4        │    5     │       6       │      7       │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
.}
.]h
.fields
  MbpName
  MbpNum
  MbpEdKod
  MbpEd
  otpKol
  price
  sumpr
.endfields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@@@@@@│@@@@@@@@@@@@@@@@│&#&&&&&&&&│&#&&&&&&&&&&.&&│&#&&&&&&&&&.&&│
.[f
.fields
  FromMol
  ToMol
.endfields
.begin
  PageKol := PageKol + 1;
  PrintObr := (PageKol mod 2 > 0);
end.
 └──────────────────────────────────────────────┴──────────────┴────────┴────────────────┴──────────┴───────────────┴──────────────┘
.{?Internal;(PageKol mod 2 = 0);

 Начальник инструментального
 (планового) отдела        ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Начальник цеха            ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Бухгалтер                 ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Инструменты отпустил      ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
 Инструменты принял
 на ответственное хранение ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
.}
.{?Internal;(PageKol mod 2 > 0);

.}
.]f
.}
.{?INTERNAL;PrintObr
.fields
  FromMol
  ToMol
.endfields
                                                                                                      Оборотная сторона формы М-30п
 ┌──────────────────────────────────────────────┬──────────────┬────────┬────────────────┬──────────┬───────────────┬──────────────┐
 │                        1                     │       2      │   3    │       4        │    5     │       6       │      7       │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 └──────────────────────────────────────────────┴──────────────┴────────┴────────────────┴──────────┴───────────────┴──────────────┘

 Начальник инструментального
 (планового) отдела        ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Начальник цеха            ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Бухгалтер                 ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Инструменты отпустил      ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
 Инструменты принял
 на ответственное хранение ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
.} Р
.}
.endform

!======================================================================================================================

.linkform 'Move_MBP_06' prototype is Move_MBP
.Group 'Внутреннее перемещение (Беларусь)'
.NameInList 'Заказ на ремонт инструмента (Форма М-33п)'
.f "MBPM_33p.OUT"
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.var
 PageKol : longint;
 PrintObr : boolean;
.endvar
.fields
 'true' : 's'
 CommonFormHeader
 NameOrg
 ОКПО
 FromPodr
 Nom
 if (DateToStr(Dat, 'DD/MM/YYYY') <> string(0), DateToStr(Dat, 'DD/MM/YYYY'), '')
 FromPodr
 ToPodr
 'true' : 's'
.endfields
.{
.begin
  PageKol := 1;
  PrintObr := True;
end.
^ Р ^
                                                                                                                         Утверждена
                                                                                                         Постановлением Минпрома РБ
                                                                                                                  от 29.12.2004 №21
                                                                                                                        Форма М-33п
                                                                                                                      ┌────────────┐
                                                                                                                      │    Коды    │
                                                                                                                      ├────────────┤
                                                                                                        Форма по ОКУД │            │
                                                                                                                      ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   по ОКЮЛП │@~@@@@@@@@@@│
                                          наименование организации                                                    ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д            │            │
                                   наименование структурного подразделения                                            └────────────┘

                           БЗАКАЗ НА РЕМОНТ ИЛИ ЗАТОЧКУ ИНСТРУМЕНТА (ПРИСПОСОБЛЕНИЙ) Б
                                                                                                                      Таблица 1
               ┌────────────┬─────────────┬───────────────────────────────────────────┬─────────────────────────────┬──────────┐
               │            │             │         Структурное подразделение         │    Корреспондирующий счет   │          │
               │   Номер    │    Дата     ├─────────────────────┬─────────────────────┼─────────────┬───────────────┤          │
               │ документа  │ составления │       заказчик      │     исполнитель     │счет, субсчет│код аналитичес-│   Срок   │
               │            │             │                     │                     │             │   кого учета  │исполнения│
               ├────────────┼─────────────┼─────────────────────┼─────────────────────┼─────────────┼───────────────┼──────────┤
               │     1      │      2      │           3         │          4          │      5      │       6       │     7    │
               ├────────────┼─────────────┼─────────────────────┼─────────────────────┼─────────────┼───────────────┼──────────┤
               │@~@@@@@@@@@@│@~@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@│             │               │          │
               └────────────┴─────────────┴─────────────────────┴─────────────────────┴─────────────┴───────────────┴──────────┘
^
                                                                                                                          Таблица 2
 ┌─────────────────────────────────────────────────────────────┬───────┬────────────────┬───────┬───────────┬───────────┬──────────┐
 │                      Инструмент (приспособление)            │       │   Количество   │       │           │           │          │
 ├──────────────────────────────────────────────┬──────────────┤ Номер ├─────┬──────────┤  Вид  │  Отметка  │    Дата   │  Подпись │
 │                 наименование                 │номенклатурный│чертежа│сдано│возвращено│ремонта│или подпись│  возврата │кладовщика│
 │                                              │    номер     │       │     │          │       │ контролера│           │          │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
 │                        1                     │       2      │   3   │  4  │    5     │   6   │     7     │     8     │    9     │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
.{
.[h
.{?Internal;(PageKol > 1) and (PageKol mod 2 > 0);
                                                                                                      Оборотная сторона формы М-33п
.}
.{?Internal;(PageKol > 1);
 ┌──────────────────────────────────────────────┬──────────────┬───────┬─────┬──────────┬───────┬───────────┬───────────┬──────────┐
 │                        1                     │       2      │   3   │  4  │    5     │   6   │     7     │     8     │    9     │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
.}
.]h
.fields
  MbpName
  MbpNum
  otpKol
.endfields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│       │&#&&&│          │       │           │           │          │
.[f
.fields
  FromMol
  ToMol
.endfields
.begin
  PageKol := PageKol + 1;
  PrintObr := (PageKol mod 2 > 0);
end.
 └──────────────────────────────────────────────┴──────────────┴───────┴─────┴──────────┴───────┴───────────┴───────────┴──────────┘
.{?Internal;(PageKol mod 2 = 0);
   БСдал Б   ___________________  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
             должность              подпись                       фамилия, инициалы
  БПринял Б  ___________________  ___________________    Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
             должность              подпись                       фамилия, инициалы
.}
.{?Internal;(PageKol mod 2 > 0);

.}
.]f
.}
.{?INTERNAL;PrintObr;
.fields
  FromMol
  ToMol
.endfields
                                                                                                      Оборотная сторона формы М-33п
 ┌──────────────────────────────────────────────┬──────────────┬───────┬─────┬──────────┬───────┬───────────┬───────────┬──────────┐
 │                        1                     │       2      │   3   │  4  │    5     │   6   │     7     │     8     │    9     │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
 │                                              │              │       │     │          │       │           │           │          │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
 │                                              │              │       │     │          │       │           │           │          │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
 │                                              │              │       │     │          │       │           │           │          │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
 │                                              │              │       │     │          │       │           │           │          │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
 │                                              │              │       │     │          │       │           │           │          │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
 │                                              │              │       │     │          │       │           │           │          │
 ├──────────────────────────────────────────────┼──────────────┼───────┼─────┼──────────┼───────┼───────────┼───────────┼──────────┤
 │                                              │              │       │     │          │       │           │           │          │
 └──────────────────────────────────────────────┴──────────────┴───────┴─────┴──────────┴───────┴───────────┴───────────┴──────────┘

  БСдал Б    ___________________  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
             должность              подпись                       фамилия, инициалы
  БПринял Б  ___________________  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
             должность              подпись                       фамилия, инициалы
.} Р
.}
.endForm

!======================================================================================================================

.linkform 'Move_MBP_434' prototype is Move_MBP
.Group 'Ввод в эксплуатацию'
.Group 'Ввод в эксплуатацию. Россия.'
.Group 'Ввод в эксплуатацию. ВСМН.'
.NameInList 'Накладная-требование (Форма № 434)'
.P 80
.defo Portrait
.var
  PageKol : longint;
  PrintObr : boolean;
.endvar
.fields
 'true' : 's'
 CommonFormHeader
 NameOrg
 FromPodr
 Nom
 DateToStr(Dat,'DD')
 DateToStr(Dat,'Month')
 DateToStr(Dat,'YYYY')
 if (PersonFIO <> '', PersonFIO, ToMol)
 FromMol
 NameOrg
 FromPodr
 ToPodr
 NameOrg
 ToPodr
 FromPodr
.endfields
.{
.begin
  PageKol := 0;
  PrintObr := True;
end.
^ Р ^

   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д                                                              Форма № 434-мc
                наименование учреждения

   Отделение  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д                           Ш УТВЕРЖДАЮ Ш

                                                                                          ________________________________________
                                                                                               подпись руководителя учреждения
                                                 БНАКЛАДНАЯ (ТРЕБОВАНИЕ) №  Д@@@@@@@@ Д Б

   Основание (цель)  __________________________________________________________________    " Д@~@@@ Д"   Д@~@@@@@@@@@@@@@@@@@@@ Д  @@@@ г.

   Кому    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  Через кого   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д

  ┌──────┬──────┬───────────────────────┬─────────────────────────┬────────────────────────┬──────┬───────────────────┐
  │      │      │                       │           Склад         │      Получатель        │      │                   │
  │      │      │                       │       (отправитель)     │                        │ Вид  │        Код        │
  │Раздел│Источ-│       Учреждение      ├─────────────────────────┼────────────────────────┤опера-├─────────┬─────────┤
  │      │ ник  │                       │         Получатель      │      Отправитель       │ ции  │         │         │
  │      │      │                       │                         │                        │      │         │         │
  ├──────┼──────┼───────────────────────┼─────────────────────────┼────────────────────────┼──────┼─────────┼─────────┤
  │      │      │@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@│      │         │         │
  ├──────┼──────┼───────────────────────┼─────────────────────────┼────────────────────────┤      │         │         │
  │      │      │@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@│      │         │         │
  └──────┴──────┴───────────────────────┴─────────────────────────┴────────────────────────┴──────┴─────────┴─────────┘
.{
.[h
  ┌────────────────────────────────────────────────────┬──────┬──────────────┬──────────────────────┬──────────────┬──────────────┐
  │                                                    │ Един.│Номенклатурный│      Количество      │              │              │
  │           Наименование, сорт, размер               │измер.│     номер    ├───────────┬──────────┤     Цена     │     Сумма    │
  │                                                    │      │              │затребовано│ отпущено │              │              │
  ├────────────────────────────────────────────────────┼──────┼──────────────┼───────────┼──────────┼──────────────┼──────────────┤
.]h
.fields
  MbpName
  MbpEd
  MbpNum
  Double(0)
  otpKol
  price
  sumpr
.endfields
  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@│@@@@@@@@@@@@@@│&#'&&&&.&&&│&#'&&&.&&&│&#'&&&&&&&&.&&│&#'&&&&&&&&.&&│
.[f
.begin
  PageKol := PageKol + 1;
  PrintObr := (PageKol mod 2 > 0);
end.
  └────────────────────────────────────────────────────┴──────┴──────────────┴───────────┴──────────┴──────────────┴──────────────┘
.{?Internal;(PageKol mod 2 = 0);

  "_____"  _____________________  20___ г.               Принял (получил)                        Сдал (выдал)
.}
.{?Internal;(PageKol mod 2 > 0);

.}
.]f
.}
.{?INTERNAL;PrintObr;
                                                                                                  Оборотная сторона формы № 434-мс
  ┌────────────────────────────────────────────────────┬──────┬──────────────┬──────────────────────┬──────────────┬──────────────┐
  │                                                    │ Един.│Номенклатурный│      Количество      │              │              │
  │           Наименование, сорт, размер               │измер.│     номер    ├───────────┬──────────┤     Цена     │     Сумма    │
  │                                                    │      │              │затребовано│ отпущено │              │              │
  ├────────────────────────────────────────────────────┼──────┼──────────────┼───────────┼──────────┼──────────────┼──────────────┤
  │                                                    │      │              │           │          │              │              │
  ├────────────────────────────────────────────────────┼──────┼──────────────┼───────────┼──────────┼──────────────┼──────────────┤
  │                                                    │      │              │           │          │              │              │
  ├────────────────────────────────────────────────────┼──────┼──────────────┼───────────┼──────────┼──────────────┼──────────────┤
  │                                                    │      │              │           │          │              │              │
  ├────────────────────────────────────────────────────┼──────┼──────────────┼───────────┼──────────┼──────────────┼──────────────┤
  │                                                    │      │              │           │          │              │              │
  ├────────────────────────────────────────────────────┼──────┼──────────────┼───────────┼──────────┼──────────────┼──────────────┤
  │                                                    │      │              │           │          │              │              │
  ├────────────────────────────────────────────────────┼──────┼──────────────┼───────────┼──────────┼──────────────┼──────────────┤
  │                                                    │      │              │           │          │              │              │
  ├────────────────────────────────────────────────────┼──────┼──────────────┼───────────┼──────────┼──────────────┼──────────────┤
  │                                                    │      │              │           │          │              │              │
  └────────────────────────────────────────────────────┴──────┴──────────────┴───────────┴──────────┴──────────────┴──────────────┘

  "_____"  _____________________  20___ г.               Принял (получил)                        Сдал (выдал)
.} Р
.}
.endForm

!======================================================================================================================

.linkform 'Move_MBP_07' prototype is Move_MBP
.Group 'Изменение параметров'
.NameInList 'Акт изменения параметров'
.declare
#include FeeSigners.vih
.endDeclare
.var
 iFeeSigners : FeeSigners;
 DocNpp, i, lSign : longint;
 FIOs, Post : array [1..2] of string;
.endvar
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 FromPodr
 FromMol
.endfields
.begin
 DocNpp := 0;
 lSign := 0;

 for (i := 1; i <= Count(FIOs); i++)
 {
   FIOs[i] := '';
   Post[i] := '';
 }

 iFeeSigners.InitFeeSigners(cgReport_MBP);
 iFeeSigners.FindFeeSignersByNRec(cSigners);

 if (iFeeSigners.FeeSignersIsValid)
   if (iFeeSigners.GetSignerFirst)
     do
     {
       lSign++;
       FIOs[lSign] := iFeeSigners.GetSignerFIO(1);
       Post[lSign] := if (iFeeSigners.GetSignerRole <> '', iFeeSigners.GetSignerRole, iFeeSigners.GetSignerPosition(1));
     }
     while (iFeeSigners.GetSignerNext);
end.
.{
.begin
  DocNpp++;
end.
.{?Internal;(DocNpp > 1);

.}
 ^

                            АКТ ИЗМЕНЕНИЯ ПАРАМЕТРОВ
                             №  Б^ Б от  Б^ Б

  Подразделение : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  МОЛ           : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Р
┌───┬────────────┬─────────────────────────────────────┬───────────┬──────────────┬───────────────┬──────────────┐
│ № │ Номенклат. │            Наименование             │  Единица  │  Количество  │     Цена      │   Стоимость  │
│п/п│   номер    │                                     │ измерения │              │               │              │
├───┼────────────┼─────────────────────────────────────┼───────────┼──────────────┼───────────────┼──────────────┤
.{
.fields
 Npp
 MbpNum
 MbpName
 MbpEd
 otpKol
 price
 sumpr
.endfields
│&&.│@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│
.}
└───┴────────────┴─────────────────────────────────────┴───────────┴──────────────┴───────────────┴──────────────┘
.fields
 Sum
.endfields
 Б Итого :                                                                                           &&&&&&&&&&&.&&  Б Р

.begin
 i := 0;
end.
.{While (i < lSign)
.begin
 i++;
end.
.fields
 Post[i]
 FIOs[i]
.endfields
  @@@@@@@@@@@@@@: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
.endform
