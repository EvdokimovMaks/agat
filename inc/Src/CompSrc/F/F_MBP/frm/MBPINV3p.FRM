//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецоснастка
// Печатные формы по инвентаризации спецоснастки(ТМЦ) (формы ИНВ-3, ИНВ-19)
//------------------------------------------------------------------------------

#doc
Формирование отчеов по инвентаризации спецоснастки (ТМЦ): инвентаризационных
описей, ведомостей по итогам инвентаризации.<br>
#end
#include Commission.frn // комиссии

.Form MBPInvProtPlus
!.Group 'Инвентаризационные описи'
!.Group 'Ведомости по итогам инвентаризации'
.Group 'Сличительные ведомости'
.Hide
.Fields
#CommissionFields
  NRec    : comp
  RepType : Word
  expVal  : Word
  OrgName : String  OKPO : String  MOL : String  Podr : String
  DocDate : Date  DocNom : String
  begDate : Date  vidMC : String  placeMC : String
  ownerMC : String
  startNpp: Word
  Nom     : String
  endDate : Date
  MolPost : String
  MBPType : Word
  TipName  : Word
.endFields
  #CommissionBody(MBPInvProtPlus)
  NRec - ^
  ^ ^  ^ ^ ^ ^  ^ ^  ^ ^ ^  ^
  ^ ^ ^ ^ ^ ^
.{
.Fields
  MBPName : String  MBPKod : String
  Ed : String  EdKod : String
  Price : Double  InvNum : String  PasNum : String
  PartyKod : String PartyName : String
  State : Word  Izn : Double
  cntKol: Double  fctKol : Double  dOst : Date
  Sizes : String
.endFields
  ^ ^ ^ ^  ^ ^ ^  ^ ^  ^ ^  ^ ^  ^  ^
.}

.endForm

//-------------------------------------------------------------------------

.linkForm MBPInv01Plus Prototype is MBPInvProtPlus
.nameInList 'Инвентаризационная опись № ИНВ-3 << Россия >>'
.Group 'Инвентаризационные описи'
.Group 'Ведомости по итогам инвентаризации'
.f "MBPInv01.OUT"
.Defo landscape
.p 54
.declare
#include FeeSigners.vih
.endDeclare
.Var
  Npp : Longint  NpPg : Longint  tSum : Double
  TotCntKol : Double  PgCntKol : Double
  TotFctKol : Double  PgFctKol : Double
  TotCntSum : Double  PgCntSum : Double
  TotFctSum : Double  PgFctSum : Double
  TotCIzSum : Double  PgCIzSum : Double
  TotFIzSum : Double  PgFIzSum : Double
  StrKol : Longint
  MBPInfo : String
.endVar
.function GetKolStr(Kol : double) : string;
begin
  Kol := Round(Kol, 2);
  GetKolStr := DoubleToStr(Kol, '\f4'); // целая часть

  if (Pos('ноль', DoubleToStr(Kol, '\f5')) = 0) // дробная часть
  {
    if (DoubleToStr(Kol / 10, '8') = '1') and (DoubleToStr(Kol / 100, '88') <> '11')
      GetKolStr := GetKolStr + DoubleToStr(Kol, 'целая \f5');
    else
      GetKolStr := GetKolStr + DoubleToStr(Kol, 'целых \f5');
  }
end.
.function GetKopStr(SumKop : double) : string;
begin
  GetKopStr := DoubleToStr(SumKop, '\2p88'); // цифрами

  if (wGetTune('Country') = ccKaz) // цифрами и прописью
    GetKopStr := GetKopStr + ' (' + Trim(DoubleToStr(Double(GetKopStr), '\f4')) + ')';
end.
#CommissionLinkVar
#CommissionLinkInit(MBPInvProtPlus)
.var
  iFeeSigners : FeeSigners;
  Номер_МОЛ, Колич_МОЛ : word;
  Массив_МОЛ_ФИО : array[1..2] of string;
  Массив_МОЛ_Должность : array[1..2] of string;
  Провер_ФИО, Провер_Должность : string;
.endvar
.begin
  for (Колич_МОЛ := 1; Колич_МОЛ <= Count(Массив_МОЛ_ФИО); Колич_МОЛ++)
  {
    Массив_МОЛ_ФИО[Колич_МОЛ] := '';
    Массив_МОЛ_Должность[Колич_МОЛ] := '';
  }

  Провер_ФИО := '';
  Провер_Должность := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  // МОЛ
  Колич_МОЛ := 0;

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Otvetstv))
      if (iFeeSigners.GetSignerFirst)
        do
        {
          Колич_МОЛ++;
          Массив_МОЛ_ФИО[Колич_МОЛ] := iFeeSigners.GetSignerFIO(1);
          Массив_МОЛ_Должность[Колич_МОЛ] := iFeeSigners.GetSignerPosition(1);
        }
        while (iFeeSigners.GetSignerNext);

    iFeeSigners.ClearRestriction;
  }

  if (Колич_МОЛ = 0)
  {
    Колич_МОЛ := 3;
    Массив_МОЛ_ФИО[1] := MOL;
    Массив_МОЛ_Должность[1] := MolPost;
    Массив_МОЛ_ФИО[2] := '';
    Массив_МОЛ_Должность[2] := '';
    Массив_МОЛ_ФИО[3] := '';
    Массив_МОЛ_Должность[3] := '';
  }

  // Проверяющее лицо
  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_ProvLico))
      if (iFeeSigners.GetSignerFirst)
      {
        Провер_ФИО := iFeeSigners.GetSignerFIO(1);
        Провер_Должность := iFeeSigners.GetSignerPosition(1);
      }

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
  CommonFormHeader
  OrgName
  OKPO
  Podr
  DocNom
  if (Longint(DocDate) > 0, DateToStr(DocDate, 'DD mon YYYY г.'), '')
  if (Longint(begDate) > 0, DateToStr(begDate, 'DD mon YYYY г.'), '')
  if (Longint(endDate) > 0, DateToStr(endDate, 'DD mon YYYY г.'), '')
  Nom
  if (Longint(begDate) > 0, DateToStr(begDate, 'DD/MM/YYYY'), '')
  vidMC + placeMC
  ownerMC
.endFields
.begin
  Npp := startNpp - 1;
  TotCntKol := 0;
  TotFctKol := 0;
  TotCntSum := 0;
  TotFctSum := 0;
  TotCIzSum := 0;
  TotFIzSum := 0;
  StrKol := 1;
end.
 Р ^
                                                                                                                                                Унифицированная форма № ИНВ-3
                                                                                                                                                Утверждена постановлением Госкомстата
                                                                                                                                                России от 18.08.98  № 88
                                                                                                                                                              ┌─────────────────────┐
                                                                                                                                                              │         КОД         │
                                                                                                                                                              ╠═════════════════════╣
                                                                                                                                                Форма по ОКУД ║        0317004      ║
                                                                                                                                                              ╟─────────────────────╢
     Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е по ОКПО ║@~@@@@@@@@@@@@@@@@@@@║
                                                                                   oрганизация                                                                ╟─────────────────────╢
     Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е ║                     ║
                                                                            структурное подразделение                                                         ╟─────────────────────╢
                                                                                                                                             Вид деятельности ║                     ║
                                                                                                                                                      ┌───────╫─────────────────────╢
         Основание для проведения инвентаризации:                        приказ,     постановление,     распоряжение                                  │ Номер ║@~@@@@@@@@@@@@@@@@@@@║
                                                  ────────────────────────────────────────────────────────────────────────────────────────────────────┼───────╫─────────────────────╢
                                                                                  ненужное зачеркнуть                                                 │ Дата  ║@~@@@@@@@@@@@@@@@@@@@║
                                                                                                                                                      └───────╫─────────────────────╢
                                                                                                                                   Дата начала инвентаризации ║@~@@@@@@@@@@@@@@@@@@@║
                                                                                                                                                              ╟─────────────────────╢
                                                                                                                                Дата окончания инвентаризации ║@~@@@@@@@@@@@@@@@@@@@║
                                                                                                                                                              ╟─────────────────────╢
                                                                                                                                                 Вид операции ║                     ║
                                                                                                                                                              ╚═════════════════════╝
                                                                                                                                        ┌─────────────────┬──────────────────┐
                                                                                                                                        │ Номер документа │ Дата составления │
                                                                                                                                        ╠═════════════════╪══════════════════╣
                                                                   БИ Н В Е Н Т А Р И З А Ц И О Н Н А Я   О П И С Ь Б                       ║@~@@@@@@@@@@@@@@@│@~@@@@@@@@@@@@@@@@║
                                                                                                                                        ╚═════════════════╧══════════════════╝
                                                                            Бтоварно-материальных ценностей Б

     Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                           вид товарно-материальных ценностей
    находящиеся   Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                 в собственности организации, полученные для переработки

                                                                                Р А С П И С К А

              К началу проведения инвентаризации все расходные и приходные документы  на  товарно-материальные ценности сданы в бухгалтерию и все товарно-материальные ценности,
    поступившие на мою (нашу) ответственность, оприходованы, а выбывшие списаны в расход.

    Материально ответственное(ые) лицо(а):
.begin
  Номер_МОЛ := 0;
end.
.{ While (Номер_МОЛ < Колич_МОЛ)
.begin
  Номер_МОЛ++;
end.
.fields
  Массив_МОЛ_Должность[Номер_МОЛ]
  Массив_МОЛ_ФИО[Номер_МОЛ]
.endfields
                                              Д@@@@@@@@@@@@@@@@@@@@@@@@ Д       ________________________         Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                    (должность)                    (подпись)                                 (расшифровка подписи)

.}
    Произведено снятие фактических остатков ценностей по состоянию на "__" _________________________  ____ г.
.fields
  'true' : 's'
.endfields
^
.{
.[h
.begin
  NpPg := 0;
  PgCntKol := 0;
  PgFctKol := 0;
  PgCntSum := 0;
  PgFctSum := 0;
  PgCIzSum := 0;
  PgFIzSum := 0;
  StrKol := StrKol + 1;
end.
.Fields
  StrKol
  StrKol - 3
.endFields
.{?Internal;(StrKol <= 3);
                                                                                                                                                          @-я страница формы № ИНВ-3
.}
.{?Internal;(StrKol > 3);
                                                                                                                                                  Вкладной лист к форме № ИНВ-3 № @@
.}
┌──────┬─────────┬──────────────────────────────────────────────┬─────────────────┬─────────────┬─────────────────────┬──────────────────────────────┬──────────────────────────────┐
│      │         │                   Товарно-                   │     Единица     │             │        Номер        │      Фактическое наличие     │По данным бухгалтерского учета│
│Номер │         │            материальные  ценности            │    измерения    │             ├──────────┬──────────┼──────────┬───────────────────┼──────────┬───────────────────┤
│по по-│  Счет,  ├───────────────────────────────┬──────────────┼──────┬──────────┤    Цена     │  Инвен-  │          │          │                   │          │                   │
│рядку │ субсчет │         Наименование,         │  Код(номен-  │код по│ наимено- │  руб. коп   │  тарный  │ Паспорта │  Количе- │      Сумма,       │  Количе- │      Сумма,       │
│      │         │        характеристика         │  клатурный   │ ОКЕИ │  вание   │             │          │          │   ство   │     руб. коп      │   ство   │     руб. коп      │
│      │         │      (вид, сорт, группа)      │    номер)    │      │          │             │          │          │          │                   │          │                   │
├──────┼─────────┼───────────────────────────────┼──────────────┼──────┼──────────┼─────────────┼──────────┼──────────┼──────────┼───────────────────┼──────────┼───────────────────┤
│  1   │    2    │               3               │      4       │  5   │    6     │      7      │     8    │    9     │    10    │        11         │    12    │        13         │
├──────┼─────────┼───────────────────────────────╬══════════════╪══════╬──────────╬═════════════╪══════════╪══════════╪══════════╪═══════════════════╬──────────┼───────────────────┤
.]h
.begin
  NpPg := NpPg + 1;
  Npp  := Npp + 1;
  tSum := Price * Izn / 100;
  TotCntKol := TotCntKol + cntKol;
  TotFctKol := TotFctKol + fctKol;
  TotCntSum := TotCntSum + cntKol*Price;
  TotFctSum := TotFctSum + fctKol*Price;
  TotCIzSum := TotCIzSum + cntKol*tSum;
  TotFIzSum := TotFIzSum + fctKol*tSum;
  PgCntKol := PgCntKol + cntKol;
  PgFctKol := PgFctKol + fctKol;
  PgCntSum := PgCntSum + cntKol*Price;
  PgFctSum := PgFctSum + fctKol*Price;
  PgCIzSum := PgCIzSum + cntKol*tSum;
  PgFIzSum := PgFIzSum + fctKol*tSum;
  MBPInfo  := '';

  if ((MBPName <> '') or (MBPKod <> ''))
  {
    if (expVal = 3)
      MBPInfo := if (State = 0, 'скл', 'экс');

    if (Izn > 0)
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' изн '+ String(Izn)+ '%';

    if (PartyName <> '') and (TipName > 0)
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' партия: ' + if (TipName = 2, PartyKod, PartyName);

    if (Sizes <> '')
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' размер: ' + Sizes;

    MBPInfo := MBPName + if (MBPInfo = '', '', ' (' + MBPInfo + ')');
  }
end.
.Fields
  Npp
  MBPInfo
  MBPKod  EdKod  Ed  Price  InvNum  PasNum
  fctKol  fctKol * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price - tSum)
  cntKol  cntKol * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price - tSum)
.endFields
│&'&&& │         │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@@│@@@@@@║@@@@@@@@@@║&'&&&&&&&&.&&│@@@@@@@@@@│@@@@@@@@@@│&&&'#&&.&&│&'#&&&&&&&&&&&&&.&&║&&&'#&&.&&│&'#&&&&&&&&&&&&&.&&│
.[f
.Fields
  NpPg
  if (RepType = 0, 0.0, PgFctKol)
  if (RepType = 0, 0.0, if (wGetTune('Fin.MBP.OstStoim') = 0, PgFctSum, PgFctSum - PgFIzSum))
  PgCntKol if (wGetTune('Fin.MBP.OstStoim') = 0, PgCntSum, PgCntSum - PgCIzSum)
  DoubleToStr(NpPg, '\m4')
  if (RepType = 0, '', GetKolStr(PgFctKol))
  if (RepType = 0, '', DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, PgFctSum, PgFctSum - PgFIzSum), '\2p\m4'))
  if (RepType = 0, '', GetKopStr(if (wGetTune('Fin.MBP.OstStoim') = 0, PgFctSum, PgFctSum - PgFIzSum)))
.endFields
├──────┼─────────┴───────────────────────────────╩══════════════╧══════╩──────────╩═════════════╧══════════╧══════════╪══════════╪═══════════════════╬──────────┼───────────────────┤
│ Б&&&&&  Б│                                                                                                        БИтого Б  │ Б&&&'#&&.&& Б│ Б&'#&&&&&&&&&&&&&.&& Б│ Б&&&'&&&.&& Б│ Б&'&&&&&&&&&&&&&&.&& Б│
└──────┘                                                                                                              └──────────┴───────────────────┴──────────┴───────────────────┘
    Итого по странице:
                       а) количество порядковых номеров        Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                                                                       прописью
                       б) общее количество единиц фактически   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                                                                       прописью
                       в) на сумму фактически     Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д руб  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д коп
                                                                                     прописью
.]f
.}
.begin
  Npp := Npp - startNpp + 1
end.
.Fields
  'true' : 's'
  Npp
  if (RepType = 0, 0.0, TotFctKol)
  if (RepType = 0, 0.0, if (wGetTune('Fin.MBP.OstStoim') = 0, TotFctSum, TotFctSum - TotFIzSum))
  TotCntKol if (wGetTune('Fin.MBP.OstStoim') = 0, TotCntSum, TotCntSum - TotCIzSum)
  DoubleToStr(Npp, '\m4')
  if (RepType = 0, '', GetKolStr(TotFctKol))
  if (RepType = 0, '', DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, TotFctSum, TotFctSum - TotFIzSum), '\2p\m4'))
  if (RepType = 0, '', GetKopStr(if (wGetTune('Fin.MBP.OstStoim') = 0, TotFctSum, TotFctSum - TotFIzSum)))
.endFields
^
                                                                                                                                                          4-я страница формы № ИНВ-3
┌───────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────┬───────────────────┬──────────┬───────────────────┐
│ Б&&&&&&  Б│                                                                                       Всего по описи        │ Б&&&'#&&.&& Б│ Б&'#&&&&&&&&&&&&&.&& Б│ Б&&&'&&&.&& Б│ Б&'&&&&&&&&&&&&&&.&& Б│
└───────┘                                                                                                             └──────────┴───────────────────┴──────────┴───────────────────┘
    Итого по описи:
                       а) количество порядковых номеров       Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                                                                       прописью
                       б) общее количество единиц фактически  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                                                                       прописью
                       в) на сумму фактически   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                                                                       прописью
                       _________________________________________________________________________________________ руб  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д коп

       Все цены, подсчеты итогов по строкам, страницам и в целом по инвентаризационной описи товарно-материальных ценностей проверены.

.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
   Председатель комиссии:  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ______________________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     (должность)                             (подпись)                                          (расшифровка подписи)

.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
     @@@@@@@@@@@@@@@       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ______________________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     (должность)                             (подпись)                                          (расшифровка подписи)

.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
     Члены комиссии:      __________________________________    ______________________________    _______________________________________________________________________________
                                     (должность)                             (подпись)                                          (расшифровка подписи)

                          __________________________________    ______________________________    _______________________________________________________________________________
                                     (должность)                             (подпись)                                          (расшифровка подписи)

                          __________________________________    ______________________________    _______________________________________________________________________________
                                     (должность)                             (подпись)                                          (расшифровка подписи)

.}
.fields
  startNpp
  Npp + startNpp - 1
.endfields
    Все товарно-материальные ценности, поименованные в настоящей инвентаризационной описи с №  Д@~@@@@@@@@@@@@@@@@ Д по №  Д@~@@@@@@@@@@@@@@@ Д, комиссией проверены в натуре в моем (нашем)
присутствии и внесены в опись, в связи с чем претензий к инвентаризационной комиссии не имею (не имеем). Товарно-материальные ценности, перечисленные в описи, находятся на моем(нашем)
ответственном хранении.

    Лицо(а), ответственное(ые) за сохранность товарно-материальных ценностей:
.begin
  Номер_МОЛ := 0;
end.
.{ While (Номер_МОЛ < Колич_МОЛ)
.begin
  Номер_МОЛ++;
end.
.fields
  Массив_МОЛ_Должность[Номер_МОЛ]
  Массив_МОЛ_ФИО[Номер_МОЛ]
.endfields
                            Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д        __________________________________         Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                      (должность)                           (подпись)                                                    (расшифровка подписи)

.}
                           "      " _________________________            г.


.fields
  Провер_Должность
  Провер_ФИО
.endfields
    Указанные в настоящей описи данные и расчеты проверил    Д@@@@@@@@@@@@@@@@@@@@@@@@@ Д    __________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                   (должность)                (подпись)                                  (расшифровка подписи)

                                                            "     "  _________________________            г.
 Р
.endForm

//-------------------------------------------------------------------------

.linkForm MBPInv02Plus Prototype is MBPInvProtPlus
.nameInList 'Инвентаризационная опись'
.Group 'Инвентаризационные описи'
.Group 'Инвентаризационные описи << Беларусь >>'
.f "MBPInv02.OUT"
.Orient Portrait
.p 80
.Fields
  CommonFormHeader
  if (MBPType = 2, 'СФО', 'спецоснастки')
  placeMC
  DateToStr(begDate, '"DD" mon YYYY г.')
  Podr  MOL
  MBPKod  MBPName + if (Sizes = '', '', ' (размер: ' + Sizes + ')')
  InvNum  PasNum
  PartyName
  if ((MBPName = '') and (MBPKod = ''), '', if (State = 0, 'скл', 'эксп'))
  if (Izn > 0, String(Izn), '')
  Ed  Price
.endFields
#CommissionLinkVar
#CommissionLinkInit(MBPInvProtPlus)
 Ш ^

  Инвентаризационная опись ^ ^.
                           ^

 Склад : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 МОЛ   : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.[h
────────────────┬───────────────────────────────┬───────────┬────────────┬────────────────┬────┬──────┬───────────┬───────────┬────────┬────────────────
 Номенклатурный │         Наименование          │Инвентарный│   Номер    │     Партия     │Сост│ Износ│  Единица  │Дата выявл.│Количест│   Цена в НДЕ
     номер      │                               │   номер   │  паспорта  │                │    │   %  │ измерения │ остатков  │        │
────────────────┴───────────────────────────────┴───────────┴────────────┴────────────────┴────┴──────┴───────────┴───────────┴────────┴────────────────
.]h
@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@ &&&&&& @@@@@@@@@@@ __.__._____ ________ &'#&&&&&&&&&&.&&
.}
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Ш
.endForm

//-------------------------------------------------------------------------

.linkForm MBPInv03Plus Prototype is MBPInvProtPlus
.nameInList 'Ведомость инвентаризации'
.Group 'Ведомости по итогам инвентаризации'
.Group 'Ведомости по итогам инвентаризации << Беларусь >>'
.f "MBPInv03.OUT"
.orient Portrait
.p 80
.Fields
  CommonFormHeader
  if (MBPType = 2, 'СФО', 'спецоснастки')
  placeMC  DateToStr(begDate, '"DD" mon YYYY г.')  Podr  MOL
  MBPKod  MBPName + if (Sizes = '', '', ' (размер: ' + Sizes + ')')
  InvNum  PasNum
  PartyName
  if ((MBPName = '') and (MBPKod = ''), '', if (State = 0, 'скл', 'эксп'))
  if (Izn > 0, String(Izn), '')
  Ed  if (LongInt(dOst) > 0, DateToStr(dOst, 'DD/MM/YYYY'), '__.__.____')
  fctKol  Price
.endFields
#CommissionLinkVar
#CommissionLinkInit(MBPInvProtPlus)
 Ш^

              БВедомость инвентаризации ^ ^.
                      Дата инвентаризации ^ Б

 Склад : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 МОЛ   : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.[h
────────────────┬───────────────────────────────┬───────────┬────────────┬────────────────┬────┬──────┬───────────┬───────────┬────────┬────────────────
 Номенклатурный │         Наименование          │Инвентарный│   Номер    │     Партия     │Сост│ Износ│  Единица  │Дата выявл.│Количест│   Цена в НДЕ
     номер      │                               │   номер   │  паспорта  │                │    │   %  │ измерения │ остатков  │        │
────────────────┴───────────────────────────────┴───────────┴────────────┴────────────────┴────┴──────┴───────────┴───────────┴────────┴────────────────
.]h
@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@ &&&&&& @@@@@@@@@@@  @@@@@@@@@@ &'&&&.&& &'#&&&&&&&&&&.&&
.}
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Ш
.endForm

//-------------------------------------------------------------------------
//     Сличительные ведомости

.linkForm MBPInv04Plus Prototype is MBPInvProtPlus
.nameInList 'Сличительная ведомость'
.Group 'Сличительные ведомости'
.f "MBPInv04.OUT"
.Orient Landscape
.p 80
.Var
  totIzl, totNed : Double
.endVar
.Fields
  CommonFormHeader
  if (MBPType = 2, 'СФО', 'спецоснастки')
  placeMC
  Podr  MOL  DateToStr(begDate, 'DD/MM/YYYY')

  MBPKod  MBPName + if (Sizes = '', '', ' (размер: ' + Sizes + ')')
  InvNum  PasNum
  PartyName
  if ((MBPName = '') and (MBPKod = ''), '', if (State = 0, 'скл', 'эксп'))
  if (Izn > 0, String(Izn), '')
  Ed  DateToStr(dOst, 'DD/MM/YYYY')
  fctKol  cntKol  Price  fctKol - cntKol
  (fctKol - cntKol) * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price*(1 - Izn/100))

  totNed  totIzl
.endFields
#CommissionLinkVar
#CommissionLinkInit(MBPInvProtPlus)
.begin
  totIzl := 0;
  totNed := 0;
end.
 И ^

    В Е Д О М О С Т Ь   П О   И Т О Г А М   И Н В Е Н Т А Р И З А Ц И И  ^ ^

 Склад : ^
 МОЛ   : ^
 Дата инвентаризации : ^ И
 Ш.{
.[h
────────────────┬────────────────────────────────────────────┬─────────────┬──────────────┬────────────────┬────┬──────┬───────────┬──────────┬─────────┬─────────┬───────────────┬─────────┬───────────────────
 Номенклатурный │                Наименование                │ Инвентарный │Номер паспорта│     Партия     │Сост│ Износ│  Единица  │   Дата   │ Фактич. │Расчетный│     Цена      │ Расхож- │ Сумма расхождения
     номер      │                                            │    номер    │              │                │    │   %  │ измерения │ остатков │ остаток │ остаток │     в НДЕ     │  дение  │       в НДЕ
────────────────┴────────────────────────────────────────────┴─────────────┴──────────────┴────────────────┴────┴──────┴───────────┴──────────┴─────────┴─────────┴───────────────┴─────────┴───────────────────
.]h
.begin
  if (fctKol > cntKol) totIzl := totIzl + (fctKol - cntKol) * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price*(1 - Izn/100));
  if (fctKol < cntKol) totNed := totNed + (cntKol - fctKol) * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price*(1 - Izn/100));
end.
@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@ &&&&&& @@@@@@@@@@@ @@@@@@@@@@ &'#&&&.&& &'#&&&.&& &'&&&&&&&&&&.&& &'#&&&.&& &'#&&&&&&&&&&&&&.&&
.}
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по недостаче                                                                                                                                                                           &'#&&&&&&&&&&&&&.&&
Итого по излишку                                                                                                                                                                             &'#&&&&&&&&&&&&&.&&
 Ш
.endForm

//-------------------------------------------------------------------------

.linkForm MBPInv05Plus Prototype is MBPInvProtPlus
.nameInList 'Сличительная ведомость № ИНВ-19 << Россия >>'
.Group 'Сличительные ведомости'
.f "MBPInv05.OUT"
.p 50
.Orient LandScape
.declare
#include FeeSigners.vih
.endDeclare
.Var
  Npp : Longint
  PgIzlSum, PgNedSum, PgIzlKol, PgNedKol, PgNedIzn, PgIzlIzn : Double
  MBPInfo : String
.endVar
#CommissionLinkVar
#CommissionLinkInit(MBPInvProtPlus)
.var
  Номер_МОЛ, Колич_МОЛ : word;
  Массив_МОЛ_ФИО : array[1..2] of string;
  Массив_МОЛ_Должность : array[1..2] of string;
  Бухгалтер_ФИО : string;
  iFeeSigners : FeeSigners;
.endvar
.begin
  for (Колич_МОЛ := 1; Колич_МОЛ <= Count(Массив_МОЛ_ФИО); Колич_МОЛ++)
  {
    Массив_МОЛ_ФИО[Колич_МОЛ] := '';
    Массив_МОЛ_Должность[Колич_МОЛ] := '';
  }

  Бухгалтер_ФИО := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  // МОЛ
  Колич_МОЛ := 0;

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Otvetstv))
      if (iFeeSigners.GetSignerFirst)
        do
        {
          Колич_МОЛ++;
          Массив_МОЛ_ФИО[Колич_МОЛ] := iFeeSigners.GetSignerFIO(1);
          Массив_МОЛ_Должность[Колич_МОЛ] := iFeeSigners.GetSignerPosition(1);
        }
        while (iFeeSigners.GetSignerNext);

    iFeeSigners.ClearRestriction;
  }

  if (Колич_МОЛ = 0)
  {
    Колич_МОЛ := 2;
    Массив_МОЛ_ФИО[1] := MOL;
    Массив_МОЛ_Должность[1] := MolPost;
    Массив_МОЛ_ФИО[2] := '';
    Массив_МОЛ_Должность[2] := '';
  }

  // Бухгалтер
  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Bux))
      if (iFeeSigners.GetSignerFirst)
        Бухгалтер_ФИО := iFeeSigners.GetSignerFIO(1);

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
  CommonFormHeader
  OrgName
  OKPO
  Podr
  DocNom
  if (Longint(DocDate) > 0, DateToStr(DocDate, 'DD/MM/YYYY'), '')
  if (Longint(begDate) > 0, DateToStr(begDate, 'DD/MM/YYYY'), '')
  if (Longint(endDate) > 0, DateToStr(endDate, 'DD/MM/YYYY'), '')
.endFields
.begin
  Npp := startNpp - 1
end.
 Ш ^
                                                                                                                                                                        Унифицированная форма № ИНВ-19
                                                                                                                                                                        Утверждена постановлением Госкомстата
                                                                                                                                                                        России от 18.08.98 № 88
                                                                                                                                                                                       ┌─────────────────────┐
                                                                                                                                                                                       │         Код         │
                                                                                                                                                                                       ╠═════════════════════╣
                                                                                                                                                                        Форма по ОКУД  ║       0317017       ║
                                                                                                                                                                                       ╟─────────────────────╢
       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  по ОКПО  ║ @@@@@@@@@@@@@@@@@@@@║
       ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ╟─────────────────────╢
       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  ║                     ║
       ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╫─────────────────────╢
                                                                               структурное подразделение                                                             Вид деятельности  ║                     ║
                                                                                                                                                                             ┌─────────╫─────────────────────╢
                                                 Основание для проведения инвентаризации:                        приказ, постановление, распоряжение                         │  номер  ║@~@@@@@@@@@@@@@@@@@@@║
                                                                                          ───────────────────────────────────────────────────────────────────────────────────┼─────────╫─────────────────────╢
                                                                                                                         ненужное зачеркнуть                                 │   дата  ║@~@@@@@@@@@@@@@@@@@@@║
                                                                                                                                                                             └─────────╫─────────────────────╢
                                                                                                                                                           Дата начала инвентаризации  ║@~@@@@@@@@@@@@@@@@@@@║
                                                                                                                                                                                       ╟─────────────────────╢
                                                                                                                                                        Дата окончания инвентаризации  ║@~@@@@@@@@@@@@@@@@@@@║
                                                                                                                                                                                       ╟─────────────────────╢
                                                                                                                                                                         Вид операции  ║                     ║
                                                                                                                                                                                       ╚═════════════════════╝
                                                                                                                                              ┌────────────────────┬────────────────────┐
                                                                                                                                              │  Номер документа   │  Дата составления  │
                                                                                                                                              ╠════════════════════╪════════════════════╣
                                                                                 БС Л И Ч И Т Е Л Ь Н А Я   В Е Д О М О С Т Ь Б                   ║                    │                    ║
                                                                                                                                              ╚════════════════════╧════════════════════╝
                                                                          Брезультатов инвентаризации товарно-материальных ценностей Б

             Проведена инвентаризация фактического наличия ценностей, находящихся на ответственном хранении

.begin
  Номер_МОЛ := 0;
end.
.{ While (Номер_МОЛ < Колич_МОЛ)
.begin
  Номер_МОЛ++;
end.
.fields
  Массив_МОЛ_Должность[Номер_МОЛ]
  Массив_МОЛ_ФИО[Номер_МОЛ]
.endfields
                   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д      Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                   должность                                                                             фамилия, имя, отчество
.}

             по состоянию на  "_____" ________________________  _________ г.

             При инвентаризации установлено следующее:
.fields
  'true' : 's'
.endfields
^
.{
.[h
.begin
  PgIzlKol := 0;
  PgNedKol := 0;
  PgIzlSum := 0;
  PgNedSum := 0;
  PgIzlIzn := 0;
  PgNedIzn := 0;
end.
                                                                                                                                                                                    @NP@-я страница формы № ИНВ-19
┌───┬─────────────────────────────────────────────┬───────────────────┬───────────────────┬─────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────┐
│   │        Товарно-материальные ценности        │ Единица измерения │      Номер        │                Результаты инвентаризации                │       Отрегулировано за счет уточнения записей в учете      │
│   ├───────────────────────────────┬─────────────┼────────┬──────────┼────────┬──────────┼────────────────────────────┬────────────────────────────┼──────────────────────────────┬──────────────────────────────┤
│ № │         наименование,         │     код     │        │          │        │ паспорта │          излишек           │         недостача          │            излишек           │           недостача          │
│п/п│        характеристика         │   (номен-   │ код по │ наимено- │ инвен- │(документа├────────────┬───────────────┼────────────┬───────────────┼──────┬─────────┬─────────────┼──────┬─────────┬─────────────┤
│   │      (вид, сорт, группа)      │  клатурный  │  ОКЕИ  │  вание   │ тарный │  о ре-   │ количество │     сумма,    │ количество │     сумма,    │ коли-│  сумма, │номер счета, │ коли-│  сумма, │номер счета, │
│   │                               │    номер)   │        │          │        │гистрации │            │   руб. коп.   │            │   руб. коп.   │чество│руб. коп.│статьи,заказа│чество│руб. коп.│статьи,заказа│
├───┼───────────────────────────────┼─────────────┼────────┼──────────┼────────┼──────────┼────────────┼───────────────┼────────────┼───────────────┼──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤
│ 1 │               2               │      3      │   4    │     5    │    6   │     7    │     8      │       9       │     10     │      11       │  12  │   13    │     14      │  15  │   16    │     17      │
├───┼───────────────────────────────╬═════════════╪════════╬──────────╬════════╪══════════╪════════════╪═══════════════╪════════════╪═══════════════╬──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤
.]h
.begin
  Npp := Npp + 1;
  MBPInfo := '';

  if ((MBPName <> '') or (MBPKod <> ''))
  {
    if (expVal = 3)
      MBPInfo := if (State = 0, 'скл', 'экс');

    if (Izn > 0)
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' изн ' + String(Izn)+ '%';

    if (PartyName <> '') and (TipName > 0)
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' партия: ' + if (TipName = 2, PartyKod, PartyName);

    if (Sizes <> '')
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' размер: ' + Sizes;

    MBPInfo := MBPName + if (MBPInfo = '', '', ' (' + MBPInfo + ')');
  }

  if (fctKol > cntKol)
  {
    PgIzlKol := PgIzlKol + (fctKol - cntKol);
    PgIzlSum := PgIzlSum + (fctKol - cntKol) * Price;
    PgIzlIzn := PgIzlIzn + (fctKol - cntKol) * Price * Izn / 100;
  }

  if (fctKol < cntKol)
  {
    PgNedKol := PgNedKol + (cntKol - fctKol);
    PgNedSum := PgNedSum + (cntKol - fctKol) * Price;
    PgNedIzn := PgNedIzn + (cntKol - fctKol) * Price * Izn / 100;
  }
end.
.Fields
  Npp
  MBPInfo
  MBPKod  EdKod  Ed  InvNum  PasNum
  if (fctKol > cntKol, fctKol - cntKol, 0.0)
  if (fctKol > cntKol, (fctKol - cntKol) * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price * (1 - Izn/100)), 0.0)
  if (fctKol < cntKol, cntKol - fctKol, 0.0)
  if (fctKol < cntKol, (cntKol - fctKol) * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price * (1 - Izn/100)), 0.0)
.endFields
│&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@│@@@@@@@@║@@@@@@@@@@║@@@@@@@@│@@@@@@@@@@│&#'&&&&&&.&&│&#'&&&&&&&&&.&&│&#'&&&&&&.&&│&#'&&&&&&&&&.&&║      │         │             │      │         │             │
.[f
.Fields
  PgIzlKol  if (wGetTune('Fin.MBP.OstStoim') = 0, PgIzlSum, PgIzlSum - PgIzlIzn)
  PgNedKol  if (wGetTune('Fin.MBP.OstStoim') = 0, PgNedSum, PgNedSum - PgNedIzn)
  Бухгалтер_ФИО
.endFields
└───┴───────────────────────────────╩═════════════╧════════╩──────────╩════════╧══════════╪════════════╪═══════════════╪════════════╪═══════════════╬──────┼─────────┼─────────────┼──────┼─────────┼─────────────┤
                                                                                    БИтого Б  │&#'&&&&&&.&&│ Б&#'&&&&&&&&&.&& Б│&#'&&&&&&.&&│ Б&#'&&&&&&&&&.&& Б│      │         │             │      │         │             │
                                                                                          └────────────┴───────────────┴────────────┴───────────────┴──────┴─────────┴─────────────┴──────┴─────────┴─────────────┘

                  Бухгалтер          _________________________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                  подпись                                             расшифровка подписи
.]f
.}
.Fields
  'true' : 's'
.endFields
^
                                                                                                                                                                                     @NP@-я страница формы № ИНВ-19
┌─────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────┐
│                                         Пересортица                                         │ Приходуются окончательные излишки    │                          Окончательные недостатки                           │
├──────────────────────────────────────────────┬──────────────────────────────────────────────┼────────────┬────────────┬────────────┼─────────────────────────┬─────────────────────────┬─────────────────────────┤
│    излишки, зачтенные в покрытие недостач    │         недостачи, покрытые излишками        │            │            │            │                         │                         │                         │
├────────────┬──────────────┬──────────────────┼────────────┬──────────────┬──────────────────┤ количество │   сумма,   │   номер    ├────────────┬────────────┼────────────┬────────────┼────────────┬────────────┤
│ количество │    сумма,    │ порядковый номер │ количество │    сумма,    │ порядковый номер │            │  руб. коп. │   счета    │ количество │   сумма,   │ количество │   сумма,   │ количество │   сумма,   │
│            │   руб. коп.  │зачтенных излишков│            │   руб. коп.  │зачтенных излишков│            │            │            │            │  руб. коп. │            │  руб. коп. │            │  руб. коп. │
├────────────┼──────────────┼──────────────────┼────────────┼──────────────┼──────────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┤
│     18     │      19      │        20        │     21     │      22      │        23        │     24     │     25     │     26     │     27     │     28     │     29     │     30     │     31     │     32     │
├────────────┼──────────────┼──────────────────┼────────────┼──────────────┼──────────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┼────────────┤
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
│            │              │                  │            │              │                  │            │            │            │            │            │            │            │            │            │
└────────────┴──────────────┴──────────────────┴────────────┴──────────────┴──────────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┴────────────┘
  С результатами сличения ознакомлен:
.begin
  Номер_МОЛ := 0;
end.
.{ While (Номер_МОЛ < Колич_МОЛ)
.begin
  Номер_МОЛ++;
end.
.fields
  if (Номер_МОЛ = 1, 'Материально ответственное(ые) лицо(а)', '')
  Массив_МОЛ_Должность[Номер_МОЛ]
  Массив_МОЛ_ФИО[Номер_МОЛ]
.endfields
  &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   ___________________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                               должность                         подпись                                            расшифровка подписи
.} Ш
.endForm

//-------------------------------------------------------------------------

.linkForm MBPInv06Plus Prototype is MBPInvProtPlus
.nameInList 'Инвентаризационная опись 6-инв'
.Group 'Инвентаризационные описи << Беларусь >>'
.Group 'Ведомости по итогам инвентаризации << Беларусь >>'
.f "MBPInv06.OUT"
.Defo LandScape
.p 54
.declare
#include FeeSigners.vih
.endDeclare
.Var
  Npp : Longint  NpPg : Longint  tSum : Double
  TotCntKol : Double  PgCntKol : Double
  TotFctKol : Double  PgFctKol : Double
  TotCntSum : Double  PgCntSum : Double
  TotFctSum : Double  PgFctSum : Double
  TotCIzSum : Double  PgCIzSum : Double
  TotFIzSum : Double  PgFIzSum : Double
  MBPInfo : String
.endVar
.function GetKolStr(Kol : double) : string;
begin
  Kol := Round(Kol, 2);
  GetKolStr := DoubleToStr(Kol, '\f4'); // целая часть

  if (Pos('ноль', DoubleToStr(Kol, '\f5')) = 0) // дробная часть
  {
    if (DoubleToStr(Kol / 10, '8') = '1') and (DoubleToStr(Kol / 100, '88') <> '11')
      GetKolStr := GetKolStr + DoubleToStr(Kol, 'целая \f5');
    else
      GetKolStr := GetKolStr + DoubleToStr(Kol, 'целых \f5');
  }
end.
.function GetKopStr(SumKop : double) : string;
begin
  GetKopStr := DoubleToStr(SumKop, '\2p88'); // цифрами

  if (wGetTune('Country') = ccKaz) // цифрами и прописью
    GetKopStr := GetKopStr + ' (' + Trim(DoubleToStr(Double(GetKopStr), '\f4')) + ')';
end.
#CommissionLinkVar
#CommissionLinkInit(MBPInvProtPlus)
.var
  iFeeSigners : FeeSigners;
  Номер_МОЛ, Колич_МОЛ : word;
  Массив_МОЛ_ФИО : array[1..2] of string;
  Массив_МОЛ_Должность : array[1..2] of string;
  Провер_ФИО, Провер_Должность : string;
.endvar
.begin
  for (Колич_МОЛ := 1; Колич_МОЛ <= Count(Массив_МОЛ_ФИО); Колич_МОЛ++)
  {
    Массив_МОЛ_ФИО[Колич_МОЛ] := '';
    Массив_МОЛ_Должность[Колич_МОЛ] := '';
  }

  Провер_ФИО := '';
  Провер_Должность := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  // МОЛ
  Колич_МОЛ := 0;

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Otvetstv))
      if (iFeeSigners.GetSignerFirst)
        do
        {
          Колич_МОЛ++;
          Массив_МОЛ_ФИО[Колич_МОЛ] := iFeeSigners.GetSignerFIO(1);
          Массив_МОЛ_Должность[Колич_МОЛ] := iFeeSigners.GetSignerPosition(1);
        }
        while (iFeeSigners.GetSignerNext);

    iFeeSigners.ClearRestriction;
  }

  if (Колич_МОЛ = 0)
  {
    Колич_МОЛ := 2;
    Массив_МОЛ_ФИО[1] := MOL;
    Массив_МОЛ_Должность[1] := MolPost;
    Массив_МОЛ_ФИО[2] := '';
    Массив_МОЛ_Должность[2] := '';
  }

  // Проверяющее лицо
  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_ProvLico))
      if (iFeeSigners.GetSignerFirst)
      {
        Провер_ФИО := iFeeSigners.GetSignerFIO(1);
        Провер_Должность := iFeeSigners.GetSignerPosition(1);
      }

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
  CommonFormHeader
  Nom
  OrgName
  OKPO
  Podr
  if(DocDate = 0,'',DateToStr(DocDate, 'DD mon YYYY г.'))
  DocNom
  if (Longint(begDate) > 0, DateToStr(begDate, 'DD mon YYYY г.'), '')
  if (Longint(endDate) > 0, DateToStr(endDate, 'DD mon YYYY г.'), '')
.endFields
.begin
  Npp := startNpp - 1;
  TotCntKol := 0;
  TotFctKol := 0;
  TotCntSum := 0;
  TotFctSum := 0;
  TotCIzSum := 0;
  TotFIzSum := 0;
end.
 Ш ^
                                                                                                                                                                                                    Приложение 11
                                                                                                                                                                                   к Инструкции по инвентаризации
                                                                                                                                                                                           активов и обязательств
                                                                                                                                                                                                       Минфина РБ
                                                                                                                                                                                           от 30.11.2007 г. № 180

                                                     БИ Н В Е Н Т А Р И З А Ц И О Н Н А Я   О П И С Ь  Б
                                                     БО Б О Р О Т Н Ы Х  А К Т И В О В   № Д^ Д Б


                                                                                                                                                                                           ┌─────────────────────┐
                                                                                                                                                                               Форма 6-инв │        Коды         │
                                                                                                                                                                                           ├─────────────────────┤
                                                                                                                                                                                   по ОКУД │      05015303       │
                                                                                                                                                                                           ├─────────────────────┤
      Наименование организации  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@    по ОКЮЛП │@~@@@@@@@@@@@@@@@@@@@│
                                ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────             ├─────────────────────┤
      Структурное подразделение @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             │                     │
                                ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────    ┌────────┼─────────────────────┤
      Основание для проведения инвентаризации:                    приказ, постановление, распоряжение                                                                             │  дата  │@~@@@@@@@@@@@@@@@@@@@│
                                               ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼────────┼─────────────────────┤
                                                                           (ненужное зачеркнуть)                                                                                  │  номер │@~@@@@@@@@@@@@@@@@@@@│
                                                                                                                                                                                  └────────┼─────────────────────┤
                                                                                                                                                                Дата начала инвентаризации │@~@@@@@@@@@@@@@@@@@@@│
                                                                                                                                                                                           ├─────────────────────┤
                                                                                                                                                             Дата окончания инвентаризации │@~@@@@@@@@@@@@@@@@@@@│
                                                                                                                                                                                           └─────────────────────┘

                                                                          БР А С П И С К А Б

      К началу проведения инвентаризации все расходные и приходные документы на оборотные активы сданы в бухгалтерию и все оборотные активы, поступившие на мою (нашу) ответственность,
      оприходованы, а выбывшие списаны в расход.

      Материально ответственное(ые) лицо(а):
.begin
  Номер_МОЛ := 0;
end.
.{ While (Номер_МОЛ < Колич_МОЛ)
.begin
  Номер_МОЛ++;
end.
.fields
  Массив_МОЛ_Должность[Номер_МОЛ]
  Массив_МОЛ_ФИО[Номер_МОЛ]
.endfields
       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д       _________________________________         Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                (должность)                                (подпись)                                         (расшифровка подписи)

.}
.{
.[h
.begin
  NpPg := 0;
  PgCntKol := 0;
  PgFctKol := 0;
  PgCntSum := 0;
  PgFctSum := 0;
  PgCIzSum := 0;
  PgFIzSum := 0;
end.
                                                                                                                                                                                    @NP@-я страница формы 6-инв
    ┌───────┬─────────────────────────────────────────────────────────────────────────┬───────────────┬─────────────────────┬────────────────────────────────────────┬────────────────────────────────────────┐
    │       │                            Оборотные активы                             │               │                     │           Фактическое наличие          │     По данным бухгалтерского учета     │
    │   №   ├──────────────────────────────────────────────────────┬──────────────────┤    Единица    │     Цена, руб.      ├──────────────────┬─────────────────────┼──────────────────┬─────────────────────┤
    │  п/п  │                       наименование,                  │  номенклатурный  │   измерения   │                     │    количество    │     сумма, руб.     │    количество    │     сумма, руб.     │
    │       │                    вид, сорт, группа                 │       номер      │               │                     │                  │                     │                  │                     │
    ├───────┼──────────────────────────────────────────────────────┼──────────────────┼───────────────┼─────────────────────┼──────────────────┼─────────────────────┼──────────────────┼─────────────────────┤
    │   1   │                           2                          │        3         │       4       │          5          │        6         │          7          │        8         │          9          │
    ├───────┼──────────────────────────────────────────────────────┼──────────────────┼───────────────┼─────────────────────┼──────────────────┼─────────────────────┼──────────────────┼─────────────────────┤
.]h
.begin
  NpPg := NpPg + 1;
  Npp  := Npp + 1;
  tSum := Price * Izn / 100;
  TotCntKol := TotCntKol + cntKol;
  TotFctKol := TotFctKol + fctKol;
  TotCntSum := TotCntSum + cntKol*Price;
  TotFctSum := TotFctSum + fctKol*Price;
  TotCIzSum := TotCIzSum + cntKol*tSum;
  TotFIzSum := TotFIzSum + fctKol*tSum;
  PgCntKol := PgCntKol + cntKol;
  PgFctKol := PgFctKol + fctKol;
  PgCntSum := PgCntSum + cntKol*Price;
  PgFctSum := PgFctSum + fctKol*Price;
  PgCIzSum := PgCIzSum + cntKol*tSum;
  PgFIzSum := PgFIzSum + fctKol*tSum;
  MBPInfo := '';

  if ((MBPName <> '') or (MBPKod <> ''))
  {
    if (expVal = 3)
      MBPInfo := if (State = 0, 'скл', 'экс');

    if (Izn > 0)
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' изн ' + String(Izn) + '%';

    if (PartyName <> '') and (TipName > 0)
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' партия: ' + if(TipName = 2, PartyKod, PartyName);

    if (Sizes <> '')
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' размер: ' + Sizes;

    MBPInfo := MBPName + if (MBPInfo = '', '', ' (' + MBPInfo + ')');

    if (Trim(invNum) <> '')
      MBPInfo := MBPInfo + ' инв: ' + Trim(invNum);

    if (Trim(pasNum) <> '')
      MBPInfo := MBPInfo + ' пас: ' + Trim(pasNum);
  }
end.
.fields
  Npp
  MBPInfo
  MBPKod  Ed  Price
  fctKol  fctKol * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price - tSum)
  cntKol  cntKol * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price - tSum)
.endfields
    │@~@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&.&&│&&&&&&&&&&&'#&&.&&│&'#&&&&&&&&&&&&&&&.&&│&&&&&&&&&&&'&&&.&&│&'&&&&&&&&&&&&&&&&.&&│
.[f
.fields
  NpPg
  if (RepType = 0, 0.0, PgFctKol)
  if (RepType = 0, 0.0, if (wGetTune('Fin.MBP.OstStoim') = 0, PgFctSum, PgFctSum - PgFIzSum))
  PgCntKol  if (wGetTune('Fin.MBP.OstStoim') = 0, PgCntSum, PgCntSum - PgCIzSum)
  DoubleToStr(NpPg, '\m4')
  if (RepType = 0, '', GetKolStr(PgFctKol))
  if (RepType = 0, '', DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, PgFctSum, PgFctSum - PgFIzSum), '\2p\m4'))
  if (RepType = 0, '', GetKopStr(if (wGetTune('Fin.MBP.OstStoim') = 0, PgFctSum, PgFctSum - PgFIzSum)))
.endFields
    ├───────┼──────────────────────────────────────────────────────┴──────────────────┴───────────────┼─────────────────────┼──────────────────┼─────────────────────┼──────────────────┼─────────────────────┤
    │ Б@~@@@@@ Б│                                                                           Б         Б       │       Б ИТОГО Б         │ Б&&&&&&&&&&&'#&&.&& Б│ Б&'#&&&&&&&&&&&&&&&.&& Б│ Б&&&&&&&&&&&'&&&.&& Б│ Б&'&&&&&&&&&&&&&&&&.&& Б│
    └───────┘                                                                                         └─────────────────────┴──────────────────┴─────────────────────┴──────────────────┴─────────────────────┘

      Итого по странице: количество порядковых номеров  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
                    общее количество единиц фактически  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
                    на сумму фактически  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е руб.  Е@~@@@@@@ Е коп.
                                                                                                                     (прописью)
.]f
.}
.begin
  Npp := Npp - startNpp + 1
end.
.fields
  'true' : 's'
  Npp
  if (RepType = 0, 0.0, TotFctKol)
  if (RepType = 0, 0.0, if (wGetTune('Fin.MBP.OstStoim') = 0, TotFctSum, TotFctSum - TotFIzSum))
  TotCntKol  if (wGetTune('Fin.MBP.OstStoim') = 0, TotCntSum, TotCntSum - TotCIzSum)
  DoubleToStr(Npp, '\m4')
  if (RepType = 0, '', GetKolStr(TotFctKol))
  if (RepType = 0, '', DoubleToStr(if (wGetTune('Fin.MBP.OstStoim') = 0, TotFctSum, TotFctSum - TotFIzSum), '\2p\m4'))
  if (RepType = 0, '', GetKopStr(if (wGetTune('Fin.MBP.OstStoim') = 0, TotFctSum, TotFctSum - TotFIzSum)))
.endFields
^
                                                                                                                                                                                    @NP@-я страница формы 6-инв
    ┌───────┬─────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────┬──────────────────┬─────────────────────┬──────────────────┬─────────────────────┐
    │ Б@~@@@@@ Б│                                                                                   Б Б       │      Б    ИТОГО Б       │ Б&&&&&&&&&&&'#&&.&& Б│ Б&'#&&&&&&&&&&&&&&&.&& Б│ Б&&&&&&&&&&&'&&&.&& Б│ Б&'&&&&&&&&&&&&&&&&.&& Б│
    └───────┘                                                                                         └─────────────────────┴──────────────────┴─────────────────────┴──────────────────┴─────────────────────┘

      Итого по описи: количество порядковых номеров  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
                    общее количество единиц фактически  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
                    на сумму фактически  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е руб.  Е@~@@@@@@ Е коп.
                                                                                                                     (прописью)
.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
      Председатель комиссии:
          Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д     ________________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                     (должность)                     (подпись)                                        (расшифровка подписи)

.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
      @@@@@@@@@@@@@@@
          Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д     ________________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                     (должность)                     (подпись)                                       (расшифровка подписи)
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
      Члены комиссии:
         ___________________________________    ________________________    ___________________________________________________________________________________________________
                     (должность)                     (подпись)                                        (расшифровка подписи)

         ___________________________________    ________________________    ___________________________________________________________________________________________________
                     (должность)                     (подпись)                                        (расшифровка подписи)

         ___________________________________    ________________________    ___________________________________________________________________________________________________
                     (должность)                     (подпись)                                        (расшифровка подписи)
.}

.fields
  startNpp
  Npp + startNpp - 1
.endfields
      Все активы, поименованные в настоящей инвентаризационной описи с №  Д@~@@@@@@@@@@@@@@@@@@@ Д по №  Д@~@@@@@@@@@@@@@@@@@@@ Д комиссией проверены в натуре в моем (нашем) присутствии и внесены в опись, в связи
      с чем претензий к инвентаризационной комиссии не имею (не имеем). Активы, перечисленные в описи, находятся на моем (нашем) ответственном хранении.

      Материально ответственное(ые) лицо(а)
.begin
  Номер_МОЛ := 0;
end.
.{ While (Номер_МОЛ < Колич_МОЛ)
.begin
  Номер_МОЛ++;
end.
.fields
  Массив_МОЛ_Должность[Номер_МОЛ]
  Массив_МОЛ_ФИО[Номер_МОЛ]
.endfields
       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
            (должность)                       (подпись)                               (расшифровка подписи)

.}
.fields
  Провер_Должность
  Провер_ФИО
.endfields
      Указанные в настоящей описи данные и подсчеты проверил:
       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
            (должность)                       (подпись)                               (расшифровка подписи)
 Ш
.endform
//-------------------------------------------------------------------------

.linkForm MBPInv03Plus1 Prototype is MBPInvProtPlus
.nameInList 'Инвентаризационная опись № ИНВ-3'
.Group 'Инвентаризационные описи'
.Group 'Инвентаризационные описи << Беларусь >>'
.Group 'Ведомости по итогам инвентаризации'
.Group 'Ведомости по итогам инвентаризации << Беларусь >>'
.Hide
.f "MBPInv3.OUT"
.Defo LandScape
.p 54
.declare
#include FeeSigners.vih
.endDeclare
.Var
  Npp : Longint  NpPg : Longint  tSum : Double
  TotCntKol : Double  PgCntKol : Double
  TotFctKol : Double  PgFctKol : Double
  TotCntSum : Double  PgCntSum : Double
  TotFctSum : Double  PgFctSum : Double
  TotCIzSum : Double  PgCIzSum : Double
  TotFIzSum : Double  PgFIzSum : Double
  MBPInfo : String
.endVar
.function GetKolStr(Kol : double) : string;
begin
  Kol := Round(Kol, 2);
  GetKolStr := DoubleToStr(Kol, '\f4'); // целая часть

  if (Pos('ноль', DoubleToStr(Kol, '\f5')) = 0) // дробная часть
  {
    if (DoubleToStr(Kol / 10, '8') = '1') and (DoubleToStr(Kol / 100, '88') <> '11')
      GetKolStr := GetKolStr + DoubleToStr(Kol, 'целая \f5');
    else
      GetKolStr := GetKolStr + DoubleToStr(Kol, 'целых \f5');
  }
end.
.function GetStoimStr(Stoim : double) : string;
begin
  Stoim := Round(Stoim, 2);
  GetStoimStr := DoubleToStr(Stoim, '\m4'); // целая часть

  if (Pos('ноль', DoubleToStr(Stoim, '\f5')) = 0) // дробная часть
  {
    if (DoubleToStr(Stoim / 10, '8') = '1') and (DoubleToStr(Stoim / 100, '88') <> '11')
      GetStoimStr := DoubleToStr(Stoim, '\f4 целая \f5');
    else
      GetStoimStr := DoubleToStr(Stoim, '\f4 целых \f5');
  }
end.
#CommissionLinkVar
#CommissionLinkInit(MBPInvProtPlus)
.var
  iFeeSigners : FeeSigners;
  Номер_МОЛ, Колич_МОЛ : word;
  Массив_МОЛ_ФИО : array[1..2] of string;
  Массив_МОЛ_Должность : array[1..2] of string;
  Провер_ФИО, Провер_Должность : string;
.endvar
.begin
  for (Колич_МОЛ := 1; Колич_МОЛ <= Count(Массив_МОЛ_ФИО); Колич_МОЛ++)
  {
    Массив_МОЛ_ФИО[Колич_МОЛ] := '';
    Массив_МОЛ_Должность[Колич_МОЛ] := '';
  }

  Провер_ФИО := '';
  Провер_Должность := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  // МОЛ
  Колич_МОЛ := 0;

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Otvetstv))
      if (iFeeSigners.GetSignerFirst)
        do
        {
          Колич_МОЛ++;
          Массив_МОЛ_ФИО[Колич_МОЛ] := iFeeSigners.GetSignerFIO(1);
          Массив_МОЛ_Должность[Колич_МОЛ] := iFeeSigners.GetSignerPosition(1);
        }
        while (iFeeSigners.GetSignerNext);

    iFeeSigners.ClearRestriction;
  }

  if (Колич_МОЛ = 0)
  {
    Колич_МОЛ := 2;
    Массив_МОЛ_ФИО[1] := MOL;
    Массив_МОЛ_Должность[1] := MolPost;
    Массив_МОЛ_ФИО[2] := '';
    Массив_МОЛ_Должность[2] := '';
  }

  // Проверяющее лицо
  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_ProvLico))
      if (iFeeSigners.GetSignerFirst)
      {
        Провер_ФИО := iFeeSigners.GetSignerFIO(1);
        Провер_Должность := iFeeSigners.GetSignerPosition(1);
      }

    iFeeSigners.ClearRestriction;
  }
end.
.Fields
  CommonFormHeader
  Nom
  OrgName
  OKPO
  Podr
  DocNom
  if (Longint(DocDate) > 0, DateToStr(DocDate, 'DD mon YYYY г.'), '')
  if (Longint(begDate) > 0, DateToStr(begDate, 'DD mon YYYY г.'), '')
  if (Longint(endDate) > 0, DateToStr(endDate, 'DD mon YYYY г.'), '')
.endFields
.begin
  Npp := startNpp - 1;
  TotCntKol := 0;
  TotFctKol := 0;
  TotCntSum := 0;
  TotFctSum := 0;
  TotCIzSum := 0;
  TotFIzSum := 0;
end.
 Ш ^
                                                                                                                                                                                                    Приложение 8
                                                                                                                                                                      к Методическим указаниям по инвентаризации
                                                                                                                                                                             имущества и финансовых обязательств
                                                                                                                                                                                       от 5 декабря 1995 г. № 54

                                                     БИ Н В Е Н Т А Р И З А Ц И О Н Н А Я   О П И С Ь  Б
                                             БТ О В А Р Н О - М А Т Е Р И А Л Ь Н Ы Х   Ц Е Н Н О С Т Е Й  № Д^ Д Б

                                                                                                                                                                                           ┌─────────────────────┐
                                                                                                                                                                                           │        Коды         │
                                                                                                                                                                                           ├─────────────────────┤
                                                                                                                                                                    Форма № инв-3 по ОКУД  │       0317017       │
                                                                                                                                                                                           ├─────────────────────┤
      Предприятие (учреждение) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  по ОКПО  │@~@@@@@@@@@@@@@@@@@@@│
                               ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ├─────────────────────┤
      Структурная единица предприятия (учреждения) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           │                     │
                                                   ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────           ├─────────────────────┤
      Основание для проведения инвентаризации: приказ, постановление, распоряжение (ненужное зачеркнуть)                                                                            Номер  │@~@@@@@@@@@@@@@@@@@@@│
                                                                                                                                                                                           ├─────────────────────┤
      Дата                                                                                                                                                                                 │@~@@@@@@@@@@@@@@@@@@@│
                                                                                                                                                                                           ├─────────────────────┤
      Дата начала инвентаризации                                                                                                                                                           │@~@@@@@@@@@@@@@@@@@@@│
                                                                                                                                                                                           ├─────────────────────┤
      Дата окончания инвентаризации                                                                                                                                                        │@~@@@@@@@@@@@@@@@@@@@│
                                                                                                                                                                                           └─────────────────────┘

                                                                          БР А С П И С К А Б

      К началу проведения инвентаризации все расходные и приходные документы на товарно-материальные ценности сданы в бухгалтерию и все товарно-материальные ценности, поступившие на мою (нашу) ответственность,
      оприходованы, а выбывшие списаны в расход.

      Материально ответственное(ые) лицо(а):
.begin
  Номер_МОЛ := 0;
end.
.{ While (Номер_МОЛ < Колич_МОЛ)
.begin
  Номер_МОЛ++;
end.
.fields
  Массив_МОЛ_Должность[Номер_МОЛ]
  Массив_МОЛ_ФИО[Номер_МОЛ]
.endfields
       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д       _________________________________         Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                (должность)                                (подпись)                                         (расшифровка подписи)

.}
.{
.[h
.begin
  NpPg := 0;
  PgCntKol := 0;
  PgFctKol := 0;
  PgCntSum := 0;
  PgFctSum := 0;
  PgCIzSum := 0;
  PgFIzSum := 0;
end.
                                                                                                                                                                                   @NP@-я страница формы № ИНВ-3
    ┌───────┬─────────────────────────────────────────────────────────────────────────┬────────────────────────────┬─────────────────────┬──────────────────────────────────┬──────────────────────────────────┐
    │       │                         Товарно-материальные ценности                   │        Единица измерения   │                     │        Фактическое наличие       │  По данным бухгалтерского учета  │
    │   №   ├──────────────────────────────────────────────────────┬──────────────────┼──────────────┬─────────────┤     Цена, руб.      ├────────────┬─────────────────────┼────────────┬─────────────────────┤
    │  п/п  │                       наименование,                  │  номенклатурный  │ наименование │ код по СОЕИ │                     │ количество │     сумма, руб.     │ количество │     сумма, руб.     │
    │       │                    вид, сорт, группа                 │       номер      │              │             │                     │            │                     │            │                     │
    ├───────┼──────────────────────────────────────────────────────┼──────────────────┼──────────────┼─────────────┼─────────────────────┼────────────┼─────────────────────┼────────────┼─────────────────────┤
    │   1   │                           2                          │        3         │       4      │      5      │          6          │     7      │          8          │     9      │          10         │
    ├───────┼──────────────────────────────────────────────────────╬══════════════════╬──────────────╬═════════════╪═════════════════════╪════════════╪═════════════════════╬────────────┼─────────────────────┤
.]h
.begin
  NpPg := NpPg + 1;
  Npp  := Npp + 1;
  tSum := Price * Izn / 100;
  TotCntKol := TotCntKol + cntKol;
  TotFctKol := TotFctKol + fctKol;
  TotCntSum := TotCntSum + cntKol*Price;
  TotFctSum := TotFctSum + fctKol*Price;
  TotCIzSum := TotCIzSum + cntKol*tSum;
  TotFIzSum := TotFIzSum + fctKol*tSum;
  PgCntKol := PgCntKol + cntKol;
  PgFctKol := PgFctKol + fctKol;
  PgCntSum := PgCntSum + cntKol*Price;
  PgFctSum := PgFctSum + fctKol*Price;
  PgCIzSum := PgCIzSum + cntKol*tSum;
  PgFIzSum := PgFIzSum + fctKol*tSum;
  MBPInfo := '';

  if ((MBPName <> '') or (MBPKod <> ''))
  {
    if (expVal = 3)
      MBPInfo := if (State = 0, 'скл', 'экс');

    if (Izn > 0)
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' изн ' + String(Izn) + '%';

    if (PartyName <> '') and (TipName > 0)
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' партия: ' + if (TipName = 2, PartyKod, PartyName);

    if (Sizes <> '')
      MBPInfo := MBPInfo + if (MBPInfo = '', '', ',') + ' размер: ' + Sizes;

    MBPInfo := MBPName + if (MBPInfo = '', '', ' (' + MBPInfo + ')');

    if (Trim(invNum) <> '')
      MBPInfo := MBPInfo + ' инв: ' + Trim(invNum);

    if (Trim(pasNum) <> '')
      MBPInfo := MBPInfo + ' пас: ' + Trim(pasNum);
  }
end.
.fields
  Npp
  MBPInfo
  MBPKod  Ed  EdKod  Price
  fctKol  fctKol * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price - tSum)
  cntKol  cntKol * if (wGetTune('Fin.MBP.OstStoim') = 0, Price, Price - tSum)
.endfields
    │@~@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@@@@@@║@@@@@@@@@@@@@@║@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&.&&│&&&&&'#&&.&&│&'#&&&&&&&&&&&&&&&.&&║&&&&&'&&&.&&│&'&&&&&&&&&&&&&&&&.&&│
.[f
.fields
  NpPg
  if (RepType = 0, 0.0, PgFctKol)
  if (RepType = 0, 0.0, if (wGetTune('Fin.MBP.OstStoim') = 0, PgFctSum, PgFctSum - PgFIzSum))
  PgCntKol  if (wGetTune('Fin.MBP.OstStoim') = 0, PgCntSum, PgCntSum - PgCIzSum)
  DoubleToStr(NpPg, '\m4')
  if (RepType = 0, '', GetKolStr(PgFctKol))
  if (RepType = 0, '', GetStoimStr(if (wGetTune('Fin.MBP.OstStoim') = 0, PgFctSum, PgFctSum - PgFIzSum)))
.endFields
    ├───────┼──────────────────────────────────────────────────────╩══════════════════╩──────────────╩═════════════╪═════════════════════╪════════════╪═════════════════════╬────────────┼─────────────────────┤
    │ Б@~@@@@@ Б│                                                                                                БИТОГО Б  │                     │ Б&&&&&'#&&.&& Б│ Б&'#&&&&&&&&&&&&&&&.&& Б│ Б&&&&&'&&&.&& Б│ Б&'&&&&&&&&&&&&&&&&.&& Б│
    └───────┘                                                                                                      └─────────────────────┴────────────┴─────────────────────┴────────────┴─────────────────────┘

      Итого по странице: количество порядковых номеров  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
                    общее количество единиц фактически  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
                    на сумму, руб. фактически  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
.]f
.}
.begin
  Npp := Npp - startNpp + 1
end.
.fields
  'true' : 's'
  Npp
  if (RepType = 0, 0.0, TotFctKol)
  if (RepType = 0, 0.0, if (wGetTune('Fin.MBP.OstStoim') = 0, TotFctSum, TotFctSum - TotFIzSum))
  TotCntKol  if (wGetTune('Fin.MBP.OstStoim') = 0, TotCntSum, TotCntSum - TotCIzSum)
  DoubleToStr(Npp, '\m4')
  if (RepType = 0, '', GetKolStr(TotFctKol))
  if (RepType = 0, '', GetStoimStr(if (wGetTune('Fin.MBP.OstStoim') = 0, TotFctSum, TotFctSum - TotFIzSum)))
.endFields
^
                                                                                                                                                                                 @NP@-я страница формы № ИНВ-3
    ┌───────┬──────────────────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────┬────────────┬─────────────────────┬────────────┬─────────────────────┐
    │ Б@~@@@@@ Б│                                                                                                БИТОГО Б  │                     │ Б&&&&&'#&&.&& Б│ Б&'#&&&&&&&&&&&&&&&.&& Б│ Б&&&&&'&&&.&& Б│ Б&'&&&&&&&&&&&&&&&&.&& Б│
    └───────┘                                                                                                      └─────────────────────┴────────────┴─────────────────────┴────────────┴─────────────────────┘

      Итого по описи: количество порядковых номеров  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
                    общее количество единиц фактически  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
                    на сумму, руб. фактически  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                                                     (прописью)
.fields
  Председатель_комиссии_Должность
  Председатель_комиссии_ФИО
.endfields
      Председатель комиссии:
          Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д     ________________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                     (должность)                     (подпись)                                        (расшифровка подписи)

.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
      @@@@@@@@@@@@@@@
          Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д     ________________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                     (должность)                     (подпись)                                       (расшифровка подписи)

.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
      Члены комиссии:
         ___________________________________    ________________________    ___________________________________________________________________________________________________
                     (должность)                     (подпись)                                        (расшифровка подписи)

         ___________________________________    ________________________    ___________________________________________________________________________________________________
                     (должность)                     (подпись)                                        (расшифровка подписи)

         ___________________________________    ________________________    ___________________________________________________________________________________________________
                     (должность)                     (подпись)                                        (расшифровка подписи)

.}
.fields
  startNpp
  Npp + startNpp - 1
.endfields
      Все ценности, поименованные в настоящей инвентаризационной описи с №  Д@~@@@@@@@@@@@@@@@@@@@ Д по №  Д@~@@@@@@@@@@@@@@@@@@@ Д комиссией проверены в натуре в моем (нашем) присутствии и внесены в опись, в связи
      с чем претензий к инвентаризационной комиссии не имею (не имеем). Ценности, перечисленные в описи, находятся на моем (нашем) ответственном хранении.

      Материально ответственное(ые) лицо(а)
.begin
  Номер_МОЛ := 0;
end.
.{ While (Номер_МОЛ < Колич_МОЛ)
.begin
  Номер_МОЛ++;
end.
.fields
  Массив_МОЛ_Должность[Номер_МОЛ]
  Массив_МОЛ_ФИО[Номер_МОЛ]
.endfields
       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
            (должность)                       (подпись)                               (расшифровка подписи)

.}
.fields
  Провер_Должность
  Провер_ФИО
.endfields
      Указанные в настоящей описи данные и подсчеты проверил:
       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    ________________________    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
            (должность)                       (подпись)                               (расшифровка подписи)
 Ш
.endform
