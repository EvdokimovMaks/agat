//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецоснастка
// Накладные и др. документы по спецоснастке
//------------------------------------------------------------------------------

.linkform 'Move_MBP_011' prototype is Move_MBP
.Group 'Внутреннее перемещение'
.NameInList 'Накладная на внутреннее перемещение материалов. Форма № М-13'
.Defo Portrait
.p 80
.fields
 'true' : 's'
 CommonFormHeader
 NameOrg
 Nom
 DateToStr(Dat,'"DD" mon YYYYг.')
 FromPodr
 ToPodr
.endfields
.{
^ Р ^
                                                                                             Типовая межведомственная форма № М-13
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д      Утверждена приказом ЦСУ СССР от 14.12.72 № 816
                предприятие, организация                                                                             ┌───────────┐
                                                                                                         Код по ОКУД │ 0303010 2 │
                                                                                                                     └───────────┘
 Р
 И                                   НАКЛАДНАЯ №  Б^ Б
                         на внутреннее перемещение материалов
                                    Б^ Б
 И
 Р                                                    ┌──────────────┬────────────────────────────────┬───────────────────────────────┐
                                                    │ Вид операции │ Цех, объект, склад-отправитель │ Цех, объект, склад-получатель │
                                                    ├──────────────┼────────────────────────────────┼───────────────────────────────┤
 Б                                                    │              │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ Б
                                                    └──────────────┴────────────────────────────────┴───────────────────────────────┘
.{
.[h
┌────────────────┬───────────────────────────────────────┬─────────────┬───────────────────┬──────────────┬───────────────┬─────────┐
│  Корреспонди-  │               Материалы               │   Единицы   │    Количество     │     Цена     │     Сумма     │Порядко- │
│  рующий счет   │                                       │  измерения  │                   │              │               │вый номер│
├─────┬──────────┼───────────────────────────┬───────────┼─────┬───────┼─────────┬─────────┼──────────────┼───────────────┤записи по│
│счет,│ код ана- │    наименование, сорт,    │код(номен- │ код │ наиме-│ отправ- │ принято │              │               │складской│
│суб- │ литичес- │       размер, марка       │клатурный  │     │нование│  лено   │         │              │               │картотеке│
│счет │кого учета│                           │  номер)   │     │       │         │         │              │               │         │
├─────┼──────────┼───────────────────────────┼───────────┼─────┼───────┼─────────┼─────────┼──────────────┼───────────────┼─────────┤
│  1  │    2     │             3             │     4     │  5  │   6   │    7    │    8    │       9      │      10       │   11    │
├─────┼──────────┼───────────────────────────┼───────────┼─────┼───────┼─────────┼─────────┼──────────────┼───────────────┼─────────┤
.]h
.fields
 MbpName
 MbpNum
 MbpEdKod
 MbpEd: 'D:R'
 otpKol
 price
 sumpr
 SklNum
.endfields
│     │          │@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@│@@@@@@@│&&&&&&.&&│         │&&&&&&&&&&&.&&│&&&&&&&&&&&&.&&│@@@@@@@@@│
.[f
└─────┴──────────┴───────────────────────────┴───────────┴─────┴───────┴─────────┴─────────┴──────────────┴───────────────┴─────────┘
.]f
.}
.fields
 Sum
 '/' + LetPersFIO + '/'
 '/' + FromMol + '/'
 '/' + ToMol + '/'
.endfields
 Б                                                                                                   Итого:  &&&&&&&&&&&&.&& Б

 Разрешил _________________________________  Сдал _________________________________  Принял __________________________________
 Б          @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@       @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@         @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б Р
.}
.endform

!======================================================================================================================

.linkform 'Move_MBP_012' prototype is Move_MBP
.Group 'Внутреннее перемещение'
.Group 'Ввод в эксплуатацию'
.NameInList 'Накладная-требование на отпуск материалов. Форма № М-11'
.f "LMoveMBP.OUT"
.Defo Landscape
.p 54
.var
  Count : integer;
  TotSum : double;
  SumIzn : double;
.endVar
.fields
 'true' : 's'
 CommonFormHeader
 NameOrg
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 if ((DocTiDk = cgDoc_0731) and (PersonFIO <> ''), PersonFIO, if (ToMOL = '', ToPodr, ToMOL))
 if (FromMOL = '', FromPodr, FromMOL)

 MbpName  MbpNum  MbpEdKod  MbpEd  Double(0)  otpKol  Price  SumPr  InvNum  PasNum  SklNum

 Sum  DoubleToStr(Count, '\m4')  DoubleToStr(Sum,'\2p\m4')

 if (Pos('ноль', DoubleToStr(Sum, '\2p5')) <> 0, '=',
   DoubleToStr(Sum, '\2p88'))

 '/' + LetPersSht + '/'
 '/' + FrMolShort + '/'
 '/' + if ((DocTiDk = cgDoc_0731) and (PersonFIO <> ''), PersonShort, ToMolShort) + '/'
.endfields
.{
#include MBP_M11P.frn
.}
.endform

!======================================================================================================================

.linkform 'Move_MBP_014' prototype is Move_MBP
.Group 'Возврат из эксплуатации. Россия.'
.Group 'Возврат из эксплуатации. ВСМН.'
.Group 'Внутреннее перемещение. Россия.'
.Group 'Внутреннее перемещение. ВСМН.'
.Group 'Ввод в эксплуатацию. Россия.'
.Group 'Ввод в эксплуатацию. ВСМН.'
.Group 'Передача в МЦ. Россия.'
.Group 'Передача в МЦ. ВСМН.'
.NameInList 'Форма № М-11'
.f "MBPM_11.OUT"
.DEFP PA4
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.Var
  Tire : string;
  CurP, Counter : word;
  PrintPic : boolean;
  hCnt : longint;
.endVar
.fields
 'true' : 's'
 CommonFormHeader
 Nom  Tire  CurP
 NameOrg  ОКПО
 DateToStr(Dat,'DD/MM/YYYY')
 FromPodr
 ToPodr

 FromMOL + if (FromMolDlg <> '', ' (' + FromMolDlg + ')', '')

 if (ReqPersFIO <> '', ReqPersFIO + if (ReqPersDlg <> '', ' (' + ReqPersDlg + ')', ''),
   if ((DocTiDk = cgDoc_0731) and (PersonFIO <> ''), PersonFIO + if (PersonDlg <> '', ' (' + PersonDlg + ')', ''),
     ToMOL + if (ToMolDlg <> '', ' (' + ToMolDlg + ')', '')))

 if (LetPersFIO <> '', LetPersFIO + if (LetPersDlg <> '', ' (' + LetPersDlg + ')', ''),
   FromMOL + if (FromMolDlg <> '', ' (' + FromMolDlg + ')', ''))

 MbpName  MbpNum  MbpEdKod MbpEd  Double(0)  otpKol  Price  SumPr  SklNum

 FromMolDlg
 FrMolShort
 if ((DocTiDk = cgDoc_0731) and (PersonFIO <> ''), PersonDlg, ToMolDlg)
 if ((DocTiDk = cgDoc_0731) and (PersonFIO <> ''), PersonShort, ToMolShort)

 FromMolDlg
 FrMolShort
 if ((DocTiDk = cgDoc_0731) and (PersonFIO <> ''), PersonDlg, ToMolDlg)
 if ((DocTiDk = cgDoc_0731) and (PersonFIO <> ''), PersonShort, ToMolShort)
.endfields
.{
#include MBP_M11R.frn
.}
.endform

!======================================================================================================================
//-------------------------------------------------------------------------
//  Форма утвержденного в России образца
//-------------------------------------------------------------------------

.linkform 'Move_MBP_015' Prototype is 'Move_MBP'
.Group 'Ввод в эксплуатацию'
.Group 'Ввод в эксплуатацию. Россия.'
.Group 'Ввод в эксплуатацию. ВСМН.'
.NameInList 'Ведомость учета выдачи СФО (форма № МБ-7)'
.defo Landscape
.p 50
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  sDirect, sDirPost,
  sMol, sMolPost : string;
.endvar
.fields
 'true' : 's'
 CommonFormHeader
 Nom
 NameOrg
 ОКПО
 ToPodr
 DateToStr(Dat,'DD/MM/YYYY')
 ToPodr
.endfields
.begin
  sDirect := sDirPost := '';
  sMol := ToMol;
  sMolPost := ToMolDlg;

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Direct))
    {
      sDirect := iFeeSigners.GetSignerFIO(1);
      sDirPost := iFeeSigners.GetSignerPosition(1)
    }

    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Otvetstv))
    {
      sMol := iFeeSigners.GetSignerFIO(1);
      sMolPost := iFeeSigners.GetSignerPosition(1);
    }

    iFeeSigners.ClearRestriction;
  }
end.
.{
^ Р ^
                                                                                                                                       Типовая межотраслевая форма № MБ-7
                                                                                                                                       Утверждена постановлением Госкомстата России
                                                                                                                                       от 30.10.97 № 71а

                                               БВЕДОМОСТЬ №  Д^ Е
                                       Бучета выдачи спецодежды, спецобуви и Б
                                         Бпредохранительных приспособлений Б
                                                                                                                                                                      ┌────────────┐
                                                                                                                                                                      │    Коды    │
                                                                                                                                                                      ├────────────┤
                                                                                                                                                        Форма по ОКУД │  0320003   │
                                                                                                                                                                      ├────────────┤
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                      по ОКПО │@~@@@@@@@@@@│
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                              └────────────┘
                                                                                   ┌───────────────┬─────────────────┬─────────────────────────────────────┬───────────────────────┐
                                                                                   │      Дата     │     Код вида    │              Cтруктурное            │          Вид          │
                                                                                   │  составления  │     операции    │             подразделение           │     деятельности      │
                                                                                   ├───────────────┼─────────────────┼─────────────────────────────────────┼───────────────────────┤
                                                                                    Б│@~@@@@@@@@@@@@@│                 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                       │
                                                                                   └───────────────┴─────────────────┴─────────────────────────────────────┴───────────────────────┘ Б
.{
.[h
┌───────┬─────────────────────────────────────┬─────────┬──────────────────────────────────────────────────┬────────────────────┬──────────┬────────────┬─────────┬────────────────┐
│ Номер │                                     │Табельный│Спецодежда,спецобувь и предохранит. приспособления│ Единица измерения  │          │Дата поступ-│   Срок  │   Подпись в    │
│  по   │       Фамилия, имя, отчество        │  номер  ├─────────────────────────────┬────────────────────┼─────┬──────────────┤Количество│ления в экс-│  службы │   получении    │
│порядку│                                     │         │         Наименование        │Номенклатурный номер│ Код │ Наименование │          │ плуатацию  │         │    (сдаче)     │
├───────┼─────────────────────────────────────┼─────────┼─────────────────────────────┼────────────────────┼─────┼──────────────┼──────────┼────────────┼─────────┼────────────────┤
│   1   │                  2                  │    3    │              4              │          5         │  6  │      7       │     8    │      9     │    10   │       11       │
├───────┼─────────────────────────────────────┼─────────┼─────────────────────────────┼────────────────────┼─────┼──────────────┼──────────┼────────────┼─────────┼────────────────┤
.]h
.fields
  Npp
  WokerFIO
  WokerTabN
  MbpName
  MbpNum
  MbpEdKod
  MbpEd
  otpKol
  DateToStr(Dat, 'DD/MM/YYYY')
  if (UpCase(SrokExp) = 'ДО ИЗНОСА' or UpCase(SrokExp) = 'РАЗОВАЯ' or SrokExp = '', SrokExp,  SrokExp + ' мес.')
.endfields
│@~@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│@@@@@│@@@@@@@@@@@@@@│&'&&&&&.&&│ @@@@@@@@@@ │&&&&&&&&&│                │
.[f
└───────┴─────────────────────────────────────┴─────────┴─────────────────────────────┴────────────────────┴─────┴──────────────┴──────────┴────────────┴─────────┴────────────────┘
.]f
.}
.fields
  sMolPost
  sMol
  sDirPost
  sDirect
.endfields

  БМатериально ответственное лицо Б   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                               должность                   подпись                         расшифровка подписи
  БРуководитель подразделения Б       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                               должность                   подпись                         расшифровка подписи
    "   " ______________ 20  г. Р
.}
.endform

!========================================================================================================

.linkform 'Move_MBP_016' Prototype is 'Move_MBP'
.Group 'Ввод в эксплуатацию. Беларусь.'
.NameInList 'Ведомость учета выдачи спецодежды (форма М-38п)'
.defo Landscape
.p 50
.declare
#include FeeSigners.vih
.endDeclare
.var
 iFeeSigners : FeeSigners;
 sDirect, sDirPost,
 sMol, sMolPost,
 sBuh, sBuhPost : string;
 PageKol : longint;
.endvar
.fields
 'true' : 's'
 CommonFormHeader
 NameOrg
 ToPodr
 ОКПО
 Nom
 if (Longint(Dat) > 0, DateToStr(Dat,'DD/MM/YYYY'), '')
 ToPodr
.endfields
.begin
  sDirect := sDirPost := sBuh := sBuhPost := '';
  sMol := ToMol;
  sMolPost := ToMolDlg;

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSigners);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Direct))
    {
      sDirect := iFeeSigners.GetSignerFIO(1);
      sDirPost := iFeeSigners.GetSignerPosition(1)
    }

    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Otvetstv))
    {
      sMol := iFeeSigners.GetSignerFIO(1);
      sMolPost := iFeeSigners.GetSignerPosition(1);
    }

    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Bux))
    {
      sBuh := iFeeSigners.GetSignerFIO(1);
      sBuhPost := iFeeSigners.GetSignerPosition(1);
    }

    iFeeSigners.ClearRestriction;
  }
end.
.{
.begin
 PageKol := 0;
end.
^ Р ^
                                                                                                                                                                         Утверждена
                                                                                                                                                        Постановлением Министерства
                                                                                                                                                                  промышленности РБ
                                                                                                                                                                  от 29.12.2004 №21

                                                                                                                                                                        Форма М-38п
                                                                                                                                                                       Б┌────────────┐
                                                                                                                                                                      │    Коды    │
                                                                                                                                                                      ├────────────┤ Б
  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д            Форма по ОКУД │            │
                                                      (наименование организации)                                                                                      ├────────────┤
  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д                 по ОКЮЛП │@~@@@@@@@@@@│
                                               (наименование структурного подразделения)                                                                              ├────────────┤
                                                                                                                                                                      │            │
                                                           БВЕДОМОСТЬ Б                                                                                                   └────────────┘
                                 Бучета выдачи спецодежды, спецобуви и предохранительных приспособлений Б

 Б┌────────────────────┬────────────────┬─────────────────┬────────────────────────────────────────────────────────┬──────────────────────────────────────┐
│   Номер документа  │Дата составления│Код вида операции│               Структурное подразделение                │           Вид деятельности           │
├────────────────────┼────────────────┼─────────────────┼────────────────────────────────────────────────────────┼──────────────────────────────────────┤
│         1          │       2        │        3        │                           4                            │                  5                   │
├────────────────────┼────────────────┼─────────────────┼────────────────────────────────────────────────────────┼──────────────────────────────────────┤ Б
│@~@@@@@@@@@@@@@@@@@@│@~@@@@@@@@@@@@@@│                 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                                      │
└────────────────────┴────────────────┴─────────────────┴────────────────────────────────────────────────────────┴──────────────────────────────────────┘

.{
.[h
.{?Internal;(PageKol = 0);
 Б┌───────┬─────────────────────────────────────┬─────────┬──────────────────────────────────────────────────┬────────────────────┬──────────┬────────────┬─────────┬────────────────┐
│       │                                     │         │             Спецодежда, спецобувь и              │      Единица       │          │    Дата    │         │    Подпись     │
│   №   │       Фамилия, имя, отчество        │Табельный│         предохранительные приспособления         │     измерения      │Количество│поступления │  Срок   │       в        │
│  п/п  │                                     │  номер  ├─────────────────────────────┬────────────────────┼─────┬──────────────┤          │     в      │ службы  │   получении    │
│       │                                     │         │         Наименование        │Номенклатурный номер│ Код │ Наименование │          │эксплуатацию│         │    (сдаче)     │
├───────┼─────────────────────────────────────┼─────────┼─────────────────────────────┼────────────────────┼─────┼──────────────┼──────────┼────────────┼─────────┼────────────────┤
│   1   │                  2                  │    3    │              4              │          5         │  6  │      7       │     8    │     9      │   10    │       11       │
├───────┼─────────────────────────────────────┼─────────┼─────────────────────────────┼────────────────────┼─────┼──────────────┼──────────┼────────────┼─────────┼────────────────┤ Б
.}
.{?Internal;(PageKol > 0);
                                                                                                                                                      Оборотная сторона формы М-38п
 Б┌───────┬─────────────────────────────────────┬─────────┬─────────────────────────────┬────────────────────┬─────┬──────────────┬──────────┬────────────┬─────────┬────────────────┐
│   1   │                  2                  │    3    │              4              │          5         │  6  │      7       │     8    │     9      │   10    │       11       │
├───────┼─────────────────────────────────────┼─────────┼─────────────────────────────┼────────────────────┼─────┼──────────────┼──────────┼────────────┼─────────┼────────────────┤ Б
.}
.]h
.fields
  Npp
  WokerFIO
  WokerTabN
  MbpName
  MbpNum
  MbpEdKod
  MbpEd
  otpKol
  if (Longint(Dat) > 0, DateToStr(Dat, 'DD/MM/YYYY'), '')
  if (UpCase(SrokExp) = 'ДО ИЗНОСА' or UpCase(SrokExp) = 'РАЗОВАЯ' or SrokExp = '', SrokExp,  SrokExp + ' мес.')
.endfields
│@~@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│@@@@@│@@@@@@@@@@@@@@│&'&&&&&.&&│ @@@@@@@@@@ │&&&&&&&&&│                │
.[f
.begin
  PageKol := PageKol + 1;
end.
└───────┴─────────────────────────────────────┴─────────┴─────────────────────────────┴────────────────────┴─────┴──────────────┴──────────┴────────────┴─────────┴────────────────┘
.]f
.}
.fields
  sMolPost sMol
  sDirPost sDirect
  sBuhPost sBuh
.endfields

 Материально ответственное лицо   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              (должность)                   (подпись)                           (инициалы, фамилия)
 Руководитель                     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              (должность)                   (подпись)                           (инициалы, фамилия)
 Проверил бухгалтер               Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                              (должность)                   (подпись)                           (инициалы, фамилия) Р
.}
.endform

!========================================================================================================
