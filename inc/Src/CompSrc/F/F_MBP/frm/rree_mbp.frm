//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецоснастка
// Печатная форма для вывода реестров документов спецоснастки
//------------------------------------------------------------------------------

#doc
Печать реестра документов по спецоснастке.<br>
#end
.Set Name = 'rRee_MBPProt'
.Hide
.Fields
  DocsType : String
  frDate : Date
  toDate : Date
  RazrFiltr : String
  MyOrgName : String
  NDE_ShName : String
.endFields

// Шапка реестра

  ^  ^  ^  ^  ^  ^

.{ // Список документов

.Fields
  fDate : Date  fNumber : String  fSumma : Double
  fPodrTo : String  fMOLTo : String  fPersTo : String
  fPodrFr : String  fMOLFr : String
  fMBPMoveNrec fDesGr : String fDescr : String
.endFields
  fDate   ^
  fNumber ^
  fSumma  ^
  fPodrTo ^
  fMOLTo  ^
  fPersTo ^
  fPodrFr ^
  fMOLFr  ^
  fMBPMoveNrec ^
  fDesGr  ^
  fDescr  ^
.{ ReeMBPDocSpec CheckEnter // Спецификация документа

.Fields
   fMBPKod : String  fMBPName : String  fEd : String
   fKol : Double  fPrice : Double  fPerc : Double  fStoim : Double
   fDopInfo : String
   fPodr: String
   fMOL : String
   fMBPNrec
   fMBPInNrec
   fMBPOutNrec
.endFields
// Спецификация документа
   fMBPKod   -  ^
   fMBPName  -  ^
   fEd       -  ^
   fKol      -  ^
   fPrice    -  ^
   fPerc     -  ^
   fStoim    -  ^
   fDopInfo  -  ^
   fPodr     -  ^
   fMOL      -  ^
   fMBPNrec  -  ^
   fMBPInNrec - ^
   fMBPOutNrec - ^
// конец Спецификация документа
.}
.}

.{ CheckEnter FeeSignersCycle_rRee_MBPProt
.Fields
  Подписант_nRec : comp
  Подписант_ФИО : String
  Подписант_Табельный_Номер : String
  Подписант_Должность : String
  Подписант_Роль : String
.EndFields
  ^ ^ ^ ^ ^
.}
.endForm

//-------------------------------------------------------------------------

.LinkFORM rRee_MBP_01 Prototype Is rRee_MBPProt
.NameInList 'Краткий реестр вводов в эксплуатацию'
.Group 'Краткий реестр вводов в эксплуатацию'
.Fields
   CommonFormHeader  MyOrgName
   DocsType  frDate  toDate  RazrFiltr
.endFields
.Var
  NumDocs : Longint
  ReeItog : Double
.endVar
.begin
  NumDocs := 0;
  ReeItog := 0;
end.
 Ш ^
 ^

            Реестр  Б^ Б за период с  Б^ Б по  Б^ Б
 ^
.{
.[h
.Fields
  NDE_ShName
.endFields
──────────┬───────────┬───────────────────────────────────────────┬─────────────────────────────────────────────────────────────────┬─────── стр.@NP@
          │           │                   Откуда                  │                              Куда                               │
   Дата   │   Номер   ├─────────────────────┬─────────────────────┼─────────────────────┬─────────────────────┬─────────────────────┤     Сумма,
          │           │    Подразделение    │         МОЛ         │    Подразделение    │         МОЛ         │       Работник      │@~@@@@@@@@@@@@@@
──────────┴───────────┴─────────────────────┴─────────────────────┴─────────────────────┴─────────────────────┴─────────────────────┴────────────────
.]h
.Fields
  fDate
  fNumber
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fPodrFr, SubStr(fPodrFr, 1, 21))
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fMOLFr, SubStr(fMOLFr, 1, 21))
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fPodrTo, SubStr(fPodrTo, 1, 21))
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fMOLTo, SubStr(fMOLTo, 1, 21))
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fPersTo, SubStr(fPersTo, 1, 21))
  fSumma
.endFields
.begin
  NumDocs := NumDocs + 1;
  ReeItog := ReeItog + fSumma;
end.
@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&&
.{ReeMBPDocSpec CheckEnter
.}
.}
.Fields
  NumDocs  ReeItog
.endFields
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру      документов &&&&&     на  сумму                                                                      &'&&&&&&&&&&&&&&&&&&&&&&.&&
.{ CheckEnter FeeSignersCycle_rRee_MBPProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    _______________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                должность                           подпись                                расшифровка подписи
.} Ш
.endForm

//-------------------------------------------------------------------------

.LinkFORM rRee_MBP_04 Prototype Is rRee_MBPProt
.NameInList 'Подробный реестр вводов в эксплуатацию'
.Group 'Подробный реестр вводов в эксплуатацию'
.Fields
   CommonFormHeader  MyOrgName
   DocsType  frDate  toDate  RazrFiltr
.endFields
.Var
  NumDocs : Longint
  ReeItog : Double
.endVar
.begin
  NumDocs := 0;
  ReeItog := 0;
end.
 Ш ^
  ^

            Подробный реестр  Б^ Б за период с  Б^ Б по  Б^ Б
 ^
.{
.[h
.Fields
  NDE_ShName
.endFields
──────────┬───────────┬───────────────────────────────────────────┬─────────────────────────────────────────────────────────────────┬─────── стр.@NP@
          │           │                   Откуда                  │                              Куда                               │
   Дата   │   Номер   ├─────────────────────┬─────────────────────┼─────────────────────┬─────────────────────┬─────────────────────┤     Сумма,
          │           │    Подразделение    │         МОЛ         │    Подразделение    │         МОЛ         │       Работник      │@~@@@@@@@@@@@@@@
──────────┴───────────┴─────────────────────┴─────────────────────┴─────────────────────┴─────────────────────┴─────────────────────┴────────────────
.]h
.Fields
  fDate
  fNumber
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fPodrFr, SubStr(fPodrFr, 1, 21))
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fMOLFr, SubStr(fMOLFr, 1, 21))
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fPodrTo, SubStr(fPodrTo, 1, 21))
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fMOLTo, SubStr(fMOLTo, 1, 21))
  if (wGetTune('Fin.MBP.HighPodrToRep') = 1, fPersTo, SubStr(fPersTo, 1, 21))
  fSumma
.endFields
.begin
  NumDocs := NumDocs + 1;
  ReeItog := ReeItog + fSumma;
end.
 Б@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&& Б
.{ReeMBPDocSpec CheckEnter
.[h
──────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]h
.Fields
  fMBPKod  SubStr(fMBPName, 1, 30)  fKol  SubStr(fEd, 1, 10)  fPrice  fPerc  fDopInfo  fStoim
.endFields
          │@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&.&& @@@@@@@@@@ &'&&&&&&&&&&&.&& &&&.&&% @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&&
.[f
───────── └──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]f
.}
.}
.Fields
  NumDocs  ReeItog
.endFields
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру      документов &&&&&     на  сумму                                                                      &'&&&&&&&&&&&&&&&&&&&&&&.&&
.{ CheckEnter FeeSignersCycle_rRee_MBPProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    _______________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                должность                           подпись                                расшифровка подписи
.} Ш
.endForm

//-------------------------------------------------------------------------

.LinkFORM rRee_MBP_02 Prototype Is rRee_MBPProt
.NameInList 'Краткий реестр перемещений'
.Group 'Краткий реестр перемещений'
.Fields
   CommonFormHeader  MyOrgName
   DocsType  frDate  toDate  RazrFiltr
.endFields
.Var
  NumDocs : Longint
  ReeItog : Double
.endVar
.begin
  NumDocs := 0;
  ReeItog := 0;
end.
 Ш ^
 ^

            Реестр  Б^ Б за период с  Б^ Б по  Б^ Б
 ^
.{
.[h
.Fields
  NDE_ShName
.endFields
──────────┬─────────────────────┬─────────────────────────────────────────────────┬─────────────────────────────────────────────────┬─────── стр.@NP@
          │                     │                      Откуда                     │                      Куда                       │
   Дата   │        Номер        ├────────────────────────┬────────────────────────┼────────────────────────┬────────────────────────┤     Сумма,
          │                     │      Подразделение     │          МОЛ           │      Подразделение     │          МОЛ           │@~@@@@@@@@@@@@@@
──────────┴─────────────────────┴────────────────────────┴────────────────────────┴────────────────────────┴────────────────────────┴────────────────
.]h
.Fields
  fDate  fNumber
  SubStr(fPodrFr, 1, 24)  SubStr(fMOLFr, 1, 24)
  SubStr(fPodrTo, 1, 24)  SubStr(fMOLTo, 1, 24)
  fSumma
.endFields
.begin
  NumDocs := NumDocs + 1;
  ReeItog := ReeItog + fSumma;
end.
@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&&
.{ReeMBPDocSpec CheckEnter
.}
.}
.Fields
  NumDocs  ReeItog
.endFields
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру      документов &&&&&     на  сумму                                                                      &'&&&&&&&&&&&&&&&&&&&&&&.&&
.{ CheckEnter FeeSignersCycle_rRee_MBPProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    _______________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                должность                           подпись                                расшифровка подписи
.} Ш
.endForm

//-------------------------------------------------------------------------

.LinkFORM rRee_MBP_05 Prototype Is rRee_MBPProt
.NameInList 'Подробный реестр перемещений'
.Group 'Подробный реестр перемещений'
.Fields
   CommonFormHeader  MyOrgName
   DocsType  frDate  toDate  RazrFiltr
.endFields
.Var
  NumDocs : Longint
  ReeItog : Double
.endVar
.begin
  NumDocs := 0;
  ReeItog := 0;
end.
 Ш ^
 ^

            Подробный реестр  Б^ Б за период с  Б^ Б по  Б^ Б
 ^
.{
.[h
.Fields
  NDE_ShName
.endFields
──────────┬─────────────────────┬─────────────────────────────────────────────────┬─────────────────────────────────────────────────┬─────── стр.@NP@
          │                     │                      Откуда                     │                      Куда                       │
   Дата   │        Номер        ├────────────────────────┬────────────────────────┼────────────────────────┬────────────────────────┤     Сумма,
          │                     │      Подразделение     │          МОЛ           │      Подразделение     │          МОЛ           │@~@@@@@@@@@@@@@@
──────────┴─────────────────────┴────────────────────────┴────────────────────────┴────────────────────────┴────────────────────────┴────────────────
.]h
.Fields
  fDate  fNumber
  SubStr(fPodrFr, 1, 24)  SubStr(fMOLFr, 1, 24)
  SubStr(fPodrTo, 1, 24)  SubStr(fMOLTo, 1, 24)
  fSumma
.endFields
.begin
  NumDocs := NumDocs + 1;
  ReeItog := ReeItog + fSumma;
end.
 Б@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&& Б
.{ReeMBPDocSpec CheckEnter
.[h
──────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]h
.Fields
  fMBPKod  SubStr(fMBPName, 1, 30)  fKol  SubStr(fEd, 1, 10)  fPrice  fPerc  fDopInfo  fStoim
.endFields
          │@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&.&& @@@@@@@@@@ &'&&&&&&&&&&&.&& &&&.&&% @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&&
.[f
───────── └──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]f
.}
.}
.Fields
  NumDocs  ReeItog
.endFields
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру      документов &&&&&     на  сумму                                                                      &'&&&&&&&&&&&&&&&&&&&&&&.&&
.{ CheckEnter FeeSignersCycle_rRee_MBPProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    _______________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                должность                           подпись                                расшифровка подписи
.} Ш
.endForm

//-------------------------------------------------------------------------

.LinkFORM rRee_MBP_03 Prototype Is rRee_MBPProt
.NameInList 'Краткий реестр списаний'
.Group 'Краткий реестр списаний'
.Fields
   CommonFormHeader  MyOrgName
   DocsType  frDate  toDate  RazrFiltr
.endFields
.Var
  NumDocs : Longint
  ReeItog : Double
.endVar
.begin
  NumDocs := 0;
  ReeItog := 0;
end.
 Ш ^
 ^

            Реестр  Б^ Б за период с  Б^ Б по  Б^ Б
 ^
.{
.[h
.Fields
  NDE_ShName
.endFields
──────────┬─────────────────────┬─────────────────────────────────────────────────┬─────────────────────────────────────────────────┬─────── стр.@NP@
   Дата   │        Номер        │                  Подразделение                  │                       МОЛ                       │  Сумма, @@@@@@
──────────┴─────────────────────┴─────────────────────────────────────────────────┴─────────────────────────────────────────────────┴────────────────
.]h
.Fields
  fDate  fNumber  SubStr(fPodrTo, 1, 49)  SubStr(fMOLTo, 1, 49)  fSumma
.endFields
.begin
  NumDocs := NumDocs + 1;
  ReeItog := ReeItog + fSumma;
end.
@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&&
.{ReeMBPDocSpec CheckEnter
.}
.}
.Fields
  NumDocs  ReeItog
.endFields
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру      документов &&&&&     на  сумму                                                                      &'&&&&&&&&&&&&&&&&&&&&&&.&&
.{ CheckEnter FeeSignersCycle_rRee_MBPProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    _______________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                должность                           подпись                                расшифровка подписи
.} Ш
.endForm

//-------------------------------------------------------------------------

.LinkFORM rRee_MBP_06 Prototype Is rRee_MBPProt
.NameInList 'Подробный реестр списаний'
.Group 'Подробный реестр списаний'
.Fields
   CommonFormHeader  MyOrgName
   DocsType  frDate  toDate  RazrFiltr
.endFields
.Var
  NumDocs : Longint
  ReeItog : Double
.endVar
.begin
  NumDocs := 0;
  ReeItog := 0;
end.
 Ш ^
 ^

            Подробный реестр  Б^ Б за период с  Б^ Б по  Б^ Б
 ^
.{
.[h
.Fields
  NDE_ShName
.endFields
──────────┬─────────────────────┬─────────────────────────────────────────────────┬─────────────────────────────────────────────────┬─────── стр.@NP@
   Дата   │        Номер        │                  Подразделение                  │                       МОЛ                       │  Сумма, @@@@@@
──────────┴─────────────────────┴─────────────────────────────────────────────────┴─────────────────────────────────────────────────┴────────────────
.]h
.Fields
  fDate  fNumber  SubStr(fPodrTo, 1, 49)  SubStr(fMOLTo, 1, 49)  fSumma
.endFields
.begin
  NumDocs := NumDocs + 1;
  ReeItog := ReeItog + fSumma;
end.
 Б@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&& Б
.{ReeMBPDocSpec CheckEnter
.[h
──────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]h
.Fields
  fMBPKod  SubStr(fMBPName, 1, 30)  fKol  SubStr(fEd, 1, 10)  fPrice  fPerc  fDopInfo  fStoim
.endFields
          │@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&.&& @@@@@@@@@@ &'&&&&&&&&&&&.&& &&&.&&% @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&&
.[f
───────── └──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]f
.}
.}
.Fields
  NumDocs  ReeItog
.endFields
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру      документов &&&&&     на  сумму                                                                      &'&&&&&&&&&&&&&&&&&&&&&&.&&
.{ CheckEnter FeeSignersCycle_rRee_MBPProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    _______________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                должность                           подпись                                расшифровка подписи
.} Ш
.endForm

//-------------------------------------------------------------------------
.LinkFORM rRee_MBP_07 Prototype Is rRee_MBPProt
.NameInList 'Краткий реестр'
.Group 'Краткий реестр'
.Fields
   CommonFormHeader  MyOrgName
   DocsType  frDate  toDate  RazrFiltr
.endFields
.Var
  NumDocs, Ном : Longint
  ReeItog : Double
.endVar
.begin
  NumDocs := 0;
  ReeItog := 0;
end.
 Ш ^
 ^

            Реестр  Б^ Б за период с  Б^ Б по  Б^ Б
 ^
.{
.[h
.Fields
  NDE_ShName
.endFields
──────────┬────────────────┬───────────────────────────────────┬─────────────────────────────────┬───────────────────────────────────┬────────стр.@NP@
   Дата   │      Номер     │              Работник             │          Подразделение          │                МОЛ                │  Сумма, @@@@@@
──────────┴────────────────┴───────────────────────────────────┴─────────────────────────────────┴───────────────────────────────────┴────────────────
.]h
.{ReeMBPDocSpec CheckEnter
.}
.Fields
  fDate  fNumber
  SubStr(fPersTo, 1, 35)
  SubStr(fPodrTo, 1, 34)
  SubStr(fMOLTo,  1, 35)
  fSumma
.endFields
.begin
  NumDocs := NumDocs + 1;
  ReeItog := ReeItog + fSumma;
end.
@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&&
.}
.Fields
  NumDocs  ReeItog
.endFields
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру      документов &&&&&     на  сумму                                                                      &'&&&&&&&&&&&&&&&&&&&&&&.&&
.{ CheckEnter FeeSignersCycle_rRee_MBPProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    _______________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                должность                           подпись                                расшифровка подписи
.} Ш
.endForm

//-------------------------------------------------------------------------

.LinkFORM rRee_MBP_08 Prototype Is rRee_MBPProt
.NameInList 'Подробный реестр'
.Group 'Подробный реестр'
.Fields
   CommonFormHeader  MyOrgName
   DocsType
   frDate  toDate  RazrFiltr
.endFields
.Var
  NumDocs, Ном : Longint
  ReeItog : Double
.endVar
.begin
  NumDocs := 0;
  ReeItog := 0;
end.
 Ш ^
 ^

            Подробный реестр  Б^ Б за период с  Б^ Б по  Б^ Б
 ^
.{
.[h
.Fields
  NDE_ShName
.endFields
──────────┬────────────────┬──────────────────────────────────────┬─────────────────────────────────────┬─────────────────────────────────────┬───────стр.@NP@
   Дата   │      Номер     │               Работник               │            Подразделение            │                 МОЛ                 │ Сумма, @@@@@@
──────────┴────────────────┴──────────────────────────────────────┴─────────────────────────────────────┴─────────────────────────────────────┴───────────────
.]h
.Fields
  fDate  fNumber  SubStr(fPersTo, 1, 35)
  SubStr(fPodrTo, 1, 34)
  SubStr(fMOLTo,  1, 35)
  fSumma
.endFields
.begin
  NumDocs := NumDocs + 1;
  ReeItog := ReeItog + fSumma;
end.
 Б@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&.&& Б
.{ReeMBPDocSpec CheckEnter
.[h
──────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]h
.Fields
   fMBPKod
   fMBPName
   SubStr(fPodr, 1, 23)
   SubStr(fMOL,  1, 25)
   fKol
   SubStr(fEd, 1, 10)
   fPrice
   fStoim
.endFields
          │@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&.&& @@@@@@@@ &'&&&&&&&&.&& &'&&&&&&&&&&&.&&
.[f
───────── └───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]f
.}
.} //
.Fields
  NumDocs  ReeItog
.endFields
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру      документов &&&&&     на  сумму                                                                               &'&&&&&&&&&&&&&&&&&&&&&&.&&
.{ CheckEnter FeeSignersCycle_rRee_MBPProt
.Fields
  if (Подписант_Роль <> '', Подписант_Роль, Подписант_должность)
  Подписант_ФИО
.EndFields

  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д    _______________________     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                должность                           подпись                                расшифровка подписи
.} Ш
.endForm

//-------------------------------------------------------------------------
