//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецоснастка
// Групповые документы на списание спецоснастки
//------------------------------------------------------------------------------

#doc
Формирование различных печатных форм из документов спецоснастки следующих
типов: ведомость начисления износа, акт на списание, акт о недостаче.<br>
#end
#include Commission.frn // комиссии
.set name = 'Spis_MBP'
.NameInList 'Базовая форма для групповых документов на списание МБП'
.hide
.fields
  DocTiDk  : Word
  DocNRec  : Comp     //
  Nom      : String   // 01
  Dat      : Date     // 02
  Podr     : String   // 03
  MOL      : String   // 04
  MOLShort : String
  MainBuh  : String
  MyOrg    : String   // 05
  ОКПО     : String   // 06
  SchMain  : String
  KodMain  : String
  nPrikaz  : String
  dPrikaz  : String
#CommissionFields
  NDEShNm  : String
  UDNRec   : Comp
  UDNom    : String
  UDDate   : Date
  UDPodrF  : String
  UDMolF   : String
  UDPodrT  : String
  UDMolT   : String
  UDMCName : String
  UDMCNum  : String
  UDEdName : String
  UDEdShNm : String
  UDEdKod  : String
  UDKol    : Double
  UDSum    : Double
.endfields
.{
  1234
^^^^^^^^^^^^^^
#CommissionBody(SpisMBPProt)
^ ^^^^^^^^^^^^^^
.{SpSpis CheckEnter
.fields
  SpNRec    : Comp     //
  MBPName   : String   // 05
  MBPNum    : String   // 06
  KodEd     : String
  MBPEd     : String   // 07
  explDate  : Date     // 08
  Price     : Double   // 09
  Srok      : String
  SrokF     : String
  InvN      : String
  Pass      : String
  Kol       : Double   // 10  Для начисления износа кол-во на момент операции
  SumPr     : Double   // 11  Для начисления износа сумма на момент операции
  tPerc     : Double   // 12
  tSumIsn   : Double   // 13
  Perc      : Double   // 14
  SumIsn    : Double   // 15
  PrKod     : String   // 16
  PrName    : String   // 17
  PersFIO   : String
  TabNum    : String
  OstStoim  : Double
  PostDate  : Date
  USNRec    : Comp
  USNormW   : Double
  USWeight  : Double
  USNormP   : Double
  USStoim   : Double
  PageBreak : Boolean
.endfields
56 789  01234567
^^^^^^^^^^^^^^^^^^^
^^^^
^^^^^
.}
^
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_01' prototype is 'Spis_MBP'
.Group 'Акт на списание МБП' // CCCP
.NameInList 'Акт на списание (форма № МБ-8)'
.declare
#include FeeSigners.vih
.endDeclare
.var
  DocNpp : Longint;
  Cnt : LongInt;
  TotCnt : Double;
  TotSum : Double;
  i : Longint;
  Number : Longint;
  Util_Name : array [1..2] of string;
  Util_Numb : array [1..2] of string;
  Util_Weight : array [1..2] of double;
  Util_Price  : array [1..2] of double;
  Util_Stoim  : array [1..2] of double;
  iFeeSigners : FeeSigners;
  sUtv, sPost : string;
.endvar
#CommissionLinkVar
.begin
  DocNpp := 0;
  sUtv := sPost := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_UtvLico))
    {
      sUtv := iFeeSigners.GetSignerFIO(7);
      sPost := iFeeSigners.GetSignerPosition(1)
    }

    iFeeSigners.ClearRestriction;
  }
end.
.{
#CommissionLinkInit(SpisMBPProt)
.fields
  CommonFormHeader
  sPost
  sUtv
  Nom
  DateToStr(Dat,'DD')
  DateToStr(Dat,'Mon')
  DateToStr(Dat,'YYYY')
  dPrikaz
  nPrikaz
  Podr
  SchMain
  KodMain
.endfields
.begin
  DocNpp++;
  Cnt := 0;
  TotSum := 0;
  TotCnt := 0;
  Number := 0;

  for (i := 0; i < Count(Util_Name); i++)
    Util_Name[i + 1] := '';

  for (i := 0; i < Count(Util_Numb); i++)
    Util_Numb[i + 1] := '';

  for (i := 0; i < Count(Util_Weight); i++)
    Util_Weight[i + 1] := 0;

  for (i := 0; i < Count(Util_Price); i++)
    Util_Price[i + 1] := 0;

  for (i := 0; i < Count(Util_Stoim); i++)
    Util_Stoim[i + 1] := 0;
end.
.{?Internal;(DocNpp > 1);

.}
 ^
 И                                                     УТВЕРЖДАЮ:
                                          Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                          должность
                                         ____________    Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                            подпись            И.,О.,фамилия

                                            "___"______________20___г. И


                             А К Т  №  Б@@@@@@@@@@@@@@@ Б

        АКТ НА СПИСАНИЕ МАЛОЦЕННЫХ И БЫСТРОИЗНАШИВАЮЩИХСЯ ПРЕДМЕТОВ
                               " Б^ Б"  Б^ Б  Б^ Бг.
 Р  Комиссия, назначенная приказом от ^  № ^, осмотрела принятые
  за ________________20___г. находившиеся в эксплуатации  малоценные и быстроизнашивающиеся пред-
  меты и признала их пришедшими в негодность и подлежащими сдаче в утиль.
               ┌──────────────────┬──────────────────────────────┬──────────────────┬─────────────────────────────────┐
               │                  │                              │                  │       Корреспондирующий счет    │
               │   Вид операции   │     Цех (отдел), участок     │     Кладовая     ├────────────────┬────────────────┤
               │                  │                              │                  │ счет, субсчет  │код аналит.учета│
               ├──────────────────┼──────────────────────────────┼──────────────────┼────────────────┼────────────────┤
               │                  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                  │@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@│
               └──────────────────┴──────────────────────────────┴──────────────────┴────────────────┴────────────────┘
┌─────────────────────────────────────┬──────┬──────────┬───────┬───────────┬──────────────┬──────────────────────────┐
│              Предмет                │      │   Дата   │       │           │              │      Причина списания    │
├───┬──────────────────────┬──────────┤Един. │ поступл. │ Коли- │           │              ├───────┬──────────────────┤
│ № │     Наименование     │Номенклат.│измер.│ в эксп-  │ чест- │    Цена   │    Сумма     │  Код  │   Наименование   │
│п/п│                      │  номер   │      │ луатацию │  во   │           │              │       │                  │
├───┼──────────────────────┼──────────┼──────┼──────────┼───────┼───────────┼──────────────┼───────┼──────────────────┤
.{SpSpis CheckEnter
.begin
  Cnt := Cnt + 1;
  TotSum := TotSum + if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn);
  TotCnt := TotCnt + Kol;

  if (USNRec <> 0)
  {
    Number := Number + 1;
    Util_Name[Number]   := MBPName;
    Util_Numb[Number]   := MBPNum;
    Util_Weight[Number] := USWeight;
    Util_Price[Number]  := USNormP;
    Util_Stoim[Number]  := USStoim;
  }
end.
.fields
  Cnt
  MBPName
  MBPNum
  MBPEd
  if (LongInt(explDate) > 0, DateToStr(explDate, 'DD/MM/YYYY'), '')
  Kol
  Price
  if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
  PrKod
  PrName
.endfields
│&&.│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@│@@@@@@@@@@│&&&&.&&│&&&&&&&&.&&│&&&&&&&&&&&.&&│@@@@@@@│@@@@@@@@@@@@@@@@@@│
.}
└───┴──────────────────────┴──────────┴──────┴──────────┴───────┴───────────┴──────────────┴───────┴──────────────────┘
.fields
  TotCnt
  TotSum
  DoubleToStr(TotCnt, '\2p\m4')+
    if (Pos('ноль', DoubleToStr(TotCnt, '\2p5')) <> 0, '',
      DoubleToStr(TotCnt, 'целых \2p5'))
.endfields

 Б  Итого :                                                &&&&.&&   на сумму  &&&&&&&&&&&.&&

    @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
    ───────────────────────────────────────────────────────────────────────────────────────────────────
                                 общее количество предметов прописью

  Номера и даты актов выбытия________________________________________________________________________
  ___________________________________________________________________________________________________
  Перечисленные в настоящем акте предметы в присутствии комиссии превращены в утиль, который подлежит
  оприходованию:
.{?Internal;(UDNRec = 0);
  ┌───────────────────────────────────────────┬─────────────────┬───────┬────────────┬─────────────────┬──────────────┐
  │                   Утиль                   │ Един. измерения │ Коли- │            │                 │  Порядковый  │
  ├────────────────────────────┬──────────────┼───────────┬─────┤ чест- │    Цена    │      Сумма      │ номер записи │
  │        Наименование        │ код (номенк- │  наимено- │ код │  во   │            │                 │ по складской │
  │                            │ лат. номер)  │   вание   │     │       │            │                 │  картотеке   │
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  │              1             │      2       │     3     │  3  │   4   │     5      │        6        │      7       │
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  └────────────────────────────┴──────────────┴───────────┴─────┴───────┴────────────┴─────────────────┴──────────────┘
.}
.{?Internal;(UDNRec <> 0);
  ┌───────────────────────────────────────────┬─────────────────┬───────┬────────────┬─────────────────┬──────────────┐
  │                   Утиль                   │ Един. измерения │ Коли- │            │                 │  Порядковый  │
  ├────────────────────────────┬──────────────┼───────────┬─────┤ чест- │    Цена    │      Сумма      │ номер записи │
  │        Наименование        │ код (номенк- │  наимено- │ код │  во   │            │                 │ по складской │
  │                            │ лат. номер)  │   вание   │     │       │            │                 │  картотеке   │
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  │              1             │      2       │     3     │  3  │   4   │     5      │        6        │      7       │
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
.begin
  i := 0;
end.
.{While (i < Number)
.begin
  i := i + 1;
end.
.fields
  Util_Name[i]
  Util_Numb[i]
  UDEdName
  UDEdKod
  Util_Weight[i]
  Util_Price[i]
  Util_Stoim[i]
.endfields
  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@│&&&&.&&│&&&&&&&&&.&&│&&&&&&&&&&&&&&.&&│              │
.}
  └────────────────────────────┴──────────────┴───────────┴─────┴───────┴────────────┴─────────────────┴──────────────┘
.}
   Утиль, не подлежащий учету, уничтожен.

.fields
 Председатель_комиссии_Должность
 Председатель_комиссии_ФИО
.endfields
    БПредседатель комиссии: Б  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                 должность                      подпись                        и., о., фамилия
.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
      Б@@@@@@@@@@@@@@@ Б       Д@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                 должность                      подпись                        и., о., фамилия
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
      БЧлены комиссии: Б      ___________________________  ________________________  ______________________________________
                                 должность                      подпись                        и., о., фамилия
                          ___________________________  ________________________  ______________________________________
                                 должность                      подпись                        и., о., фамилия
                          ___________________________  ________________________  ______________________________________
                                 должность                      подпись                        и., о., фамилия
.} Р

   Утиль по накладной № ___________________сдан.

   "_____"_______________20___г.
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_02' prototype is 'Spis_MBP'
.Group 'Акт на списание МБП'
.Group 'Акт на списание МБП (Россия)'
.NameInList 'Расходный ордер'
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  DocNpp, i, lSign : longint;
  FIOs, Post : array [1..2] of string;
  Npp : LongInt;
  TotCnt : Double;
  TotSum : Double;
.endvar
#CommissionLinkVar
.begin
  DocNpp := 0;
  lSign := 0;

  for (i := 1; i <= Count(FIOs); i++)
  {
    FIOs[i] := '';
    Post[i] := '';
  }

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  if (iFeeSigners.FeeSignersIsValid)
    if (iFeeSigners.GetSignerFirst)
      do
      {
        lSign++;
        FIOs[lSign] := iFeeSigners.GetSignerFIO(1);
        Post[lSign] := if (iFeeSigners.GetSignerRole <> '', iFeeSigners.GetSignerRole, iFeeSigners.GetSignerPosition(1));
      }
      while (iFeeSigners.GetSignerNext);
end.
.{
#CommissionLinkInit(SpisMBPProt)
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 Podr MOL
.endfields
.begin
 DocNpp++;
 Npp := 0;
 TotSum := 0;
 TotCnt := 0;
end.
.{?Internal;(DocNpp > 1);

.}
 ^

              РАСХОДНЫЙ ОРДЕР №  Б^ Б  от  Б^ Б

  Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  МОЛ: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Р┌───┬────────────┬───────────────────────────────┬───────────┬──────────────┬───────────────┬──────────────┐
│ № │ Номенклат. │         Наименование          │  Единица  │  Количество  │     Цена      │  Стоимость   │
│п/п│   номер    │                               │ измерения │              │               │              │
├───┼────────────┼───────────────────────────────┼───────────┼──────────────┼───────────────┼──────────────┤
.{SpSpis CheckEnter
.begin
 Npp := Npp + 1;
 TotSum := TotSum + if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn);
 TotCnt := TotCnt + Kol;
end.
.fields
 Npp
 MBPNum
 MBPName
 MBPEd
 Kol  Price  if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
.endfields
│&&.│ @@@@@@@@@@@│ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ @@@@@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│
.}
└───┴────────────┴───────────────────────────────┴───────────┴──────────────┴───────────────┴──────────────┘ Р

.fields
  TotCnt
  TotSum
.endfields
 С Итого :                                                      &&&&&&&&&&&.&&                 &&&&&&&&&&&.&& С

.begin
 i := 0;
end.
.{While (i < lSign)
.begin
 i++;
end.
.fields
 Post[i] + ':'
 FIOs[i]
.endfields
  @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_03' prototype is 'Spis_MBP'
.Group 'Ведомость начисления износа'
.NameInList 'Расширенная ведомость начисления износа'
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  DocNpp, i, lSign : longint;
  FIOs, Post : array [1..2] of string;
  Cnt : longInt;
  TotCnt : double;
  TotIzn : double;
  TotSum : double;
.endvar
#CommissionLinkVar
.begin
  DocNpp := 0;
  lSign := 0;

  for (i := 1; i <= Count(FIOs); i++)
  {
    FIOs[i] := '';
    Post[i] := '';
  }

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  if (iFeeSigners.FeeSignersIsValid)
    if (iFeeSigners.GetSignerFirst)
      do
      {
        lSign++;
        FIOs[lSign] := iFeeSigners.GetSignerFIO(1);
        Post[lSign] := if (iFeeSigners.GetSignerRole <> '', iFeeSigners.GetSignerRole, iFeeSigners.GetSignerPosition(1));
      }
      while (iFeeSigners.GetSignerNext);
end.
.{
#CommissionLinkInit(SpisMBPProt)
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 Podr
 MOL
.endfields
.begin
 DocNpp++;
 Cnt := 0;
 TotCnt := 0;
 TotIzn := 0;
 TotSum := 0;
end.
.{?Internal;(DocNpp > 1);

.}
 ^

                    ВЕДОМОСТЬ НАЧИСЛЕНИЯ ИЗНОСА
                      №  Б^ Б от  Б^ Б

  Подразделение : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  МОЛ           : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Р┌───┬────────────┬───────────────────────┬───────────┬────────┬──────────────┬───────┬──────────────┬────────┬──────────────┬─────────┬──────────────┐
│ № │ Номенклат. │     Наименование      │  Единица  │ Кол-во │  Стоимость   │ Износ │    Сумма     │Начислен│ Сумма начис- │Суммарный│  Общая сумма │
│п/п│   номер    │                       │ измерения │        │              │   %   │    износа    │ износ %│леного износа │ износ % │    износа    │
├───┼────────────┼───────────────────────┼───────────┼────────┼──────────────┼───────┼──────────────┼────────┼──────────────┼─────────┼──────────────┤
.{SpSpis CheckEnter
.begin
 Cnt := Cnt + 1;
 TotCnt := TotCnt + Kol;
 TotIzn := TotIzn + SumIsn;
 TotSum := TotSum + if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - tSumIsn);
end.
.fields
 Cnt
 MBPNum
 MBPName
 MBPEd
 Kol
 if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - tSumIsn)
 tPerc
 tSumIsn
 Perc
 SumIsn
 tPerc + Perc
 tSumIsn + SumIsn
.endfields
│&&.│ @@@@@@@@@@@│ @@@@@@@@@@@@@@@@@@@@@@│ @@@@@@@@@@│&&&&&.&&│&&&&&&&&&&&.&&│ &&&.&&│&&&&&&&&&&&.&&│ &&&&.&&│&&&&&&&&&&&.&&│ &&&&&.&&│&&&&&&&&&&&.&&│
.}
└───┴────────────┴───────────────────────┴───────────┴────────┴──────────────┴───────┴──────────────┴────────┴──────────────┴─────────┴──────────────┘ Р

.fields
  TotCnt
  TotSum
  TotIzn
.endfields
 С Итого :                                              &&&&&.&& &&&&&&&&&&&.&&                                 &&&&&&&&&&&.&& С

.begin
 i := 0;
end.
.{While (i < lSign)
.begin
 i++;
end.
.fields
 Post[i] + ':'
 FIOs[i]
.endfields
  @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_04' prototype is 'Spis_MBP'
.Group 'Ведомость начисления износа'
.NameInList 'Краткая ведомость начисления износа'
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  DocNpp, i, lSign : longint;
  FIOs, Post : array [1..2] of string;
  Cnt : longint;
  TotCnt : double;
  TotIzn : double;
  TotSum : double;
.endvar
#CommissionLinkVar
.begin
  DocNpp := 0;
  lSign := 0;

  for (i := 1; i <= Count(FIOs); i++)
  {
    FIOs[i] := '';
    Post[i] := '';
  }

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  if (iFeeSigners.FeeSignersIsValid)
    if (iFeeSigners.GetSignerFirst)
      do
      {
        lSign++;
        FIOs[lSign] := iFeeSigners.GetSignerFIO(1);
        Post[lSign] := if (iFeeSigners.GetSignerRole <> '', iFeeSigners.GetSignerRole, iFeeSigners.GetSignerPosition(1));
      }
      while (iFeeSigners.GetSignerNext);
end.
.{
#CommissionLinkInit(SpisMBPProt)
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat, 'DD/MM/YYYY')
 Podr
 MOL
.endfields
.begin
 DocNpp++;
 Cnt := 0;
 TotCnt := 0;
 TotIzn := 0;
 TotSum := 0;
end.
.{?Internal;(DocNpp > 1);

.}
 ^

                    ВЕДОМОСТЬ НАЧИСЛЕНИЯ ИЗНОСА
                      №  Б^ Б от  Б^ Б

  Подразделение : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  МОЛ           : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Р┌───┬────────────┬───────────────────────┬───────────┬────────┬──────────────┬────────┬──────────────┐
│ № │ Номенклат. │     Наименование      │  Единица  │ Кол-во │  Стоимость   │Начислен│ Сумма начис- │
│п/п│   номер    │                       │ измерения │        │              │ износ %│ленного износа│
├───┼────────────┼───────────────────────┼───────────┼────────┼──────────────┼────────┼──────────────┤
.{SpSpis CheckEnter
.begin
 Cnt := Cnt + 1;
 TotCnt := TotCnt + Kol;
 TotIzn := TotIzn + SumIsn;
 TotSum := TotSum + if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - tSumIsn);
end.
.fields
 Cnt
 MBPNum
 MBPName
 MBPEd
 Kol
 if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - tSumIsn)
 Perc
 SumIsn
.endfields
│&&.│ @@@@@@@@@@@│ @@@@@@@@@@@@@@@@@@@@@@│ @@@@@@@@@@│&&&&&.&&│&&&&&&&&&&&.&&│ &&&&.&&│&&&&&&&&&&&.&&│
.}
└───┴────────────┴───────────────────────┴───────────┴────────┴──────────────┴────────┴──────────────┘ Р

.fields
  TotCnt
  TotSum
  TotIzn
.endfields
 С Итого :                                              &&&&&.&& &&&&&&&&&&&.&&          &&&&&&&&&&&.&& С

.begin
 i := 0;
end.
.{While (i < lSign)
.begin
 i++;
end.
.fields
 Post[i] + ':'
 FIOs[i]
.endfields
  @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_05' prototype is 'Spis_MBP'
.Group 'Акт на списание МБП (Россия)'
.NameInList 'Акт на списание (форма № МБ-8)'
.f "MBPSPAKT.OUT"
.defo LandScape
.p 50
.declare
#include FeeSigners.vih
.endDeclare
.var
  PageNumber : word;
  PageSeparator : boolean;

  TotCnt : Double;
  TotSum : Double;
  IznSum : Double;
  StrCount : word;

  i : Longint;
  Number : Longint;
  Util_Name : array [1..2] of string;
  Util_Numb : array [1..2] of string;
  Util_Weight : array [1..2] of double;
  Util_Price  : array [1..2] of double;
  Util_Stoim  : array [1..2] of double;

  iFeeSigners : FeeSigners;
  sUtv, sPost : string;
.endvar
.begin
  sUtv := sPost := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_UtvLico))
    {
      sUtv := iFeeSigners.GetSignerFIO(7);
      sPost := iFeeSigners.GetSignerPosition(1)
    }

    iFeeSigners.ClearRestriction;
  }
end.
.[h skip
.{?INTERNAL; (PageSeparator)
 Ш                                                                                                                                                                                   Оборотная сторона формы № МБ-8 Ш
.}
.begin
  PageNumber := PageNumber + 1;
  PageSeparator := true;
end.
.]h
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.fields
  'true' : 's'
  CommonFormHeader
  sPost
  Nom
  sUtv
  MyOrg  ОКПО
  Podr
  DateToStr(Dat, 'DD/MM/YYYY')
  Podr
  SchMain
  KodMain
  dPrikaz
  nPrikaz
.endfields
.begin
  TotCnt := 0;
  TotSum := 0;
  IznSum := 0;
  StrCount := 0;
  Number := 0;

  for (i := 0; i < Count(Util_Name); i++)
    Util_Name[i + 1] := '';

  for (i := 0; i < Count(Util_Numb); i++)
    Util_Numb[i + 1] := '';

  for (i := 0; i < Count(Util_Weight); i++)
    Util_Weight[i + 1] := 0;

  for (i := 0; i < Count(Util_Price); i++)
    Util_Price[i + 1] := 0;

  for (i := 0; i < Count(Util_Stoim); i++)
    Util_Stoim[i + 1] := 0;
end.
^ Ш ^
                                                                                                                                                                     Типовая межотраслевая форма № МБ-8
                                                                                                                                                                     Утверждена постановлением Госкомстата России
                                                                                                                                                                     от 30.10.97 № 71а

                                                                                                                                                                                 УТВЕРЖДАЮ:
                                                                                                                                                                              Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                              БАКТ №  Д@@@@@@@@@@ Е                                                                                                       должность
                                              Бна списание малоценных и быстроизнашивающихся Б                                                                               ____________   Д@~@@@@@@@@@@@@@@@@@@@@ Д
                                                                 Бпредметов Б                                                                                                   подпись     расшифровка подписи

                                                                                                                                                                   "___"______________20___г.
                                                                                                                                                                                                    ┌────────────┐
                                                                                                                                                                                                    │    Коды    │
                                                                                                                                                                                                    ├────────────┤
                                                                                                                                                                                      Форма по ОКУД │  0320004   │
                                                                                                                                                                                                    ├────────────┤
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е         по ОКПО │@~@@@@@@@@@@│
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                 └────────────┘
                                                                         ┌──────────┬──────────┬───────────────────────────────────────────────────────────┬────────────────┬────────────────────────────────────┐
                                                                         │   Дата   │   Код    │                         Структурное                       │      Вид       │       Корреспондирующий счет       │
                                                                         │  состав- │   вида   │                        подразделение                      │  деятельности  ├───────────┬────────────────────────┤
                                                                         │   ления  │ операции │                                                           │                │   счет,   │      код аналити-      │
                                                                         │          │          │                                                           │                │  субсчет  │     ческого учета      │
                                                                         ├──────────┼──────────┼───────────────────────────────────────────────────────────┼────────────────┼───────────┼────────────────────────┤
                                                                          Б│@@@@@@@@@@│          │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                │@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@│
                                                                         └──────────┴──────────┴───────────────────────────────────────────────────────────┴────────────────┴───────────┴────────────────────────┘ Б
 Комиссия, назначенная приказом от ^ № ^ осмотрела принятые за _______________ 20   г., находившиеся в
 эксплуатации малоценные и быстроизнашивающиеся предметы и признала их пришедшими в негодность и подлежащими сдаче в утиль (лом)
.{SpSpis CheckEnter
.[h
┌───────────────────────────────────────────────────────────────────┬────────────────────┬────────┬──────────┬──────────────┬───────────────────────────┬──────┬────────────────────────────────┬────────────────┐
│                              Предмет                              │ Единица измерения  │        │          │              │      Сумма, руб. коп.     │      │        Причина списания        │                │
├────────────────────────────────────────┬──────────────┬───────────┼─────┬──────────────┤        │   Дата   │              ├─────────────┬─────────────┤      ├──────────────────────┬─────────┤                │
│              Наименование              │ Номенклатур- │ Инвентар- │ Код │ Наименование │  Коли- │ поступле-│    Цена,     │  Без учета  │   Аморти-   │ Срок │                      │         │ Номер паспорта │
│                                        │  ный номер   │ ный номер │     │              │ чество │   ния    │   руб.коп.   │     НДС     │   зации     │службы│     Наименование     │   Код   │                │
├────────────────────────────────────────┼──────────────┼───────────┼─────┼──────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼──────────────────────┼─────────┼────────────────┤
│                   1                    │      2       │     3     │  4  │      5       │   6    │    7     │      8       │      9      │     10      │  11  │          12          │   13    │       14       │
├────────────────────────────────────────┼──────────────┼───────────┼─────┼──────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼──────────────────────┼─────────┼────────────────┤
.begin
  PageNumber := PageNumber + 1;
  PageSeparator := true;
end.
.]h
.begin
 TotCnt := TotCnt + Kol;
 TotSum := TotSum + if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn);
 IznSum := IznSum + SumIsn;

 if (GroupWrap(MBPName, 1 , 40) <> '' or GroupWrap(MBPNum, 1 , 14) <>'')
   StrCount := StrCount + 1;

 if (GroupWrap(MBPName, 2 , 40) <> '' or GroupWrap(MBPNum, 2 , 14) <>'')
   StrCount := StrCount + 1;

 if (GroupWrap(MBPName, 3 , 40) <> '' or GroupWrap(MBPNum, 3 , 14) <>'')
   StrCount := StrCount + 1;

 if (GroupWrap(MBPName, 4 , 40) <> '')
   StrCount := StrCount + 1;

  if (USNRec <> 0)
  {
    Number := Number + 1;
    Util_Name[Number]   := MBPName;
    Util_Numb[Number]   := MBPNum;
    Util_Weight[Number] := USWeight;
    Util_Price[Number]  := USNormP;
    Util_Stoim[Number]  := USStoim;
  }
end.
.{?INTERNAL; ((StrCount > 7) and (PageNumber = 1))
└────────────────────────────────────────┴──────────────┴───────────┴─────┴──────────────┴────────┴──────────┴──────────────┴─────────────┴─────────────┴──────┴──────────────────────┴─────────┴────────────────┘
.fields
  'true' : 's'
.endFields
^│                                        │              │           │     │              │        │          │              │             │             │      │                      │         │                │
.}
.fields
  MBPName
  MBPNum
  InvN
  KodEd
  MBPEd
  Kol
  if (Longint(explDate) > 0, DateToStr(explDate, 'DD/MM/YYYY'), if (Longint(PostDate) > 0, DateToStr(PostDate, 'DD/MM/YYYY'), ''))
  Price
  if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
  if (Round(SumIsn, 2) > 0, DoubleToStr(SumIsn, '\2p[|-]3666''666''666''666''666.88'), '-')
  SrokF
  PrName
  PrKod
  Pass
.endfields
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@│@@@@@@@@@@@@@@│&&&&.&&&│&&&&&&&&&&│&'&&&&&&&&&.&&│&'#&&&&&&&.&&│&'#&&&&&&&.&&│&&&&&&│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@@│
.}
.fields
  TotCnt
  TotSum
  if (Round(IznSum, 2) > 0, DoubleToStr(IznSum, '\2p[|-]3666''666''666''666''666.88'),  '-')
  DoubleToStr(TotCnt, '\2p\m4')+
    if (Pos('ноль', DoubleToStr(TotCnt, '\2p5')) <> 0, '',
      DoubleToStr(TotCnt, 'целых \2p5'))
.endfields
└────────────────────────────────────────┴──────────────┴───────────┴─────┴──────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┴──────────────────────┴─────────┴────────────────┘
                                                                                   БИтого  │&#&&.&&&│    X     │      X       │&'#&&&&&&&.&&│&'#&&&&&&&.&&│
                                                                                         └────────┴──────────┴──────────────┴─────────────┴─────────────┘ Б
 Общее количество предметов   Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                                              прописью
.fields
  'true' : 's'
.endfields
^
.{?INTERNAL; (PageNumber = 1)
                                                                                                                                                                                   Оборотная сторона формы № МБ-8
.begin
  PageSeparator := false;
end.
.}
 Номера и даты актов выбытия ____________________________________________________________________________________________________________________________________________________________________________________

 Перечисленные в настоящем акте в присутствии комиссии превращены в утиль (лом), который подлежит оприходованию:
.{?Internal;(UDNRec = 0);
┌──────────┬──────────────┬────────────────────────────────────┬───────────────────────────────────────────────────────┬───────────────────┬────────────┬───────────────────┬───────────────────┬────────────────┐
│          │              │                                    │                      Утиль (лом)                      │ Единица измерения │            │                   │                   │   Порядковый   │
│ Код вида │     Вид      │            Структурное             ├────────────────────────────────────────┬──────────────┼─────────────┬─────┤ Количество │       Цена,       │      Сумма,       │  номер записи  │
│ операции │ деятельности │           подразделение            │              Наименование              │ Номенклатур- │ Наименование│ Код │            │     руб. коп.     │     руб. коп.     │  по складской  │
│          │              │                                    │                                        │  ный номер   │             │     │            │                   │                   │   картотеке    │
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
│    1     │      2       │                 3                  │                   4                    │       5      │      6      │  7  │      8     │         9         │        10         │       11       │
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
└──────────┴──────────────┴────────────────────────────────────┴────────────────────────────────────────┴──────────────┴─────────────┴─────┼────────────┼───────────────────┼───────────────────┼────────────────┘
 Утиль, не подлежащий учету, уничтожен.                                                                                               БИтого │            │                   │                   │
                                                                                                                                           └────────────┴───────────────────┴───────────────────┘ Б
.}
.{?Internal;(UDNRec <> 0);
.begin
  i := 0;
end.
.{While (i < Number)
.[h
┌──────────┬──────────────┬────────────────────────────────────┬───────────────────────────────────────────────────────┬───────────────────┬────────────┬───────────────────┬───────────────────┬────────────────┐
│          │              │                                    │                      Утиль (лом)                      │ Единица измерения │            │                   │                   │   Порядковый   │
│ Код вида │     Вид      │            Структурное             ├────────────────────────────────────────┬──────────────┼─────────────┬─────┤ Количество │       Цена,       │      Сумма,       │  номер записи  │
│ операции │ деятельности │           подразделение            │              Наименование              │ Номенклатур- │ Наименование│ Код │            │     руб. коп.     │     руб. коп.     │  по складской  │
│          │              │                                    │                                        │  ный номер   │             │     │            │                   │                   │   картотеке    │
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
│    1     │      2       │                 3                  │                   4                    │       5      │      6      │  7  │      8     │         9         │        10         │       11       │
├──────────┼──────────────┼────────────────────────────────────┼────────────────────────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
.]h
.begin
  i := i + 1;
end.
.fields
  UDPodrF
  Util_Name[i]
  Util_Numb[i]
  UDEdName
  UDEdKod
  Util_Weight[i]
  Util_Price[i]
  Util_Stoim[i]
  UDKol
  UDSum
.endfields
│          │              │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@@@@@@@@@@@│@@@@@│&&&&&&&&.&&&│&'&&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&&.&&│                │
.}
└──────────┴──────────────┴────────────────────────────────────┴────────────────────────────────────────┴──────────────┴─────────────┴─────┼────────────┼───────────────────┼───────────────────┼────────────────┘
 Утиль, не подлежащий учету, уничтожен.                                                                                               БИтого │&&&&&&&&.&&&│                   │&'&&&&&&&&&&&&&&.&&│
                                                                                                                                           └────────────┴───────────────────┴───────────────────┘ Б
.}
.fields
 Председатель_комиссии_Должность
 Председатель_комиссии_ФИО
.endfields
    БПредседатель комиссии Б:  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                    должность                     подпись                     расшифровка подписи
.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
     Б@@@@@@@@@@@@@@@ Б        Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                    должность                     подпись                     расшифровка подписи
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
       БЧлены комиссии: Б     _____________________________  ________________________  _________________________________________
                                    должность                     подпись                     расшифровка подписи
                          _____________________________  ________________________  _________________________________________
                                    должность                     подпись                     расшифровка подписи
                          _____________________________  ________________________  _________________________________________
                                    должность                     подпись                     расшифровка подписи
.}
  Утиль (лом) по накладной №  ____________________ сдан
    "  " ____________ 20   г. Ш
.begin
  PageNumber := 0;
  PageSeparator := false;
end.
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_06' prototype is 'Spis_MBP'
.Group 'Акт на списание МБП'
.Group 'Акт на списание МБП (Россия)'
.NameInList 'Акт выбытия (форма № МБ-4)'
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  TotSum : Double
  IznSum : Double
  KolStr,
  KolStr2  : integer
  KolPage  : integer
  KolPage2 : integer
  arKolStr : array[1..2] of integer;
  arDate   : array[1..2] of String;
  arFIO    : array[1..2] of String;
  arTabN   : array[1..2] of String;
  arPerc   : array[1..2] of Double;
  arOstSt  : array[1..2] of Double;
  iFeeSigners : FeeSigners;
  sDirect, sPost, sBuh, sMaster : string
.endvar
#CommissionLinkVar
.begin
  sDirect := sPost := sBuh := sMaster := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Direct))
    {
      sDirect := iFeeSigners.GetSignerFIO(1);
      sPost := iFeeSigners.GetSignerPosition(1)
    }

    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Bux))
      sBuh := iFeeSigners.GetSignerFIO(1);

    if (iFeeSigners.RestrictFeeByRole(3, 'Исполнитель'))
      sMaster := iFeeSigners.GetSignerFIO(1);

    iFeeSigners.ClearRestriction;
  }
end.
.{
#CommissionLinkInit(SpisMBPProt)
.begin
  KolStr   := 0;
  KolStr2  := 0;
  KolPage  := 0;
  KolPage2 := 0;
end.
.{SpSpis CheckEnter
.[h
.begin
  TotSum := 0;
  IznSum := 0;
  KolPage := KolPage + 1;
  KolStr2 := KolStr2 + KolStr;
  KolStr := 0;
end.
.fields
  'true' : 's'
  CommonFormHeader
  Nom
  MyOrg
  ОКПО
  Podr
  DateToStr(Dat, 'DD/MM/YYYY')
  Podr
  SchMain
  KodMain
.endfields
^ Ш^
                                                                                                            Типовая межотраслевая форма № МБ-4
                                                                                                            Утверждена постановлением Госкомстата России
                                                                                                            от 30.10.97 № 71а
                                                   БАКТ № Б  Е@@@@@@@@@@ Е                                                                        ┌─────────────┐
                                Бвыбытия малоценных и быстроизнашивающихся предметов Б                                                        │     Коды    │
                                                                                                                                          ├─────────────┤
                                                                                                                            Форма по ОКУД │   0320002   │
                                                                                                                                          ├─────────────┤
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е          по ОКПО │@~@@@@@@@@@@@│
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                  └─────────────┘
                           ┌──────────┬──────────┬──────────────────────────────────────────┬──────────────┬─────────────────────────────┬──────────────┐
                           │   Дата   │   Код    │              Структурное                 │     Вид      │    Корреспондирующий счет   │ Учетная еди- │
                           │  состав- │   вида   │             подразделение                │ деятельности ├───────────┬─────────────────┤ ница выпуска │
                           │   ления  │ операции │                                          │              │   счет,   │  код аналити-   │  продукции   │
                           │          │          │                                          │              │  субсчет  │  ческого учета  │(работ, услуг)│
                           ├──────────┼──────────┼──────────────────────────────────────────┼──────────────┼───────────┼─────────────────┼──────────────┤
                           │ Б@@@@@@@@@@ Б│          │ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б│              │ Б@@@@@@@@@@@ Б│ Б@@@@@@@@@@@@@@@@@ Б│              │
                           └──────────┴──────────┴──────────────────────────────────────────┴──────────────┴───────────┴─────────────────┴──────────────┘
┌───────────────────────────────────────────────────────┬─────────────────┬──────┬──────────────┬───────────────────────────┬───────────────────────────┐
│                        Предмет                        │Единица измерения│      │              │      Сумма, руб. коп.     │      Причина выбытия      │
├────────────────────────────────────────┬──────────────┼───┬─────────────┤ Коли-│    Цена,     ├─────────────┬─────────────┼─────────┬─────────────────┤
│             Наименование,              │ Номенклатур- │Код│ Наименование│чество│   руб.коп.   │  Без учета  │   Аморти-   │         │                 │
│          сорт, размер, марка           │  ный  номер  │   │             │      │              │     НДС     │   зации     │   Код   │  Наименование   │
├────────────────────────────────────────┼──────────────┼───┼─────────────┼──────┼──────────────┼─────────────┼─────────────┼─────────┼─────────────────┤
│                   1                    │      2       │ 3 │      4      │   5  │      6       │      7      │      8      │    9    │       10        │
├────────────────────────────────────────┼──────────────┼───┼─────────────┼──────┼──────────────┼─────────────┼─────────────┼─────────┼─────────────────┤
.]h
.begin
  TotSum := TotSum + if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn);
  IznSum := IznSum + SumIsn;
  KolStr := KolStr + 1;
  arDate [KolStr2 + KolStr] := if (LongInt(explDate) > 0, DateToStr(explDate, 'DD/MM/YYYY'), '');
  arFIO  [KolStr2 + KolStr] := PersFIO;
  arTabN [KolStr2 + KolStr] := TabNum;
  arPerc [KolStr2 + KolStr] := tPerc;
  arOstSt[KolStr2 + KolStr] := OstStoim;
end.
.fields
  MBPName
  MBPNum
  KodEd
  MBPEd
  Kol
  Price
  if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
  SumIsn
  PrKod
  PrName
.endfields
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@│@@@@@@@@@@@@@│&&&.&&│&'&&&&&&&&&.&&│&'#&&&&&&&.&&│&'#&&&&&&&.&&│@@@@@@@@@│@@@@@@@@@@@@@@@@@│
.[f
.begin
  arKolStr[KolPage] := KolStr
end.
.fields
  TotSum  IznSum  sMaster
.endfields
└────────────────────────────────────────┴──────────────┴───┴─────────────┴──────┴──────────────┼─────────────┼─────────────┼─────────┴─────────────────┘
                                                                                          БИтого Б  │ Б&'#&&&&&&&.&& Б│ Б&'#&&&&&&&.&& Б│
 Причина выбытия _______________________________________________________________________        └─────────────┴─────────────┘
                 _______________________________________________________________________________________________________________________________________
                 _______________________________________________________________________________________________________________________________________
  БМастер (исполнитель работ) Б   _________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                   подпись                 расшифровка подписи

.]f
.}
.begin
  KolStr := 0;
  KolStr2 := 0;
end.
.{While (KolPage2 < KolPage)
.begin
  KolStr2 := KolStr2 + KolStr;
  KolStr := 0;
  KolPage2 := KolPage2 + 1;
end.
.{?INTERNAL;KolPage2 > 1
 
.}
                                                                                                                          Оборотная сторона формы № МБ-4
 ┌──────────────────────────────────────────┬───────────┬──────────┬──────────────┬───────────────────────────────────────────────────────┬─────────────┐
 │                                          │           │          │              │               Расчет удержания с виновных             │             │
 │                                          │           │          │              │                 Вид и способ удержания                │             │
 │             Фамилия, И., О.              │ Табельный │   Дата   │   Подпись    ├───────┬────────────┬──────────────────────┬───────────┤   Подпись   │
 │                                          │   номер   │  выдачи  │   сдавшего   │       │ стоимость  │  код вида удержания  │   сумма   │  виновного  │
 │                                          │           │          │  малоценные  │процент│ за вычетом ├──────────────────────┤  ежеме-   │  в поломке  │
 │                                          │           │          │  и быстроиз- │аморти-│амортизации,├─────────┬────────────┤  сячного  │   (утере)   │
 │                                          │           │          │ нашивающиеся │ зации │ руб. коп.  │ размер  │   cумма    │  взноса,  │             │
 │                                          │           │          │   предметы   │       │            │(процент)│ удержания, │  руб.коп  │             │
 │                                          │           │          │              │       │            │удержания│  руб. коп. │           │             │
 ├──────────────────────────────────────────┼───────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
 │                    1                     │     2     │    3     │       4      │   5   │     6      │    7    │      8     │     9     │     10      │
 ├──────────────────────────────────────────┼───────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
.{While (KolStr < arKolStr[KolPage2])
.begin
  KolStr := KolStr + 1
end.
.fields
  arFIO  [KolStr2 + KolStr]
  arTabN [KolStr2 + KolStr]
  arDate [KolStr2 + KolStr]
  arPerc [KolStr2 + KolStr]
  arOstSt[KolStr2 + KolStr]
.endfields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│@~@@@@@@@@│              │&'#&.&&│&'#&&&&&&.&&│         │            │           │             │
.}
 └──────────────────────────────────────────┴───────────┴──────────┴──────────────┴───────┴────────────┴─────────┴────────────┴───────────┴─────────────┘
.fields
  sPost
  sDirect
  MOL
  sBuh
.endfields
  БРуководитель подразделения Б  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  _____________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                      должность               подпись               расшифровка подписи
  БКладовщик Б  _____________    Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
               подпись                расшифровка подписи
  ББухгалтер Б  _____________    Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
               подпись                расшифровка подписи

    "  " ___________20   г.
.} Ш
.}
.endform

//-------------------------------------------------------------------------

.linkForm 'MBP_Nedost' prototype is 'Spis_MBP'
.nameInList 'Акт инвентаризации о недостачах'
.Group 'Недостача'
.declare
#include FeeSigners.vih
.endDeclare
.var
  iFeeSigners : FeeSigners;
  DocNpp, i, lSign : longint;
  FIOs, Post : array [1..2] of string;
  totSum : double;
.endVar
#CommissionLinkVar
.begin
  DocNpp := 0;
  lSign := 0;

  for (i := 1; i <= Count(FIOs); i++)
  {
    FIOs[i] := '';
    Post[i] := '';
  }

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  if (iFeeSigners.FeeSignersIsValid)
    if (iFeeSigners.GetSignerFirst)
      do
      {
        lSign++;
        FIOs[lSign] := iFeeSigners.GetSignerFIO(1);
        Post[lSign] := if (iFeeSigners.GetSignerRole <> '', iFeeSigners.GetSignerRole, iFeeSigners.GetSignerPosition(1));
      }
      while (iFeeSigners.GetSignerNext);
end.
.{
#CommissionLinkInit(SpisMBPProt)
.Fields
  CommonFormHeader
  Nom
  DateToStr(Dat, 'DD/MM/YYYY')
  Podr
  MOL
  MBPName
  MBPNum
  MBPEd
  Kol
  Price
  if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
.endFields
.begin
  DocNpp++;
end.
.{?Internal;(DocNpp > 1);

.}
 Р ^

                                  АКТ ИНВЕНТАРИЗАЦИИ О НЕДОСТАЧАХ
                                    № ^ от ^

Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
МОЛ          : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.begin
  totSum := 0
end.
─────────────────────────────────┬──────────────┬───────────────┬──────────┬───────────────┬───────────────
           Наименование          │Номенкл. номер│ Ед. измерения │Количество│     Цена      │   Стоимость
─────────────────────────────────┴──────────────┴───────────────┴──────────┴───────────────┴───────────────
.{SpSpis CheckEnter
.begin
  totSum := totSum + if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn);
end.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ &&&&&&&.&& &'&&&&&&&&&&.&& &'&&&&&&&&&&.&&
.}
───────────────────────────────────────────────────────────────────────────────────────────────────────────

.Fields
  totSum
  DoubleToStr(totSum, '\2p\m4') + if (Pos('ноль', DoubleToStr(totSum, '\2p5')) <> 0, '', DoubleToStr(totSum, 'целых \2p5'))
.endFields
Сумма по акту: &'&&&&&&&&&&.&& руб.
     Прописью: ^

.begin
 i := 0;
end.
.{While (i < lSign)
.begin
 i++;
end.
.fields
 Post[i] + ':'
 FIOs[i]
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.} Р
.}
.endForm

!========================================================================================================

.linkform 'Spis_MBP_08' prototype is 'Spis_MBP'
.NameInList 'Акт на списание инструмента (Форма М-36п)'
.Group 'Акт на списание МБП (Беларусь)'
.f "MBPM_36p.OUT"
.defo LandScape
.p 50
.declare
#include FeeSigners.vih
.endDeclare
.var
  Cnt : LongInt;
  TotCnt : Double;
  TotSum : Double;
  iFeeSigners : FeeSigners;
  sUtv, sPost, sBuh : string;
  sRazr, sRazrPost, MolPost : string;
.endvar
#CommissionLinkVar
.begin
  sUtv := sPost := sBuh := sRazr := sRazrPost := MolPost := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_UtvLico))
    {
      sUtv := iFeeSigners.GetSignerFIO(7);
      sPost := iFeeSigners.GetSignerPosition(1)
    }

    if (iFeeSigners.RestrictFeeByRole(2, 'Allowed'))
    {
      sRazr := iFeeSigners.GetSignerFIO(7);
      sRazrPost := iFeeSigners.GetSignerPosition(1)
    }

    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Bux))
      sBuh := iFeeSigners.GetSignerFIO(7);

    iFeeSigners.ClearRestriction;
  }
end.
.{
#CommissionLinkInit(SpisMBPProt)
.fields
 'true' : 's'
 CommonFormHeader
 MyOrg
 ОКПО
 Podr
 sPost
 sUtv
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
.endfields
.begin
  Cnt := 0;
  TotSum := 0;
  TotCnt := 0;
end.
^ Р ^
                                                                                                                                                                              Утверждена
                                                                                                                                                              Постановлением Минпрома РБ
                                                                                                                                                                       от 29.12.2004 №21
                                                                                                                                                                             Форма М-36п
                                                                                                                                                                           ┌────────────┐
                                                                                                                                                                           │    Код     │
                                                                                                                                                                           ├────────────┤
                                                                                                                                                             Форма по ОКУД │            │
                                                                                                                                                                           ├────────────┤
   Организация  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@    по ОКЮЛП │@~@@@@@@@@@@│
                                                                                                                                                                           ├────────────┤
   Структурное подразделение  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             │            │
                                                                                                                                                                           └────────────┘

                                       АКТ                                                             УТВЕРЖДАЮ
                             НА СПИСАНИЕ ИНСТРУМЕНТА                                                    Д@~@@@@@@@@@@@@@@@@@@@@@@@ Д  _______________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                      (ПРИСПОСОБЛЕНИЙ) И ОБМЕН ИХ НА ГОДНЫЕ                                                    должность              подпись                фамилия, инициалы
                                                                                                       "____" __________________ 20____ г.
                                                                                                                                                                               Таблица 1
  ┌──────────────┬──────────────┬─────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────┐
  │              │              │         Информация об утверждении комиссией         │                                               Коды                                              │
  │     Номер    │     Дата     ├────────────────────────┬────────────────────────────┼─────────────────────────────────┬───────────────────────────────┬───────────────────────────────┤
  │   документа  │  составления │      номер приказа     │           дата             │            отправителя          │           получателя          │          вида операции        │
  ├──────────────┼──────────────┼────────────────────────┼────────────────────────────┼─────────────────────────────────┼───────────────────────────────┼───────────────────────────────┤
  │       1      │       2      │            3           │             4              │                 5               │                6              │                7              │
  ├──────────────┼──────────────┼────────────────────────┼────────────────────────────┼─────────────────────────────────┼───────────────────────────────┼───────────────────────────────┤
  │@@@@@@@@@@@@@@│@~@@@@@@@@@@@@│                        │                            │                                 │                               │                               │
  └──────────────┴──────────────┴────────────────────────┴────────────────────────────┴─────────────────────────────────┴───────────────────────────────┴───────────────────────────────┘
                                                                                                                                                                               Таблица 2
.{SpSpis CheckEnter
.[h1
  ┌────┬──────┬─────────┬─────────────────────────┬──────┬─────────┬───────────────┬─────────────────────┬─────────────────────┬──────────────────────┬─────────────────────────────────┐
  │    │      │         │                         │      │         │               │ Пришло в негодность │   Выдано в порядке  │ Списано с цеха ввиду │                                 │
  │ №  │ Код  │         │       Наименование      │Марка,│ Единица │      Цена,    │ и подлежит списанию │   обмена и списано  │отсутствия инструмента│        Лом списанного           │
  │п/п │затрат│Номенкла-│        инструмента      │размер│измерения│      руб.     │                     │                     │       на складе      │          инструмента            │
  │    │      │ турный  │                         │      │         │               ├──────┬──────────────┼──────┬──────────────┼──────┬───────────────┼───────┬───────────┬─────────────┤
  │    │      │ номер   │                         │      │         │               │коли- │     сумма,   │коли- │     сумма,   │коли- │     сумма,    │вес, кг│   цена,   │    сумма,   │
  │    │      │         │                         │      │         │               │чество│      руб.    │чество│      руб.    │чество│      руб.     │       │    руб.   │     руб.    │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │ 1  │  2   │    3    │             4           │  5   │    6    │       7       │   8  │       9      │  10  │      11      │  12  │       13      │   14  │    15     │      16     │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
.]h
.[h2

                                                                                                                                                           Оборотная сторона формы М-36п
  ┌────┬──────┬─────────┬─────────────────────────┬──────┬─────────┬───────────────┬──────┬──────────────┬──────┬──────────────┬──────┬───────────────┬───────┬───────────┬─────────────┐
  │ 1  │  2   │    3    │             4           │  5   │    6    │       7       │   8  │       9      │  10  │      11      │  12  │       13      │   14  │    15     │      16     │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
.]h
.begin
 Cnt := Cnt + 1;
 TotCnt := TotCnt + Kol;
 TotSum := TotSum + if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn);
end.
.fields
 Cnt
 MBPNum
 MBPName
 MBPEd
 Price
 Kol
 if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
.endfields
  │&&&&│      │@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@│      │@@@@@@@@@│&#&&&&&&&&&&.&&│&#&&&&│&#&&&&&&&&&.&&│      │              │      │               │       │           │             │
.[f
  └────┴──────┴─────────┴─────────────────────────┴──────┴─────────┴───────────────┴──────┴──────────────┴──────┴──────────────┴──────┴───────────────┴───────┴───────────┴─────────────┘

.]f
.}
.fields
 TotCnt TotSum
 Председатель_комиссии_Должность
 Председатель_комиссии_ФИО
.endfields

                                                                                                                                                           Оборотная сторона формы М-36п
  ┌────┬──────┬─────────┬─────────────────────────┬──────┬─────────┬───────────────┬──────┬──────────────┬──────┬──────────────┬──────┬───────────────┬───────┬───────────┬─────────────┐
  │ 1  │  2   │    3    │             4           │  5   │    6    │       7       │   8  │       9      │  10  │      11      │  12  │       13      │   14  │    15     │      16     │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  └────┴──────┴─────────┴─────────────────────────┴──────┴─────────┴───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
                                       Итого . . . . . . . . . . . . . . . . . . . │&#&&&&│&#&&&&&&&&&.&&│      │              │      │               │       │           │             │
                                                                                   └──────┴──────────────┴──────┴──────────────┴──────┴───────────────┴───────┴───────────┴─────────────┘

   БПредседатель комиссии Б:  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                    должность                      подпись                        фамилия, инициалы
.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
    Б@@@@@@@@@@@@@@@ Б        Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                    должность                      подпись                        фамилия, инициалы
.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
     БЧлены комиссии: Б      _____________________________  ________________________  _________________________________________
                                    должность                      подпись                        фамилия, инициалы
                         _____________________________  ________________________  _________________________________________
                                    должность                      подпись                        фамилия, инициалы
                         _____________________________  ________________________  _________________________________________
                                    должность                      подпись                        фамилия, инициалы
.}
.fields
  MolPost MolShort
  sRazrPost sRazr
  MolPost MolShort
  sBuh
.endfields
  Негодный инструмент сдал     Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                        должность                  подпись                        фамилия, инициалы
                    принял    _____________________________  ___________________  _________________________________________________
                                        должность                  подпись                        фамилия, инициалы
            Обмен разрешил     Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                        должность                  подпись                        фамилия, инициалы


  Выданный взамен пришедшего в негодность инструмент получил    Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                         должность                  подпись                        фамилия, инициалы

  Приложение: накладная на сдачу металлолома № _______________________ от  "____" __________________ 20____ г.

  Проверил бухгалтер ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                           подпись                       фамилия, инициалы Р
.}
.endForm

!========================================================================================================

.linkform 'Spis_MBP_09' prototype is 'Spis_MBP'
.NameInList 'Ведомость на изъятие инструмента (Форма М-30п)'
.Group 'Акт на списание МБП (Беларусь)'
.f "MBPM_30p.OUT"
.p 80
.declare
#include FeeSigners.vih
.endDeclare
.var
  PrintObr : Boolean;
  iFeeSigners : FeeSigners;
  sBuh : string;
.endvar
#CommissionLinkVar
.begin
  sBuh := '';

  iFeeSigners.InitFeeSigners(cgReport_MBP);
  iFeeSigners.FindFeeSignersByNRec(cSelectionCommissionNRec);

  if (iFeeSigners.FeeSignersIsValid)
  {
    if (iFeeSigners.RestrictFeeByRole(1, cgRole_Bux))
      sBuh := iFeeSigners.GetSignerFIO(7);

    iFeeSigners.ClearRestriction;
  }
end.
.fields
 'true' : 's'
 CommonFormHeader
 MyOrg
 ОКПО
 Podr
 Nom
 DateToStr(Dat, 'DD/MM/YYYY')
 SchMain
 KodMain
.endfields
.{
#CommissionLinkInit(SpisMBPProt)
.begin
  PrintObr := True;
end.
^ Р ^
                                                                                                                         Утверждена
                                                                                                         Постановлением Минпрома РБ
                                                                                                                  от 29.12.2004 №21
                                                                                                                        Форма М-30п
                                                                                                                      ┌────────────┐
                                                                                                                      │    Коды    │
                                                                                                                      ├────────────┤
                                                                                                        Форма по ОКУД │            │
                                                                                                                      ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   по ОКЮЛП │@~@@@@@@@@@@│
                                           наименование организации                                                   ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д            │            │
                                   наименование структурного подразделения                                            └────────────┘

                                                            БВЕДОМОСТЬ
                                    НА ИЗЪЯТИЕ ПОСТОЯННОГО ЗАПАСА ИНСТРУМЕНТА (ПРИСПОСОБЛЕНИЙ) Б
                                                                                                                    Таблица 1
       ┌────────────┬─────────────┬────────────────────────────────────────────────┬─────────────────────────────────────────┐
       │            │             │                        Код                     │           Корреспондирующий счет        │
       │   Номер    │    Дата     ├────────────────┬───────────────┬───────────────┼────────────────────┬────────────────────┤
       │ документа  │ составления │ вида операции  │  отправителя  │   получателя  │    счет, субсчет   │   код аналитичес-  │
       │            │             │                │               │               │                    │      кого учета    │
       ├────────────┼─────────────┼────────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┤
       │     1      │      2      │        3       │       4       │       5       │          6         │          7         │
       ├────────────┼─────────────┼────────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┤
       │@@@@@@@@@@@@│@~@@@@@@@@@@@│                │               │               │@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│
       └────────────┴─────────────┴────────────────┴───────────────┴───────────────┴────────────────────┴────────────────────┘
                                                                                                                          Таблица 2
.{SpSpis CheckEnter
.[h1
 ┌─────────────────────────────────────────────────────────────┬─────────────────────────┬─────────────────────────────────────────┐
 │                     Инструмент (приспособление)             │    Единица измерения    │                 Изъятие                 │
 │                                                             │                         │            поcтоянного запаса           │
 ├──────────────────────────────────────────────┬──────────────┼────────┬────────────────┼──────────┬───────────────┬──────────────┤
 │                 наименование,                │номенклатурный│  код   │  наименование  │количество│     цена,     │    сумма,    │
 │                 размер, марка                │    номер     │        │                │          │      руб.     │     руб.     │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                        1                     │       2      │   3    │       4        │    5     │       6       │      7       │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
.]h
.[h2
                                                                                                      Оборотная сторона формы М-30п
 ┌──────────────────────────────────────────────┬──────────────┬────────┬────────────────┬──────────┬───────────────┬──────────────┐
 │                        1                     │       2      │   3    │       4        │    5     │       6       │      7       │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
.]h
.fields
  MBPName
  MBPNum
  KodEd
  MBPEd
  Kol
  Price
  if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
.endfields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@@@@@@│@@@@@@@@@@@@@@@@│&#&&&&&&&&│&#&&&&&&&&&&.&&│&#&&&&&&&&&.&&│
.[f1
.begin
  PrintObr := True;
end.
 └──────────────────────────────────────────────┴──────────────┴────────┴────────────────┴──────────┴───────────────┴──────────────┘

.]f
.[f2
.fields
  sBuh
  MolShort
.endfields
.begin
  PrintObr := False;
end.
 └──────────────────────────────────────────────┴──────────────┴────────┴────────────────┴──────────┴───────────────┴──────────────┘

 Начальник инструментального
 (планового) отдела        ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Начальник цеха            ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Бухгалтер                 ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
 Инструменты отпустил      ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
 Инструменты принял
 на ответственное хранение ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
.]f
.}
.{?INTERNAL;PrintObr
.fields
  sBuh
  MolShort
.endfields
                                                                                                      Оборотная сторона формы М-30п
 ┌──────────────────────────────────────────────┬──────────────┬────────┬────────────────┬──────────┬───────────────┬──────────────┐
 │                        1                     │       2      │   3    │       4        │    5     │       6       │      7       │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 └──────────────────────────────────────────────┴──────────────┴────────┴────────────────┴──────────┴───────────────┴──────────────┘

 Начальник инструментального
 (планового) отдела        ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Начальник цеха            ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Бухгалтер                 ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
 Инструменты отпустил      ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
 Инструменты принял
 на ответственное хранение ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
.} Р
.}
.endform

!========================================================================================================

.linkform 'Spis_MBP_10' prototype is 'Spis_MBP'
.NameInList 'Акт перевода в утиль'
.Group 'Акт перевода в утиль'
.f "Spis_MBP_10.OUT"
.p 80
.fields
  CommonFormHeader
  UDNom
  if(Longint(UDDate) = 0, '____', DateToStr(UDDate, 'DD'))
  if(Longint(UDDate) = 0, '__________', DateToStr(UDDate, 'mon'))
  if(Longint(UDDate) = 0, ' 20   ', DateToStr(UDDate, 'YYYY'))
  UDPodrF
  UDPodrT
  '(МЦ "' + UDMCName + '", ' + UDMCNum + '):'
  if(Trim(UDEdShNm) <> '', ',', '')
  if(Trim(NDEShNm) <> '', ',', '')
  if(Trim(NDEShNm) <> '', ',', '')
  UDEdShNm
  NDEShNm
  NDEShNm
.endfields
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
 Р ^

                                              БАКТ ПЕРЕВОДА В УТИЛЬ №  Д@@@@@@@@@@@@@@@@@@@@ Е
                                                   от " Д@~@@ Д"  Д@~@@@@@@@@ Д @~@@@@ г.

  Сдатчик     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Получатель  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д

  Перечисленные в настоящем акте предметы превращены в утиль @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 ┌───────────────────────────────────────────────────────────────────────┬───────────────────────────────────────────────────────────┐
 │                                Предмет                                │                           Утиль                           │
 ├─────────────────────────────────────────────┬──────────────┬──────────┼──────────────┬──────────────┬──────────────┬──────────────┤
 │                наименование                 │номенклатурный│количество│   по норме   │  фактически@ │     цена@    │  стоимость@  │
 │                                             │    номер     │          │  на единицу  │@~@@@@@@@@@@@@│@~@@@@@@@@@@@@│@~@@@@@@@@@@@@│
 ├─────────────────────────────────────────────┼──────────────┼──────────┼──────────────┼──────────────┼──────────────┼──────────────┤
 │                      1                      │      2       │    3     │      4       │      5       │      6       │      7       │
 ├─────────────────────────────────────────────┼──────────────┼──────────┼──────────────┼──────────────┼──────────────┼──────────────┤
.{SpSpis CheckEnter
.[h skip
 ┌─────────────────────────────────────────────┬──────────────┬──────────┬──────────────┬──────────────┬──────────────┬──────────────┐
 │                      1                      │      2       │    3     │      4       │      5       │      6       │      7       │
 ├─────────────────────────────────────────────┼──────────────┼──────────┼──────────────┼──────────────┼──────────────┼──────────────┤
.]h
.fields
  MBPName
  MBPNum
  Kol
  USNormW
  USWeight
  USNormP
  USStoim
  UDKol
  UDSum
.endfields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│&&&&&&.&&&│&&&&&&&&&&.&&&│&&&&&&&&&&.&&&│&'&&&&&&&&&.&&│&'&&&&&&&&&.&&│
.}
 └─────────────────────────────────────────────┴──────────────┴──────────┴──────────────┼──────────────┼──────────────┼──────────────┤
                                                                                   БИтого │&&&&&&&&&&.&&&│              │&'&&&&&&&&&.&&│ Б
                                                                                        └──────────────┴──────────────┴──────────────┘
.fields
  UDMolF
  UDMolT
.endfields
  Предметы утиля сдал   ___________________  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                              подпись                      расшифровка подписи
                 принял ___________________  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                              подпись                      расшифровка подписи Р
.}
.endform

!======================================================================================================================
