//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика ERP 9.1 - Управление персоналом
// Импорт адресообразующих элементов по спецификации ФИАС
//------------------------------------------------------------------------------

#component "Z_FIAS"

#doc
Объектный интерфейс запуска из внешнего источника
#end
objinterface IImportATD_FIAS;

  #doc
  Процедура запуска
  #end
  procedure prRunImport(sText, sPath: string; wConvMaskRU: word; wUpd: word);

  #doc
  Завершение импорта
  #end
  procedure prStopImport;

  #doc
  Разблокирование элементов интерфейса
  #end
  procedure prUnBlockFields;

  property ppMode: word read;
  property ppIsFin: boolean read;

end;

#doc
Объектный интерфейс запуска из внешнего источника
#end
objinterface IImportATD_FIAS1;

  property ppSDT: string read;

end;

#doc
Расширение интерфейса импорта
#end
private objinterface IImportATD_FIAS2;

  property ppError: boolean write;

end;

VipInterface ImportATD_FIAS
implements IImportATD_FIAS, IImportATD_FIAS1, IImportATD_FIAS2
licensed(free);

#doc
Объектный интерфейс загрузки обновлений из базы ФИАС на портале fias.nalog.ru
#end
objinterface IDownloadFias;

  #doc
  Запуск загрузки обновлений из базы ФИАС на портале fias.nalog.ru
  #end
  procedure prRunDownloadFIAS(Ref: IImportATD_FIAS; Num: word; Path: string; wConvMaskRU: word; wFormat: word);
  deprecated 'Новая функция prRunDownloadFIAS_VipRef';

  #doc
  Отмена загрузки обновлений
  #end
  procedure prCancel;

  #doc
  Освобождение ссылки на визуальный интерфейс
  #end
  procedure prFreeVipIAF;

  #doc
  Отобразить ошибки загрузки/распаковки
  #end
  procedure prShowStatusError;

end;

#doc
Объектный интерфейс загрузки обновлений из базы ФИАС на портале fias.nalog.ru
#end
objinterface IDownloadFias1;

  #doc
  Запуск загрузки обновлений из базы ФИАС на портале fias.nalog.ru
  #end
  procedure prRunDownloadFIAS_VipRef(Ref: ObjRef; Num: word; Path: string; wConvMaskRU: word; wFormat: word);

end;

VipInterface DownloadFias
  implements IDownloadFias, IDownloadFias1
  licensed(free);
