//******************************************************************************
//                                                      (с) корпорация Галактика
// Галактика 9.1 - Заработная плата, Управление персоналом
// Объявление объектного интерфейса для расчета остатка оплачиваемых дней
// больничного по уходу
//******************************************************************************

#ifndef _BOLNICH_FUNCS_OBJ_INCLUDED_
#define _BOLNICH_FUNCS_OBJ_INCLUDED_

#ifdef ComponentVersion
  #component "Z_SREDN"
#end

#doc
 Объектный интерфейс для расчета остатка оплачиваемых дней больничного
#end
objinterface IBOLNICH_FUNCS;

#doc
     Функция для расчета остатка оплачиваемых дней больничного
#end
public function GetOstatokBoln (_NRec: comp): word;

  #doc
    Остаток оплачиваемых дней за год начала больничного листа
  #end
  property OstatokFirstYear: word read;

  #doc
    Остаток оплачиваемых дней за год окончания больничного листа
#end
  property OstatokSecondYear: word read;

end;

#doc
 Объектный интерфейс для обработки периода пребывания в стационаре в рамках
 одного(текущего) больничного листа по уходу
#end
objinterface IBoln_Hospital_Include;

  #doc
     Функция для определения наличия периода лечения в стационаре
  #end
  public function isHospitalDays(BlisnetNRec: comp): boolean;

  #doc
     Функция для подсчета дней (часов) пребывания в стационаре
  #end
  public function CalcHospitalDays(BlisnetNRec: comp; isOgr: byte): double;

  #doc
     Функция для подсчета дней (часов) первого процента пребывания в стационаре
  #end
  public function FirstProcHospitalDays(BlisnetNRec: comp): double;

end;

#doc
Объектный интерфейс
#end
objinterface IbolnichFuncs01;

#doc
Функция получения названия лечебного учреждения
#end
public function GetNameMedicalOffice (BlisnetNRec: comp): string;

end;

#doc
Объектный интерфейс
#end
objinterface IbolnichFuncs02;

#doc
Функция контроля необходимости установки кода 47 в строке <Условия исчисления>:
47 - в случае, если заболевание (травма) наступили в течение 30 календарных дней
со дня прекращения работы по трудовому договору, осуществления служебной или иной деятельности,
в течение которых лицо подлежит обязательному социальному страхованию на случай временной нетрудоспособности и
в связи с материнством
Параметры:
dtUv - дата увольнения
dtBeg - дата начала заболевания
wType - тип пособия (для типа пособия "по уходу" код 47 не заполняется)
Функция возвращает true, если <Условия исчисления> в больничном - 47,
иначе - false
#end
public function fboCheckCode47(dtUv: date; dtBeg: date; byTypePos: byte): boolean;
end;

#doc
Объектный интерфейс
#end
objinterface IbolnichFuncs03;

#doc
Функция контроля (проверки) возможности расчета больничного
в зависимости от его состояния.
ЭЛН, которые находятся в одном из состояний:
"010 ЭЛН открыт", "020 ЭЛН продлен", "040 ЭЛН направление на МСЭ", "050 ЭЛН дополнен данными МСЭ"
не подлежат расчету.

Параметры:
wStateLN - состояние ЭЛН
Функция возвращает true, если больничный можно рассчитывать, иначе - false
#end
public function fboChecktoCalculate(wStateLN: word): boolean;
end;
//------------------------------------------------------------------------------

#end
