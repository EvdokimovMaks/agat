//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.10 - модуль "Заработная плата"
// Интерфейс редактирования: "Документы РСВ-1"
//------------------------------------------------------------------------------

#ifndef _NDFL_VIH_INCLUDED_
#define _NDFL_VIH_INCLUDED_

const
  cgReport_6NDFL   = 6;
  //период формирования
  cnPeriod_1_Kvart = 1;  // 1 - ы й квартал
  cnPeriod_2_Kvart = 2;  // 2 - ы й квартал
  cnPeriod_3_Kvart = 3;  // 3 - ы й квартал
  cnPeriod_4_Kvart = 4;  // 4 - ы й квартал

  //разделы
  cnRazdel_Titl    = 0;
  cnRazdel_01      = 1;
  cnRazdel_02      = 2;

  //суммы по сотрудникам
  cnSum_R2          = 0;
  cnSumDU_R2        = 1;
  cnSumPer_R2       = 2;
  cnSumNeg_R2       = 3;
  cnSumDel_R2       = 100;

  //наименование организации
  cn_NmOrgFull     = 0;
  cn_NmOrgAlt      = 1;

  //ставки налога
  cnStavka_Itog    = 1000;
  cnStavka_9       = 9;
  cnStavka_13      = 13;
  cnStavka_15      = 15;
  cnStavka_30      = 30;
  cnStavka_35      = 35;

  NDFL6_RAZDEL2_LISTNAME = 'Раздел 2 (Исходные данные)';
  NDFL6_RAZDEL2_HEADERROWNUM = 4;
  NDFL6_RAZDEL2_STARTCOL     = 1;

  //заголовки столбцов
  NDFL6_RAZDEL2_HEADERNAME_TABN     = 'Таб. номер';
  NDFL6_RAZDEL2_HEADERNAME_FIO      = 'ФИО';
  NDFL6_RAZDEL2_HEADERNAME_D_POLUCH = 'Дата получения дохода (100)';
  NDFL6_RAZDEL2_HEADERNAME_D_VYPLAT = 'Дата выплаты дохода (110)';
  NDFL6_RAZDEL2_HEADERNAME_D_PERECH = 'Срок перечисления (120)';
  NDFL6_RAZDEL2_HEADERNAME_S_VYPLAT = 'Сумма выплаты (130)';
  NDFL6_RAZDEL2_HEADERNAME_S_NDFL   = 'Сумма НДФЛ (140)';
  NDFL6_RAZDEL2_HEADERNAME_LS_NDFL  = 'Ссылка на ЛС';
  NDFL6_RAZDEL2_HEADERNAME_CODEP    = 'Код дохода';
  NDFL6_RAZDEL2_HEADERNAME_REESTR   = 'Реквизиты реестра/ведомости';
end;

// таблица в памяти, в которой хранится перечисленный налог по сотруднику
Table struct tp_listedIncTax
(
  NRec          : comp
 ,cLsch         : comp
 ,cSbBan        : comp
 ,cPlPor        : comp
 ,wStavka       : word
 ,dataN         : date
 ,Month         : word
 ,Year          : word
 ,dtIncTax      : date
 ,NoDOK         : tNoDok
 ,Summa         : double
 ,SummaN        : double
)
With Index
(
  tp_listedIncTax01  =  NRec(Unique, Surrogate)
 ,tp_listedIncTax02  =  cLsch + wStavka + dataN + dtIncTax
 ,tp_listedIncTax03  =  cLsch + Month   + Year  + dtIncTax
);

#define sMaskDouble2Format [14.2, '\2p[|-]36 666 666 666 666.88']
#define sMaskDouble0Format [14, '\2p[|-]36 666 666 666 666']

#ifdef Gal9_1
  #define hcNDFL hcZar_ParamNDFL6
#else
  #define hcNDFL hcNalSprR
#end

#end
