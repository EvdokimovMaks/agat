//------------------------------------------------------------------------------
//                                                     (c) корпорация ГАЛАКТИКА
// Галактика 8.1 - Заработная плата
// Интерфейс для определения существенных признаков, заданных в классификаторах
//------------------------------------------------------------------------------
#ifndef _DeterminantAdviser_vih_INCLUDED_
#define _DeterminantAdviser_vih_INCLUDED_

#ifdef ComponentVersion
  #component "Z_CALC"
#end

#include IAmountCorrection.obj
#include ITaxAttributes.obj

//------------------------------------------------------------------------------
objinterface ICached;
  #doc
    сбросить кэш работы всех кэшируемых функций
  #end
  function Reset: boolean;
end;
//------------------------------------------------------------------------------
objinterface IMAP_KLVIDUD; // IChart_KLVIDUD     IMap_KlVidUd
  #doc
    получить пользовательский код вида удержания
  #end
  function GetUserCode(SysCode: word): word;
  #doc
    получить системный код вида удержания
  #end
  function GetSysCode(UserCode: word): word;
  #doc
    по виду удержания и идентификатору признака направления
  #end
  function IsTrend(SysCode: word; Ch: byte): boolean;
  #doc
    получить текущее значение атрибута Part для вида удержания SysCode
  #end
  function GetVal(SysCode: word; Part: longint): comp;
  #doc
    получить наименование текущего значения атрибута Part для вида удержания
    с системным кодом SysCode
  #end
  function GetValName(SysCode: word; Part: longint): string;
  #doc
    с признаком "перечисление" (в банк)
  #end
  function IsTransfer(SysCode: word): boolean;
  #doc
    с признаком "выплата" (через кассу)
  #end
  function IsPayment(SysCode: word): boolean;
  #doc
    с признаком "удержание"
  #end
  function IsDeduction(SysCode: word): boolean;
  #doc
    пересылка почтой
  #end
  function IsPostalOrder(SysCode: word): boolean;
  #doc
    выплата через кассу
  #end
  function IsCashOrder(SysCode: word): boolean;
  #doc
    выплата зарплаты
  #end
  function IsSalary(SysCode: word): boolean;
  #doc
    зарплата почтой
  #end
  function IsSalaryPost(SysCode: word): boolean;
  #doc
    зарплата через банк
  #end
  function IsSalaryBank(SysCode: word): boolean;
  #doc
    зарплата через кассу
  #end
  function IsSalaryCash(SysCode: word): boolean;
  #doc
    выплата аванса
  #end
  function IsPrepayment(SysCode: word): boolean;
  #doc
    налоги на доходы
  #end
  function IsIncomeTax(SysCode: word): boolean;
  #doc
    профвзносы
  #end
  function IsProfDue(SysCode: word): boolean;
  #doc
    алименты
  #end
  function IsAlimony(SysCode: word): boolean;
  #doc
    алименты почтой
  #end
  function IsAlimonyPost(SysCode: word): boolean;
  #doc
    алименты через банк
  #end
  function IsAlimonyBank(SysCode: word): boolean;
  #doc
    алименты через кассу
  #end
  function IsAlimonyCash(SysCode: word): boolean;
  #doc
    исполнительные листы
  #end
  function IsWritOfExec(SysCode: word): boolean;
  #doc
    исполнительные листы почтой
  #end
  function IsWritOfExecPost(SysCode: word): boolean;
  #doc
    исполнительные листы через банк
  #end
  function IsWritOfExecBank(SysCode: word): boolean;

  #doc
    страховые взносы
  #end
  function IsInsurance(SysCode: word): boolean;
  #doc
    с признаком "ссуда"
  #end
  function IsLoan(SysCode: word): boolean;

  #doc
    наименование вида удержания
  #end
  function GetName(SysCode: word): string;
  #doc
    сокращенное наименование вида удержания
  #end
  function GetShortName(SysCode: word): string;

  #doc
    поиск организации получателя в классификаторе удержаний, возвращает в
    ссылку на организацию получателя и true, если получатель был найден
  #end
  function GetPayee(SysCode: word; Department: comp; var Org, Bank: comp): boolean;

  #doc
    поиск сведений о получателе и его атрибутах в классификаторе удержаний,
    возвращает ссылку на источник сведений о получателе (на запись KLUDER)
    и true, если такой источник был найден
  #end
  function GetKlPayee(SysCode: word; Department: comp; var Ref: comp): boolean;

end;

//------------------------------------------------------------------------------
vipinterface DeterminantAdviser
  implements
    IMAP_KLVIDUD,
    IAmountCorrection,
    ITaxAttributes,
    ICached,
    ITaxesRegion
  licensed (free);

#end
