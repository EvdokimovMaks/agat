//-----------------------------------------------------------------------------
//                                                     (c) корпорация ГАЛАКТИКА
// Галактика 8.1 - Заработная плата
// Атрибуты плательщика и получателя для платежных документов
//-----------------------------------------------------------------------------
#ifndef _TAXATTRIBUTES_OBJ_INCLUDED_
#define _TAXATTRIBUTES_OBJ_INCLUDED_

#ifdef ComponentVersion
  #component "Z_CALC"
#end

#doc
  определение атрибутов оплаты для платежных документов
#end
objinterface ITaxAttributes;
  #doc
    удаление всех ранее определенных атрибутов
  #end
  procedure Clear;
  #doc
    возвращает подразделение из допаналитик, либо подразделение RefDep
  #end
  function GetDepartmentEx(RefDep, RefDop: comp): comp; deprecated 'Устаревший метод. Работа по ссылке на OtpDop не поддерживается.';
  #doc
    возвращает АТД подразделения RefDep
  #end
  function GetDepATD(RefDep, RefDop: comp): comp; deprecated 'Устаревший метод. Работа по ссылке на OtpDop не поддерживается.';
  #doc
    возвращает ОКАТО подразделения RefDep
  #end
  function GetDepOKATO(RefDep, RefDop: comp): string; deprecated 'Устаревший метод. Работа по ссылке на OtpDop не поддерживается.';
  #doc
    возвращает подразделение, имеющее прямую связь с переданной организацией
  #end
  function GetFilialDep(RefOrg: comp): comp;
  #doc
    возвращает организацию, к которой относится переданное подразделение
  #end
  function GetLinkedOrg(RefDep: comp): comp;
  #doc
    возвращает ссылку на вышестоящее обособленное подразделение или филиал
  #end
  function GetDistinctDep(RefDep: comp): comp;
  #doc
    подразделение свертки на уровне Depth для подразделения RefDep
  #end
  function GetPacketDep(RefDep: comp; Depth: word): comp;
  #doc
    ссылка на код причины постановки на учет подразделения RefDep
  #end
  function GetDepKpp(RefDep: comp; var RefKpp: comp): boolean;
  #doc
    возвращает строковый код КПП по ссылке на КПП
  #end
  function GetKodKPP(RefKpp: comp): string;
  #doc
    возвращает ссылку на ГНИ (ссылку на запись в KATKOD с данными ГНИ)
  #end
  function GetTaxAgency(RefDep: comp): comp;
  #doc
    возвращает атрибуты плательщика, имеющего прямую связь с подразделением
  #end
  function GetTaxPayer(RefDep: comp; var RefOrg, RefBnk: comp): boolean;
  #doc
    возвращает получателя, связанного с подразделением RefDep
  #end
  function GetTaxPayee(SysCode: word; RefDep: comp; var RefOrg, RefBnk: comp): boolean;

end;

#doc
  муниципальный код территории (ОКТМО), обслуживаемой налоговой инспекцией
#end
objinterface ITaxesRegion;
  #doc
    возвращает АТД определенное по допаналитикам, либо АТД, определенное
    по подразделению RefDep
  #end
  function GetDepTaxAtd(RefDep, RefDop: comp): comp; deprecated 'Устаревший метод. Работа по ссылке на OtpDop не поддерживается.';

  #doc
    возвращает код ОКТМО по аналитике АТД или аналитике подразделения
    в допаналитиках, либо код ОКТMО по подразделению RefDep
  #end
  function GetDepOKTMO(RefDep, RefDop: comp): string; deprecated 'Устаревший метод. Работа по ссылке на OtpDop не поддерживается.';

end;

#end
