//------------------------------------------------------------------------------
//                                                     (c) корпорация ГАЛАКТИКА
// Галактика 8.1 - Заработная плата
// Выплаты по лицевому счету
//------------------------------------------------------------------------------
#ifndef _AccountWages_vih_INCLUDED_
#define _AccountWages_vih_INCLUDED_

#component "Z_PayRep"

objinterface IAccountWages;
  #doc
    Загружает документы выплат по лицевому счету и формирует список выплат,
    относящихся к переданному периоду.
  #end
  function Load(cPersAccount: comp; wYear, wMonth: word): boolean;

  #doc
    Альтернативный способ получения списка выплат по лицевому счету и периоду.
    Формирует список выплат, основываясь на данных в той, на которую передана ссылка.
    Если ссылка не передана, то ничего не будет загружено. Метод не гарантирует,
    что будет что то загружено, или что список будет правильным или достаточно полным.
  #end
  function LoadVipl(wVipl: word; cVipl: comp): boolean;

  #doc
    Отобразить список выплат. Возвращает событие, по которому закрылось окно.
  #end
  function ShowWages: word;

  #doc
    Скрыть список выплат.
  #end
  procedure HideWages;

  #doc
    Поиск выплаты по типу wVipl и ссылке cVipl в текущем списке выплат.
    Если выплата в списке найдена, переходит на нее и возвращает true.
    Если выплата в списке не найдена возвращает false.
    Применяется после создания списка выплат методом Load.
  #end
  function Seek(wVipl: word; cVipl: comp): boolean;

  #doc
    Метод для обхода списка выплат. Переход к первой выплате в списке.
    Возвращает false, если список пуст.
    Применяется после создания списка выплат методом Load.
  #end
  function First: boolean;

  #doc
    Метод для обхода списка выплат. Переход к следующей выплате в списке.
    Применяется совместно с методом First.
  #end
  function Next: boolean;

  #doc
    Возвращает тип выплаты из записи, которая является текущей в списке.
  #end
  function wCurrent: word;

  #doc
    Возвращает NRec выплаты из записи, которая является текущей в списке.
  #end
  function cCurrent: comp;

  #doc
    Возвращает дату создания выплаты (для текущей записи в списке).
  #end
  function GetDatVpl: date;

  #doc
    Возвращает дату фактической оплаты (для текущей записи в списке).
  #end
  function GetDatOpl: date;

  #doc
    Сброс всех опций отображения в значение по умолчанию (с отображением всех выплат).
  #end
  procedure SetDefault;

  #doc
    Параметры вывода информации о выплате в виде строки.
    Используются в методе GetString.
  #end
  property ParString: word;

  #doc
    Строка с информацией о выплате. Настройка выводимой в строку информации
    производится в свойстве ParString.
  #end
  function GetString(wVipl: word; cVipl: comp): string;

  #doc
    Режим выбора выплаты: true - в режиме одиночного выбора;
    false - режим с отсутствием выбора.
    Значение следует устанавливать до вызова метода ShowWages.
  #end
  property IsSingled: boolean;

  #doc
    Отображать выплаты дохода.
    Значение следует устанавливать до вызова метода Load.
  #end
  property SetIncome: boolean;

  #doc
    Отображать выплаты НДФЛ.
    Значение следует устанавливать до вызова метода Load.
  #end
  property IncomeTax: boolean;

  #doc
    Отображать социальные отчисления (налоги на ФОТ).
    Значение следует устанавливать до вызова метода Load.
  #end
  property SocialTax: boolean;

end;

vipinterface AccountWages
  implements
    IAccountWages
  licensed(free)
  parameters(
    cLschet: comp;
    wYearN,
    wMesN,
    wVipl: word;
    cVipl: comp;
    dVipl: date)
  ;

#end
