/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,2001 корпорация ГАЛАКТИКА                    ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Заработная плата                                          ║
 ║ Версия        : 5.7 - 7.1                                                 ║
 ║ Назначение    : Объектный интерфейс "Функции обработки нарядов"           ║
 ║ Ответственный : Корзюк Виталий Францевич                                  ║
 ║ Параметры     : нет                                                       ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#ifndef _JOBFUNCS_INCLUDED_
#define _JOBFUNCS_INCLUDED_

#component "Z_MP"
type TPrNaryad = record as table PRNARYAD;

#doc
Объектный интерфейс "Функции обработки нарядов"
#end

objinterface oJobFunctions;
  #doc
    Кол-во алгоритмов расчета заработка по наряду
  #end
  function GetSalaryAlgCount: integer;

  #doc
    Название I-го алгоритма расчета заработка по наряду
  #end
  function GetSalaryAlgName(I: integer): string;

  #doc
    Кол-во алгоритмов расчета премии по наряду
  #end
  function GetPremiumAlgCount: integer;

  #doc
    Название I-го алгоритма расчета премии по наряду
  #end
  function GetPremiumAlgName(I: integer): string;

  #doc
    Пересчет кол-ва дней, часов, даты окончания; то, что нужно пересчитать,
    предварительно зануляется
  #end
  procedure RecalcTime(var B: type$PRNARYAD; Actual: boolean);

  #doc
    не выполнять пересчет периода при корректировке фактических дней и пересчет
    фактических дней и часов при корректировке периода
  #end
  function WorkingTableUseDisabled: boolean;

  #doc
    наряд должен разноситься с учетом переходов в межпериод
  #end
  function ProcessChanges(var B: type$SYS_NAR): boolean;

  #doc
    наряд должен разноситься с учетом лицевой стороны
  #end
  function ProcessJobList(var B: type$SYS_NAR): boolean;

  #doc
    удалить запись с лицевой стороны наряда
  #end
  procedure DeleteJobListItem(var JLI: type$P_SMNARYAD);

  #doc
    удалить работу
  #end
  procedure DeleteJob(var J: type$p_PRNARYAD);

  #doc
    удалить работы наряда
  #end
  procedure DeleteJobs(var JS: type$p_SYS_NAR);

  #doc
    удалить запись из перечня нарядов
  #end
  procedure DeleteJobSheet(var JS: type$p_SYS_NAR);

  #doc
    порядковый номер наряда
  #end
  function GetNextJobSheetNumber: word;
    deprecated 'Метод устарел. Нужно использовать GetNextJobSheetNumberNew';

  #doc
    название вида наряда
  #end
  function GetJobSheetTypeName(Choice: word): string;

  #doc
    наименование наряда по умолчанию
  #end
  function GetJobSheetDefaultName(Number: word): string;
    deprecated 'Метод устарел. Нужно использовать GetJobSheetDefaultNameNew';

  #doc
    сдублировать наряд
  #end
  procedure DuplicateJobSheet(Src: comp; var Dst: comp);

end;

//******************************************************************************
#doc
  Объектный интерфейс для доступа к функционалу обработки доплат на наряд.
#end
objinterface oJobFunctions1(oJobFunctions);
  #doc
    порядковый номер наряда
  #end
  function GetNextJobSheetNumberEx(maxCount: longint; markers: TPtr): word;   //АВЗ024
    deprecated 'Метод устарел. Нужно использовать GetNextJobSheetNumberExNew';

  #doc
    заполнить маркер номерами наряда
  #end
  procedure GetMarkerJobSheetNumbers(maxCount: longint; var markers: longint);  //АВЗ024
end;

//******************************************************************************
#doc
  Объектный интерфейс для доступа к функционалу обработки доплат на наряд.
#end
objinterface oJobFunctions2(oJobFunctions1);
  #doc
    порядковый номер наряда
  #end
  function GetNextJobSheetNumberNew: longint;

  #doc
    наименование наряда по умолчанию
  #end
  function GetJobSheetDefaultNameNew(Number: longint): string;

  #doc
    порядковый номер наряда
  #end
  function GetNextJobSheetNumberExNew(maxCount: longint; markers: TPtr): longint;   //АВЗ024
end;

//******************************************************************************
#doc
  Объектный интерфейс для доступа к функционалу обработки доплат на наряд.
#end
objinterface IJobFunctions1;
  #doc
    Копирует доплаты.</brief>

    <p>Тип доплат и запись-владелец определяются параметрами Choice и Owner,
    запись-владелец копий - значением параметра NewOwner.</p>
  #end
  procedure DuplicateAdditionalPayments(Choice: word; Owner, NewOwner: comp);
end;

//******************************************************************************
#doc
  Объектный интерфейс для доступа к функционалу распределения времени по наряду.
#end
objinterface IJobTimeRedistributor;
  #doc
    Перераспределяет время во всей спецификации данного наряда.
  #end
  procedure RedistributeByJobSheet(jobSheetRef: comp);

  #doc
    Перераспределяет время во всех спецификациях, связанных с данной записью на
    лицевой стороне наряда.
  #end
  procedure RedistributeByJobListItem(JobListItemRef: comp);
end;

//******************************************************************************
#doc
  Объектный интерфейс для доступа к функционалу распределения времени по наряду.
#end
objinterface IJobTimeRedistributor1;
  #doc
    Перераспределяет время при опции 'по фактическому времени из табеля'
    только для позиций с тем же ЛС в спецификации, для остальных опций так же,
    как и RedistributeByJobListItem
  #end
  procedure TimeRedistributionManager(specRef: comp);
end;

//******************************************************************************
#doc
  Управление разноской и расчетом нарядов.
#end

objinterface IDistrCalc;
  #doc
    Установить статус разноски и расчета наряда.
  #end
  procedure SetDistributionCalculationStatus(workOrderRef: comp; calculated: boolean);
end;

#doc
  Объектный интерфейс для доступа к функционалу обработки доплат на наряд.
#end
objinterface oJobFunctions3(oJobFunctions2);
  #doc
    порядковый номер наряда с возможностью указать параметры
  #end
  function GetCustomNextJSNumber(sub: string; len: byte): longint;
end;

#doc
  Объектный интерфейс для доступа к функционалу обработки доплат на наряд.
#end
objinterface oJobFunctions4(oJobFunctions3);
  #doc
    порядковый номер наряда с возможностью указать параметры, возвращает строку
  #end
  function GetCustomNextJSStrNum(sub: string; len: byte): string;
end;

vipinterface JobFunctions
  implements
    oJobFunctions,
    IJobFunctions1,
    oJobFunctions1,
    oJobFunctions2,
    oJobFunctions3,
    oJobFunctions4,
    IJobTimeRedistributor,
    IJobTimeRedistributor1,
    IDistrCalc
  licensed(free);

#end
