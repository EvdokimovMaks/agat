//------------------------------------------------------------------------------
//                                           (c) корпорация ГАЛАКТИКА
// Галактика 9.1 - Управление персоналом
// Источники финансирования по модулю УП
//------------------------------------------------------------------------------

#ifndef _WorkWithIF_INCLUDED_
#define _WorkWithIF_INCLUDED_

#component "Z_StaffIF"

const
  cn_NotUseIF = 0;  //не использовать ИФ ни в каком виде
  cn_UseIF = 1;     //используем ИФ
  cn_UseSHPZ = 2;   //используем ШПЗ
end;

#doc
Источники финансирования для модуля "Управление персоналом"
#end
ObjInterface IWorkWithIF;

#doc
Подсчет суммарной занятости по источникам финансирования для сущности
#end
  function GetWholeSum(wTable: word  // #docl физический код таблицы, для которой выбираются данные
                      ; cTable: comp // #docl NRec записи таблицы, для которой выбираются данные
                      ; bPosition: boolean // #docl надо ли дополнительное позиционирование (перестроение ЛТ)
                      ): double;

#doc
Создание разбиения по источникам финансирования для сущности
#end
  function CreateOrUpdateAllIF(wTable: word // #docl физический код таблицы, в которой мы изменяем разбиение по ИФ
                             ; cTable: comp // #docl NRec записи таблицы, в которой мы изменяем разбиение по ИФ
                             ; dSizeVacancy: double // #docl размер заполняемой ставки величинами ИФ
                             ; KindField: word // #docl какое поле модифицировать: 0 - dPortion, 1 - dbusyPortion, 2 - dFreePortion
                              ): boolean;
  deprecated 'Вместо CreateOrUpdateAllIF следует использовать RecalcIFForEntity';

#doc
Копирование разбиения по источникам финансирования из одной сущности в другую</brief>
Данные по источникам финансирования в сущности-приемнике предварительно зачищаются
#end
  function CopyIFFromTo(wTableS: word // #docl физический код таблицы, в которой есть данные
                      ; cTableS: comp // #docl NRec записи таблицы, в которой есть данные
                      ; wTableD: word // #docl физический код таблицы, в которую копируем данные
                      ; cTableD: comp // #docl NRec записи таблицы, в которую копируем данные
                       ): boolean;

#doc
Наследование разбивки по ИФ из ШР в назначение
#end
  function CopyIFFromSSToApp(wTableS: word // #docl физический код таблицы, в которой есть данные
                           ; cTableS: comp // #docl NRec записи таблицы, в которой есть данные
                           ; wTableD: word // #docl физический код таблицы, в которую копируем данные
                           ; cTableD: comp // #docl NRec таблицы, в которую копируем данные
                           ; dSizeVacancy: double // #docl размер, который нужно вычленить из ИФ
                            ): boolean;
  deprecated 'Вакантная часть по источникам финансирования динамически пересчитывается и больше не наследуется';

#doc
Удаление разбиения по источникам финансирования для сущности
#end
  function DeleteIFFromTable(wTable: word // #docl физический код таблицы, в которой есть данные
                           ; cTable: comp // #docl NRec записи таблицы, в которой есть данные
                           ; wTypeDel: word // #docl тип удаления: 0 - все записи, 1 - первую, 2 - вторую, ...
                            ): boolean;

#doc
Показать окно текущего разбиения по источникам финансирования для сущности
#end
  function ShowScreen(wTable: word // #docl физический код таблицы, для которой мы хотим увидеть данные
                    ; cTable: comp // #docl NRec записи таблицы, для которой мы хотим увидеть данные
                    ; ViewRegim: word // #docl 0 - просмотр, 1 - редактирование
                    ; dSizeVacancy: double // #docl размер заполняемой ставки
                     ): boolean; // #docl возвращает признак того, редактировались ли данные

#doc
Проверка на существование ИФ в системе. В зависимости от варианта настроек и наличия классификатора возвращает значения:<br>
  cn_NotUseIF - источники финансирования не используются<br>
  cn_UseIF - используется разбиение по источникам финансирования<br>
  cn_UseSHPZ - функционал источников финансирования используется для работы с ШПЗ
#end
  function CheckIFInBD: word;

#doc
Проверка на возможнсть ввода значения относительно остатков по таблицам штатного расписания
#end
  function CheckCountInBDByOne(Np: tNpp // #docl порядковый номер ИФ
                             ; wTableD: word; cTableD: comp
                             ; d1, d2, d3: double): boolean;
  deprecated 'Функция устарела. Всегда возвращает true.';

#doc
Проверка на возможность ввода значения относительно остатков по таблицам штатного расписания (по всем источникам)
#end
  function CheckCountInBDByAll(wTableS: word; cTableS: comp
                             ; wTableD: word; cTableD: comp): boolean;
  deprecated 'Функция устарела. Всегда возвращает true.';

#doc
Внести изменения в ШР или доплаты по ШР
#end
  function ModifySERaises(wTableS: word // #docl какую таблицу модифицировать
                        ; cTableS: comp // #docl какую запись таблицы модифицировать
                        ; wTableD: word // #docl на основании какой таблицы модифицировать
                        ; cTableD: comp // #docl на основании какой записи таблицы модифицировать
                        ; btPath: byte  // #docl 0 - уменьшить, 1 - увеличить
                         ): boolean;
  deprecated 'Занятая часть ИФ пересчитывается динамически. Функция устарела. Всегда возвращает true.';


#doc
Строковое значение по всем ИФ данной сущности
#end
  function GetStrNameByIF(wTableS: word; cTableS: comp): string;

#doc
Строковое значение по всем ИФ данной сущности вместе с планом и фактом
#end
  function GetWholeStrNameByIF(wTableS: word; cTableS: comp): string;
  deprecated 'Вместо GetWholeStrNameByIF следует использовать GetStrNameByIF';

#doc
Пересчитать разбиение по ИФ ввиду изменившегося количества ставок для сущностей по полю "занятые" - dBusyPortion
#end
  procedure ReSizeIF(wTableS: word; cTableS: comp; dSizeVacancy: double);
  deprecated 'Занятая часть ИФ пересчитывается динамически. Процедура ReSizeIF устарела.';

#doc
Реформировать занятые и свободные ставки
#end
  procedure ReCalcPortion(wTableS: word; cTableS: comp; dSizeVacancy: double; wNp: word);
  deprecated 'Занятая/свободная часть ИФ пересчитывается динамически. Процедура ReCalcPortion устарела.';
end;

#doc
Источники финансирования по модулю УП (расширение)
#end
ObjInterface IWorkWithIF02;

#doc
Количество ИФ по указанной сущности
#end
  function Exists(wTableS: word; cTableS: comp): word;

#doc
Совпадают ли ИФ в двух сущностях
#end
  function CompareIF(wTableS: word; cTableS: comp
                    ; wTableD: word; cTableD: comp): boolean;
#doc
Пересчет разбиения по ИФ ввиду изменившегося количества ставок для сущностей по полю "всего" - dBusyPortion
#end
  procedure ReSizeIFinCommon(wTableS: word; cTableS: comp; dSizeVacancy: double);
  deprecated 'Занятая/свободная часть ИФ пересчитывается динамически. Процедура ReSizeIFinCommon устарела.';

#doc
Модификация разбиения по ИФ (ШПЗ) сотрудников ввиду изменения этих параметров в ставке
#end
  procedure UpdateAppBySS(wTableS: word; cTableS: comp; wTableD: word; cTableD: comp);
  deprecated 'Занятая/свободная часть ИФ пересчитывается динамически. Процедура UpdateAppBySS устарела.';
end;

#doc
Источники финансирования по модулю УП (расширение)
#end
ObjInterface IWorkWithIF03;

#doc
Показать окно разбиения ИФ указанной сущности на дату
#end
  function ShowScreenOnDate(_wTable: word // #docl физический код таблицы, для которой выбираются данные
                    ; _cTable: comp // #docl NRec записи таблицы, для которой выбираются данные
                    ; _ViewRegim: word // #docl 0 - просмотр, 1 - просмотр и редактирование
                    ; _dSizeVacancy: double // #docl размер заполняемой ставки
                    ; _dDate: date = ZeroDate // #docl дата, на которую анализируются данные (необязательный параметр)
                    ): boolean; // #docl Возвращает признак того, редактировались ли данные

#doc
Пересчитать распределяемую часть ИФ для указанной сущности.
#end
  function RecalcIFForEntity(_wTable: word // #docl физический код таблицы, для которой выбираются данные
                    ; _cTable: comp // #docl NRec записи таблицы, для которой выбираются данные
                    ; _dValue: double // #docl распределяемая величина ИФ
                    ; _dDate: date = ZeroDate // #docl дата, на которую анализируются данные (необязательный параметр)
                    ): boolean; // #docl возвращает false в случае неудачи
#doc
Добавление/удаление значений разбиения по ИФ из одной сущности в другую.
#end
  function AddIFFromTo(_wTableS: word // #docl физический код таблицы-источника, данные по ИФ из которой добавляются
                      ; _cTableS: comp // #docl NRec записи таблицы-источника
                      ; _wTableD: word // #docl физический код таблицы-приемника, в которую добавляем данные
                      ; _cTableD: comp // #docl NRec записи таблицы-приемника
                      ; _bSubtraction: boolean = false // #docl необязательный параметр, который определяет добавляем (false, значение по умолчанию) или отнимаем (true) долю по ИФ
                       ): boolean;     // #docl возвращает false в случае неудачи

end;

VipInterface WorkWithIF
  implements IWorkWithIF, IWorkWithIF02, IWorkWithIF03
  Licensed(Free);
#end
