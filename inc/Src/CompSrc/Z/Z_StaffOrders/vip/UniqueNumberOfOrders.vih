/*
  Проект        : ГАЛАКТИКА
  Система       : Управление персоналом
  Назначение    : Объектный интерфейс обработки номеров приказов
*/
#ifndef _UniqueNumberOfOrders_INCLUDED_
#define _UniqueNumberOfOrders_INCLUDED_

#ifdef ComponentVersion
#component "Z_StaffOrders"
#end

const
  NUM_BY_SPEC_TABLE = 0; //нумерация по специальной таблице
  NUM_BY_LAST_IN_DB = 1; //нумерация по последним номерам в БД
end;

#doc
Объектный интерфейс обработки номеров приказов
#end
objinterface IUniqueNumberOfOrders;

#doc
Функция проверки уникальности присваемого номера
#end
Function UniqDoc(MyNmb: string): boolean;
deprecated 'Функция устарела, лучше использовать UniqDocByNastrWithYear';

#doc
Функция нахожения следующего номера для приказа
#end
Function GetNmbPr(wOper: word): string[20];
deprecated 'Функция устарела, лучше использовать GetNmbPrWithYear';

#doc
Функция удаления конкретного приказа с номером sDelNmb
#end
Function DelNmbPr(wOper: word; sDelNmb: string): boolean;

end;//IUniqueNumberOfOrders
//******************************************************************************
#doc
Первое расширение объектника по обработке уникальности номеров
#end
objinterface IUniqueNumberOfOrders01;

#doc
Функция проверки уникальности присваемого номера в рамках установленных настроек
#end
Function UniqDocByNastr(MyNmb: string; cTitleDoc: comp; wOper: word): boolean;
deprecated 'Функция устарела, лучше использовать UniqDocByNastrWithYear';

end; //IUniqueNumberOfOrders01

#doc
Второе расширение объектника по обработке уникальности номеров
#end
objinterface IUniqueNumberOfOrders02;

#doc
Функция проверки а нужно ли искать при данных настройках другой номер
приказа при переходе от сводного к индивидуальному и наоборот
wOper - номер рпд в индивидуальном варианте
wPath: 0 - из индивидуального в сводный
       1 - из сводного в индивидуальный
#end
Function ShouldChangeNumber(wOper, wPath: word): boolean;
deprecated 'Достаточно проверки настройки UP.STAFF.DIFF_NMB_FOR_DIFF_OPER';

end; //IUniqueNumberOfOrders02

objinterface IUniqueNumberOfOrders03;
  #doc
    Функция проверки уникальности присваемого номера в рамках установленных настроек
  #end
  Function UniqDocByNastrWithYear(MyNmb: string; cTitleDoc: comp; wOper, wYr: word): boolean;
  #doc
    Функция нахожения следующего номера для приказа
  #end
  Function GetNmbPrWithYear(wOper, wYr: word): string[20];

end;

vipinterface UniqueNumberOfOrders implements IUniqueNumberOfOrders
                                              , IUniqueNumberOfOrders01
                                              , IUniqueNumberOfOrders02
                                              , IUniqueNumberOfOrders03
  Licensed (free)
;

#end
