/*
  Проект        : ГАЛАКТИКА
  Система       : Управление персоналом
  Назначение    : Объектный интерфейс работы с удержаниями при работе с РК (рабочей корзиной)
*/
#ifndef _SetUderRK_INCLUDED_
#define _SetUderRK_INCLUDED_

#ifdef ComponentVersion
#component "Z_StaffOrders"
#end

#doc
Объектный интерфейс работы с удержаниями при связи с рабочей корзиной
#end
objinterface ISetUderRK;

#doc
Закрыть по сотруднику постоянное удержание
cPers - ссылка на Persons
cApp - ссылка на Appointments
cPunish - ссылка на Punishments (удержания модуля "Кадры")
MsgCode - добавление или удаление постоянного удержания
#end
Function MsgRR(cPers: comp; cApp: comp; MsgCode: integer; cPunish: comp): boolean;

#doc
Закрыть по сотруднику постоянное удержание
cPers - ссылка на Persons
cApp - ссылка на Appointments
cPunish - ссылка на Punishments (удержания модуля "Кадры")
cContDoc - ссылка на ContDoc (приказ)
dEnd - дата окончания действия взыскания (необходима для обработки откатов рпд-32)
#end
Function CloseSU(cPers: comp; cApp: comp; cPunish: comp; cContDoc: comp; dEnd: date): boolean;

#doc
Открыть по сотруднику постоянное удержание
cPers - ссылка на Persons
cApp - ссылка на Appointments
cPunish - ссылка на Punishments (удержания модуля "Кадры")
cContDoc - ссылка на ContDoc (приказ)
dBeg - дата начала действия взыскания
dEnd - дата окончания действия взыскания
#end
Function OpenSU(cPers: comp; cApp: comp; cPunish: comp; cContDoc: comp; dBeg, dEnd: date): boolean;

#doc
 Зачистка корзины по данному удержанию в случаях удаления вообще, в принципе
 1 - все грохать
 2 - только неутвержденные
 3 - только утвержденные
 5 - только по конкретному приказу
 возвращаемые коды:
 0 - невзрачный признак. Либо групповое удаление, либо не было удаленных сигналов
 1 - удален обработанный сигнал
 2 - удален необработанный сигнал
 100 - удаление было неудачно
 (когда удалялось несколько, то будем возвращать признак утв., если такой был хоть один,
 а неутв. только, если все неутвержденные)
#end
Function DelSU(cPunish: comp; wFlag: word; cContDoc: comp): word;

#doc
 апдейт либо открытие нового сообщения в РК.
 получаем в качестве пар-ов флаги, что и как менять
 Пока работать не будет. Т.к. в ЗП нету истории постоянных удержаний
#end
Procedure UpdSURK(cPunish: comp; cPers: comp; cApp: comp;
                  MsgCode: integer;
                  bDataOkMod: boolean;
                  bSummaMod: boolean; bDataNMod: boolean;
                  bVidOplMod: boolean; bCurrMod: boolean);

end;

vipinterface SetUderRK implements ISetUderRK
  Licensed (free)
;

#end
