//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - Управление персоналом
// Протокол с визуализацией
//------------------------------------------------------------------------------

#component "Z_StaffOrders"

#include AtlProtocol.vih

private ObjInterface IOrdersProtocol;
#doc
  Автоматическое добавление сообщение в протокол с поиском родительской записи.
  Фукнция работает рекурсивно, если найдена родительская запись и  она корректна,
  то она тоже будет добавлена в протокол, т.е. если вызвать функцию для самого низкого
  уровня (4-го) все остальные уровни будут сгенерированы автоматически. </br>
  Параметры: </br>
    cnRec - код записи о которой будет сообщение </br>
    cParentRec - родительская запись </br>
    wTypeMsg - тип сообщения: </br>
      APE_NONE         = 0;  // не определено </br>
      APE_BREAK        = 1;  // пользователь прервал процесс </br>
      APE_ERROR        = 2;  // ошибка </br>
      APE_WARNING      = 3;  // предупреждение </br>
      APE_CAUTION      = 4;  // предостережение </br>
      APE_REMARK       = 5;  // замечание </br>
      APE_NOTIFICATION = 6;  // оповещение </br>
      APE_MESSAGE      = 7;  // сообщение </br>
      APE_INFO         = 8;  // информация </br>
    wIL - уровень записи-отправителя сообщения: </br>
      4 - самый низкий уровень (таблица Persons) </br>
      3 - уровень таблицы ContDoc </br>
      2 - уровень таблицы PartDoc </br>
      1 - уровень таблицы TitleDoc </br>
      0 - наивысший уровень иерархии сообщений </br>
    sMsg - текст сообщения </br>
#end
  function SmartLogMessage(cnRec, cParentRec: comp; wTypeMsg, wIL: word; sMsg: string): longint;
#doc
  Процедура проверяет есть ли во временной таблице с сообщениями записи,
  если записей нет протокол очищается от возможного мусора и закрывает окно.
#end
  procedure CheckAndClose;
  end;

ObjInterface IOrdersProtocol2;
  #doc
  Процедура сохраняет Cont.nRec в котором есть ошибка.
  #end
  procedure FillcCurContToIns(cCurContDocRec: comp);
  #doc
  Функция заполняет протокол для записи таблицы ContDoc сохраненной процедурой FillcCurContToIns.
  Возвращает true если протокол заполен успешно. </br>
  Параметры: </br>
    wTypeMsg - тип сообщения: </br>
      APE_NONE         = 0;  // не определено </br>
      APE_BREAK        = 1;  // пользователь прервал процесс </br>
      APE_ERROR        = 2;  // ошибка </br>
      APE_WARNING      = 3;  // предупреждение </br>
      APE_CAUTION      = 4;  // предостережение </br>
      APE_REMARK       = 5;  // замечание </br>
      APE_NOTIFICATION = 6;  // оповещение </br>
      APE_MESSAGE      = 7;  // сообщение </br>
      APE_INFO         = 8;  // информация </br>
    sMsg - текст сообщения </br>
  #end
  function AddExplanationToExError(wTypeMsg: word; sMsg: string):boolean;
  #doc
  Очищает переменную в которую процедура FillcCurContToIns сохраняет StrCont.nRec.
  #end
  procedure ClearcCurContToIns;
end;

vipinterface OrdersProtocol(AtlProtocol)
implements
IOrdersProtocol, IOrdersProtocol2
Licensed (free);
