//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - Управление персоналом
// Протокол с визуализацией
//------------------------------------------------------------------------------

#component "Z_StaffSHR"

#include AtlProtocol.vih

private ObjInterface ISHR_OrdersProtocol;
  #doc
    Запись сообщения в AtlProtocol возвращает код сообщения, работает рекурсивно
  #end
  function SmartLogMessage(cnRec, cParentRec: comp; wTypeMsg, wIL: word; sMsg: string): longint;
  #doc
    Добавление сообщения на уровень ниже наименования подразделения
  #end
  function AddPodrMessage(cnRec, cParentRec: comp; wTypeMsg: word; sMsg: string): longint;
  #doc
    Добавление сообщения на уровень наименования подразделения (StrCont)
  #end
  function AddStrContMessage(cnRec, cParentRec: comp; wTypeMsg: word; sMsg: string): longint;
  #doc
    Добавление сообщения на уровень РПДШР (StrPart)
  #end
  function AddStrPartMessage(cnRec, cParentRec: comp; wTypeMsg: word; sMsg: string): longint;
  #doc
    Добавление сообщения на уровень приказа (StrTitle)
  #end
  function AddStrTitleMessage(cnRec, cParentRec: comp; wTypeMsg: word; sMsg: string): longint;

end;

ObjInterface ISHR_OrdersProtocol2;
  #doc
  Процедура сохраняет StrCont.nRec в котором есть ошибка.
  #end
  procedure FillcStrContToIns(cStrContTI: comp);
  #doc
  Функция заполняет протокол для записи таблицы StrCont сохраненной процедурой FillcStrContToIns.
  Возвращает true если протокол заполен успешно. </br>
  Параметры: </br>
    wTypeMsg - тип сообщения: </br>
      APE_NONE         = 0;  // не определено </br>
      APE_BREAK        = 1;  // пользователь прервал процесс </br>
      APE_ERROR        = 2;  // ошибка </br>
      APE_WARNING      = 3;  // предупреждение </br>
      APE_CAUTION      = 4;  // предостережение </br>
      APE_REMARK       = 5;  // замечание </br>
      APE_NOTIFICATION = 6;  // оповещение </br>
      APE_MESSAGE      = 7;  // сообщение </br>
      APE_INFO         = 8;  // информация </br>
    sMsg - текст сообщения </br>
  #end
  function AddExplanationToExError(wTypeMsg: word; sMsg: string):boolean;
  #doc
  Очищает переменную в которую процедура FillcStrContToIns сохраняет StrCont.nRec.
  #end
  procedure ClearcStrContToIns;

end;

vipinterface SHR_OrdersProtocol(AtlProtocol)
implements ISHR_OrdersProtocol, ISHR_OrdersProtocol2
Licensed (free);
