//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - Управление персоналом
// Нумерация приказов по штатному расписанию
//------------------------------------------------------------------------------

#ifndef _SHRUniqueNumberOfOrders_INCLUDED_
#define _SHRUniqueNumberOfOrders_INCLUDED_

#ifdef ComponentVersion
#component "Z_StaffSHR"
#end

#doc
Объектный интерфейс обработки номеров приказов по штатному расписанию
#end
objinterface ISHRUniqueNumberOfOrders;
deprecated 'Методы интерфейса ISHRUniqueNumberOfOrders устарели, т.к. не принимают в качестве параметра год. Используйте ISHRUniqueNumberOfOrdersByYear.';

#doc
Функция проверки уникальности номера приказа по штатному расписанию.<brief />
<p>Возвращает <code>true</code>, если номер не был использован в приказах по штатному расписанию
или выключена настройка контроля уникальности <code>UP.STAFF.PRIKAZ_STR.UNIQUE_NMB</code>.</p>
<p>Метод устарел, т.к. не принимает в качестве параметра год, а использует текущий год или год из настроек.
Применяйте вместо него метод <link function Z_StaffSHR::ISHRUniqueNumberOfOrdersByYear.UniqDocByYear>UniqDocByYear</link>.</p>
#end
function UniqDoc(MyNmb: string): boolean;

#doc
Функция нахожения следующего номера для приказа по штатному расписанию.<brief />
<p>Находит последний использованный номер приказа, добавляет к нему единицу и возвращает получившуюся строку.</p>
<p>Параметр <code>wOper</code> не используется.</p>
<p>Метод устарел, т.к. не принимает в качестве параметра год, а использует текущий год или год из настроек.
Применяйте вместо него метод <link function Z_StaffSHR::ISHRUniqueNumberOfOrdersByYear.GetNextNmbByYear>GetNextNmbByYear</link>.</p>
#end
function GetNmbPr(wOper: word): string[20];

end;

#doc
Объектный интерфейс обработки номеров приказов по штатному расписанию за конкретный год
#end
objinterface ISHRUniqueNumberOfOrdersByYear;

#doc
Функция проверки уникальности номера приказа по штатному расписанию.<brief />
<p>Возвращает <code>true</code>, если номер <code>_sNmb</code> не был использован
в приказах по штатному расписанию за год <code>_wYear</code>
или выключена настройка контроля уникальности <code>UP.STAFF.PRIKAZ_STR.UNIQUE_NMB</code>.</p>
<p>При проверке игнорирует приказ <code>_cSelf</code> (идентификатор записи <code>StrTitle</code>).</p>
#end
function UniqDocByYear(_sNmb: string; _wYear: word; _cSelf: comp = 0): boolean;

#doc
Функция нахожения следующего номера для приказа по штатному расписанию.<brief />
<p>Находит последний использованный номер приказа в году <code>_wYear</code>,
добавляет к нему единицу и возвращает получившуюся строку.</p>
#end
function GetNextNmbByYear(_wYear: word): string;

end;

vipinterface SHRUniqueNumberOfOrders
  implements ISHRUniqueNumberOfOrders, ISHRUniqueNumberOfOrdersByYear
  Licensed (free);

#end
