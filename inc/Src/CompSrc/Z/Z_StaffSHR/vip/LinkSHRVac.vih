//******************************************************************************
//                                                      (с) корпорация Галактика
// Галактика 9.1 - Управление персоналом
// Привязка отпусков штатного расписания
//******************************************************************************

#ifndef _LinkSHRVac_INCLUDED_
#define _LinkSHRVac_INCLUDED_

#ifdef ComponentVersion
#component "Z_StaffSHR"
#end
//******************************************************************************
#doc
  Объектный интерфейс "Привязка отпусков штатного расписания"
#end
private objinterface ILinkSHRVac;

  #doc
    Процедура запуска окна
  #end
  procedure pRunWindow;

  #doc
    Процедура смены ссылки отпусков на новую ставку
  #end
  procedure pVacationLink(cSSOld, cSSNew: comp);

  #doc
    Процедура удаления отпусков для ставки
  #end
  procedure pVacationDelete(cSS: comp);

  #doc
    Функция подсчета кол-ва дней отпуска по ШР на дату
  #end
  function GetVacKolDn(_cStruct: comp; _dCalc: date): integer;

end;

#doc
  Расширение интерфейса "Привязка отпусков штатного расписания"
#end
private objinterface ILinkSHRVac1;

  #doc
    Процедура добавления для ставки отпуска из настройки
    "Управление персоналом \ Общие настройки \ Больничные, отпуска, расчеты по среднему \ Отпуска \
    Формирование \ Ежегодный трудовой отпуск".
    Если такой отпуск уже есть - добавления не происходит
  #end
  procedure pAddDefOtpusk(_cStruct: comp);

end;

#doc
  Расширение интерфейса "Привязка отпусков штатного расписания"
#end
objinterface ILinkSHRVac2;
  #doc
    Процедура позиционирования на нужную ставку
  #end
  procedure pSetValidOtp(cStaffSTR: comp);

  #doc
    Блокировка всех полей
  #end
  procedure SetProtect;
end;

vipinterface LinkSHRVac
implements ILinkSHRVac, ILinkSHRVac1, ILinkSHRVac2
Licensed(Free);

#end
