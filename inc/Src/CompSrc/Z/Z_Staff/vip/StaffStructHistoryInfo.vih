//******************************************************************************
//                                                      (с) корпорация Галактика
//  Галактика 8.1 - Заработная плата
//  Объектный интерфейс выбора данных по наполнению работниками штатного расписания
//******************************************************************************
#ifndef _StaffStructHistoryInfo_INCLUDED_
#define _StaffStructHistoryInfo_INCLUDED_

#ifdef ComponentVersion
#component "z_Staff"
#end

#doc
  Объектный интерфейс выбора данных по наполнению работниками штатного расписания.</brief>
  Т.е. главная цель - получение на дату кол-ва ставок и вакансий. Все данные
  будут подтягиваться из таблиц StaffStruct, HistoryStr. Никаких перерасчетов по
  таблице "назначений" здесь делать не будем. (пока не будем). Если дата между записями
  истории, то значение будет подтягиваться из левой записи истории, если UseDate больше,
  нежели дата последней записи истории, то возьмется текущее значение в ШР. Понятно, что
  в промежуток времени между этими датами может произойти что-нибудь типа приема или увольнения.
  Однако мы не создаем записи в истории СЕ ШР на каждый прием или увольнение.
#end
objinterface IStaffStructHistoryInfo;

#doc
Получение количества занятых ставок на некую дату.
#end
function GetWorkersStaff(NrecStaff : comp; UseDate : date) : double;

#doc
Получение количества вакансий
#end
function GetWorkStations(NrecStaff : comp; UseDate : date) : double;

#doc
Получение общего количества ставок для данной СЕ ШР.
#end
function GetWholeStations(NrecStaff : comp; UseDate : date) : double;

end;

vipinterface StaffStructHistoryInfo implements IStaffStructHistoryInfo
  Licensed (free);

#end
