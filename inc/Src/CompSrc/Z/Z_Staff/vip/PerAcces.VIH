//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика ERP 5.8 - Управление персоналом
// Права доступа пользователя к указанному окну Картотеки
//------------------------------------------------------------------------------

#ifndef _PerAcces_INCLUDED_
#define _PerAcces_INCLUDED_

#component "Z_Staff"

#doc
Права доступа пользователя к указанному окну Картотеки
#end
ObjInterface IPerAcces;
deprecated 'Методы IPerAcces принимают имя пользователя и при включенной NT-авторизации могут быть неработоспособными. Используйте методы, описанные в IPerAccesByUserId.';

  #doc
  Права доступа пользователя к указанному окну Картотеки относительно точки входа
  #end
  function GetUserAccess(User_Name : string; SysCode : word): word;

End;

#doc
Права доступа пользователя к Картотеке с учетом типа пользователя (администратору доступ разрешен)
и настройки разграничения доступа (если разграничение выключено, то доступ разрешен)
#end
ObjInterface IPerAcces2;

  #doc
  Права доступа текущего пользователя к окну картотеки <code>_wType</code> на <b>просмотр</b>.
  Если доступ на просмотр есть, функция возвращает <code>true</code>, иначе <code>false</code>.
  #end
  function GetAccessRecwinRead(_wType: word): boolean;

  #doc
  Права доступа текущего пользователя к окну картотеки <code>_wType</code> на <b>редактирование</b>.
  Если доступ на редактирование есть, функция возвращает <code>true</code>, иначе <code>false</code>.
  #end
  function GetAccessRecwinWrite(_wType: word): boolean;

  #doc
  Права доступа текущего пользователя к заявлению в ФСС. В том случае, если у пользователя нет доступа к 1 разделу
  картотеки или банковским реквизитам, функция возвращает <code>false</code>, иначе <code>true</code>.
  #end
  function GetAccessStatementFSS: boolean;

End;

#doc
Расширение интерфейса проверки прав доступа
#end
objInterface IPerAcces3;

   #doc
   Проверка прав на чтение
   #end
   function ReadAccess(wNum: word): boolean;

   #doc
   Проверка прав на запись
   #end
   function WriteAccess(wNum: word): boolean;

   #doc
   Проверка прав на приказы
   #end
   function OrderAccess(wNum: word): boolean;

   #doc
   Проверка прав на все (есть ли вообще какие-либо права)
   #end
   function AllAccess(wNum: word): boolean;

   #doc
   Проверка прав на печать (проверка прав на чтение во всех окнах)
   #end
   function PrintAccess: boolean;

end;

#doc
Права доступа к указанному окну картотеки по идентификатору пользователя
#end
objinterface IPerAccesByUserId;

  #doc
  Функция проверки прав доступа пользователя к окну картотеки.</ brief>
  <p>Возвращает битовую маску, порядок установки битов в которой зависит от номера окна картотеки.</p>
  <p>Для получения прав доступа на чтение/запись удобнее использовать методы, описанные в <link objInterface Z_STAFF::IPerAcces2>IPerAcces2</link>.</p>
  <h3>Параметры</h3>
  <ul>
    <li><code>_wType</code> - номер окна картотеки / код сущности для разграничения прав доступа в картотеке</li>
    <li><code>_cUser</code> - идентификатор пользователя (<code>UserId</code>), необязательный параметр
        (если не передан, проверяются права текущего пользователя).</li>
  </ul>
  #end
  function GetAccessMask(_wType: word; _cUser: comp = 0): word;

end;

VipInterface SetPersonsAccess
  implements IPerAcces, IPerAcces2, IPerAccesByUserId, IPerAcces3
  Licensed (free);

VipInterface SetPersonsAccess_Old
  implements IPerAcces
  Licensed (free);
  deprecated "Интерфейс устарел. Используйте SetPersonsAccess.";

#end
