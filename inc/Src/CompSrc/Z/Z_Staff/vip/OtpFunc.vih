//******************************************************************************
//                                                      (с) корпорация Галактика
// Галактика 8.10 - Управление персоналом
// Функции для работы с отпусками
//******************************************************************************

#ifndef _OtpFunc_vih_INCLUDED_
#define _OtpFunc_vih_INCLUDED_

#ifdef ComponentVersion
  #component "Z_STAFF"
#end

Table Struct LongOtp (
                         NRecStaff  : comp,
                         NRecPsn    : comp,
                         NRecApp    : comp,
                         BegDate    : date,
                         EndDate    : date,
                         Rate       : double,
                         Note       : string[40]
                         )
            with index   (
                         NRecStaffIndex   = NRecStaff,
                         NRecPsnIndex     = NRecPsn,
                         NRecAppIndex     = NRecApp
                         );

#doc
Функции для работы с отпусками совместителей
#end
objinterface OtpSovmFuncs;

#doc
Создание отпуска совместителю, который будет аналогичен по основному назначению
Параметры:
  cFact    - Nrec FactOtpus-ка по основному назначению.
  cLsch    - Nrec LSCHET-а
  cPsnNrec - Nrec сотрудника
  bPrikaz  - если "да" - вызывается из перечня приказов, "нет" - из картотеки
  lMarkOtp - список помеченых отпусков для переноса, если "0", значит переносим все отпуска
#end
function CreateSovmOtpusk(cFact: comp; cLsch: comp; cPsnNrec: comp; bPrikaz: boolean; lMarkOtp: TPtr): boolean;

end;

#doc
Функции для работы с отпусками совместителей (расширение)
#end
objinterface OtpSovmFuncs1;

#doc
Создание таблицы отпусков по беременности и родам сотрудников на указанную дату
#end
public procedure CreateTabLongOtp(StsNRec : comp; curDate : date);

#doc
Функция возвращает TRUE, если на ставке есть сотрудники в отпуске по беременности и родам
#end
public function isPsnLongOtpInSts(StsNRec : comp; curDate : date): boolean;

#doc
Функция возвращает TRUE, если в подразделении есть сотрудники в отпуске по беременности и родам
#end
public function isPsnLongOtpInDept(DeptNRec : comp; curDate : date): boolean;

end;

objinterface OtpFuncs1;
#doc

#end
public procedure ReturnFromLongOtp(AppNRec : comp; VacNrec: comp);
deprecated 'Метод устарел. Возврат сотрудника из долгосрочного отпуска на ставку происходит автоматически.';

end;

objinterface OtpFuncs2;
#doc

#end
public function GetTypePackOtp(FactOtpNrec: comp) : integer;

end;

objinterface OtpFuncs03;
#doc
Создание Vacations для целодневной неявки по информации из FactOtpusk
#end
public function CreateVacForFDA(FactOtpNrec: comp) : boolean;

end;

vipinterface OtpFunc implements OtpSovmFuncs, OtpSovmFuncs1, OtpFuncs1, OtpFuncs2,
                                  OtpFuncs03
Licensed (free)
;

#end
