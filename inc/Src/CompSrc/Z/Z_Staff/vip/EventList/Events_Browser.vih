//------------------------------------------------------------------------------
//                                           (c) корпорация ГАЛАКТИКА
// Версия     : 7.12
// Назначение : декларация интерфейса, реализующего просмотр доступных событий
//------------------------------------------------------------------------------

#ifndef _IEvents_Browser_VIH_INCLUDED_
#define _IEvents_Browser_VIH_INCLUDED_

#include EventsObj.obj

#ifdef ComponentVersion
  #component "z_staff"
#end

#doc
Объектный интерфейс реализующий просмотр доступных событий
#end
objinterface IEvents_Browser;

#doc
процедура обновляет данные по юзеру. Value -- NRec пользователя
#end
procedure RefreshList(Value: comp);

#doc
процедура установки значения параметра. Value -- префикс интерфейсов, cNum -- NRec юзера
#end
procedure SetParameter(Value: string; cNum: comp);

#doc
позиционирование на первую запись таблицы Plugin
#end
function FirstPlugin: integer;

#doc
переход на следующую запись таблицы Plugin
#end
function NextPlugin: integer;

#doc
получить состояние объектного интерфейса (выделен или нет)
#end
function GetStatePlugin: boolean;

#doc
функция запускает на выполнение метод ExecuteEvent объектного интерфейса
#end
function ExecuteObjMethod(cNumber: comp; _Days: Word): boolean;

#doc
функция возвращает результат работы метода ExecuteEvent объектного интерфейса
#end
function GetResultObj: string;

#doc
функция возвращает результирующую дату объектного интерфейса
#end
function GetResultDate: Date;

end;

#doc
Расширение объекта для календаря и блокнота событий </brief>
#end
private objinterface IEvents_Browser_Ex(IEvents_Browser);

#doc
Метод возвращает время начала проверки события блокнотом. </brief>
#end
public function fGetPluginTime: time;

#doc
Метод запуска обработки текущего плагина событий системы. </brief>
Определяется наступило ли у работника событие описанное плагином, на указанную дату. </br>

<h3> Параметры: </h3>
<ul>
  <li><code> cNumber   </code> - ссылка на карточку работника Persons.nRec </li>
  <li><code> dCalcDate </code> - дата проверки наступления события </li>
  <li><code> wParam    </code> - = 1 - только вывод сообщения о событии, без пост-действий (если у плагина оно есть) </li>
</ul>

<h3> Результат: </h3>
<ul>
  <li><code> true  </code> - событие наступило  </li>
  <li><code> false </code> - нет такого события </li>
</ul>
#end
public function ExecuteObjMethodOnDateWParam(cNumber: comp; dCalcDate: date; wParam: word): boolean;

#doc
Метод поиска текущего плагина событий системы в месяце, включающем указанную дату. </brief>

<h3> Параметры: </h3>
<ul>
  <li><code> cNumber   </code> - ссылка на карточку работника Persons.nRec </li>
  <li><code> dCalcDate </code> - дата, входящая в месяц проверки </li>
  <li><code> wParam    </code> - = 1 - только вывод сообщения о событии, без пост-действий (если у плагина оно есть) </li>
</ul>

<h3> Результат: </h3>
<ul>
  <li><code> true  </code> - событие наступило  </li>
  <li><code> false </code> - нет такого события </li>
</ul>
#end
public function ExecuteObjMethod4Month(cNumber: comp; dCalcDate: date; wParam: word): boolean;

end;

#doc
Расширение объекта для календаря и блокнота событий для разделения событий по типам </brief>
#end
private objinterface IEvents_Browser_Ex01(IEvents_Browser_Ex);

#doc
получить тип объектного интерфейса (ожидает передачи Persons.NRec, StauffStruct.NRec, ....)
#end
function GetPluginTypeEvent : word;

#doc
определить наличие в интерфейсе активного события определенного типа (  EvntNeedPerson, EvntNeedStaffStr, ....)
#end
function IsExistsAndActivePlugin(_TypeEvent : word): boolean;

#doc
функция возвращает заголовок метода ExecuteEvent объектного интерфейса
#end
function GetHeaderObj : string;

end;

vipinterface Events_Browser implements IEvents_Browser_Ex, IEvents_Browser_Ex01
  Licensed(Free)
;

#end
