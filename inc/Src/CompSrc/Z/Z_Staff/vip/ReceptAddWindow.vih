//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 8.10 - Управление персоналом
// Реализация закладок картотеки сотрудников (до пяти)
//------------------------------------------------------------------------------

#ifndef _ReceptAddWindow_INCLUDED_
#define _ReceptAddWindow_INCLUDED_

#component "Z_Staff"

#doc
Объектный интерфейс реализации закладок картотеки сотрудников (до пяти).
ради множественной информативности для клиента
#end
ObjInterface IReceptAddWindow;

  #doc
  Вспомогательная процедура ради возможных дальнейших доработок
  #end
  procedure SetData(
                    #doc
                    (до 10 - изменения по tmpCatalogs; после - по tmpPersons)<br>
                    0 - произошла смена позиции в подразделениях. Однозначно переформировываем выборку
                        по полю .Department<br>
                    1 - нажали кнопку "показать вложенных". Для данной записи Catalogs нужно вытянуть
                        еще и сотрудников из вложенных подразделений<br>
                    10 - произошло перепозиционирование в таблице tmpPersons
                    #end
                    ModView: word
                  ; cValue: comp // #docl tmpPersons.Nrec
                  ; cValueDop: comp // #docl tmpCatalogs.nRec (необязательный параметр для собственных доработок)
                   );

  #doc
  Функция получения наименования закладки
  #end
  function GetBookMarkName: string[30];

  #doc
  Функция получения информации о том, а можно ли подключать закладку в данном случае
  #end
  function GetAbilityForShow(
                             #doc
                             место, где будут грузиться закладки<br>
                             0 - списочный вид картотеки<br>
                             1 - по подразделениям
                             #end
                             wPlace: word
                            ): boolean;

  #doc
  Безусловная (жесткая) перерисовка всех панелей (ReReadRecord)
  #end
  procedure MustReDraw;

  #doc
  Процедура прорисовки. В зависимости от параметра будем использовать тот или другой методы.
  #end
  procedure ReScan(wTypeScan: word);

  #doc
  Процедура, сообщающая интерфейсу-владельцу об изменении данных
  Sender -
  wTypeChange - что именно с ней произошло
  wEvent - событие. Предполагаю решение, что все пункты меню
  буду запускать из главного, а из встроенных только сообщать об этом
  sNameInt - имя интерфейса, который генерит событие
  #end
  event procedure OnEventWork(Sender: comp // #docl NRec изменяемой записи
                            ; wTypeChange: word // #docl что именно с ней произошло
                            ; wEvent: word // #docl событие. Предполагаю решение, что все пункты меню буду запускать из главного, а из встроенных только сообщать об этом
                            ; sNameInt: string[30] // #docl имя интерфейса, который генерит событие
                             );

  #doc
  Произошло перепозиционирование в закладке, работающей с той же таблицей tmpPersons
  #end
  event procedure OnPositionChangePsn(Sender: comp);

end;

#doc
Реализация-заглушка. Для подавления ошибки ОТК "Не найдена реализация объектного интерфейса Z_STAFF::IRECEPTADDWINDOW"
#end
VipInterface DummyRAW
  implements IReceptAddWindow
  licensed(free);

#end
