//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.8 - Общая функциональность контура "Управление персоналом"
// Функции работы со строками
//------------------------------------------------------------------------------

#ifndef _StrFunc_vih_Included
#define _StrFunc_vih_Included

#component "Z_Staff"

#doc
Функции работы со строками
#end
ObjInterface ObjStrFunc;

  #doc
  Склонение количества лет, месяцев, дней
  #end
  function DeclYMD(countYMD : longint; typeYMD: longint) : string;

  #doc
  Извлечение фамилии из заданной строки ФИО
  #end
  function GetFirstName(FIO : string) : string;
    deprecated 'Вместо GetFirstName следует использовать ObjStrFunc3::Get_LastName';

  #doc
  Извлечение имени из заданной строки ФИО
  #end
  function GetLastName(FIO : string) : string;
    deprecated 'Вместо GetLastName следует использовать ObjStrFunc3::Get_FirstName';

  #doc
  Извлечение отчества из заданной строки ФИО
  #end
  function GetPatronymic(FIO : string) : string;

  #doc
  ФИО в формате, заданном настройкой "Вывод инициалов лица, подписывающего приказы"
  #end
  function GetFIO(FIO : string) : string;

  #doc
  Преобразование целого числа в строку с заменой значения "0" пустой строкой
  #end
  function UnVisibleInt(iTemp : integer) : string;

  #doc
  Преобразование длинного целого числа в строку с заменой значения "0" пустой строкой
  #end
  function UnVisibleLong(iTemp : longInt) : string;

  #doc
  Преобразование числа с плавающей точкой в строку с заменой некорректного значения пустой строкой
  #end
  function UnVisibleDouble(doubleTemp : double) : string;

  #doc
  Преобразование даты в строку заданного формата с заменой нулевого или некорректного значения пустой строкой
  #end
  function UnVisibleDate(dateTemp : date; formatStr : string) : string;

  #doc
  Количество дней между датами без учета полных месяцев
  #end
  function GetCountDay(DateBeg : Date; DateEnd : Date) : longint;

  #doc
  Количество полных месяцев между датами
  #end
  function GetCountMonths(DateBeg : Date; DateEnd : Date) : longint;

  #doc
  Количество полных лет между датами
  #end
  function GetCountYears(DateBeg : Date; DateEnd : Date) : longint;

  #doc
  Строка периода месяц, квартал, полугодие, год, период
  #end
  function CreatePeriod(dateBeg : date; dateEnd : date) : string;

  #doc
  Проверка на пересечение периодов
  #end
  function isCrossPeriod(dateBeg1 : date; dateEnd1 : date; dateBeg2 : date; dateEnd2 : date) : boolean;

  #doc
  Проверка попадания заданной даты в указанный период
  #end
  function isHitPeriod(dateBeg : date; dateEnd : date; dateTest : date) : boolean;

//------------------------------------------------------------------------------
end;

#doc
Расширение №1 интерфейса ObjStrFunc
#end
ObjInterface ObjStrFunc1;

  #doc
  ФИО из настройки "Право подписи приказов по персоналу" или из настройки "Руководитель"
  #end
  function GetFIODir : string;

end;

//------------------------------------------------------------------------------
#doc
Расширение №2 интерфейса ObjStrFunc
#end
ObjInterface ObjStrFunc2;

  #doc
  Выделяет рубли из суммы
  #end
  function GetRub(Sum : double; okrug1 : double) : string;

  #doc
  Выделяет копейки из суммы и округляет с указанной точностью
  #end
  function GetKop(Sum : double; okrug1 : double) : string;

  #doc
  Округляет сумму с указанной точностью и преобразует в строку
  #end
  function GetSumRate(Sum : double; okrug1 : double) : string;

end;

//------------------------------------------------------------------------------
#doc
Расширение №3 интерфейса ObjStrFunc
#end
ObjInterface ObjStrFunc3;

  #doc
  Из указанной строки выделяется первое слово, в том числе и с дефисами
  #end
  function DivStr(var FIO: string): string;

  #doc
  Извлечение фамилии из заданной строки ФИО
  #end
  function Get_LastName(FIO: string): string;

  #doc
  Извлечение имени из заданной строки ФИО
  #end
  function Get_FirstName(FIO: string): string;

  #doc
  ФИО в формате "Фамилия И.О."
  #end
  function GetFioIn(var FIO: string): boolean;

  #doc
  ФИО в формате, заданном настройкой "Настройки Галактики \ Управление персоналом \ Расчеты с персоналом \ Отчеты \ Вывод ФИО"
  #end
  function GetFIO_ZAR(sFIO : string) : string;

end;

#doc
Расширение №4 интерфейса ObjStrFunc
#end
ObjInterface ObjStrFunc4;

  #doc
  Преобразование года и месяца в строку
  #end
  Public function GetStrYearMonth(wYear, wMonth : word) : string;

end;

//------------------------------------------------------------------------------

VipInterface StringFunctions
  implements ObjStrFunc, ObjStrFunc1, ObjStrFunc2, ObjStrFunc3, ObjStrFunc4
  Licensed (free);

#endif