//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - Управление персоналом
// Сквозной протокол конвертеров
// появляется при добавлении любой информации в любом из конвертеров, не "завешивает" конвертацию
// запрещено использование кроме как для конвертеров
// -------------------------------------------------
// объявление верное: var объектная_переменная: oConvertProtocol;
// обязательна загрузка при помощи GetVipRef, конструктор Init - не применять
//
// объявление НЕ верное: var объектная_переменная: oConvertProtocol new; // новый экземпляр
// Для построения иерархии конвертеров д.б. запущена визуализация AtlProtocol:
// объектная_переменная.LogStartVisual...
//------------------------------------------------------------------------------

#ifndef ConvertProtocol
#define ConvertProtocol

#ifdef ComponentVersion
#component "Z_StaffNastr"
#end

#doc
Сквозной протокол конвертеров </brief>
появляется при добавлении любой информации в любом из конвертеров, не "завешивает" конвертацию  </br>
<b>запрещено использование кроме как для конвертеров</b>                                        </br> </br>

<b>объявление верное:   </b> var объектная_переменная: oConvertProtocol;                        </br>
<b>объявление НЕ верное:</b> var объектная_переменная: oConvertProtocol new; // новый экземпляр </br> </br>

<b>обязательна загрузка при помощи GetVipRef, конструктор Init - не применять                   </br> </br>

 Для построения иерархии конвертеров д.б. запущена визуализация AtlProtocol:                    </br>
 объектная_переменная.LogStartVisual...                                                         </br>
#end

#include AtlProtocol.vih

private objinterface oConvertProtocol(IAtlProtocol);

#doc
Метод добавления записи в иерархию сообщений AtlProtocol.                                                    </brief>
Если сообщение добавлено и протокол был закрыт, то протокол откроется.                                       </brief>
Параллельно сообщение добавляется в протокол сообщений кадров, где доступно для просмотра всем пользователям </brief>

<h3> Параметры: </h3>
<ul>
  <li><code> wTypeMsg   </code> - тип сообщения (ошибка(APE_ERROR), информация(APE_INFO) и т.д.)  </li>
  <li><code> sMsg       </code> - текст сообщения                                                 </li>
  <li><code> sRootName  </code> - текст краткого содержания в протоколе сообщений кадров          </li>
</ul>

#end
procedure prSetLogLine(wTypeMsg: word; sMsg, sRootName: string);

end;

private vipinterface iConvertProtocol(AtlProtocol) implements oConvertProtocol
Licensed (free);

#endif
