//------------------------------------------------------------------------------
//                                                      (с) корпорация Галактика
// Галактика 7.12 - Заработная плата
// Описание obj-интерфейса расчета среднесписочной численности
//------------------------------------------------------------------------------

#ifndef _IAPNCALCULATOR_OBJ_INCLUDED_
#define _IAPNCALCULATOR_OBJ_INCLUDED_

#component "Z_WT"

#doc
  Объектный интерфейс калькулятора среднесписочной численности
#end
objinterface IAveragePayrollNumberCalculator;
  #doc
    Возвращает среднюю продолжительность рабочего дня OnDay.
  #end
  function GetWorkingDayAverageTime(OnDay: byte): double;

  #doc
    Возвращает среднесписочную для лицевого счета с nrec = PersonalAccountRef
    за период с PeriodBeginning по PeriodEnding.
  #end
  function GetNumber(PersonalAccountRef: comp; PeriodBeginning, PeriodEnding: date): double;
end;

#doc
  Расширение № 1 объектного интерфейса IAveragePayrollNumberCalculator
#end
objinterface IAveragePayrollNumberCalculator1;
  #doc
    Инициализация печати протокола расчета среднесписочной численности
  #end
  property SetProtocol : boolean write;

  #doc
    <brief>Вычисление средней продолжительности рабочего дня.</brief>
    Функция для внутренних нужд, извне не получится получить ничего полезного,
    поэтому извне не вызывайте пожалуйста.
  #end
  function GetAvgHoursPerDay : double;

  #doc
    Расчет среднесписочной численности за несколько месяцев
  #end
  function CalcSRCHbyAccount( Account: comp; dBegin, dEnd : date ) : double;

  #doc
    Расчет среднесписочной численности по периодам табеля
  #end
  function fGetSRCHTable( cLsch : comp; bMonth : byte; wYear : word ) : double;

  #doc
    <brief>Расчет дней/часов по неявкам.</brief>
    Функция для внутренних нужд, сюда случайно попало. Лучше не вызывать наверное,
    т.к. может неадекватить.
  #end
  procedure ProcessMonthlyAbsence(AbsenceIndex: integer; ByHours: boolean;
                                var AbsenceDays: word; var AbsenceHours: double);
    deprecated 'Метод используется для внутренних нужд!';
end;

#doc
  Расширение № 2 объектного интерфейса IAveragePayrollNumberCalculator
#end
objInterface IAveragePayrollNumberCalculator2;
  #doc
    <brief>Учитывать кол-во занимаемых ставок из кадров</brief>
    По умолчанию false. Сервисная функция расчета коэффициента делает расчет с параметром true,
    то есть учитывает кол-во ставок из кадров. Не исключено, что данный параметр
    излишний, и в скором времени станет всегда равным true.
  #end
  property WithAppointmentRate: boolean;
end;

#end
