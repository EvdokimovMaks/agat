/*
                      (c) 1994,2000 корпорация ГАЛАКТИКА
  Проект        : ГАЛАКТИКА
  Система       : Бухгалтерский контур
  Назначение    : obj-интерфейс "Маска ручной корректировки табеля учета
                  рабочего времени"
  Ответственный : Корзюк Виталий Францевич
  Параметры     : нет
*/

#ifndef _WTHCM_INCLUDED_
#define _WTHCM_INCLUDED_

#include WTCONTAINER.VIH
#include IProtectable.obj

#ifdef ComponentVersion
#component "Z_WT"
#end

#doc
  Объектный интерфейс редактора маски ручной корректировки табеля учета
  рабочего времени. Используется окном редактирования табеля.
#end
objinterface IWTHandCorrectionMask;
  #doc
    Загружает данные маски ручной корректировки табеля с nrec = RecordNumber.
  #end
  function  LinkTo(RecordNumber: comp): boolean;

  #doc
    Возвращает nrec табеля, маска ручной корректировки которого загружена в
    данный момент.
  #end
  function  GetLink: comp;

  #doc
    Возвращает дату проверки маски ручной корректировки.
  #end
  function  GetCheckDate: date;

  #doc
    Устанавливает дату проверки маски ручной корректировки.
  #end
  procedure SetCheckDate(Value: date);

  #doc
    Установить в маске Value часов вида HourKind на день AtDay.
  #end
  procedure SetHours(AtDay: byte; HourKind: byte; Value: double);

  #doc
    Возвращает количество часов вида HourKind, приходящихся на день AtDay.
  #end
  function  GetHours(AtDay: byte; HourKind: byte): double;

  #doc
    Устанавливает (Enabled = true) или сбрасывает (Enabled = false) управляющие
    флаги Flags (см. константы coXXXX в money.ccm) в дне AtDay.
  #end
  procedure SetMask(AtDay: byte; Flags: word; Enabled: boolean);

  #doc
    Возвращает true, если в дне AtDay установлены управляющие флаги Flags (см.
    константы coXXXX в money.ccm); иначе возвращает false.
  #end
  function  GetMask(AtDay: byte; Flags: word): boolean;

  #doc
    Перемещает курсор к данным дня AtDay.
  #end
  procedure GoTo(AtDay: byte);

  #doc
    Устанавливает улучшенный (Enhanced = true) или обычный (Enhanced = false)
    формат отображения количества времени.
  #end
  procedure SetTimeFormat(Enhanced: boolean);

  #doc
    Событие генерируется после обновления содержимого маски ручной
    корректировки в БД.
  #end
  event procedure OnUpdate;
end;

vipinterface WTHandCorrectionMask implements IWTHandCorrectionMask, IWTContainerItem, IProtectable
#ifdef ATL51
Licensed(Free)
#end
;
#end
