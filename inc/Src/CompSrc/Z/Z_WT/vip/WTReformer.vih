/*

                      (c) 1994,2003 корпорация ГАЛАКТИКА
  Проект        : ГАЛАКТИКА
  Система       : Заработная плата
  Назначение    : obj-интерфейс для пакетного переформирования табелей учета
                  рабочего времени
  Ответственный : Корзюк Виталий Францевич
  Параметры     : нет

*/

#ifndef _WTREFORMER_INCLUDED_
#define _WTREFORMER_INCLUDED_

#ifdef ComponentVersion
  #component "Z_WT"
#end

//------------------------------------------------------------------------------
#doc
  Объектный интерфейс с набором методов для пакетного переформирования табелей
  учета рабочего времени.
#end
objinterface IWorkingTableReformer;
  #doc
    Очищает очередь нуждающихся в переформировании табелей.
  #end
  procedure Clear;

  #doc
    Заносит в очередь на переформирование табель лицевого счета с nrec =
    APersonalAccount за месяц AMonth года AYear.
  #end
  procedure Queue(APersonalAccount: comp; AYear: integer; AMonth: byte);

  #doc
    Добавляет в очередь на переформирование табели лицевого счета с nrec =
    APersonalAccount за месяцы, описанные начальной датой Beginning и конечной
    датой Ending.
  #end
  procedure QueuePeriod(APersonalAccount: comp; Beginning, Ending: date);

  #doc
    Выполняет переформирование находящихся в очереди табелей (очередь не
    очищается).
  #end
  procedure Run;
end;

//------------------------------------------------------------------------------
#doc
  Расширение стандартного объектного интерфейса переформирователя табелей учета
  рабочего времени для случаев обновления табелей. Под обновлением
  подразумевается подсчет некоторых итоговых величин и перенос значений
  атрибутов лицевого счета (для табелей текущего и будущих периодов).
#end
objinterface IWorkingTableReformer2(IWorkingTableReformer);

  #doc
    Cвойство, управляющее включением (true) и выключением (false) режима
    обновления.
  #end
  property RefreshOnly: boolean;
end;


vipinterface WorkingTableReformer
  implements
    IWorkingTableReformer,
    IWorkingTableReformer2
  licensed(free);

#end