//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика ERP 8.1 - Управление персоналом
// Работа со списками условий труда на рабочем месте
//------------------------------------------------------------------------------

#ifndef _APPOINTKPS_VIH_INCLUDED_
#define _APPOINTKPS_VIH_INCLUDED_

#component "Z_Harm"

#include AppointKps.inc

const
  KPS_OSOBUSL   = 00000001b; // особые условия / вид деятельности
  KPS_TERR      = 00000010b; // террирориальные условия
  KPS_CODE      = 00000100b; // КПС / код профессии по ОКПД
  KPS_SUBCLASS  = 00001000b; // подкласс условий труда
  KPS_VISL      = 00010000b; // основание для выслуги
end;

#doc
Работа со списками условий труда на рабочем месте
#end
ObjInterface IAppointKps;

  procedure UpdateKps(app_Nrec, advises_nrec, inf_nrec: comp);

end;

#doc
Расширение №1 интерфейса IAppointKps
#end
ObjInterface IAppointKps1;

  procedure CopyKPS(NrecFrom, NrecTo: comp; KPStypeFrom, KPSTypeTo: integer);

end;

#doc
Расширение №2 интерфейса IAppointKps
#end
ObjInterface IAppointKps2;

  #doc
  Код особых условий "основных" условий работы заданного назначения
  #end
  function GetOU(_Appoint: comp): string;

  #doc
  Код КПС "основных" условий работы заданного назначения
  #end
  function GetKPS(_Appoint: comp): string;

  #doc
  Код территориальных условий "основных" условий работы заданного назначения
  #end
  function GetTU(_Appoint: comp): string;

  #doc
  Список всех особых условий заданного назначения
  #end
  function GetAllOU(_Appoint: comp): string;

  #doc
  Список всех КПС заданного назначения
  #end
  function GetAllKPS(_Appoint: comp): string;

  #doc
  Инициализация условий работы при выборе должности или подразделения в назначении
  #end
  procedure InitKPS(_Appoint, _Dept, _Post: comp);

  #doc
  Ссылка на "основные" условия работы для заданного назначения
  #end
  function GetMainKPS(_Appoint: comp // #docl Ссылка на назначение (Appointments.Nrec)
                     ): comp; // #docl Возвращает ссылку на Advises
  #doc
  Выбор условий работы для заданного назначения
  #end
  procedure PickMainKPS(_Appoint: comp // #docl Ссылка на назначение (Appointments.Nrec)
                       );
  #doc
  Удаление "основных" условий работы назначения
  #end
  procedure DeleteMainKPS(_Appoint: comp // #docl Ссылка на назначение (Appointments.Nrec)
                         );
  #doc
  Удаление всех условий работы ставки штатного расписания или назначения
  #end
  procedure DeleteAllKPS(KPSType: integer // #docl Константа cgKpsType_Staff или cgKpsType_Appoint
                       ; app_Nrec: comp // #docl Ссылка на ставку ШР (StaffStruct.Nrec) или на назначение (Appointments.Nrec)
                        );
end;

#doc
Расширение №3 интерфейса IAppointKps
#end
ObjInterface IAppointKps3;
  #doc
  Код подкласса условий труда заданного назначения
  #end
  function GetKlassPost(_Appoint: comp): string;
end;

#doc
Расширение №4 интерфейса IAppointKps
#end
ObjInterface IAppointKps4;
  #doc
  Код особых условий труда
  #end
  function GetAdvOU(_Advises: comp): string;

  #doc
  Код КПС
  #end
  function GetAdvKPS(_Advises: comp): string;

  #doc
  Код подкласса условий труда
  #end
  function GetAdvKlass(_Advises: comp): string;

  #doc
  Код территориальных условий
  #end
  function GetAdvTU(_Advises: comp): string;

  #doc
  Выбор ссылки на Advises из условий труда по назначению
  #end
  function PickNRecKPS(_Appoint, _Advises: comp): comp;

  #doc
  Замена "основных" условий работы назначения
  #end
  procedure ChangeMainKPS(_Appoint, _NewAdvises: comp);
end;

#doc
Расширение №5 интерфейса IAppointKps
#end
ObjInterface IAppointKps5;
  #doc
  Выбор ссылки на Advises из условий труда по подразделению и должности
  (для новой записи в БД, когда ее вставка еще не произошла)
  #end
  function PickNRecKPSByDepAndPost(_Appoint, _Department, _Post, _Advises: comp): comp;
end;

#doc
Расширение №6 интерфейса IAppointKps
#end
ObjInterface IAppointKps6;
  #doc
  Возвращение строкового значения вида: </br>
  Особые условия /  КПС / Подкласс условий труда / Территориальные условия
  #end
  function GetKpsSTR(_Advises: comp): String;

  #doc
  Возвращает HelpContext для поля "Условия труда на рабочем месте" в зависимости от страны
  #end
  function GetKpsHelpContext: String;

end;

#doc
Расширение №7 интерфейса IAppointKps
#end
objinterface IAppointKps7;

  #doc
  Функция возвращает ссылку на текущие основные условия труда на рабочем месте ставки с кодом _cStaffStr
  #end
  function GetStaffStrMainKPS(_cStaffStr: comp): comp;

  #doc
  Процедура изменяет основные условия труда на _cAdvises для ставки с кодом _cStaffStr
  #end
  procedure SetStaffStrMainKPS(_cStaffStr, _cAdvises: comp);
end;

#doc
Расширение №8 интерфейса IAppointKps
#end
objinterface IAppointKps8;
  #doc
  Строковое значение кода основания для выслуги лет особых условий с кодом _Advises
  #end
  function GetAdvVisl(_Advises: comp): string;

  #doc
  Наименование особых условий труда
  #end
  function GetAdvOU_Name(_Advises: comp): string;

  #doc
  Наименование КПС
  #end
  function GetAdvKPS_Name(_Advises: comp): string;
end;

#doc
Расширение №9 интерфейса IAppointKps
#end
objinterface IAppointKps9;
  #doc
  Удалить сведения об особых условиях труда в подразделении
  #end
  procedure DeleteDepAdvises(_cDep: comp);

  #doc
  Изменить ссылку на подразделение в особых условиях труда
  #end
  procedure UpdateDepAdvisesLink(_cDepOld, _cDepNew: comp);
end;

#doc
Расширение №10 интерфейса IAppointKps
#end
ObjInterface IAppointKps10;

  #doc
  Строковое значения условий труда в соответствии с форматом (константы KPS_*)
  #end
  function GetFormatAdvisesStr(_advises: comp; _format_mask: longint): string;

  #doc
  HelpContext для поля "Условия труда на рабочем месте" в соответствии с форматом (константы KPS_*)
  #end
  function GetFormatAdvisesHelpLine(_format_mask: longint): string;

end;

#doc
Расширение №11 интерфейса IAppointKps
#end
ObjInterface IAppointKps11;

  #doc
  Возвращает значение районного коэффициента, если страна <> ccBel, иначе всегда возвращает 0
  #end
  function GetRCoef(_Advises: comp): double;

  #doc
  Возвращает значение районного коэффициента, если страна <> ccBel, иначе всегда возвращает 0 </br>
  Данные возвращаются в виде процента увеличения суммы 1.35 = увеличить на 35%
  #end
  function GetRCoefPerc(_Advises: comp): double;

end;

#doc
Расширение №12 интерфейса IAppointKps
#end
ObjInterface IAppointKps12;

  #doc
  Получить подкласс в строковом представлении
  #end
  function GetKlassPostKoef(dKlassPost: double): string; // Подкласс

end;

VipInterface AppointKps
  implements IAppointKps, IAppointKps1, IAppointKps2, IAppointKps3, IAppointKps4, IAppointKps5, IAppointKps6,
             IAppointKps7, IAppointKps8, IAppointKps9, IAppointKps10, IAppointKps11, IAppointKps12
  licensed(free)
  parameters(AppNrec: comp; kps_readonly: boolean);

#end
