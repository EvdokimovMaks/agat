//******************************************************************************
//                                                      (с) корпорация Галактика
// Галактика 8.1 - Заработная плата
// Описание объектного интерфейса для создания зарплатного графика
//******************************************************************************

#ifndef _SalaryScheduleCreator_vih_INCLUDED_
#define _SalaryScheduleCreator_vih_INCLUDED_

#ifdef ComponentVersion
  #component "z_calendar"
#end

#doc
  Объектный интерфейс для создания спецификаций зарплатных графиков.
#end
objinterface ISalaryScheduleCreator;
  #doc
    Формирует спецификацию графика режима работы с использованием шаблона.
    Возвращает true в случае удачного завершения, иначе - false.</brief>

    <p>Nrec режима работы передается в OperatingModeRef, nrec шаблона - в
    TemplateRef (ссылка на запись из таблицы GRAFIK), даты начала и окончания
    периода - в BeginningDate и EndingDate. Существующие части графика будут
    обновлены, если OverwriteExisting = true, в противном случае, они будут
    оставлены без изменений.</p>
  #end
  function CreateWithTemplate(OperatingModeRef: comp; TemplateRef: comp; BeginningDate: date; EndingDate: date; OverwriteExisting: boolean): boolean;

  #doc
    Запускает окно настройки параметров и формирует спецификацию графика режима
    работы. Возвращает true в случае удачного завершения, иначе -
    false.</brief>

    <p>Nrec режима работы передается в OperatingModeRef, год и месяц по
    умолчанию - в параметрах OperatingYear и OperatingMonth.</p>
  #end
  function CreateTuned(OperatingModeRef: comp; ScheduleYear: integer; ScheduleMonth: byte): boolean;
end;

objInterface ISalaryScheduleCreator2(ISalaryScheduleCreator);
  #doc
    <brief>Заполняет праздничные часы в старом графике</brief>
    <p>Имеет смысл вызывать только для графиков, сформированных до того,
    как появились праздничные часы в графиках, т.к. в настоящий момент
    заполнение праздничных часов происходит прямо при формировании графика.
    </p>
    <p>Возвращаемое значение: 0 - успешно заполнено, 1 - в заполнении нет надобности
    (в графике уже заполнены праздничные часы), 2 - невалидная ссылка на режим работы,
    3 - график не сформирован, 4 - апдейт не прошёл,
    99 - функция не поддерживается на текущем словаре</p>
  #end
  function FillHolidays(OperatingModeRef: comp; ScheduleYear: integer; ScheduleMonth: byte): integer;
end;

vipinterface SalaryScheduleCreator implements ISalaryScheduleCreator, ISalaryScheduleCreator2 licensed(free);
#end
