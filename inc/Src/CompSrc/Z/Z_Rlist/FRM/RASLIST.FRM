//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика ERP 5.00 - Заработная плата
// Расчетные листки для алгоритма 0
//------------------------------------------------------------------------------

#doc
Расчетные листки для алгоритма 0
#end
.set name = 'RasList'
.hide
.fields
 zagol
 zagol2
 NPred
 Mes God
 Podr
 needShowShortInfo : boolean
 Tabn LschetB FIO
 N1 Okl

 Msro NYEARK
 Koldn Kolch Kod  Nopl Summaop
 Nachisl
 FondStr FondDn FondCh
 FondTime2 : boolean
 FondStr_2 FondDn_2 FondCh_2
 FaktDn FaktCh
 PlanStr PlanDn PlanCh
 PlanTime2 : boolean
 PlanStr_2 PlanDn_2 PlanCh_2
 PaidStr PaidDn PaidCh
 TypeUd
 Msru UYEARK
 Kodud Nudr Summaud
 Uder
 Str_Dolg1 Dolg1
 Str_Dolg2 Dolg2

 Msrn NEYEARK
 Kodn Nudn Summan
 Nenach
.endfields
 ^ ^
 ^
.{
.if cc0
  ^ ^
  ^
  ^
  ^ ^ ^
  ^ ^
.{
.if cc1
  ^ ^ ^ ^ ^ ^ ^
.end
.}
 ^ 
 ^ ^ ^ 
 ^  
 ^ ^ ^
 ^ ^
.if CPlanDays
 ^ ^ ^ 
 ^
 ^ ^ ^
.end
.if CPaidDays
 ^ ^ ^
.end
.{
.if cc2
^
^ ^ ^ ^ ^
.end
.}
 ^
 ^ ^
 ^ ^
.{
.if cc3
 ^ ^ ^ ^ ^
.end
.}
.if nene
 ^
.end
.if CAllNalogFOT
.fields
  FOT_NALCODE  FOT_NALNAME   FOT_NALSUM
.endfields
.{ AllFOTLoop CheckEnter
 ^^^
.}
.end
.fields
  paymentDate
  paymentSum
  paymentComment
  totalShortSum
.endfields
.if NeedShortInfo
.{ Short_Info CheckEnter
   .@@@@@@@@@   ^   ^
.}
    итого ^
.end
.end
.fields
 FCH
 MonthRL
 EmailLine
.endfields
 ^
 ^
 ^
.}
.fields
 NameIsp
 DolgIsp
 DatePodp
.endfields
^ ^ ^
.begin
 RasList.fExit;
end.
.endform
!
!
!
.linkform 'RasList_01' prototype is 'RasList'
.group 'fullone_new'
.nameinlist'Полная форма расчетного листка'
.var
  PeriodStr, sFio : string;
  PrintUd,PrintPerech : boolean;
  CurUd : word;
  Itogo : double;
.endvar
.fields
CommonFormHeader
.endfields
^
.fields
 NPred
 PeriodStr
 Podr sFio
 N1 Okl : "p:l"
 Msro Koldn Kolch Kod Nopl Summaop
 Nachisl
 FondDn FondCh
 FondStr : "p:r"
 FondDn FondCh
 FondStr_2 : "p:r"
 FondDn_2 FondCh_2
 FaktDn FaktCh
 PlanDn PlanCh
 PlanStr : "p:r"
 PlanDn PlanCh
 PlanStr_2 : "p:r"
 PlanDn_2 PlanCh_2
 PaidDn PaidCh
 Itogo
 Msru Kodud Nudr Summaud
 Itogo
 Itogo
 Str_Dolg1 Dolg1
 Str_Dolg2 Dolg2
 Msrn Kodn Nudn Summan
 Nenach
.endfields

 И Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.if cc0
.begin
  PrintUd := false;
  PrintPerech := false;
  Itogo := 0;
  CurUd := 1;
  sFio := Tabn + ' / ' + FIO;
  PeriodStr :='за '+Mes+' месяц '+String(God)+' г.'
end.
┌───────────────────────┬────────────────────────────────────────────────────────┐
│  БПериод Б                │ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
│  БПодразделение Б         │ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
│  БТаб.номер/ФИО Б         │ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
│  БДолжность Б             │ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
│  БТарифная ставка/Оклад  Б│ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
├───┬───────┬───────┬───┴┬────────────────────────────────────┬──────────────────┤
│ БМ-ц Б│ БКол.дн Б │  БЧасов Б │  БКод Б│   БНаименование вида оплат Б           │   БСУММА Б           │
├───┼───────┼───────┼────┼────────────────────────────────────┼──────────────────┤
.{
.if cc1
│ &&│&#&&.&&│&#&&&&&│&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&│
.end
.}
│   │       │       │    │                         БНАЧИСЛЕНО...│&'&&&&&&&&&&&&&&&&│ Б
├───┴───────┴───────┴────┴────────────────────────────────────┼──────────────────┤
.{?Internal; FondTime2 = false
│                                              ФОНД ВРЕМЕНИ...│&&.&& ДН.&&&.&& Ч.│
.}
.{?Internal; FondTime2 = true
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&.&& ДН.&&&.&& Ч.│
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&.&& ДН.&&&.&& Ч.│
.}
│                             ФАКТИЧЕСКИ ОТРАБОТАНО ВРЕМЕНИ...│&&.&& ДН.&&&.&& Ч.│
.if CPlanDays
.{?Internal; PlanTime2 = false
│                                            ПЛАНОВОЕ ВРЕМЯ...│&&.&& ДН.&&&.&& Ч.│
.}
.{?Internal; PlanTime2 = true
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&.&& ДН.&&&.&& Ч.│
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&.&& ДН.&&&.&& Ч.│
.}
.end
.if CPaidDays
│                                        ОПЛАЧИВАЕМОЕ ВРЕМЯ...│&&.&& ДН.&&&.&& Ч.│
.end
├───┬───────┬───────┬────┬────────────────────────────────────┼──────────────────┤
│ БМ-ц Б│ БКол.дн Б │  БЧасов Б │  БКод Б│   БНаименование вида удержаний      Б  │   БСУММА Б           │
├───┼───────┼───────┼────┼────────────────────────────────────┼──────────────────┤
.{
.if cc2
.begin
  if TypeUd = 1
    PrintUd := true;
  if TypeUd = 2
    PrintPerech := true;
end.
.{?internal; TypeUd <> curUd;
│   │       │       │    │                          БУДЕРЖАНО...│&'&&&&&&&&&&&&&.&& Б│
├───┼───────┼───────┼────┼────────────────────────────────────┼──────────────────┤
│ БМ-ц Б│ БКол.дн Б │  БЧасов Б │  БКод Б│   БНаименование вида перечислений   Б  │     БСУММА Б         │
├───┼───────┼───────┼────┼────────────────────────────────────┼──────────────────┤
.}
.begin
  if  CurUd = TypeUd
    Itogo := Itogo + double(Summaud)
  else
  {
    curUd := integer(TypeUd);
    Itogo := double(Summaud)
  }
end.
│ &&│       │       │&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&│
.end
.}
.{?internal;  PrintPerech = false;
│   │       │       │    │                          БУДЕРЖАНО...│&'&&&&&&&&&&&&&.&& Б│
├───┼───────┼───────┼────┼────────────────────────────────────┼──────────────────┤
│ БМ-ц Б│ БКол.дн Б │  БЧасов Б │  БКод Б│   БНаименование вида перечислений   Б  │     БСУММА Б         │
├───┼───────┼───────┼────┼────────────────────────────────────┼──────────────────┤
.begin
  Itogo := 0
end.
.}
│   │       │       │    │             БПЕРЕЧИСЛЕНО\ВЫПЛАЧЕНО...│&'&&&&&&&&&&&&&.&& Б│
├───┼───────┼───────┼────┼────────────────────────────────────┼──────────────────┤
│   │       │       │    │ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&│ Б
│   │       │       │    │                      Б@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&│ Б
.{
.if cc3
│ &&│       │       │&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&│
.end
.}
.if nene
│   │       │       │    │               БНЕНАЧИСЛЯЕМЫЙ ДОХОД...│&'&&&&&&&&&&&&&&&&│ Б
.end
└───┴───────┴───────┴────┴────────────────────────────────────┴──────────────────┘
.if CAllNalogFOT
.fields
  FOT_NALCODE  FOT_NALNAME   FOT_NALSUM
.endfields
┌────────────────────────────────────────────────────────────────────────────────┐
│ Номер налога  Наименование налога                               Сумма Налога   │
.{ AllFOTLoop CheckEnter
│   @@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&&&&&&&&│
.}
└────────────────────────────────────────────────────────────────────────────────┘
.end
.if NeedShortInfo
.{ Short_Info CheckEnter
.}
.end
----------------------------------------------------------------------------------
.end
.}
 И
.endform
!
!
!
.linkform 'RasList_01_old' prototype is 'RasList'
.group 'fullone'
.nameinlist'Полная, без раздела перечислений'
.fields
CommonFormHeader
.endfields
^
.fields
 NPred
 Mes God
 Podr Tabn FIO
 N1 Okl: "p:r"
 Msro Koldn Kolch Kod Nopl Summaop
 Nachisl
 FondDn FondCh
 FondStr : "p:r"
 FondDn FondCh
 FondStr_2 : "p:r"
 FondDn_2 FondCh_2
 FaktDn FaktCh
 PlanDn PlanCh
 PlanStr : "p:r"
 PlanDn PlanCh
 PlanStr_2 : "p:r"
 PlanDn_2 PlanCh_2
 PaidDn PaidCh
 Msru Kodud Nudr Summaud
 Uder
 Str_Dolg1 Dolg1
 Str_Dolg2 Dolg2
 Msrn Kodn Nudn Summan
 Nenach
.endfields

 И Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.if cc0
┌─────────┬──────────┬───────────────────────────────────────────────────────────┐
│Подразд. │Таб.номер │  Фамилия И.О.                 за &&&&&&&& месяц  &&&& г.  │
│@@@@@@@@@│&&&&&&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
├─────────┴──────────┴─────────────────────┬─────────────────────────────────────┤
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ Тарифная ставка/Оклад  @@@@@@@@@@@@@│
├───┬───────┬───────┬────┬─────────────────┴────────────────────┬────────────────┤
│М-ц│Кол.дн │ Часов │ Код│  Наименование вида оплат(удержаний)  │  СУММА         │
├───┼───────┼───────┼────┼──────────────────────────────────────┼────────────────┤
.{
.if cc1
│ &&│&#&&.&&│&#&&&&&│&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│
.end
.}
│   │       │       │    │                          БНАЧИСЛЕНО....│&'&&&&&&&&&&&&&&│ Б
.{?Internal;  FondTime2 = false
│                                                БФОНД ВРЕМЕНИ...&&.&& ДН.&&&.&& Ч.│ Б
.}
.{?Internal;  FondTime2 = true
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б
.}
│                               БФАКТИЧЕСКИ ОТРАБОТАНО ВРЕМЕНИ...&&.&& ДН.&&&.&& Ч.│ Б
.if CPlanDays
.{?Internal;  PlanTime2 = false
│                               Б               ПЛАНОВОЕ ВРЕМЯ...&&.&& ДН.&&&.&& Ч.│ Б
.}
.{?Internal;  PlanTime2 = true
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б
.}
.end
.if CPaidDays
│                               Б           ОПЛАЧИВАЕМОЕ ВРЕМЯ...&&.&& ДН.&&&.&& Ч.│ Б
.end
.{
.if cc2
│ &&│       │       │&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│
.end
.}
│   │       │       │    │                           БУДЕРЖАНО....│&'&&&&&&&&&&&&&&│ Б
│   │       │       │    │  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│ Б
│   │       │       │    │                        Б@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│ Б
└───┴───────┴───────┴────┴──────────────────────────────────────┴────────────────┘
.{
.if cc3
│ &&│       │       │&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│
.end
.}
.if nene
│   │       │       │    │                 БНЕНАЧИСЛЯЕМЫЙ ДОХОД...│&'&&&&&&&&&&&&&&│ Б
└───┴───────┴───────┴────┴──────────────────────────────────────┴────────────────┘
.end
.if CAllNalogFOT
.fields
  FOT_NALCODE  FOT_NALNAME   FOT_NALSUM
.endfields
┌────────────────────────────────────────────────────────────────────────────────┐
│ Номер налога  Наименование налога                               Сумма Налога   │
.{ AllFOTLoop CheckEnter
│   @@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&&&&&&&&│
.}
└────────────────────────────────────────────────────────────────────────────────┘
.end
.if NeedShortInfo
.{ Short_Info CheckEnter
.}
.end
----------------------------------------------------------------------------------
.end
.}
 И
.endform
!
!
.linkform 'RasList_02' prototype is 'RasList'
.group 'simpleone'
.nameinlist'Сокращенная форма расчетного листка'
.fields
CommonFormHeader
.endfields
^
.fields
 Npred
 Mes God
 Tabn FIO
 Msro Koldn Kolch Kod  Summaop
 Nachisl
 Msru Kodud  Summaud
 Uder
 Str_Dolg1 Dolg1
 Msrn Kodn Summan
 Nenach
.endfields

 Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.if cc0
┌──────────────────────────────────────┐
│за &&&&&&&& &&&& г.  таб. &&&&&&&&&&  │
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
├──┬───────┬───────┬────┬──────────────┤
│М.│К.дн.  │ Часов │Код │  СУММА       │
├──┼───────┼───────┼────┼──────────────┤
.{
.if cc1
│&&│&#&&.&&│&#&&&&&│&&&&│&'&&&&&&&&&&&&│
.end
.}
│       БНАЧИСЛЕНО........│&'&&&&&&&&&&&&│ Б
.if CPlanDays
.end
.if CPaidDays
.end
.{
.if cc2
│&&│       │       │&&&&│&'&&&&&&&&&&&&│
.end
.}
│      Б УДЕРЖАНО.........│&'&&&&&&&&&&&&│ Б
│   Б@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&│ Б
└──────────────────────────────────────┘
.{
.if cc3
│&&│       │       │&&&&│&'&&&&&&&&&&&&│
.end
.}
.if nene
│     БНЕНАЧИСЛЯЕМЫЙ ДОХОД│&'&&&&&&&&&&&&│ Б
└──┴───────┴───────┴────┴──────────────┘
.end
.if CAllNalogFOT
.{ AllFOTLoop CheckEnter
.}
.end
.if NeedShortInfo
.{ Short_Info CheckEnter
.}
.end
----------------------------------------
.end
.}
.endform

.linkform 'RasList_03' prototype is 'RasList'
.group 'simpletwo'
.nameinlist'Сокращенная форма расчетного листка с дублированием'
.fields
CommonFormHeader
.endfields
^
.fields
 Npred
 Mes God  Tabn Mes God  Tabn
 FIO FIO
 Msro Koldn Kolch Kod  Summaop Msro Koldn Kolch Kod  Summaop
 Nachisl Nachisl
 Msru Kodud  Summaud Msru Kodud  Summaud
 Uder Uder
 Str_Dolg1 Dolg1 Str_Dolg1 Dolg1
 Msrn Kodn Summan Msrn Kodn Summan
 Nenach Nenach
.endfields
 И Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.if cc0
┌──────────────────────────────────────┐   ┌──────────────────────────────────────┐
│за &&&&&&&& &&&& г.  таб. &&&&&&&&&&  │   │за &&&&&&&& &&&& г.  таб. &&&&&&&&&&  │
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│   │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
├──┬───────┬───────┬────┬──────────────┤   ├──┬───────┬───────┬────┬──────────────┤
│М.│К.дн.  │ Часов │Код │  СУММА       │   │М.│К.дн.  │ Часов │Код │  СУММА       │
├──┼───────┼───────┼────┼──────────────┤   ├──┼───────┼───────┼────┼──────────────┤
.{
.if cc1
│&&│&#&&.&&│&#&&&&&│&&&&│&'&&&&&&&&&&&&│   │&&│&#&&.&&│&#&&&&&│&&&&│&'&&&&&&&&&&&&│
.end
.}
│       БНАЧИСЛЕНО........│&'&&&&&&&&&&&&│   │      НАЧИСЛЕНО........│&'&&&&&&&&&&&&│ Б
.if CPlanDays
.end
.if CPaidDays
.end
.{
.if cc2
│&&│       │       │&&&&│&'&&&&&&&&&&&&│   │&&│       │       │&&&&│&'&&&&&&&&&&&&│
.end
.}
│       БУДЕРЖАНО.........│&'&&&&&&&&&&&&│   │      УДЕРЖАНО.........│&'&&&&&&&&&&&&│ Б
│    Б@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&│   │   @@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&│ Б
└──────────────────────────────────────┘   └──────────────────────────────────────┘
.{
.if cc3
│&&│       │       │&&&&│&'&&&&&&&&&&&&│   │&&│       │       │&&&&│&'&&&&&&&&&&&&│
.end
.}
.if nene
│     БНЕНАЧИСЛЯЕМЫЙ ДОХОД│&'&&&&&&&&&&&&│   │    НЕНАЧИСЛЯЕМЫЙ ДОХОД│&'&&&&&&&&&&&&│ Б
└──┴───────┴───────┴────┴──────────────┘   └──┴───────┴───────┴────┴──────────────┘
.end
.if CAllNalogFOT
.{ AllFOTLoop CheckEnter
.}
.end
.if NeedShortInfo
.{ Short_Info CheckEnter
.}
.end
----------------------------------------   ----------------------------------------
.end
.}
 И
.endform

.linkform 'RasList_04' prototype is 'RasList'
.group 'fulltwo'
.nameinlist'Полная форма расчетного листка с дублированием'
.fields
CommonFormHeader
.endfields
^
.fields
 NPred
 Mes God Mes God
 Podr Tabn FIO Podr Tabn FIO
 N1 Okl: "p:r" N1 Okl: "p:r"
 Msro Koldn Kolch Kod Nopl Summaop Msro Koldn Kolch Kod Nopl Summaop
 Nachisl Nachisl
 FondDn FondCh FondDn FondCh
 FondStr : "p:r" 
 FondDn FondCh 
 FondStr : "p:r" FondDn FondCh
 FondStr_2 : "p:r" 
 FondDn_2 FondCh_2 
 FondStr_2 : "p:r" FondDn_2 FondCh_2
 FaktDn FaktCh FaktDn FaktCh
 PlanDn PlanCh PlanDn PlanCh
 PlanStr : "p:r" 
 PlanDn PlanCh 
 PlanStr : "p:r" 
 PlanDn PlanCh
 PlanStr_2 : "p:r" 
 PlanDn_2 PlanCh_2 
 PlanStr_2 : "p:r" 
 PlanDn_2 PlanCh_2
 PaidDn PaidCh PaidDn PaidCh
 Msru Kodud Nudr Summaud Msru Kodud Nudr Summaud
 Uder Uder
 Str_Dolg1 Dolg1 Str_Dolg1 Dolg1
 Str_Dolg2 Dolg2 Str_Dolg2 Dolg2
 Msrn Kodn Nudn Summan Msrn Kodn Nudn Summan
 Nenach Nenach
.endfields

 Ш Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.if cc0
┌─────────┬──────────┬───────────────────────────────────────────────────────────┐   ┌─────────┬──────────┬───────────────────────────────────────────────────────────┐
│Подразд. │Таб.номер │  Фамилия И.О.                 за &&&&&&&& месяц  &&&& г.  │   │Подразд. │Таб.номер │  Фамилия И.О.                 за &&&&&&&& месяц  &&&& г.  │
│@@@@@@@@@│&&&&&&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│   │@@@@@@@@@│&&&&&&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
├─────────┴──────────┴─────────────────────┬─────────────────────────────────────┤   ├─────────┴──────────┴─────────────────────┬─────────────────────────────────────┤
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ Тарифная ставка/Оклад  @@@@@@@@@@@@@│   │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ Тарифная ставка/Оклад  @@@@@@@@@@@@@│
├───┬───────┬───────┬────┬─────────────────┴────────────────────┬────────────────┤   ├───┬───────┬───────┬────┬─────────────────┴────────────────────┬────────────────┤
│М-ц│Кол.дн │  Часов│ Код│  Наименование вида оплат(удержаний)  │  СУММА         │   │М-ц│Кол.дн │ Часов │ Код│  Наименование вида оплат(удержаний)  │  СУММА         │
├───┼───────┼───────┼────┼──────────────────────────────────────┼────────────────┤   ├───┼───────┼───────┼────┼──────────────────────────────────────┼────────────────┤
.{
.if cc1
│ &&│&#&&.&&│&#&&&&&│&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│   │ &&│&#&&.&&│&#&&&&&│&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│
.end
.}
│   │       │       │    │                          БНАЧИСЛЕНО....│&'&&&&&&&&&&&&&&│ Б   │   │       │       │    │                          БНАЧИСЛЕНО....│&'&&&&&&&&&&&&&&│ Б
.{?Internal;  FondTime2 = false
│                                                БФОНД ВРЕМЕНИ...&&.&& ДН.&&&.&& Ч.│ Б   │                                                БФОНД ВРЕМЕНИ...&&.&& ДН.&&&.&& Ч.│ Б
.}
.{?Internal;  FondTime2 = true
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б   │ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б   │ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б
.}
│                               БФАКТИЧЕСКИ ОТРАБОТАНО ВРЕМЕНИ...&&.&& ДН.&&&.&& Ч.│ Б   │                               БФАКТИЧЕСКИ ОТРАБОТАНО ВРЕМЕНИ...&&.&& ДН.&&&.&& Ч.│ Б
.if CPlanDays
.{?Internal;  PlanTime2 = false
│                                    Б          ПЛАНОВОЕ ВРЕМЯ...&&.&& ДН.&&&.&& Ч.│ Б   │                               Б               ПЛАНОВОЕ ВРЕМЯ...&&.&& ДН.&&&.&& Ч.│ Б
.}
.{?Internal;  PlanTime2 = true
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б   │ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б   │ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&.&& ДН.&&&.&& Ч.│ Б
.}
.end
.if CPaidDays
│                               Б           ОПЛАЧИВАЕМОЕ ВРЕМЯ...&&.&& ДН.&&&.&& Ч.│ Б   │                               Б           ОПЛАЧИВАЕМОЕ ВРЕМЯ...&&.&& ДН.&&&.&& Ч.│ Б
.end
.{
.if cc2
│ &&│       │       │&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│   │ &&│       │       │&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│
.end
.}
│   │       │       │    │                           БУДЕРЖАНО....│&'&&&&&&&&&&&&&&│ Б   │   │       │       │    │                           БУДЕРЖАНО....│&'&&&&&&&&&&&&&&│ Б
│   │       │       │    │  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│ Б   │   │       │       │    │  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│ Б
│   │       │       │    │                        Б@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│ Б   │   │       │       │    │                        Б@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│ Б
└───┴───────┴───────┴────┴──────────────────────────────────────┴────────────────┘   └───┴───────┴───────┴────┴──────────────────────────────────────┴────────────────┘
.{
.if cc3
│ &&│       │       │&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│   │ &&│       │       │&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&│
.end
.}
.if nene
│   │       │       │    │                 БНЕНАЧИСЛЯЕМЫЙ ДОХОД...│&'&&&&&&&&&&&&&&│ Б   │   │       │       │    │                 БНЕНАЧИСЛЯЕМЫЙ ДОХОД...│&'&&&&&&&&&&&&&&│ Б
└───┴───────┴───────┴────┴──────────────────────────────────────┴────────────────┘   └───┴───────┴───────┴────┴──────────────────────────────────────┴────────────────┘
.end
.if CAllNalogFOT
.fields
  FOT_NALCODE  FOT_NALNAME   FOT_NALSUM    FOT_NALCODE  FOT_NALNAME   FOT_NALSUM
.endfields
┌────────────────────────────────────────────────────────────────────────────────┐   ┌────────────────────────────────────────────────────────────────────────────────┐
│ Номер налога  Наименование налога                               Сумма Налога   │   │ Номер налога  Наименование налога                               Сумма Налога   │
.{ AllFOTLoop CheckEnter
│   @@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&&&&&&&&│   │   @@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&&&&&&&&│
.}
└────────────────────────────────────────────────────────────────────────────────┘   └────────────────────────────────────────────────────────────────────────────────┘
.end
.if NeedShortInfo
.{ Short_Info CheckEnter
.}
.end
----------------------------------------------------------------------------------   ----------------------------------------------------------------------------------
.end
.}
 Ш
.endform
!
!
!
.linkform 'RasList_reestr' prototype is 'RasList'
.group 'reestr5'
.nameinlist'Реестр расчетных листков (с группировкой по подразделениям)'
.var
  s,d : string;
  i,t: integer;
.endvar
.begin
  s := '';
  i := 0;
  d := '';
  t := 0;
end.
.{
.fields
NPred
zagol
.endfields
.[H
Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

    ^
┌──────┬──────────┬───────────────────────────────────────────┬──────────────┐
│№ п/п │Таб.номер │ Фамилия Имя Отчество                      │ Подпись      │
.]H
.if cc0
.{?internal; d<>Podr ;
.begin
d:=Podr;
i:=0;
t:=0;
end.
.fields
Podr
.endfields
├──────┴──────────┴───────────────────────────────────────────┴──────────────┤
|Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ |
├──────┬──────────┬───────────────────────────────────────────┬──────────────┤
.}
.{?internal; s<>Tabn ;
.begin
  s := Tabn;
  i := i+1;
end.
.fields
i Tabn FIO
.endfields
.{?internal; t=1;
├──────┼──────────┼───────────────────────────────────────────┼──────────────┤
.}
.begin
  t:=1;
end.
|&&&&& | @@@@@@@@ | @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ |              |
.}
.{
.if cc1
.end
.}
.if CPlanDays
.end
.if CPaidDays
.end
.{
.if cc2
.end
.}
.{
.if cc3
.end
.}
.if nene
.end
.if CAllNalogFOT
.{ AllFOTLoop CheckEnter
.}
.end
.if NeedShortInfo
.{ Short_Info CheckEnter
.}
.end
.end
.[f
└──────┴──────────┴───────────────────────────────────────────┴──────────────┘
.]f
.}
.fields
 DolgIsp
 NameIsp
 DatePodp
.endfields
^                         ^     ^
.endform
!
!
!
.linkform 'RasList_reestr6' prototype is 'RasList'
.group 'reestr6'
.nameinlist'Реестр расчетных листков (без группировки по подразделениям)'
.var
  s : string;
  i: integer;
.endvar
.begin
  s := '';
  i := 0;
end.
.fields
NPred
zagol
zagol2
.endfields
.[H

Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    ^

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

┌──────┬──────────┬───────────────────────────────────────────┬──────────────┐
│№ п/п │Таб.номер │ Фамилия Имя Отчество                      │ Подпись      │
.]H
.{
.if cc0
.{?internal; s<>Tabn ;
.begin
  s := Tabn;
  i := i+1;
end.
.fields
i Tabn FIO
.endfields
├──────┼──────────┼───────────────────────────────────────────┼──────────────┤
|&&&&& | @@@@@@@@ | @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ |              |
.}
.{
.if cc1
.end
.}
.if CPlanDays
.end
.if CPaidDays
.end
.{
.if cc2
.end
.}
.{
.if cc3
.end
.}
.if nene
.end
.if CAllNalogFOT
.{ AllFOTLoop CheckEnter
.}
.end
.if NeedShortInfo
.{ Short_Info CheckEnter
.}
.end
.end
.[f
└──────┴──────────┴───────────────────────────────────────────┴──────────────┘
.]f
.}
.fields
 DolgIsp
 NameIsp
 DatePodp
.endfields
^                         ^     ^
.endform
