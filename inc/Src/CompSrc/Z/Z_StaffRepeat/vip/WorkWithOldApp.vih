/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                                           (c) корпорация ГАЛАКТИКА        ║
 ║ Проект        : Управление персоналом                                     ║
 ║ Версия        : 7.11                                                      ║
 ║ Назначение    : Сервисная функция: Копирование данных сотрудников         ║
 ║                 повторно принимаемых на работу                            ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#ifdef ComponentVersion
#component "z_StaffRepeat"
#end

#doc
Работа с таблицей истории увольнений при повторном трудоустройстве
#end
objinterface IWorkWithOldApp;

#doc
  Функция инициализации периодов предыдущих трудоустройств сотрудника
  на данном предприятии
  wType - вариант загрузки  (пока в планах):
  0 - по карточкам
  1 - по лицевым счетам
  true - есть периоды (автоматически позиционирование на первую запись - можно тянуть атрибуты)
  false - нет предыдущих трудоустройств на ту же карточку

#end
function LoadPeriods(cPsn: comp; wType: word): boolean;

#doc
  Функция говорит, удалось ли спозиционироваться на очередной виток рабочего периода
  В случае удачи можно тянуть необходимые атрибуты
#end
function Next: boolean;

#doc
  Ссылка на старую карточку. Не исключен вариант, что это поле идентично ссылке на новую
  карточку
#end
function GetOldPsn: comp;

#doc
  Ссылка на новую карточку
#end
function GetNewPsn: comp;

#doc
  Ссылка на старый л\с
#end
function GetOldLS: comp;

#doc
  Ссылка на новый л\с
#end
function GetNewLS: comp;

#doc
  Ссылка на приказ об увольнении (cContDoc)
#end
function GetOrder: comp;

#doc
  Дата приема
#end
function GetDateApp: date;

#doc
  Дата увольнения
#end
function GetDateDis: date;

#doc
  табельный номер
#end
function GetTabN: string[20];

// теперь пойдут функции, не связанные с загрузкой периодов
#doc
  проверяет, а был ли прием до входной даты по истории увольнений
#end
Function IsPriemBefore(cPsn: comp; dRab: date): boolean;

#doc
  проверяет, а был ли прием после входной даты по истории увольнений
#end
Function IsPriemAfter(cPsn: comp; dRab: date): boolean;

end;

vipinterface WorkWithOldApp implements IWorkWithOldApp
  Licensed (free)
;
