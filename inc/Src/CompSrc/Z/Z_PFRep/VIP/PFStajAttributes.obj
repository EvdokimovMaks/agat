//******************************************************************************
//                                                      (с) корпорация Галактика
// Галактика 7.12 - контур "Управление персоналом"
// Объявление объектного интерфеса для получения атрибутов пенсионного стажа
//******************************************************************************

#ifndef _PFSTAJATTRIBUTES_OBJ_INCLUDED_
#define _PFSTAJATTRIBUTES_OBJ_INCLUDED_

#ifdef ComponentVersion
  #component "Z_PFRep"
#end

//******************************************************************************
// набор методов для выборки атрибутов пенсионного стажа
//******************************************************************************

#doc
Объектный интерфейс для получения атрибутов пенсионного стажа
#end
objinterface IPFStajAttributes1;
//------------------------------------------------------------------------------
#doc
 Функция возвращает кол-во записей о декрктном отпуске в пенсионном стаже за период,
 передаваемый в процедуру CalcPFStagAttributes
 Возвращаемый тип: word;</brief>

  Параметры:
  НЕТ
#end
  function GetDekretCount: word;

end;
//------------------------------------------------------------------------------
#doc
Объектный интерфейс для получения атрибутов пенсионного стажа
#end
objinterface IPFStajAttributes2;
//------------------------------------------------------------------------------
#doc
  Установить ссылку на маркер для Территориальных условий </brief>

  Параметры:
  (Longint) маркер со списком значений для Территориальных условий;

#end
  procedure SetTerrCatCollectionPointer(_Marker: longint);
//------------------------------------------------------------------------------
#doc
  Установить параметр необходимости проверки условий для пенсионного стажа,
  заданных в маркерах, на наличие - отсутствие условий в стаже              </brief>

  Параметры:
  (boolean) проверка на наличие или отсутствие условий в стаже;

#end
procedure pSetwUslEx(boCondittionEx: boolean);
end;
//------------------------------------------------------------------------------
#doc
Объектный интерфес для получения атрибутов пенсионного стажа
#end
objinterface IPFStajAttributes;
//------------------------------------------------------------------------------
#doc
 Процедура получения основных атрибутов пенсионного стажа за указанный период </brief>
 Параметры:
  (comp)ссылка на физическое лицо(Persons);
  (date)дата начала периода;
  (date)дата окончания периода;
  (comp)ссылка на доп. сведения о стаже(var-параметр);
  (comp)ссылка на территориальные условия(var-параметр);
  (comp)ссылка на особые условия(var-параметр);
  (comp)ссылка на условия по выслуге лет(var-параметр);
  (word)количество записей о стаже(var-параметр);
  (boolean)признак других особых условий(var-параметр);
  (word)признак стажа по договору подряда(var-параметр);
  (boolean) признак того, что стаж по беременности и родам(var-параметр);
#end
  Procedure CalcPFStagAttributes( cPerson: comp; _datbeg, _datend: date; var _prDoprec: boolean;
                                  var cTerr: comp; var cOsUsl: comp; var cVysl: comp; var SRecCount: word;
                                  var bOther: boolean; var cDogSzv: word; var bDekret: boolean
                                );
//------------------------------------------------------------------------------
#doc
 Функция определяющая был ли у персоны льготный стаж за установленный период
 Возвращаемый тип: boolean;</brief>

  Параметры:
  (comp)ссылка на физическое лицо(Persons);
  (date)дата начала периода;
  (date)дата окончания периода;
#end
  function IsStajHaveLgots( cPerson: comp; _datbeg, _datend: date): boolean;

//------------------------------------------------------------------------------
#doc
  Установить текущей предприятие, для выборки записей о пенсионном стаже
  !ВНИМАНИЕ! Парамер - это ссылка на Catalogs . Точка входа в каталоги (-35) </brief>

  Параметры:
  (comp)ссылка на Catalogs;

#end
  procedure SetCurOrg(_Value: comp);

//------------------------------------------------------------------------------
#doc
  Установить ссылку на маркер для особых условий </brief>

  Параметры:
  (Longint) маркер со списком особых условий;

#end
  procedure SetUslCatCollectionPointer(_Marker: longint);

//------------------------------------------------------------------------------
#doc
  Установить ссылку на маркер для оснований на исчисление пенсионного стажа </brief>

  Параметры:
  (Longint) маркер со списком оснований;

#end
  procedure SetOsnCatCollectionPointer(_Marker: longint);

//------------------------------------------------------------------------------
#doc
  Установить ссылку на маркер для оснований на выслугу лет </brief>

  Параметры:
  (Longint) маркер со списком оснований для выслуги лет;

#end
  procedure SetVislCatCollectionPointer(_Marker: longint);

//------------------------------------------------------------------------------
#doc
  Установить ссылку на маркер для вредных условий </brief>

  Параметры:
  (Longint) маркер со списком оснований для вредных условий;

#end
  procedure SetVredCatCollectionPointer(_Marker: longint);

//------------------------------------------------------------------------------
#doc
  Установить ссылку на маркер для Доп. параметра (ИТ-Д3) </brief>

  Параметры:
  (Longint) маркер со списком значений для Доп. параметра (ИТ-Д3);

#end
  procedure SetDopCatCollectionPointer(_Marker: longint);

//------------------------------------------------------------------------------
#doc
  Учитываются ли дополнительные условия по стажу
  Возвращаемый тип: boolean; </brief>

  Параметры:
  нет
#end
  function GetAdditionalCaseCondition: boolean;

//------------------------------------------------------------------------------
#doc
  Установить учет  дополнительных условия по стажу </brief>

  Параметры:
  (boolen) флаг(установить/сбросить);
#end
  procedure SetAdditionalCaseCondition( Condittion: boolean);

//------------------------------------------------------------------------------
#doc
  Попадает ли работник под дополнительные условия
  Возвращаемый тип: boolean; </brief>

  Параметры:
  Нет
#end
  function IsAdditionalCaseValid: boolean;

end;

#end
