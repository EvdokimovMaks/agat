//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 9.1 - модуль "Заработная плата"
// Временные структуры для формирования ОДВ-1 и СЗВшек с 2017 г.
//
//------------------------------------------------------------------------------
#ifndef _SZV_VIH_INCLUDED_
#define _SZV_VIH_INCLUDED_

//------------------------------------------------------------------------------
// таблицы для формы СЗВ-Корр
table struct tp_SZV_Korr_LS "Данные сотрудников для отчета СЗВ-Корр"
(
  nRec          : comp
 ,cLschet       : comp
 ,TabN          : longInt
 ,StrTabN       : string   // строковое значение таб.номера
 ,tPerson       : comp
 ,cPodr         : comp
 ,FIO           : string   // ФИО
 ,LastName      : s60      // фамилия
 ,FirstName     : s60      // имя
 ,Patronymic    : s60      // отчество
 ,SNILS         : s50      // СНИЛС
 ,CategCode     : s10      // код категории застрах.лица
 ,ContractType  : s20      // тип договора
 ,wContractType : word     // тип договора - 1 или 2
 ,ContractNum   : integer
 ,ContractDate  : date
 ,DopTarCode    : string[4]
 // для СЗВ-ИСХ :
 ,IsUv31_12     : boolean                  // уволен ли 31/12 отчетного года
 ,SummaV        : array [1..12] of double  // сумма выплат
 ,SummaB        : array [1..12] of double  // база
 ,SummaBDog     : array [1..12] of double  // база по договорам
 ,SummaP        : array [1..12] of double  // сумма превышения
 ,SummaVznStr   : double                   // начислено страховых взносов с базы
 ,sCode         : array [1..3] of string   // строковое значение кода особых условий
 ,SumSpisok1    : array [1..3] of double   // сумма выплат по всем подклассам списка 1 за месяц
 ,SumSpisok2    : array [1..3] of double   // сумма выплат по всем подклассам списка 2 за месяц
)
with index
(
  tp_LS01 = cLschet
 ,tp_LS02 = StrTabN
 ,tp_LS03 = FIO
 ,tp_LS04 = TabN
)
;

table struct tp_SZV_Korr_Sums "Суммы по сотрудникам для отчета СЗВ-Корр"
(
  cLschet        : comp
 ,wMonth         : word
 ,SummaV         : double          // сумма выплат
 ,SummaB         : double          // база
 ,SummaP         : double          // сумма превышения
 ,SummaBDog      : double          // база по договорам
  //взносы
 ,SummaVznStr    : double          // начислено страховых взносов с базы
 ,SumVznStrS     : double          // взносы на страховую пенсию
 ,SumVznStrN     : double          // взносы на накопительную пенсию
 ,SumVznDopT     : double          // общая сумма взносов по доп. тарифу
)
with index
(
  tp_Sums01 = cLschet
 ,tp_Sums02 = wMonth + cLschet
)
;

// "Суммы выплат, на которые начислены страх.взносы по доп.тарифу по сотрудникам для отчета СЗВ-Корр"
table struct tp_SZV_Korr_DopT "Суммы выплат по доп.тарифу"
(
  cLschet        : comp
 ,wMonth         : word
 ,sCode          : string          // строковое значение кода особых условий
 ,SumSpisok1     : double          // общая сумма выплат по всем подклассам списка 1
 ,SumSpisok2     : double          // общая сумма выплат по всем подклассам списка 2
)
with index
(
  tp_DopT01 = cLschet
 ,tp_DopT02 = wMonth + cLschet
)
;

// Сведения о корректировке периодов работы застрахованного лица
table struct tp_SZV_Korr_PenStaj "Корректировка периодов работы ЗЛ"
(
  cLschet        : comp
 ,Uv31_12        : boolean   // признак уволенного 31 декабря
 ,FromDate       : date      // начало периода
 ,ToDate         : date      // конец периода
 ,Terr           : s15       // код терр. условий
 ,doKoef         : double    // районный коэффициент к терр.условиям
 ,Usl            : s15       // код особых условий
 ,KPS            : s15
 ,NotDog         : word      // признак "0 = договор / 1 = не договор"
 // код основания для стажа
 ,Osn            : s15
 ,wMon           : word
 ,wDays          : word
 ,wHours         : word
 ,wMinutes       : word
 ,OsnDop         : s15       // доп.сведения к исчислению страхового стажа
 // код основания для выслуги
 ,Visl           : s15
 ,wMon2          : word
 ,wDays2         : word
 ,wHours2        : word
 ,wMinutes2      : word
 ,wDopV3         : double    // доля ставки
 ,VislDop        : s15       // доп.сведения к выслуге
)
with index
(
  tp_SZV_PenStaj01 = cLschet + FromDate
 ,tp_SZV_PenStaj02 = cLschet + NotDog + FromDate
)
;

table struct tmpStaffStr
(
  nRec           : tnRec,
  Adv            : tnRec,
  Department     : tnRec,
  Post           : tnRec,
  Npp            : integer,
  DepartmentName : string,
  PostName       : string,
  CountPlan      : double,
  CountFact      : double,
  NatureWork     : string,
  Doc            : string,
  Usl            : s15,
  KPS            : s15,
  Visl           : s15,
  Osn            : s15
)
with index
(
  tmpStaffStr01 = Npp (AutoInc),
  tmpStaffStr02 = nRec,
  tmpStaffStr03 = CountFact
);

table struct tmpStrFact
(
  LSchet    : tnRec,
  StaffStr  : tnRec
)
with index
(
  tmpStrFact01 = LSchet + StaffStr,
  tmpStrFact02 = StaffStr
);


//------------------------------------------------------------------------------
//суммы выплат по сотруднику
Type TSumLS = record
cLsch          : comp;
wPrDopTar      : word;
wPrOPS         : array [1..4] of word;
wPrFOMS        : array [1..4] of word;
wPrFSS         : array [1..4] of word;
Prizn          : array [1..12] of word;   // SumUlSoc.Summa2
Proc           : array [1..12] of double; // процент SumUlSoc.Summa3
wTarif         : array [1..12] of word;   // тариф сотрудника
wCatLgot       : array [1..12] of word;   // категория при наличии льготы с причиной
SumV           : array [1..12] of double; // сумма выплат
SumN1          : array [1..12] of double; // н е о б л а г а е м а я сумма
SumN2          : array [1..12] of double; // н е о б л а г а е м а я сумма к вычету
SumP           : array [1..12] of double; // сумма превышения
SumBDog        : array [1..12] of double; // база по договорам
SumVF          : array [1..12] of double; // сумма выплат ФОМС
SumN1F         : array [1..12] of double; // н е о б л а г а е м а я сумма ФОМС
SumN2F         : array [1..12] of double; // н е о б л а г а е м а я сумма к вычету ФОМС
SumVSP1        : array [1..12] of double; // сумма выплат по списку 1
SumVPk4_SP1    : array [1..12] of double; // сумма выплат по подклассу 4
SumVPk34_SP1   : array [1..12] of double; // сумма выплат по подклассу 3.4
SumVPk33_SP1   : array [1..12] of double; // сумма выплат по подклассу 3.3
SumVPk32_SP1   : array [1..12] of double; // сумма выплат по подклассу 3.2
SumVPk31_SP1   : array [1..12] of double; // сумма выплат по подклассу 3.1
SumVSP2        : array [1..12] of double; // сумма выплат по списку 2
SumVPk4_SP2    : array [1..12] of double; // сумма выплат по подклассу 4
SumVPk34_SP2   : array [1..12] of double; // сумма выплат по подклассу 3.4
SumVPk33_SP2   : array [1..12] of double; // сумма выплат по подклассу 3.3
SumVPk32_SP2   : array [1..12] of double; // сумма выплат по подклассу 3.2
SumVPk31_SP2   : array [1..12] of double; // сумма выплат по подклассу 3.1
SumNSP1        : array [1..12] of double; // необл. сумма выплат по списку 1
SumNPk4_SP1    : array [1..12] of double; // необл. сумма выплат по подклассу 4
SumNPk34_SP1   : array [1..12] of double; // необл. сумма выплат по подклассу 3.4
SumNPk33_SP1   : array [1..12] of double; // необл. сумма выплат по подклассу 3.3
SumNPk32_SP1   : array [1..12] of double; // необл. сумма выплат по подклассу 3.2
SumNPk31_SP1   : array [1..12] of double; // необл. сумма выплат по подклассу 3.1
SumNSP2        : array [1..12] of double; // необл. сумма выплат по списку 1
SumNPk4_SP2    : array [1..12] of double; // необл. сумма выплат по подклассу 4
SumNPk34_SP2   : array [1..12] of double; // необл. сумма выплат по подклассу 3.4
SumNPk33_SP2   : array [1..12] of double; // необл. сумма выплат по подклассу 3.3
SumNPk32_SP2   : array [1..12] of double; // необл. сумма выплат по подклассу 3.2
SumNPk31_SP2   : array [1..12] of double; // необл. сумма выплат по подклассу 3.1
//взносы
SumVznStr      : array [1..12] of double; // начислено страховых взносов с базы
SumVznStrP     : array [1..12] of double; // начислено страховых взносов с превышения
SumVznFOMS     : array [1..12] of double; // начислено взносов в Ф О М С
SumVznSp1      : array [1..12] of double; // начислено взносов по списку 1 (без подкласса)
SumVznPk4_SP1  : array [1..12] of double; // начислено взносов по подклассу 4
SumVznPk34_SP1 : array [1..12] of double; // начислено взносов по подклассу 3.4
SumVznPk33_SP1 : array [1..12] of double; // начислено взносов по подклассу 3.3
SumVznPk32_SP1 : array [1..12] of double; // начислено взносов по подклассу 3.2
SumVznPk31_SP1 : array [1..12] of double; // начислено взносов по подклассу 3.1
SumVznSp2      : array [1..12] of double; // начислено взносов по списку 2 (без подкласса)
SumVznPk4_SP2  : array [1..12] of double; // начислено взносов по подклассу 4
SumVznPk34_SP2 : array [1..12] of double; // начислено взносов по подклассу 3.4
SumVznPk33_SP2 : array [1..12] of double; // начислено взносов по подклассу 3.3
SumVznPk32_SP2 : array [1..12] of double; // начислено взносов по подклассу 3.2
SumVznPk31_SP2 : array [1..12] of double; // начислено взносов по подклассу 3.1
end;
//------------------------------------------------------------------------------
#end
