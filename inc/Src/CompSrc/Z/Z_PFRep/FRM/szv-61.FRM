.set name = 'SZV-61'
.hide
.var
 ShortOrLongNameOrg : word;
.endvar
.fields
  wParAdr:word
!----------
  PersonsNumb : integer
  PachNumBegin: LongInt
  AllCounter  : Longint
  RabCounter  : Longint
  Страховой_номер
  TabN
  Должность
  Пол
  Дата_Рождения:date
  Дата_Оформления_пенсии: date
  Наим_Подразд
  Фамилия
  Имя
  ТипСведений :word
  ВидКорректировки :word
  Отчество
  Мес_По_Нетрудоспособ
  Дней_По_Нетрудоспособ
  Мес_По_Отпуску
  Дней_По_Отпуску
!----------
  АдрПрописки_инд

  АдрПрописки_Страна
  АдрПрописки_Страна_сокр

  АдрПрописки_Регион
  АдрПрописки_Регион_сокр

  АдрПрописки_Район
  АдрПрописки_Район_сокр

  АдрПрописки_Город
  АдрПрописки_Город_сокр

  АдрПрописки_НасПункт
  АдрПрописки_НасПункт_сокр

  АдрПрописки_Улица
  АдрПрописки_Улица_сокр

  АдрПрописки_Дом
  АдрПрописки_Дом_сокр

  АдрПрописки_Корпус
  АдрПрописки_Корпус_сокр

  АдрПрописки_Квартира
  АдрПрописки_Квартира_сокр
!----------
 Адрес_бумаж
 Адрес_магнит
 MagnitKvartal:string
 Mes2
 God
 sNamePeriod
 MagnitKvNext
 GodNext
 sNmPeriodNext
 CodeOKPO
 RealInn
 INN
 Pred
 PredShort
 FormofLaw
 KPP
 CodeOGRIP
 CodeOGRUL
 curdate: date
 HP
 НАЕМ

 ИтогоНачисл:double
 ИтогоНетрудосп:double

 ИтогоВзносы_страх_часть:double
 ИтогоВзносы_страх_часть_Упл:double
 ИтогоВзносы_накопит_часть:double
 ИтогоВзносы_накопит_часть_Упл:double
 ИтогоВзносы_доп_часть:double

 Взносы_страх_часть_пач:double
 Взносы_страх_часть_пач_Упл:double
 Взносы_накопит_часть_пач:double
 Взносы_накопит_часть_пач_Упл:double
 Взносы_доп_часть_пач:double

!!!!!!!!!!!!!  страховые взносы    !!!!!!!!!!!!!!!
 Взносы_страх_часть:double
 Взносы_страх_часть_Упл:double
 Взносы_накопит_часть:double
 Взносы_накопит_часть_Упл:double
 Взносы_доп_часть:double

 ФилиалВзносы_страх_часть:double
 ФилиалВзносы_накопит_часть:double
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 KolStag
 Okrug : word
 НомерДоговора
 ДеньЗак
 МесяцЗак
 ГодЗак
 ВидВыплаты

! Поля руководители и дата отчета, для разбивки стажей на несколько страниц
 Dolg_ruk_S
 ФИО_руководителя_S
 Число_S
 Месяц_S
 Год_S
 дат_сост
!72
 .endfields
.begin
  if (not ReadMyDsk(ShortOrLongNameOrg, 'SFOND_ShortOrLongNameOrg', false))
    ShortOrLongNameOrg := 0;
end.
.{ CheckEnter SZV6_1_7
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.fields
  Наим_стажа
  ФИО_сотрудника
  СтрахНомер
  Должность1
  Подразделение
  nppSt
  Нач_стажа
  Кон_стажа

  TerCond
  Район_коэфф

  WorkCond

  Исчисл_труд_стаж_основание
  Исчисл_труд_стаж_доп_свед1
  Исчисл_труд_стаж_доп_свед2
  Строка_Исчисл_труд_стаж_доп_свед1
  Строка_Исчисл_труд_стаж_доп_свед2
  Исчисл_труд_стаж_доп_свед3
  Исчисл_труд_стаж_доп_свед4
  Строка_Исчисл_труд_стаж_доп_свед3
  Строка_Исчисл_труд_стаж_доп_свед4
  Исчисл_труд_стаж_доп_свед_3

!особенности выслуга лет
  Выслуга_лет_основание
  Выслуга_лет_доп_свед1
  Выслуга_лет_доп_свед2
  Строка_Выслуга_лет_доп_свед1
  Строка_Выслуга_лет_доп_свед2
  Выслуга_лет_доп_свед3
  Выслуга_лет_доп_свед4
  Строка_Выслуга_лет_доп_свед3
  Строка_Выслуга_лет_доп_свед4
!новое
  Выслуга_лет_доп_свед_3: double
  Ед_изм_Выслуга_лет_доп_свед3

  Число_записей_лгот   : byte
  Код_позиции_списка1
  Профессия
.endfields
.{ CheckEnter SZV61_Stages_7
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^
.fields
  Код_позиции_списка1С
.endfields
.{ CheckEnter SZV61Vred1_7
  ^
.}
.fields
  Наим_стажа_Lgot
  nppStLgot
  WorkCond_Lgot
!новое
  Исчисл_труд_стаж_основание_Lgot
!
  Исчисл_труд_стаж_доп_свед1_Lgot: word
  Исчисл_труд_стаж_доп_свед2_Lgot: word
  Строка_Исчисл_труд_стаж_доп_свед1_Lgot
  Строка_Исчисл_труд_стаж_доп_свед2_Lgot
  Исчисл_труд_стаж_доп_свед3_Lgot

  Выслуга_лет_основание_Lgot
  Выслуга_лет_доп_свед1_Lgot: word
  Выслуга_лет_доп_свед2_Lgot: word
  Строка_Выслуга_лет_доп_свед1_Lgot
  Строка_Выслуга_лет_доп_свед2_Lgot
  Выслуга_лет_доп_свед3_Lgot: word
  Выслуга_лет_доп_свед4_Lgot: word
  Строка_Выслуга_лет_доп_свед_3_Lgot
  Строка_Выслуга_лет_доп_свед4_Lgot

  Выслуга_лет_доп_свед_3_Lgot: double
  Ед_изм_Выслуга_лет_доп_свед3_Lgot

  TerCond_Lgot
  Район_коэфф_Lgot
!
  Код_позиции_списка2
.endfields
.{ CheckEnter SZV61Lgot_7
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^
.fields
  Код_позиции_списка2С
.endfields
.{ CheckEnter SZV61Vred2_7
  ^
.}
.}
.}
.fields
  Dolg_ruk
  ФИО_руководителя
  Число
  Месяц
  Год
.endfields
  L--+---------------+---------------+--------+-------+---------+------------+-----------+-------------

   Наименование должности руководителя            Подпись                 Расшифровка подписи

   @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                             @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

   Дата "&&" @@@@@@@@ &&&& года                    М.П.
.fields
  ФИО_исполнителя
  тел_исполнителя
  FIO_KP
  Год_Адв61

  КодКатег_АДВ61
  ВзносыСтрх_АДВ61:double
  ВзносыСтрх_АДВ61_Упл:double
  ВзносыНакопит_АДВ61:double
  ВзносыНакопит_АДВ61_Упл:double
  ВзносыДоп_АДВ61:double

  Dolg_ruk_АДВ6
  ФИО_руководителя_АДВ6
  Число_АДВ6
  Месяц_АДВ6
  Год_АДВ6
.endfields
.{ CheckEnter SZV_ADV6_1_7
 ^ ^ ^ ^ ^ ^ ^ ^ ^
 ^ ^ ^ ^ ^ ^
.if DeadLine_61_SZV
.end
.}
.}
.endform

.linkform 'SZV-6-1-7_MAGNITlink17' prototype is 'SZV-61'
.F 'IS_SZV_6-1.XML'
.nameinlist'Файл для ПФ на МН (СЗВ-6-1 в.7.00)'
.group 'SZV'
.var
  EndPach: boolean;
  _ТипСведений,_ВидКорректировки : string;
  rrr,rrr_2,TypeChars: String;
  my_pred, my_pred2    : string[100];
  my_inn     : string[14]
  pach_nmb   : Longint
  nomer      : longint
  MyPersonCounter: LongInt;
  PersonCounterOut: LongInt;
  AdrStr: string;
  StrGod     : string
  kvartal    : string
  my_nach_st : string
  my_kon_st  : string
  KolNach    : LongInt
  NppStrLgot : LongInt
  SumNach    : double
  SumBoln    : double
  RИсчисл_труд_стаж_доп_свед1     : string
  RИсчисл_труд_стаж_доп_свед2     : string
  RИсчисл_труд_стаж_доп_свед3     : string
  RИсчисл_труд_стаж_доп_свед4     : string
  RИсчисл_труд_стаж_доп_свед1_lgot: string
  RИсчисл_труд_стаж_доп_свед2_lgot: string
  RВыслуга_лет_доп_свед_3_lgot     : string
  RВыслуга_лет_доп_свед1          : string
  RВыслуга_лет_доп_свед2          : string
  RВыслуга_лет_доп_свед3          : string
  RВыслуга_лет_доп_свед4          : string
  RВыслуга_лет_доп_свед_3          : string
  RЧисло_записей_лгот             : string
  CodeDopTarr                     : String;
  RDataDog                        : string
.endvar
.begin
  my_inn   := Upcase( Trim( Replace( inn, '"', '''' ) ) )
  my_pred  := Replace( Upcase( Trim( Pred ) ), '"', '&quot;' )
  my_pred2 := Replace( Upcase( Trim( PredShort ) ), '"', '&quot;' )
  pach_nmb:= PachNumBegin
  CodeDopTarr := 'АВИА';
  TypeChars := 'ИСХД'
  nomer   := 0
  KolNach := 0
  SumNach := 0
  SumBoln := 0
  MyPersonCounter := 0;
  PersonCounterOut:= 0;
 end.
.{ CheckEnter SZV6_1_7
.{?internal;(nomer=0)or(nomer = (AllCounter + 1))
.begin
  if (PersonsNumb - MyPersonCounter) >= AllCounter
  {
    MyPersonCounter := MyPersonCounter + AllCounter;
    PersonCounterOut := AllCounter;
  }
  else
    PersonCounterOut := PersonsNumb - MyPersonCounter;

  if nomer=AllCounter then
  {
    pach_nmb:= pach_nmb + 1;
    nomer:= 0;
  }
end.
<?xml version="1.0" encoding="cp866"?>
<ФайлПФР>
  <ИмяФайла></ИмяФайла>
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
#ifdef Gal9_1
       <Версия>9.1</Версия>
#else
       <Версия>8.1</Версия>
#end
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
.begin
 if ВидКорректировки  = 0
 {
   _ТипСведений      := 'ИСХОДНАЯ';
   _ВидКорректировки := '';
 }
 else if ВидКорректировки  = 1
 {
   _ТипСведений      := 'КОРРЕКТИРУЮЩАЯ';
   _ВидКорректировки := 'КОРРЕКТИРУЮЩАЯ';
 }
 else
 {
   _ТипСведений      := 'ОТМЕНЯЮЩАЯ';
   _ВидКорректировки := 'ОТМЕНЯЮЩАЯ';
 }
  if Okrug = 2
  {
    rrr   := '666666666666667.88'
    rrr_2 := '-666666666666667.88'
  }
  else if Okrug = 0
  {
    rrr   :='666666666666667'
    rrr_2 :='-666666666666667'
  }
  EndPach := false;
  nomer := nomer+1;
  AdrStr  := '';
end.
.fields
  nomer
  RealInn
  KPP
  if (ShortOrLongNameOrg <> 0, my_pred, my_pred2)
  my_inn
  pach_nmb
  PersonsNumb
  curdate
.endfields
  <ПачкаВходящихДокументов Окружение = "В составе файла" Стадия = "До обработки">
    <ВХОДЯЩАЯ_ОПИСЬ_ПО_СТРАХОВЫМ_ВЗНОСАМ>
      <НомерВпачке>^</НомерВпачке>
      <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
      <СоставительПачки>
        <НалоговыйНомер>
          <ИНН>^</ИНН>
          <КПП>^</КПП>
        </НалоговыйНомер>
        <НаименованиеКраткое>^</НаименованиеКраткое>
        <РегистрационныйНомер>^</РегистрационныйНомер>
      </СоставительПачки>
      <НомерПачки>
        <Основной>^</Основной>
      </НомерПачки>
      <СоставДокументов>
        <Количество>1</Количество>
        <НаличиеДокументов>
          <ТипДокумента>СВЕДЕНИЯ_О_СТРАХОВЫХ_ВЗНОСАХ_И_СТРАХОВОМ_СТАЖЕ_ЗЛ</ТипДокумента>
          <Количество>^</Количество>
        </НаличиеДокументов>
      </СоставДокументов>
      <ДатаСоставления>^</ДатаСоставления>
.fields
  _ТипСведений
  HP
  MagnitKvartal
  God
  sNamePeriod
  MagnitKvNext
  GodNext
  sNmPeriodNext
  MagnitKvartal
  God
  sNamePeriod
  if (Взносы_страх_часть_пач>=0,DoubleToStr(Взносы_страх_часть_пач,rrr),DoubleToStr(Взносы_страх_часть_пач,rrr_2))
  if (Взносы_страх_часть_пач_Упл>=0,DoubleToStr(Взносы_страх_часть_пач_Упл,rrr),DoubleToStr(Взносы_страх_часть_пач_Упл,rrr_2))
  if (Взносы_накопит_часть_пач>=0,DoubleToStr(Взносы_накопит_часть_пач,rrr),DoubleToStr(Взносы_накопит_часть_пач,rrr_2))
  if (Взносы_накопит_часть_пач_Упл>=0,DoubleToStr(Взносы_накопит_часть_пач_Упл,rrr),DoubleToStr(Взносы_накопит_часть_пач_Упл,rrr_2))
.endfields
      <ТипСведений>^</ТипСведений>
      <КодКатегории>^</КодКатегории>
.{?internal;ВидКорректировки = 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
.}
.{?internal;ВидКорректировки > 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
      <КорректируемыйОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </КорректируемыйОтчетныйПериод>
.}
.{?internal;ВидКорректировки <> 2
      <СуммаВзносовНаСтраховую>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаСтраховую>
      <СуммаВзносовНаНакопительную>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаНакопительную>
.}
    </ВХОДЯЩАЯ_ОПИСЬ_ПО_СТРАХОВЫМ_ВЗНОСАМ>
.}
.begin
 StrGod:= God;

 IF (Word(ДеньЗак)<>0)and(Word(МесяцЗак)<>0)and(Word(ГодЗак)<>0)
  RDataDog:= string(Date(Word(ДеньЗак), Word(МесяцЗак), Word(ГодЗак)))
 else
  RDataDog:=''

  AdrStr := '';
  if trim(АдрПрописки_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';

  nomer := nomer+1;
 end.
.fields
  nomer
  _ТипСведений
  my_inn
  if (ShortOrLongNameOrg <> 0, my_pred, my_pred2)
  RealInn
  KPP
  HP
  MagnitKvartal
  God
  sNamePeriod
  MagnitKvNext
  GodNext
  sNmPeriodNext
  MagnitKvartal
  God
  sNamePeriod
  trim(Страховой_номер)
  trim(UpCase(Фамилия))
  trim(UpCase(Имя))
  trim(UpCase(Отчество))
  AdrStr
  АдрПрописки_инд
.endfields
    <СВЕДЕНИЯ_О_СТРАХОВЫХ_ВЗНОСАХ_И_СТРАХОВОМ_СТАЖЕ_ЗЛ>
      <НомерВпачке>^</НомерВпачке>
      <ВидФормы>СЗВ-6-1</ВидФормы>
      <ТипСведений>^</ТипСведений>
      <РегистрационныйНомер>^</РегистрационныйНомер>
      <НаименованиеКраткое>^</НаименованиеКраткое>
      <НалоговыйНомер>
      <ИНН>^</ИНН>
      <КПП>^</КПП>
      </НалоговыйНомер>
      <КодКатегории>^</КодКатегории>
.{?internal;ВидКорректировки = 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
.}
.{?internal;ВидКорректировки <> 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
      <КорректируемыйОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </КорректируемыйОтчетныйПериод>
.}
      <СтраховойНомер>^</СтраховойНомер>
      <ФИО>
        <Фамилия>^</Фамилия>
        <Имя>^</Имя>
        <Отчество>^</Отчество>
      </ФИО>
.{?internal; ( ВидКорректировки <> 2 and wParAdr = 0 )
      <АдресЗЛ>
          <ТипАдреса>^</ТипАдреса>
          <Индекс>^</Индекс>
.}
.fields

  АдрПрописки_Страна_сокр
  АдрПрописки_Страна
  Адрес_бумаж


  АдрПрописки_Регион
  АдрПрописки_Регион_сокр

  АдрПрописки_Район
  АдрПрописки_Район_сокр

  АдрПрописки_Город
  АдрПрописки_Город_сокр

  АдрПрописки_НасПункт
  АдрПрописки_НасПункт_сокр

  АдрПрописки_Улица
  АдрПрописки_Улица_сокр

  АдрПрописки_Дом_сокр
  АдрПрописки_Дом

  АдрПрописки_Корпус_сокр
  АдрПрописки_Корпус

  АдрПрописки_Квартира_сокр
  UpCase(АдрПрописки_Квартира)
.endfields
.{?internal;( ВидКорректировки <> 2 and wParAdr = 0 )
.{?internal;trim(АдрПрописки_Страна_сокр) <> ''
          <ИностранныйАдрес>
            <КодСтраны>^</КодСтраны>
            <НазваниеСтраны>^</НазваниеСтраны>
            <Адрес>^</Адрес>
          </ИностранныйАдрес>
.}
.{?internal;trim(АдрПрописки_Страна_сокр) = ''
          <РоссийскийАдрес>
          <Регион>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Регион>
          <Район>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Район>
          <Город>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Город>
          <НаселенныйПункт>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </НаселенныйПункт>
          <Улица>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Улица>
          <Дом>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Дом>
          <Корпус>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Корпус>
          <Квартира>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Квартира>
          </РоссийскийАдрес>
.}
      </АдресЗЛ>
.}
.fields
if (Взносы_страх_часть>=0,DoubleToStr(Взносы_страх_часть,rrr),DoubleToStr(Взносы_страх_часть,rrr_2))
if (Взносы_страх_часть_Упл>=0,DoubleToStr(Взносы_страх_часть_Упл,rrr),DoubleToStr(Взносы_страх_часть_Упл,rrr_2))
if (Взносы_накопит_часть>=0,DoubleToStr(Взносы_накопит_часть,rrr),DoubleToStr(Взносы_накопит_часть,rrr_2))
if (Взносы_накопит_часть_Упл>=0,DoubleToStr(Взносы_накопит_часть_Упл,rrr),DoubleToStr(Взносы_накопит_часть_Упл,rrr_2))
curdate
!curdate
.endfields
.{?internal;ВидКорректировки <> 2
      <СуммаВзносовНаСтраховую>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаСтраховую>
      <СуммаВзносовНаНакопительную>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаНакопительную>
.}
      <ДатаЗаполнения>^</ДатаЗаполнения>
!      <ДатаЗаполненияНа>^</ДатаЗаполненияНа>
.fields
!  KolStag
.endfields
.{?internal;ВидКорректировки <> 2
!.{?internal;KolStag > 0
!      <СтажевыйПериод>
!        <Количество>^</Количество>
!.}
.}
.{ CheckEnter SZV61_Stages_7
.{?internal;Trim(Наим_стажа) <> 'АВАНС'
.fields
  nppSt
  my_nach_st
  my_kon_st
  Число_записей_лгот

  UpCase(TerCond)
  DoubleToStr(Double(RВыслуга_лет_доп_свед_3),'666666666666667.88')

  UpCase(WorkCond)
  Код_позиции_списка1

  UpCase(Исчисл_труд_стаж_основание)
  RИсчисл_труд_стаж_доп_свед3
  RИсчисл_труд_стаж_доп_свед4
  RИсчисл_труд_стаж_доп_свед1
  RИсчисл_труд_стаж_доп_свед2
  UpCase(Исчисл_труд_стаж_доп_свед_3)

  UpCase(Выслуга_лет_основание)
  RВыслуга_лет_доп_свед3
  RВыслуга_лет_доп_свед4
  RВыслуга_лет_доп_свед1
  RВыслуга_лет_доп_свед2

!  Ед_изм_Выслуга_лет_доп_свед3_Lgot
  DoubleToStr(Double(RВыслуга_лет_доп_свед_3),'666666666666667.88')
.endfields
.begin
 my_nach_st := Нач_стажа
 my_kon_st  := Кон_стажа
 NppStrLgot := 1;

 IF (Исчисл_труд_стаж_доп_свед1=0) or (trim(Исчисл_труд_стаж_доп_свед1) = '') then
  RИсчисл_труд_стаж_доп_свед1:='0'
 else
  RИсчисл_труд_стаж_доп_свед1:= UpCase(string(Исчисл_труд_стаж_доп_свед1));

 if (Исчисл_труд_стаж_доп_свед2=0)or(trim(Исчисл_труд_стаж_доп_свед2) = '') then
  RИсчисл_труд_стаж_доп_свед2:= '0'
 else
  RИсчисл_труд_стаж_доп_свед2:= UpCase(string(Исчисл_труд_стаж_доп_свед2));

 if (Исчисл_труд_стаж_доп_свед3=0)or(trim(Исчисл_труд_стаж_доп_свед3) = '') then
  RИсчисл_труд_стаж_доп_свед3:= '0'
 else
  RИсчисл_труд_стаж_доп_свед3:= UpCase(string(Исчисл_труд_стаж_доп_свед3));

 if (Исчисл_труд_стаж_доп_свед4=0) or(trim(Исчисл_труд_стаж_доп_свед4)='') then
  RИсчисл_труд_стаж_доп_свед4:= '0'
 else
  RИсчисл_труд_стаж_доп_свед4:= UpCase(string(Исчисл_труд_стаж_доп_свед4));

 if (Выслуга_лет_доп_свед1=0)or(trim(Выслуга_лет_доп_свед1)='') then
  RВыслуга_лет_доп_свед1:= '0'
 else
  RВыслуга_лет_доп_свед1:= UpCase(string(Выслуга_лет_доп_свед1));

 if (Выслуга_лет_доп_свед2=0)or(trim(Выслуга_лет_доп_свед2) ='') then
  RВыслуга_лет_доп_свед2:= '0'
 else
  RВыслуга_лет_доп_свед2:= UpCase(string(Выслуга_лет_доп_свед2));

 if (Выслуга_лет_доп_свед3=0)or(trim(Выслуга_лет_доп_свед3) = '') then
  RВыслуга_лет_доп_свед3:= '0'
 else
  RВыслуга_лет_доп_свед3:= UpCase(string(Выслуга_лет_доп_свед3));

 if (Выслуга_лет_доп_свед4=0)or(trim(Выслуга_лет_доп_свед4) = '') then
  RВыслуга_лет_доп_свед4:= '0'
 else
  RВыслуга_лет_доп_свед4:= UpCase(string(Выслуга_лет_доп_свед4));

 if (Выслуга_лет_доп_свед_3=0) then
  RВыслуга_лет_доп_свед_3:= '0.00'
 else
  RВыслуга_лет_доп_свед_3:= DoubleToStr(Выслуга_лет_доп_свед_3,'66666.99');

 IF (Число_записей_лгот=0) or (trim(Число_записей_лгот) = '') then
   RЧисло_записей_лгот:= '0'
 else
   RЧисло_записей_лгот:= string(Число_записей_лгот);
end.
.{?internal;ВидКорректировки <> 2
        <СтажевыйПериод>
            <НомерСтроки>^</НомерСтроки>
            <ДатаНачалаПериода>^</ДатаНачалаПериода>
            <ДатаКонцаПериода>^</ДатаКонцаПериода>
.{?internal; (TerCond<>'') or (WorkCond<>'') or (Код_позиции_списка1<>'') or (Исчисл_труд_стаж_основание<>'') or (Исчисл_труд_стаж_доп_свед_3<>'') or (Выслуга_лет_основание<>'')
            <КоличествоЛьготныхСоставляющих>^</КоличествоЛьготныхСоставляющих>
            <ЛьготныйСтаж>
            <НомерСтроки>1</НомерСтроки>
            <ОсобенностиУчета>
              <ТерриториальныеУсловия>
                <ОснованиеТУ>^</ОснованиеТУ>
.{?internal; ( TerCond<>''and Выслуга_лет_доп_свед_3 > 0 and Выслуга_лет_доп_свед_3 < 1 )
                <Коэффициент>^</Коэффициент>
.}
              </ТерриториальныеУсловия>
              <ОсобыеУсловияТруда>
                <ОснованиеОУТ>^</ОснованиеОУТ>
                <ПозицияСписка>^</ПозицияСписка>
              </ОсобыеУсловияТруда>
              <ИсчисляемыйСтаж>
                <ОснованиеИС>^</ОснованиеИС>
.{?internal; (RИсчисл_труд_стаж_доп_свед3 <> 0) or (RИсчисл_труд_стаж_доп_свед4 <> 0)
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; (RИсчисл_труд_стаж_доп_свед1 <> 0) or (RИсчисл_труд_стаж_доп_свед2 <> 0)
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
              </ИсчисляемыйСтаж>
              <ДекретДети>^</ДекретДети>
              <ВыслугаЛет>
                <ОснованиеВЛ>^</ОснованиеВЛ>
.{?internal; (RВыслуга_лет_доп_свед3 <> '0') or (RВыслуга_лет_доп_свед4 <> '0')
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; (RВыслуга_лет_доп_свед1 <> '0') or (RВыслуга_лет_доп_свед2 <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
.{?internal; ( TerCond = '' or Выслуга_лет_доп_свед_3 = 0 or Выслуга_лет_доп_свед_3 >= 1 )
                <ДоляСтавки>^</ДоляСтавки>
.}
              </ВыслугаЛет>
            </ОсобенностиУчета>
            </ЛьготныйСтаж>
.}
!       </СтажевыйПериод>
.}
.}
.{ CheckEnter SZV61Vred1_7
.}
.{ CheckEnter SZV61Lgot_7
.begin
 NppStrLgot := NppStrLgot + 1;
 if  (Исчисл_труд_стаж_доп_свед1_Lgot=0)or(trim(Исчисл_труд_стаж_доп_свед1_Lgot) = '') then
  RИсчисл_труд_стаж_доп_свед1_Lgot:= '0'
 else
  RИсчисл_труд_стаж_доп_свед1_Lgot:= UpCase(string(Исчисл_труд_стаж_доп_свед1_Lgot))
 if  (Исчисл_труд_стаж_доп_свед2_Lgot=0) or (trim(Исчисл_труд_стаж_доп_свед2_Lgot) = '') then
  RИсчисл_труд_стаж_доп_свед2_Lgot:= '0'
 else
  RИсчисл_труд_стаж_доп_свед2_Lgot:= UpCase(string(Исчисл_труд_стаж_доп_свед2_Lgot))

 if  (Выслуга_лет_доп_свед_3_lgot=0) //or(trim(Выслуга_лет_доп_свед_3_lgot) = '') then
  RВыслуга_лет_доп_свед_3_lgot:= '0.00'
 else
  RВыслуга_лет_доп_свед_3_lgot:= DoubleToStr(Выслуга_лет_доп_свед_3_lgot,'66667.99');
 end.
.{?internal;Trim(Наим_стажа) <> 'АВАНС'
.fields
!  nppStLgot
  NppStrLgot
  UpCase(TerCond_Lgot)
  UpCase(WorkCond_Lgot)
  Код_позиции_списка2
  UpCase(Исчисл_труд_стаж_основание_Lgot)
  if( trim(RИсчисл_труд_стаж_доп_свед1_Lgot) <> '',RИсчисл_труд_стаж_доп_свед1_Lgot, 0 )
  if( trim(RИсчисл_труд_стаж_доп_свед2_Lgot) <> '',RИсчисл_труд_стаж_доп_свед2_Lgot, 0 )

  UpCase(Исчисл_труд_стаж_доп_свед3_Lgot)

  UpCase(Выслуга_лет_основание_Lgot)
  if( trim(Выслуга_лет_доп_свед3_Lgot) <> '',Выслуга_лет_доп_свед3_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед4_Lgot) <> '',Выслуга_лет_доп_свед4_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед1_Lgot) <> '',Выслуга_лет_доп_свед1_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед2_Lgot) <> '',Выслуга_лет_доп_свед2_Lgot, 0 )


!  DoubleToStr(Double(RВыслуга_лет_доп_свед_3_Lgot),'666666666666667.88')
!  Выслуга_лет_доп_свед_3_Lgot

  Ед_изм_Выслуга_лет_доп_свед3_Lgot

.endfields
.{?internal;ВидКорректировки <> 2
!          <ДополнительныеСтроки>
!           <Количество>^</Количество>
.{?internal; (TerCond_Lgot<>'') or (WorkCond_Lgot<>'') or (Код_позиции_списка2<>'') or (Исчисл_труд_стаж_основание_Lgot<>'') or (Исчисл_труд_стаж_доп_свед3_Lgot<>'') or (Выслуга_лет_основание_Lgot<>'')
            <ЛьготныйСтаж>
            <НомерСтроки>^</НомерСтроки>
            <ОсобенностиУчета>
              <ТерриториальныеУсловия>
                <ОснованиеТУ>^</ОснованиеТУ>
              </ТерриториальныеУсловия>
              <ОсобыеУсловияТруда>
                <ОснованиеОУТ>^</ОснованиеОУТ>
                <ПозицияСписка>^</ПозицияСписка>
              </ОсобыеУсловияТруда>
              <ИсчисляемыйСтаж>
                <ОснованиеИС>^</ОснованиеИС>
.{?internal; (RИсчисл_труд_стаж_доп_свед1_Lgot <> '0') or (RИсчисл_труд_стаж_доп_свед2_Lgot <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
              </ИсчисляемыйСтаж>
              <ДекретДети>^</ДекретДети>
              <ВыслугаЛет>
                <ОснованиеВЛ>^</ОснованиеВЛ>
.{?internal; ( Выслуга_лет_доп_свед3_Lgot <> '0') or ( Выслуга_лет_доп_свед4_Lgot <> '0')
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; ( Выслуга_лет_доп_свед1_Lgot <> '0') or ( Выслуга_лет_доп_свед2_Lgot <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
!                <КодИсчисления>^</КодИсчисления>
.{?internal; (Ед_изм_Выслуга_лет_доп_свед3_Lgot <> '')
                <ДоляСтавки>^</ДоляСтавки>
.}
              </ВыслугаЛет>
!              <ПрофессияДолжность></ПрофессияДолжность>
!              <ОтметкаОценщика></ОтметкаОценщика>
            </ОсобенностиУчета>
            </ЛьготныйСтаж>
.}
!          </ДополнительныеСтроки>
.}
.}
.{ CheckEnter SZV61Vred2_7
.}
.} //CheckEnter Lgot
.{?internal;ВидКорректировки <> 2
!.{?internal;KolStag > 0
      </СтажевыйПериод>
!.}
.}
.} //стаж
    </СВЕДЕНИЯ_О_СТРАХОВЫХ_ВЗНОСАХ_И_СТРАХОВОМ_СТАЖЕ_ЗЛ>
.{ CheckEnter SZV_ADV6_1_7
.if DeadLine_61_SZV
.begin
  EndPach := true;
end.
.fields
   pach_nmb
.endfields
  </ПачкаВходящихДокументов>
</ФайлПФР>
___КОНЕЦ ^ ПАЧКИ!!!_Разрежьте_здесь!
.end
.begin
  pach_nmb:= pach_nmb + 1;
  nomer:= 0;
end.
.{?internal;not EndPach
  </ПачкаВходящихДокументов>
</ФайлПФР>
.}
.}
.}
.endform

.linkform 'SPV-1_7_MAGNITlink17' prototype is 'SZV-61'
.F 'IS_SPV-1.XML'
.nameinlist'Файл для ПФ на МН (СПВ-1 в.7.00)'
.group 'SPV'
.var
  EndPach: boolean;
  _ТипСведений,_ВидКорректировки : string;
  rrr,rrr_2,TypeChars: String;
  my_pred, my_pred2    : string[100];
  my_inn     : string[14]
  pach_nmb   : Longint
  nomer      : longint
  MyPersonCounter: LongInt;
  PersonCounterOut: LongInt;
  AdrStr: string;
  StrGod     : string
  kvartal    : string
  my_nach_st : string
  my_kon_st  : string
  KolNach    : LongInt
  NppStrLgot : LongInt
  SumNach    : double
  SumBoln    : double
  RИсчисл_труд_стаж_доп_свед1     : string
  RИсчисл_труд_стаж_доп_свед2     : string
  RИсчисл_труд_стаж_доп_свед3     : string
  RИсчисл_труд_стаж_доп_свед4     : string
  RИсчисл_труд_стаж_доп_свед1_lgot: string
  RИсчисл_труд_стаж_доп_свед2_lgot: string
  RВыслуга_лет_доп_свед_3_lgot     : string
  RВыслуга_лет_доп_свед1          : string
  RВыслуга_лет_доп_свед2          : string
  RВыслуга_лет_доп_свед3          : string
  RВыслуга_лет_доп_свед4          : string
  RВыслуга_лет_доп_свед_3          : string
  RЧисло_записей_лгот             : string
  CodeDopTarr                     : String;
  RDataDog                        : string
.endvar
.begin
  my_inn   := Upcase( Trim( Replace( inn, '"', '''' ) ) )
  my_pred  := Replace( Upcase( Trim( Pred ) ), '"', '&quot;' )
  my_pred2 := Replace( Upcase( Trim( PredShort ) ), '"', '&quot;' )
  pach_nmb:= PachNumBegin
  CodeDopTarr := 'АВИА';
  TypeChars := 'ИСХД'
  nomer   := 0
  KolNach := 0
  SumNach := 0
  SumBoln := 0
  MyPersonCounter := 0;
  PersonCounterOut:= 0;
 end.
.{ CheckEnter SZV6_1_7
.{?internal;(nomer=0)or(nomer = (AllCounter + 1))
.begin
  if (PersonsNumb - MyPersonCounter) >= AllCounter
  {
    MyPersonCounter := MyPersonCounter + AllCounter;
    PersonCounterOut := AllCounter;
  }
  else
    PersonCounterOut := PersonsNumb - MyPersonCounter;

  if nomer=AllCounter then
  {
    pach_nmb:= pach_nmb + 1;
    nomer:= 0;
  }
end.
<?xml version="1.0" encoding="cp866"?>
<ФайлПФР>
  <ИмяФайла></ИмяФайла>
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
#ifdef Gal9_1
       <Версия>9.1</Версия>
#else
       <Версия>8.1</Версия>
#end
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
.begin
 if ВидКорректировки  = 0
 {
   _ТипСведений      := 'ИСХОДНАЯ';
   _ВидКорректировки := '';
 }
 else if ВидКорректировки  = 1
 {
   _ТипСведений      := 'КОРРЕКТИРУЮЩАЯ';
   _ВидКорректировки := 'КОРРЕКТИРУЮЩАЯ';
 }
 else
 {
   _ТипСведений      := 'ОТМЕНЯЮЩАЯ';
   _ВидКорректировки := 'ОТМЕНЯЮЩАЯ';
 }
  if Okrug = 2
  {
    rrr   := '666666666666667.88'
    rrr_2 := '-666666666666667.88'
  }
  else if Okrug = 0
  {
    rrr   :='666666666666667'
    rrr_2 :='-666666666666667'
  }
  EndPach := false;
  nomer := nomer+1;
  AdrStr  := '';
end.
.fields
  nomer
  RealInn
  KPP
  if (ShortOrLongNameOrg <> 0, my_pred, my_pred2)
  my_inn
  pach_nmb
  PersonsNumb
  curdate
.endfields
  <ПачкаВходящихДокументов Окружение = "В составе файла" Стадия = "До обработки">
    <ВХОДЯЩАЯ_ОПИСЬ_ПО_СТРАХОВЫМ_ВЗНОСАМ>
      <НомерВпачке>^</НомерВпачке>
      <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
      <СоставительПачки>
        <НалоговыйНомер>
          <ИНН>^</ИНН>
          <КПП>^</КПП>
        </НалоговыйНомер>
        <НаименованиеКраткое>^</НаименованиеКраткое>
        <РегистрационныйНомер>^</РегистрационныйНомер>
      </СоставительПачки>
      <НомерПачки>
        <Основной>^</Основной>
      </НомерПачки>
      <СоставДокументов>
        <Количество>1</Количество>
        <НаличиеДокументов>
          <ТипДокумента>СВЕДЕНИЯ_О_СТРАХОВЫХ_ВЗНОСАХ_И_СТРАХОВОМ_СТАЖЕ_ЗЛ</ТипДокумента>
          <Количество>^</Количество>
        </НаличиеДокументов>
      </СоставДокументов>
      <ДатаСоставления>^</ДатаСоставления>
.fields
  _ТипСведений
  HP
  MagnitKvartal
  God
  sNamePeriod
  MagnitKvNext
  GodNext
  sNmPeriodNext
  MagnitKvartal
  God
  sNamePeriod
  if (Взносы_страх_часть_пач>=0,DoubleToStr(Взносы_страх_часть_пач,rrr),DoubleToStr(Взносы_страх_часть_пач,rrr_2))
  if (Взносы_страх_часть_пач_Упл>=0,DoubleToStr(Взносы_страх_часть_пач_Упл,rrr),DoubleToStr(Взносы_страх_часть_пач_Упл,rrr_2))
  if (Взносы_накопит_часть_пач>=0,DoubleToStr(Взносы_накопит_часть_пач,rrr),DoubleToStr(Взносы_накопит_часть_пач,rrr_2))
  if (Взносы_накопит_часть_пач_Упл>=0,DoubleToStr(Взносы_накопит_часть_пач_Упл,rrr),DoubleToStr(Взносы_накопит_часть_пач_Упл,rrr_2))
.endfields
      <ТипСведений>^</ТипСведений>
      <КодКатегории>^</КодКатегории>
.{?internal;ВидКорректировки = 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
.}
.{?internal; ВидКорректировки > 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
      <КорректируемыйОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </КорректируемыйОтчетныйПериод>
.}
.{?internal; ВидКорректировки <> 2
      <СуммаВзносовНаСтраховую>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаСтраховую>
      <СуммаВзносовНаНакопительную>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаНакопительную>
.}
    </ВХОДЯЩАЯ_ОПИСЬ_ПО_СТРАХОВЫМ_ВЗНОСАМ>
.}
.begin
 StrGod:= God;

 IF (Word(ДеньЗак)<>0)and(Word(МесяцЗак)<>0)and(Word(ГодЗак)<>0)
  RDataDog:= string(Date(Word(ДеньЗак), Word(МесяцЗак), Word(ГодЗак)))
 else
  RDataDog:=''

  AdrStr := '';
  if trim(АдрПрописки_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';

  nomer := nomer+1;
 end.
.fields
  nomer
  _ТипСведений
  my_inn
  if (ShortOrLongNameOrg <> 0, my_pred, my_pred2)
  RealInn
  KPP
  HP
  MagnitKvartal
  God
  sNamePeriod
  MagnitKvartal
  God
  sNamePeriod
  trim(Страховой_номер)
  trim(UpCase(Фамилия))
  trim(UpCase(Имя))
  trim(UpCase(Отчество))
.endfields
    <СВЕДЕНИЯ_О_СТРАХОВЫХ_ВЗНОСАХ_И_СТРАХОВОМ_СТАЖЕ_ЗЛ>
      <НомерВпачке>^</НомерВпачке>
      <ВидФормы>СПВ-1</ВидФормы>
      <ТипСведений>^</ТипСведений>
      <РегистрационныйНомер>^</РегистрационныйНомер>
      <НаименованиеКраткое>^</НаименованиеКраткое>
      <НалоговыйНомер>
      <ИНН>^</ИНН>
      <КПП>^</КПП>
      </НалоговыйНомер>
      <КодКатегории>^</КодКатегории>
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
.{?internal;ВидКорректировки = 10
      <КорректируемыйОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </КорректируемыйОтчетныйПериод>
.}
      <СтраховойНомер>^</СтраховойНомер>
      <ФИО>
        <Фамилия>^</Фамилия>
        <Имя>^</Имя>
        <Отчество>^</Отчество>
      </ФИО>
.fields
if (Взносы_страх_часть>=0,DoubleToStr(Взносы_страх_часть,rrr),DoubleToStr(Взносы_страх_часть,rrr_2))
if (Взносы_страх_часть_Упл>=0,DoubleToStr(Взносы_страх_часть_Упл,rrr),DoubleToStr(Взносы_страх_часть_Упл,rrr_2))
if (Взносы_накопит_часть>=0,DoubleToStr(Взносы_накопит_часть,rrr),DoubleToStr(Взносы_накопит_часть,rrr_2))
if (Взносы_накопит_часть_Упл>=0,DoubleToStr(Взносы_накопит_часть_Упл,rrr),DoubleToStr(Взносы_накопит_часть_Упл,rrr_2))
curdate
Дата_Оформления_пенсии
.endfields
.{?internal; ВидКорректировки <> 2
      <СуммаВзносовНаСтраховую>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаСтраховую>
      <СуммаВзносовНаНакопительную>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаНакопительную>
.}
      <ДатаЗаполнения>^</ДатаЗаполнения>
      <ДатаСоставленияНа>^</ДатаСоставленияНа>
.fields
!  KolStag
.endfields
.{?internal;ВидКорректировки <> 2
!.{?internal;KolStag > 0
!      <СтажевыйПериод>
!        <Количество>^</Количество>
!.}
.}
.{ CheckEnter SZV61_Stages_7
.{?internal;Trim(Наим_стажа) <> 'АВАНС'
.fields
  nppSt
  my_nach_st
  my_kon_st
  Число_записей_лгот

  UpCase(TerCond)
  DoubleToStr(Double(RВыслуга_лет_доп_свед_3),'666666666666667.88')

  UpCase(WorkCond)
  Код_позиции_списка1

  UpCase(Исчисл_труд_стаж_основание)
  RИсчисл_труд_стаж_доп_свед3
  RИсчисл_труд_стаж_доп_свед4
  RИсчисл_труд_стаж_доп_свед1
  RИсчисл_труд_стаж_доп_свед2
  UpCase(Исчисл_труд_стаж_доп_свед_3)

  UpCase(Выслуга_лет_основание)
  RВыслуга_лет_доп_свед3
  RВыслуга_лет_доп_свед4
  RВыслуга_лет_доп_свед1
  RВыслуга_лет_доп_свед2

!  Ед_изм_Выслуга_лет_доп_свед3_Lgot
  DoubleToStr(Double(RВыслуга_лет_доп_свед_3),'666666666666667.88')
.endfields
.begin
 my_nach_st := Нач_стажа
 my_kon_st  := Кон_стажа
 NppStrLgot := 1;

 IF (Исчисл_труд_стаж_доп_свед1=0) or (trim(Исчисл_труд_стаж_доп_свед1) = '') then
  RИсчисл_труд_стаж_доп_свед1:='0'
 else
  RИсчисл_труд_стаж_доп_свед1:= UpCase(string(Исчисл_труд_стаж_доп_свед1));

 if (Исчисл_труд_стаж_доп_свед2=0)or(trim(Исчисл_труд_стаж_доп_свед2) = '') then
  RИсчисл_труд_стаж_доп_свед2:= '0'
 else
  RИсчисл_труд_стаж_доп_свед2:= UpCase(string(Исчисл_труд_стаж_доп_свед2));

 if (Исчисл_труд_стаж_доп_свед3=0)or(trim(Исчисл_труд_стаж_доп_свед3) = '') then
  RИсчисл_труд_стаж_доп_свед3:= '0'
 else
  RИсчисл_труд_стаж_доп_свед3:= UpCase(string(Исчисл_труд_стаж_доп_свед3));

 if (Исчисл_труд_стаж_доп_свед4=0) or(trim(Исчисл_труд_стаж_доп_свед4)='') then
  RИсчисл_труд_стаж_доп_свед4:= '0'
 else
  RИсчисл_труд_стаж_доп_свед4:= UpCase(string(Исчисл_труд_стаж_доп_свед4));

 if (Выслуга_лет_доп_свед1=0)or(trim(Выслуга_лет_доп_свед1)='') then
  RВыслуга_лет_доп_свед1:= '0'
 else
  RВыслуга_лет_доп_свед1:= UpCase(string(Выслуга_лет_доп_свед1));

 if (Выслуга_лет_доп_свед2=0)or(trim(Выслуга_лет_доп_свед2) ='') then
  RВыслуга_лет_доп_свед2:= '0'
 else
  RВыслуга_лет_доп_свед2:= UpCase(string(Выслуга_лет_доп_свед2));

 if (Выслуга_лет_доп_свед3=0)or(trim(Выслуга_лет_доп_свед3) = '') then
  RВыслуга_лет_доп_свед3:= '0'
 else
  RВыслуга_лет_доп_свед3:= UpCase(string(Выслуга_лет_доп_свед3));

 if (Выслуга_лет_доп_свед4=0)or(trim(Выслуга_лет_доп_свед4) = '') then
  RВыслуга_лет_доп_свед4:= '0'
 else
  RВыслуга_лет_доп_свед4:= UpCase(string(Выслуга_лет_доп_свед4));

 if (Выслуга_лет_доп_свед_3=0) then
  RВыслуга_лет_доп_свед_3:= '0.00'
 else
  RВыслуга_лет_доп_свед_3:= DoubleToStr(Выслуга_лет_доп_свед_3,'66666.99');

 IF (Число_записей_лгот=0) or (trim(Число_записей_лгот) = '') then
   RЧисло_записей_лгот:= '0'
 else
   RЧисло_записей_лгот:= string(Число_записей_лгот);
end.
.{?internal;ВидКорректировки <> 2
        <СтажевыйПериод>
            <НомерСтроки>^</НомерСтроки>
            <ДатаНачалаПериода>^</ДатаНачалаПериода>
            <ДатаКонцаПериода>^</ДатаКонцаПериода>
.{?internal; (TerCond<>'') or (WorkCond<>'') or (Код_позиции_списка1<>'') or (Исчисл_труд_стаж_основание<>'') or (Исчисл_труд_стаж_доп_свед_3<>'') or (Выслуга_лет_основание<>'')
            <КоличествоЛьготныхСоставляющих>^</КоличествоЛьготныхСоставляющих>
            <ЛьготныйСтаж>
            <НомерСтроки>1</НомерСтроки>
            <ОсобенностиУчета>
              <ТерриториальныеУсловия>
                <ОснованиеТУ>^</ОснованиеТУ>
.{?internal; ( TerCond<>''and Выслуга_лет_доп_свед_3 > 0 and Выслуга_лет_доп_свед_3 < 1 )
                <Коэффициент>^</Коэффициент>
.}
              </ТерриториальныеУсловия>
              <ОсобыеУсловияТруда>
                <ОснованиеОУТ>^</ОснованиеОУТ>
                <ПозицияСписка>^</ПозицияСписка>
              </ОсобыеУсловияТруда>
              <ИсчисляемыйСтаж>
                <ОснованиеИС>^</ОснованиеИС>
.{?internal; (RИсчисл_труд_стаж_доп_свед3 <> 0) or (RИсчисл_труд_стаж_доп_свед4 <> 0)
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; (RИсчисл_труд_стаж_доп_свед1 <> 0) or (RИсчисл_труд_стаж_доп_свед2 <> 0)
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
              </ИсчисляемыйСтаж>
              <ДекретДети>^</ДекретДети>
              <ВыслугаЛет>
                <ОснованиеВЛ>^</ОснованиеВЛ>
.{?internal; (RВыслуга_лет_доп_свед3 <> '0') or (RВыслуга_лет_доп_свед4 <> '0')
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; (RВыслуга_лет_доп_свед1 <> '0') or (RВыслуга_лет_доп_свед2 <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
.{?internal; ( TerCond = '' or Выслуга_лет_доп_свед_3 = 0 or Выслуга_лет_доп_свед_3 >= 1 )
                <ДоляСтавки>^</ДоляСтавки>
.}
              </ВыслугаЛет>
            </ОсобенностиУчета>
            </ЛьготныйСтаж>
.}
!       </СтажевыйПериод>
.}
.}
.{ CheckEnter SZV61Vred1_7
.}
.{ CheckEnter SZV61Lgot_7
.begin
 NppStrLgot := NppStrLgot + 1;
 if  (Исчисл_труд_стаж_доп_свед1_Lgot=0)or(trim(Исчисл_труд_стаж_доп_свед1_Lgot) = '') then
  RИсчисл_труд_стаж_доп_свед1_Lgot:= '0'
 else
  RИсчисл_труд_стаж_доп_свед1_Lgot:= UpCase(string(Исчисл_труд_стаж_доп_свед1_Lgot))
 if  (Исчисл_труд_стаж_доп_свед2_Lgot=0) or (trim(Исчисл_труд_стаж_доп_свед2_Lgot) = '') then
  RИсчисл_труд_стаж_доп_свед2_Lgot:= '0'
 else
  RИсчисл_труд_стаж_доп_свед2_Lgot:= UpCase(string(Исчисл_труд_стаж_доп_свед2_Lgot))

 if  (Выслуга_лет_доп_свед_3_lgot=0) //or(trim(Выслуга_лет_доп_свед_3_lgot) = '') then
  RВыслуга_лет_доп_свед_3_lgot:= '0.00'
 else
  RВыслуга_лет_доп_свед_3_lgot:= DoubleToStr(Выслуга_лет_доп_свед_3_lgot,'66667.99');
 end.
.{?internal;Trim(Наим_стажа) <> 'АВАНС'
.fields
!  nppStLgot
  NppStrLgot
  UpCase(TerCond_Lgot)
  UpCase(WorkCond_Lgot)
  Код_позиции_списка2
  UpCase(Исчисл_труд_стаж_основание_Lgot)
  if( trim(RИсчисл_труд_стаж_доп_свед1_Lgot) <> '',RИсчисл_труд_стаж_доп_свед1_Lgot, 0 )
  if( trim(RИсчисл_труд_стаж_доп_свед2_Lgot) <> '',RИсчисл_труд_стаж_доп_свед2_Lgot, 0 )

  UpCase(Исчисл_труд_стаж_доп_свед3_Lgot)

  UpCase(Выслуга_лет_основание_Lgot)
  if( trim(Выслуга_лет_доп_свед3_Lgot) <> '',Выслуга_лет_доп_свед3_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед4_Lgot) <> '',Выслуга_лет_доп_свед4_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед1_Lgot) <> '',Выслуга_лет_доп_свед1_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед2_Lgot) <> '',Выслуга_лет_доп_свед2_Lgot, 0 )


!  DoubleToStr(Double(RВыслуга_лет_доп_свед_3_Lgot),'666666666666667.88')
!  Выслуга_лет_доп_свед_3_Lgot

  Ед_изм_Выслуга_лет_доп_свед3_Lgot

.endfields
.{?internal;ВидКорректировки <> 2
!          <ДополнительныеСтроки>
!           <Количество>^</Количество>
.{?internal; (TerCond_Lgot<>'') or (WorkCond_Lgot<>'') or (Код_позиции_списка2<>'') or (Исчисл_труд_стаж_основание_Lgot<>'') or (Исчисл_труд_стаж_доп_свед3_Lgot<>'') or (Выслуга_лет_основание_Lgot<>'')
            <ЛьготныйСтаж>
            <НомерСтроки>^</НомерСтроки>
            <ОсобенностиУчета>
              <ТерриториальныеУсловия>
                <ОснованиеТУ>^</ОснованиеТУ>
              </ТерриториальныеУсловия>
              <ОсобыеУсловияТруда>
                <ОснованиеОУТ>^</ОснованиеОУТ>
                <ПозицияСписка>^</ПозицияСписка>
              </ОсобыеУсловияТруда>
              <ИсчисляемыйСтаж>
                <ОснованиеИС>^</ОснованиеИС>
.{?internal; (RИсчисл_труд_стаж_доп_свед1_Lgot <> '0') or (RИсчисл_труд_стаж_доп_свед2_Lgot <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
              </ИсчисляемыйСтаж>
              <ДекретДети>^</ДекретДети>
              <ВыслугаЛет>
                <ОснованиеВЛ>^</ОснованиеВЛ>
.{?internal; ( Выслуга_лет_доп_свед3_Lgot <> '0') or ( Выслуга_лет_доп_свед4_Lgot <> '0')
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; ( Выслуга_лет_доп_свед1_Lgot <> '0') or ( Выслуга_лет_доп_свед2_Lgot <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
!                <КодИсчисления>^</КодИсчисления>
.{?internal; (Ед_изм_Выслуга_лет_доп_свед3_Lgot <> '')
                <ДоляСтавки>^</ДоляСтавки>
.}
              </ВыслугаЛет>
!              <ПрофессияДолжность></ПрофессияДолжность>
!              <ОтметкаОценщика></ОтметкаОценщика>
            </ОсобенностиУчета>
            </ЛьготныйСтаж>
.}
!          </ДополнительныеСтроки>
.}
.}
.{ CheckEnter SZV61Vred2_7
.}
.} //CheckEnter Lgot
.{?internal;ВидКорректировки <> 2
!.{?internal;KolStag > 0
      </СтажевыйПериод>
!.}
.}
.} //стаж
    </СВЕДЕНИЯ_О_СТРАХОВЫХ_ВЗНОСАХ_И_СТРАХОВОМ_СТАЖЕ_ЗЛ>
.{ CheckEnter SZV_ADV6_1_7
.if DeadLine_61_SZV
.begin
  EndPach := true;
end.
.fields
   pach_nmb
.endfields
  </ПачкаВходящихДокументов>
</ФайлПФР>
___КОНЕЦ ^ ПАЧКИ!!!_Разрежьте_здесь!
.end
.begin
  pach_nmb:= pach_nmb + 1;
  nomer:= 0;
end.
.{?internal;not EndPach
  </ПачкаВходящихДокументов>
</ФайлПФР>
.}
.}
.}
.endform
.linkform 'SPV-1-2_7_MAGNITlink17' prototype is 'SZV-61'
.F 'IS_SPV-1-2.XML'
.nameinlist'Файл для ПФ на МН (СПВ-1-2 в.7.00)'
.group 'SPV-1-2'
.var
  EndPach: boolean;
  _ТипСведений,_ВидКорректировки : string;
  rrr,rrr_2,TypeChars: String;
  my_pred, my_pred2    : string[100];
  my_inn     : string[14]
  pach_nmb   : Longint
  nomer      : longint
  MyPersonCounter: LongInt;
  PersonCounterOut: LongInt;
  AdrStr: string;
  StrGod     : string
  kvartal    : string
  my_nach_st : string
  my_kon_st  : string
  KolNach    : LongInt
  NppStrLgot : LongInt
  SumNach    : double
  SumBoln    : double
  RИсчисл_труд_стаж_доп_свед1     : string
  RИсчисл_труд_стаж_доп_свед2     : string
  RИсчисл_труд_стаж_доп_свед3     : string
  RИсчисл_труд_стаж_доп_свед4     : string
  RИсчисл_труд_стаж_доп_свед1_lgot: string
  RИсчисл_труд_стаж_доп_свед2_lgot: string
  RВыслуга_лет_доп_свед_3_lgot     : string
  RВыслуга_лет_доп_свед1          : string
  RВыслуга_лет_доп_свед2          : string
  RВыслуга_лет_доп_свед3          : string
  RВыслуга_лет_доп_свед4          : string
  RВыслуга_лет_доп_свед_3          : string
  RЧисло_записей_лгот             : string
  CodeDopTarr                     : String;
  RDataDog                        : string
.endvar
.begin
  my_inn   := Upcase( Trim( Replace( inn, '"', '''' ) ) )
  my_pred  := Replace( Upcase( Trim( Pred ) ), '"', '&quot;' )
  my_pred2 := Replace( Upcase( Trim( PredShort ) ), '"', '&quot;' )
  pach_nmb:= PachNumBegin
  CodeDopTarr := 'АВИА';
  TypeChars := 'ИСХД'
  nomer   := 0
  KolNach := 0
  SumNach := 0
  SumBoln := 0
  MyPersonCounter := 0;
  PersonCounterOut:= 0;
 end.
.{ CheckEnter SZV6_1_7
.{?internal;(nomer=0)or(nomer = (AllCounter + 1))
.begin
  if (PersonsNumb - MyPersonCounter) >= AllCounter
  {
    MyPersonCounter := MyPersonCounter + AllCounter;
    PersonCounterOut := AllCounter;
  }
  else
    PersonCounterOut := PersonsNumb - MyPersonCounter;

  if nomer=AllCounter then
  {
    pach_nmb:= pach_nmb + 1;
    nomer:= 0;
  }
end.
<?xml version="1.0" encoding="cp866"?>
<ФайлПФР>
  <ИмяФайла></ИмяФайла>
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
#ifdef Gal9_1
       <Версия>9.1</Версия>
#else
       <Версия>8.1</Версия>
#end
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
.begin
 if ВидКорректировки  = 0
 {
   _ТипСведений      := 'ИСХОДНАЯ';
   _ВидКорректировки := '';
 }
 else if ВидКорректировки  = 1
 {
   _ТипСведений      := 'КОРРЕКТИРУЮЩАЯ';
   _ВидКорректировки := 'КОРРЕКТИРУЮЩАЯ';
 }
 else
 {
   _ТипСведений      := 'ОТМЕНЯЮЩАЯ';
   _ВидКорректировки := 'ОТМЕНЯЮЩАЯ';
 }

  if Okrug = 2
  {
    rrr   := '666666666666667.88'
    rrr_2 := '-666666666666667.88'
  }
  else if Okrug = 0
  {
    rrr   :='666666666666667'
    rrr_2 :='-666666666666667'
  }
  EndPach := false;
  nomer := nomer+1;
  AdrStr  := '';
end.
.fields
  nomer
  RealInn
  KPP
  if (ShortOrLongNameOrg <> 0, my_pred, my_pred2)
  my_inn
  pach_nmb
  PersonsNumb
  curdate
.endfields
  <ПачкаВходящихДокументов Окружение = "В составе файла" Стадия = "До обработки">
    <ВХОДЯЩАЯ_ОПИСЬ_ПО_СТРАХОВЫМ_ВЗНОСАМ>
      <НомерВпачке>^</НомерВпачке>
      <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
      <СоставительПачки>
        <НалоговыйНомер>
          <ИНН>^</ИНН>
          <КПП>^</КПП>
        </НалоговыйНомер>
        <НаименованиеКраткое>^</НаименованиеКраткое>
        <РегистрационныйНомер>^</РегистрационныйНомер>
      </СоставительПачки>
      <НомерПачки>
        <Основной>^</Основной>
      </НомерПачки>
      <СоставДокументов>
        <Количество>1</Количество>
        <НаличиеДокументов>
          <ТипДокумента>СВЕДЕНИЯ_О_СТРАХОВЫХ_ВЗНОСАХ_И_СТРАХОВОМ_СТАЖЕ_ЗЛ</ТипДокумента>
          <Количество>^</Количество>
        </НаличиеДокументов>
      </СоставДокументов>
      <ДатаСоставления>^</ДатаСоставления>
.fields
  _ТипСведений
  HP
  MagnitKvartal
  God
  sNamePeriod
  MagnitKvNext
  GodNext
  sNmPeriodNext
  MagnitKvartal
  God
  sNamePeriod
  if (Взносы_страх_часть_пач>=0,DoubleToStr(Взносы_страх_часть_пач,rrr),DoubleToStr(Взносы_страх_часть_пач,rrr_2))
  if (Взносы_страх_часть_пач_Упл>=0,DoubleToStr(Взносы_страх_часть_пач_Упл,rrr),DoubleToStr(Взносы_страх_часть_пач_Упл,rrr_2))
  if (Взносы_накопит_часть_пач>=0,DoubleToStr(Взносы_накопит_часть_пач,rrr),DoubleToStr(Взносы_накопит_часть_пач,rrr_2))
  if (Взносы_накопит_часть_пач_Упл>=0,DoubleToStr(Взносы_накопит_часть_пач_Упл,rrr),DoubleToStr(Взносы_накопит_часть_пач_Упл,rrr_2))
.endfields
      <ТипСведений>^</ТипСведений>
      <КодКатегории>^</КодКатегории>
.{?internal;ВидКорректировки = 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
.}
.{?internal;ВидКорректировки > 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
      <КорректируемыйОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </КорректируемыйОтчетныйПериод>
.}
.{?internal;ВидКорректировки <> 2
      <СуммаВзносовНаСтраховую>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаСтраховую>
      <СуммаВзносовНаНакопительную>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаНакопительную>
.}
    </ВХОДЯЩАЯ_ОПИСЬ_ПО_СТРАХОВЫМ_ВЗНОСАМ>
.}
.begin
 StrGod:= God;

 IF (Word(ДеньЗак)<>0)and(Word(МесяцЗак)<>0)and(Word(ГодЗак)<>0)
  RDataDog:= string(Date(Word(ДеньЗак), Word(МесяцЗак), Word(ГодЗак)))
 else
  RDataDog:=''

  AdrStr := '';
  if trim(АдрПрописки_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';

  nomer := nomer+1;
 end.
.fields
  nomer
  _ТипСведений
  my_inn
  if (ShortOrLongNameOrg <> 0, my_pred, my_pred2)
  RealInn
  KPP
  HP
  MagnitKvartal
  God
  sNamePeriod
  MagnitKvartal
  God
  sNamePeriod
  trim(Страховой_номер)
  trim(UpCase(Фамилия))
  trim(UpCase(Имя))
  trim(UpCase(Отчество))
.endfields
    <СВЕДЕНИЯ_О_СТРАХОВЫХ_ВЗНОСАХ_И_СТРАХОВОМ_СТАЖЕ_ЗЛ>
      <НомерВпачке>^</НомерВпачке>
      <ВидФормы>СПВ-1</ВидФормы>
      <ТипСведений>^</ТипСведений>
      <РегистрационныйНомер>^</РегистрационныйНомер>
      <НаименованиеКраткое>^</НаименованиеКраткое>
      <НалоговыйНомер>
      <ИНН>^</ИНН>
      <КПП>^</КПП>
      </НалоговыйНомер>
      <КодКатегории>^</КодКатегории>
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </ОтчетныйПериод>
.{?internal;ВидКорректировки = 10
      <КорректируемыйОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      <Название>^</Название>
      </КорректируемыйОтчетныйПериод>
.}
      <СтраховойНомер>^</СтраховойНомер>
      <ФИО>
        <Фамилия>^</Фамилия>
        <Имя>^</Имя>
        <Отчество>^</Отчество>
      </ФИО>
.fields
if (Взносы_страх_часть>=0,DoubleToStr(Взносы_страх_часть,rrr),DoubleToStr(Взносы_страх_часть,rrr_2))
if (Взносы_страх_часть_Упл>=0,DoubleToStr(Взносы_страх_часть_Упл,rrr),DoubleToStr(Взносы_страх_часть_Упл,rrr_2))
if (Взносы_накопит_часть>=0,DoubleToStr(Взносы_накопит_часть,rrr),DoubleToStr(Взносы_накопит_часть,rrr_2))
if (Взносы_накопит_часть_Упл>=0,DoubleToStr(Взносы_накопит_часть_Упл,rrr),DoubleToStr(Взносы_накопит_часть_Упл,rrr_2))
curdate              
Дата_Оформления_пенсии
.endfields
.{?internal;ВидКорректировки <> 2
      <СуммаВзносовНаСтраховую>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаСтраховую>
      <СуммаВзносовНаНакопительную>
        <Начислено>^</Начислено>
        <Уплачено>^</Уплачено>
      </СуммаВзносовНаНакопительную>
.}
      <ДатаЗаполнения>^</ДатаЗаполнения>
      <ДатаСоставленияНа>^</ДатаСоставленияНа>
.fields
!  KolStag
.endfields
.{?internal;ВидКорректировки <> 2
!.{?internal;KolStag > 0
!      <СтажевыйПериод>
!        <Количество>^</Количество>
!.}
.}
.{ CheckEnter SZV61_Stages_7
.{?internal;Trim(Наим_стажа) <> 'АВАНС'
.fields
  nppSt
  my_nach_st
  my_kon_st
  Число_записей_лгот

  UpCase(TerCond)
  DoubleToStr(Double(RВыслуга_лет_доп_свед_3),'666666666666667.88')

  UpCase(WorkCond)
  Код_позиции_списка1

  UpCase(Исчисл_труд_стаж_основание)
  RИсчисл_труд_стаж_доп_свед3
  RИсчисл_труд_стаж_доп_свед4
  RИсчисл_труд_стаж_доп_свед1
  RИсчисл_труд_стаж_доп_свед2
  UpCase(Исчисл_труд_стаж_доп_свед_3)

  UpCase(Выслуга_лет_основание)
  RВыслуга_лет_доп_свед3
  RВыслуга_лет_доп_свед4
  RВыслуга_лет_доп_свед1
  RВыслуга_лет_доп_свед2

!  Ед_изм_Выслуга_лет_доп_свед3_Lgot
  DoubleToStr(Double(RВыслуга_лет_доп_свед_3),'666666666666667.88')
.endfields
.begin
 my_nach_st := Нач_стажа
 my_kon_st  := Кон_стажа
 NppStrLgot := 1;

 IF (Исчисл_труд_стаж_доп_свед1=0) or (trim(Исчисл_труд_стаж_доп_свед1) = '') then
  RИсчисл_труд_стаж_доп_свед1:='0'
 else
  RИсчисл_труд_стаж_доп_свед1:= UpCase(string(Исчисл_труд_стаж_доп_свед1));

 if (Исчисл_труд_стаж_доп_свед2=0)or(trim(Исчисл_труд_стаж_доп_свед2) = '') then
  RИсчисл_труд_стаж_доп_свед2:= '0'
 else
  RИсчисл_труд_стаж_доп_свед2:= UpCase(string(Исчисл_труд_стаж_доп_свед2));

 if (Исчисл_труд_стаж_доп_свед3=0)or(trim(Исчисл_труд_стаж_доп_свед3) = '') then
  RИсчисл_труд_стаж_доп_свед3:= '0'
 else
  RИсчисл_труд_стаж_доп_свед3:= UpCase(string(Исчисл_труд_стаж_доп_свед3));

 if (Исчисл_труд_стаж_доп_свед4=0) or(trim(Исчисл_труд_стаж_доп_свед4)='') then
  RИсчисл_труд_стаж_доп_свед4:= '0'
 else
  RИсчисл_труд_стаж_доп_свед4:= UpCase(string(Исчисл_труд_стаж_доп_свед4));

 if (Выслуга_лет_доп_свед1=0)or(trim(Выслуга_лет_доп_свед1)='') then
  RВыслуга_лет_доп_свед1:= '0'
 else
  RВыслуга_лет_доп_свед1:= UpCase(string(Выслуга_лет_доп_свед1));

 if (Выслуга_лет_доп_свед2=0)or(trim(Выслуга_лет_доп_свед2) ='') then
  RВыслуга_лет_доп_свед2:= '0'
 else
  RВыслуга_лет_доп_свед2:= UpCase(string(Выслуга_лет_доп_свед2));

 if (Выслуга_лет_доп_свед3=0)or(trim(Выслуга_лет_доп_свед3) = '') then
  RВыслуга_лет_доп_свед3:= '0'
 else
  RВыслуга_лет_доп_свед3:= UpCase(string(Выслуга_лет_доп_свед3));

 if (Выслуга_лет_доп_свед4=0)or(trim(Выслуга_лет_доп_свед4) = '') then
  RВыслуга_лет_доп_свед4:= '0'
 else
  RВыслуга_лет_доп_свед4:= UpCase(string(Выслуга_лет_доп_свед4));

 if (Выслуга_лет_доп_свед_3=0) then
  RВыслуга_лет_доп_свед_3:= '0.00'
 else
  RВыслуга_лет_доп_свед_3:= DoubleToStr(Выслуга_лет_доп_свед_3,'66666.99');

 IF (Число_записей_лгот=0) or (trim(Число_записей_лгот) = '') then
   RЧисло_записей_лгот:= '0'
 else
   RЧисло_записей_лгот:= string(Число_записей_лгот);
end.
.{?internal;ВидКорректировки <> 2
        <СтажевыйПериод>
            <НомерСтроки>^</НомерСтроки>
            <ДатаНачалаПериода>^</ДатаНачалаПериода>
            <ДатаКонцаПериода>^</ДатаКонцаПериода>
.{?internal; (TerCond<>'') or (WorkCond<>'') or (Код_позиции_списка1<>'') or (Исчисл_труд_стаж_основание<>'') or (Исчисл_труд_стаж_доп_свед_3<>'') or (Выслуга_лет_основание<>'')
            <КоличествоЛьготныхСоставляющих>^</КоличествоЛьготныхСоставляющих>
            <ЛьготныйСтаж>
            <НомерСтроки>1</НомерСтроки>
            <ОсобенностиУчета>
              <ТерриториальныеУсловия>
                <ОснованиеТУ>^</ОснованиеТУ>
.{?internal; ( TerCond<>''and Выслуга_лет_доп_свед_3 > 0 and Выслуга_лет_доп_свед_3 < 1 )
                <Коэффициент>^</Коэффициент>
.}
              </ТерриториальныеУсловия>
              <ОсобыеУсловияТруда>
                <ОснованиеОУТ>^</ОснованиеОУТ>
                <ПозицияСписка>^</ПозицияСписка>
              </ОсобыеУсловияТруда>
              <ИсчисляемыйСтаж>
                <ОснованиеИС>^</ОснованиеИС>
.{?internal; (RИсчисл_труд_стаж_доп_свед3 <> 0) or (RИсчисл_труд_стаж_доп_свед4 <> 0)
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; (RИсчисл_труд_стаж_доп_свед1 <> 0) or (RИсчисл_труд_стаж_доп_свед2 <> 0)
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
              </ИсчисляемыйСтаж>
              <ДекретДети>^</ДекретДети>
              <ВыслугаЛет>
                <ОснованиеВЛ>^</ОснованиеВЛ>
.{?internal; (RВыслуга_лет_доп_свед3 <> '0') or (RВыслуга_лет_доп_свед4 <> '0')
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; (RВыслуга_лет_доп_свед1 <> '0') or (RВыслуга_лет_доп_свед2 <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
.{?internal; ( TerCond = '' or Выслуга_лет_доп_свед_3 = 0 or Выслуга_лет_доп_свед_3 >= 1 )
                <ДоляСтавки>^</ДоляСтавки>
.}
              </ВыслугаЛет>
            </ОсобенностиУчета>
            </ЛьготныйСтаж>
.}
!       </СтажевыйПериод>
.}
.}
.{ CheckEnter SZV61Vred1_7
.}
.{ CheckEnter SZV61Lgot_7
.begin
 NppStrLgot := NppStrLgot + 1;
 if  (Исчисл_труд_стаж_доп_свед1_Lgot=0)or(trim(Исчисл_труд_стаж_доп_свед1_Lgot) = '') then
  RИсчисл_труд_стаж_доп_свед1_Lgot:= '0'
 else
  RИсчисл_труд_стаж_доп_свед1_Lgot:= UpCase(string(Исчисл_труд_стаж_доп_свед1_Lgot))
 if  (Исчисл_труд_стаж_доп_свед2_Lgot=0) or (trim(Исчисл_труд_стаж_доп_свед2_Lgot) = '') then
  RИсчисл_труд_стаж_доп_свед2_Lgot:= '0'
 else
  RИсчисл_труд_стаж_доп_свед2_Lgot:= UpCase(string(Исчисл_труд_стаж_доп_свед2_Lgot))

 if  (Выслуга_лет_доп_свед_3_lgot=0) //or(trim(Выслуга_лет_доп_свед_3_lgot) = '') then
  RВыслуга_лет_доп_свед_3_lgot:= '0.00'
 else
  RВыслуга_лет_доп_свед_3_lgot:= DoubleToStr(Выслуга_лет_доп_свед_3_lgot,'66667.99');
 end.
.{?internal;Trim(Наим_стажа) <> 'АВАНС'
.fields
!  nppStLgot
  NppStrLgot
  UpCase(TerCond_Lgot)
  UpCase(WorkCond_Lgot)
  Код_позиции_списка2
  UpCase(Исчисл_труд_стаж_основание_Lgot)
  if( trim(RИсчисл_труд_стаж_доп_свед1_Lgot) <> '',RИсчисл_труд_стаж_доп_свед1_Lgot, 0 )
  if( trim(RИсчисл_труд_стаж_доп_свед2_Lgot) <> '',RИсчисл_труд_стаж_доп_свед2_Lgot, 0 )

  UpCase(Исчисл_труд_стаж_доп_свед3_Lgot)

  UpCase(Выслуга_лет_основание_Lgot)
  if( trim(Выслуга_лет_доп_свед3_Lgot) <> '',Выслуга_лет_доп_свед3_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед4_Lgot) <> '',Выслуга_лет_доп_свед4_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед1_Lgot) <> '',Выслуга_лет_доп_свед1_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед2_Lgot) <> '',Выслуга_лет_доп_свед2_Lgot, 0 )


!  DoubleToStr(Double(RВыслуга_лет_доп_свед_3_Lgot),'666666666666667.88')
!  Выслуга_лет_доп_свед_3_Lgot

  Ед_изм_Выслуга_лет_доп_свед3_Lgot

.endfields
.{?internal;ВидКорректировки <> 2
!          <ДополнительныеСтроки>
!           <Количество>^</Количество>
.{?internal; (TerCond_Lgot<>'') or (WorkCond_Lgot<>'') or (Код_позиции_списка2<>'') or (Исчисл_труд_стаж_основание_Lgot<>'') or (Исчисл_труд_стаж_доп_свед3_Lgot<>'') or (Выслуга_лет_основание_Lgot<>'')
            <ЛьготныйСтаж>
            <НомерСтроки>^</НомерСтроки>
            <ОсобенностиУчета>
              <ТерриториальныеУсловия>
                <ОснованиеТУ>^</ОснованиеТУ>
              </ТерриториальныеУсловия>
              <ОсобыеУсловияТруда>
                <ОснованиеОУТ>^</ОснованиеОУТ>
                <ПозицияСписка>^</ПозицияСписка>
              </ОсобыеУсловияТруда>
              <ИсчисляемыйСтаж>
                <ОснованиеИС>^</ОснованиеИС>
.{?internal; (RИсчисл_труд_стаж_доп_свед1_Lgot <> '0') or (RИсчисл_труд_стаж_доп_свед2_Lgot <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
              </ИсчисляемыйСтаж>
              <ДекретДети>^</ДекретДети>
              <ВыслугаЛет>
                <ОснованиеВЛ>^</ОснованиеВЛ>
.{?internal; ( Выслуга_лет_доп_свед3_Lgot <> '0') or ( Выслуга_лет_доп_свед4_Lgot <> '0')
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; ( Выслуга_лет_доп_свед1_Lgot <> '0') or ( Выслуга_лет_доп_свед2_Lgot <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
!                <КодИсчисления>^</КодИсчисления>
.{?internal; (Ед_изм_Выслуга_лет_доп_свед3_Lgot <> '')
                <ДоляСтавки>^</ДоляСтавки>
.}
              </ВыслугаЛет>
!              <ПрофессияДолжность></ПрофессияДолжность>
!              <ОтметкаОценщика></ОтметкаОценщика>
            </ОсобенностиУчета>
            </ЛьготныйСтаж>
.}
!          </ДополнительныеСтроки>
.}
.}
.{ CheckEnter SZV61Vred2_7
.}
.} //CheckEnter Lgot
.{?internal;ВидКорректировки <> 2
!.{?internal;KolStag > 0
      </СтажевыйПериод>
!.}
.}
.} //стаж
    </СВЕДЕНИЯ_О_СТРАХОВЫХ_ВЗНОСАХ_И_СТРАХОВОМ_СТАЖЕ_ЗЛ>
.{ CheckEnter SZV_ADV6_1_7
.if DeadLine_61_SZV
.begin
  EndPach := true;
end.
.fields
   pach_nmb
.endfields
  </ПачкаВходящихДокументов>
</ФайлПФР>
___КОНЕЦ ^ ПАЧКИ!!!_Разрежьте_здесь!
.end
.begin
  pach_nmb:= pach_nmb + 1;
  nomer:= 0;
end.
.{?internal;not EndPach
  </ПачкаВходящихДокументов>
</ФайлПФР>
.}
.}
.}
.endform

.linkform 'SPV-2_7_MAGNITlink17' prototype is 'SZV-61'
.F 'IS_SPV-2.XML'
.nameinlist'Файл для ПФ на МН (СПВ-2 в.7.00)'
.group 'SPV2'
.var
  EndPach: boolean;
  _ТипСведений,_ВидКорректировки : string;
  rrr,rrr_2,TypeChars: String;
  my_pred, my_pred2    : string[100];
  my_inn     : string[14]
  pach_nmb   : Longint
  nomer      : longint
  MyPersonCounter: LongInt;
  PersonCounterOut: LongInt;
  AdrStr: string;
  StrGod     : string
  kvartal    : string
  my_nach_st : string
  my_kon_st  : string
  KolNach    : LongInt
  NppStrLgot : LongInt
  SumNach    : double
  SumBoln    : double
  ВзносыОПС  : string
  ВзносыДопТар : string
  НаличиеВзнДопТар : integer
  RИсчисл_труд_стаж_доп_свед1     : string
  RИсчисл_труд_стаж_доп_свед2     : string
  RИсчисл_труд_стаж_доп_свед3     : string
  RИсчисл_труд_стаж_доп_свед4     : string
  RИсчисл_труд_стаж_доп_свед1_lgot: string
  RИсчисл_труд_стаж_доп_свед2_lgot: string
  RВыслуга_лет_доп_свед_3_lgot     : string
  RВыслуга_лет_доп_свед1          : string
  RВыслуга_лет_доп_свед2          : string
  RВыслуга_лет_доп_свед3          : string
  RВыслуга_лет_доп_свед4          : string
  RВыслуга_лет_доп_свед_3          : string
  RЧисло_записей_лгот             : string
  CodeDopTarr                     : String;
  RDataDog                        : string
.endvar
.begin
  my_inn   := Upcase( Trim( inn ) )
  my_pred  := Upcase( Trim( Pred ))
  my_pred2 :=  Upcase( Trim( PredShort ))
  pach_nmb:= PachNumBegin
  CodeDopTarr := 'АВИА';
  TypeChars := 'ИСХД'
  nomer   := 0
  KolNach := 0
  SumNach := 0
  SumBoln := 0
  MyPersonCounter := 0;
  PersonCounterOut:= 0;
 end.
.{ CheckEnter SZV6_1_7
.{?internal;(nomer=0)or(nomer = (AllCounter + 1))
.begin
  if (PersonsNumb - MyPersonCounter) >= AllCounter
  {
    MyPersonCounter := MyPersonCounter + AllCounter;
    PersonCounterOut := AllCounter;
  }
  else
    PersonCounterOut := PersonsNumb - MyPersonCounter;

  if nomer=AllCounter then
  {
    pach_nmb:= pach_nmb + 1;
    nomer:= 0;
  }
end.
<?xml version="1.0" encoding="cp866"?>
<ФайлПФР>
  <ИмяФайла></ИмяФайла>
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
#ifdef Gal9_1
       <Версия>9.1</Версия>
#else
       <Версия>8.1</Версия>
#end
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
.begin
 if ВидКорректировки  = 0
 {
   _ТипСведений      := 'ИСХОДНАЯ';
   _ВидКорректировки := '';
 }
 else if ВидКорректировки  = 1
 {
   _ТипСведений      := 'КОРРЕКТИРУЮЩАЯ';
   _ВидКорректировки := 'КОРРЕКТИРУЮЩАЯ';
 }
 else
 {
   _ТипСведений      := 'ОТМЕНЯЮЩАЯ';
   _ВидКорректировки := 'ОТМЕНЯЮЩАЯ';
 }
  if Okrug = 2
  {
    rrr   := '666666666666667.88'
    rrr_2 := '-666666666666667.88'
  }
  else if Okrug = 0
  {
    rrr   :='666666666666667'
    rrr_2 :='-666666666666667'
  }
  EndPach := false;
  nomer := nomer+1;
  AdrStr  := '';
end.
.fields
  nomer
  RealInn
  KPP
  CodeOGRUL
  my_pred
  my_pred2
  my_inn
  pach_nmb
  PersonsNumb
  curdate
.endfields
  <ПачкаВходящихДокументов Окружение = "В составе файла" Стадия = "До обработки">
    <ВХОДЯЩАЯ_ОПИСЬ>
      <НомерВпачке>^</НомерВпачке>
      <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
      <СоставительПачки>
        <НалоговыйНомер>
          <ИНН>^</ИНН>
          <КПП>^</КПП>
        </НалоговыйНомер>
        <КодЕГРЮЛ>^</КодЕГРЮЛ>
        <НаименованиеОрганизации>^</НаименованиеОрганизации>
        <НаименованиеКраткое>^</НаименованиеКраткое>
        <РегистрационныйНомер>^</РегистрационныйНомер>
      </СоставительПачки>
      <НомерПачки>
        <Основной>^</Основной>
      </НомерПачки>
      <СоставДокументов>
        <Количество>1</Количество>
        <НаличиеДокументов>
          <ТипДокумента>СВЕДЕНИЯ_О_СТРАХОВОМ_СТАЖЕ_ЗЛ_ДЛЯ_УСТАНОВЛЕНИЯ_ПЕНСИИ</ТипДокумента>
          <Количество>^</Количество>
        </НаличиеДокументов>
      </СоставДокументов>
      <ДатаСоставления>^</ДатаСоставления>
    </ВХОДЯЩАЯ_ОПИСЬ>
.}
.begin
 StrGod:= God;

 IF (Word(ДеньЗак)<>0)and(Word(МесяцЗак)<>0)and(Word(ГодЗак)<>0)
  RDataDog:= string(Date(Word(ДеньЗак), Word(МесяцЗак), Word(ГодЗак)))
 else
  RDataDog:=''

  AdrStr := '';
  if trim(АдрПрописки_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';

  nomer := nomer+1;
  НаличиеВзнДопТар := 0;
 end.
.fields
  nomer
  _ТипСведений
  my_inn
  my_pred2
  RealInn
  KPP
  HP
  integer(MagnitKvartal)*3 mod 12
  God
  integer(MagnitKvNext)*3 mod 12
  GodNext
  integer(MagnitKvartal)*3 mod 12
  God

  trim(Страховой_номер)
  trim(UpCase(Фамилия))
  trim(UpCase(Имя))
  trim(UpCase(Отчество))
.endfields
    <СВЕДЕНИЯ_О_СТРАХОВОМ_СТАЖЕ_ЗЛ_ДЛЯ_УСТАНОВЛЕНИЯ_ПЕНСИИ>
      <НомерВпачке>^</НомерВпачке>
      <ТипСведений>^</ТипСведений>
      <РегистрационныйНомер>^</РегистрационныйНомер>
      <НаименованиеКраткое>^</НаименованиеКраткое>
      <НалоговыйНомер>
      <ИНН>^</ИНН>
      <КПП>^</КПП>
      </НалоговыйНомер>
      <КодКатегории>^</КодКатегории>
.{?internal;ВидКорректировки = 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      </ОтчетныйПериод>
.}
.{?internal;ВидКорректировки <> 0
      <ОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      </ОтчетныйПериод>
      <КорректируемыйОтчетныйПериод>
      <Квартал>^</Квартал>
      <Год>^</Год>
      </КорректируемыйОтчетныйПериод>
.}
      <СтраховойНомер>^</СтраховойНомер>
      <ФИО>
        <Фамилия>^</Фамилия>
        <Имя>^</Имя>
        <Отчество>^</Отчество>
      </ФИО>
.fields
curdate
!Дата_Оформления_пенсии
!Кон_стажа
 дат_сост
.endfields
      <ДатаЗаполнения>^</ДатаЗаполнения>
      <ДатаСоставленияНа>^</ДатаСоставленияНа>
.{ CheckEnter SZV61_Stages_7
.{?internal;Trim(Наим_стажа) <> 'АВАНС'
.fields
  nppSt
  my_nach_st
  my_kon_st
  Число_записей_лгот

  UpCase(TerCond)
  DoubleToStr(Double(RВыслуга_лет_доп_свед_3),'666666666666667.88')

  UpCase(WorkCond)
  Код_позиции_списка1

  UpCase(Исчисл_труд_стаж_основание)
  RИсчисл_труд_стаж_доп_свед3
  RИсчисл_труд_стаж_доп_свед4
  RИсчисл_труд_стаж_доп_свед1
  RИсчисл_труд_стаж_доп_свед2
  UpCase(Исчисл_труд_стаж_доп_свед_3)

  UpCase(Выслуга_лет_основание)
  RВыслуга_лет_доп_свед3
  RВыслуга_лет_доп_свед4
  RВыслуга_лет_доп_свед1
  RВыслуга_лет_доп_свед2

!  Ед_изм_Выслуга_лет_доп_свед3_Lgot
  DoubleToStr(Double(RВыслуга_лет_доп_свед_3),'666666666666667.88')
.endfields
.begin

 if  WorkCond <> ''
   НаличиеВзнДопТар := НаличиеВзнДопТар + 1
 my_nach_st := Нач_стажа
 my_kon_st  := Кон_стажа
 NppStrLgot := 1;

 IF (Исчисл_труд_стаж_доп_свед1=0) or (trim(Исчисл_труд_стаж_доп_свед1) = '') then
  RИсчисл_труд_стаж_доп_свед1:='0'
 else
  RИсчисл_труд_стаж_доп_свед1:= UpCase(string(Исчисл_труд_стаж_доп_свед1));

 if (Исчисл_труд_стаж_доп_свед2=0)or(trim(Исчисл_труд_стаж_доп_свед2) = '') then
  RИсчисл_труд_стаж_доп_свед2:= '0'
 else
  RИсчисл_труд_стаж_доп_свед2:= UpCase(string(Исчисл_труд_стаж_доп_свед2));

 if (Исчисл_труд_стаж_доп_свед3=0)or(trim(Исчисл_труд_стаж_доп_свед3) = '') then
  RИсчисл_труд_стаж_доп_свед3:= '0'
 else
  RИсчисл_труд_стаж_доп_свед3:= UpCase(string(Исчисл_труд_стаж_доп_свед3));

 if (Исчисл_труд_стаж_доп_свед4=0) or(trim(Исчисл_труд_стаж_доп_свед4)='') then
  RИсчисл_труд_стаж_доп_свед4:= '0'
 else
  RИсчисл_труд_стаж_доп_свед4:= UpCase(string(Исчисл_труд_стаж_доп_свед4));

 if (Выслуга_лет_доп_свед1=0)or(trim(Выслуга_лет_доп_свед1)='') then
  RВыслуга_лет_доп_свед1:= '0'
 else
  RВыслуга_лет_доп_свед1:= UpCase(string(Выслуга_лет_доп_свед1));

 if (Выслуга_лет_доп_свед2=0)or(trim(Выслуга_лет_доп_свед2) ='') then
  RВыслуга_лет_доп_свед2:= '0'
 else
  RВыслуга_лет_доп_свед2:= UpCase(string(Выслуга_лет_доп_свед2));

 if (Выслуга_лет_доп_свед3=0)or(trim(Выслуга_лет_доп_свед3) = '') then
  RВыслуга_лет_доп_свед3:= '0'
 else
  RВыслуга_лет_доп_свед3:= UpCase(string(Выслуга_лет_доп_свед3));

 if (Выслуга_лет_доп_свед4=0)or(trim(Выслуга_лет_доп_свед4) = '') then
  RВыслуга_лет_доп_свед4:= '0'
 else
  RВыслуга_лет_доп_свед4:= UpCase(string(Выслуга_лет_доп_свед4));

 if (Выслуга_лет_доп_свед_3=0) then
  RВыслуга_лет_доп_свед_3:= '0.00'
 else
  RВыслуга_лет_доп_свед_3:= DoubleToStr(Выслуга_лет_доп_свед_3,'66666.99');

 IF (Число_записей_лгот=0) or (trim(Число_записей_лгот) = '') then
   RЧисло_записей_лгот:= '0'
 else
   RЧисло_записей_лгот:= string(Число_записей_лгот);
end.
.{?internal;ВидКорректировки <> 2
        <СтажевыйПериод>
            <НомерСтроки>^</НомерСтроки>
            <ДатаНачалаПериода>^</ДатаНачалаПериода>
            <ДатаКонцаПериода>^</ДатаКонцаПериода>
.{?internal; (TerCond<>'') or (WorkCond<>'') or (Код_позиции_списка1<>'') or (Исчисл_труд_стаж_основание<>'') or (Исчисл_труд_стаж_доп_свед_3<>'') or (Выслуга_лет_основание<>'')
            <КоличествоЛьготныхСоставляющих>^</КоличествоЛьготныхСоставляющих>
            <ЛьготныйСтаж>
            <НомерСтроки>1</НомерСтроки>
            <ОсобенностиУчета>
              <ТерриториальныеУсловия>
                <ОснованиеТУ>^</ОснованиеТУ>
.{?internal; ( TerCond<>''and Выслуга_лет_доп_свед_3 > 0 and Выслуга_лет_доп_свед_3 < 1 )
                <Коэффициент>^</Коэффициент>
.}
              </ТерриториальныеУсловия>
              <ОсобыеУсловияТруда>
                <ОснованиеОУТ>^</ОснованиеОУТ>
                <ПозицияСписка>^</ПозицияСписка>
              </ОсобыеУсловияТруда>
              <ИсчисляемыйСтаж>
                <ОснованиеИС>^</ОснованиеИС>
.{?internal; (RИсчисл_труд_стаж_доп_свед3 <> 0) or (RИсчисл_труд_стаж_доп_свед4 <> 0)
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; (RИсчисл_труд_стаж_доп_свед1 <> 0) or (RИсчисл_труд_стаж_доп_свед2 <> 0)
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
              </ИсчисляемыйСтаж>
              <ДекретДети>^</ДекретДети>
              <ВыслугаЛет>
                <ОснованиеВЛ>^</ОснованиеВЛ>
.{?internal; (RВыслуга_лет_доп_свед3 <> '0') or (RВыслуга_лет_доп_свед4 <> '0')
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; (RВыслуга_лет_доп_свед1 <> '0') or (RВыслуга_лет_доп_свед2 <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
.{?internal; ( TerCond = '' or Выслуга_лет_доп_свед_3 = 0 or Выслуга_лет_доп_свед_3 >= 1 )
                <ДоляСтавки>^</ДоляСтавки>
.}
              </ВыслугаЛет>
            </ОсобенностиУчета>
            </ЛьготныйСтаж>
.}
!       </СтажевыйПериод>
.}
.}
.{ CheckEnter SZV61Vred1_7
.}
.{ CheckEnter SZV61Lgot_7
.begin
 NppStrLgot := NppStrLgot + 1;
 if  (Исчисл_труд_стаж_доп_свед1_Lgot=0)or(trim(Исчисл_труд_стаж_доп_свед1_Lgot) = '') then
  RИсчисл_труд_стаж_доп_свед1_Lgot:= '0'
 else
  RИсчисл_труд_стаж_доп_свед1_Lgot:= UpCase(string(Исчисл_труд_стаж_доп_свед1_Lgot))
 if  (Исчисл_труд_стаж_доп_свед2_Lgot=0) or (trim(Исчисл_труд_стаж_доп_свед2_Lgot) = '') then
  RИсчисл_труд_стаж_доп_свед2_Lgot:= '0'
 else
  RИсчисл_труд_стаж_доп_свед2_Lgot:= UpCase(string(Исчисл_труд_стаж_доп_свед2_Lgot))

 if  (Выслуга_лет_доп_свед_3_lgot=0) //or(trim(Выслуга_лет_доп_свед_3_lgot) = '') then
  RВыслуга_лет_доп_свед_3_lgot:= '0.00'
 else
  RВыслуга_лет_доп_свед_3_lgot:= DoubleToStr(Выслуга_лет_доп_свед_3_lgot,'66667.99');
 end.
.{?internal;Trim(Наим_стажа) <> 'АВАНС'
.fields
!  nppStLgot
  NppStrLgot
  UpCase(TerCond_Lgot)
  UpCase(WorkCond_Lgot)
  Код_позиции_списка2
  UpCase(Исчисл_труд_стаж_основание_Lgot)
  if( trim(RИсчисл_труд_стаж_доп_свед1_Lgot) <> '',RИсчисл_труд_стаж_доп_свед1_Lgot, 0 )
  if( trim(RИсчисл_труд_стаж_доп_свед2_Lgot) <> '',RИсчисл_труд_стаж_доп_свед2_Lgot, 0 )

  UpCase(Исчисл_труд_стаж_доп_свед3_Lgot)

  UpCase(Выслуга_лет_основание_Lgot)
  if( trim(Выслуга_лет_доп_свед3_Lgot) <> '',Выслуга_лет_доп_свед3_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед4_Lgot) <> '',Выслуга_лет_доп_свед4_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед1_Lgot) <> '',Выслуга_лет_доп_свед1_Lgot, 0 )
  if( trim(Выслуга_лет_доп_свед2_Lgot) <> '',Выслуга_лет_доп_свед2_Lgot, 0 )

  Ед_изм_Выслуга_лет_доп_свед3_Lgot

.endfields
.{?internal;ВидКорректировки <> 2
!          <ДополнительныеСтроки>
!           <Количество>^</Количество>
.{?internal; (TerCond_Lgot<>'') or (WorkCond_Lgot<>'') or (Код_позиции_списка2<>'') or (Исчисл_труд_стаж_основание_Lgot<>'') or (Исчисл_труд_стаж_доп_свед3_Lgot<>'') or (Выслуга_лет_основание_Lgot<>'')
            <ЛьготныйСтаж>
            <НомерСтроки>^</НомерСтроки>
            <ОсобенностиУчета>
              <ТерриториальныеУсловия>
                <ОснованиеТУ>^</ОснованиеТУ>
              </ТерриториальныеУсловия>
              <ОсобыеУсловияТруда>
                <ОснованиеОУТ>^</ОснованиеОУТ>
                <ПозицияСписка>^</ПозицияСписка>
              </ОсобыеУсловияТруда>
              <ИсчисляемыйСтаж>
                <ОснованиеИС>^</ОснованиеИС>
.{?internal; (RИсчисл_труд_стаж_доп_свед1_Lgot <> '0') or (RИсчисл_труд_стаж_доп_свед2_Lgot <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
              </ИсчисляемыйСтаж>
              <ДекретДети>^</ДекретДети>
              <ВыслугаЛет>
                <ОснованиеВЛ>^</ОснованиеВЛ>
.{?internal; ( Выслуга_лет_доп_свед3_Lgot <> '0') or ( Выслуга_лет_доп_свед4_Lgot <> '0')
                <ВыработкаВчасах>
                  <Часы>^</Часы>
                  <Минуты>^</Минуты>
                </ВыработкаВчасах>
.}
.{?internal; ( Выслуга_лет_доп_свед1_Lgot <> '0') or ( Выслуга_лет_доп_свед2_Lgot <> '0')
                <ВыработкаКалендарная>
                  <ВсеМесяцы>^</ВсеМесяцы>
                  <ВсеДни>^</ВсеДни>
                </ВыработкаКалендарная>
.}
!                <КодИсчисления>^</КодИсчисления>
.{?internal; (Ед_изм_Выслуга_лет_доп_свед3_Lgot <> '')
                <ДоляСтавки>^</ДоляСтавки>
.}
              </ВыслугаЛет>
!              <ПрофессияДолжность></ПрофессияДолжность>
!              <ОтметкаОценщика></ОтметкаОценщика>
            </ОсобенностиУчета>
            </ЛьготныйСтаж>
.}
!          </ДополнительныеСтроки>
.}
.}
.{ CheckEnter SZV61Vred2_7
.}
.} //CheckEnter Lgot
.{?internal;ВидКорректировки <> 2
!.{?internal;KolStag > 0
      </СтажевыйПериод>
!.}
.}
.} //стаж
.begin
if Взносы_страх_часть > 0
  ВзносыОПС := 'ДА'
else
  ВзносыОПС := 'НЕТ'

if НаличиеВзнДопТар > 0
  ВзносыДопТар := 'ДА'
else
  ВзносыДопТар := 'НЕТ'
end.
.fields
ВзносыОПС
ВзносыДопТар
.endfields
      <ПризнакНачисленияВзносовОПС>^</ПризнакНачисленияВзносовОПС>
      <ПризнакНачисленияВзносовПоДопТарифу>^</ПризнакНачисленияВзносовПоДопТарифу>
    </СВЕДЕНИЯ_О_СТРАХОВОМ_СТАЖЕ_ЗЛ_ДЛЯ_УСТАНОВЛЕНИЯ_ПЕНСИИ>
.{ CheckEnter SZV_ADV6_1_7
.if DeadLine_61_SZV
.begin
  EndPach := true;
end.
.fields
   pach_nmb
.endfields
  </ПачкаВходящихДокументов>
</ФайлПФР>
___КОНЕЦ ^ ПАЧКИ!!!_Разрежьте_здесь!
.end
.begin
  pach_nmb:= pach_nmb + 1;
  nomer:= 0;
end.
.{?internal;not EndPach
  </ПачкаВходящихДокументов>
</ФайлПФР>
.}
.}
.}
.endform
