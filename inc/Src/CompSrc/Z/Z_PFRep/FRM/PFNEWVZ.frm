/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,2001 корпорация ГАЛАКТИКА                    ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Заработная плата                                          ║
 ║ Версия        : 5.74 и выше                                               ║
 ║ Назначение    : Форма АДИ-5, СЗИ-3                                        ║
 ║ Ответственный : Погосский Константин Владимирович                         ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#doc
Форма АДИ-5, СЗИ-3
#end
.form PFNEWVZ
.hide
.DEFO LANDSCAPE
.p 50
.{ NewVz_Loop CheckEnter
.fields
TecPodrName
Month1Name Month2Name YearOtch
.endfields
^^^^
.{ NewVzPers_Loop CheckEnter
.fields
 LoopPodrName
.endfields
^
.{ NewVzGroup_Loop CheckEnter
.if TheNextgroup
.fields
VozGrpup
.endfields
^
.end
.fields
TabNom FIO Sex BornYear StrahNom
NalogBase NalogS: double NalogN: double NalogL6: double NalogL10: double
basedoprev: double baseposleprev: double nalogdoprev: double nalogposle: double
.endfields
^^^^^^^^^^
^^^^
.}
.}
.if TheGroupsItog
.{ GroupsItog CheckEnter
.fields
  VozGrpup_I
  Sex_I
  CountPeople SumB SumN SumS SumL6 SumL10 SumI
  sumBD: double SumBP: double SumND: double SumNP: double
.endfields
^^^^^^^^^
^^^^
.}
.end
.}
.endform

.Linkform 'PFNEWVZ_Link01' Prototype is 'PFNEWVZ'
.nameinlist 'Отчет о страховых взносах на обязательное пенсионное страхование'
.group 'OLdOtch'
.DEFO LANDSCAPE
.p 50
.var
  Str_Sex  : string;
.endvar
.{ NewVz_Loop CheckEnter
.fields
TecPodrName
Month1Name Month2Name YearOtch
.endfields


             БОтчет о страховых взносах на обязательное пенсионное страхование Б
             Бпо Б  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  Бза период Б ^ - ^ @@@@  Бгода Б

.{ NewVzPers_Loop CheckEnter
.fields
LoopPodrName
.endfields
    Подразделение :  ^
 И ┌─────────────┬───────────────────────────┬────┬──────────┬─────────────────┬─────────────┬───────────────────────────────────────────────────────────┐
 │ БТабельный  Б   │            БФ.И.О. Б          │ БПол Б │ БДата Б      │ БСтраховой Б        │ БОблагаемая Б   │                        БСуммы взносов Б                       │
 │ Бномер Б        │                           │    │ Брождения Б  │ Бномер Б            │ Ббаза для Б     ├──────────┬─────────────┬─────────────────────┬────────────┤
 │             │                           │    │          │                 │ Биндивид. Б     │ Бстраховой Б │ Бнакопительной Б│ Б  солидарной Б Б Б  Бчасти Б   │    БИТОГО Б    │
 │             │                           │    │          │                 │ Бчасти взносов Б│ Бчасти Б     │ Бчасти  Б       ├──────────┬────────── Б Б Б Б┤            │
 │             │                           │    │          │                 │             │          │             │ Бдо Б        │ Бсвыше Б     │ Б Б            │ Б Б
 │             │                           │    │          │                 │             │          │             │ Бпревышения Б│ Бпревышения Б│            │
 ├─────────────┼───────────────────────────┼────┼──────────┼─────────────────┼─────────────┼──────────┼─────────────┼──────────┼──────────┼────────────┤ И
.{ NewVzGroup_Loop CheckEnter
.begin
  if (SEX = 'МУЖ')
    Str_Sex := 'МУЖЧИНЫ'
  else if (SEX = 'ЖЕН')
    Str_Sex := 'ЖЕНЩИНЫ'
  else
  {
    Str_Sex := 'БЕСПОЛЫЕ';
    VozGrpup := '0';
  }

end.
.if TheNextgroup
 И │-----------------------------------------------------------------------------------------------------------------------------------------------------│ И
 И │ БВозрастная группа @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               @@@@@@@@@@@@@@@@@ Б                                                                │ И
 И │-----------------------------------------------------------------------------------------------------------------------------------------------------│ И
.end
.fields
VozGrpup Str_Sex
TabNom FIO SEX  BornYear  StrahNom
NalogBase
NalogS NalogN NalogL6 NalogL10 (NalogS+NalogN+NalogL6+NalogL10)
.endfields
 И │@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@│&&&&&&&&&&.&&│&&&&&&&.&&│  &&&&&&&.&& │&&&&&&&.&&│&&&&&&&.&&│&&&&&&&&&.&&│
.}
 └─────────────┴───────────────────────────┴────┴──────────┴─────────────────┴─────────────┴──────────┴─────────────┴──────────┴──────────┴────────────┘
.}
 И.if TheGroupsItog
 И ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
 │                                                                    БИ  Т  О  Г  И Б                                                                     │
 │-----------------------------------------------------------------------------------------------------------------------------------------------------│
 │                                                              │  БКол-во Б     │ БОблагаемая Б   │                        БСуммы взносов Б                       │
 │                                                              │  Бработников Б │ Ббаза для Б     ├──────────┬─────────────┬─────────────────────┬────────────┤
 │                                                              │  Бв группе Б   │ Биндивид. Б     │ Бстраховой Б │ Бнакопительной Б│ Б  солидарной Б  Бчасти Б   │    БИТОГО  Б   │
 │                                                              │            │ Бчасти взносов Б│ Бчасти Б     │ Бчасти Б        ├ Б Б Б Б──────────┬──────────┤            │ И
 И │                                                              │            │             │          │             │ Бдо Б        │ Бсвыше Б     │ Б Б            │ Б Б
 │                                                              │            │             │          │             │ Бпревышения Б│ Бпревышения Б│            │
 И.{ GroupsItog CheckEnter
.fields
  VozGrpup_I
  Sex_I
  CountPeople SumB SumS SumN  SumL6 SumL10 SumI
.endfields
 И │-----------------------------------------------------------------------------------------------------------------------------------------------------│ И
 И │ БВозрастная группа @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               @@@@@@@@@@@@@@@@@ Б                                                                │ И
 И │-------------------------------------------------------------  --------------------------------------------------------------------------------------│ И
 И │                                                              │ &&&&&&&&&& │&&&&&&&&&&.&&│&&&&&&&.&&│  &&&&&&&.&& │&&&&&&&.&&│&&&&&&&.&&│&&&&&&&&&.&&│ И
.}
 И └──────────────────────────────────────────────────────────────┴────────────┴─────────────┴──────────┴─────────────┴──────────┴──────────┴────────────┘ И
 И.end И
.}
.endform

.Linkform 'PFNEWVZ_Link03' Prototype is 'PFNEWVZ'
.nameinlist 'Отчет о страховых взносах на обязательное пенсионное страхование'
.group 'NewOtch'
.DEFO LANDSCAPE
.p 50
.var
  Str_Sex  : string;
.endvar
.{ NewVz_Loop CheckEnter
.fields
TecPodrName
Month1Name Month2Name YearOtch
.endfields


             БОтчет о страховых взносах на обязательное пенсионное страхование Б
             Бпо Б  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  Бза период Б ^ - ^ @@@@  Бгода Б

.{ NewVzPers_Loop CheckEnter
.fields
LoopPodrName
.endfields
    Подразделение :  ^
 И ┌─────────────┬───────────────────────────┬────┬──────────┬─────────────────┬────────────────────────────────────┬────────────────────────────────────┐
 │ БТабельный  Б   │            БФ.И.О. Б          │ БПол Б │ Б БДата      │ БСтраховой Б        │ БОблагаемая база Б                     | БСуммы страховых взносов Б             │
 │ Бномер Б        │                           │    │ Брождения Б  │ Бномер Б            ├───────────┬───────────┬────────────┼───────────┬───────────┬────────────┤
 │             │                           │    │          │                 │ Бдо Б         │ Бсвыше Б      │  БИтого Б      │ Бдо Б         │ Бсвыше Б      │  БИтого Б      │ Б Б
 │             │                           │    │          │                 │ Бпревышения Б │ Бпревышения Б │            │ Бпревышения Б │ Бпревышения Б │            │
 ├─────────────┼───────────────────────────┼────┼──────────┼─────────────────┼───────────┼───────────┼────────────┼───────────┼───────────┼────────────┤ И
.{ NewVzGroup_Loop CheckEnter
.begin
  if (SEX = 'МУЖ')
    Str_Sex := 'МУЖЧИНЫ'
  else if (SEX = 'ЖЕН')
    Str_Sex := 'ЖЕНЩИНЫ'
  else
  {
    Str_Sex := 'БЕСПОЛЫЕ';
    VozGrpup := '0';
  }

end.
.if TheNextgroup
 И │-----------------------------------------------------------------------------------------------------------------------------------------------------│ И
 И │ БВозрастная группа @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               @@@@@@@@@@@@@@@@@ Б                                                                │ И
 И │-----------------------------------------------------------------------------------------------------------------------------------------------------│ И
.end
.fields
VozGrpup Str_Sex
TabNom FIO SEX  BornYear  StrahNom
basedoprev baseposleprev (basedoprev+baseposleprev)
nalogdoprev nalogposle   (nalogdoprev+nalogposle)
.endfields
 И │@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@│&&&&&&&&.&&│&&&&&&&&.&&│&&&&&&&&&.&&│&&&&&&&&.&&│&&&&&&&&.&&│&&&&&&&&&.&&│
.}
 └─────────────┴───────────────────────────┴────┴──────────┴─────────────────┴───────────┴───────────┴────────────┴───────────┴───────────┴────────────┘
.}
 И.if TheGroupsItog
 И ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
 │                                                                    БИ  Т  О  Г  И Б                                                                     │ И
 И │-----------------------------------------------------------------------------------------------------------------------------------------------------│
 │                                                              │  БКол-во Б     │ БОблагаемая база Б                     | БСуммы страховых взносов Б             │
 │                                                              │  Бработников Б ├───────────┬───────────┬────────────┼───────────┬───────────┬────────────┤
 │                                                              │  Бв группе Б   │ Бдо Б         │ Бсвыше Б      │  БИтого Б      │ Бдо Б         │ Бсвыше Б      │ БИтого Б       │ Б Б
 │                                                              │            │ Бпревышения Б │ Бпревышения Б │            │ Бпревышения Б │ Бпревышения Б │            │ И
.{ GroupsItog CheckEnter
.fields
  VozGrpup_I
  Sex_I
  CountPeople
  sumBD SumBP (sumBD+SumBP)
  SumND SumNP (SumND+SumNP)
.endfields
 И │-----------------------------------------------------------------------------------------------------------------------------------------------------│ И
 И │ БВозрастная группа @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               @@@@@@@@@@@@@@@@@ Б                                                                │ И
 И │-----------------------------------------------------------------------------------------------------------------------------------------------------│ И
 И │                                                              │ &&&&&&&&&& │&&&&&&&&.&&│&&&&&&&&.&&│&&&&&&&&&.&&│&&&&&&&&.&&│&&&&&&&&.&&│&&&&&&&&&.&&│ И
.}
 И └──────────────────────────────────────────────────────────────┴────────────┴───────────┴───────────┴────────────┴───────────┴───────────┴────────────┘ И
 И.end И
.}
.endform
