//******************************************************************************
//                                                      (с) корпорация Галактика
// Галактика 8.1 - базовая функциональность
// Конкурентная транзакция
//******************************************************************************

#ifndef _ConcurrentTransaction_vip_INCLUDED_
#define _ConcurrentTransaction_vip_INCLUDED_

#include ITransaction.obj

#ifdef ComponentVersion
#component "c_common"
#end

#doc
  Инкапсулирует работу с конкурентными транзакциями БД.</brief>

  <p>Допускается использование только переменных-ссылок на разделяемую копию
  ConcurrentTransaction. Вызов метода Run необходим только в тех случаях,
  когда используется переменная типа "ссылка на vip-интерфейс" - для того,
  чтобы сработала ее автоинициализация. В случае использования переменной типа
  "ссылка на obj-интерфейс" начало транзакции совпадает с моментом
  инициализации ссылки функцией GetVipRef. Использование ссылки на разделяемую
  копию автоматически решает проблему вложенных транзакций. Реально транзакция
  начинается в момент загрузки интерфейса, а заканчивается при его уничтожении,
  если только транзакция не была прервана с помощью вызова метода Cancel - в
  этом случае выполнится ее откат.</p>
#end
vipinterface ConcurrentTransaction implements ITransaction
#ifdef ATL51
  licensed(free)
#end
;

#end
