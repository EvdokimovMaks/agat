/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,2003 корпорация ГАЛАКТИКА                    ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Версия        : 5.8                                                       ║
 ║ Назначение    : Сохранение и отображение информации о необходимости       ║
 ║                 дополнительных прав на доступ к таблицам                  ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#ifndef __NEEDRIGHTS_VIH__
#define __NEEDRIGHTS_VIH__

const
  nrRead   : word = 1;
  nrInsert : word = 2;
  nrUpdate : word = 4;
  nrDelete : word = 8;
end;

#component "C_COMMON"

// ---------------------------------------------------------------------------
// Объект для сбора и отображения информации о необходимых правах для
// выполнения каких-либо операций.
// ---------------------------------------------------------------------------
#doc
  Сохранение и отображение информации о необходимости дополнительных прав на доступ к таблицам
#end
ObjInterface oNeedRights;

  #doc
  Очистка списка таблиц
  #end
  procedure Clear;

  #doc
  Добавление информации о требуемх правах на таблицу
  Передаваемые параметры:
         pwTable - код таблицы
         pwRights - битовая маска прав
  #end
  function AddTable(pwTable : word; pwRights : word ) : boolean;

  #doc
  Возвращает количество таблиц по которым требуются дополнительные права
  #end
  function NumberOfTables : word;

  #doc
  Отображение информации о требуемых правах
  После отображения список таблиц очищается.
  #end
  procedure ShowRights;

  #doc
  Выдача результата проверки наличия прав на модификацию данных
  #end
  function HaveModifyRights : boolean;
end;

VipInterface NeedRights
  implements oNeedRights
#ifdef ATL51
  licensed   (FREE)
#end
;

#doc
Проверка наличия прав на модификацию данных
#end
ObjInterface oCheckRights;
  #doc
  Проверка наличия прав на модификацию данных
  #end
  procedure CheckModifyRights( var pvNeedRights : NeedRights );
end;

#endif // __NEEDRIGHTS_VIH__
