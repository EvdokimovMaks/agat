//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 9.1
// Деноминация в РБ 2016 года
//******************************************************************************

#ifndef _DenominationMaster_vih_
#define _DenominationMaster_vih_

#component "C_Denominator"

ObjInterface ObjDenominationMaster;
  #doc
    Деление на 10000 вещественных типов данных с плавающей точкой
  #end
  Procedure Div10000Double(var Summa : double);

  #doc
    Деление на 10000 вещественных типов данных с фиксированной точкой
  #end
  Procedure Div10000Decimal(var Summa : tSumma);

  #doc
    Деление на 10000 целых чисел
  #end
  Procedure Div10000Longint(var Summa : longInt);

  #doc
    Деление на 10000 вещественных типов данных с плавающей точкой и округлением до копеек
  #end
  Procedure Div10000DoubleRound2(var Summa : double);

  #doc
    Деление на 10000 вещественных типов данных с фиксированной точкой и округлением до копеек
  #end
  Procedure Div10000DecimalRound2(var Summa : tSumma);

  #doc
    Проверка ссылки на валюту, является значение ссылкой на НДЕ
  #end
  Function ValutRefIsNde(var cValut : comp) : boolean;

  #doc
    Управляющая функция мастера деноминации, обозначает для визуализации процесса начало
    очередного этапа для очередной таблицы.
  #end
  Function EnterStageHeader(StageName : string) : boolean;

  #doc
    Управляющая функция мастера деноминации, обозначает в протоколе завершение начатого этапа таблицы.
    И подсчитывает итог по накопленным.
  #end
  Procedure LeaveStageHeader;

  #doc
    Управляющая функция мастера деноминации, для отработки прерывания сквозного процесса деноминации.
  #end
  Function CheckStop : boolean;

  #doc
    Управляющая функция мастера деноминации, обработка кодов ошибок обновления записей в БД
    с выдачей сообщения в отчетном протоколе.
  #end
  Function CheckError(Res : longint) : boolean;

  #doc
    Выдача в отчет произвольной ошибки.
  #end
  Procedure ReportError(msg:string);

  #doc
    Выдача в отчет произвольного сообщения.
  #end
  Procedure ReportMessage(msg:string);

  #doc
    Регистрация в мастере деноминации, программного блока обработки таблиц компоненты.
  #end
  Procedure AddPlugin(PluginName : String; PluginInfo : String);

  #doc
    Регистрация в мастере деноминации, информации о начальной пометке для внешних атрибутов
    требуемых в деноминации.
  #end
  Procedure AddExtAttrPreset(CodeTable : word; AttrName : string);

  Function GetMarkerExtAttr: TPtr;

  Function GetDenominationWithDSQL : boolean;

  #doc
    Округлять тарифы и оклады в модулях "Управление персоналом" и "Заработная плата"
  #end
  property NeedRoundTarif : boolean read;
End;

ObjInterface ObjDenominationPlugin;
  Function MakeDenomination(DenMaster : ObjDenominationMaster) : boolean;
End;

VipInterface DenominationMaster Implements ObjDenominationMaster
   licensed (B_ACT, B_BALANS, B_FINANS, B_HOZOP, B_KASSA, B_OSN, MBP, SKLAD2, OL_KBU, BUY, POSTPOL, SELL, SKLAD, OL_KL, MENUZARP2, MENUZARP, OL_UP, OL_UP2);

ExtensionPoint EpDenominationRegPlugin(DenMaster : ObjDenominationMaster);

ObjInterface ObjDenominationChoise;
  Function OnGetText : string;
  Function OnPick : boolean;
  Function OnAllowMake : boolean;
  Function OnMakeDenomination(DenMaster : ObjDenominationMaster) : boolean;
End;

VipInterface DenominationChoise_L_CalcUsl Implements ObjDenominationChoise licensed (free);
VipInterface DenominationChoise_M_MnPlan Implements ObjDenominationChoise licensed (free);

#endif
