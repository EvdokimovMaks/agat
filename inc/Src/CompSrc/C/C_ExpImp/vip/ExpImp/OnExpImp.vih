//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Импорт/экспорт
// Обработка событий вызова экспорта-импорта из интерфейсов документов
//******************************************************************************

// для объявления переменной необходимо использовать #include OnExpImp.var (для
// обеспечения межверсионной устойчивости), в котором описана переменная oOnExpImp
// с типом текущей последней версии объекта
//
// пример использования:
//      if oOnExpImp.CheckFinCanDeleteDO(BaseDoc.VidDoc, BaseDoc.NRec)

//******************************************************************************
#ifNdef __OnExpImp_vih__
#define __OnExpImp_vih__

//******************************************************************************

#component "C_EXPIMP"

//******************************************************************************
// свежая версия:
// #include OnExpImpV1.vih

#doc
Объектный интерфейс обработки событий вызова экспорта/импорта из интерфейсов документов<br>
#end

ObjInterface ObjOnExpImpV1;

//******************************************************************************
#doc
Функция формирует сигнатуру маркера выбранных документов<br>
wDocType - тип документа<br>
wDocSubType - подтип документа<br>
Результат - строковое значение вида 'ieExport_wDocType_wDocSubType'<br>
#end
Function ieMarkerSignature( 
           wDocType           : Word
         ; wDocSubType        : Word 
         ): String;
//******************************************************************************

#doc
Функция проверяет наличие лицензии на модоль "Обмен бизнес-документами" или "Клиент-банк"
в зависимости от типа документа<br>
wDocType - тип документа<br>
Результат - true, если лицензия есть, иначе - false<br>
#end
Function ieExistLicense(                // проверка лицензии на "Экспорт-Импорт"
           wDocType: word               // тип документа
         ): boolean;                    // TRUE - работа в обычном режиме
//******************************************************************************

#doc
Обработчик события cmExp в интерфейсах документов. Вызывает настройку экспорта для заданного типа и подтипа документов<br>
wDocType - тип документа.<br>
wDocSubType - подтип документа.<br>
cDocument - NRec документа, используется, если следующие два параметра нулевые, либо они ненулевые, но по ним нет пометок<br>
wList - код помеченных из Pick.wList <br>
hExternalMarkers - код помеченных из маркера<br>
#end
Procedure OnExportHandler(              // обработчик события cmExp в интерфейсах документов
            wDocType          : word    // тип документа
          ; wDocSubType       : word    // подтип документа
          ; cDocument         : comp    // NRec документа, используется, если 1) следующие два параметра нулевые либо 2) они ненулевые, но по ним нет пометок
          ; wList             : word    // код помеченных из Pick.wList
          ; hExternalMarkers  : longint // код помеченных из маркера
          );
//******************************************************************************

#doc
Обработчик события cmImp в интерфейсах документов. Запускает настройку импорта для заданного типа и подтипа документов<br>
wDocType - тип документа.<br>
wDocSubType - подтип документа.<br>
#end
Procedure OnImportHandler(              // обработчик события cmImp в интерфейсах документов
            wDocType          : word    // тип документа
          ; wDocSubType       : word    // подтип документа
          );
//******************************************************************************

#doc
Обработчик события cmIEHist в интерфейсах документов.<br>
wDocType - тип документа.<br>
wDocSubType - подтип документа.<br>
#end
Procedure OnExportImportHistory(        // обработчик события cmIEHist в интерфейсах документов
            wDocType          : word    // тип документа
          ; cDocument         : comp    // ссылка на запись документа
          );
//******************************************************************************

end;

//******************************************************************************

VipInterface OnExpImpV1 implements ObjOnExpImpV1 licensed (FREE);


#end
//******************************************************************************
//******************************************************************************
