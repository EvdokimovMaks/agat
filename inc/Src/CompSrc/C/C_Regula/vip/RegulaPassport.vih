//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 9.1
// Регула - паспортные данные 
//
//******************************************************************************

#ifndef __RegulaPassport_vih__
#define __RegulaPassport_vih__

#ifdef ComponentVersion
#component "C_Regula"
#end

#doc
Структура TRegulaPassportInfo содержит паспортные данные,
доступные для получения со сканера документов Regula
#end
type
  TRegulaPassportInfo = record
    DateFormat                     : string[10];
    Document_Class_Code            : string[2];
    Issuing_State_Code             : string[3];
    Document_N                     : string[10];
    Date_of_Expiry                 : date;
    Date_of_Issue                  : date;
    Date_of_Birth                  : date;
    Place_of_Birth_BEL             : string[80];
    Place_of_Birth_RUS             : string[80];
    Personal_N                     : string[20];
    Surname_BEL                    : string;
    Surname_RUS                    : string;
    Surname_ENG                    : string;
    Given_names_ENG                : string;
    Given_names_BEL                : string;
    Given_names_RUS                : string;
    Sex_ENG                        : string[1];
    Sex_RUS                        : string[1];
    Authority_BEL                  : string[40];
    Authority_RUS                  : string[40];
    Surname_And_Given_Names_BEL    : string;
    Surname_And_Given_Names_RUS    : string;
    Fathers_Name_BEL               : string;
    Fathers_Name_RUS               : string;
    Nationality_Code               : string[3];
    Nationality_BEL                : string;
    Nationality_RUS                : string;
    Optional_Data                  : string;
    Issuing_State                  : string[60];
    MRZ_Lines                      : string;
    Check_digit_of_document_number : word;
    Check_digit_of_birth_date      : word;
    Check_digit_of_expiry_date     : word;
    Final_check_digit              : word;
    Age                            : word;
    Check_digit_of_Optional_data   : word;
    City                           : string[20];
    Area                           : string[20];
    State                          : string[20];
    Country                        : string[20];
    Months_to_Expire               : word;
    Residence_Permit_BEL           : string;
    Residence_Permit_RUS           : string;
end;

#doc
Объектный интерфейс IRegulaPassport предназначен для получения
паспортных данных со сканера Regula.
Может использоваться в двух сценариях:
1. Подписка на событие OnResultReady, возникающее по завершении сканирования
2. Принудительный запуск сканирования функцией Read
#end

ObjInterface IRegulaPassport;

  #doc
  Выполняет сканирование документа и помещает полученные данные в структуру TRegulaPassportInfo.
  Возвращает TRUE в случае успешного завершения.
  #end
	function Read(var info: TRegulaPassportInfo): boolean;

  #doc
  Возвращает строку с описанием последней ошибки.
  #end
	function GetLastError: string;

  #doc
  Активируется сканером после завершения сканирования.
  Принимает результат сканирования в структуру TRegulaPassportInfo.
  #end
  event Procedure OnResultReady(info: TRegulaPassportInfo);

  #doc
  Активируется сразу после начала сканирования
  #end
  event Procedure OnStartProcessing;

  #doc
  Регулирует выдачу сообщений об ошибках: TRUE - выдавать сообщения, FALSE - не выдавать.
  По умолчанию TRUE.
  #end
  property ShowMessages: boolean read write;

End;

ObjInterface IRegulaPassportExt1(IRegulaPassport);
  #doc
  Установка подкаталога для сохранения изображений
  #end
  procedure SetImageSubFolder (sValue : string);
end;

VipInterface RegulaPassport implements IRegulaPassportExt1 licensed(free);

#end
