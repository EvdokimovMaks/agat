//------------------------------------------------------------------------------
//                                                      (c) корпорация ГАЛАКТИКА
// Галактика
// Базовые интерфейсы управления хранилищами шаблонов и спецификаций
//------------------------------------------------------------------------------
#ifndef _template_vih_included_
#define _template_vih_included_

#component "C_Template"
#include IModify.vih

//------------------------------------------------------------------------------
#doc
  Базовый интерфейс "Хранилище шаблонов"
#end

public ObjInterface ITemplate;
  property NRec:      comp       read write;
  //наименование шаблона
  property Name:      tName      read write;
  //ссылка на код таблицы
  property TableCode: word       read write;

  index IdxNRec =  NRec(unique);
  index IdxShablon = TableCode, Name;

end;

//------------------------------------------------------------------------------
#doc
  Базовый функционал управления перечнем шаблонов
#end
public ObjInterface ITemplateRule;

  //Добавление шаблона, если успешно возвращает номер записи в таблице(иначе 0)
  function Add(TableCode: word; Name: string): comp;

  //Удаление шаблона
  function Del(NRec: comp): boolean;

  //Возвращает наименование шаблона
  function GetName(NRec: comp): string;

end;

//------------------------------------------------------------------------------
#doc
  Базовый интерфейс "Хранилище спецификаций"
#end
#ifdef Gal9_1
public ObjInterface ISpecification;
  //Наименование спецификации
  property Name :   s30         read write;
  //Значение спецификации
  property Value:   string      read write;
  //Ссылка на шаблон
  property Shablon: comp        read write;

  index IdxShablon = Shablon, Name;
end;
#else
public ObjInterface ISpecification;
  //Наименование спецификации
  property Name :   s15         read write;
  //Значение спецификации
  property Value:   tName       read write;
  //Ссылка на шаблон
  property Shablon: comp        read write;

  index IdxShablon = Shablon, Name;
end;
#end
//------------------------------------------------------------------------------
#doc
  Базовый функционал управления спецификациями шаблонов
#end
public ObjInterface ISpecificationRule;
  //Добавление спецификации в шаблон
  function Add(Name: string; Value: string): boolean;

  //Удаление спецификации из шаблона
  function Del(NRec: comp): boolean;
end;

//------------------------------------------------------------------------------

public vipinterface Template implements ITemplate, IModify licensed(free);

public vipinterface TemplateRule implements ITemplateRule licensed(free);

public vipinterface Specification implements ISpecification, IModify licensed(free);

public vipinterface SpecificationRule implements ISpecificationRule licensed(free);

//------------------------------------------------------------------------------
#end

