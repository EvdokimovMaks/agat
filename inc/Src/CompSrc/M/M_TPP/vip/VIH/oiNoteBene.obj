//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.1 Производственный контур/Спецификации продуктов
//               объектный интерфейс работы с извещениями
//******************************************************************************


#ifndef __OINOTEBENE_VIH
#define __OINOTEBENE_VIH

#ifdef ComponentVersion
#component "M_TPP"
#end

#include tRawChng.tbl
#include ListOutP.vih

#doc
объектный интерфейс работы с извещениями</brief>
#end

ObjInterface oiNoteBene;

#doc
установка на нужное извещение</brief>
#end
  function SetOwner(cNtBn : comp) : integer;

#doc
проверка есть ли документ в акте на замену или извещении</brief>
<I>wDoc</I>  - вид документа
<I>cDoc</I>  - nRec документа
<I>wFlag</I> - 1- в конкретном извещении, 0 - по всем извещениям
В случае успеха возвращает <I>tsOk</I>
#end
  function GetDocHistory(wDoc : word; cDoc : comp; wFlag : word): integer;

#doc
Удалить документ из акта замен или извещения</brief>
<I>wDoc</I>  - вид документа
<I>cDoc</I>  - nRec документа
<I>wFlag<I> - 1- в конкретном извещении, 0 - по всем извещениям
В случае успеха возвращает <I>tsOk</I>
#end
  function xDeleteDocs  (wDoc : word; cDoc : comp; wFlag : word): integer;

#doc
Удалить всю историю замен связанную с этим документом</brief>
<I>wDoc</I>  - вид документа
<I>cDoc</I>  - nRec документа
<I>wFlag</I> - 1- в конкретном извещении, 0 - по всем извещениям
В случае успеха возвращает <I>tsOk</I>
#end
  function xDeleteAllHistory(wDoc : word; cDoc : comp; wFlag : word): integer;

#doc
Проверка - есть ли история замен для конкретной записи</brief>
<I>wDoc</I> - вид документа
<I>cRec</I> - nRec позиции спецификации
В случае успеха возвращает <I>tsOk</I>
#end
  function GetPosHistory(wDoc : word; cRec : comp): integer;

#doc
Удаление всех историии замен для позиции спецификации</brief>
<I>wDoc</I> - вид документа
<I>cRec</I> - nRec позиции спецификации
В случае успеха возвращает <I>tsOk</I>
#end
  function xDeletePosHistory(wDoc : word; cRec : comp): integer;


#doc
заполнение информацией временной таблицы</brief>
<I>wDoc</I>  - вид документа
<I>cDoc</I>  - nRec документа
В случае успеха возвращает <I>tsOk</I>
#end
  function Fill_RawItems(wDoc : word; cDoc : comp): integer;

#doc
функция заполнения списка информацией о заменяемых/заменяющих ресурсах в
зависимости от значений передаваемых параметров</brief><br>
возвращает список МЦ и nRec акта в таблице AlgInDocList<br><br>
Параметры:<br>
<I>pt</I> - cписок актов, в которых ищем информацию
<I>wResource</I> - тип заменяемого ресурса  (МЦ/Услуга)
<I>сResource</I> - nRec заменяемого ресурса  (МЦ/Услуга)
<I>wFlag</I> - 0 - список МЦ/Услуг на которые можно менять по акту
               1 - список МЦ/Услуг на которые уже заменили (из истории замен)
<br>
Результат:<br>
возвращает количество найденных записей
#end
  function Fill_AlgDocList(pt:TRecAcc; wResource : word; cResource : comp; wFlag : word) : integer;

#doc
функция заполнения списка информацией о заменяемых/заменяющих ресурсах в
зависимости от значений передаваемых параметров</brief><br><br>
Параметры:<br>
<PRE>
<I>pt</I>      - cписок МЦ/Услуг из листа замен для которых формируется список
<I>wReturnedType</I>  - тип возращаемых элементов:
                1 - МЦ         2 - Услуга        4 - ПС  на МЦ  8 - ПС на Услугу
               16 - КС на МЦ  32 - КС на Услугу 64 - Группа   128 - Набор МЦ
<I>wReplacVariant</I> - 0 - список  МЦ/Услуг на которые можно заменить
                     ресурс - wResource, сResource
                 1 - список  МЦ/Услуг которые можно заменить
                     ресурсом  - wResource, сResource
<I>wReturnedTable</I> - возвращает данные в разных таблицах
                  0 - Список ресурсов и коэффициент  из листа замена
                      в AlgInDocList возвращает в таблице AlgInDocList - список
                      МЦ /Услуг
                       TypeDoc, cDoc    - тип и nRеc ПС КС
                       wTypeNorm, cNorm - тип и nRеc ресурса (МЦ, Услуга изделие
                       спецификации (МЦ, Услуга), Набор или Группа МЦ)
                  1 - Список ресурсов, коэфициент в vtOutP аналитика в vtOutP_An
                      потребители - исполнители в   vtOutP_ND
</PRE><br>
Результат:<br>
возвращает количество найденных записей
#end
  function ReplacmentList(pt:TRecAcc; wReturnedType : word;  wReplacVariant : word; wReturnedTable : word) : integer;

#doc
функция передачи объекта, который будем заполнять информацией о заменяемых
ресурсах</brief>
#end
  function LoadObjRef(foListOutP: oiListOutP) : integer;
end; // oiNoteBene

#endif  // __OINOTEBENE_VIH