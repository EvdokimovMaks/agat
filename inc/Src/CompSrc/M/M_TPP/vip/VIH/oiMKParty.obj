//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.12 Производственный контур/Спецификации продуктов
//                Сервис работы с партиями МЦ для операций МК
//******************************************************************************

#ifndef __OIMKPARTY_VIH
#define __OIMKPARTY_VIH

#ifdef ComponentVersion
#component "M_TPP"
#end

type
  rMKPartyParam = record
                    wVal$0,         // индекс партии среди аналитик операции
                    wVal$1,         // формирование партий доступно
                    wVal$2,         // порядок номера операции в наименовании партии
                    wVal$3,         // порядок операции в наименовании партии
                    wVal$4,         // порядок изделия в наименовании партии
                    wVal$5: word;   // порядок доп. строки в наименовании партии

                    cVal$1,         // nRec операции
                    cVal$2,         // nRec изделия
                    cVal$3: comp;   // nRec партии (резерв)

                    sVal$1,         // номер операции
                    sVal$2,         // наименование операции
                    sVal$3: string; // наименование изделия
                    sVal$4: s20;    // доп. строка
                    sVal$5: s6;     // строковый разделитель
                  end;

#doc
Сервис работы с партиями МЦ для операций МК</brief>
#end
ObjInterface oiMKParty;

#doc
установка параметров</brief>
#end
  procedure SetWorkParam(pPartyParam: rMKPartyParam);

#doc
установка партии в аналитику операции МК(создание партии)</brief>
#end
  function CreateParty: comp;

#doc
поиск партии [и создание]</brief>
#end
  function SearchParty(bCreateNew: boolean): comp;

#doc
удаление партии</brief>
#end
  function DeleteParty: boolean;
end; // oiMKParty

#doc
Сервис работы с партиями МЦ для операций МК (обновление определенных полей)</brief>
#end
ObjInterface oiMKParty01(oiMKParty);

#doc
функция обновления поля партии</brief><br>
Параметры:<br>
<I>wPrField</I> - 1 = (наименование партии<br>
Результат:<br>
в случае успеха возвращает <I>true</I> иначе <I>false</I><br>
#end
  function UpdateFieldKatParty(wPrField: word): boolean;
end; // oiMKParty

#endif  // __OIMKPARTY_VIH
