//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.1 Производственный контур/Спецификации продуктов
//               объектный интерфейс для работы с естественным показателем
//******************************************************************************

#ifndef __OINISRV_VIH
#define __OINISRV_VIH

#ifdef ComponentVersion
#component "M_TPP"
#end

ObjInterface oiNISrv; forward;

type
  rNIInfo = record
              dVal$1,                 // значение показателя
              dVal$2,                 // коэффициент пересчета материалов
              dVal$3: double;         // резерв
              dtVal$1,                // дата начала действия значения
              dtVal$2, dtVal$3: date; // резерв
              cVal$1,                 // ссылка на ед. изм. показателя
              cVal$2, cVal$3: comp;   // резерв
            end;

#doc
объектный интерфейс для работы со значениями естественного показателя</brief>
#end
ObjInterface oiNISrv;

#doc
устанавливает дату расчетов</brief>
#end
  procedure SetWorkDate(onDate: date);

#doc
устанавливает исходную спецификацию (через буфер с позицией)</brief>
#end
  procedure SetWorkDoc(rBuffer: type$p_HDR_PS);

#doc
устанавливает исходную спецификацию (через nRec)</brief>
#end
  function SetWorkDocKey(cKey: comp): longint;
//******************************************************************************

#doc
получить значения параметров (исходные данные уже должны быть установлены)</brief>
#end
  function GetInfo: rNIInfo;
//******************************************************************************

#doc
установить исходную спецификацию (через буфер с позицией) и получить значения</brief>
#end
  function GetInfoDoc(rBuffer: type$p_HDR_PS): rNIInfo;

#doc
установить исходную спецификацию (через nRec) и получить значения</brief>
#end
  function GetInfoDocKey(cKey: comp): rNIInfo;
end; // oiNISrv

#endif  // __OINISRV_VIH