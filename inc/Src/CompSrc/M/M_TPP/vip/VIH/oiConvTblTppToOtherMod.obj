//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 8.10 Производственный контур/Спецификации продуктов
// объектный интерфейс ковертации таблиц модуля "СП" в таблицы других модулей
//******************************************************************************


#ifndef __oiConvTblTppToOtherMod_VIH
#define __oiConvTblTppToOtherMod_VIH

#ifdef ComponentVersion
#component "M_TPP"
#end

#doc
объектный интерфейс ковертации таблиц модуля "СП" в таблицы других модулей</brief>
#end

ObjInterface oiConvTblTppToOtherMod;

#doc
установка рабочих параметров для расчета</brief>:<br>
<I>wFlag</I> - флаг параметров: бит: значение:<br>
<PRE>
                            0:    0 (0000)- очищать таблицу результатов (по умолчанию)
                                  1 (0001)- накапливать результаты
                          2,1:   00 (    )- в учетных ед.   (по умолчанию)
                                 01 (0002)- в тех, что есть
                                 10 (0004)- в акт.отпускных
                                 11 (0006)- резерв
                            3:    0 (    )- выключить визуализацию (по умолчанию)
                                  1 (0008)- включить визуализацию
                            4:    0 (    )- не разузловывать инструмент (по умолчанию)
                                  1 (0016)- разузловывать инструмент
                          6,5:   00 (    )- не учитывать %потерь и коэф.использования (по умолчанию)
                                 01 (0032)- учитывать %потерь
                                 10 (0064)- учитывать коэф.использования
                                 11 (    )- резерв
                            7:    0 (    )- выполнить пересчет формул (по умолчанию)
                                  1 (0128)- не выполнять пересчет формул
                    11,10,9,8: 0000 (    )- не проверять наличие ресурсов (по умолчанию)
                               0001 (0256)- проверять наличие материальных ресурсов
                               0010 (0512)- проверять наличие трудовых ресурсов
                               0100 (1024)- проверять наличие оборудования
                               1000 (2048)- проверять наличие инструментов
                           12:    0 (    )- контроль ресурсов по всему документу (по умолчанию)
                                  1 (4096)- пооперационный контроль ресурсов
                           13:    0 (    )- не доставать статью затрат (по умолчанию)
                                  1 (8192)- доставать статью затрат
                           14:    0 (    )- при поиске документа искать основной, при отсутствии - не основной (по умолчанию)
                                  1 (16384)- при поиске документа искать только основной
</PRE>
<I>wMode</I> - режим работы 0: бит: значение:
<PRE>
                            0:   0 (0000)- исключать фантомы (по умолчанию)
                                 1 (0001)- оставлять фантомы
                            1:   0 (    )- не открывать окно отладки скриптов (по умолчанию)
                                 1 (0002)- открывать окно отладки скриптов

                            учитывать категории:
                            2:   1 (0004)- учитывать покупные
                            3:   1 (0008)- учитывать собственного производства
                            4:   1 (0016)- учитывать фантомные
                            5:   1 (0032)- учитывать cубподрядные

                            учитывать характеристики:
                            6:   1 (0064)- учитывать материал
                            7:   1 (0128)- учитывать ДСЕ
                            8:   1 (0256)- учитывать инструмент, оснастку

                            9:   1 (0512)- учитывать продукт выхода
</PRE>
#end
  procedure SetParam(wFlag: word; wMode: word);

#doc
конвертация ПС в таблицы <I>KatDsNor</I>, <I>DsGotPr</I>, <I>DsNorm</I></brief>:<br>
<I>cHDR_PS</I>   - ссылка на ПС
<I>cBaseDoc</I>  - ссылка на таблицу BaseDoc
<I>wLevel</I>    - уровень разузлования (<I>>0</I> - на все уровни)
<I>wTypeConv</I> - код, говорящий что куда конвертируется

возвращает ссылку на созданную запись таблицы <I>KatDsNor</I>
#end
  function ConvTblSrcToTables(cHDR_PS:comp; cBaseDoc: comp; wLevel: word; wTypeConv: word): comp;

end;
#endif  // __oiConvTblTppToOtherMod_VIH
