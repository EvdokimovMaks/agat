
#define OI_OPParams
ObjInterface oOPParams;

  // Загрузка параметров объекта планирования;
  Function SetOPParams(var bfOPInfo: type$p_OPInfo;
                            dDate  : Date;
                            eDate  : Date): Boolean;


  // Получить значение параметра объекта планирования
  function GetOPParamValue(
                           bfOPInfo  : type$p_OPInfo; // Структура записи ОП
                           wKpn      : word;          // Константа КПН
                           var dPar  : TSumma;        // Значение КПН
                           var cEd   : comp;          // Единица измерения
                           var dParty: TSumma         // Размер партии
                          ): boolean;

  // Записать значение параметра объекта планирования
  Function SetOPParamValue(
                           var bfOPInfo  : type$p_OPInfo; // Структура записи ОП
                               wKpn      : word;          // Константа КПН
                               dPar      : Double;        // Значение КПН
                               cEd       : comp;          // Единица измерения
                               dParty    : Double         // Размер партии
                          ): boolean;

  // Пересчитать параметры объекта планирования
  Function RecalcOPParams(var bfOPInfo: type$p_OPInfo;
                              cEdNew  : Comp
                         ): Boolean;

  // Начало расчета остатков (вызывается перед первым вызовом SetOPInvOnHand)
  Function StartMc(dDate: Date): Boolean;

  // Окончание расчета остатков (вызывается после последнего вызова SetOPInvOnHand)
  Function EndMc: Boolean;

  // Расчет остатков
  Function SetOPInvOnHand(var bfOPInfo: type$p_OPInfo; dDate: Date): Boolean;

  //'Выполнять или нет апдейт в ф-циях объекта
  Procedure UpdateOPInfo( fUpdate:Boolean );

end;