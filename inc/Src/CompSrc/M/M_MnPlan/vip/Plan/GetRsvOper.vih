// =============================================================================
//                                                     (c)  корпорация Галактика
// Галактика 7.1 - Производственный контур
// Прототип интерфейса Журнала резервирования  для встраивания в другие
// интерфейсы
// =============================================================================

#ifdef ComponentVersion
#component "M_MnPlan"
#end

//------------------------------------------------------------------------------
// Структура для хранения информации
#ifndef __Def_TRsvOperPrmInfo__
#define __Def_TRsvOperPrmInfo__
#doc
Структура для хранения информации по производственным центрам </brief> <br>
<b>Поля:</b> <br>
  cMCRsvOper - Ссылка на WrkFndPE_Hdr (производственный центр) <br>
  wOper      - Код операции (1 - удаление, 2 - замена "F3")<br>
  KauPrEdOld - Кау старого производственного центра <br>
  cPrEdOld   - Ссылка на старый производственный центр <br>
  KauPrEdNew - Кау нового производственного центра <br>
  cPrEdNew   - Ссылка на новый производственный центр <br>
#end
Type
  TRsvOperPrmInfo = record
    cMCRsvOper: comp;
    wOper: word;
    KauPrEdOld: word;
    cPrEdOld: comp;
    KauPrEdNew: word;
    cPrEdNew: comp;
  End; // record TRsvOperPrmInfo
#endif

#doc
Описание интерфейс-объекта для журнала резервирования планового фонда производственных центров <br>
<b>Внимание!</b> Интерфейс предназначен только для внутреннего использования </brief> <br>
#end
ObjInterface oGetRsvOper;

#doc
Устанавливает владельца для журнала резервирования планового фонда производственных центров <br>
<b>Внимание!</b> Функция предназначена только для внутреннего использования </brief> <br>
<b>Параметры:</b><br>
  cWrkFndPE_Hdr - Ссылка на WrkFndPE_Hdr (производственный центр) <br>
#end
Procedure SetOwner( cWrkFndPE_Hdr : comp; cVarPlan: comp);
#doc
Удаление всех записей журнала резервирования по производственному центру  <br>
<b>Внимание!</b> Функция предназначена только для внутреннего использования </brief> <br>
<b>Параметры:</b><br>
  cWrkFndPE_Hdr - Ссылка на WrkFndPE_Hdr (производственный центр) <br>
<b>Результат:</b> <br>
  True, если все Ok <br>
#end
Function DelRsvOperForOwner( cWrkFndPE_Hdr : comp): boolean;
#doc
Проверка на наличие записей в журнале резервирования по производственному центру  <br>
<b>Внимание!</b> Функция предназначена только для внутреннего использования </brief> <br>
Назначение: <br>
 - проверяет наличие записей в журнале резервирования по производственному центру <br>
 - запрещает удаление/замену производственного центра при наличии записей в журнале резервирования <br>
<b>Параметры:</b><br>
  strRsvOperPrmInfo - Структура для хранения информации по производственному центру<br>
  Поля:<br>
  cMCRsvOper - Ссылка на WrkFndPE_Hdr (производственный центр) <br>
  wOper      - Код операции (1 - удаление, 2 - замена "F3")<br>
  KauPrEdOld - Кау старого производственного центра <br>
  cPrEdOld   - Ссылка на старый производственный центр <br>
  KauPrEdNew - Кау нового производственного центра <br>
  cPrEdNew   - Ссылка на новый производственный центр <br>
<b>Результат:</b><br>
  True, если все Ok <br>
#end
Function CheckAction(var strRsvOperPrmInfo: TRsvOperPrmInfo):boolean;

End;

VipInterface GetRsvOper Implements oGetRsvOper

 #ifdef ATL51
 Licensed (FREE)
 Parameters (p_WrkFndPE_Hdr: comp)
 #end

;



