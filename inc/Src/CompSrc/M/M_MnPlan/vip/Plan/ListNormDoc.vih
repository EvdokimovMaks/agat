// =============================================================================
//                                                     (c)  корпорация Галактика
// Галактика 7.11 - Производственный контур
// Описание интерфейса-объекта "Список документов-норм"
// =============================================================================

#component "M_MnPlan"

//******************************************************************************
// Типы данных

//------------------------------------------------------------------------------
// Структура для хранения ссылки на документ-норму
#ifndef __Def_TRecNormDoc__
#define __Def_TRecNormDoc__
#doc
 Структура для хранения ссылки на документ-норму</brief> <br>
 Поля: <br>
   CalcGroup - Код группы расчета <br>
   CalcDate  - Дата расчета <br>
   TypeDoc   - КАУ документа <br>
   cDoc      - Ссылка на документ-норму <br>
   wPriority - Приоритет <br>
   dCnvKoef  - Коэффициент пересчета <br>
   dCount_EN - Единица нормирования (количество) <br>
   cOtpEd_EN - Ссылка на отпускную единицу измерения для единицы нормирования <br>
   cTmOut    - Ссылка на соответствующую запись TmOut <br>
   cOtpEdFN  - Ссылка на отпускную единицу измерения для единицы нормирования для поиска норм <br>
   MinCount  - Минимальное количество <br>
   MaxCount  - Максимальное количество <br>
   TypeBnd   - Тип ограничения (0-локальное, 1-общее) <br>
#end
Type TRecNormDoc = record
  CalcGroup: comp;   // Код группы расчета
  CalcDate: date;    // Дата расчета
  TypeDoc: word;     // КАУ документа
  cDoc: comp;        // Ссылка на документ-норму
  wPriority: word;   // Приоритет
  dCnvKoef: double;  // Коэффициент пересчета
  dCount_EN: double; // Единица нормирования (количество)
  cOtpEd_EN: comp;   // Ссылка на отпускную единицу измерения для единицы нормирования
  cTmOut: comp;      // Ссылка на соответствующую запись TmOut
  cOtpEdFN: comp;    // Ссылка на отпускную единицу измерения для единицы нормирования для поиска норм
  MinCount: double;  // Минимальное количество
  MaxCount: double;  // Максимальное количество
  TypeBnd: word;     // Тип ограничения (0-локальное, 1-общее)
End; // Type TRecNormDoc = record
#endif

//******************************************************************************
// ObjInterface oiListNormDoc
#ifndef __Def_OI_ListNormDoc__
#define __Def_OI_ListNormDoc__
#doc
 Описание интерфейса-объекта "Список документов-норм"</brief>
#end
ObjInterface oiListNormDoc;

//------------------------------------------------------------------------------
#doc
 Просмотр буфера</brief> <br>
 Параметры: <br>
   asWindowTitle - Заголовок окна <br>
#end
Procedure ViewData(asWindowTitle: string);

//------------------------------------------------------------------------------
#doc
 Получение копии записи</brief> <br>
 Параметры: <br>
   awFlag            - = 0 <br>
   ardRecNormDoc_Src - Структура-источник для хранения ссылки на документ-норму <br>
   ardRecNormDoc_Dst - Структура-приемник для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если успешно <br>
#end
Function AssignRec(awFlag: word; ardRecNormDoc_Src: TRecNormDoc;
  var ardRecNormDoc_Dst: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Получение порядкового номера текущей записи</brief> <br>
 Результат: <br>
   Npp записи, 0 - если запись не определена <br>
#end
Function GetCurRecNpp: comp;

//------------------------------------------------------------------------------
#doc
 Чтение текущей записи в списке</brief> <br>
 Параметры: <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если успешно <br>
#end
Function GetCurRec(var ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Обновление текущей записи в списке</brief> <br>
 Параметры: <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если успешно <br>
#end
Function UpdCurRec(ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Поиск в списке</brief> <br>
 Параметры: <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   Порядковый номер в списке <br>
#end
Function Find(ardRecNormDoc: TRecNormDoc): comp;

//------------------------------------------------------------------------------
#doc
 Переход на запись</brief> <br>
 Параметры: <br>
   acNpp - Порядковый номер в списке <br>
 Результат: <br>
   True, если успешно <br>
#end
Function GoToRec(acNpp: comp): boolean;

//------------------------------------------------------------------------------
#doc
 Добавление в список</brief> <br>
 Параметры: <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   Порядковый номер <br>
#end
Function Add(ardRecNormDoc: TRecNormDoc): comp;

//------------------------------------------------------------------------------
#doc
 Очистка списка</brief> <br>
 Параметры: <br>
   acCalcGroup - Код группы расчета (0 - на важен) <br>
 Результат: <br>
   True, если успешно <br>
#end
Function Clear(acCalcGroup: comp): boolean;

//------------------------------------------------------------------------------
#doc
 Удаление из списка</brief> <br>
 Параметры: <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если успешно <br>
#end
Function Del(ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Получение первой записи</brief> <br>
 Параметры: <br>
   acCalcGroup   - Код группы расчета (0 - не важен) <br>
   adtCalcDate   - Дата расчета (date(0, 0, 0) - не учитывается) <br>
   acTmOut       - Значение cTmOut (0 - не важно) <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если запись найдена <br>
#end
Function GetFirstNormDoc(acCalcGroup: comp; adtCalcDate: date; acTmOut: comp;
  var ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Получение последней записи</brief> <br>
 Параметры: <br>
   acCalcGroup   - Код группы расчета (0 - не важен) <br>
   adtCalcDate   - Дата расчета (date(0, 0, 0) - не учитывается) <br>
   acTmOut       - Значение cTmOut (0 - не важно) <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если запись найдена <br>
#end
Function GetLastNormDoc(acCalcGroup: comp; adtCalcDate: date; acTmOut: comp;
  var ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Получение следующей записи относительно текущей позиции</brief> <br>
 Параметры: <br>
   acCalcGroup   - Код группы расчета (0 - не важен) <br>
   adtCalcDate   - Дата расчета (date(0, 0, 0) - не учитывается) <br>
   acTmOut       - Значение cTmOut (0 - не важно) <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если запись найдена <br>
#end
Function GetNextNormDoc(acCalcGroup: comp; adtCalcDate: date; acTmOut: comp;
  var ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Получение предыдующей записи относительно текущей позиции</brief> <br>
 Параметры: <br>
   acCalcGroup   - Код группы расчета (0 - не важен) <br>
   adtCalcDate   - Дата расчета (date(0, 0, 0) - не учитывается) <br>
   acTmOut       - Значение cTmOut (0 - не важно) <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если запись найдена <br>
#end
Function GetPrevNormDoc(acCalcGroup: comp; adtCalcDate: date; acTmOut: comp;
  var ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Получение первой записи типа документов-норм</brief> <br>
 Параметры: <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если запись найдена <br>
#end
Function GetFirstTypeDoc(var ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Получение последней записи типа документов-норм</brief> <br>
 Параметры: <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если запись найдена <br>
#end
Function GetLastTypeDoc(var ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Получение следующей записи типа документов-норм относительно текущей позиции</brief> <br>
 Параметры: <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если запись найдена <br>
#end
Function GetNextTypeDoc(var ardRecNormDoc: TRecNormDoc): boolean;

//------------------------------------------------------------------------------
#doc
 Получение предыдующей записи типа документов-норм относительно текущей позиции</brief> <br>
 Параметры: <br>
   ardRecNormDoc - Структура для хранения ссылки на документ-норму <br>
 Результат: <br>
   True, если запись найдена <br>
#end
Function GetPrevTypeDoc(var ardRecNormDoc: TRecNormDoc): boolean;

End; // ObjInterface oiListNormDoc

VipInterface iListNormDoc implements oiListNormDoc Licensed(Free);

#endif
