/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,2002 корпорация ГАЛАКТИКА                    ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Производственное планирование                             ║
 ║ Версия        : 7.1                                                       ║
 ║ Назначение    : Описание объектного интерфейса                            ║
 ║ Ответственный : Климович Виктор Леонидович (VICTOR)                       ║
 ║ Параметры     : есть                                                      ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#ifdef ComponentVersion
#component "M_MnPlan"
#end

#ifndef __OALGINDOCLIST_VIH
#define __OALGINDOCLIST_VIH

#include TabMem.vpp

ObjInterface oAlgInDocList;
  // Очищает таблицу AlgInDocList
Function ClearList : Boolean;
  // Добавляет документ в таблицу AlgInDocList
Function InsertDocument ( pTypeDoc : Word; cDoc : Comp ) : LongInt;
  // Ищет первый по порядку документ данного типа в таблице AlgInDocList
Function FindDocument ( pTypeDoc : Word; cDoc : Comp ) : LongInt;
  // Удаляет все документы данного типа из таблицы AlgInDocList
Function DeleteDocument ( pTypeDoc : Word; cDoc : Comp ) : Boolean;
  // Удаляет документ с данным номером  из таблицы AlgInDocList
Function DeleteDocumentByNumber ( pNumber : LongInt ) : Boolean;
  // Возвращает количество записей в таблице AlgInDocList
Function GetListSize : LongInt;
  // Получить документ с данным номером  из таблицы AlgInDocList
Function GetDocumentByNumber (  pNumber  : LongInt;
                            Var pTypeDoc : Word;
                            Var cDoc     : Comp     ) : Boolean;
  //'Получить первый документ в списке
Function GetFirstDocument(
                           Var pTypeDoc : Word;
                           Var cDoc     : Comp
                         ) : Boolean;
  //'Получить следующий документ в списке
Function GetNextDocument(
                          Var pTypeDoc : Word;
                          Var cDoc     : Comp
                        ) : Boolean;

  //'Получить количество из текущего документа, возвращает номер записи
Function GetKolCurDocument(
                          var cOtpEd      : comp;
                          var Kol         : double;
                          var dataP       : date;
                          var wTypeNorm   : Word;     // Тип нормы
                          var cNorm       : Comp     // Ссылка на нормы
                         ) : LongInt;

// вставляет документ со всеми данными и возвращает номер новой записи
Function InsertDocumentKol ( pTypeDoc : Word;
                             cDoc     : Comp;
                             cOtpEd   : comp;
                             Kol      : double;
                             dataP    : date;
                             wTypeNorm   : Word;     // Тип нормы
                             cNorm       : Comp     // Ссылка на нормы
                              ) : LongInt;
Function DoGetCurDocument : Type$AlgInDocList_Declare;
Function DoSetDocumentByNumber( pNumber  : LongInt;
                                bfRec    : Type$AlgInDocList_Declare ) : Boolean;

  // Начальная инициализация
Function InitInter : Boolean;
  // Закрытие объекта с освобождением ссылок
Function DoneInter : Boolean;
end;

//******************************************************************************
// для доступа к полям wObject, cObject таблицы AlgInDocList
ObjInterface oAlgInObjList;
// установить объект в запись списка с указанным номером
// возвращает true если успешно изменили запись
  function SetObjInList(lNum: longint; wObj: word; cObj: comp): boolean;
// получить объект из текущей записи списка
// возвращает true если запись существует
  function GetObjFromList(var wObj: word; var cObj: comp): boolean;
end;

//******************************************************************************
ObjInterface oAlgInDocList1;
  Function GetKolCurDocumentExt(
                            Var cOtpEd      : Comp;
                            Var Kol         : Double;
                            Var dataP       : Date;
                            Var wTypeNorm   : Word;     // Тип нормы
                            Var cNorm       : Comp;     // Ссылка на нормы
                            Var pNumPr      : Longint
                               ) : LongInt;

End;

ObjInterface oAlgInDocList2(oAlgInDocList);
  // Добавляет документ в таблицу AlgInDocList
Function InsertDocumentEx ( pTypeDoc : Word; cDoc : Comp; cComp : comp) : LongInt;
  //'Получить первый документ в списке
Function GetFirstDocumentEx(
                           Var pTypeDoc : Word;
                           Var cDoc     : Comp;
                           var cComp    : comp
                         ) : Boolean;
  //'Получить следующий документ в списке
Function GetNextDocumentEx(
                          Var pTypeDoc : Word;
                          Var cDoc     : Comp;
                          var cComp    : comp
                        ) : Boolean;

//'Получить следующий документ в списке
procedure ClearAlgInDocListcObject;

End;

ObjInterface oAlgInDocList3(oAlgInDocList2);

#doc
 Сохранить AlgInDocList в буффер </brief>
#end
 Procedure Save_AlgInDocList_to_AlgInDocList_Buff;
#doc
 Загрузить AlgInDocList из буффер </brief>
#end
 Procedure Load_AlgInDocList_Buff_to_AlgInDocList;

end;


ObjInterface oAlgInDocList4(oAlgInDocList3);

 function ClearList_Buff: boolean;

end;


VipInterface iAlgInDocList implements oAlgInDocList, oAlgInObjList, oAlgInDocList1, oAlgInDocList4 #Licensed_Free;

#endif // __OALGINDOCLIST_VIH
