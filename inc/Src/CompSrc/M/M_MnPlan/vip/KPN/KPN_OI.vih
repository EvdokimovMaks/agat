// =============================================================================
//                                                     (c)  корпорация Галактика
// Галактика 7.11
// Объектные интерфейсы для календарно-плановых нормативов
// =============================================================================

#include SteckAn.vih
#include ListAn.vih

#Component "M_MnPlan"

//******************************************************************************
// ObjInterface oiKPN_CMN
#ifndef __Def_OI_KPN_OI__
#define __Def_OI_KPN_OI__
#doc
 Описание интерфейса "Общие функции работы с календарно-плановыми нормативами"</brief>
#end
ObjInterface oiKPN_CMN;

//------------------------------------------------------------------------------
#doc
 Инициализация данных</brief> <br>
 Параметры: <br>
   abShowMsg - Флаг "выдавать сообщения" <br>
#end
Procedure InitData(abShowMsg: boolean);

//------------------------------------------------------------------------------
#doc
 Возвращает Nrec роли аналитик для параметра по номеру</brief> <br>
 Параметры: <br>
   awParam - Код параметра КПН <br>
   awNpp   - Номер аналитики по порядку (1..3) <br>
 Результат: <br>
   Nrec роли аналитик <br>
#end
Function GetRoleAnByParam(awParam: word; awNpp: word): comp;

//------------------------------------------------------------------------------
#doc
 Чтение записи норматива КПН</brief> <br>
 Параметры: <br>
   awParam   - код параметра КПН <br>
   adtDat    - Дата, на которую нужно вернуть <br>
   awKAU_Obj - КАУ объекта, к которому относится параметр (-> KauConst.inc) <br>
   acObj     - Ссылка на объект <br>
   aoSteckAn - Объект, содержащий дополнительные аналитики для объекта acObj <br>
 Результат: <br>
   Запись таблицы KPN_Sp <br>
#end
Function GetParam(awParam: word; adtDat: date; awKAU_Obj: word; acObj: comp;
  aoSteckAn: oiSteckAn): type$p_KPN_Sp;

//------------------------------------------------------------------------------
#doc
 Чтение записи норматива КПН - коэффициент выполнения норм</brief> <br>
 Параметры: <br>
   adtDat   - Актуальная дата <br>
   acProfes - Ссылка на профессию (KatProfes.Nrec) <br>
   awRazr   - Разряд <br>
   awCodTar - Код тарифа <br>
   awSisOpl - Система оплаты <br>
   aoListAn - Объект-список аналитик <br>
 Результат: <br>
   Запись таблицы KPN_Sp <br>
#end
Function GetParam_KoefExecNorm(adtDat: date; acProfes: comp; awRazr: word; awCodTar: word; awSisOpl: word;
  aoListAn: oiListAn): type$p_KPN_Sp;

End; // ObjInterface oiKPN_CMN

VipInterface iKPN_CMN implements oiKPN_CMN Licensed(Free);

//******************************************************************************
// ObjInterface oiKPN_Prm
#doc
 Описание интерфейса "Параметры КПН"</brief>
#end
ObjInterface oiKPN_Prm;
End; // ObjInterface oiKPN_Prm

VipInterface iKPN_Prm implements oiKPN_Prm Licensed(Free)
Parameters
(
  pwParam: word; // Идентификатор-константа параметра КПН (передается/возвращается)
  pwFlRun: word  // Группа флагов запуска
);

//******************************************************************************
// ObjInterface oiKPN
#doc
 Описание интерфейса "Календарно-плановые нормативы"</brief>
#end
ObjInterface oiKPN;
End; // ObjInterface oiKPN

VipInterface iKPN implements oiKPN Licensed(Free);

//******************************************************************************
// ObjInterface oiKPN_Win1
#doc
 Описание интерфейса "Календарно-плановые нормативы (встроенный с одним окном)"</brief>
#end
ObjInterface oiKPN_Win1;

//------------------------------------------------------------------------------
#doc
 Установка фильтра</brief> <br>
 Параметры: <br>
   awParam - Фильтр: идентификатор параметра КПН <br>
   acRole  - Фильтр: ссылка на роль аналитик <br>
   awKAU   - Фильтр: КАУ <br>
   acAn    - Фильтр: ссылка на аналитику <br>
#end
Procedure SetFilter(awParam: word; acRole: comp; awKAU: word; acAn: comp);

//------------------------------------------------------------------------------
#doc
 Процедура обработки на ApplySet</brief>
#end
Event Procedure ApplySet;

End; // ObjInterface oiKPN_Win1

VipInterface iKPN_Win1 implements oiKPN_Win1 Licensed(Free);

//******************************************************************************
// ObjInterface oiKPN_Win2
#doc
 Описание интерфейса "Календарно-плановые нормативы (встроенный с двумя окнами)"</brief>
#end
ObjInterface oiKPN_Win2;

//------------------------------------------------------------------------------
#doc
 Установка фильтра</brief> <br>
 Параметры: <br>
   awParam - Фильтр: идентификатор параметра КПН <br>
   acRole  - Фильтр: ссылка на роль аналитик <br>
   awKAU   - Фильтр: КАУ <br>
   acAn    - Фильтр: ссылка на аналитику <br>
#end
Procedure SetFilter(awParam: word; acRole: comp; awKAU: word; acAn: comp);

//------------------------------------------------------------------------------
#doc
 Процедура обработки на ApplySet</brief> <br>
#end
Event Procedure ApplySet;

End; // ObjInterface oiKPN_Win2

VipInterface iKPN_Win2 implements oiKPN_Win2 Licensed(Free);

//******************************************************************************
// ObjInterface oiKPN_PrmC
#doc
 Описание интерфейса "Разрез по параметрам для календарно-плановых нормативов"</brief>
#end
ObjInterface oiKPN_PrmC;

//------------------------------------------------------------------------------
#doc
 Установка фильтра</brief> <br>
 Параметры: <br>
   acRole_1 - Фильтр: ссылка на роль аналитик 1 <br>
   awKAU_1  - Фильтр: КАУ 1 <br>
   acAn_1   - Фильтр: ссылка на аналитику 1 <br>
   acRole_2 - Фильтр: ссылка на роль аналитик 2 <br>
   awKAU_2  - Фильтр: КАУ 2 <br>
   acAn_2   - Фильтр: ссылка на аналитику 2 <br>
   acRole_3 - Фильтр: ссылка на роль аналитик 3 <br>
   awKAU_3  - Фильтр: КАУ 3 <br>
   acAn_3   - Фильтр: ссылка на аналитику 3 <br>
#end
Procedure SetFilter(acRole_1: comp; awKAU_1: word; acAn_1: comp; acRole_2: comp; awKAU_2: word; acAn_2: comp;
  acRole_3: comp; awKAU_3: word; acAn_3: comp);

//------------------------------------------------------------------------------
#doc
 Процедура обработки на cmPosChanged</brief> <br>
 Параметры: <br>
   awParam - Константа-идентификатор параметра <br>
#end
Event Procedure PosChanged(awParam: word);

//------------------------------------------------------------------------------
#doc
 Процедура обработки на ApplySet</brief> <br>
#end
Event Procedure ApplySet;

End; // ObjInterface oiKPN_PrmC

VipInterface iKPN_PrmC implements oiKPN_PrmC Licensed(Free);

//******************************************************************************
// ObjInterface oiKPN_PrmCAn
#doc
 Описание интерфейса "Разрез по роли аналитик для календарно-плановых нормативов"</brief>
#end
ObjInterface oiKPN_PrmCAn;

//------------------------------------------------------------------------------
#doc
 Установка фильтра</brief> <br>
 Параметры: <br>
   acRole   - Роль аналитик <br>
   awParam  - Фильтр: идентификатор параметра КПН <br>
   acRole_1 - Фильтр: ссылка на роль аналитик 1 <br>
   awKAU_1  - Фильтр: КАУ 1 <br>
   acAn_1   - Фильтр: ссылка на аналитику 1 <br>
   acRole_2 - Фильтр: ссылка на роль аналитик 2 <br>
   awKAU_2  - Фильтр: КАУ 2 <br>
   acAn_2   - Фильтр: ссылка на аналитику 2 <br>
#end
Procedure SetFilter(acRole: comp; awParam: word; acRole_1: comp; awKAU_1: word; acAn_1: comp;
  acRole_2: comp; awKAU_2: word; acAn_2: comp);

//------------------------------------------------------------------------------
#doc
 Процедура обработки на cmPosChanged</brief> <br>
 Параметры: <br>
   awKAU - КАУ <br>
   acAn  - Ссылка на аналитику <br>
#end
Event Procedure PosChanged(awKAU: word; acAn: comp);

//------------------------------------------------------------------------------
#doc
 Процедура обработки на ApplySet</brief> <br>
#end
Event Procedure ApplySet;

End; // ObjInterface oiKPN_PrmCAn

VipInterface iKPN_PrmCAn implements oiKPN_PrmCAn Licensed(Free);

//******************************************************************************
// ObjInterface oiKPN_PrmCV
#doc
 Описание интерфейса "Значения календарно-плановых нормативов"</brief>
#end
ObjInterface oiKPN_PrmCV;

//------------------------------------------------------------------------------
#doc
 Установка фильтра</brief> <br>
 Параметры: <br>
   awParam  - Фильтр: идентификатор параметра КПН <br>
   acRole_1 - Фильтр: ссылка на роль аналитик 1 <br>
   awKAU_1  - Фильтр: КАУ 1 <br>
   acAn_1   - Фильтр: ссылка на аналитику 1 <br>
   acRole_2 - Фильтр: ссылка на роль аналитик 2 <br>
   awKAU_2  - Фильтр: КАУ 2 <br>
   acAn_2   - Фильтр: ссылка на аналитику 2 <br>
   acRole_3 - Фильтр: ссылка на роль аналитик 3 <br>
   awKAU_3  - Фильтр: КАУ 3 <br>
   acAn_3   - Фильтр: ссылка на аналитику 3 <br>
#end
Procedure SetFilter(awParam: word; acRole_1: comp; awKAU_1: word; acAn_1: comp; acRole_2: comp;
  awKAU_2: word; acAn_2: comp; acRole_3: comp; awKAU_3: word; acAn_3: comp);

//------------------------------------------------------------------------------
#doc
 Процедура обработки на ApplySet</brief> <br>
#end
Event Procedure ApplySet;

End; // ObjInterface oiKPN_PrmCV

VipInterface iKPN_PrmCV implements oiKPN_PrmCV Licensed(Free);

//******************************************************************************
// ObjInterface oiKPN_Set
#doc
 Описание интерфейса "Установка параметров КПН"</brief>
#end
ObjInterface oiKPN_Set;
End; // ObjInterface oiKPN_Set

VipInterface iKPN_Set implements oiKPN_Set Licensed(Free);

//******************************************************************************
// ObjInterface oiKPN_Setup
#doc
 Описание интерфейса "Настройка календарно-плановых нормативов"</brief>
#end
ObjInterface oiKPN_Setup;
End; // ObjInterface oiKPN_Setup

VipInterface iKPN_Setup implements oiKPN_Setup Licensed(Free);

#endif
