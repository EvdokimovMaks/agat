//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Контроллинг"
// Базовый объект : "Настройка формирования первичных документов"
//------------------------------------------------------------------------------

#ifndef __MCBaseTuneCreatePD_Vih__
#define __MCBaseTuneCreatePD_Vih__

//------------------------------------------------------------------------------
#include PD_tableMemory.vpp  // Таблицы сущности : "Множественный выбор аналитики"
//------------------------------------------------------------------------------

#component "M_Control"

//------------------------------------------------------------------------------
Type TMCTuneCreatePD = record
  NRec          : comp;
  wTuneNpp      : word;
  sTuneCode     : string;
  wVidMoveMode  : word;
  cVidMoveNRec  : comp;
  cActualPeriod : comp;
  wTiDKGal      : word;
  sPreFixDoc    : string;
  cTXO          : comp;
  wDateDocMode  : word;
  wSRCPodrMode  : word;
  cSRCPodrMean  : comp;
  wDSTPodrMode  : word;
  cDSTPodrMean  : comp;
  wKOrgMode     : word;
  cKOrgMean     : comp;
  wCheckSumMode : word;
end;
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
#doc
Базовый объект : "Настройка формирования первичных документов"
#end
ObjInterface oMCBaseTuneCreatePD;

//==============================================================================
// ERROR
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить описание последней ошибки
#end
Function GetStLastError : string;

//==============================================================================
// BUFFER
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Очистить буфер значений полей настройки
#end
Procedure ClearLastTuneBuff;
//------------------------------------------------------------------------------
#doc
   Сформировать буфер значений полей настройки
#end
Function MakeBuff(_cRec : comp; var _Buff : TMCTuneCreatePD) : boolean;
//------------------------------------------------------------------------------
#doc
   Получить буфер значений полей настройки
#end
Function GetBuff (_cRec : comp) : TMCTuneCreatePD;

//==============================================================================
// VALUES
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить значение кода настройки
#end
Function GetTuneCode     (_cRec : comp) : string;
//------------------------------------------------------------------------------
#doc
   Получить значение кода вида движения
#end
Function GetVidMoveMode  (_cRec : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить ссылку на вид движения
#end
Function GetVidMoveNRec  (_cRec : comp) : comp;
//------------------------------------------------------------------------------
#doc
   Получить ссылку на период действия настройки
#end
Function GetActualPeriod (_cRec : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Получить тип документа
#end
Function GetTiDKGalDoc   (_cRec : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить префикс номера документа
#end
Function GetPreFixDoc    (_cRec : comp) : string;
//------------------------------------------------------------------------------
#doc
   Получить ссылку на ТХО
#end
Function GetTXO          (_cRec : comp) : comp;
//------------------------------------------------------------------------------
#doc
   Получить режим формирования даты документа
#end
Function GetDateDocMode  (_cRec : comp) : word;

//------------------------------------------------------------------------------
#doc
   Получить режим формирования подразделения-источника
#end
Function GetSRCPodrMode  (_cRec : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить ссылку на заданное подразделение-источника
#end
Function GetSRCPodrMean  (_cRec : comp) : comp;
//------------------------------------------------------------------------------
#doc
   Получить режим формирования подразделения-приемника
#end
Function GetDSTPodrMode  (_cRec : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить ссылку на заданное подразделение-приемника
#end
Function GetDSTPodrMean  (_cRec : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Получить режим формирования контрагента
#end
Function GetKOrgMode     (_cRec : comp) : word;
//------------------------------------------------------------------------------
#doc
   Получить ссылку на заданного контрагента
#end
Function GetKOrgMean     (_cRec : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Получить ссылку на внешний атрибут подразделения-источника
#end
Function GetSRCExtAttrPodrMean(_cRec : comp; _cPodr : comp) : comp;
//------------------------------------------------------------------------------
#doc
   Получить ссылку на внешний атрибут подразделения-приемника
#end
Function GetDSTExtAttrPodrMean(_cRec : comp; _cPodr : comp) : comp;

//------------------------------------------------------------------------------
#doc
   Получить режим корректировки сумм
#end
Function GetCheckSumMode (_cRec : comp) : word;

//==============================================================================
// NAMES
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
#doc
   Получить наименование вида движения
#end
Function GetVidMoveName      (_cRec : comp) : string;
//------------------------------------------------------------------------------
#doc
   Получить наименование периода действия настройки
#end
Function GetActualPeriodName (_cRec : comp) : string;
//------------------------------------------------------------------------------
#doc
   Получить наименование типа документа
#end
Function GetTiDKGalDocName   (_cRec : comp) : string;
//------------------------------------------------------------------------------
#doc
   Получить аббревиатуру типа документа
#end
Function GetTiDKGalDocAbbr   (_cRec : comp) : string;
//------------------------------------------------------------------------------
#doc
   Получить наименование ТХО
#end
Function GetTXOName          (_cRec : comp) : string;

//==============================================================================
//  FILTERS
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
// Получить временную таблицы с аналитикой для фильтра
// _cRec - nRec таблицы BillObor
//------------------------------------------------------------------------------
#doc
   Получить временную таблицы с аналитикой для фильтра
#end
Function GetFltTbl           (_cRec : comp) : boolean;

//------------------------------------------------------------------------------
// Построить название фильтра аналитики источника
// _cRec - nRec таблицы BillObor
//------------------------------------------------------------------------------
#doc
   Построить название фильтра аналитики источника
#end
Function GetSRCFltName       (_cRec : comp) : string;
//------------------------------------------------------------------------------
// Построить название фильтра аналитики приемника
// _cRec - nRec таблицы BillObor
//------------------------------------------------------------------------------
#doc
   Построить название фильтра аналитики приемника
#end
Function GetDSTFltName       (_cRec : comp) : string;

//------------------------------------------------------------------------------
// Удаление фильтров аналитики для таблицы SpBill
// _cRec   - nRec таблицы BillObor
// _wParam - 0-источник 1-приемник 2-источник и приемник
//------------------------------------------------------------------------------
#doc
   Удаление фильтров аналитики для таблицы SpBill
#end
Function DeleteSrcDstFlt     (_cRec : comp; _wParam  : word) : boolean;

//------------------------------------------------------------------------------
// Копирование фильтров аналитики для таблицы SpBill
// _cRec   - nRec таблицы SpBill
// _wParam - 0-источник 1-приемник 2-источник и приемник
//------------------------------------------------------------------------------
#doc
   Копирование фильтров аналитики для таблицы SpBill
#end
Function CopySrcDstFlt(_cOldRec : comp; _cNewRec : comp ) : boolean;

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
End;

VipInterface iMCBaseTuneCreatePD implements oMCBaseTuneCreatePD #Licensed_Free;

#endif // __MCBaseTuneCreatePD_Vih__
