//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.12 Производственный контур
//                расчет потребностей: поиск документов
//******************************************************************************


#ifndef __OIGPGD_VIH
#define __OIGPGD_VIH

#include oiGPSrv01.obj // установка/получение параметров расчета
#include oiGPSrv04.obj // установка/получение параметров аналитик
#include oiListSrv.obj // работа с объектом oAlgInDocList

#ifdef ComponentVersion
#component "M_GetPotr"
#end

ObjInterface oiGPGD; forward;
//******************************************************************************
#doc
Объектный интерфейс "расчет потребностей:поиск документов"</brief>
#end
ObjInterface oiGPGD;
//******************************************************************************
#doc
возвращает ссылку на активный документ</brief><br>
Параметры:<br>
<I>_wDocType</I> - тип искомого документа;<br>
<I>_wObjType, _cObject</I> - объект, для которого ищется документ<br>
<I>_wProd</I> - признак искомого документа: норма (<I>mdRes_In</I>) или продукт выхода
               (<I>mdRes_Out</I>)<br>
#end
  function GetActiveDoc(var _wDocType: word; _wObjType: word; _cObject: comp;
                        _wProd: word): comp;
#doc
возвращает ссылку на активный документ для производителя</brief>:<br>
<I>_wDocType</I> - тип искомого документа;
<I>_wObjType, _cObject</I> - объект, для которого ищется документ<br>
<I>_wDept, _cDept</I> - производитель, для которого ищется документ<br>
<I>_wProd</I> - признак искомого документа: норма (<I>mdRes_In</I>) или продукт выхода
         (<I>mdRes_Out</I>)
#end
  function GetActiveDocDept(var _wDocType: word; _wObjType: word;
                            _cObject: comp; _wDept: word; _cDept: comp;
                            _wProd: word): comp;

#doc
возвращает тип и ссылку документа для ресурса (<I>_wDoc, _cDoc</I>)</brief>:<br>
<I>_cSrcRec</I> - ссылка на исходную позицию документа<br>
результат функции:<br>
 - 0,  -  если документ найден;<br>
 - > 0 - иначе.<br>
#end
  function GetTPPDoc(_tSrcRec: word; _cSrcRec: comp; var _wDoc: word;
                     var _cDoc: comp): integer;

//******************************************************************************
#doc
реализация поиска наборов</brief>
#end
  function GetGPGDMS: oiGPGD;

#doc
реализация поиска спецификаций</brief>
#end
  function GetGPGDPS: oiGPGD;

#doc
реализация поиска маршрутов</brief>
#end
  function GetGPGDTM: oiGPGD;

end; // oiGPGD

//******************************************************************************
#doc
Объектный интерфейс "расчет потребностей: поиск документов по аналитикам"</brief>
#end
ObjInterface oiGPGDA;
#doc
поиск документов(заполняет объект <I>oAlgInDocList</I> подходящими документами)</brief>:<br>
<I>_wDoc</I> - тип искомых документов (0 - все типы)<br>
<I>_wObj, _cObj</I> - объект, для которого искать документы<br>
<I>_wProd</I> - признак искомого документа:<br>
          норма (<I>mdRes_In</I>), продукт выхода (<I>mdRes_Out</I>), все (0)<br>
 
#end
  procedure GetDocList(_wDoc, _wObj: word; _cObj: comp; _wProd: word);

end; // oiGPGDA

#endif  // __OIGPGD_VIH