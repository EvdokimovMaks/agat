//******************************************************************************
//                                                    (  c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.12 Производственный контур
//                расчет потребностей: установка/получение параметров
//******************************************************************************

#ifndef __OIGPSRV01_VIH
#define __OIGPSRV01_VIH

#ifdef ComponentVersion
#component "M_GetPotr"
#end

#include oiHistXC.vih  // проверка по извещениям

//******************************************************************************
#doc
Объектный интерфейс "расчет потребностей: установка/получение параметров"</brief>
#end
ObjInterface oiGPSrv01;
//******************************************************************************
#doc
устанавливает рабочую дату расчетов</brief><br>
Параметры:<br>
<I>_onDate</I> - рабочая дата расчета<br>
#end
  procedure SetWorkDate(_onDate: date);

#doc
устанавливает рабочие параметры расчетов</brief>:<br>
<I>_wFlag</I> - флаг параметров:<br>
<PRE class=SetWorkFlag>
       бит: значение:
         0:    0 (0000)- очищать таблицу результатов (по умолчанию)
               1 (0001)- накапливать результаты
       2,1:   00 (    )- в учетных ед.   (по умолчанию)
              01 (0002)- в тех, что есть
              10 (0004)- в акт.отпускных
              11 (0006)- резерв
         3:    0 (    )- выключить визуализацию (по умолчанию)
               1 (0008)- включить визуализацию
         4:    0 (    )- не разузловывать инструмент (по умолчанию)
               1 (0016)- разузловывать инструмент
       6,5:   00 (    )- не учитывать %потерь и коэф.использования(по умолчанию)
              01 (0032)- учитывать %потерь
              10 (0064)- учитывать коэф.использования
              11 (0096)- учитывать оба
         7:    0 (    )- выполнить пересчет формул (по умолчанию)
               1 (0128)- не выполнять пересчет формул
 11,10,9,8: 0000 (    )- не проверять наличие ресурсов (по умолчанию)
            0001 (0256)- проверять наличие материальных ресурсов
            0010 (0512)- проверять наличие трудовых ресурсов
            0100 (1024)- проверять наличие оборудования
            1000 (2048)- проверять наличие инструментов
        12:    0 (    )- контроль ресурсов по всему документу (по умолчанию)
               1 (4096)- пооперационный контроль ресурсов
        13:    0 (    )- не доставать статью затрат (по умолчанию)
               1 (8192)- доставать статью затрат
</PRE>
#end
  procedure SetWorkFlag(_wFlag: word);

#doc
устанавливает различные режимы расчетов</brief>:<br>
<I>_wMode</I> - режим работы:<br>
<PRE class=SetWorkMode>
        бит: значение:
          0:   0 (0000)- исключать фантомы (по умолчанию)
               1 (0001)- оставлять фантомы
          1:   0 (    )- не открывать окно отладки скриптов (по умолчанию)
               1 (0002)- открывать окно отладки скриптов
</PRE>
#end
  procedure SetWorkMode(_wMode: word);

#doc
устанавливает все параметры</brief>:<br>
<I>_onDate</I> - рабочую дату расчетов<br>
<I>_wFlag</I>  - рабочие параметры расчетов<br>
<I>_wMode</I>  - различные режимы расчетов<br>
#end
  procedure SetWorkParam(_onDate: date; _wFlag: word; _wMode: word);

//******************************************************************************
#doc
возвращает рабочую дату расчетов</brief>
#end
  function GetWorkDate: date;

#doc
возвращает установленные рабочие параметры расчетов</brief>
#end
  function GetWorkFlag: word;

#doc
возвращает установленные различные режимы расчетов</brief>
#end
  function GetWorkMode: word;

end; // oiGPSrv01

#endif  // __OIGPSRV01_VIH