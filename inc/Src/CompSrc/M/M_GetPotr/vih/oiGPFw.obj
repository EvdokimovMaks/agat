//******************************************************************************
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.1 Производственный контур
// расчет потребностей:получение потребностей в ресурсах для объектов по док-там
//******************************************************************************


#ifndef __OIGPFW_VIH
#define __OIGPFW_VIH

#include oiGPSrv01.obj // установка/получение параметров расчета
#include oiGPSrv02.obj // наследование параметров расчета
#include oiGPSrv03.obj

#include oiHistXC.vih  // проверка по извещениям
#include oiGetVal.vih  // получение параметров объектов модуля
#ifdef GAL7_11
#include oiJSWork.vih  // выполнение javascript
#end

#ifdef ComponentVersion
#component "M_GetPotr"
#end

ObjInterface oiGPFw; forward;

#doc
Объектный интерфейс "расчет потребностей: получение потребностей в ресурсах для
                     объектов по документам"</brief>
#end
ObjInterface oiGPFw;

//******************************************************************************
#doc
 расчет потребности по документу на учетную единицу объекта</brief>:<br>
 <I>wDocType, cDoc</I> ссылка на документ (обязательные параметры)<br>
 <I>wDepth</I> - глубина разузлования (пока 0 - нулевой, >0 - все уровни)<br>
#end
  procedure GetDocPotr(_wDocType: word; _cDoc: comp; _wDepth: word);

#doc
 расчет потребности по документу на <I>wQnt cEd</I> единиц объекта</brief>:<br>
 <I>wDocType, cDoc</I> - ссылка на документ (обязательные параметры)<br>
 <I>wDepth</I> - глубина разузлования (пока 0 - нулевой, >0 - все уровни)<br>
#end
  procedure GetDocPotrEx(_wDocType: word; _cDoc: comp; _wDepth: word;
                         _dQnt: double; _cEd: comp);

//******************************************************************************
#doc
расчет потребностей по документу и операции (только по первому уровню)на учетную
единицу объекта</brief>:<br>
<PRE class=GetDocOperPotr>
<I>wOpType, cOper</I> - ссылка на операцию (обязательные параметры,
                        если <I>wOpType = cgKAU_Marsh_Sp</I>,
                        то   <I>cDoc</I> не учитывается)
<I>wDocType, cDoc</I> - ссылка на документ (обязательный параметр)
</PRE>
#end
  procedure GetDocOperPotr(_wOpType: word; _cOper: comp; _wDocType: word;
                           _cDoc: comp);

#doc
расчет потребностей по документу и операции (только по первому уровню) на <I>wQnt
cEd</I> единиц объекта</brief>:<br>
<I>wOpType, cOper</I> - ссылка на операцию (обязательные параметры,<br>
                        если <I>wOpType = cgKAU_Marsh_Sp</I>,<br>
                        то   <I>cDoc</I> не учитывается)<br>
<I>wDocType, cDoc</I> - ссылка на документ (обязательный параметр)<br>
#end
  procedure GetDocOperPotrEx(_wOpType: word; _cOper: comp; _wDocType: word;
                             _cDoc: comp; _dQnt: double; _cEd: comp);

//******************************************************************************
#doc
расчет потребностей для объекта на учетную единицу объекта</brief>:<br>
<I>wObjType, cObject</I> - ссылка на объект (обязательные параметры)<br>
<I>wDocType, cDoc</I> - ссылка на документ (если не указан, найдет активный)<br>
<I>wDepth</I> - глубина разузлования (пока 0 - нулевой, >0 - все уровни)<br>
#end
  procedure GetObjPotr(_wObjType: word; _cObject: comp; _wDocType: word; _cDoc: comp;
                       _wDepth: word);

#doc
расчет потребностей для объекта на <I>wQnt cEd</I> единиц объекта</brief>:<br>
<I>wObjType, cObject</I> - ссылка на объект (обязательные параметры)<br>
<I>wDocType, cDoc</I> - ссылка на документ (если не указан, найдет активный)<br>
<I>wDepth</I> - глубина разузлования (пока 0 - нулевой, >0 - все уровни)<br>
#end
  procedure GetObjPotrEx(_wObjType: word; _cObject: comp; _wDocType: word;
                         _cDoc: comp; _wDepth: word; _dQnt: double; _cEd: comp);

//******************************************************************************
#doc
расчет потребностей для объекта и операции (только по первому уровню) на учетную
единицу объекта</brief>:<br>
<I>wOpType, cOper</I> - ссылка на операцию (обязательные параметры,<br>
                        если <I>wOpType = cgKAU_Marsh_Sp</I>, то <I>cDoc</I> не учитывается)<br>
<I>wObjType, cObject</I> - ссылка на объект (обязательные параметры)<br>
<I>wDocType, cDoc</I> ссылка на документ (если не указан, найдет активный для <I>wObjType</I>,<br>
                                   cObject или возьмет из Marsh_Sp,<br>
                                   если <I>wOpType</I> = cgKAU_Marsh_Sp)<br>
#end
  procedure GetObjOperPotr(_wOpType: word; _cOper: comp; _wObjType: word;
                           _cObject: comp; _wDocType: word; _cDoc: comp);

#doc
расчет потребностей для объекта и операции(только по первому уровню) на <I>wQnt cEd</I>
единиц объекта</brief>:<br>
<I>wOpType, cOper</I> - ссылка на операцию (обязательные параметры,<br>
                        если <I>wOpType = cgKAU_Marsh_Sp</I>, то <I>cDoc</I> не учитывается)<br>
<I>wObjType, cObject</I> - ссылка на объект (обязательные параметры)<br>
<I>wDocType, cDoc</I> ссылка на документ (если не указан, найдет активный для <I>wObjType</I>,<br>
                                   <I>cObject</I> или возьмет из Marsh_Sp,<br>
                                   если <I>wOpType</I> = cgKAU_Marsh_Sp)<br>
#end
  procedure GetObjOperPotrEx(_wOpType: word; _cOper: comp; _wObjType: word;
                             _cObject: comp; _wDocType: word; _cDoc: comp;
                             _dQnt: double; _cEd: comp);

//******************************************************************************
#doc
устанавливает фильтр по категориям ресурсов для документов с типом <I>_wDocType</I>
(пока только для <I>cgKAU_KatMarsh</I>)</brief>
#end
  procedure SetWorkNorm(_wDocType: word; _wNormSort: word);

#doc
устанавливает владельца (вышестоящая запись TmpPotr) и текущий уровень
для документов с типом <I>_wDocType</I></brief>
#end
  procedure SetWorkOwner(_wDocType: word; _cOwner: comp; _wLevel: word);

#doc
устанавливает маркер со списком контролируемых</brief>:<br>
<I>_wMode = cgKAU_KaWork</I> - видов работ<br>
<I>_wMode = cgKAU_TechOp</I> - техопераций<br>
для документов с типом <I>_wDocType</I> (пока только для cgKAU_KatMarsh)<br>
#end
  procedure SetWorkMarker(_wDocType: word; _wMode: word; _lValue: longint);

//******************************************************************************
#doc
возвращает установленный фильтр по категориям ресурсов для документов с типом
_wDocType (пока только для cgKAU_KatMarsh)</brief>
#end
  function GetWorkNorm(_wDocType: word): word;

#doc
возвращает установленный маркер со списком контролируемых</brief>:<br>
<I>_wMode = cgKAU_KaWork</I> - видов работ<br>
<I>_wMode = cgKAU_TechOp</I> - техопераций<br>
для документов с типом <I>_wDocType</I> (пока только для cgKAU_KatMarsh)<br>
#end
  function GetWorkMarker(_wDocType: word; _wMode: word): longint;

//******************************************************************************
#doc
реализация получения потребности в ресурсах по наборам</brief>
#end
  function GetGPFwMS: oiGPFw;

#doc
реализация получения потребности в ресурсах по спецификациям</brief>
#end
  function GetGPFwPS: oiGPFw;

#doc
реализация получения потребности в ресурсах по маршрутам</brief>
#end
  function GetGPFwTM: oiGPFw;

end; // oiGPFw

#endif  // __OIGPFW_VIH