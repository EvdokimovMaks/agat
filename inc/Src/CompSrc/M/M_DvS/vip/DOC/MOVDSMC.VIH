
#ifndef _MOVDSMC_VIH_
#define _MOVDSMC_VIH_

#ifdef ComponentVersion
#component "M_Dvs"
#end

#include DebugObj.vih


ObjInterface oMoveDs;
    Function InitShortStatusVar(FlagLoadObj : longInt) : boolean;
    Procedure KillAllTab;

//определение разреза по которому будет формироваться информация по движению сырья
//NumBound = константа для определения разреза (список допустимых констант определен в WorkDvDs.Inc)
//SectionVar структура в которую необходимо поместить информацию по которой будет определен данный разрез

//--------------------------------------------------------------------------------------------------------------------------------------------
    Function BaseFunc(prStartDate : date; prEndDate : date; prRefMC : comp; prListPick_MC : word; prRefParty : comp; prListPick_Party : word; pc_KitKau_nRec : comp;
                                                                                   prListPick_KatPodr : word; prListPick_MOL : word; S_Var : SectionVarDvDS) : boolean;
//--------------------------------------------------------------------------------------------------------------------------------------------
    Function GetKoltDSIO_Wrk_Sopr521(prRefMC : comp; prRefParty : comp; pc_KitKau_nRec : comp; prRefKatSopr_521 : comp;
                                     var prKol_Otpusk : double; var prSum_Otpusk : double;
                                     var prKol_Pererabotka : double; var prSum_Pererabotka : double;
                                     var prKol_Vozvrat : double; var prSum_Vozvrat : double) : boolean;
//--------------------------------------------------------------------------------------------------------------------------------------------
    Function GetKolSpisano_ForDSIO521(prRefDSIO : comp; pc_KitKau_nRec : comp; var prKol : double; var prRefED : comp) : boolean;
!    Function GetKolOtpusk(prStartDate : date; prEndDate : date; prRefMC : comp; prListPick_MC : word; prRefParty : comp; prListPick_Party : word; S_Var_DSIO : SectionVarDvDS; prRefOtpED : comp;
!                          var prKol : double; var prPrice : double) : boolean;
    Function GetKolOstIsh(prStartDate : date; prEndDate : date; prRefMC : comp; prListPick_MC : word; prRefParty : comp; prListPick_Party : word; pc_KitKau_nRec : comp; S_Var_DSIO : SectionVarDvDS; prRefOtpED : comp;
                          var prKol : double; var prPrice : double) : boolean;
//--------------------------------------------------------------------------------------------------------------------------------------------
    Function SetAgrInfo_tDSIO_Wrk_All(prStartDate : date; prEndDate : date; prTypeDv : word;
       prRefMC : comp; prListPick_MC : word; prRefParty : comp; prListPick_Party : word; pc_KitKau_nRec : comp; prListPick_KatPodr : word; prListPick_MOL : word; S_Var_Wrk : SectionVarDvDS) : boolean;
    Function GetStructAgrInfo_MCParty(prStartDate : date; prEndDate : date; prTypeDv : word;
        prRefMC : comp; prListPick_MC : word; prRefParty : comp; prListPick_Party : word; pc_KitKau_nRec : comp; prListPick_KatPodr : word; prListPick_MOL : word; S_Var_DSIO : SectionVarDvDS) : StructAgrInfo;
//--------------------------------------------------------------------------------------------------------------------------------------------
//список МЦ передается в объект через таблицы Pick. Признак по которому можно найти данную инфомацию,
//передается через параметр wlist. Он должен соответствовать Pick.wList для данных таблиц
    Function GetInfoDSIO_by_PickMC(prStartDate : date; prEndDate : date; wList : word; S_Var : SectionVarDvDS) : boolean;
//получить детальню информацию по движению сырья(одно наименование МЦ)
    Function GetInfoDSIO_by_AllMC(prStartDate : date; prEndDate : date; S_Var : SectionVarDvDS) : boolean;
    Function GetInfoDSIO_by_AllMC_Full(prStartDate : date; prEndDate : date; S_Var : SectionVarDvDS) : boolean;
    Function GetState_TAgrInfo_MCParty_All : Boolean;
    Function GetRefKatDSNor(prDSIO : type$DSIO) : comp;
//--------------------------------------------------------------------------------------------------------------------------------------------
    Function DefCorrectDSIO_KatSopr(prRefKatSopr : comp) : boolean;
    Function DefCorrectDSIO_All(prStartDate : date; prEndDate : date) : boolean;
//--------------------------------------------------------------------------------------------------------------------------------------------
//  Отладка
   Function GetStrDsk_Deb : string;
   Procedure SetStrDsk_Deb(prStrDSK_Deb : string);
   Function GetNameObj : string;
   Procedure SetNameObj(prNameObj : string);
   Function LoadDebugObj(prDebugObj : oDebug) : boolean;
   Function GetModeDebug : boolean;
   Function SetModeDebug(prFlagDebug : boolean) : Boolean;
   Procedure SetStartVarDebug(prStrDSK_Deb : string; prNameObj : string);
   Function RunWindow_Debug(prTypeWnd : word; prNameWnd : string; prDebStr : string) : Boolean;
   Function SetExtInfoDebug(prDebugObj : oDebug) : Boolean;
end;

VipInterface MovDSMC implements oMoveDs
#ifdef ATL51
 Licensed (FREE)
#endif
;

#endif
