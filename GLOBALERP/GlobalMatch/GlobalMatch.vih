#ifndef _GlobalMatchManager_
#define _GlobalMatchManager_

#include GlobalGoods.vih
#include GlobalDataProviderMatches.vih
#include Query.vih
#include System.vih

#component "AGAT"

const
  MatchDirection_SearchGlobal = 001b;
  MatchDirection_SearchGalaxy = 010b;
  MatchDirection_DontSearch   = 100b;
end;

objinterface IMC;
  property Nrec       : comp;
  property Name       : string;
  property Code       : string[80];
  property KatedNrec  : comp;
  property GroupmcNrec: comp;
  property TypemcNrec : comp;
end;

objinterface IGoodsMatch;
  property Goods: IGlobalGoods;
  property MC: IMC;
end;

objinterface IGoodsMatches(IGoodsMatch);
  property MCCollection: ICollection;
end;

objinterface IMatchLoaderGoodsByMC;
  function LoadMatches(aMC: IMC): ICollection;
end;

objinterface IMatchLoaderMCByGoods;
  function LoadMatches(aGoods: IGlobalGoods): ICollection;
end;

objinterface IMatchesManager;
  procedure LoadMatches(aMatchesCollection: ICollection);
  function ShowUIEditMatches(aMatchesList: IList): longint;
  procedure SaveMatches(aMatchesCollection: ICollection);
end;

vipinterface MC implements IMC;
  public:
    constructor LoadByNrec(aKatmcNrec: comp);
end;

vipinterface GoodsMatch implements IGoodsMatch;
  public:
    function InitObjectsIfNull: boolean;
    constructor Init;
    constructor GoodsMatch(aGoods: IGlobalGoods = nullref;
                           aMC: IMC = nullref);
end;

vipinterface GoodsMatches(GoodsMatch) implements IGoodsMatches;
  public:
    function InitObjectsIfNull: boolean;
    constructor GoodsMatches(aGoods: IGlobalGoods = nullref;
                             aMC: IMC = nullref;
                             aMCCollection: ICollection = nullref);
end;

vipinterface MatchLoaderGoodsByMC implements IMatchLoaderGoodsByMC;
  public:
    constructor Init;
    constructor MatchLoaderGoodsByMC(aDataProvider: IGlobalDataProviderMatches);
    property DataProvider: IGlobalDataProviderMatches;
end;

vipinterface MatchLoaderMCByGoods implements IMatchLoaderMCByGoods;
  public:
    constructor Init;
    constructor MatchLoaderMCByGoods(aDataProvider: IGlobalDataProviderMatches);
    property DataProvider: IGlobalDataProviderMatches;
end;

vipinterface MatchesManager implements IMatchesManager;
  public:
    constructor Init;
    constructor MatchesManager(aMatchLoaderMCByGoods: IMatchLoaderMCByGoods = nullref;
                               MatchLoaderGoodsByMC: IMatchLoaderGoodsByMC = nullref);
    property MatchLoaderMCByGoods: IMatchLoaderMCByGoods;
    property MatchLoaderGoodsByMC: IMatchLoaderGoodsByMC;
end;

/*
objinterface IGoodsMatch;
  function LoadMatches(aGlobalGoodsCollection: IGlobalGoodsCollection): boolean;
  function ShowUI(aGlobalGoodsCollection: IGlobalGoodsCollection; aDefaultMatchDirection: byte = MatchDirection_SearchGlobal): longint;
end;


objinterface IGlobalMatchSetter;
  function SetMatch(args: tArgsArray): boolean;
end;

objinterface IGlobalMatchManager;
  function FindByExternalObjId(aExternalObjId: string): IResultSet;
  function FindByRefObjId(aRefObjId: comp): IResultSet;
  function SetMatch(aRefObjId: comp; aExternalObjId: string): boolean;
end;

vipinterface GlobalMatchManager implements IGlobalMatchManager;
  public:
    constructor Init;
    property SearcherByExternalObjId: IGlobalMatchSearcher;
    property SearcherByRefObjId: IGlobalMatchSearcher;
    property MatchSetter: IGlobalMatchSetter;
end;

vipinterface GoodsByKatmcMatchSearcher implements IGlobalMatchSearcher;
  public:
    constructor Init;
    property IdObjMappingType: string;
    property IdRefClass: string;
end;

vipinterface KatmcByGoodsMatchSearcher implements IGlobalMatchSearcher;
  public:
    constructor Init;
    property IdObjMappingType: string;
    property IdRefClass: string;
end;

vipinterface SingleKatmcByGoodsMatchSearcher(KatmcByGoodsMatchSearcher);
  public:
    function IGlobalMatchSearcher.SearchMatch(args: tArgsArray): IResultSet;
end;

vipinterface KatmcGoodsMatchSetter implements IGlobalMatchSetter;
  public:
    constructor Init;
    property IdObjMappingType: string;
    property IdRefClass: string;
end;

vipinterface GlobalGoodsColFillerKatsopr implements IGlobalGoodsCollectionFiller;
vipinterface GlobalGoodsColFillerBasedoc implements IGlobalGoodsCollectionFiller;

objinterface IGlobalGoodsCollectionFiller;
  procedure FillCollection(aCollection: ICollection; aParams: IParams = nullref);
end;
*/

#end
