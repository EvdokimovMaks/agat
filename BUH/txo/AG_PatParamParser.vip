#include AG_PatParam.vih

#component "AGAT"

interface AG_PatParamParser;

var
  _factory: AP_IPatParamFactory;

function parse(params: AG_IPatParams; ctx: TAG_PatParamContext): boolean;
{
  var i: word = 0;
  var cnt: word = TxoParamCount(ctx.hTxo);
  for(i := 1; i <= cnt; i++)
  {
    var pn: TPatParamName = TxoParamName(ctx.hTxo, i);
    var pv: string = TxoParamValue(ctx.hTxo, i);
    var p: AG_IPatParam = _factory.param(pn, pv, ctx);
    if params.set(pn, p) and p != NullRef
      p.value := pv;
  }
}

constructor Init;
{
  result := false;
}

constructor Create(factory: AG_IPatParamFactory);
{
  _factory := factory;
  result := _factory != NullRef;
}

end.